var b4w="object"===typeof b4w?b4w:function(a){var p={};a.module=p;var e={};a.cleanup=function(a,b){var n=p[a];n&&(n.jl=null);e[b||"__b4w_default"]=null};a.register=function(a,b){p[a]||(p[a]=b)};a.require=function(a,b){if(!p[a])throw Error('Module "'+a+'" not found');b=b||"__b4w_default";e[b]||(e[b]=function(a){return function(b){var c=p[b];if(!c)throw Error('Module "'+b+'" not found');c.jl||(c.jl={});c.jl[a]||(c.jl[a]={},c(c.jl[a],e[a]));return c.jl[a]}}(b));return e[b](a)};a.module_check=function(a){return p[a]?
!0:!1};a.get_namespace=function(a){for(var b in e)if(e[b]==a)return b;return""};a.worker_listeners=[];a.worker_namespaces=[];return a}({});"object"==typeof module&&module.tu&&(GLOBAL.b4w={module:{}});
b4w.module.__version=function(a){function p(){var a=e,c=a.getDate(),c=10>c?"0"+String(c):String(c),h=a.getMonth()+1,h=10>h?"0"+String(h):String(h),r=String(a.getFullYear()),g=a.getHours(),g=10>g?"0"+String(g):String(g),m=a.getMinutes(),m=10>m?"0"+String(m):String(m),a=a.getSeconds(),a=10>a?"0"+String(a):String(a);return c+"."+h+"."+r+" "+g+":"+m+":"+a}var e=new Date(2016,7,31,12,35,13),c=[16,8];a.version=function(){return c};a.version_str=function(){for(var a="",e=0;e<c.length;e++)a=1==e?a+(10>c[e]?
"0"+c[e]:c[e]):a+c[e],e!=c.length-1&&(a+=".");return a};a.type=function(){return"RELEASE"};a.date=function(){return e};a.date_str=p;a.timestamp=function(){var a=p(),a=a.split(" ").join("").split(":").join("").split(".").join("");return"?t="+a}};"object"==typeof module&&module.tu&&b4w.module.__version(exports);b4w.module.__config=function(a,p){function e(){return b4w.module_check(a.Od.dq)}function c(){for(var c=a.Od,e=null,g=document.getElementsByTagName("script"),m=0;m<g.length;m++){for(var q=g[m].src,B=0;B<c.qA.length;B++)if(0<=q.indexOf(c.qA[B])){e=q;break}if(null!==e)break}e||(b.warn("Couldn't determine path to ancillary resources, fallback to the current page directory"),e=document.location.href);c=e.indexOf("?");0<=c&&(e=e.substring(0,c));return e.substring(0,e.lastIndexOf("/")+1)}var b=p("__print"),
n=p("__util");a.P_LOW=1;a.P_HIGH=2;a.P_ULTRA=3;a.P_CUSTOM=4;a.context={alpha:!0,antialias:!1,premultipliedAlpha:!0};a.Py=n.I(a.context);a.v={alpha_sort:!0,alpha_sort_threshold:.1,yk:[5,7],max_fps:1E4,console_verbose:!1,do_not_load_resources:!1,use_min50:!1,uz:1,WI:5,background_color:[0,0,0,0],canvas_resolution_factor:1,Em:3,allow_cors:!1,wu:!1,anisotropic_filtering:!0,show_hud_debug_info:!1,fQ:!0,shadows:!0,stereo:"NONE",reflections:!0,refractions:!0,ssao:!0,dof:!0,god_rays:!0,bloom:!0,motion_blur:!0,
ql:!0,antialiasing:!0,smaa:!1,debug_view:!1,eD:!1,Dl:!0,Nr:!0,kc:!0,water_dynamic:!0,shore_smoothing:!0,mm:!0,PC:!0,precision:"highp",quality:a.P_HIGH,Tp:!0,lL:!1,PB:!1,mu:!1,XC:!1,is_mobile_device:!1,Su:!1,Lt:!1,DR:!1,Yo:!1,allow_hidpi:!1,TB:!1,qv:!1,enable_selectable:!0,enable_outlining:!0,sh:!0,$q:!1,oz:!1,fv:[0,0],Vn:!1,tB:!0,ms:!1,url_params:null,pc:!0,xc:4,DB:!1,EB:!1,aw:!1,Dy:!1,media_auto_activation:!0,JA:4,vr:!1,Qx:!1,gl_debug:!1,yy:!1,Px:!1,pt:!1};a.bz=n.I(a.v);a.zj={Iq:-1,wz:!1,ak:1};a.controls=
{hL:1/120};a.hf={dir:"ASSETS=../../assets/",bL:15,prevent_caching:!0,pv:!1,iu:!1};a.Vx=n.I(a.hf);a.Od={shaders_dir:"",YM:"include/",AR:"postprocessing/",dq:"built_in_data",qA:"b4w.min.js b4w.full.min.js b4w.simple.min.js b4w.whitespace.min.js src/b4w.js USER_DEFINED_MODULE".split(" "),zB:"./",smaa_search_texture_path:"",smaa_area_texture_path:""};a.bK={webvr:{distortion_coefs:[.22,.28],chromatic_aberration_coefs:[-.015,.02,.025,.02]},nonwebvr:{nk:.064,ci:.035,Zi:.039,distortion_coefs:[.34,.55],chromatic_aberration_coefs:[0,
0,0,0],Rm:.11,wi:.062,ei:.004}};a.A={enabled:!0,max_fps:60,op:"",Dt:!1,ping:!1,sp:!0};a.iB=n.I(a.A);a.Kk={Oq:1024,sl:384,Uy:32,gI:128,fI:256,kB:.25,DL:.5,CL:1};a.HB=n.I(a.Kk);a.L={hx:!0,Ar:!1,Yx:!1,Ey:!1,fz:!1};a.OB=n.I(a.L);a.fc={outlining_overview_mode:!1,Dh:[1,.4,.05],Mi:.2,Ni:3.8,Oi:1};a.uq={enabled:!1,AN:0,zN:0,aN:"COLOR"};a.Yy=n.I(a.uq);a.mi={$K:8,iv:64,KA:8,mv:8,LA:15,MA:0,nv:128,Ei:1024,jv:4096,ec:4096,ov:[4096,4096]};a.Oy=n.I(a.mi);a.IF=function(){var b=a.v,c=a.A,e=a.Kk;switch(b.quality){case a.P_ULTRA:b.shadows=
!0;b.shore_smoothing=!0;b.ssao=!0;b.dof=!0;b.god_rays=!0;b.bloom=!0;b.reflections=!0;b.refractions=!0;b.Dl=!0;b.Nr=!0;b.kc=!0;e.Oq=2048;b.Em=3;b.anisotropic_filtering=!0;b.use_min50=!1;b.precision="highp";b.water_dynamic=!0;b.mm=!0;b.antialiasing=!0;b.smaa=!1;b.ql=!0;b.motion_blur=!0;b.allow_hidpi=!0;b.enable_outlining=!0;b.sh=!0;b.xc=16;c.max_fps=120;break;case a.P_HIGH:b.shadows=!0;b.shore_smoothing=!0;b.ssao=!0;b.dof=!0;b.god_rays=!0;b.bloom=!0;b.reflections=!0;b.refractions=!0;b.Dl=!0;b.Nr=!0;
b.kc=!0;e.Oq=1024;b.Em=3;b.anisotropic_filtering=!0;b.use_min50=!1;b.precision="highp";b.water_dynamic=!0;b.mm=!0;b.antialiasing=!0;b.smaa=!1;b.ql=!0;b.motion_blur=!0;b.allow_hidpi=!1;b.enable_outlining=!0;b.sh=!0;b.xc=4;c.max_fps=60;break;case a.P_LOW:b.shadows=!1,b.shore_smoothing=!1,b.ssao=!1,b.dof=!1,b.god_rays=!1,b.bloom=!1,b.reflections=!1,b.refractions=!1,b.Dl=!1,b.Nr=!1,b.kc=!1,e.Oq=512,b.Em=2,b.anisotropic_filtering=!1,b.use_min50=!0,b.precision="mediump",b.water_dynamic=!1,b.mm=!1,b.antialiasing=
!1,b.smaa=!1,b.ql=!1,b.motion_blur=!1,b.allow_hidpi=!1,b.enable_outlining=!1,b.sh=!1,b.xc=1,c.max_fps=60}};a.set=function(c,e){switch(c){case "allow_cors":a.v.allow_cors=e;break;case "allow_hidpi":a.v.allow_hidpi=e;break;case "alpha":a.context.alpha=e;break;case "alpha_sort":a.v.alpha_sort=e;break;case "alpha_sort_threshold":a.v.alpha_sort_threshold=e;break;case "anaglyph_use":b.EI();a.v.stereo=e?"ANAGLYPH":a.v.stereo;break;case "animation_framerate":a.zj.Iq=e;break;case "anisotropic_filtering":a.v.anisotropic_filtering=
e;break;case "antialiasing":a.v.antialiasing=e;break;case "assets_dds_available":a.hf.iu=e;break;case "assets_min50_available":a.hf.pv=e;break;case "audio":a.L.hx=e;break;case "background_color":a.v.background_color=e;break;case "bloom":a.v.bloom=e;break;case "built_in_module_name":a.Od.dq=e;break;case "canvas_resolution_factor":a.v.canvas_resolution_factor=e;break;case "console_verbose":a.v.console_verbose=e;break;case "dof":a.v.dof=e;break;case "do_not_load_resources":a.v.do_not_load_resources=
e;break;case "god_rays":a.v.god_rays=e;break;case "stereo":a.v.stereo=e;break;case "max_fps":a.v.max_fps=e;break;case "max_fps_physics":a.A.max_fps=e;break;case "media_auto_activation":a.v.media_auto_activation=e;break;case "motion_blur":a.v.motion_blur=e;break;case "physics_enabled":a.A.enabled=e;break;case "physics_uranium_path":a.A.op=e;break;case "physics_calc_fps":a.A.Dt=e;break;case "physics_use_workers":a.A.sp=e;break;case "precision":a.v.precision=e;break;case "prevent_caching":a.hf.prevent_caching=
e;break;case "quality":a.v.quality=e;break;case "reflections":a.v.reflections=e;break;case "refractions":a.v.refractions=e;break;case "sfx_mix_mode":a.L.Ar=e;break;case "shaders_dir":a.Od.shaders_dir=e;break;case "shadows":a.v.shadows=e;break;case "show_hud_debug_info":a.v.show_hud_debug_info=e;break;case "smaa":a.v.smaa=e;break;case "smaa_search_texture_path":a.Od.smaa_search_texture_path=e;break;case "smaa_area_texture_path":a.Od.smaa_area_texture_path=e;break;case "ssao":a.v.ssao=e;break;case "debug_view":a.v.debug_view=
e;break;case "enable_selectable":a.v.enable_selectable=e;break;case "enable_outlining":a.v.enable_outlining=e;break;case "outlining_overview_mode":a.fc.outlining_overview_mode=e;break;case "glow_materials":a.v.sh=e;break;case "url_params":a.v.url_params=e;break;case "use_min50":a.v.use_min50=e;break;case "gl_debug":a.v.gl_debug=e;break;default:b.error("Unknown config property: "+c)}};a.get=function(c){switch(c){case "allow_cors":return a.v.allow_cors;case "allow_hidpi":return a.v.allow_hidpi;case "alpha":return a.context.alpha;
case "alpha_sort":return a.v.alpha_sort;case "alpha_sort_threshold":return a.v.alpha_sort_threshold;case "anaglyph_use":return"ANAGLYPH"==a.v.stereo;case "animation_framerate":return a.zj.Iq;case "anisotropic_filtering":return a.v.anisotropic_filtering;case "antialiasing":return a.v.antialiasing;case "assets_dds_available":return a.hf.iu;case "assets_min50_available":return a.hf.pv;case "audio":return a.L.hx;case "background_color":return a.v.background_color;case "bloom":return a.v.bloom;case "built_in_module_name":return a.Od.dq;
case "canvas_resolution_factor":return a.v.canvas_resolution_factor;case "console_verbose":return a.v.console_verbose;case "dof":return a.v.dof;case "do_not_load_resources":return a.v.do_not_load_resources;case "is_mobile_device":return a.v.is_mobile_device;case "god_rays":return a.v.god_rays;case "stereo":return a.v.stereo;case "max_fps":return a.v.max_fps;case "max_fps_physics":return a.A.max_fps;case "media_auto_activation":return a.v.media_auto_activation;case "motion_blur":return a.v.motion_blur;
case "physics_enabled":return a.A.enabled;case "physics_uranium_path":return a.A.op;case "physics_calc_fps":return a.A.Dt;case "physics_use_workers":return a.A.sp;case "precision":return a.v.precision;case "prevent_caching":return a.hf.prevent_caching;case "quality":return a.v.quality;case "reflections":return a.v.reflections;case "refractions":return a.v.refractions;case "sfx_mix_mode":return a.L.Ar;case "shaders_dir":return a.Od.shaders_dir;case "shadows":return a.v.shadows;case "show_hud_debug_info":return a.v.show_hud_debug_info;
case "smaa":return a.v.smaa;case "smaa_search_texture_path":return a.Od.smaa_search_texture_path;case "smaa_area_texture_path":return a.Od.smaa_area_texture_path;case "ssao":return a.v.ssao;case "debug_view":return a.v.debug_view;case "enable_selectable":return a.v.enable_selectable;case "enable_outlining":return a.v.enable_outlining;case "outlining_overview_mode":return a.fc.outlining_overview_mode;case "glow_materials":return a.v.sh;case "url_params":return a.v.url_params;case "use_min50":return a.v.use_min50;
case "gl_debug":return a.v.gl_debug;default:b.error("Unknown config property: "+c)}};a.reset=function(){for(var b in a.Py)a.context[b]=a.Py[b];for(b in a.bz)a.v[b]=a.bz[b];for(b in a.Vx)a.hf[b]=a.Vx[b];for(b in a.iB)a.A[b]=a.iB[b];for(b in a.HB)a.Kk[b]=a.HB[b];for(b in a.OB)a.L[b]=a.OB[b];for(b in a.Yy)a.uq[b]=a.Yy[b]};a.reset_limits=function(){for(var b in a.Oy)a.mi[b]=a.Oy[b]};a.hA=e;a.HM=function(){var b=a.Od,n=a.A;e()||""!=b.shaders_dir||(b.shaders_dir=c()+"../shaders/");if(e())b.smaa_search_texture_path=
"smaa_search_texture.png",b.smaa_area_texture_path="smaa_area_texture.png";else if(""==b.smaa_search_texture_path||""==b.smaa_area_texture_path){var g=c()+b.zB;b.smaa_search_texture_path=b.smaa_search_texture_path||g+"smaa_search_texture.png";b.smaa_area_texture_path=b.smaa_area_texture_path||g+"smaa_area_texture.png"}n.enabled&&""==n.op&&(g=c()+b.zB,n.op=g+"uranium.js")};a.get_std_assets_path=function(){return a.hf.dir.replace("ASSETS=","")}};b4w.module.__anchors=function(a,p){function e(){t=!0;l.get_container().addEventListener("mouseup",function(){function a(){return"visible"==d.style.visibility&&!l&&!h}if(!M&&!x){var b=k;if(b)if("visible"==b.lastElementChild.style.visibility)c(),k=null;else if(1==b.style.opacity){var d=b.lastElementChild,f=d.firstElementChild,v=f.innerHTML;d.style.visibility="visible";var t=Math.min(parseInt(d.style.width)||200,r(v)-24),L=g(v,t),l=!1,h=!1,v=b.offsetWidth-24,b=b.offsetHeight-16;L==b&&(d.style.height=
L+"px");t!=v?(M=l=!0,y.animate(v,t,200,function(b){b==t&&(l=!1,h||(M=!1),a&&(f.style.visibility="visible"));d.style.width=b+"px"})):l=!1;L!=b?(M=h=!0,y.animate(b,L,200,function(b){b==L&&(h=!1,l||(M=!1),a&&(f.style.visibility="visible"));d.style.height=b+"px"})):h=!1}}})}function c(){var a=k.lastElementChild;a.style.visibility="hidden";a.firstElementChild.style.visibility="hidden"}function b(a){a.style.cssText+="color:       #fff;font-family: Arial;font-size:   12px;font-weight: bold;line-height: 15px;"}
function n(a){a.style.cssText+="background-color:   #000;border-radius:      20px 20px 20px 0px;bottom:             0;box-shadow:         0px 0px 10px rgb(180, 180, 200);-webkit-box-shadow: 0px 0px 10px rgb(180, 180, 200);font-size:          12px;left:               0;line-height:        15px;opacity:            1.0;overflow:           hidden;padding:            8px 12px;position:           absolute;z-index:            2;"}function h(a,d,f){var v=document.createElement("div"),l=document.createElement("span");
f&&(v.style.width=f+"px");n(v);b(l);l.innerHTML=a;v.style.visibility="hidden";l.style.visibility="hidden";v.appendChild(l);d.appendChild(v);d.addEventListener("mousedown",function(){M||d==k||1!=d.style.opacity||x||(k&&"visible"==k.lastElementChild.style.visibility&&c(),k=d)})}function r(a){var c=document.createElement("div"),d=document.createElement("span");d.innerHTML=a;b(d);n(c);c.appendChild(d);document.body.appendChild(c);a=c.offsetWidth+1;document.body.removeChild(c);return a}function g(a,c){var d=
document.createElement("div"),f=document.createElement("span");f.innerHTML=a;b(f);n(d);d.style.width=c+"px";d.style.display="inline-block";d.appendChild(f);document.body.appendChild(d);f=d.offsetHeight-16;document.body.removeChild(d);return f}function m(){for(var a=0,b=0;b<G.length;b++)G[b].vl&&a++;u=new Float32Array(3*a)}function q(a,b){return b.depth-a.depth}var B=p("__batch"),d=p("__camera"),l=p("__container"),f=p("__objects"),H=p("__print"),D=p("__renderer"),w=p("__scenes"),E=p("__subscene"),
y=p("__time"),A=p("__tsr"),G=[],x=!1,k=null,t=!1,M=!1,u=new Float32Array(0),v=new Uint8Array(16),z=new Float32Array(2),S=new Float32Array(3);a.append=function(a){var c;a:{for(c=0;c<G.length;c++)if(G[c].obj==a){c=!0;break a}c=!1}if(!c){c=a.anchor.vl&&Boolean(w.Ba(w.ik(),E.cl));c={type:a.anchor.type,obj:a,x:0,y:0,depth:0,Aj:"out",vl:c,element:null,$l:null,iF:a.anchor.cL,Up:0,rt:0,Aq:a.anchor.Aq};switch(c.type){case "ANNOTATION":var d=c.iF,v=document.createElement("div"),k=document.createElement("span"),
u="",L=a.name,z=l.get_container();a=f.get_meta_tags(a);v.style.cssText+="background-color:   #000;border-radius:      20px 20px 20px 0px;box-shadow:         0px 0px 10px rgb(180, 180, 200);-webkit-box-shadow: 0px 0px 10px rgb(180, 180, 200);font-size:          12px;line-height:        15px;opacity:            1.0;padding:            8px 12px;position:           absolute;";v.style.visibility="hidden";z.appendChild(v);a&&(u=a.description||u,L=a.title||L);k.innerHTML=L;k.style.cssText+="-webkit-touch-callout: none;-webkit-user-select:   none;-khtml-user-select:    none;-moz-user-select:      none;-ms-user-select:       none;user-select:           none;cursor:                default;";
b(k);v.appendChild(k);u&&h(u,v,d);c.element=v;c.Up=c.element.offsetHeight;c.rt=c.element.offsetWidth;break;case "ELEMENT":c.element=document.getElementById(a.anchor.Aq),c.element?(c.Up=c.element.offsetHeight,c.rt=c.element.offsetWidth):(H.warn("Anchor HTML element was not found, making it generic"),c.type="GENERIC")}G.push(c);m();t||e()}};a.remove=function(a){for(var b=0;b<G.length;b++){var c=G[b];if(c.obj==a){"ANNOTATION"==c.type&&(a=c,l.get_container().removeChild(a.element));G.splice(b,1);m();
break}}};a.update=function(){for(var a=0,b=G.length;b--;){var c=G[b];if(c.vl){var f=A.get_trans_view(c.obj.k.m);u.set(f,3*a++)}var v;v=c;var f=S,l=w.gk(w.ik());v=A.get_trans_view(v.obj.k.m);v=f=d.project_point(l,v,f);f=v[0];l=v[1];v=v[2];if(f!=c.x||l!=c.y||v!=c.depth){switch(c.type){case "ANNOTATION":var L=c.element;L.style.left=Math.floor(f)+"px";L.style.top=Math.floor(l-c.Up)+"px";break;case "ELEMENT":var L=c.element,t=L.getBoundingClientRect();L.style.cssText+="left:"+Math.floor(f-t.width/2)+"px;top:"+
Math.floor(l-t.height/2)+"px;"}c.x=f;c.y=l;c.depth=v;c.$l&&c.$l(f,l,c.Aj,c.obj,L)}}G.sort(q);for(b=0;b<G.length;b++)c=G[b],"GENERIC"!=c.type&&(c.element.style.zIndex=k==c.element?G.length:b);0<a&&(a=w.Ba(w.ik(),E.cl).za[0].ha[0].Y,B.ON(a,u))};a.OC=function(){for(var a=l.get_container(),b=G.length;b--;){var c=G[b],d=c.obj,f=c.x,t=c.y,L=c.depth,L=0>f||0>t||0>L||1<L||w.is_hidden(d)||f>=a.clientWidth||t>=a.clientHeight?"out":"visible";if(c.vl&&"out"!=L){var L=c,k=w.Ba(w.ik(),E.cl).o,h=l.gq(L.x,L.y,z,
k);D.Wv(k.je,h[0],k.height-h[1],2,2,v);L=1020==v[0]+v[4]+v[8]+v[12]?"visible":"out"==L.Aj||0==v[0]+v[4]+v[8]+v[12]?"covered":L.Aj}if(L!=c.Aj){switch(c.type){case "ANNOTATION":case "ELEMENT":var U=c.element;if(!U)break;"out"==L?(U.style.visibility="hidden",U.children.length&&(U.children[0].style.visibility="hidden")):"visible"==L?(U.style.visibility="visible",U.children.length&&(U.children[0].style.visibility="visible"),U.style.opacity=1):(U.style.visibility="visible",U.style.opacity=.1,U.children.length&&
(U.children[0].style.visibility="visible"),"ANNOTATION"==c.type&&1<U.children.length&&(k=U.children[1],k.style.visibility="hidden",k.children.length&&(k.children[0].style.visibility="hidden")))}c.Aj=L;c.$l&&c.$l(f,t,c.Aj,d,U)}}};a.attach_move_cb=function(a,b){for(var c=0;c<G.length;c++)G[c].obj==a&&(G[c].$l=b)};a.detach_move_cb=function(a){for(var b=0;b<G.length;b++)G[b].obj==a&&(G[b].$l=null)};a.cleanup=function(){for(var a=0;a<G.length;a++){var b=G[a];"ANNOTATION"==b.type&&l.get_container().removeChild(b.element)}G.length=
0};a.is_anchor=function(a){for(var b=0;b<G.length;b++)if(G[b].obj==a)return!0;return!1};a.get_element_id=function(a){for(var b=0;b<G.length;b++)if(G[b].obj==a)return G[b].Aq;return!1};a.pause=function(){x=!0};a.resume=function(){x=!1};a.wL=function(a,b){for(var c=-1,d=0;d<G.length;d++){var f;if(f="visible"==G[d].Aj){var v=G[d];f=Math.round(v.rt);var L=Math.round(v.Up),l=v.x,v=v.y;f=a>=l&&a<=l+f&&b<v&&b>=v-L?!0:!1}if(f)if(0>c)var t=G[d].depth,c=d;else G[d].depth<t&&(c=d,t=G[d].depth)}return 0>c?null:
G[c].obj}};b4w.module.__armature=function(a,p){function e(a){a=a.k;for(var b=a.pm,c=a.xr,d=0;d<b.length;d++){for(var l=b[d],h=c[d],e=0;e<h.length;e+=2)for(var g=h[e],x=h[e+1],k=0;4>k;k++)l.Bd[g+k]=a.Bd[x+k],l.Qd[g+k]=a.Qd[x+k],l.Ed[g+k]=a.Ed[x+k],l.Sd[g+k]=a.Sd[x+k];l.ie=a.ie}}function c(a,b,d,l){var h=a.Vw,e=a.ij,g=a.lp,B=a.Jv;B?(B=B.lp,b?n.multiply(B,h,g):(b=q,n.invert(B,b),n.multiply(b,g,h))):b?n.copy(h,g):n.copy(g,h);h=m;n.invert(e,h);n.multiply(g,h,h);e=a.fi;d[4*e]=h[0];d[4*e+1]=h[1];d[4*e+2]=h[2];d[4*
e+3]=h[3];l[4*e]=h[4];l[4*e+1]=h[5];l[4*e+2]=h[6];l[4*e+3]=h[7];a=a.dz;for(e=0;e<a.length;e++)g=a[e],g.Ib||c(g,!0,d,l)}var b=p("__util"),n=p("__tsr"),h=p("__quat"),r=p("__mat4"),g=p("__vec3"),m=n.create(),q=n.create(),B=new Float32Array(4),d=new Float32Array(4),l=new Float32Array(4);a.lj=function(a,c){for(var d=a.data.bones,l=a.pose.bones,h={},e=0;e<l.length;e++){var B=l[e],q=B.bone,x=q.name,k=h[x]={fi:0,YC:-1,Jv:null,dz:[],hq:[],Ib:null,kp:n.create(),Vw:n.create(),ij:n.create(),lp:n.create(),ys:n.create(),
Ww:n.create(),zs:!1,rC:new Float32Array(3)},x=new Float32Array(q.matrix_local),t=new Float32Array(16);r.invert(x,t);var B=new Float32Array(B.matrix_basis),M=k.rC;g.subtract(b.f32(q.tail_local),b.f32(q.head_local),M);b.IO(M,t,M);n.from_mat4(x,k.ij);n.from_mat4(B,k.ys);n.copy(k.ij,k.lp)}for(e=0;e<d.length;e++){x=d[e].name;B=b.keysearch("name",x,l);k=h[x];q=B.parent_recursive;k.hq.push(k);for(t=0;t<q.length;t++)B=q[t],B=B.name,B=h[B],k.hq.push(B);q.length?(B=q[0],B=B.name,B=h[B],k.Jv=B,n.invert(B.ij,
m),n.multiply(m,k.ij,k.kp),B.dz.push(k)):n.copy(k.ij,k.kp);k.fi=e;k.name=x;n.multiply(k.kp,k.ys,k.Vw)}c.k.be=h};a.get_bone_tsr=function(a,b,c,e,g){var y=a.k,A=y.ie;b=y.be[b];var r=b.fi;a=b.ij;var x=y.Ed,k=y.Sd,t=y.Bd,y=y.Qd,M=x[4*r+1],u=x[4*r+2],v=x[4*r+3],z=k[4*r+1],S=k[4*r+2],C=k[4*r+3];B[0]=(1-A)*x[4*r]+A*k[4*r];B[1]=(1-A)*M+A*z;B[2]=(1-A)*u+A*S;B[3]=(1-A)*v+A*C;d[0]=t[4*r];d[1]=t[4*r+1];d[2]=t[4*r+2];d[3]=t[4*r+3];l[0]=y[4*r];l[1]=y[4*r+1];l[2]=y[4*r+2];l[3]=y[4*r+3];h.slerp(d,l,A,d);A=m;n.set_transcale(B,
A);n.set_quat(d,A);c?(c=q,n.translate(a,b.rC,c),n.multiply(A,c,A)):n.multiply(A,a,A);if(e){if(e=b.Jv)c=q,n.invert(e.lp,c),n.multiply(c,A,A);e=q;n.invert(b.kp,e);n.multiply(e,A,A)}n.copy(A,g)};a.set_bone_tsr=function(a,b,d,l){var h=a.k;b=h.be[b];var g=h.Ed,m=h.Bd;l?n.multiply(b.kp,d,b.Vw):n.copy(d,b.lp);c(b,l,g,m);h.ie=0;e(a)};a.nO=e;a.VN=c;a.wn=function(a,b){return b in a.k.be}};b4w.module.__boundings=function(a,p){function e(){return{max_x:0,min_x:0,max_y:0,min_y:0,max_z:0,min_z:0}}function c(a,b){b.min_x=a.min_x;b.max_x=a.max_x;b.min_y=a.min_y;b.max_y=a.max_y;b.min_z=a.min_z;b.max_z=a.max_z;return b}function b(a,b){for(var c=a[0],d=a[1],f=a[2],l=a[0],t=a[1],k=a[2],h=3;h<a.length;h+=3)var e=a[h],g=a[h+1],L=a[h+2],c=Math.max(c,e),d=Math.max(d,g),f=Math.max(f,L),l=Math.min(l,e),t=Math.min(t,g),k=Math.min(k,L);b.max_x=c;b.max_y=d;b.max_z=f;b.min_x=l;b.min_y=t;b.min_z=k;return b}
function n(a,b){b||(b=new Float32Array(24));var c=a.max_x,d=a.max_y,f=a.max_z,l=a.min_x,t=a.min_y,k=a.min_z;b[0]=l;b[1]=t;b[2]=k;b[3]=c;b[4]=t;b[5]=k;b[6]=c;b[7]=d;b[8]=k;b[9]=l;b[10]=d;b[11]=k;b[12]=l;b[13]=t;b[14]=f;b[15]=c;b[16]=t;b[17]=f;b[18]=c;b[19]=d;b[20]=f;b[21]=l;b[22]=d;b[23]=f;return b}function h(){return{J:new Float32Array(3),Za:0}}function r(){return{rd:new Float32Array(3),sd:new Float32Array(3),td:new Float32Array(3),J:new Float32Array(3)}}function g(a){var b=r();f.copy(a.rd,b.rd);
f.copy(a.sd,b.sd);f.copy(a.td,b.td);f.copy(a.J,b.J);return b}function m(a,b,c,d){return{rd:new Float32Array(a),sd:new Float32Array(b),td:new Float32Array(c),J:new Float32Array([d[0],d[1],d[2]])}}function q(a,b){var c=H.lG(a,G),c=b?H.hG(a,c,k):D.identity(k),c=H.QI(c,x);f.copy(a,E);f.transformMat3(E,c,E);for(var d=E[0],l=d,h=E[1],e=h,g=E[2],B=g,q=0,w=0,L=0,P=0,n=0,U=0,ga=3;ga<a.length;ga+=3)E[0]=a[ga],E[1]=a[ga+1],E[2]=a[ga+2],f.transformMat3(E,c,E),q=E[0],w=E[1],L=E[2],q>d&&(d=q),q<l&&(l=q),w>h&&(h=
w),w<e&&(e=w),L>g&&(g=L),L<B&&(B=L);h-=e;g-=B;d=Math.max(d-l,1E-9);h=Math.max(h,1E-9);g=Math.max(g,1E-9);l=D.identity(k);l[0]=0!=d?1/d:1E8;l[4]=0!=h?1/h:1E8;l[8]=0!=g?1/g:1E8;D.transpose(c,t);E[0]=a[0];E[1]=a[1];E[2]=a[2];f.transformMat3(E,c,E);f.transformMat3(E,l,E);f.transformMat3(E,t,E);q=E[0];w=E[0];L=E[1];P=E[1];n=E[2];U=E[2];for(ga=3;ga<a.length;ga+=3)E[0]=a[ga],E[1]=a[ga+1],E[2]=a[ga+2],f.transformMat3(E,c,E),f.transformMat3(E,l,E),f.transformMat3(E,t,E),q=Math.max(q,E[0]),w=Math.min(w,E[0]),
L=Math.max(L,E[1]),P=Math.min(P,E[1]),n=Math.max(n,E[2]),U=Math.min(U,E[2]);ga=Math.sqrt((q-w)*(q-w)+(L-P)*(L-P)+(n-U)*(n-U))/2;ga=Math.min(ga,1);A[0]=(q+w)/2;A[1]=(L+P)/2;A[2]=(n+U)/2;q=A;l=D.identity(k);l[0]=d;l[4]=h;l[8]=g;f.transformMat3(q,c,q);f.transformMat3(q,l,q);f.transformMat3(q,t,q);l=[c[0],c[3],c[6]];w=[c[1],c[4],c[7]];c=[c[2],c[5],c[8]];f.scale(l,d*ga,l);f.scale(w,h*ga,w);f.scale(c,g*ga,c);return m(l,w,c,q)}function B(a,b,c){f.add(b,c,a.J);f.scale(a.J,.5,a.J);a.Za=f.distance(a.J,b);return a}
var d=p("__tsr"),l=p("__util"),f=p("__vec3"),H=p("__math"),D=p("__mat3");p("__quat");var w=new Float32Array(24),E=new Float32Array(3),y=new Float32Array(3),A=new Float32Array(3),G=new Float32Array(3),x=new Float32Array(9),k=new Float32Array(9),t=new Float32Array(9);new Float32Array(9);a.Wc=e;a.oi=c;a.NP=function(){return{max_x:1E12,min_x:-1E12,max_y:1E12,min_y:-1E12,max_z:1E12,min_z:-1E12}};a.ZO=function(a){a.max_x=0;a.min_x=0;a.max_y=0;a.min_y=0;a.max_z=0;a.min_z=0};a.ii=function(a){var b=e();c(a,
b);return b};a.iG=function(a){var b=a.max_x-a.min_x,c=a.max_y-a.min_y;c<b&&(b=c);a=a.max_z-a.min_z;a<b&&(b=a);return b};a.Yn=function(a,b){var c=a.max_y,d=a.max_z,f=a.min_x,l=a.min_y,t=a.min_z;a.max_x=Math.max(b.max_x,a.max_x);a.max_y=Math.max(b.max_y,c);a.max_z=Math.max(b.max_z,d);a.min_x=Math.min(b.min_x,f);a.min_y=Math.min(b.min_y,l);a.min_z=Math.min(b.min_z,t)};a.WF=b;a.fh=function(a,c,f){f||(f=e());a=n(a,w);d.transform_vectors(a,c,a);return b(a,f)};a.Zn=n;a.BR=function(a,b,c){c||(c=e());var d=
b.min_x,f=b.max_x,l=b.min_y,t=b.max_y,k=b.min_z;b=b.max_z;if(d>=a.max_x||f<=a.min_x||l>=a.max_y||t<=a.min_y||k>=a.max_z||b<=a.min_z)return c.min_x=-.1,c.max_x=.1,c.min_y=-.1,c.max_y=.1,c.min_z=-.2,c.max_z=-.1,c;c.min_x=Math.max(a.min_x,d);c.max_x=Math.min(a.max_x,f);c.min_y=Math.max(a.min_y,l);c.max_y=Math.min(a.max_y,t);c.min_z=Math.max(a.min_z,k);c.max_z=Math.min(a.max_z,b);return c};a.HR=function(a,b,c){c||(c=e());var d=a.max_x-a.min_x,f=a.max_y-a.min_y,l=a.max_z-a.min_z;c.min_x=a.min_x-.5*(b-
1)*d;c.max_x=a.max_x+.5*(b-1)*d;c.min_y=a.min_y-.5*(b-1)*f;c.max_y=a.max_y+.5*(b-1)*f;c.min_z=a.min_z-.5*(b-1)*l;c.max_z=a.max_z+.5*(b-1)*l;return c};a.At=function(a,b,c){c||(c=h());d.transform_vec3(a.J,b,c.J);c.Za=a.Za*d.get_scale(b)};a.pl=function(a,b,c){c||(c=r());d.transform_vec3(a.J,b,c.J);f.copy(a.rd,c.rd);f.copy(a.sd,c.sd);f.copy(a.td,c.td);d.transform_dir_vec3(c.rd,b,c.rd);d.transform_dir_vec3(c.sd,b,c.sd);d.transform_dir_vec3(c.td,b,c.td);return c};a.cq=function(a,b){var c=h();f.copy(b,c.J);
c.Za=a;return c};a.Vt=h;a.lq=function(a,b){b.J[0]=a.J[0];b.J[1]=a.J[1];b.J[2]=a.J[2];b.Za=a.Za};a.kf=r;a.ji=g;a.nn=m;a.YF=function(){var a;a||(a=h());f.set(0,0,0,a.J);a.Za=1E12;return a};a.GI=function(a,b){var c=f.subtract(b.J,a.J,f.create());0==f.length(c)&&f.set(1,0,0,c);var d=f.normalize(c,f.create()),c=f.scale(d,a.Za,f.create());f.add(c,a.J,c);var l=f.scale(d,-a.Za,f.create());f.add(l,a.J,l);var t=f.scale(d,b.Za,f.create());f.add(t,b.J,t);var k=f.scale(d,-b.Za,f.create());f.add(k,b.J,k);c=[c,
l,t,k];d=f.normalize(d,f.create());l=c[0];t=c[0];for(k=1;k<c.length;k++){var h=f.dot(c[k],d);h<f.dot(l,d)&&(l=c[k]);h>f.dot(t,d)&&(t=c[k])}d=[l,t];c=d[0];d=d[1];a.J=f.scale(f.add(c,d,f.create()),.5,f.create());a.Za=f.length(f.subtract(d,c,f.create()))/2};a.oq=q;a.Ct=function(a,b){var c=g(a),l=d.cc(b,G);f.subtract(c.J,l,c.J);return c};a.xy=function(a,b){var c=f.length(a.rd),d=f.length(a.sd),l=f.length(a.td);return b.Za*b.Za*b.Za<2*c*d*l};a.ay=function(a,b){var c=b.max_y,d=b.min_y,f=Math.max(0,c-d-
2*a);return{Za:a,height:f,J:new Float32Array([0,(c+d)/2,0])}};a.cy=function(a,b){var c=b.max_y,d=b.min_y,f=Math.max(0,c-d);return{Za:a,height:f,J:new Float32Array([0,(c+d)/2,0])}};a.by=function(a,b){var c=b.max_y,d=b.min_y,f=Math.max(0,c-d);return{Za:a,height:f,J:new Float32Array([0,(c+d)/2,0])}};a.QP=function(a,b){return a.min_x>b.max_x||a.max_x<b.min_x?!1:a.min_y>b.max_y||a.max_y<b.min_y?!1:a.min_z>b.max_z||a.max_z<b.min_z?!1:!0};a.KL=function(a){for(var b=0,c=0,d=0,f=0,l=0,t=0,k=0,h=0,e=0,g=0,
L=0,x=0,m=0,U=0,B=0;B<a.submeshes.length;B++){var n=a.submeshes[B];if(n.position.length){b=f=n.position[0];c=l=n.position[1];d=t=n.position[2];break}}for(B=0;B<a.submeshes.length;B++){for(var n=a.submeshes[B],A=n.position,k=g=n.position[0],h=L=n.position[1],e=x=n.position[2],O=0;O<A.length/3;O++)var Q=A[3*O],Z=A[3*O+1],ma=A[3*O+2],b=Math.max(Q,b),c=Math.max(Z,c),d=Math.max(ma,d),f=Math.min(Q,f),l=Math.min(Z,l),t=Math.min(ma,t),k=Math.max(Q,k),h=Math.max(Z,h),e=Math.max(ma,e),g=Math.min(Q,g),L=Math.min(Z,
L),x=Math.min(ma,x),m=Math.max(Math.sqrt(Q*Q+Z*Z+ma*ma),m),U=Math.max(Math.sqrt(Q*Q+ma*ma),U);A=n.boundings.bounding_box;A.max_x=k;A.min_x=g;A.max_y=h;A.min_y=L;A.max_z=e;A.min_z=x;A=w;A[0]=g;A[1]=L;A[2]=x;A[3]=k;A[4]=L;A[5]=x;A[6]=k;A[7]=h;A[8]=x;A[9]=g;A[10]=h;A[11]=x;A[12]=g;A[13]=L;A[14]=e;A[15]=k;A[16]=L;A[17]=e;A[18]=k;A[19]=h;A[20]=e;A[21]=g;A[22]=h;A[23]=e;k=q(A,!1);n.boundings.bounding_ellipsoid_center=k.J;n.boundings.bounding_ellipsoid_axes=[k.rd[0],k.sd[1],k.td[2]]}a.b4w_bounding_box.max_x=
b;a.b4w_bounding_box.min_x=f;a.b4w_bounding_box.max_y=c;a.b4w_bounding_box.min_y=l;a.b4w_bounding_box.max_z=d;a.b4w_bounding_box.min_z=t;a.b4w_bounding_box_source.max_x=b;a.b4w_bounding_box_source.min_x=f;a.b4w_bounding_box_source.max_y=c;a.b4w_bounding_box_source.min_y=l;a.b4w_bounding_box_source.max_z=d;a.b4w_bounding_box_source.min_z=t;a.b4w_bounding_sphere_radius=m;a.b4w_bounding_cylinder_radius=U;A=w;A[0]=f;A[1]=l;A[2]=t;A[3]=b;A[4]=l;A[5]=t;A[6]=b;A[7]=c;A[8]=t;A[9]=f;A[10]=c;A[11]=t;A[12]=
f;A[13]=l;A[14]=d;A[15]=b;A[16]=l;A[17]=d;A[18]=b;A[19]=c;A[20]=d;A[21]=f;A[22]=c;A[23]=d;k=q(A,!1);a.b4w_bounding_ellipsoid_center=k.J;a.b4w_bounding_ellipsoid_axes=[k.rd[0],k.sd[1],k.td[2]]};a.FJ=function(a){var b=a.subarray(0,3),c=a.subarray(6,9),d=a.subarray(12,15),k=a.subarray(18,21);a=f.subtract(c,b,E);f.normalize(a,a);var t=l.OJ(b,c,d,y),t=f.cross(t,a,t);f.normalize(t,t);var e=f.create(),g=f.create();f.subtract(c,b,A);g[0]=f.dot(A,a);g[1]=f.dot(A,t);c=f.create();f.subtract(d,b,A);c[0]=f.dot(A,
a);c[1]=f.dot(A,t);d=f.create();f.subtract(k,b,A);d[0]=f.dot(A,a);d[1]=f.dot(A,t);k=h();d=[e,g,c,d];e=B(k,d[0],d[1]);for(k=2;k<d.length;k++)if(f.distance(e.J,d[k])>e.Za){for(var x=e,e=d,g=d[k],c=k-1,x=B(x,g,e[0]),m=1;m<=c;m++)if(f.distance(x.J,e[m])>x.Za){for(var q=x,x=e,L=g,w=e[m],n=m-1,q=B(q,L,w),U=0;U<=n;U++)if(f.distance(q.J,x[U])>q.Za){var ga=L,T=w,r=x[U],O=f.subtract(T,r,A),O=f.squaredLength(O),Q=f.subtract(ga,r,A),Z=f.squaredLength(Q),Q=f.subtract(ga,T,A),ma=f.squaredLength(Q),Q=O*(Z+ma-O),
D=Z*(ma+O-Z),O=ma*(O+Z-ma),Z=Q+D+O;f.copy(ga,q.J);f.scale(q.J,Q/Z,q.J);f.scaleAndAdd(q.J,T,D/Z,q.J);f.scaleAndAdd(q.J,r,O/Z,q.J);q.Za=f.distance(q.J,ga)}x=q}e=x}k=e;a=f.scale(a,k.J[0],A);f.scaleAndAdd(a,t,k.J[1],a);f.add(a,b,k.J);return k}};b4w.module.__compat=function(a,p){function e(a){return-1<navigator.userAgent.indexOf(a)?!0:!1}function c(){return navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)}function b(){return!window.ActiveXObject&&"ActiveXObject"in window}var n=p("__config"),h=p("__debug"),r=p("__extensions"),
g=p("__print"),m=p("__renderer"),q="R600;RV610;RV630;RV620;RV635;RV670;RS780;RS880;RV770;RV730;RV710;RV740;CEDAR;REDWOOD;JUNIPER;CYPRESS;PALM (Wrestler/Ontario);SUMO (Llano);SUMO2 (Llano);ARUBA (Trinity/Richland);BARTS;TURKS;CAICOS;CAYMAN".split(";");a.Bx=256;var B=n.zj,d=n.v,l=n.context,f=n.mi,H=n.Kk,D=n.L,w=n.A;a.oI=function(a){a.getError()==a.INVALID_ENUM&&g.warn("Possible Tegra invalid enum issue detected, ignoring")};a.yM=function(E){f.$K=E.getParameter(E.MAX_COMBINED_TEXTURE_IMAGE_UNITS);f.iv=
E.getParameter(E.MAX_FRAGMENT_UNIFORM_VECTORS);f.KA=E.getParameter(E.MAX_TEXTURE_IMAGE_UNITS);f.mv=E.getParameter(E.MAX_VARYING_VECTORS);f.LA=E.getParameter(E.MAX_VERTEX_ATTRIBS);f.MA=E.getParameter(E.MAX_VERTEX_TEXTURE_IMAGE_UNITS);f.nv=E.getParameter(E.MAX_VERTEX_UNIFORM_VECTORS);f.Ei=E.getParameter(E.MAX_CUBE_MAP_TEXTURE_SIZE);f.jv=E.getParameter(E.MAX_RENDERBUFFER_SIZE);f.ec=E.getParameter(E.MAX_TEXTURE_SIZE);f.ov=E.getParameter(E.MAX_VIEWPORT_DIMS);d.pc?(d.xc=Math.min(d.xc,E.getParameter(E.MAX_SAMPLES)),
e("Firefox")&&(g.warn("Firefox and WebGL 2 detected, applying framebuffer hack"),d.yy=!0)):d.xc=1;e("Firefox")&&"NONE"!==d.stereo&&(g.warn("Firefox and Stereo rendering detected, disable texture reusage"),d.oz=!0);if(d.pc&&h.DG()||e("Firefox"))g.warn("Firefox detected, disabling multisample"),d.xc=1;m.qM();var y=Boolean(r.AJ());e("Firefox/28.0")&&(e("Linux")||e("Macintosh"))&&(g.warn("Firefox 28 detected, applying depth hack"),y=!1);e("Windows Phone")||(e("iPad")||e("iPhone")?(g.warn("iOS detected, applying alpha hack, applying vertex animation mix normals hack, disable smaa. Disable ssao for performance. Initialize WebAudio context with empty sound. Applying glow hack."),
l.alpha||(d.background_color[3]=1),d.EB=!0,d.XC=!0,d.smaa=!1,d.ssao=!1,d.precision="highp",d.Su=!0,H.sl=256):e("Mac OS X")&&e("Safari")&&!e("Chrome")&&(g.warn("OS X / Safari detected, force to wait complete loading. Applying playback rate hack for video textures. Applying canvas alpha hack."),d.DB=!0,D.Yx=!0,D.Ey=!0));e("Windows")&&(e("Chrome/40")||e("Firefox/33")||e("Firefox/34")||e("Firefox/35")||e("Firefox/36"))&&(g.warn("Windows/Chrome40 or Firefox33-36 detected. Applying clear procedural skydome hack."),
d.Lt=!0);e("Chrome")&&!c()&&n.hA()&&(g.warn('Chrome (non-mobile) was detected for a single HTML-exported file. "Background Music" speakers were changed to "Background Sound".'),d.Dy=!0);e("Mac OS X")&&(d.vr=!0,g.warn("OS X detected, applying shadows hack."));c()&&(g.warn("Mobile detected, applying various hacks for video textures."),d.is_mobile_device=!0,e("iPad")||e("iPhone")||e("Windows Phone")||(g.warn("Mobile (not iOS) detected, disable playback rate for video textures."),D.fz=!0));(e("Firefox/35.0")||
e("Firefox/36.0"))&&e("Windows")&&(g.warn("Windows/Firefox 35/36 detected, applying shadows slink hack"),d.TB=!0);if(e("iPhone")||b()||e("Edge"))g.warn("iPhone, IE11 or Edge detected. Enable sequential video fallback for video textures."),d.Yo=!0;10>f.mv&&(g.warn("Not enough varyings, disable shadows on blend objects"),d.mu=!0);e("Windows Phone")&&(g.warn("Windows Phone detected. Disable debug view mode, glow materials, ssao, smaa, shadows, reflections, refractions."),d.debug_view=!1,d.precision=
"highp",d.sh=!1,d.ssao=!1,d.smaa=!1,d.shadows=!1,d.reflections=!1,d.refractions=!1,d.tB=!1);if(e("UCBrowser")||e("Firefox")&&d.is_mobile_device)g.warn("Mobile Firefox or UCBrowser detected, disable workers."),w.sp=!1;var A=r.get_renderer_info();if(A){var G=E.getParameter(A.UNMASKED_VENDOR_WEBGL),A=E.getParameter(A.UNMASKED_RENDERER_WEBGL),x=/\b4\d{2}\b/;e("Macintosh")&&-1<A.indexOf("Intel HD Graphics 3000")&&(g.warn("OS X / Intel HD 3000 detected, applying depth hack"),y=!1);-1<G.indexOf("ARM")&&
x.test(A)&&(g.warn("ARM Mali-400 series detected, applying depth and frames blending hacks"),y=!1,B.wz=!0);-1<G.indexOf("ARM")&&-1<A.indexOf("Mali-T604")&&(g.warn('ARM Mali-T604 detected, set "highp" precision and disable shadows.'),d.precision="highp",d.shadows=!1);-1<G.indexOf("ARM")&&-1<A.indexOf("Mali-T760")&&(g.warn('ARM Mali-T760 detected, set "highp" precision and disable SSAO.'),d.precision="highp",d.ssao=!1,d.ms=!0,d.pc&&(d.xc=1,g.warn("ARM Mali-T760 and WebGL 2 detected, switch MSAA samples to 1.")));
-1<G.indexOf("Qualcomm")&&-1<A.indexOf("Adreno")&&(g.warn("Qualcomm Adreno detected, applying shader constants hack."),d.PB=!0,-1<A.indexOf("305")&&(g.warn('Qualcomm Adreno305 detected, set "highp" precision.'),d.precision="highp"),-1<A.indexOf("330")&&(g.warn('Qualcomm Adreno330 detected, set "highp" precision.'),d.precision="highp"),-1<A.indexOf("420")&&(g.warn("Qualcomm Adreno420 detected, setting max cubemap size to 4096, setting max texture size to 4096."),f.ec=4096,f.Ei=4096));-1<G.indexOf("NVIDIA")&&
-1<A.indexOf("Tegra 3")&&(g.warn("NVIDIA Tegra 3 detected, force low quality for B4W_LEVELS_OF_QUALITY nodes."),d.wu=!0);e("Windows")&&e("Chrome")&&!e("Edge")&&(A.match(/NVIDIA GeForce 8..0/)||A.match(/NVIDIA GeForce 9..0/)||A.match(/NVIDIA GeForce( (G|GT|GTS|GTX))? 2../))&&(g.warn("Chrome / Windows / NVIDIA GeForce 8/9/200 series detected, setting max cubemap size to 256, use canvas for resizing."),f.Ei=a.Bx,d.aw=!0);-1<A.indexOf("PowerVR")&&(g.warn("PowerVR series detected, use canvas for resizing. Set sky cubemap texture size to 256 (power of two). Disable shadows. Apply skinning hack, disable skin blending between frames."),
d.aw=!0,H.sl=256,d.ms=!0,d.shadows=!1);G="";for(x=0;x<q.length;x++)if(-1<A.indexOf(q[x])){G=q[x];break}G&&(g.warn("Architecture "+G+" detected. Blending between frames and shadows on blend objects will be disabled."),d.ms=!0,d.mu=!0)}0==f.MA&&(g.warn("Vertex textures are not allowed. Disabling vertex textures"),d.Tp=!1);y||(d.Dl=!1,d.kc=!1,d.water_dynamic=!1,d.shore_smoothing=!1,d.mm=!1,d.smaa=!1);d.PC=Boolean(r.Tz());d.xq=y;if(E.getShaderPrecisionFormat)var k=E.getShaderPrecisionFormat(E.FRAGMENT_SHADER,
E.HIGH_FLOAT);E.getShaderPrecisionFormat&&0!==k.precision||(d.precision="mediump");b()&&(g.warn("IE11 detected. Set sky cubemap texture size to 512 (power of two)."),H.sl=512);if(b()&&e("Touch")||e("Edge"))g.warn("IE11 and touchscreen or Edge detected. Behaviour of the mouse move sensor will be changed."),d.$q=!0;128>=f.iv&&(g.warn("Not enough fragment uniforms, force low quality for B4W_LEVELS_OF_QUALITY nodes."),d.wu=!0);e("Chrome")&&!e("Edge")&&g.log("Chrome detected. Some of deprecated functions related to the Doppler effect won't be called.");
c()&&e("Firefox")&&(g.log("Mobile firefox detected. Applying autoplay media hack.Setting max cubemap size to 4096, setting max texture size to 4096."),d.qv=!0,f.ec=4096,f.Ei=4096);e("Edge")&&(g.warn("Microsoft Edge detected, set up new minimal texture size."),d.Vn=!0)};a.Jt=e;a.detect_mobile=c;a.GF=function(){e("Firefox/35.0")&&e("Windows")&&(g.warn("Windows/Firefox 35 detected, forcing context's alpha"),n.context.alpha=!0)};a.is_ie11=b};b4w.module.__constraints=function(a,p){function e(a){var b={};b.type=a;return b}function c(a,c){a.Ib&&a.Ib.ra&&b(a.Ib.ra,a);if(c.ra){var d=c.ra;-1==d.ee.indexOf(a)?d.ee.push(a):H.q("Descendant object override is forbidden")}a.Ib=c}function b(a,b){var c=a.ee.indexOf(b);-1!=c?a.ee.splice(c,1):H.q("No descendant object")}function n(a,b,c){switch(b.type){case 1:var d=f.get_quat_view(a.k.m),h=b.ra.k.m;c=f.get_quat_view(b.ra.k.m);b.Cd?(l.copy(b.Cd,d),l.multiply(c,d,d)):l.copy(c,d);var e=f.transform_vec3(b.offset,
h,y);f.set_trans(e,a.k.m);e=f.get_scale(b.ra.k.m);f.set_scale(b.Vo*e,a.k.m);break;case 9:e=f.get_trans_view(a.k.m);d=f.get_quat_view(a.k.m);h=b.ra.k.m;c=f.get_quat_view(b.ra.k.m);l.multiply(l.invert(b.Ek,b.Ek),d,d);l.multiply(c,d,d);f.transform_vec3(b.offset,h,e);l.copy(c,b.Ek);break;case 10:e=f.get_trans_view(a.k.m);d=f.get_quat_view(a.k.m);h=b.ra.k.m;c=f.get_quat_view(b.ra.k.m);l.multiply(l.invert(b.Ek,b.Ek),d,d);l.multiply(c,d,d);f.transform_vec3(b.offset,h,e);l.copy(c,b.Ek);e=f.get_quat_view(a.k.m);
d=f.get_quat_view(b.ra.k.m);d=l.multiply(d,b.Cd,k);d=q.Kz(d,w);e=q.Kz(e,E);q.rotate_eye_camera(a,H.Ij(e[0],d[0]+b.LG,d[0]+b.KG),H.Ij(e[1],d[1]+b.JG,d[1]+b.MG));break;case 13:var e=f.get_trans_view(a.k.m),d=f.get_quat_view(a.k.m),h=b.ra.k.m,x=f.get_trans_view(h),n=b.dN,L=y,P=k;f.transform_vec3(b.offset,h,L);H.smooth_v(L,e,c,n,e);h=y;D.sub(x,e,h);D.normalize(h,h);var A=d,e=t,x=e.subarray(0,3),L=e.subarray(3,6),U=e.subarray(6,9);D.copy(h,L);D.negate(L,L);D.normalize(L,L);Boolean(.999999<Math.abs(D.dot(h,
H.AXIS_Y)))?(h=B.fromQuat(l.normalize(A,P),M),D.copy(h.subarray(0,3),x)):D.cross(H.AXIS_Y,L,x);D.normalize(x,x);D.cross(x,L,U);D.normalize(U,U);l.fromMat3(e,P);l.normalize(P,P);H.ZB(P,d,c,.16*n,d);break;case 2:d=f.get_quat_view(a.k.m);c=u;m.get_bone_tsr(b.ra,b.Gj,!0,!1,c);f.multiply(b.ra.k.m,c,c);d[0]=c[4];d[1]=c[5];d[2]=c[6];d[3]=c[7];b.Cd&&(l.copy(b.Cd,d),l.multiply(d,b.Cd,d));f.set_scale(b.Vo*c[3],a.k.m);e=f.get_trans_view(a.k.m);f.transform_vec3(b.offset,c,e);break;case 3:e=f.get_trans_view(a.k.m);
d=f.get_quat_view(a.k.m);c=f.get_trans_view(b.ra.k.m);r(e,d,c);break;case 4:e=f.get_trans_view(a.k.m);d=f.get_quat_view(a.k.m);c=b.target;r(e,d,c);break;case 5:e=f.get_trans_view(a.k.m);d=f.get_quat_view(a.k.m);c=f.get_trans_view(b.ra.k.m);r(e,d,c);d=D.dist(e,c);if(d=d>b.dist_max?d-b.dist_max:d<b.Qn?d-b.Qn:0)D.sub(c,e,y),D.normalize(y,y),D.scale(y,d,y),D.add(e,y,e);break;case 6:e=f.get_trans_view(a.k.m);d=f.get_quat_view(a.k.m);c=b.target;r(e,d,c);d=D.dist(e,c);if(d=d>b.dist_max?d-b.dist_max:d<b.Qn?
d-b.Qn:0)D.sub(c,e,y),D.normalize(y,y),D.scale(y,d,y),D.add(e,y,e);break;case 7:h=b.ra.k.m;e=f.get_trans_view(a.k.m);f.transform_vec3(b.offset,h,e);break;case 8:x=f.get_trans_view(b.ra.k.m);e=f.get_trans_view(a.k.m);D.add(x,b.offset,e);break;case 14:d=f.get_quat_view(a.k.m);h=b.ra.k.m;c=f.get_quat_view(b.ra.k.m);b.Cd?(l.copy(b.Cd,d),l.multiply(c,d,d)):l.copy(c,d);e=f.get_trans_view(a.k.m);f.transform_vec3(b.offset,h,e);break;case 11:f.multiply(b.ra.k.m,b.As,a.k.m);break;case 12:e=b.As;c=u;m.get_bone_tsr(b.ra,
b.Gj,!0,!1,c);f.multiply(b.ra.k.m,c,c);f.multiply(c,e,a.k.m);break;case 15:d=b.ra,c=q.DJ(d),e=f.get_trans_view(a.k.m),h=q.Hl(c,"LEFT"),x=q.Hl(c,"RIGHT"),n=q.Hl(c,"TOP"),P=q.Hl(c,"BOTTOM"),L="heights"==b.hor_units?n-P:x-h,b.zA?(h=q.Hl(c,"LEFT"),e[0]=h+L*b.$u):(x=q.Hl(c,"RIGHT"),e[0]=x-L*b.$u),h="heights"==b.vert_units?n-P:x-h,e[2]=b.zC?-(n-h*b.Mw):-(P+h*b.Mw),q.qK(c)?e[1]=-b.distance:(e[1]=-1,D.normalize(e,e),D.scale(e,b.distance/Math.abs(e[1]),e)),f.transform_dir_vec3(e,d.k.m,e),c=f.get_trans_view(d.k.m),
D.add(c,e,e),e=f.get_quat_view(a.k.m),d=f.get_quat_view(d.k.m),b.Cd?(l.copy(b.Cd,e),l.multiply(d,e,e)):l.copy(d,e)}"CAMERA"==a.k.type&&(e=a.k.xe,10==b.type&&(c=f.get_quat_view(b.ra.k.m),e=D.transformQuat(e,c,v)),q.Yw(a),g(a,e))}function h(a,b){switch(b.type){case 1:var c=b.target.k.m,d=u;f.invert(a.k.m,d);f.multiply(d,c,d);m.set_bone_tsr(a,b.Gj,d,!1)}a.Av=!0}function r(a,b,c){var d=y;H.quat_to_dir(b,H.AXIS_MY,d);D.normalize(d,d);var f=A;D.subtract(c,a,f);D.normalize(f,f);a=H.CB(d,f,x);l.multiply(a,
b,b);l.normalize(b,b)}function g(a,b,c){var d=a.k,e=f.get_quat_view(d.m),t=H.quat_to_dir(e,H.AXIS_Y,y);D.normalize(t,t);if(.999999<Math.abs(D.dot(b,t)))t=l.identity(k);else{var h=D.cross(b,t,A);D.normalize(h,h);d.nb==q.MS_TARGET_CONTROLS?d.Dm&&D.negate(h,h):(d=H.quat_to_dir(e,H.AXIS_Z,G),0<D.dot(d,b)&&D.negate(h,h));d=H.quat_to_dir(e,H.AXIS_X,G);D.normalize(d,d);var v=H.clamp(D.dot(d,h),-1,1),t=-.999999>=v?l.setAxisAngle(t,Math.acos(v),k):l.rotationTo(d,h,k);l.normalize(t,t)}l.multiply(t,e,e);c&&
(c=H.quat_to_dir(e,H.AXIS_MZ,y),0>D.dot(b,c)&&l.rotateY(e,Math.PI,e));q.Yw(a)}var m=p("__armature"),q=p("__camera"),B=p("__mat3"),d=p("__print"),l=p("__quat"),f=p("__tsr"),H=p("__util"),D=p("__vec3");a.kP=1;a.jP=2;a.oP=3;a.pP=4;a.eP=5;a.fP=6;a.lP=7;a.dP=8;a.iP=9;a.hP=10;a.bP=11;a.cP=12;a.gP=13;a.mP=14;a.nP=15;a.aP=1;var w=new Float32Array(2),E=new Float32Array(2),y=new Float32Array(3),A=new Float32Array(3),G=new Float32Array(3),x=new Float32Array(4),k=new Float32Array(4),t=new Float32Array(9),M=new Float32Array(9),
u=f.create(),v=new Float32Array(3);a.Tx=function(a,b,d,f,l){var t=e(1);t.ra=b;t.offset=new Float32Array(d);t.Cd=f?new Float32Array(f):null;t.Vo=l;c(a,t);n(a,t,0)};a.wF=function(a,b,d,f,l,t){var k=e(2);k.ra=b;k.Gj=d;k.offset=new Float32Array(f);k.Cd=l?new Float32Array(l):null;k.Vo=t;c(a,k);n(a,k,0)};a.uF=function(a,b,d,t){var k=e(9),h=f.get_quat_view(a.k.m),v=f.get_quat_view(b.k.m);k.ra=b;k.offset=new Float32Array(d);k.Ek=new Float32Array(v);t&&(l.copy(t,h),l.multiply(v,h,h));c(a,k);n(a,k,0)};a.tF=
function(a,b,d,k,t,h,v,g){var L=e(10),x=f.get_quat_view(a.k.m),m=f.get_quat_view(b.k.m);L.ra=b;L.offset=new Float32Array(d);L.Ek=new Float32Array(m);L.KG=H.angle_wrap_0_2pi(t);L.LG=H.angle_wrap_0_2pi(h);L.MG=H.angle_wrap_periodic(v,-Math.PI,Math.PI);L.JG=H.angle_wrap_periodic(g,-Math.PI,Math.PI);k?(L.Cd=new Float32Array(k),l.copy(k,x),l.multiply(m,x,x)):L.Cd=l.create();c(a,L);n(a,L,0)};a.sF=function(a,b,d,f){var l=e(13);l.ra=b;l.offset=new Float32Array(d);l.dN=f;c(a,l);n(a,l,0)};a.zF=function(a,b,
d,f){var l=e(14);l.ra=b;l.offset=new Float32Array(d);l.Vo=1;l.Cd=f?new Float32Array(f):null;c(a,l);n(a,l,0)};a.tR=b;a.CF=function(a,b){var d=e(3);d.ra=b;c(a,d);n(a,d,0)};a.DF=function(a,b){var d=e(4);d.target=new Float32Array(b);c(a,d);n(a,d,0)};a.oF=function(a,b,d,f){var l=e(5);l.ra=b;l.Qn=d;l.dist_max=f;c(a,l);n(a,l,0)};a.pF=function(a,b,d,f){var l=e(6);l.target=new Float32Array(b);l.Qn=d;l.dist_max=f;c(a,l);n(a,l,0)};a.yF=function(a,b,d){var f=e(7);f.ra=b;f.offset=new Float32Array(d);c(a,f);n(a,
f,0)};a.mF=function(a,b,d){var f=e(8);f.ra=b;f.offset=new Float32Array(d);c(a,f);n(a,f,0)};a.kF=function(a,b,d){var f=e(11);f.ra=b;f.As=new Float32Array(d);c(a,f);n(a,f,0)};a.lF=function(a,b,d,f){var l=e(12);l.ra=b;l.Gj=d;l.As=new Float32Array(f);c(a,l);n(a,l,0)};a.append_stiff_viewport=function(a,b,f){var l=e(15);l.ra=b;if(H.sf(f.left))l.zA=!0,l.$u=f.left;else if(H.sf(f.right))l.zA=!1,l.$u=f.right;else{d.error("append_stiff_viewport: Wrong positioning params");return}if(H.sf(f.top))l.zC=!0,l.Mw=
f.top;else if(H.sf(f.bottom))l.zC=!1,l.Mw=f.bottom;else{d.error("append_stiff_viewport: Wrong positioning params");return}H.sf(f.distance)?(l.distance=f.distance,l.Cd=H.sf(f.rotation)?new Float32Array(f.rotation):null,l.hor_units=H.sf(f.hor_units)?f.hor_units:"widths",l.vert_units=H.sf(f.vert_units)?f.vert_units:"heights",c(a,l),n(a,l,0)):d.error("append_stiff_viewport: Wrong positioning params")};a.$N=function(a,b){a.Ib&&n(a,a.Ib,b)};a.xF=function(a,b,c,d,f){var l=e(1);l.Gj=c;l.target=b;l.offset=
new Float32Array(d);l.Cd=f?new Float32Array(f):null;l.Vo=1;b=l.target;c=l.Gj;d=a.k.be[c];f=b.St;for(var k=0;k<f;k++){var t=f[k];if(t[0]==a&&t[1]==c){f.splice(k,1);break}}b.St.push([a,c]);d.Ib=l;h(a,l)};a.UN=function(a,b){var c=a.k.be[b];c.Ib&&h(a,c.Ib)};a.cM=r;a.correct_up=g;a.xG=function(a){return a.Ib?!0:!1};a.remove=function(a){a.Ib.ra&&b(a.Ib.ra,a);a.Ib=null};a.KQ=function(a){return a.Ib?a.Ib.type:null};a.qf=function(a){a=a.Ib;return!a||11!=a.type&&12!=a.type?!1:!0};a.Kq=function(a){if((a=a.Ib)&&
11==a.type)return a.ra.k.m;if(a&&12==a.type){var b=u;m.get_bone_tsr(a.ra,a.Gj,!0,!1,b);f.multiply(a.ra.k.m,b,b);return b}return null};a.pf=function(a){a=a.Ib;return!a||11!=a.type&&12!=a.type?null:a.As}};b4w.module.__container=function(a,p){var e,c,b,n,h;function r(a,b){e=a;c=b}function g(){var a=t.getBoundingClientRect();r(a.left,a.top)}function m(){return G.allow_hidpi&&2<=window.devicePixelRatio?!0:!1}function q(b,c,d){if(!b||!c){b=a.Ys;c=a.Xs;var e=u;e.style.width=a.Ys+"px";e.style.height=a.Xs+"px"}var e=t,h=M;!1!==d&&(e.style.width=b+"px",e.style.height=c+"px",h&&(h.style.width=b+"px",h.style.height=c+"px"));h&&(h.width=b,h.height=c,f.np());d=Math.floor(b*G.canvas_resolution_factor);c=Math.floor(c*
G.canvas_resolution_factor);m()&&(d*=window.devicePixelRatio,c*=window.devicePixelRatio);if(h=w.ik())h=h.p,d=Math.floor(d*h.re),c=Math.floor(c*h.re);e.width=d;e.height=c;var h=Math.min(k.drawingBufferWidth,x.jv,x.ov[0]),v=Math.min(k.drawingBufferHeight,x.jv,x.ov[1]);if(d>h||c>v)D.warn("Canvas size exceeds platform limits, downscaling"),h=Math.min(h/d,v/c),d*=h,c*=h,e.width=d,e.height=c;w.NB(d,c,d/b);w.ya()&&y.u(w.get_active().ai);l.dO(e.width,e.height);l.is_primary_loaded()&&(B.update(),w.update(E.get_timeline(),
0),B.OC())}var B=p("__anchors"),d=p("__config"),l=p("__data"),f=p("__hud"),H=p("__input"),D=p("__print"),w=p("__scenes"),E=p("__time"),y=p("__transform"),A=p("__util"),G=d.v,x=d.mi,k=null,t=null,M=null,u=null,v=!1;n=b=0;h=1;e=c=0;a.Ys=320;a.Xs=240;a.Ve=function(a){k=a};a.get_canvas=function(){return t};a.get_canvas_hud=function(){return M};a.get_container=function(){return u};a.init=function(a,b){a&&a.parentNode?(t=a,M=b,u=a.parentNode):A.q("canvas container is not available")};a.insert_to_container=
function(a,b){b=b||"LAST";switch(b){case "FIRST":u.insertBefore(a,u.firstElementChild);break;case "JUST_BEFORE_CANVAS":u.insertBefore(a,t);break;case "JUST_AFTER_CANVAS":t.nextElementSibling?u.insertBefore(a,t.nextElementSibling):u.appendChild(a,t);break;case "LAST":u.appendChild(a,t);break;default:D.error(b+" invalid stack order")}};a.Xz=function(){return b};a.Wz=function(){return n};a.set_canvas_offsets=r;a.update_canvas_offsets=g;a.XM=function(a,c,d){b=a;n=c;h=d;g()};a.force_offsets_updating=function(){v=
!0};a.client_to_canvas_coords=function(a,b,d){d||(d=new Float32Array(2));var f=d;v&&(g(),v=!1);f[0]=a-e;a=d;v&&(g(),v=!1);a[1]=b-c;return d};a.gq=function(a,c,d,f){d||(d=new Float32Array(2));d[0]=a*h;d[1]=c*h;f&&(a=f.width/b,d[0]*=a,d[1]*=a);return d};a.NO=function(a,c,d,f){d||(d=new Float32Array(2));d[0]=a/h;d[1]=c/h;f&&(a=f.width/b,d[0]/=a,d[1]/=a)};a.iA=function(b){return b&&b.parentNode?b.parentNode==u?!0:a.iA(b.parentNode):!1};a.mK=m;a.TI=function(a){var b=document.getElementsByTagName("script");
a=A.Co(a);for(var c=0;c<b.length;c++)if(b[c].src==a)return b[c];return null};a.resize=q;a.resize_to_container=function(a){var b=u,c=t,d=b.clientWidth,b=b.clientHeight;if(a||d!=c.clientWidth||b!=c.clientHeight)(a="HMD"===G.stereo&&H.Yz())&&a.isPresenting||q(d,b,!0)};a.reset=function(){u=M=t=k=null}};b4w.module.__controls=function(a,p){function e(a,b){b||(b=l.get_container());return{type:a,value:0,ka:null,element:b,Fa:!1,key:0,xb:"",qg:!1,Pt:null,Ot:function(){},Nt:null,Iy:function(){},Pg:null,from:new Float32Array(3),to:new Float32Array(3),gA:!1,ar:!1,Po:0,wB:function(){},axis:"",Ze:0,Fm:new Float32Array(3),Yr:new Float32Array(4),threshold:0,uB:new Float32Array(4),Zp:0,Yp:0,BB:0,$p:0,Te:0,repeat:!1,jz:!1,ek:0,callback:function(){}}}function c(a){function b(){return{ni:new Float32Array(2),uk:!0,
obj:null,identifier:-1,jr:!0}}a||(a=l.get_container());for(var c=0;c<S.length;c++){var d=S[c];if(a==d.element)return d}d={element:a,Ql:!0,Nl:!1,kr:!0,sv:0,tv:0,Yl:0,Zl:0,eg:new Float32Array(2),ue:new Float32Array(2),fg:new Float32Array(2),$e:new Float32Array(2),xs:0,Tw:0,AC:0,wd:new Uint8Array(256),Qs:0,Lu:null,Ig:b(),Pk:Array(10),Yu:!1,aA:E.create(),Sq:0,Rq:0,Qq:0,Nu:0,Mu:0,Pq:Infinity,Gv:null,Fv:null,xv:null,rv:null,vv:null,Rw:null,Qw:null,wv:null,uv:null,dR:null,Sw:null,Pw:null,Ow:null,Gh:{}};
for(c=0;10>c;++c)d.Pk[c]=b();d.Gv=function(a){d.Yu||(f.XJ(a,d.aA),d.Yu=!0)};d.Fv=function(a){a=x.copy(a,F);d.Qq=a[0];d.Rq=a[1];d.Sq=a[2];Infinity==d.Pq&&(d.Pq=a[0],d.Mu=a[1],d.Nu=a[2])};d.xv=function(a){d.Qs+=a*k.hL};d.rv=function(a){var b=f.get_device_by_type_element(f.DEVICE_MOUSE,d.element),b=f.get_vector_param(b,f.MOUSE_LOCATION,C);d.sv=b[0];d.tv=b[1];d.Yl=b[0];d.Zl=b[1];d.Nl=!0;d.which=a};d.vv=function(){var a=f.get_device_by_type_element(f.DEVICE_MOUSE,d.element),a=f.get_vector_param(a,f.MOUSE_LOCATION,
C),a=l.client_to_canvas_coords(a[0],a[1],C);d.Ig.uk=!1;d.Ig.ni[0]=a[0];d.Ig.ni[1]=a[1]};d.Rw=function(a){for(var b=0;b<a.length;++b){for(var c=a[b],L=null,f=null,k=0;k<d.Pk.length;k++){var t=d.Pk[k];if(t.identifier==c.identifier){t.jr&&(f=t);break}else!L&&t.jr&&(L=t,L.identifier=c.identifier)}if(c=f||L)L=l.client_to_canvas_coords(a[b].clientX,a[b].clientY,C),c.uk=!1,c.jr=!1,c.ni[0]=L[0],c.ni[1]=L[1]}};d.Qw=function(a){for(var b=0;b<d.Pk.length;++b){for(var c=d.Pk[b],L=!1,f=0;f<a.length;++f)if(a[f].identifier==
c.identifier){L=!0;break}L||(c.uk=!0,c.jr=!0,c.obj=null)}};d.wv=function(){d.Nl=!1};d.uv=function(a){if(!t.$q||d.Nl)d.Yl=a[0],d.Zl=a[1]};d.rA=function(a){2!=d.wd[a]&&(d.wd[a]=1,d.Ql=!1)};d.tA=function(){for(var a=0;a<d.wd.length;a++)0!=d.wd[a]&&(d.wd[a]=3,d.Ql=!1)};d.uA=function(a){1==d.wd[a]?d.wd[a]=0:(d.Ql&=0,d.wd[a]=3)};d.Sw=function(a){d.kr=!1;if(1==a.length)d.eg[0]=a[0].clientX,d.eg[1]=-1,d.fg[0]=a[0].clientY,d.fg[1]=-1;else if(1<a.length){d.xs=d.Tw=q(a);d.eg[0]=a[0].clientX;d.eg[1]=a[1].clientX;
d.fg[0]=a[0].clientY;d.fg[1]=a[1].clientY;var b=a[0];a=a[1];d.AC=Math.atan2(b.clientY-a.clientY,b.clientX-a.clientX)}d.ue.set(d.eg);d.$e.set(d.fg)};d.Pw=function(a){1===a.length?(d.ue[0]=a[0].clientX,d.ue[1]=-1,d.$e[0]=a[0].clientY,d.$e[1]=-1):1<a.length&&(d.ue[0]=a[0].clientX,d.ue[1]=a[1].clientX,d.$e[0]=a[0].clientY,d.$e[1]=a[1].clientY,d.xs=q(a))};d.Ow=function(a){0==a.length&&(d.kr=!0)};S.push(d);return d}function b(a,b){if(b in a.Gh&&0<a.Gh[b])a.Gh[b]+=1;else switch(a.Gh[b]=1,b){case "orientation_quat":var c=
f.get_device_by_type_element(f.DEVICE_GYRO);c&&f.attach_param_cb(c,f.GYRO_ORIENTATION_ANGLES,a.Gv);break;case "orientation_angles":(c=f.get_device_by_type_element(f.DEVICE_GYRO))&&f.attach_param_cb(c,f.GYRO_ORIENTATION_ANGLES,a.Fv);break;case "mouse_wheel":(c=f.get_device_by_type_element(f.DEVICE_MOUSE,a.element))&&f.attach_param_cb(c,f.MOUSE_WHEEL,a.xv);break;case "mouse_down_which":(c=f.get_device_by_type_element(f.DEVICE_MOUSE,a.element))&&f.attach_param_cb(c,f.MOUSE_DOWN_WHICH,a.rv);break;case "mouse_select":(c=
f.get_device_by_type_element(f.DEVICE_MOUSE,a.element))&&f.attach_param_cb(c,f.MOUSE_DOWN_WHICH,a.vv);break;case "touch_select":if(c=f.get_device_by_type_element(f.DEVICE_TOUCH,a.element))f.attach_param_cb(c,f.TOUCH_START,a.Rw),f.attach_param_cb(c,f.TOUCH_END,a.Qw);break;case "mouse_up_which":(c=f.get_device_by_type_element(f.DEVICE_MOUSE,a.element))&&f.attach_param_cb(c,f.MOUSE_UP_WHICH,a.wv);break;case "mouse_location":(c=f.get_device_by_type_element(f.DEVICE_MOUSE,a.element))&&f.attach_param_cb(c,
f.MOUSE_LOCATION,a.uv);break;case "keyboard_downed_keys":if(c=f.get_device_by_type_element(f.DEVICE_KEYBOARD,a.element))f.attach_param_cb(c,f.KEYBOARD_DOWN,a.rA),f.attach_param_cb(c,f.ux,a.tA),f.attach_param_cb(c,f.KEYBOARD_UP,a.uA);break;case "touch_start":(c=f.get_device_by_type_element(f.DEVICE_TOUCH,a.element))&&f.attach_param_cb(c,f.TOUCH_START,a.Sw);break;case "touch_move":(c=f.get_device_by_type_element(f.DEVICE_TOUCH,a.element))&&f.attach_param_cb(c,f.TOUCH_MOVE,a.Pw);break;case "touch_end":(c=
f.get_device_by_type_element(f.DEVICE_TOUCH,a.element))&&f.attach_param_cb(c,f.TOUCH_END,a.Ow)}}function n(a,b){if(!(!b in a.Gh)&&0<a.Gh[b]&&(--a.Gh[b],!a.Gh[b]))switch(b){case "orientation_quat":var c=f.get_device_by_type_element(f.DEVICE_GYRO);c&&f.detach_param_cb(c,f.GYRO_ORIENTATION_QUAT,a.Gv);break;case "orientation_angles":(c=f.get_device_by_type_element(f.DEVICE_GYRO))&&f.detach_param_cb(c,f.GYRO_ORIENTATION_ANGLES,a.Fv);break;case "mouse_wheel":(c=f.get_device_by_type_element(f.DEVICE_MOUSE,
a.element))&&f.detach_param_cb(c,f.MOUSE_WHEEL,a.xv);break;case "mouse_down_which":(c=f.get_device_by_type_element(f.DEVICE_MOUSE,a.element))&&f.detach_param_cb(c,f.MOUSE_DOWN_WHICH,a.rv);break;case "mouse_select":(c=f.get_device_by_type_element(f.DEVICE_MOUSE,a.element))&&f.detach_param_cb(c,f.MOUSE_DOWN_WHICH,a.vv);break;case "touch_select":if(c=f.get_device_by_type_element(f.DEVICE_TOUCH,a.element))f.detach_param_cb(c,f.TOUCH_START,a.Rw),f.detach_param_cb(c,f.TOUCH_END,a.Qw);break;case "mouse_up_which":(c=
f.get_device_by_type_element(f.DEVICE_MOUSE,a.element))&&f.detach_param_cb(c,f.MOUSE_UP_WHICH,a.wv);break;case "mouse_location":(c=f.get_device_by_type_element(f.DEVICE_MOUSE,a.element))&&f.detach_param_cb(c,f.MOUSE_LOCATION,a.uv);break;case "keyboard_downed_keys":if(c=f.get_device_by_type_element(f.DEVICE_KEYBOARD,a.element))f.detach_param_cb(c,f.KEYBOARD_DOWN,a.rA),f.detach_param_cb(c,f.ux,a.tA),f.detach_param_cb(c,f.KEYBOARD_UP,a.uA);break;case "touch_start":(c=f.get_device_by_type_element(f.DEVICE_TOUCH,
a.element))&&f.detach_param_cb(c,f.TOUCH_START,a.Sw);break;case "touch_move":(c=f.get_device_by_type_element(f.DEVICE_TOUCH,a.element))&&f.detach_param_cb(c,f.TOUCH_MOVE,a.Pw);break;case "touch_end":(c=f.get_device_by_type_element(f.DEVICE_TOUCH,a.element))&&f.detach_param_cb(c,f.TOUCH_END,a.Ow)}}function h(a,b){a.value=Number(b)}function r(a){for(var b=a.$i,c=a.iM,d=0;d<b.length;d++)c[d]=b[d].value;return a.TK(c)}function g(a,b){a=a||u;var c=a.cg;if(c){var d=a.Lk;if(b){var f=c[b];if(f){for(var l=
f.$i,k=0;k<l.length;k++){var t=l[k],e;e=v.indexOf(t);e=-1<e?z[e]:[];1==e.length?(m(t),t=v.indexOf(t),-1<t?(v.splice(t,1),z.splice(t,1)):G.q("Sensors cache is corrupted")):1<e.length&&e.splice(e.indexOf(f),1)}delete c[b];k=d.indexOf(f);-1<k?d.splice(k,1):G.q("Incorrect manifolds array");Object.getOwnPropertyNames(c).length||(c=M.indexOf(a),-1<c?M.splice(c,1):D.error("Wrong object"))}}else{d=[];for(b in c)d.push(b);for(k=0;k<d.length;k++)g(a,d[k])}X=!0}}function m(a){switch(a.type){case 90:w.remove_collision_test(a.Pt,
a.xb,a.Ot);a.Fa=!0;break;case 100:w.clear_collision_impulse_test(a.Nt);a.Fa=!0;break;case 110:w.remove_ray_test(a.Po);a.Fa=!0;break;case 140:a.Fa=!0;break;case 20:var b=c(a.element);n(b,"keyboard_downed_keys");a.Fa=!0;break;case 30:b=c(a.element);n(b,"mouse_wheel");a.Fa=!0;break;case 40:b=c(a.element);n(b,"mouse_down_which");n(b,"mouse_up_which");n(b,"mouse_location");a.Fa=!0;break;case 50:b=c(a.element);n(b,"mouse_down_which");n(b,"mouse_up_which");a.Fa=!0;break;case 60:b=c(a.element);n(b,"touch_start");
n(b,"touch_move");n(b,"touch_end");a.Fa=!0;break;case 70:b=c(a.element);n(b,"touch_start");n(b,"touch_move");a.Fa=!0;break;case 75:b=c(a.element);n(b,"touch_start");n(b,"touch_move");a.Fa=!0;break;case 80:b=c(a.element);n(b,"touch_start");n(b,"touch_end");a.Fa=!0;break;case 170:b=c(a.element);n(b,"mouse_select");n(b,"touch_select");n(b,"touch_start");n(b,"touch_end");n(b,"mouse_down_which");n(b,"mouse_up_which");a.Fa=!0;break;case 180:case 190:b=c(a.element);n(b,"orientation_angles");a.Fa=!0;break;
case 200:b=c(a.element);n(b,"orientation_quat");a.Fa=!0;break;case 210:case 220:a.Fa=!0}}function q(a){var b=a[0],c=a[1];a=b.clientX-c.clientX;b=b.clientY-c.clientY;return Math.sqrt(a*a+b*b)}function B(a){return 0==a?f.get_device_by_type_element(f.Ap):1==a?f.get_device_by_type_element(f.Zs):2==a?f.get_device_by_type_element(f.$s):f.get_device_by_type_element(f.at)}var d=p("__config"),l=p("__container"),f=p("__input"),H=p("__objects"),D=p("__print"),w=p("__physics"),E=p("__quat"),y=p("__time"),A=p("__tsr"),
G=p("__util"),x=p("__vec3");p("__vec4");var k=d.controls,t=d.v,M=[],u={},v=[],z=[],S=[],C=new Float32Array(2),W=new Float32Array(2),F=x.create(),K=E.create(),X=!1,N=0;a.CT_POSITIVE=10;a.CT_CONTINUOUS=20;a.CT_TRIGGER=30;a.CT_SHOT=40;a.CT_LEVEL=50;a.CT_CHANGE=60;a.PL_SINGLE_TOUCH_MOVE=0;a.PL_MULTITOUCH_MOVE_ZOOM=1;a.PL_MULTITOUCH_MOVE_PAN=2;a.PL_MULTITOUCH_MOVE_ROTATE=3;a.update=function(b,d){for(var l=0;l<S.length;l++){var k=S[l];k.Ig.uk||(k.Ig.obj=H.pick_object(k.Ig.ni[0],k.Ig.ni[1]),k.Ig.uk=!0,k.Lu=
k.Ig.obj);for(var e=0;10>e;++e){var g=k.Pk[e];g.uk||(g.obj=H.pick_object(g.ni[0],g.ni[1]),g.uk=!0,k.Lu=g.obj)}}for(l=0;l<v.length;l++)if(k=v[l],e=b,g=d)switch(k.type){case 120:var m=k.Pg,O=A.cc(m.k.m,F),m=A.xd(m.k.m,K),Q=x.dist(k.Fm,O),q=k.uB;E.invert(k.Yr,q);E.multiply(m,q,q);E.normalize(q,q);q=Math.abs(2*Math.acos(q[3]));Q/=g;k.Zp=G.smooth(Q,k.Zp,g,.3);k.ka[0]=Q;Q=q/g;k.Yp=G.smooth(Q,k.Yp,g,.3);k.ka[1]=Q;k.Zp>=k.threshold||k.Yp>=k.BB?h(k,1):h(k,0);x.copy(O,k.Fm);E.copy(m,k.Yr);k.Ze=e;break;case 130:m=
k.Pg;O=A.cc(m.k.m,F);m=Math.abs(O[1]-k.Fm[1])/g;k.$p=G.smooth(m,k.$p,g,.3);k.ka=m;k.$p>=k.threshold?h(k,1):h(k,0);x.copy(O,k.Fm);k.Ze=e;break;case 140:!k.Fa&&0<=k.Te&&e-k.Ze>=k.Te&&(h(k,1),k.repeat?k.Ze=e:k.Te=-k.Te);break;case 150:k.Ze||(k.Ze=e);h(k,e-k.Ze);k.Ze=e;break;case 160:h(k,e);break;case 180:e=c(k.element);k.ka[0]=e.Sq-e.Nu;k.ka[1]=e.Rq-e.Mu;k.ka[2]=e.Qq-e.Pq;break;case 190:e=c(k.element);k.ka[0]=e.Sq;k.ka[1]=e.Rq;k.ka[2]=e.Qq;break;case 200:e=c(k.element);E.copy(e.aA,k.ka);break;case 210:e=
f.get_device_by_type_element(f.DEVICE_HMD);f.get_vector_param(e,f.HMD_ORIENTATION_QUAT,k.ka);break;case 220:e=f.get_device_by_type_element(f.DEVICE_HMD);f.get_vector_param(e,f.HMD_POSITION,k.ka);break;case 240:e=B(k.ek);k.value=f.HJ(e,k.key);break;case 250:e=B(k.ek);k.value=f.GJ(e,k.key);break;case 230:h(k,k.callback());break;case 30:e=c(k.element);h(k,e.Qs);break;case 40:e=c(k.element);if(!t.$q||e.Nl)switch(g=e.Yl-e.sv,O=e.Zl-e.tv,k.axis){case "X":h(k,g);k.ka=e.Yl;break;case "Y":h(k,O);k.ka=e.Zl;
break;case "XY":m=Math.sqrt(g*g+O*O),h(k,m),k.ka[0]=e.Yl,k.ka[1]=e.Zl}break;case 50:e=c(k.element);h(k,e.Nl);k.ka=e.which;break;case 170:e=c(k.element);h(k,0);if(k.jz)e.Lu==k.Pg&&h(k,1);else if(e.Nl&&e.Ig.obj==k.Pg)h(k,1);else if(!e.kr)for(g=0;10>g;++g)if(e.Pk[g].obj==k.Pg){h(k,1);break}break;case 20:e=c(k.element);k.ka=e.wd[k.key];1==k.ka||e.wd[0]&&16==k.key?h(k,1):k.ka&&3!=k.ka||h(k,0);break;case 60:e=c(k.element);-1==e.ue[1]&&-1==e.$e[1]?(g=e.ue[0]-e.eg[0],O=e.$e[0]-e.fg[0],m=Math.sqrt(g*g+O*O),
-1!=e.eg[1]&&-1!=e.fg[1]&&(Q=e.ue[0]-e.eg[1],e=e.$e[0]-e.fg[1],q=Math.sqrt(Q*Q+e*e),q<m&&(g=Q,O=e,m=q)),k.ka=a.PL_SINGLE_TOUCH_MOVE):(O=C,O[0]=(e.ue[0]+e.ue[1])/2,O[1]=(e.$e[0]+e.$e[1])/2,m=W,m[0]=(e.eg[0]+e.eg[1])/2,m[1]=(e.fg[0]+e.fg[1])/2,g=O[0]-m[0],O=O[1]-m[1],m=Math.sqrt(g*g+O*O),k.ka=a.PL_MULTITOUCH_MOVE_PAN);switch(k.axis){case "X":h(k,g);break;case "Y":h(k,O);break;case "XY":h(k,m)}break;case 70:e=c(k.element);e=e.xs-e.Tw;k.ka=a.PL_MULTITOUCH_MOVE_ZOOM;h(k,e);break;case 75:e=c(k.element);
-1!=e.ue[1]&&(g=Math.atan2(e.$e[0]-e.$e[1],e.ue[0]-e.ue[1]),k.ka=a.PL_MULTITOUCH_MOVE_ROTATE,h(k,g-e.AC));break;case 80:e=c(k.element),e.kr?h(k,0):h(k,1)}for(l=0;l<M.length;l++)for(g=M[l],k=g.Lk,e=0;e<k.length;e++)if(O=k[e],O.kj!=N){O.kj=N;q=O;m=0;switch(q.type){case a.CT_POSITIVE:m=(Q=r(q))?1:0;break;case a.CT_CONTINUOUS:m=q.uh;(Q=r(q))?(m=1,q.uh=1):1==m?(m=-1,q.uh=-1):m=0;break;case a.CT_TRIGGER:m=q.uh;(Q=r(q))&&-1==m?(m=1,q.uh=1):Q||1!=m?m=0:(m=-1,q.uh=-1);break;case a.CT_SHOT:m=q.uh;(Q=r(q))&&
-1==m?(m=1,q.uh=1):Q||1!=m?m=0:(m=0,q.uh=-1);break;case a.CT_LEVEL:Q=r(q);q.wA!=Q?(m=1,q.wA=Q):m=0;break;case a.CT_CHANGE:for(var Q=q.$i,q=q.xK,w=0;w<Q.length;w++){var n=Q[w].value;m||n==q[w]||(m=1);q[w]=n}break;default:G.q("Wrong sensor manifold type: "+q.type)}if(m&&(Q=g==u?null:g,X=!1,O.callback(Q,O.id,m,O.mG),X)){l=-1;break}}for(l=0;l<M.length;l++)for(g=M[l],k=g.Lk,e=0;e<k.length;e++)for(O=k[e],g=O.$i,O=0;O<g.length;O++)switch(m=g[O],m.type){case 30:h(m,0);break;case 40:h(m,0);break;case 60:h(m,
0);break;case 70:h(m,0);break;case 75:h(m,0);break;case 80:h(m,0);break;case 140:h(m,0)}for(l=0;l<S.length;l++){k=S[l];if(!k.Ql){for(e=0;e<k.wd.length;e++)1==k.wd[e]?k.wd[e]=2:3==k.wd[e]&&(k.wd[e]=0);k.Ql=!0}k.Qs=0;k.sv=k.Yl;k.tv=k.Zl;k.wd[0]=!1;k.eg.set(k.ue);k.fg.set(k.$e);k.Tw=k.xs;k.Nu=k.Sq;k.Mu=k.Rq;k.Pq=k.Qq;k.Yu=!1}N++};a.create_custom_sensor=function(a){var b=e(10);h(b,a);return b};a.create_keyboard_sensor=function(a){var b=e(20,document);b.key=a;b.Fa=!0;return b};a.create_gamepad_btn_sensor=
function(a,b){var c=e(240,document);b=b||f.Oz();c.ek=b;c.key=a;c.Fa=!0;return c};a.create_gamepad_axis_sensor=function(a,b){var c=e(250,document);b=void 0==b?f.Oz():b;c.ek=b;c.key=a;c.Fa=!0;return c};a.create_collision_sensor=function(a,b,c){if(!a||!w.ia(a))return D.error("Wrong collision object"),null;var d=e(90);d.Pt=a;d.xb=b;d.qg=c;d.ka={coll_obj:null,coll_pos:c?new Float32Array(3):null,coll_norm:c?new Float32Array(3):null,coll_dist:0};d.Ot=function(a,b,c,k,f){h(d,a);a=d.ka;a.coll_obj=b;d.qg&&
(a.coll_pos.set(c),a.coll_norm.set(k),a.coll_dist=f)};d.Fa=!0;return d};a.create_collision_impulse_sensor=function(a){if(!a||!a.A)return D.error("Wrong collision impulse object"),null;var b=e(100);b.Nt=a;b.Iy=function(a){h(b,a)};b.Fa=!0;return b};a.create_ray_sensor=function(a,b,c,d,k,f,l){var t=e(110);t.Pg=a;t.from=b;t.to=c;t.xb=d;t.gA=k;t.qg=f;t.ar=l;t.ka={hit_fract:0,obj_hit:null,hit_time:0,hit_pos:new Float32Array(3),hit_norm:new Float32Array(3),Po:0};t.wB=function(a,b,c,d,k,f){t.gA?h(t,-1==b?
0:1):h(t,b);t.ka.hit_fract=b;t.ka.obj_hit=c;t.ka.hit_time=d;t.qg&&(t.ka.hit_pos.set(k),t.ka.hit_norm.set(f))};t.Fa=!0;return t};a.create_mouse_click_sensor=function(a){a=e(50,a);a.Fa=!0;return a};a.create_mouse_wheel_sensor=function(a){a=e(30,a);a.Fa=!0;return a};a.create_mouse_move_sensor=function(a,b){var c=e(40,b);c.axis=a||"XY";c.ka="XY"==c.axis?new Float32Array(2):0;c.Fa=!0;return c};a.create_touch_move_sensor=function(a,b){var c=e(60,b);c.axis=a||"XY";c.ka=0;c.Fa=!0;return c};a.create_touch_zoom_sensor=
function(a){a=e(70,a);a.ka=0;a.Fa=!0;return a};a.create_touch_rotate_sensor=function(a){a=e(75,a);a.ka=0;a.Fa=!0;return a};a.create_touch_click_sensor=function(a){a=e(80,a);a.ka=0;a.Fa=!0;return a};a.create_motion_sensor=function(a,b,c){if(!a)return D.error("Wrong collision object"),null;var d=e(120);d.Pg=a;var k=A.get_trans_view(a.k.m);a=A.get_quat_view(a.k.m);d.uB=new Float32Array(4);d.Fm=new Float32Array(k);d.Yr=new Float32Array(a);d.Zp=0;d.Yp=0;d.threshold=b||.1;d.BB=c||.1;d.Ze=0;d.ka=new Float32Array([0,
0]);return d};a.create_vertical_velocity_sensor=function(a,b){if(!a)return D.error("Wrong collision object"),null;var c=e(130);c.Pg=a;var d=A.get_trans_view(a.k.m),k=A.get_quat_view(a.k.m);c.Fm=new Float32Array(d);c.Yr=new Float32Array(k);c.$p=0;c.threshold=b||1;c.Ze=0;c.ka=0;return c};a.create_timer_sensor=function(a,b){var c=e(140);c.Te=a;c.repeat=b;c.Fa=!0;return c};a.reset_timer_sensor=function(a,b,c,d){a=a||u;a=a.cg;if(!a||!a[b])return D.error("reset_timer_sensor(): wrong object"),null;b=a[b].$i[c];
if(!b)return D.error("reset_timer_sensor(): sensor not found"),null;b.Ze=y.get_timeline();b.Te=d};a.create_elapsed_sensor=function(){var a=e(150);a.Ze=0;return a};a.create_gyro_delta_sensor=function(){var a=e(180,window);a.ka=new Float32Array(3);f.get_device_by_type_element(f.DEVICE_GYRO)?h(a,1):h(a,0);a.Fa=!0;return a};a.create_gyro_angles_sensor=function(){var a=e(190,window);a.ka=new Float32Array(3);f.get_device_by_type_element(f.DEVICE_GYRO)?h(a,1):h(a,0);a.Fa=!0;return a};a.create_gyro_quat_sensor=
function(){var a=e(200,window);a.ka=E.create();f.get_device_by_type_element(f.DEVICE_GYRO)?h(a,1):h(a,0);a.Fa=!0;return a};a.create_hmd_quat_sensor=function(){var a=e(210,window);a.ka=E.create();f.get_device_by_type_element(f.DEVICE_HMD)?h(a,1):h(a,0);a.Fa=!0;return a};a.create_hmd_position_sensor=function(){var a=e(220,window);a.ka=x.create();f.get_device_by_type_element(f.DEVICE_HMD)?h(a,1):h(a,0);a.Fa=!0;return a};a.create_timeline_sensor=function(){return e(160)};a.create_selection_sensor=function(a,
b){var c=e(170);c.Pg=a;c.jz=b;c.Fa=!0;return c};a.create_callback_sensor=function(a,b){var c=e(230);c.callback=a;h(c,b);return c};a.hM=h;a.get_sensor_value=function(a,b,c){a=a||u;a=a.cg;if(!a||!a[b])return D.error("get_sensor_value(): wrong object"),null;b=a[b].$i[c];return b?b.value:(D.error("get_sensor_value(): sensor not found"),null)};a.get_sensor_payload=function(a,b,c){a=a||u;a=a.cg;if(!a||!a[b])return D.error("get_sensor_payload(): wrong object"),null;b=a[b].$i[c];return b?b.ka:(D.error("get_sensor_payload(): sensor not found"),
null)};a.cleanup=function(){M=[];u={};for(var a=0;a<v.length;a++)m(v[a]);v.length=0;z.length=0};a.check_sensor_manifold=function(a,b){a=a||u;if(!a.cg)return!1;if(b&&a.cg[b])return!0;if(!b)for(var c in a.cg)return!0;return!1};a.create_sensor_manifold=function(a,d,k,e,l,t,h){a=a||u;a.Lk=a.Lk||[];a.cg=a.cg||{};var O=a.cg,Q=a.Lk;O[d]&&g(a,d);k={id:d,type:k,$i:e.slice(0),TK:l,iM:Array(e.length),callback:t,mG:h,uh:-1,wA:0,xK:Array(e.length),kj:-1};O[d]=k;Q.push(k);-1==M.indexOf(a)&&M.push(a);e=k.$i;for(a=
0;a<e.length;a++){O=d=e[a];if(O.Fa){switch(O.type){case 90:w.append_collision_test(O.Pt,O.xb,O.Ot,O.qg);break;case 100:w.apply_collision_impulse_test(O.Nt,O.Iy);break;case 110:O.Po=w.append_ray_test(O.Pg,O.from,O.to,O.xb,O.wB,!1,!1,O.qg,O.ar);O.ka.Po=O.Po;break;case 140:O.Ze=y.get_timeline();0>O.Te&&(O.Te=-O.Te);break;case 20:Q=c(O.element);b(Q,"keyboard_downed_keys");break;case 30:Q=c(O.element);b(Q,"mouse_wheel");break;case 40:Q=c(O.element);b(Q,"mouse_down_which");b(Q,"mouse_up_which");b(Q,"mouse_location");
break;case 50:Q=c(O.element);b(Q,"mouse_down_which");b(Q,"mouse_up_which");break;case 60:Q=c(O.element);b(Q,"touch_start");b(Q,"touch_move");b(Q,"touch_end");break;case 70:Q=c(O.element);b(Q,"touch_start");b(Q,"touch_move");break;case 75:Q=c(O.element);b(Q,"touch_start");b(Q,"touch_move");break;case 80:Q=c(O.element);b(Q,"touch_start");b(Q,"touch_end");break;case 170:Q=c(O.element);b(Q,"mouse_select");b(Q,"touch_select");b(Q,"touch_start");b(Q,"touch_end");b(Q,"mouse_down_which");b(Q,"mouse_up_which");
break;case 180:case 190:Q=c(O.element);b(Q,"orientation_angles");break;case 200:Q=c(O.element);b(Q,"orientation_quat");break;case 240:0==O.ek?f.get_device_by_type_element(f.Ap):1==O.ek?f.get_device_by_type_element(f.Zs):2==O.ek?f.get_device_by_type_element(f.$s):f.get_device_by_type_element(f.at)}O.Fa=!1}O=v.indexOf(d);-1==O?(v.push(d),z.push([k])):z[O].push(k)}X=!0};a.Zy=function(a){for(var b=0;b<a.length;b++)if(!a[b])return a[b];return a[a.length-1]};a.$y=function(a){for(var b=0;b<a.length;b++)if(a[b])return a[b];
return a[a.length-1]};a.remove_sensor_manifold=g;a.reset=function(){for(var a=0;a<M.length;a++){var b=M[a],c=b.cg,b=b.Lk,d;for(d in c)delete c[d];b.length=0}for(a=0;a<v.length;a++)m(v[a]);M.length=0;v.length=0;z.length=0};a.debug=function(){D.log(String(M.length)+" objects with manifolds",M);D.log(String(v.length)+" sensors",v);for(var a=[],b=[],c=0;c<v.length;c++){var d=v[c];90==d.type&&a.push(d);110==d.type&&b.push(d)}D.log(String(a.length)+" collision sensors",a);D.log(String(b.length)+" ray sensors",
b)}};b4w.module.__curve=function(a,p){function e(a,b,c,d,e){var f=d.length;e||(e=new Float32Array(f));for(var h=f+a,g=new Float32Array(h),w=1;w<=h-1;w++)g[w-1]=b>=c[w-1]&&b<c[w+1-1]?1:0;for(var n=2;n<=a;n++)for(w=1;w<=h-n;w++)g[w-1]=(0!=g[w-1]?(b-c[w-1])*g[w-1]/(c[w+n-1-1]-c[w-1]):0)+(0!=g[w+1-1]?(c[w+n-1]-b)*g[w+1-1]/(c[w+n-1]-c[w+1-1]):0);b==c[h-1]&&(g[f-1]=1);a=0;for(w=1;w<=f;w++)a+=g[w-1]*d[w-1];for(w=1;w<=f;w++)e[w-1]=0!=a?g[w-1]*d[w-1]/a:0;return e}function c(a){a=a.nr;return a[a.length-1]}function b(a){a=
a.Vy;return a[a.length-1]}function n(a,b,c,d,e,f,g,r){var w=a+(b-a)/2,E=h(w,d,e,f,g)-c;r=r?r:.01;return Math.abs(E)<r?w:0<E?n(a,w,c,d,e,f,g,r):n(w,b,c,d,e,f,g,r)}function h(a,b,c,d,e){var f=1-a;return b*f*f*f+3*c*f*f*a+3*d*f*a*a+e*a*a*a}p("__print");var r=p("__util"),g=p("__vec3");a.zH=function(a){var b={},c=a.data;a=c.splines[0];if(!a||"NURBS"!=a.type||!a.use_endpoint_u)return null;var d=a.order_u;b.Li=d;a=a.points;var l=a.length/5,f=[],h=l+d,l=l+2;f[0]=0;for(var g=2;g<=h;g++)f[g-1]=g>d&&g<l?f[g-
2]+1:f[g-2];b.nr=f;"2D"==c.dimensions?b.zi=!1:"3D"==c.dimensions?b.zi=!0:r.q("Wrong curve dimensions");d=[];f=[];for(c=0;c<a.length;c+=5)d.push(a[c]),d.push(a[c+1]),d.push(a[c+2]),b.zi&&d.push(a[c+3]),f.push(a[c+4]);b.Ut=d;b.ix=f;a=[];for(var c=b.Ut,d=b.zi?4:3,f=b.ix,h=b.nr,l=b.Li,g=c.length/d,w=g+l,n=0,y=h[w-1]/999,A=0;1E3>A;A++){5E-6>h[w-1]-n&&(n=h[w-1]);for(var G=e(l,n,h,f),x=0;x<d;x++)for(var k=a[d*A+x]=0;k<g;k++)a[d*A+x]+=G[k]*c[d*k+x];n+=y}d=b.zi?4:3;f=new Float32Array(1E3);f[0]=0;for(c=1;1E3>
c;c+=1)h=a[(c-1)*d],l=a[(c-1)*d+1],g=a[(c-1)*d+2],w=a[c*d],n=a[c*d+1],y=a[c*d+2],f[c]=f[c-1]+Math.sqrt((w-h)*(w-h)+(n-l)*(n-l)+(y-g)*(y-g));b.Vy=f;return b};a.qN=function(a,b,h){h||(h=[]);var d=b,l=Math.max(d,0);b=l=Math.min(d,c(a));var d=a.Ut,l=a.zi?4:3,f=a.ix,g=a.nr,n=a.Li;a=d.length/l;var w=a+n;5E-6>g[w-1]-b&&(b=g[w-1]);w=new Float32Array(a);e(n,b,g,f,w);for(b=0;b<l;b++)for(f=h[b]=0;f<a;f++)h[b]+=w[f]*d[l*f+b]};a.nN=function(a,b,c){c||(c=[]);var d=a.Ut,e=a.zi?4:3,f=a.ix,h=a.nr,g=a.Li;a=d.length/
e;var w=a+g;5E-6>h[w-1]-b&&(b=h[w-1]);var w=new Float32Array(a),n=b;b=w;var r=f.length;b||(b=new Float32Array(r));var A=new Float32Array(r),G=new Float32Array(r),x=A,k=G;x||(x=new Float32Array(r));k||(k=new Float32Array(r));for(var t=r+g,M=new Float32Array(t),u=new Float32Array(t),v=1;v<=t-1;v++)M[v-1]=n>=h[v-1]&&n<h[v+1-1]?1:0;n==h[t-1]&&(M[r-1]=1);for(var z=2;z<=g;z++)for(v=1;v<=t-z;v++){var p=0!=M[v-1]?M[v-1]/(h[v+z-1-1]-h[v-1]):0,C=0!=M[v+1-1]?-M[v+1-1]/(h[v+z-1]-h[v+1-1]):0,W=0!=u[v-1]?(n-h[v-
1])*u[v-1]/(h[v+z-1-1]-h[v-1]):0,F=0!=u[v+1-1]?(h[v+z-1]-n)*u[v+1-1]/(h[v+z-1]-h[v+1-1]):0;M[v-1]=(0!=M[v-1]?(n-h[v-1])*M[v-1]/(h[v+z-1-1]-h[v-1]):0)+(0!=M[v+1-1]?(h[v+z-1]-n)*M[v+1-1]/(h[v+z-1]-h[v+1-1]):0);u[v-1]=p+C+W+F}for(v=1;v<=r;v++)x[v-1]=M[v-1],k[v-1]=u[v-1];h=0;for(g=1;g<=r;g++)h+=A[g-1]*f[g-1];n=0;for(g=1;g<=r;g++)n+=G[g-1]*f[g-1];for(g=1;g<=r;g++)b[g-1]=0!=h?G[g-1]*f[g-1]/h+A[g-1]*f[g-1]*n/(h*h):0;for(f=0;f<e;f++)for(h=c[f]=0;h<a;h++)c[f]+=w[h]*d[e*h+f]};a.ER=c;a.pN=b;a.oN=function(a,
e){if(0>=e)return 0;var h=c(a);if(e>=b(a))return h;var d=a.Vy,l=r.aq(d,e,0,d.length-1);return h*(l+(e-d[l])/(d[l+1]-d[l]))/1E3};a.qr=function(a,b,c,d,e){return c+(e-d)*(a-c)/(b-d)};a.BA=function(a,b,c){var d=b[0];b=b[1];c=(c[1]-b)/(c[0]-d);return c*a+(b-c*d)};a.dy=function(a,b,c,d,e,f){return h(n(0,1,a,b[0],c[0],d[0],e[0],f),b[1],c[1],d[1],e[1])};a.Ft=function(a,b,c,d,e){var f=new Float32Array(3),h=new Float32Array(3),n=new Float32Array(3),w=new Float32Array(3),r=new Float32Array(3),y=new Float32Array(3);
g.copy(a[1],h);null==b?(g.copy(c[1],n),f[0]=2*h[0]-n[0],f[1]=2*h[1]-n[1]):g.copy(b[1],f);null==c?(g.copy(b[1],f),n[0]=2*h[0]-f[0],n[1]=2*h[1]-f[1]):g.copy(c[1],n);g.subtract(h,f,w);g.subtract(n,h,r);b=g.length(w);c=g.length(r);0==b&&(b=1);0==c&&(c=1);if("AUTO"==d||"AUTO"==e)y[0]=r[0]/c+w[0]/b,y[1]=r[1]/c+w[1]/b,f=2.5614*g.length(y),0!=f&&("AUTO"==d&&g.scaleAndAdd(h,y,-(b/f),a[0]),"AUTO"==e&&g.scaleAndAdd(h,y,c/f,a[2]));"VECTOR"==d&&g.scaleAndAdd(h,w,-1/3,a[0]);"VECTOR"==e&&g.scaleAndAdd(h,r,1/3,a[2])};
a.WG=function(a,b,c,d){var e=[],f=[],h,g,n;e[0]=a[0]-b[0];e[1]=a[1]-b[1];f[0]=d[0]-c[0];f[1]=d[1]-c[1];n=d[0]-a[0];h=Math.abs(e[0]);g=Math.abs(f[0]);0!=h+g&&h+g>n&&(h=n/(h+g),b[0]=a[0]-h*e[0],b[1]=a[1]-h*e[1],c[0]=d[0]-h*f[0],c[1]=d[1]-h*f[1])}};b4w.module.__dds=function(a,p){function e(a,b,c,e){var h=new Uint16Array(4),g=new Uint16Array(c*e),m=0,n=0,q=0,A=n=m=0,r=0,x=0,k=0,t=c/4;e/=4;for(var M=0;M<e;M++)for(var u=0;u<t;u++)q=b+4*(M*t+u),h[0]=a[q],h[1]=a[q+1],m=h[0]&31,n=h[0]&2016,A=h[0]&63488,r=h[1]&31,x=h[1]&2016,k=h[1]&63488,h[2]=5*m+3*r>>3|5*n+3*x>>3&2016|5*A+3*k>>3&63488,h[3]=5*r+3*m>>3|5*x+3*n>>3&2016|5*k+3*A>>3&63488,m=a[q+2],n=4*M*c+4*u,g[n]=h[m&3],g[n+1]=h[m>>2&3],g[n+2]=h[m>>4&3],g[n+3]=h[m>>6&3],n+=c,g[n]=h[m>>8&3],g[n+1]=h[m>>
10&3],g[n+2]=h[m>>12&3],g[n+3]=h[m>>14],m=a[q+3],n+=c,g[n]=h[m&3],g[n+1]=h[m>>2&3],g[n+2]=h[m>>4&3],g[n+3]=h[m>>6&3],n+=c,g[n]=h[m>>8&3],g[n+1]=h[m>>10&3],g[n+2]=h[m>>12&3],g[n+3]=h[m>>14];return g}function c(a,b,c,f){var n=new Int32Array(c,0,31),D,w,p,y,A,G;if(542327876!=n[0])return r.error("Invalid magic number in DDS header"),0;if(!n[20]&4)return r.error("Unsupported format, must contain a FourCC code"),0;D=n[21];switch(D){case g:w=8;p=b?b.COMPRESSED_RGB_S3TC_DXT1_EXT:null;break;case m:w=16;p=
b?b.COMPRESSED_RGBA_S3TC_DXT3_EXT:null;break;case q:w=16;p=b?b.COMPRESSED_RGBA_S3TC_DXT5_EXT:null;break;default:return r.error("Unsupported FourCC code:",h(D)),null}G=1;n[2]&131072&&!1!==f&&(G=Math.max(1,n[7]));y=n[4];A=n[3];n=n[1]+4;if(b)for(D=0;D<G;++D)f=Math.max(4,y)/4*Math.max(4,A)/4*w,b=new Uint8Array(c,n,f),a.compressedTexImage2D(a.TEXTURE_2D,D,p,y,A,0,b),n+=f,y=Math.max(.5*y,1),A=Math.max(.5*A,1);else if(D==g)Math.max(4,y),Math.max(4,A),b=new Uint16Array(c),c=e(b,n/2,y,A),a.texImage2D(a.TEXTURE_2D,
0,a.RGB,y,A,0,a.RGB,a.UNSIGNED_SHORT_5_6_5,c),f&&a.generateMipmap(a.TEXTURE_2D);else return r.error("No manual decoder for",h(D),"and no native support"),0;return G}function b(a,b,e,f,h,g){var m=new XMLHttpRequest;m.open("GET",e,!0);m.responseType="arraybuffer";m.onload=function(){if(200==m.status){a.bindTexture(a.TEXTURE_2D,f);var e=c(a,b,m.response,h);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR);a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,1<e?a.LINEAR_MIPMAP_LINEAR:a.LINEAR)}g&&
g(f)};m.send(null);return f}function n(a){return a.charCodeAt(0)+(a.charCodeAt(1)<<8)+(a.charCodeAt(2)<<16)+(a.charCodeAt(3)<<24)}function h(a){return String.fromCharCode(a&255,a>>8&255,a>>16&255,a>>24&255)}var r=p("__print"),g=n("DXT1"),m=n("DXT3"),q=n("DXT5");a.hQ=e;a.rO=c;a.Zz=function(a){a=new Int32Array(a,0,31);return{width:a[4],height:a[3]}};a.yJ=function(a){var b=1;a=(new Int32Array(a,0,31))[21];switch(a){case g:b=6;break;case m:case q:b=4;break;default:r.error("Unsupported FourCC code:",h(a))}return b};
a.hR=b;a.gR=function(a,c,e,f){var h=a.createTexture();b(a,c,e,h,!0,f);return h}};b4w.module.__debug=function(a,p){function e(a){a=a.split("\n");for(var b=0;b<a.length;b++)a[b]=b+1+" "+a[b];return a=a.join("\n")}function c(){var a=B.Du();if(a){var b=a.createQueryEXT();a.beginQueryEXT(a.TIME_ELAPSED_EXT,b)}else b=performance.now();return b}function b(){var b=M;return b&&b.debug_view_mode==a.DV_RENDER_TIME}function n(a,b,c){var d=B.Du(),k=0;if(d)for(c&&d.endQueryEXT(d.TIME_ELAPSED_EXT),c=0;c<a.length;c++){var e=a[c],f=d.getQueryObjectEXT(e,d.QUERY_RESULT_AVAILABLE_EXT),h=A.getParameter(d.GPU_DISJOINT_EXT);
f&&!h&&(k=d.getQueryObjectEXT(e,d.QUERY_RESULT_EXT)/1E6,b&&(k=w.smooth(k,b,1,10)),a.splice(c,1),c--)}else k=performance.now()-a.pop(),b&&(k=w.smooth(k,b,1,10));return k}function h(a,b){r(a)||w.q("Structure assertion failed: invalid first object value");r(b)||w.q("Structure assertion failed: invalid second object value");g(a,b)||w.q("Structure assertion failed: incompatible types");if(!(null==a||null==b||"object"!=typeof a||w.Xu(a)||a instanceof Array)){for(var c in a)r(a[c])||w.q("Structure assertion failed: invalid value for key in the first object: "+
c),c in b||w.q("Structure assertion failed: missing key in the first object: "+c);for(c in b)r(b[c])||w.q("Structure assertion failed: invalid value for key in the second object: "+c),c in a||w.q("Structure assertion failed: missing key in the second object: "+c),g(a[c],b[c])||w.q("Structure assertion failed: incompatible types for key "+c)}}function r(a){return"undefined"==typeof a?!1:"number"==typeof a&&isNaN(a)?!1:!0}function g(a,b){if(typeof a!=typeof b)return!1;if(null!=a&&null!=b&&"object"==
typeof a){var c=a instanceof Array,d=b instanceof Array;if(c&&!d||!c&&d)return!1;c=w.Xu(a);d=w.Xu(b);if(c&&!d||!c&&d)return!1}return!0}var m=p("__compat"),q=p("__config"),B=p("__extensions"),d=p("__graph"),l=p("__print"),f=p("__subscene"),H=p("__textures"),D=p("__time"),w=p("__util"),E=q.v,y={},A=null,G={},x=[],k=-1,t=-1,M=null,u=null,v=!1;a.DV_NONE=0;a.DV_OPAQUE_WIREFRAME=1;a.DV_TRANSPARENT_WIREFRAME=2;a.DV_FRONT_BACK_VIEW=3;a.DV_BOUNDINGS=4;a.DV_CLUSTERS_VIEW=5;a.DV_BATCHES_VIEW=6;a.DV_RENDER_TIME=
7;a.Ve=function(a){var b="INVALID_ENUM INVALID_VALUE INVALID_OPERATION OUT_OF_MEMORY INVALID_FRAMEBUFFER_OPERATION CONTEXT_LOST_WEBGL".split(" "),c;for(c in b){var d=b[c];d in a&&(y[a[d]]=d)}A=a};a.nM=function(a){M=a};a.zQ=function(){return M};a.It=function(a){if(E.gl_debug){var b=A.getError();b!=A.NO_ERROR&&(b in y?w.q("GL Error: "+b+", gl."+y[b]+" ("+a+")"):w.q("Unknown GL error: "+b+" ("+a+")"))}};a.uG=function(){if(E.gl_debug||E.yy)switch(A.checkFramebufferStatus(A.FRAMEBUFFER)){case A.FRAMEBUFFER_COMPLETE:break;
case A.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:l.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_ATTACHMENT");break;case A.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:l.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT");break;case A.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:l.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_DIMENSIONS");break;case A.FRAMEBUFFER_UNSUPPORTED:l.error("Incomplete framebuffer: FRAMEBUFFER_UNSUPPORTED");break;case A.sP:l.error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MULTISAMPLE");
break;default:l.error("FRAMEBUFFER CHECK FAILED")}};a.yG=function(){if(-1!=k)return k;A.bindFramebuffer(A.FRAMEBUFFER,A.createFramebuffer());var a=H.Jn("DEBUG",H.il);H.resize(a,1,1);A.framebufferTexture2D(A.FRAMEBUFFER,A.DEPTH_ATTACHMENT,a.Ta,a.Wa,0);A.checkFramebufferStatus(A.FRAMEBUFFER)!=A.FRAMEBUFFER_COMPLETE?(k=!0,l.warn("depth-only issue was found")):k=!1;A.bindFramebuffer(A.FRAMEBUFFER,null);return k};a.DG=function(){if(-1!=t)return t;A.bindRenderbuffer(A.RENDERBUFFER,A.createRenderbuffer());
A.renderbufferStorageMultisample(A.RENDERBUFFER,E.xc,A.RGBA8,1,1);var a=A.getRenderbufferParameter(A.RENDERBUFFER,A.RENDERBUFFER_SAMPLES);a!=E.xc?(t=!0,l.warn("multisample issue was found: requested "+E.xc+", got "+a),A.getError()==A.INVALID_OPERATION&&l.warn("the error from multisample issue detected, ignoring")):t=!1;A.bindRenderbuffer(A.RENDERBUFFER,null);return t};a.AG=function(){return m.Jt("Firefox")&&A.getError()==A.OUT_OF_MEMORY?(l.warn("Firefox/old GPUs cubemap issue was found."),!0):!1};
a.EG=function(a,b,c){if(E.gl_debug&&!A.getShaderParameter(a,A.COMPILE_STATUS)){var d=E.Qx&&B.Bu();d&&(c=d.getTranslatedShaderSource(a));c=e(c);l.error("shader compilation failed:\n"+c+"\n"+A.getShaderInfoLog(a)+" ("+b+")");w.q("Engine failed: see above for error messages")}};a.FG=function(a,b,c,d,k,f){if(E.gl_debug&&!A.getProgramParameter(a,A.LINK_STATUS)){var h=E.Qx&&B.Bu();h&&(k=h.getTranslatedShaderSource(c),f=h.getTranslatedShaderSource(d));k=e(k);f=e(f);l.error("shader linking failed:\n"+k+"\n\n\n"+
f+"\n"+A.getProgramInfoLog(a)+" ("+b+")");w.q("Engine failed: see above for error messages")}};a.Yv=function(a){if(E.show_hud_debug_info||a.type==f.Gp)a.nu||a.Sj.push(c())};a.TL=function(a){"MAIN"==a.type&&b()&&a.Sj.push(c())};a.Zv=function(a){if((E.show_hud_debug_info||a.type==f.Gp)&&!a.nu){var b=n(a.Sj,a.Ie,!0);b&&(a.Ie=b)}};a.UL=function(a){if("MAIN"==a.type&&b()){var c=n(a.Sj,a.Ie,!0);c&&(a.Ie=c)}};a.kA=b;a.IL=function(a){var b=n(a.Sj,a.Ie,!1);b&&(a.Ie=b)};a.iQ=function(a){G[a]=a in G?G[a]+1:
1};a.update=function(){for(var a in G)l.log(a,G[a]),G[a]=0};a.fbmsg=function(){for(var a=[performance.now()],b=0;b<arguments.length;b++){var c=arguments[b];if(w.is_vector(c))for(var d=0;d<c.length;d++)a.push(c[d]);else a.push(arguments[b])}x.push(a)};a.msg=function(){for(var a=1,b=0;b<x.length;b++){var c=x[b];c[1]==arguments[0]&&a++}c=[a];for(b=0;b<arguments.length;b++)if(a=arguments[b],w.is_vector(a))for(var d=0;d<a.length;d++)c.push(a[d]);else c.push(arguments[b]);x.push(c)};var z=["color: #3366FF",
"color: #CC33FF","color: #FF3366","color: #33FF66","color: #FFCC33"];a.print_telemetry=function(a){a||(a=1);for(var b=0,c={},d=Math.max(0,performance.now()-1E3*a),k=0;k<x.length;k++){var e=x[k];a=e[0];if(!(a<d)){var f=String(e[1]);c[f]||(c[f]=z[b++%z.length]);a=["%c"+(a/1E3).toFixed(6),c[f],f];for(f=2;f<e.length;f++)a.push(e[f]);l.log.apply(this,a)}}x.splice(0)};a.plot_telemetry=function(a){a||(a=1);for(var b={},c=Math.max(0,performance.now()-1E3*a),d=0;d<x.length;d++){var k=x[d];a=k[0];if(!(a<c))for(var e=
2;e<k.length;e++){var f=String(k[1]);3<k.length&&(f+="_"+String(e-2));b[f]||(b[f]=f+"\n");b[f]+=String(a)+" "+k[e]+"\n"}}a="";for(f in b)a+=b[f]+"\n\n";l.log(a);x.splice(0)};a.RP=function(a){function b(a){return-1<c.indexOf(a)?!0:!1}var c=navigator.userAgent.toLowerCase();switch(a.toLowerCase()){case "chrome":return b("mozilla")&&b("applewebkit")&&b("chrome");case "firefox":return b("mozilla")&&b("gecko")&&b("firefox");case "msie":return b("mozilla")&&b("trident")&&b("msie");case "opera":return b("opera")&&
b("presto");case "safari":return b("mozilla")&&b("applewebkit")&&b("safari")&&!b("chrome");default:return!1}};a.check_finite=function(a){if(w.is_vector(a)){for(var b=0;b<a.length;b++)if(!isFinite(a[b]))return!1;return Boolean(a.length)}return isFinite(a)?!0:!1};a.GP=function(a,b){a.constructor!=b&&w.q("Type assertion failed: value <"+a+"> has type <"+a.constructor+">, required <"+b+">")};a.HP=h;a.IP=function(a){v?h(a,u):v=!0;u=w.An(a)};a.fake_load=function(a,b,c,d,k){(a=a||null)||w.q("Stage load callback is undefined");
b=b||5E3;c=c||0;d=d||100;100<d&&w.q("Max percentage must be less than 100");0>c&&w.q("Min percentage must be greater than 0");c>d&&w.q("Max percentage must be greater than min percentage");var e=D.animate(c,d,b,function(b){b=b.toFixed();a(b);100==b&&(D.clear_animation(e),k&&k())})};a.nR=function(a){return d.jI(a,function(a,b){var c=b.type+"("+b.name+")",d=b.H,c=c+"\n\nINPUTS:";if(d.length)for(var k=0;k<d.length;k++)c+="\n"+d[k].identifier+": ",c=d[k].dc?c+"linked":c+d[k].hb;else c+="\n---";d=b.Qa;
c+="\n\nOUTPUTS:";if(d.length)for(k=0;k<d.length;k++)c+="\n"+d[k].identifier+": ",c=d[k].dc?c+("linked(default "+d[k].hb+")"):c+"not used";else c+="\n---";k="";switch(b.type){case "GEOMETRY_UV":k="\nuv_layer: "+b.data.value;break;case "TEXTURE_COLOR":case "TEXTURE_NORMAL":k="\ntexture: "+b.data.value.name+"\n("+b.data.value.SQ.yg+")"}""==k&&(k="\n---");return c=c+"\n\nDATA:"+k},function(b,c,k){b=d.Na(a,b);c=d.Na(a,c);return b.Qa[k[0]].identifier+"\n==>\n"+c.H[k[1]].identifier})};a.Pz=function(){return A};
a.cleanup=function(){M=null};a.reset=function(){A=null}};b4w.module.__extensions=function(a,p){function e(a){if(a in g)return g[a];var b=r.getExtension(a)||null;g[a]=b;n.log("%cGET EXTENSION","color: #"+(b?"0a0":"a00"),a);return b}function c(a){if(a in g)return g[a];switch(a){case "WEBGL_depth_texture":case "OES_element_index_uint":case "OES_standard_derivatives":var b={};break;case "ANGLE_instanced_arrays":case "OES_vertex_array_object":b=r}g[a]=b;n.log("%cGET EXTENSION (WebGL 2)","color: #"+(b?"0a0":"a00"),a);return b}var b=p("__config"),n=p("__print"),
h=b.v,r=null,g={};a.Ve=function(a){r=a};a.Tz=function(){return e("WEBGL_compressed_texture_s3tc")||e("WEBKIT_WEBGL_compressed_texture_s3tc")||e("MOZ_WEBGL_compressed_texture_s3tc")};a.AJ=function(){return h.pc?c("WEBGL_depth_texture"):e("WEBGL_depth_texture")||e("WEBKIT_WEBGL_depth_texture")||e("MOZ_WEBGL_depth_texture")};a.tJ=function(){return e("EXT_texture_filter_anisotropic")||e("WEBKIT_EXT_texture_filter_anisotropic")||e("MOZ_EXT_texture_filter_anisotropic")};a.Bu=function(){return e("WEBGL_debug_shaders")};
a.get_renderer_info=function(){return e("WEBGL_debug_renderer_info")};a.Nz=function(){return h.pc?c("OES_element_index_uint"):e("OES_element_index_uint")};a.Vz=function(){return h.pc?c("OES_standard_derivatives"):e("OES_standard_derivatives")};a.Du=function(){return e("EXT_disjoint_timer_query")};a.KJ=function(){if(h.pc)return c("ANGLE_instanced_arrays");var a=e("ANGLE_instanced_arrays");return null==a?a:{drawElementsInstanced:function(b,c,d,e,f){a.drawElementsInstancedANGLE(b,c,d,e,f)},vertexAttribDivisor:function(b,
c){a.vertexAttribDivisorANGLE(b,c)},drawArraysInstanced:function(b,c,d,e){a.drawArraysInstancedANGLE(b,c,d,e)}}};a.Ku=function(){if(h.pc)return c("OES_vertex_array_object");var a=e("OES_vertex_array_object");return null==a?a:{bindVertexArray:function(b){a.bindVertexArrayOES(b)},createVertexArray:function(){return a.createVertexArrayOES()},deleteVertexArray:function(b){a.deleteVertexArrayOES(b)},isVertexArray:function(b){return a.isVertexArrayOES(b)}}};a.cleanup=function(){g={}};a.reset=function(){r=
null}};b4w.module.__graph=function(a,p){function e(a,b,d){d||(d=null);c(a,b)?S.q("Graph already has node with given ID"):a.N.push(b,d)}function c(a,b){for(var c=a.N,d=0;d<c.length;d+=2)if(c[d]==b)return!0;return!1}function b(a,b,d,k){k||(k=null);c(a,b)&&c(a,d)?a.Aa.push(b,d,k):S.q("Wrong node IDs")}function n(a,b){c(a,b)||S.q("Node not found");for(var d=a.N,k=0;k<d.length;k+=2)d[k]==b&&(d.splice(k,2),k-=2)}function h(a,b,c,d){M(a,b,c)||S.q("Edge not found");a=a.Aa;for(var k=0,e=0;e<a.length;e+=3)if(a[e]==
b&&a[e+1]==c){if(-1==d)a.splice(e,3);else{if(d==k){a.splice(e,3);break}k++}e-=3}}function r(a){a=a.N;for(var b=-1,c=0;c<a.length;c+=2)b=Math.max(b,a[c]);return++b}function g(a,b){for(var c=a.N,d=0;d<c.length;d+=2)if(c[d+1]==b)return c[d];return-1}function m(a){var b=[],c={};q(a,c);for(var d=a.N,k=0;k<d.length;k+=2)0==x(a,d[k])&&B(a,d[k],c,b);return{N:b,Aa:a.Aa.slice(0)}}function q(a,b){for(var c=a.N,d=0;d<c.length;d+=2)b[c[d]]=!1}function B(a,b,c,d){if(!c[b]){c[b]=!0;for(var e=0;e<G(a,b);e++)B(a,
k(a,b,e),c,d);d.unshift(b,A(a,b))}}function d(a,b,c,e){if(!c[b]){c[b]=!0;if(10==e||30==e)for(var f=0;f<G(a,b);f++){var h=k(a,b,f);d(a,h,c,e)}if(20==e||30==e)for(f=0;f<x(a,b);f++)h=t(a,b,f),d(a,h,c,e)}}function l(a){for(var b=a.Aa,d=0;d<b.length;d+=3){var k=b[d+1];c(a,b[d])&&c(a,k)||(b.splice(d,3),d-=3)}}function f(a){for(var b=[],c=a.N,d=0;d<c.length;d+=2){var k=c[d];G(a,k)||b.push(k)}return b}function H(a){var b=a.N;a=a.Aa;for(var c=[],d=[],k=[],e=0;e<b.length;e++)k[b[2*e]]=e,c.push(e,b[2*e+1]);
for(e=0;e<a.length;e+=3)d.push(k[a[e]],k[a[e+1]],a[e+2]);return{N:c,Aa:d}}function D(a,b,c){if(c.rg==c.Ii){for(var d=0,e=0;d<c.Ii;d++)-1!=c.ih[d]&&(a[e]=d,b[e]=c.ih[d],e++);return!0}if(c.Ii>c.am||c.fj>c.gj||c.Am>c.Cm||c.zm>c.Bm)return!1;for(var e=d=-1,f=!1;!f&&w(c,C,d,e);)if(d=C[0],e=C[1],E(c,d,e)){var h;h=c;f={};f.eo=h.eo;f.fo=h.fo;f.Cv=h.Cv;f.zq=h.zq;f.Ii=h.Ii;f.am=h.am;f.Li=h.Li;f.rg=f.Kr=h.rg;f.zm=h.zm;f.Am=h.Am;f.fj=h.fj;f.Bm=h.Bm;f.Cm=h.Cm;f.gj=h.gj;f.an=-1;f.ih=h.ih;f.Pj=h.Pj;f.kk=h.kk;f.lk=
h.lk;f.Bk=h.Bk;f.Ck=h.Ck;f.ks=h.ks;h.ks[0]+=1;var f=h=f,l=d,g=e,v=f.eo,u=f.fo,m=f.Ii,O=f.am,Q=f.ih,n=f.Pj,q=f.kk,B=f.lk,z=f.Bk,A=f.Ck;y(l<m);y(g<O);y(f.rg<m);y(f.rg<O);m=++f.rg;f.an=l;q[l]||(q[l]=m,f.zm++,z[l]&&f.fj++);z[l]||(z[l]=m,f.Am++,q[l]&&f.fj++);B[g]||(B[g]=m,f.Bm++,A[g]&&f.gj++);A[g]||(A[g]=m,f.Cm++,B[g]&&f.gj++);Q[l]=g;n[g]=l;for(Q=0;Q<x(v,l);Q++)n=t(v,l,Q),q[n]||(q[n]=m,f.zm++,z[n]&&f.fj++);for(Q=0;Q<G(v,l);Q++)n=k(v,l,Q),z[n]||(z[n]=m,f.Am++,q[n]&&f.fj++);for(Q=0;Q<x(u,g);Q++)n=t(u,g,
Q),B[n]||(B[n]=m,f.Bm++,A[n]&&f.gj++);for(Q=0;Q<G(u,g);Q++)n=k(u,g,Q),A[n]||(A[n]=m,f.Cm++,B[n]&&f.gj++);f=D(a,b,h);y(1>=h.rg-h.Kr);y(-1!=h.an);n=h.eo;l=h.fo;g=h.rg;v=h.an;u=h.ih;q=h.Pj;m=h.kk;B=h.lk;O=h.Bk;z=h.Ck;if(h.Kr<g){m[v]==g&&(m[v]=0);for(A=0;A<x(n,v);A++)Q=t(n,v,A),m[Q]==g&&(m[Q]=0);O[v]==g&&(O[v]=0);for(A=0;A<G(n,v);A++)Q=k(n,v,A),O[Q]==g&&(O[Q]=0);n=u[v];B[n]==g&&(B[n]=0);for(A=0;A<x(l,n);A++)Q=t(l,n,A),B[Q]==g&&(B[Q]=0);z[n]==g&&(z[n]=0);for(A=0;A<G(l,n);A++)Q=k(l,n,A),z[Q]==g&&(z[Q]=
0);u[v]=-1;q[n]=-1;h.rg=h.Kr;h.an=-1}}return f}function w(a,b,c,d){-1==c&&(c=0);-1==d?d=0:d++;var k=a.fj,e=a.gj,f=a.Am,h=a.Cm,l=a.zm,t=a.Bm,g=a.rg,v=a.Ii,O=a.am,Q=a.ih,x=a.Pj,n=a.kk,u=a.lk,m=a.Bk,q=a.Ck;if(k>g&&e>g)for(;c<v&&(-1!=Q[c]||0==m[c]||0==n[c]);)c++,d=0;else if(f>g&&h>g)for(;c<v&&(-1!=Q[c]||0==m[c]);)c++,d=0;else if(l>g&&t>g)for(;c<v&&(-1!=Q[c]||0==n[c]);)c++,d=0;else if(0==c&&0!=a.Li){for(n=0;n<v&&-1!=Q[c=a.Li[n]];)n++;n==v&&(c=v)}else for(;c<v&&-1!=Q[c];)c++,d=0;if(k>g&&e>g)for(;d<O&&(-1!=
x[d]||0==q[d]||0==u[d]);)d++;else if(f>g&&h>g)for(;d<O&&(-1!=x[d]||0==q[d]);)d++;else if(l>g&&t>g)for(;d<O&&(-1!=x[d]||0==u[d]);)d++;else for(;d<O&&-1!=x[d];)d++;return c<v&&d<O?(b[0]=c,b[1]=d,!0):!1}function E(a,b,c){var d=a.eo,e=a.fo,f=a.am,h=a.ih,l=a.Pj,g=a.kk,v=a.lk,n=a.Bk,m=a.Ck;y(b<a.Ii);y(c<f);y(-1==h[b]);y(-1==l[c]);if(!(0,a.Cv)(A(d,b),A(e,c)))return!1;for(var O=f=0,Q=0,q=0,w=0,B=0,z=0;z<G(d,b);z++){var r=k(d,b,z);if(-1!=h[r]){var D=h[r];if(!M(e,c,D)||!u(a.zq,d,b,r,e,c,D))return!1}else g[r]&&
Q++,n[r]&&f++,g[r]||n[r]||w++}for(z=0;z<x(d,b);z++)if(r=t(d,b,z),-1!=h[r]){if(D=h[r],!M(e,D,c)||!u(a.zq,d,r,b,e,D,c))return!1}else g[r]&&Q++,n[r]&&f++,g[r]||n[r]||w++;for(z=0;z<G(e,c);z++)if(D=k(e,c,z),-1!=l[D]){if(r=l[D],!M(d,b,r))return!1}else v[D]&&q++,m[D]&&O++,v[D]||m[D]||B++;for(z=0;z<x(e,c);z++)if(D=t(e,c,z),-1!=l[D]){if(r=l[D],!M(d,r,b))return!1}else v[D]&&q++,m[D]&&O++,v[D]||m[D]||B++;return Q<=q&&f<=O&&w<=B}function y(a){a||S.q("Assertion failed")}function A(a,b){for(var c=a.N,d=0;d<c.length;d+=
2)if(c[d]==b)return c[d+1];return null}function G(a,b){for(var c=a.Aa,d=0,k=0;k<c.length;k+=3)c[k]==b&&d++;return d}function x(a,b){for(var c=a.Aa,d=0,k=0;k<c.length;k+=3)c[k+1]==b&&d++;return d}function k(a,b,c){a=a.Aa;for(var d=0,k=0;k<a.length;k+=3)if(a[k]==b){if(d==c)return a[k+1];d++}return-1}function t(a,b,c){a=a.Aa;for(var d=0,k=0;k<a.length;k+=3)if(a[k+1]==b){if(d==c)return a[k];d++}return-1}function M(a,b,c){a=a.Aa;for(var d=0;d<a.length;d+=3)if(a[d]==b&&a[d+1]==c)return!0;return!1}function u(a,
b,c,d,k,e,f){for(var h=v(b,c,d),l=v(k,e,f),t=0;t<h;t++){for(var g=!1,x=0;x<l;x++)if(a(z(b,c,d,t),z(k,e,f,x))){g=!0;break}if(!g)return!1}return!0}function v(a,b,c){var d=0;a=a.Aa;for(var k=0;k<a.length;k+=3)a[k]==b&&a[k+1]==c&&d++;return d}function z(a,b,c,d){a=a.Aa;for(var k=0,e=0;e<a.length;e+=3)if(a[e]==b&&a[e+1]==c){if(k==d)return a[e+2];k++}return null}p("__print");var S=p("__util"),C=[-1,-1];a.ft=-1;a.rP=10;a.zp=20;a.yP=30;a.create=function(){for(var a=arguments,b=[],c=[],d=0;d<a.length;d++){var k=
a[d];switch(k.length){case 2:b.push(k[0],k[1]);break;case 3:c.push(k[0],k[1],k[2]);break;default:S.q("Wrong graph constructor params")}}return{N:b,Aa:c}};a.clone=function(a,b,c){if(b)for(var d=Array(a.N.length),k=0;k<a.N.length;k+=2)d[k]=a.N[k],d[k+1]=b(a.N[k+1]);else d=S.I(a.N);if(c)for(b=Array(a.Aa.length),k=0;k<a.Aa.length;k+=3)b[k]=a.Aa[k],b[k+1]=a.Aa[k+1],b[k+2]=c(a.Aa[k+2]);else b=S.I(a.Aa);return a={N:d,Aa:b}};a.$P=function(a,b){for(var c=[],d=[],k=0;k<a.length;k++)c.push(a[k][0],a[k][1]);
for(k=0;k<b.length;k++)d.push(b[k][0],b[k][1],b[k][2]);return{N:c,Aa:d}};a.ll=e;a.OQ=c;a.qd=b;a.ag=n;a.Yi=h;a.bs=function(a,b,c,d){M(a,b,c)||S.q("Edge not found");a=a.Aa;for(var k=0;k<a.length;k+=3)if(a[k]==b&&a[k+1]==c&&a[k+2][0]==d[0]&&a[k+2][1]==d[1]){a.splice(k,3);break}};a.F=function(a,b){if(-1==g(a,b)){var c=r(a);e(a,c,b);return c}S.q("Non-unique attribute")};a.WL=function(a,b,c,d,k){a=a.Aa;for(var e=0;e<a.length;e+=3)a[e]==b&&a[e+1]==c&&a[e+2]==d&&(a[e+2]=k)};a.AF=function(a,c,d){var k;d=d||
[];k=k||[];for(var f={},h=0;h<a.N.length;h+=2){var l=a.N[h],t=a.N[h+1],g=r(c);e(c,g,t);f[l]=g}for(h=0;h<a.Aa.length;h+=3)t=f[a.Aa[h]],g=f[a.Aa[h+1]],l=a.Aa[h+2],b(c,t,g,l);for(h=0;h<d.length;h+=3)t=f[d[h]],a=d[h+1],l=d[h+2],b(c,t,a,l);for(h=0;h<k.length;h+=3)d=k[h],g=f[k[h+1]],l=k[h+2],b(c,d,g,l)};a.ho=r;a.Uf=g;a.r=function(a,c,d,k){c=g(a,c);d=g(a,d);-1!=c&&-1!=d?b(a,c,d,k):S.q("Attributes not found")};a.ma=function(a,b){for(var c=a.N,d=0;d<c.length&&!b(c[d],c[d+1]);d+=2);};a.gg=function(a,b){for(var c=
a.Aa,d=0;d<c.length&&!b(c[d],c[d+1],c[d+2]);d+=3);};a.Ug=function(a,b,c){for(var d=a.Aa,k=0;k<d.length;k+=3)if(d[k+1]==b){var e=d[k];if(c(e,A(a,e),d[k+2]))break}};a.hj=function(a,b,c){for(var d=a.Aa,k=0;k<d.length;k+=3)if(d[k]==b){var e=d[k+1];if(c(e,A(a,e),d[k+2]))break}};a.Nw=m;a.FN=function(a){a=m(a).N;for(var b=[],c=0;c<a.length;c+=2)b.push(a[c+1]);return b};a.YQ=function(){};a.ss=function(a,b,k){c(a,b)||S.q("No such node");var e={};q(a,e);d(a,b,e,k);b=[];for(var f in e)e[f]&&(f=Number(f),b.push(f,
A(a,f)));a={N:b,Aa:a.Aa.slice(0)};l(a);return a};a.Kt=l;a.QJ=function(a){for(var b=[],c=a.N,d=0;d<c.length;d+=2){var k=c[d];x(a,k)||b.push(k)}return b};a.ko=f;a.match=function(a,b,c,d){var k={};k.eo=H(a);k.fo=H(b);k.Cv=c||function(a,b){return a==b};k.zq=d||function(a,b){return a==b};d=a.N.length/2;var e=b.N.length/2;k.Ii=d;k.am=e;k.Li=0;k.rg=k.Kr=0;k.fj=k.zm=k.Am=0;k.gj=k.Bm=k.Cm=0;k.an=-1;k.ih=Array(d);k.Pj=Array(e);k.kk=Array(d);k.lk=Array(e);k.Bk=Array(d);k.Ck=Array(e);k.ks=[1];for(c=0;c<d;c++)k.ih[c]=
-1,k.kk[c]=0,k.Bk[c]=0;for(c=0;c<e;c++)k.Pj[c]=-1,k.lk[c]=0,k.Ck[c]=0;e=Array(d);d=Array(d);if(D(e,d,k)){for(c=0;c<e.length;c++)e[c]=a.N[2*e[c]],d[c]=b.N[2*d[c]];return[e,d]}return null};a.MJ=function(a,b){for(var c=a.N,d=1;d<c.length;d+=2)if(c[d]==b)return c[d-1];return null};a.Na=A;a.Kg=G;a.br=x;a.Bg=k;a.hk=t;a.AQ=v;a.Ne=z;a.replace=function(a,b,c){for(var d=a.Aa,k=r(a),f=0;f<b.length;f++){var h=b[f];n(a,h);for(var l=0;l<d.length;l+=3)d[l]==h&&(d[l]=k),d[l+1]==h&&(d[l+1]=k),d[l]==d[l+1]&&(d.splice(l,
3),l-=3)}e(a,k,c)};a.LL=function(a,b,c,d,k){M(a,b,c)||S.q("Edge not found");a=a.Aa;for(var e=0;e<a.length;e+=3)a[e]==b&&a[e+1]==c&&(a[e]=d,a[e+1]=k)};a.DI=function(a,b){function c(a,b){if(-1!=t.indexOf(a)){var d=t.slice(t.indexOf(a));if(-1!=k[d[d.length-1]].indexOf(d[0])){g.push([a,d[d.length-1]]);return}}t.push(a);for(d=0;d<b.length;d++)b[d]in k&&c(b[d],k[b[d]])}b||(b=f(a)[0]);var d=a.Aa;if(d.length&&-1!=d.indexOf(b)){for(var k={},e=0,l=0;l<d.length;l+=3)d[l+1]in k?k[d[l+1]].push(d[l]):k[d[l+1]]=
[d[l]],e++;var t=[],g=[];c(b,k[b]);for(l=0;l<g.length;l++)for(var v=e=0;v<d.length;v+=3)g[l][1]==d[v+1]&&g[l][0]==d[v]&&h(a,d[v],d[v+1],e),e++}};a.jI=function(a,b,c){var d=a.N;a=a.Aa;var k;k="digraph debug {\n    node [shape=box];\n";for(var e=0;e<d.length;e+=2){var f=d[e],h=d[e+1],h=b?b(f,h):String(f);k+="    ";k+=String(f)+' [label="'+h.replace(/\"/g,'\\"')+'"];\n'}for(e=0;e<a.length;e+=3)b=a[e],d=a[e+1],h=a[e+2],k+="    ",k+=String(b)+" -> "+String(d),c&&(k+=' [label="'+c(b,d,h)+'"]'),k+=";\n";
return k+="}"}};b4w.module.__ipc=function(a,p){function e(a,b,c){for(var e=0;e<l.length;e+=2)l[e+1]==a&&(d[e+Number(!b)]=c)}function c(a){for(var b=0;b<a.length;b++){var c=a[b],d=0,e;for(e in c){var f=c[e];switch(f.constructor){case Float32Array:d+=f.length;break;case Number:d+=1}}--d;c.len=d}}var b=!0;a.ED=0;var n=a.wD=1,h=a.yD=2;a.xD=3;a.AD=4;a.BD=5;a.CD=6;a.FD=7;var r=a.HD=8,g=a.tx=9,m=a.ID=10;a.JD=11;var q=a.KD=12;a.LD=13;a.GD=14;a.DD=15;a.zD=16;a.uE=100;a.WD=101;a.XD=102;a.YD=103;a.ZD=104;a.aE=105;a.$D=106;
a.bE=107;a.cE=108;a.dE=109;a.eE=110;a.fE=111;a.gE=112;a.iE=113;a.jE=114;a.xE=115;a.kE=116;a.lE=117;a.mE=118;a.oE=119;a.pE=120;a.qE=121;a.sE=122;a.tE=123;a.vE=124;a.hE=125;a.zE=126;a.nE=127;a.Dx=128;a.yE=129;a.AE=130;a.BE=131;a.CE=132;a.DE=133;a.EE=134;a.FE=135;a.GE=136;a.HE=137;a.IE=138;a.JE=139;a.Ex=140;var B=a.Fp=141;a.KE=142;a.Cx=143;a.LE=144;a.ME=145;a.wE=146;a.rE=147;a.NE=148;var d=b4w.worker_listeners,l=b4w.worker_namespaces,f={Re:q,M:0,time:0,trans:new Float32Array(3),quat:new Float32Array(4),
Eg:new Float32Array(3),ng:new Float32Array(3),len:0},H={Re:r,Ht:0,Qv:0,trans:new Float32Array(3),quat:new Float32Array(4),len:0},D={Re:g,id:0,ol:0,hit_fract:0,hit_time:0,len:0},w={Re:m,id:0,ol:0,hit_fract:0,hit_time:0,hit_pos:new Float32Array(3),hit_norm:new Float32Array(3),len:0},E={Re:n,Ej:0,Fj:0,result:0,len:0},y={Re:h,Ej:0,Fj:0,result:0,Lj:new Float32Array(3),coll_norm:new Float32Array(3),coll_dist:0,len:0},A={Re:B,M:0,trans:new Float32Array(3),quat:new Float32Array(4),len:0},G=[f,H,D,w,E,y,A];
a.cI=function(a,c){var f={ir:a?!0:!1,sj:null,pg:[],lf:""};if(c)if(f.sj={addEventListener:function(a,b){"message"!=a&&panic("Wrong web worker event");e(f.lf,f.ir,b)},removeEventListener:function(a){"message"!=a&&panic("Wrong web worker event");e(f.lf,f.ir,null)},postMessage:function(a){var b;a:{for(b=0;b<l.length;b+=2)if(l[b+1]==f.lf){b=d[b+Number(!!f.ir)];break a}b=null}b({data:a})},terminate:function(){for(var a=0;a<l.length;a+=2)if(l[a+1]==f.lf){d.splice(a,2);l.splice(a,2);break}}},f.ir){var h=
p("__util"),g=p("__container"),v=b4w.get_namespace(p),h=h.mp(v+"_worker");l.push(v);l.push(h);d.push(null);d.push(null);f.lf=h;(g=g.TI(a))?b?g.addEventListener("load",function(){b4w.require("__bindings",f.lf)},!1):(b4w.cleanup("__bindings",f.lf),b4w.cleanup("__ipc",f.lf),b4w.require("__bindings",f.lf)):(g=document.createElement("script"),g.src=a,g.defer="defer",g.async="async",g.addEventListener("load",function(){b=!1;b4w.require("__bindings",f.lf)},!1),document.head.appendChild(g))}else f.lf=b4w.get_namespace(p);
else f.sj=a?new Worker(a):self;return f};a.RF=function(a,b){function d(c){if(c.constructor==ArrayBuffer)c=new Float32Array(c);else if(c[0].constructor==ArrayBuffer){for(var e=0;e<c.length;e++)d(c[e]);return}e=c[0]|0;switch(e){case q:var l=f;l.M=c[1]|0;l.time=c[2];l.trans[0]=c[3];l.trans[1]=c[4];l.trans[2]=c[5];l.quat[0]=c[6];l.quat[1]=c[7];l.quat[2]=c[8];l.quat[3]=c[9];l.Eg[0]=c[10];l.Eg[1]=c[11];l.Eg[2]=c[12];l.ng[0]=c[13];l.ng[1]=c[14];l.ng[2]=c[15];break;case r:l=H;l.Ht=c[1]|0;l.Qv=c[2]|0;l.trans[0]=
c[3];l.trans[1]=c[4];l.trans[2]=c[5];l.quat[0]=c[6];l.quat[1]=c[7];l.quat[2]=c[8];l.quat[3]=c[9];break;case g:l=D;l.id=c[1]|0;l.ol=c[2]|0;l.hit_fract=c[3];l.hit_time=c[4];break;case m:l=w;l.id=c[1]|0;l.ol=c[2]|0;l.hit_fract=c[3];l.hit_time=c[4];l.hit_pos[0]=c[5];l.hit_pos[1]=c[6];l.hit_pos[2]=c[7];l.hit_norm[0]=c[8];l.hit_norm[1]=c[9];l.hit_norm[2]=c[10];break;case n:l=E;l.Ej=c[1]|0;l.Fj=c[2]|0;l.result=!!c[3];break;case h:l=y;l.Ej=c[1]|0;l.Fj=c[2]|0;l.result=!!c[3];l.Lj[0]=c[4];l.Lj[1]=c[5];l.Lj[2]=
c[6];l.coll_norm[0]=c[7];l.coll_norm[1]=c[8];l.coll_norm[2]=c[9];l.coll_dist=c[10];break;case B:l=A;l.M=c[1]|0;l.trans[0]=c[2];l.trans[1]=c[3];l.trans[2]=c[4];l.quat[0]=c[5];l.quat[1]=c[6];l.quat[2]=c[7];l.quat[3]=c[8];break;default:l=c}b(a,e,l)}c(G);a.sj.addEventListener("message",function(a){d(a.data)},!1)};a.cleanup=function(){};a.S=function(a,b){if(a)switch(b){case q:var c=f,d=new Float32Array(c.len);d[0]=c.Re;d[1]=c.M;d[2]=c.time;d[3]=c.trans[0];d[4]=c.trans[1];d[5]=c.trans[2];d[6]=c.quat[0];
d[7]=c.quat[1];d[8]=c.quat[2];d[9]=c.quat[3];d[10]=c.Eg[0];d[11]=c.Eg[1];d[12]=c.Eg[2];d[13]=c.ng[0];d[14]=c.ng[1];d[15]=c.ng[2];a.pg.push(d.buffer);break;case r:c=H;d=new Float32Array(c.len);d[0]=c.Re;d[1]=c.Ht;d[2]=c.Qv;d[3]=c.trans[0];d[4]=c.trans[1];d[5]=c.trans[2];d[6]=c.quat[0];d[7]=c.quat[1];d[8]=c.quat[2];d[9]=c.quat[3];a.pg.push(d.buffer);break;case g:c=D;d=new Float32Array(c.len);d[0]=c.Re;d[1]=c.id;d[2]=c.ol;d[3]=c.hit_fract;d[4]=c.hit_time;a.pg.push(d.buffer);break;case m:c=w;d=new Float32Array(c.len);
d[0]=c.Re;d[1]=c.id;d[2]=c.ol;d[3]=c.hit_fract;d[4]=c.hit_time;d[5]=c.hit_pos[0];d[6]=c.hit_pos[1];d[7]=c.hit_pos[2];d[8]=c.hit_norm[0];d[9]=c.hit_norm[1];d[10]=c.hit_norm[2];a.pg.push(d.buffer);break;case n:c=E;d=new Float32Array(c.len);d[0]=c.Re;d[1]=c.Ej;d[2]=c.Fj;d[3]=c.result;a.pg.push(d.buffer);break;case h:c=y;d=new Float32Array(c.len);d[0]=c.Re;d[1]=c.Ej;d[2]=c.Fj;d[3]=c.result;d[4]=c.Lj[0];d[5]=c.Lj[1];d[6]=c.Lj[2];d[7]=c.coll_norm[0];d[8]=c.coll_norm[1];d[9]=c.coll_norm[2];d[10]=c.coll_dist;
a.pg.push(d.buffer);break;case B:c=A;d=new Float32Array(c.len);d[0]=c.Re;d[1]=c.M;d[2]=c.trans[0];d[3]=c.trans[1];d[4]=c.trans[2];d[5]=c.quat[0];d[6]=c.quat[1];d[7]=c.quat[2];d[8]=c.quat[3];a.pg.push(d.buffer);break;default:d=[];for(c=1;c<arguments.length;c++)d.push(arguments[c]);a.sj.postMessage(d)}};a.EL=function(a){a&&a.pg.length&&(a.sj.postMessage(a.pg),a.pg.length=0)};a.Rz=function(a){switch(a){case q:return f;case r:return H;case g:return D;case m:return w;case n:return E;case h:return y;case B:return A;
default:return null}};a.terminate=function(a){a.sj.terminate();a.sj=null};a.er=function(a){return!!a.sj};a.lA=function(a){return!!a.lf}};b4w.module.__hud=function(a,p){function e(a){a.font="bold 15px Courier New";a.textBaseline="middle";a.shadowBlur=0;a.shadowColor=null}function c(a){b(' SCENE "'+a.name+'"');b(" Active                 Subscene   Lamps   Size   RenderCalls   Time");if(a.p){var c=0,d=0,e=0;g.ma(a.p.Oa,function(a,h){if(h.type!=m.hl){for(var l=Math.round(h.o.width)+"x"+Math.round(h.o.height),g=0,n=0;n<h.za.length;n++)g+=h.za[n].ha.length;n=h.Nn;if(h.type==m.Kc||h.type==m.Yd)g*=6;var x=h.sb,k=x?h.Ie:0;h.enqueue||(h.Ie=
0);var t=x?" (\u2713)":" (\u2715)",q=m.Cw(h);b(t,q,h.Ir,l,n,"of",g,"  ",k.toFixed(3));h.Nn=0;x&&(c+=g,d+=n,e+=k)}});return[c,d,e]}b("No INFO")}function b(){for(var a=80+20*d[0],b=arguments[0],c=1;c<arguments.length;c++){for(var e="",h=0;h<q[c]-String(arguments[c]).length;h++)e+=" ";b+=e+arguments[c]}d[0]++;B.fillText(b,30,a)}function n(a,b,c){b*=a.Lb;c.x=a.x+b;c.y=a.y;c.Lb=a.Lb-2*b;c.Bb=a.Bb}function h(a){return a.x+a.Lb/2}function r(a){var b=B,c={x:0,y:0,Lb:0,Bb:0},d=b.canvas.width,b=b.canvas.height;
c.x=0;c.y=0;c.Lb=d;c.Bb=b;n(c,.01,c);d=.02*c.Bb;c.x=c.x;c.y+=d;c.Lb=c.Lb;c.Bb-=2*d;d=c.Lb/8;c.x+=d*a;c.y=c.y;c.Lb=d;c.Bb=c.Bb;n(c,.02,c);return c}var g=p("__graph");p("__print");var m=p("__subscene"),q=[5,30,4,10,5,3,5],B=null,d=[0,0];a.init=function(a){a=a.getContext("2d");e(a);return B=a};a.np=function(){B&&e(B)};a.reset=function(){var a=B;a&&(a.clearRect(0,0,a.canvas.width,a.canvas.height),a.fillStyle="rgba(0,0,0,0.5)",a.fillRect(0,0,a.canvas.width,a.canvas.height),d[0]=0,d[1]=0)};a.$M=function(a,
e){var h=B;if(h){h.textAlign="left";h.fillStyle="rgba(0,255,0,255)";b(" FPS",(1/e).toFixed(2));d[0]++;for(var g=h=0,n=0,m=0;m<a.length;m++){var q=c(a[m]),h=h+q[0],g=g+q[1],n=n+q[2];d[0]++}b(" ----------------------------------------------------------------");b("    ","TOTAL ACTIVE","","",g,"of",h,"  ",n.toFixed(3))}};a.print=function(){var a=B;a&&(a.textAlign="left",a.fillStyle="rgba(0,255,0,255)",b.apply(Math,arguments))};a.plot_array=function(a,b,c,d,e,g,n){var m=B;if(m){b=r(b);var q=b.Bb/5;b.x=
b.x;b.y+=4*q;b.Lb=b.Lb;b.Bb=q;m.textAlign="center";m.fillStyle="#00FF00";B.fillText(a,h(b),b.y-10);m.strokeStyle="#00FF00";m.lineWidth=.5;m.beginPath();m.moveTo(b.x,b.y);m.lineTo(b.x+b.Lb,b.y);m.lineTo(b.x+b.Lb,b.y+b.Bb);m.lineTo(b.x,b.y+b.Bb);m.closePath();m.stroke();if(!g&&!n)for(g=1E6,n=-1E6,a=0;a<c.length;a++)g=Math.min(g,c[a]),n=Math.max(n,c[a]);m.textAlign="right";B.fillText(String(g),b.x-10,b.y+b.Bb);B.fillText(String(n),b.x-10,b.y);m.textAlign="center";B.fillText(String(d),b.x,b.y+b.Bb+15);
B.fillText(String(e),b.x+b.Lb,b.y+b.Bb+15);m.strokeStyle="#FF0000";m.lineWidth=1.5;m.beginPath();d=b.Lb/(c.length-1);n=b.Bb/(n-g);for(a=0;a<c.length;a++)e=b.x+d*a,q=b.y+b.Bb-(c[a]-g)*n,0==a?m.moveTo(e,q):m.lineTo(e,q);m.stroke()}};a.draw_mixer_strip=function(a,b,c,d,e,g,n){var m=B;if(m)for(m.textAlign="center",m.fillStyle="#00FF00",m.font="bold 12px Courier",c=r(c),B.fillText(b?"["+a+"]":a,h(c),c.y),0<=g&&B.fillText(g?"[M]":"[ ]",h(c)-15,c.y+30),0<=n&&B.fillText(n?"[S]":"[ ]",h(c)+15,c.y+30),a={x:0,
y:0,Lb:0,Bb:0},b=0;b<d.length;b++){g=d[b];var q="VOLUME"==g[0];if(q){n=c.y+350;var x=c.Lb,k=a;k.x=c.x;k.y=n;k.Lb=x;k.Bb=250}else{n=c.y+50+50*b;var x=c.Lb,k=c.Bb,t=a;t.x=c.x;t.y=n;t.Lb=x;t.Bb=k}n=m;var x=a,t=b==e,p=g[0],k=g[1],u=g[2],v=g[3],z=(v-u)/g[4],z=1>z?Math.floor(1/z-1E-5).toFixed(0).length:0;g=g[5]?Math.log(k/u)/Math.log(v/u):(k-u)/(v-u);n.textAlign="center";t?n.fillText("["+p+"]",h(x),x.y):n.fillText(p,h(x),x.y);n.strokeStyle="#00FF00";n.lineWidth=q?3:1;q?(n.textAlign="right",n.fillText(v.toFixed(z),
h(x)-10,x.y+15),n.textAlign="right",n.fillText(u.toFixed(z),h(x)-10,x.y+x.Bb-15)):(n.textAlign="right",n.fillText(u.toFixed(z),x.x+28,x.y+15),n.textAlign="left",n.fillText(v.toFixed(z),x.x+x.Lb-28,x.y+15));n.beginPath();if(q){var S=x.y+15+(x.Bb-30)*(1-g);n.moveTo(h(x),x.y+15);n.lineTo(h(x),x.y+x.Bb-15);n.moveTo(h(x)-5,x.y+15);n.lineTo(h(x)+5,x.y+15);n.moveTo(h(x)-5,x.y+x.Bb-15);n.lineTo(h(x)+5,x.y+x.Bb-15);n.moveTo(h(x)-5,S);n.lineTo(h(x)+5,S)}else{var C=x.x+30+(x.Lb-60)*g;n.moveTo(x.x+30,x.y+15);
n.lineTo(x.x+x.Lb-30,x.y+15);n.moveTo(x.x+30,x.y+15-5);n.lineTo(x.x+30,x.y+15+5);n.moveTo(x.x+x.Lb-30,x.y+15-5);n.lineTo(x.x+x.Lb-30,x.y+15+5);n.moveTo(C,x.y+15-5);n.lineTo(C,x.y+15+5)}n.stroke();"EQ_Q"==p?(g=Math.log(1+1/(2*k*k)+Math.sqrt((2+1/(k*k))*(2+1/(k*k))/4-1))/Math.log(2),q?(n.textAlign="left",n.fillText(k.toFixed(z),h(x)+10,S),n.textAlign="left",n.fillText("("+g.toFixed(z+1)+")",h(x)+10,S+10)):(n.textAlign="right",n.fillText(k.toFixed(z),C,x.y+30),n.textAlign="left",n.fillText("("+g.toFixed(z+
1)+")",C,x.y+30))):q?(n.textAlign="left",n.fillText(k.toFixed(z),h(x)+10,S)):(n.textAlign="center",n.fillText(k.toFixed(z),C,x.y+30))}}};b4w.module.__renderer=function(a,p){function e(a){for(var c=a.o,d=a.za,k=null,e=0;e<d.length;e++){var f=d[e];if(f.sb){var g=f.La,f=f.ha;if(g.Ui!=k){x.useProgram(g.Ui);for(var k=a,t=c,n=g,m=n.DC,u=m.length;u--;){var O=m[u];O.Fl(x,O.me,k,t)}if(n.Bo&&!n.Fr)for(n.Lv.length||h(n),n=n.Lv,u=n.length;u--;)O=n[u],O.Fl(x,O.me,k,t);k=g.Ui}for(t=0;t<f.length;t++)if(u=f[t],u.sb){n=u.Jg;u=u.Y;q.TL(u);q.kA()&&"DEBUG_VIEW"==u.type&&(u.Mn=D.smooth(r.TF(u.ul),u.Mn,1,15));for(var O=a,m=u,Q=g,w=Q.EC,B=w.length;B--;){var z=
w[B];z.Fl(x,z.me,n,m)}if(Q.Bo&&!Q.Fr){Q.Jo.length||h(Q);w=Q.Jo;for(B=w.length;B--;)z=w[B],z.Fl(x,z.me,n,m);Q.Bo=!1}x.depthMask(m.Ea);m.wb?x.enable(x.CULL_FACE):x.disable(x.CULL_FACE);B=m.T;z=x;for(w=0;w<B.length;w++){var A=B[w];z.activeTexture(z.TEXTURE0+w);z.bindTexture(A.Ta,A.Wa)}if(O.type==l.Zh){n=O;Q=Q.Qk;B=n.o.Zb.Wa;z=n.Rj;for(w=0;6>w;w++)if(A=b(w),W.Lt?(x.bindTexture(x.TEXTURE_CUBE_MAP,B),x.texImage2D(A,0,x.RGBA,1,1,0,x.RGBA,x.UNSIGNED_BYTE,G)):(x.uniformMatrix4fv(Q.u_cube_view_matrix,!1,z[w]),
x.framebufferTexture2D(x.FRAMEBUFFER,x.COLOR_ATTACHMENT0,A,B,0),v(m,0)),n.Dr&&3!=w){var A=n,y=w,p=C;W.Lt?p.set(G):(x.readPixels(191,191,1,1,x.RGBA,x.UNSIGNED_BYTE,p),255!=p[0]&&255!=p[1]&&255!=p[2]||x.readPixels(191,220,1,1,x.RGBA,x.UNSIGNED_BYTE,p));var M=p[0],ka=p[1],p=p[2],M=M/255,ka=ka/255,p=p/255;2===y?(A.Jd[3]=M,A.Jd[7]=ka,A.Jd[11]=p):2>y?(A.Jd[4*y]=M,A.Jd[4*y+1]=ka,A.Jd[4*y+2]=p):(A.Jd[4*(y-2)]=M,A.Jd[4*(y-2)+1]=ka,A.Jd[4*(y-2)+2]=p)}O.Nn+=6}else v(m,n.Gs),O.Nn++;q.UL(u);q.kA()&&"MAIN"==u.type&&
r.UF(u.id,u.Ie)}}}}function c(a){if(a){var b=(a.Xa?x.COLOR_BUFFER_BIT:0)|(a.ab?x.DEPTH_BUFFER_BIT:0);if(!b)return;switch(a.type){case l.pd:a=A;break;case l.Ac:a=w;break;case l.Be:a=E;break;case l.Xd:case l.Zg:case l.cl:a=y;break;case l.kg:case l.Ym:case l.Hp:a=A;break;default:a=W.background_color}}else b=x.COLOR_BUFFER_BIT|x.DEPTH_BUFFER_BIT,a=W.background_color;x.colorMask(!0,!0,!0,!0);x.depthMask(!0);x.clearColor(a[0],a[1],a[2],a[3]);x.clear(b)}function b(a){switch(a){case 0:return x.TEXTURE_CUBE_MAP_POSITIVE_X;
case 1:return x.TEXTURE_CUBE_MAP_NEGATIVE_X;case 2:return x.TEXTURE_CUBE_MAP_POSITIVE_Y;case 3:return x.TEXTURE_CUBE_MAP_NEGATIVE_Y;case 4:return x.TEXTURE_CUBE_MAP_POSITIVE_Z;case 5:return x.TEXTURE_CUBE_MAP_NEGATIVE_Z}}function n(a){var b=B.Ku(),c=a.jn,d=a.aa,k=d.vb;a.Vd.length=0;var e=1,h;for(h in k)e=Math.max(e,k[h].frames);for(k=0;k<e;k++){h=b.createVertexArray();u(h);x.bindBuffer(x.ARRAY_BUFFER,d.Uh);d.rf&&x.bindBuffer(x.ELEMENT_ARRAY_BUFFER,d.rf);for(var f=0;f<c.length;f++){var l=c[f];x.enableVertexAttribArray(l.me);
x.vertexAttribPointer(l.me,l.Jb,x.FLOAT,!1,l.We,l.$x+l.vz*k);t(l.me,l.wg)}u(null);a.Vd.push(h)}}function h(a){var b=a.Qk,c=a.EC,d=a.Jo,k=a.DC,e=a.Lv;c.length=0;d.length=0;k.length=0;e.length=0;for(var h in b){var f=!1,l=null,g=null;switch(h){case "u_proj_matrix":l=function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.Ya)};f=!0;break;case "u_view_matrix":l=function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.jb)};f=!0;break;case "u_view_tsr":case "u_view_tsr_frag":l=function(a,b,c,d){d.Fb?a.uniformMatrix3fv(b,!1,d.Qo):
a.uniformMatrix3fv(b,!1,d.ye)};f=!0;break;case "u_view_zup_tsr":l=function(a,b,c,d){d.Fb?a.uniformMatrix3fv(b,!1,d.Ro):a.uniformMatrix3fv(b,!1,d.tp)};f=!0;break;case "u_view_zup_tsr_inverse":l=function(a,b,c,d){d.Fb?a.uniformMatrix3fv(b,!1,d.$r):a.uniformMatrix3fv(b,!1,d.Js)};f=!0;break;case "u_shadow_cast_billboard_view_tsr":l=function(a,b,c,d){a.uniformMatrix3fv(b,!1,d.ap)};f=!0;break;case "u_view_proj_prev":l=function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.Pv)};f=!0;break;case "u_view_proj_matrix":l=
function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.Jc)};f=!0;break;case "u_view_proj_inverse":l=function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.Ks)};f=!0;break;case "u_sky_vp_inverse":l=function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.Af)};f=!0;break;case "u_camera_eye":case "u_camera_eye_frag":l=function(a,b,c,d){a.uniform3fv(b,H.cc(d.m,z))};f=!0;break;case "u_camera_quat":l=function(a,b,c,d){a.uniform4fv(b,H.xd(d.m,S))};f=!0;break;case "u_view_max_depth":l=function(a,b,c,d){a.uniform1f(b,d.far)};f=!0;break;case "u_camera_range":l=
function(a,b,c,d){a.uniform2f(b,d.near,d.far)};break;case "u_csm_center_dists":l=function(a,b,c,d){a.uniform4fv(b,d.qq)};break;case "u_height":l=function(a,b,c,d){a.uniform1f(b,d.height)};f=!0;break;case "u_pcf_blur_radii":l=function(a,b,c,d){a.uniform4fv(b,d.gm)};break;case "u_dof_dist":l=function(a,b,c,d){d.dof_on?a.uniform1f(b,d.dof_distance):a.uniform1f(b,0)};f=!0;break;case "u_dof_front_start":l=function(a,b,c,d){a.uniform1f(b,d.Qb)};f=!0;break;case "u_dof_front_end":l=function(a,b,c,d){a.uniform1f(b,
d.Pb)};f=!0;break;case "u_dof_rear_start":l=function(a,b,c,d){a.uniform1f(b,d.Sb)};f=!0;break;case "u_dof_rear_end":l=function(a,b,c,d){a.uniform1f(b,d.Rb)};f=!0;break;case "u_dof_bokeh_intensity":l=function(a,b,c,d){a.uniform1f(b,d.Ua)};f=!0;break;case "u_cam_water_depth":l=function(a,b,c){a.uniform1f(b,c.Gt)};f=!0;break;case "u_waves_height":l=function(a,b,c){a.uniform1f(b,c.fx)};break;case "u_waves_length":l=function(a,b,c){a.uniform1f(b,c.gx)};break;case "u_fog_color_density":l=function(a,b,c){a.uniform4fv(b,
c.Ld)};break;case "u_fog_params":l=function(a,b,c){a.uniform4fv(b,c.nf)};break;case "u_underwater_fog_color_density":l=function(a,b,c){a.uniform4fv(b,c.Xg)};break;case "u_bloom_key":l=function(a,b,c){a.uniform1f(b,c.bloom_key)};break;case "u_bloom_edge_lum":l=function(a,b,c){a.uniform1f(b,c.bloom_edge_lum)};break;case "u_time":l=function(a,b,c){a.uniform1f(b,c.time)};f=!0;break;case "u_wind":l=function(a,b,c){a.uniform3fv(b,c.Vh)};f=!0;break;case "u_sky_tex_dvar":l=function(a,b,c){a.uniform1f(b,c.WB)};
break;case "u_sky_tex_fac":l=function(a,b,c){a.uniform4fv(b,c.XB)};break;case "u_sky_tex_color":l=function(a,b,c){a.uniform3fv(b,c.VB)};break;case "u_horizon_color":l=function(a,b,c){a.uniform3fv(b,c.Oe)};break;case "u_zenith_color":l=function(a,b,c){a.uniform3fv(b,c.cf)};break;case "u_environment_energy":l=function(a,b,c){a.uniform1f(b,c.ph)};break;case "u_sky_color":l=function(a,b,c){a.uniform3fv(b,c.qm)};break;case "u_rayleigh_brightness":l=function(a,b,c){a.uniform1f(b,c.rayleigh_brightness)};
break;case "u_mie_brightness":l=function(a,b,c){a.uniform1f(b,c.mie_brightness)};break;case "u_spot_brightness":l=function(a,b,c){a.uniform1f(b,c.spot_brightness)};break;case "u_scatter_strength":l=function(a,b,c){a.uniform1f(b,c.scatter_strength)};break;case "u_rayleigh_strength":l=function(a,b,c){a.uniform1f(b,c.rayleigh_strength)};break;case "u_mie_strength":l=function(a,b,c){a.uniform1f(b,c.mie_strength)};break;case "u_rayleigh_collection_power":l=function(a,b,c){a.uniform1f(b,c.rayleigh_collection_power)};
break;case "u_mie_collection_power":l=function(a,b,c){a.uniform1f(b,c.mie_collection_power)};break;case "u_mie_distribution":l=function(a,b,c){a.uniform1f(b,c.mie_distribution)};break;case "u_light_positions":l=function(a,b,c){a.uniform3fv(b,c.pr)};break;case "u_light_directions":l=function(a,b,c){a.uniform3fv(b,c.bv)};break;case "u_light_color_intensities":l=function(a,b,c){a.uniform3fv(b,c.or)};break;case "u_light_factors":l=function(a,b,c){a.uniform4fv(b,c.cv)};break;case "u_sun_quaternion":l=
function(a,b,c){a.uniform4fv(b,c.nC)};break;case "u_sun_intensity":l=function(a,b,c){a.uniform3fv(b,c.mC)};break;case "u_sun_direction":l=function(a,b,c){a.uniform3fv(b,c.Dw)};break;case "u_debug_view_mode":l=function(a,b,c){a.uniform1i(b,c.debug_view_mode)};break;case "u_debug_colors_seed":l=function(a,b,c){a.uniform1f(b,c.debug_colors_seed)};break;case "u_debug_render_time_threshold":l=function(a,b,c){a.uniform1f(b,c.Xy)};break;case "u_subpixel_jitter":l=function(a,b,c){a.uniform2fv(b,c.rK)};f=
!0;break;case "u_subsample_indices":l=function(a,b,c){a.uniform4fv(b,c.sK)};f=!0;break;case "u_radial_blur_step":l=function(a,b,c){a.uniform1f(b,c.Zr)};break;case "u_god_rays_intensity":l=function(a,b,c){a.uniform1f(b,c.god_rays_intensity)};break;case "u_ssao_radius_increase":l=function(a,b,c){a.uniform1f(b,c.um)};break;case "u_ssao_blur_discard_value":l=function(a,b,c){a.uniform1f(b,c.ssao_blur_discard_value)};f=!0;break;case "u_ssao_influence":l=function(a,b,c){a.uniform1f(b,c.tm)};break;case "u_ssao_dist_factor":l=
function(a,b,c){a.uniform1f(b,c.sm)};break;case "u_texel_size":l=function(a,b,c){a.uniform2fv(b,c.Kw)};f=!0;break;case "u_normal_offset":l=function(a,b,c){a.uniform1f(b,c.self_shadow_normal_offset)};break;case "u_v_light_ts":l=function(a,b,c){a.uniform4fv(b,c.Fs)};f=!0;break;case "u_v_light_r":l=function(a,b,c){a.uniform4fv(b,c.Es)};f=!0;break;case "u_v_light_tsr":l=function(a,b,c){a.uniformMatrix3fv(b,!1,c.cx)};f=!0;break;case "u_p_light_matrix0":l=function(a,b,c){a.uniformMatrix4fv(b,!1,c.Dk[0])};
f=!0;break;case "u_p_light_matrix1":l=function(a,b,c){a.uniformMatrix4fv(b,!1,c.Dk[1])};f=!0;break;case "u_p_light_matrix2":l=function(a,b,c){a.uniformMatrix4fv(b,!1,c.Dk[2])};f=!0;break;case "u_p_light_matrix3":l=function(a,b,c){a.uniformMatrix4fv(b,!1,c.Dk[3])};f=!0;break;case "u_outline_color":l=function(a,b,c){a.uniform3fv(b,c.Dh)};break;case "u_draw_outline":l=function(a,b,c){a.uniform1f(b,c.pu)};f=!0;break;case "u_glow_mask_small_coeff":l=function(a,b,c){a.uniform1f(b,c.small_glow_mask_coeff)};
f=!0;break;case "u_glow_mask_large_coeff":l=function(a,b,c){a.uniform1f(b,c.large_glow_mask_coeff)};f=!0;break;case "u_brightness":l=function(a,b,c){a.uniform1f(b,c.brightness)};break;case "u_contrast":l=function(a,b,c){a.uniform1f(b,c.contrast)};break;case "u_exposure":l=function(a,b,c){a.uniform1f(b,c.exposure)};break;case "u_saturation":l=function(a,b,c){a.uniform1f(b,c.saturation)};break;case "u_enable_hmd_stereo":l=function(a,b,c){a.uniform1i(b,c.enable_hmd_stereo)};break;case "u_distortion_params":l=
function(a,b,c){a.uniform4fv(b,c.Tj)};break;case "u_chromatic_aberration_coefs":l=function(a,b,c){a.uniform4fv(b,c.chromatic_aberration_coefs)};break;case "u_motion_blur_exp":l=function(a,b,c){a.uniform1f(b,c.NA)};f=!0;break;case "u_motion_blur_decay_threshold":l=function(a,b,c){a.uniform1f(b,c.mb_decay_threshold)};f=!0;break;case "u_model_tsr":g=function(a,b,c){a.uniformMatrix3fv(b,!1,c.m)};f=!0;break;case "u_model_zup_tsr":g=function(a,b,c){a.uniformMatrix3fv(b,!1,c.wp)};f=!0;break;case "u_model_zup_tsr_inverse":g=
function(a,b,c){a.uniformMatrix3fv(b,!1,c.Ss)};f=!0;break;case "u_transb":g=function(a,b,c){a.uniform4fv(b,c.Ed)};f=!0;break;case "u_transa":g=function(a,b,c){a.uniform4fv(b,c.Sd)};f=!0;break;case "u_arm_rel_trans":g=function(a,b,c){a.uniform4fv(b,c.gn)};f=!0;break;case "u_arm_rel_quat":g=function(a,b,c){a.uniform4fv(b,c.fn)};f=!0;break;case "u_quat":g=function(a,b,c){a.uniform4fv(b,H.xd(c.m,S))};f=!0;break;case "u_quatsb":g=function(a,b,c){a.uniform4fv(b,c.Bd)};f=!0;break;case "u_quatsa":g=function(a,
b,c){a.uniform4fv(b,c.Qd)};f=!0;break;case "u_frame_factor":g=function(a,b,c){a.uniform1f(b,c.ie)};f=!0;break;case "au_center_pos":g=function(){};f=!0;break;case "au_wind_bending_amp":g=function(a,b,c){a.uniform1f(b,c.Ef)};f=!0;break;case "au_wind_bending_freq":g=function(a,b,c){a.uniform1f(b,c.ig)};f=!0;break;case "au_detail_bending_freq":g=function(a,b,c){a.uniform1f(b,c.Lf)};f=!0;break;case "au_detail_bending_amp":g=function(a,b,c){a.uniform1f(b,c.Kf)};f=!0;break;case "au_branch_bending_amp":g=
function(a,b,c){a.uniform1f(b,c.Hf)};f=!0;break;case "u_node_values":g=function(a,b,c,d){a.uniform1fv(b,d.Bh)};f=!0;break;case "u_node_rgbs":g=function(a,b,c,d){a.uniform3fv(b,d.Nd)};f=!0;break;case "u_diffuse_color":g=function(a,b,c,d){a.uniform4fv(b,d.Zc)};f=!0;break;case "u_diffuse_intensity":g=function(a,b,c,d){a.uniform1f(b,d.vg)};f=!0;break;case "u_diffuse_params":g=function(a,b,c,d){a.uniform2fv(b,d.Kd)};f=!0;break;case "u_emit":g=function(a,b,c,d){a.uniform1f(b,d.Nf)};f=!0;break;case "u_ambient":g=
function(a,b,c,d){a.uniform1f(b,d.Gf)};f=!0;break;case "u_specular_color":g=function(a,b,c,d){a.uniform3fv(b,d.Cf)};f=!0;break;case "u_specular_alpha":g=function(a,b,c,d){a.uniform1f(b,d.ep)};f=!0;break;case "u_specular_params":g=function(a,b,c,d){a.uniform3fv(b,d.Dd)};f=!0;break;case "u_reflect_factor":g=function(a,b,c,d){a.uniform1f(b,d.reflect_factor)};f=!0;break;case "u_mirror_factor":g=function(a,b,c,d){a.uniform1f(b,d.Ao)};f=!0;break;case "u_grass_map_dim":g=function(a,b,c,d){a.uniform3fv(b,
d.yd)};f=!0;break;case "u_grass_size":g=function(a,b,c,d){a.uniform1f(b,d.lo)};f=!0;break;case "u_scale_threshold":g=function(a,b,c,d){a.uniform1f(b,d.Nq)};f=!0;break;case "u_cube_fog":g=function(a,b,c,d){a.uniformMatrix4fv(b,!1,d.Jd)};break;case "u_jitter_amp":g=function(a,b,c,d){a.uniform1f(b,d.lr)};f=!0;break;case "u_jitter_freq":g=function(a,b,c,d){a.uniform1f(b,d.mr)};f=!0;break;case "u_wireframe_edge_color":g=function(a,b,c,d){a.uniform3fv(b,d.wireframe_edge_color)};break;case "u_cluster_id":g=
function(a,b,c,d){a.uniform1f(b,d.Jj)};f=!0;break;case "u_batch_debug_id_color":g=function(a,b,c,d){a.uniform1f(b,d.sq)};f=!0;break;case "u_batch_debug_main_render_time":g=function(a,b,c,d){a.uniform1f(b,d.Mn)};f=!0;break;case "u_refr_bump":g=function(a,b,c,d){a.uniform1f(b,d.as)};f=!0;break;case "u_line_width":g=function(a,b,c,d){a.uniform1f(b,d.Ul)};f=!0;break;case "u_lamp_light_positions":g=function(a,b,c,d){a.uniform3fv(b,d.Rl)};break;case "u_lamp_light_directions":g=function(a,b,c,d){a.uniform3fv(b,
d.xo)};break;case "u_lamp_light_color_intensities":g=function(a,b,c,d){a.uniform3fv(b,d.wo)};break;case "u_lamp_light_factors":g=function(a,b,c,d){a.uniform4fv(b,d.yo)};break;case "u_halo_size":g=function(a,b,c,d){a.uniform1f(b,d.Xq)};f=!0;break;case "u_halo_hardness":g=function(a,b,c,d){a.uniform1f(b,d.Uq)};f=!0;break;case "u_halo_rings_color":g=function(a,b,c,d){a.uniform3fv(b,d.Wq)};f=!0;break;case "u_halo_lines_color":g=function(a,b,c,d){a.uniform3fv(b,d.Vq)};f=!0;break;case "u_halo_stars_blend":g=
function(a,b,c,d){a.uniform1f(b,d.Yq)};f=!0;break;case "u_halo_stars_height":g=function(a,b,c,d){a.uniform1f(b,d.Zq)};f=!0;break;case "u_fresnel_params":g=function(a,b,c,d){a.uniform4fv(b,d.Me)};f=!0;break;case "u_texture_scale":g=function(a,b,c,d){a.uniform3fv(b,d.Rg)};f=!0;break;case "u_parallax_scale":g=function(a,b,c,d){a.uniform1f(b,d.parallax_scale)};f=!0;break;case "u_color_id":g=function(a,b,c){a.uniform3fv(b,c.Mj)};f=!0;break;case "u_line_points":g=function(a,b,c,d){a.uniform3fv(b,d.fR)};
f=!0;break;case "u_diffuse_color_factor":g=function(a,b,c,d){a.uniform1f(b,d.ug)};f=!0;break;case "u_alpha_factor":g=function(a,b,c,d){a.uniform1f(b,d.mg)};f=!0;break;case "u_specular_color_factor":g=function(a,b,c,d){a.uniform1f(b,d.Lh)};f=!0;break;case "u_normal_factor":g=function(a,b,c,d){a.uniform1f(b,d.Hr)};f=!0;break;case "u_normalmap0_scale":g=function(a,b,c,d){a.uniform2fv(b,d.Ch[0])};f=!0;break;case "u_normalmap1_scale":g=function(a,b,c,d){a.uniform2fv(b,d.Ch[1])};f=!0;break;case "u_normalmap2_scale":g=
function(a,b,c,d){a.uniform2fv(b,d.Ch[2])};f=!0;break;case "u_normalmap3_scale":g=function(a,b,c,d){a.uniform2fv(b,d.Ch[3])};f=!0;break;case "u_foam_factor":g=function(a,b,c,d){a.uniform1f(b,d.foam_factor)};f=!0;break;case "u_foam_uv_freq":g=function(a,b,c,d){a.uniform2fv(b,d.Hq)};f=!0;break;case "u_foam_mag":g=function(a,b,c,d){a.uniform2fv(b,d.Gq)};f=!0;break;case "u_foam_scale":g=function(a,b,c,d){a.uniform2fv(b,d.$n)};f=!0;break;case "u_water_norm_uv_velocity":g=function(a,b,c,d){a.uniform1f(b,
d.rj)};f=!0;break;case "u_shallow_water_col":g=function(a,b,c,d){a.uniform3fv(b,d.shallow_water_col)};f=!0;break;case "u_shore_water_col":g=function(a,b,c,d){a.uniform3fv(b,d.shore_water_col)};f=!0;break;case "u_water_shallow_col_fac":g=function(a,b,c,d){a.uniform1f(b,d.shallow_water_col_fac)};f=!0;break;case "u_water_shore_col_fac":g=function(a,b,c,d){a.uniform1f(b,d.shore_water_col_fac)};f=!0;break;case "u_p_length":g=function(a,b,c,d){a.uniform1f(b,d.Ia.wC)};f=!0;break;case "u_p_cyclic":g=function(a,
b,c,d){a.uniform1i(b,d.Ia.cyclic)};f=!0;break;case "u_p_max_lifetime":g=function(a,b,c,d){a.uniform1f(b,d.Ia.AA)};f=!0;break;case "u_p_fade_in":g=function(a,b,c,d){a.uniform1f(b,d.Ia.Zj)};f=!0;break;case "u_p_fade_out":g=function(a,b,c,d){a.uniform1f(b,d.Ia.Ke)};f=!0;break;case "u_p_size":g=function(a,b,c,d){a.uniform1f(b,d.Ia.size)};f=!0;break;case "u_p_alpha_start":g=function(a,b,c,d){a.uniform1f(b,d.Ia.Sx)};f=!0;break;case "u_p_alpha_end":g=function(a,b,c,d){a.uniform1f(b,d.Ia.Rx)};f=!0;break;
case "u_p_nfactor":g=function(a,b,c,d){a.uniform1f(b,d.Ia.Bv)};f=!0;break;case "u_p_gravity":g=function(a,b,c,d){a.uniform1f(b,d.Ia.$z)};f=!0;break;case "u_p_mass":g=function(a,b,c,d){a.uniform1f(b,d.Ia.Hg)};f=!0;break;case "u_p_color_ramp":g=function(a,b,c,d){a.uniform4fv(b,d.Ia.Jy)};f=!0;break;case "u_p_wind_fac":g=function(a,b,c,d){a.uniform1f(b,d.Ia.fD)};f=!0;break;case "u_p_time":g=function(a,b,c,d){a.uniform1f(b,d.Ia.time)};f=!0;break;case "u_p_tilt":g=function(a,b,c,d){a.uniform1f(b,d.Ia.uC)};
f=!0;break;case "u_p_tilt_rand":g=function(a,b,c,d){a.uniform1f(b,d.Ia.vC)};f=!0;break;case "u_position":g=function(a,b,c,d){a.uniform3fv(b,d.xj)};f=!0;break;case "u_va_frame_factor":g=function(a,b,c){a.uniform1f(b,c.Hs)};f=!0;break;case "u_refl_plane":g=function(a,b,c){a.uniform4fv(b,c.Fb)};f=!0;break;case "u_outline_intensity":g=function(a,b,c){a.uniform1f(b,c.Yf)},f=!0}g&&(g={name:h,Fl:g,me:b[h]},f?c.push(g):d.push(g));l&&(g={name:h,Fl:l,me:b[h]},f?k.push(g):e.push(g))}if(d.length||e.length){a=
a.Mv;for(var t in a)delete a[t];for(t=0;t<d.length;t++)g=d[t],a[g.name]=g;for(t=0;t<e.length;t++)g=e[t],a[g.name]=g}else a.Fr=!0}var r=p("__batch"),g=p("__camera"),m=p("__config"),q=p("__debug"),B=p("__extensions"),d=p("__quat"),l=p("__subscene"),f=p("__textures"),H=p("__tsr"),D=p("__util"),w=[1,1,1,1],E=[1,1,1,1],y=[0,0,0,1],A=[0,0,0,0],G=new Uint8Array([91.8,142.8,.96*255,255]);new Float32Array([.25,-.25]);new Float32Array([-.25,.25]);new Float32Array([1,1,1,0]);new Float32Array([2,2,2,0]);var x=
null,k=null,t=null,M=null,u=null,v=null,z=new Float32Array(3),S=d.create(),C=new Uint8Array(4),W=m.v;a.Ve=function(a){var b=W.background_color;a.clearColor(b[0],b[1],b[2],b[3]);a.clearDepth(1);a.enable(a.DEPTH_TEST);a.depthFunc(a.LEQUAL);a.enable(a.CULL_FACE);a.frontFace(a.CCW);a.cullFace(a.BACK);a.enable(a.BLEND);a.blendFunc(a.ONE,a.ONE_MINUS_SRC_ALPHA);x=a};a.yl=function(a){if(a.sb)if(a.type==l.fl){q.Yv(a);var d=a.o;x.bindFramebuffer(x.READ_FRAMEBUFFER,d.co);x.bindFramebuffer(x.DRAW_FRAMEBUFFER,
d.je);var k=0;d.Zb&&(k|=x.COLOR_BUFFER_BIT);d.ge&&(k|=x.DEPTH_BUFFER_BIT);x.blitFramebuffer(0,0,d.width,d.height,0,0,d.width,d.height,k,x.NEAREST);q.Zv(a);q.It("draw resolve")}else if(a.type==l.Ws)q.Yv(a),d=a.o,x.bindFramebuffer(x.FRAMEBUFFER,d.co),x.bindTexture(x.TEXTURE_2D,d.Zb.Wa),x.copyTexSubImage2D(x.TEXTURE_2D,0,0,0,0,0,d.width,d.height,0),q.Zv(a),q.It("draw copy");else{q.Yv(a);d=a.o;x.bindFramebuffer(x.FRAMEBUFFER,d.je);a.tt&&(k=d.Zb,x.framebufferTexture2D(x.FRAMEBUFFER,x.COLOR_ATTACHMENT0,
k.Ta,k.Wa,0));x.viewport(0,0,d.width,d.height);a.type!=l.Kc&&a.type!=l.Yd&&c(a);a.kb?x.enable(x.BLEND):x.disable(x.BLEND);a.md?x.enable(x.DEPTH_TEST):x.disable(x.DEPTH_TEST);switch(a.type){case l.Ac:x.enable(x.POLYGON_OFFSET_FILL);x.polygonOffset(a.self_shadow_polygon_offset,a.self_shadow_polygon_offset);x.cullFace(x.BACK);break;case l.jd:case l.df:x.disable(x.POLYGON_OFFSET_FILL);x.cullFace(x.FRONT);break;case l.ze:x.enable(x.POLYGON_OFFSET_FILL);x.polygonOffset(-4,-4);x.cullFace(x.BACK);break;case l.pd:if(1<
W.xc||W.EB){x.enable(x.POLYGON_OFFSET_FILL);x.polygonOffset(-2,-2);break}default:x.disable(x.POLYGON_OFFSET_FILL),x.cullFace(x.BACK)}if(a.type==l.Kc||a.type==l.Yd)for(var d=a.o,k=d.Zb.Wa,f=0;6>f;f++){var h=b(f);d.jb=a.Rj[f];H.from_mat4(d.jb,d.ye);g.Et(d);x.framebufferTexture2D(x.FRAMEBUFFER,x.COLOR_ATTACHMENT0,h,k,0);c(a);for(var h=a.za,t=0;t<h.length;t++)for(var n=0;n<h[t].ha.length;n++){var v=h[t].ha[n];v.sb=v.ou[f]}e(a)}else e(a);q.Zv(a);q.It("draw subscene: "+l.Cw(a))}};a.clear=function(a){x.bindFramebuffer(x.FRAMEBUFFER,
a.o.je);c(a)};a.st=function(a){var b=a.jn;b.length=0;var c=a.aa.vb,d=a.La.attributes,k;for(k in d){var e=c[k];b.push({me:d[k],$x:4*e.offset,vz:1<e.frames?4*e.length:0,Jb:e.Jb,We:4*e.We,wg:e.wg})}W.pt&&n(a)};a.QF=n;a.QG=function(a){for(var b=B.Ku(),c=0;c<a.Vd.length;c++)b.deleteVertexArray(a.Vd[c]);a.Vd.length=0};a.RG=function(a){for(var b=[],c=0;c<a.length;c++)b.push(a[c]);return b};a.PF=h;a.Xx=function(a){var b=a.La,c=a.T;a=a.Uc;x.useProgram(b.Ui);for(var d=0;d<c.length;d++)x.uniform1i(b.Qk[a[d]],
d)};a.Wv=function(a,b,c,d,k,e){d||(d=1);k||(k=1);e||(e=new Uint8Array(4*d*k));e.length!=4*d*k&&D.q("read_pixels(): Wrong storage");x.bindFramebuffer(x.FRAMEBUFFER,a);x.readPixels(b,c,d,k,x.RGBA,x.UNSIGNED_BYTE,e);x.bindFramebuffer(x.FRAMEBUFFER,null);return e};a.TN=function(a){var b=a.La;b.Fr||(x.useProgram(b.Ui),b.Jo.length||h(b),b=b.Mv.u_cube_fog,b.Fl(x,b.me,null,a))};a.SL=function(a,b){var c=x.createFramebuffer();x.bindFramebuffer(x.FRAMEBUFFER,c);if(f.Ol(a)){var d=a.Wd;x.framebufferRenderbuffer(x.FRAMEBUFFER,
x.COLOR_ATTACHMENT0,x.RENDERBUFFER,d)}else if(f.Pl(a)){var k=a,d=k.Wa,k=k.Ta==x.TEXTURE_CUBE_MAP?x.TEXTURE_CUBE_MAP_NEGATIVE_Z:k.Ta;x.framebufferTexture2D(x.FRAMEBUFFER,x.COLOR_ATTACHMENT0,k,d,0)}f.Ol(b)?(d=b.Wd,x.framebufferRenderbuffer(x.FRAMEBUFFER,x.DEPTH_ATTACHMENT,x.RENDERBUFFER,d)):f.Pl(b)&&(k=b,d=k.Wa,k=k.Ta,x.framebufferTexture2D(x.FRAMEBUFFER,x.DEPTH_ATTACHMENT,k,d,0));q.uG();x.bindFramebuffer(x.FRAMEBUFFER,null);return c};a.RL=function(a,b,c,d,k){null==a?(x.bindFramebuffer(x.FRAMEBUFFER,
a),x.viewport(0,0,d,k),x.clear(x.COLOR_BUFFER_BIT|x.DEPTH_BUFFER_BIT)):(f.Ol(b)?x.deleteRenderbuffer(b.Wd):f.Pl(b)&&x.deleteTexture(b.Wa),f.Ol(c)?x.deleteRenderbuffer(c.Wd):f.Pl(c)&&x.deleteTexture(c.Wa),x.deleteFramebuffer(a))};a.TQ=function(){};a.tI=function(a,b,c,d,k,e){a=a.Wa;x.viewport(0,0,c,c);x.framebufferTexture2D(x.FRAMEBUFFER,x.COLOR_ATTACHMENT0,b,a,0);b=r.Yt("FLIP_CUBEMAP_COORDS");a=b.La;x.activeTexture(x.TEXTURE0);x.bindTexture(x.TEXTURE_2D,k);var f=k=0;c!=d&&(k=1/(6*d),f=1/(4*d));x.uniform1i(a.Qk.u_tex_number,
e);x.uniform2fv(a.Qk.u_delta,[k,f]);x.useProgram(a.Ui);v(b,0);x.bindTexture(x.TEXTURE_2D,null)};a.uI=function(a,b,c,d,k){x.bindFramebuffer(x.FRAMEBUFFER,d);d=a.Wa;a=a.Ta;x.bindTexture(a,d);x.viewport(0,0,b,c);x.texImage2D(a,0,x.RGBA,b,c,0,x.RGBA,x.UNSIGNED_BYTE,null);x.framebufferTexture2D(x.FRAMEBUFFER,x.COLOR_ATTACHMENT0,a,d,0);b=r.Yt("NONE");c=b.La;x.bindTexture(a,null);x.activeTexture(x.TEXTURE0);x.bindTexture(a,k);x.useProgram(c.Ui);v(b,0);x.bindFramebuffer(x.FRAMEBUFFER,null);x.bindTexture(a,
null)};a.cleanup=function(){};a.qM=function(){var a=B.KJ(),b=B.Ku();W.Px=a?!0:!1;W.pt=b?!0:!1;a?(k=function(b,c,d,k,e){a.drawElementsInstanced(b,c,d,k,e)},t=function(b,c){a.vertexAttribDivisor(b,c)},M=function(b,c,d,k){a.drawArraysInstanced(b,c,d,k)}):(k=function(a,b,c,d){x.drawElements(a,b,c,d)},t=function(){},M=function(a,b,c){x.drawArrays(a,b,c)});b?(u=function(a){b.bindVertexArray(a)},v=function(a,b){var c=a.aa;u(a.Vd[b]);c.rf?k(c.mode,c.count,c.jk,0,c.mk):M(c.mode,0,c.count,c.mk);u(null)}):v=
function(a,b){var c=x,d=a.aa,e=a.jn;c.bindBuffer(c.ARRAY_BUFFER,d.Uh);for(var f=0;f<e.length;f++){var h=e[f];c.enableVertexAttribArray(h.me);c.vertexAttribPointer(h.me,h.Jb,c.FLOAT,!1,h.We,h.$x+h.vz*b);t(h.me,h.wg)}d.rf?(c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,d.rf),k(d.mode,d.count,d.jk,0,d.mk)):M(d.mode,0,d.count,d.mk);for(f=0;f<e.length;f++)h=e[f],c.disableVertexAttribArray(h.me)}};a.reset=function(){M=t=k=x=null}};b4w.module.__shaders=function(a,p){function e(a,b,d){var k=a.nh;"string"==typeof d&&(a=c(a,d))&&(d=a[1]);for(a=0;a<k.length;a++)if(k[a][0]==b){k[a][1]=d;return}k.push([b,d])}function c(a,b){for(var c=a.nh,d=0;d<c.length;d++)if(c[d][0]==b)return c[d];return!1}function b(a,b){return a+b}function n(a,c){return(a.split(";").map(function(a){return(a=a.match(c))&&(a[3]?parseInt(a[3]):1)}).filter(function(a){return a})||[]).reduce(b,0)}function h(a,b){var c=q(a.type),d=q(b.type),k=a.nl,e=b.nl;return c>d?
-1:c<d?1:k>e?-1:k<e?1:0}function r(a){function b(){for(var a=0;n<e.length;){var c=e[n];if(3!=q(c.type))break;a+=m(c.type)*c.nl;n++}l=t+a;if(l>ga)return!1;g(t,a,0,3);return!0}function c(){for(var a=ga-l,b=a,d=a;n<e.length;){var k=e[n];if(2!=q(k.type))break;k=m(k.type)*k.nl;if(k<=b)b-=k;else if(k<=d)d-=k;else return!1;n++}d=a-d;g(l,a-b,0,2);g(ga-d,d,2,2);return!0}function d(){for(;n<e.length;){for(var a=e[n],a=m(a.type)*a.nl,b=-1,c=f+1,k=-1,h=0;4>h;h++){var l=P;l[0]=0;l[1]=1;var t;var v=h;t=a;for(var x=
l;U<da.length&&15===da[U];)U++;for(;0<ga&&15===da[ga];)ga--;if(ga-U<t)t=!1;else{for(var v=1<<v,u=0,L=-1,q=da.length+1,w=!1,B=U;B<=ga;B++)B<ga&&!(da[B]&v)?w||(u=B,w=!0):(w&&(w=B-u,w>=t&&w<q&&(q=w,L=u)),w=!1);0>L?t=!1:(x[0]=L,x[1]=q,t=!0)}t&&l[1]<c&&(k=l[0],c=l[1],b=h)}if(0>b)return!1;g(k,a,b,1);n++}return!0}if(u.pc){a=a.replace(/(.*?)\([^()]*?\)(.*?)/g,"$1$2");var k=N}else k=L;var e=a.split(";").map(function(a){return(a=a.match(k))&&{type:a[2],nl:a[4]?parseInt(a[4]):1}}).filter(function(a){return a});
if(!e.length)return!0;var f=v.mv;da||(da=new Uint16Array(f));for(a=0;a<f;a++)da[a]=0;ga=f;e.sort(h);var l=0,t=0,n=0;return function(){for(;n<e.length;){var a=e[n];if(4!=q(a.type))break;t+=m(a.type)*a.nl;n++}if(t>ga)return!1;U=t;g(0,t,0,4);return!0}()&&b()&&c()&&d()}function g(a,b,c,d){for(var k=0,e=0;e<d;e++)k|=1<<c+e;for(e=0;e<b;e++)da[a+e]|=k}function m(a){var b=0;switch(a){case "mat4":b=4;break;case "mat3":b=3;break;case "mat2":b=2;break;default:b=1}return b}function q(a){var b=0;switch(a){case "mat4":case "vec4":case "mat2":b=
4;break;case "mat3":case "vec3":b=3;break;case "vec2":b=2;break;default:b=1}return b}function B(a,b){var c=a+b;if(C[c])return C[c];if(W){var d=W[b];if(!d)return null;d=p("__gpp_parser").rR.parse(d)}else if(d=p("shader_texts")[b],!d)return null;return C[c]=d}function d(a,b){for(var c={},d=b.nh||[],k=0;k<d.length;k++)c[d[k][0]]=[d[k][1]];for(k=0;k<b.Ah.length;k++)c["USE_NODE_"+b.Ah[k].id]=[1];u.pc?(c.GLSL_VERSION=["300 es"],c.GLSL1=[0],c.GLSL3=[1],c.GLSL_IN=["in"],c.GLSL_OUT=["out"],c.GLSL_OUT_FRAG_COLOR=
["glsl_out_frag_color"],c.GLSL_TEXTURE=["texture"],c.GLSL_TEXTURE_CUBE=["texture"],c.GLSL_TEXTURE_PROJ=["textureProj"]):(c.GLSL_VERSION=["100"],c.GLSL1=[1],c.GLSL3=[0],c.GLSL_IN="vert"==a?["attribute"]:["varying"],c.GLSL_OUT="vert"==a?["varying"]:[],c.GLSL_OUT_FRAG_COLOR=["gl_FragColor"],c.GLSL_TEXTURE=["texture2D"],c.GLSL_TEXTURE_CUBE=["textureCube"],c.GLSL_TEXTURE_PROJ=["texture2DProj"]);return c}function l(a,b,c){function k(b){b=b.c;for(var c=0;c<b.length;c++){var d=b[c];switch(d.a){case "cond":a:for(var d=
d.c,J=0;J<d.length;J++){var u=d[J];switch(u.a){case "if":case "elif":if(e(u.e)){k(u.h);break a}break;case "else":k(u.h);break a;case "ifdef":u.d in v&&k(u.h);break;case "ifndef":u.d in v||k(u.h)}}break;case "include":d=B(z.shaders_dir,z.YM+d.n);k(d);break;case "var":case "export":case "import":break;case "define":J=d.d;v[J]=d.b;d.OE&&(m[J]=d.OE);break;case "error":M.q("Shader error: #error "+d.b.join(" "));break;case "line":break;case "pragma":n.push("#pragma "+d.d+" "+d.b.join(" "));break;case "undef":d=
d.d;delete v[d];delete m[d];break;case "warning":t.warn("Shader warning: #warning "+d.b.join(" "));break;case "extension":d=f(d.b,v,m,!1);n.push("#extension "+d.join(" "));break;case "version":d=f(d.b,v,m,!1),n.push("#version "+d.join(" "));case "#":break;case "node":x[d.d]=d;break;case "nodes_global":d=g;for(J=0;J<d.length;J++){var u=d[J],q=x[u.id];if(q)for(var w=0,aa=0;aa<q.l.length;aa++){var V=q.l[aa];if("node_param"==V.a){var y;if("PARTICLE_INFO"==u.id&&V.f)if(1==v.PARTICLE_BATCH)switch(y=!1,
w){case 0:y=A(u.Ob,"PART_INFO_IND")||A(u.Ob,"PART_INFO_AGE")||A(u.Ob,"PART_INFO_LT")||A(u.Ob,"PART_INFO_SIZE");break;case 1:y=A(u.Ob,"PART_INFO_LOC");break;case 2:y=A(u.Ob,"PART_INFO_VEL");break;case 3:y=A(u.Ob,"PART_INFO_A_VEL");break;case 4:y=A(u.Ob,"PART_INFO_IND")}else y=!1;else y=!0;y&&(V=V.g.slice(),"vert"==a?V.push(u.pj[w]):"frag"==a&&(V.push(u.V[w]),null!==u.Or[w]&&(V.push("="),V.push(u.Or[w]))),V.push(";"),l(V));w++}}}break;case "nodes_main":d=g;for(J=0;J<d.length;J++)if(u=d[J],q=x[u.id]){w=
{};aa={};for(V=0;V<u.Ob.length;V++)aa[u.Ob[V][0]]=[u.Ob[V][1]];U=r=O=0;V=u;y=q.l;for(var D=w,G=aa,Y=0;Y<y.length;Y++){var wa=y[Y];switch(wa.a){case "node_in":var ua=V.H[O];if(null!==V.Tu[O]){if(("MATERIAL_BEGIN"==V.id&&3===O||!G.MATERIAL_EXT&&("MATERIAL_BEGIN"==V.id&&4===O||"MATERIAL_END"==V.id&&3===O||"MATERIAL_END"==V.id&&4===O||"MATERIAL_END"==V.id&&5===O)||"TEXTURE_COLOR"==V.id||"TEXTURE_NORMAL"==V.id)&&wa.f){D[wa.d]=V.Tu[O];O++;continue}var P=wa.g.slice();P.push(ua);P.push("=");P.push(V.Tu[O]);
P.push(";");l(P)}D[wa.d]=ua;O++;break;case "node_out":ua=V.Qa[r];if(!wa.f||-1<L.indexOf(ua))P=wa.g.slice(),P.push(ua),P.push(";"),l(P),D[wa.d]=ua;-1<L.indexOf(ua)&&(G["USE_OUT_"+wa.d]=[1]);r++;break;case "node_param":"vert"==a?ua=V.pj[U]:"frag"==a&&(ua=V.V[U]),D[wa.d]=ua,U++}}n.push("{");h(u,q.j,w,aa);n.push("}")}break;case "txt":l(d.b);break;default:M.q("Unknown element type: "+d.a)}}}function e(a,b){var c;c=f(a,v,m,!0,b);for(var d=[],k=0;k<c.length;k++)if(c[k]instanceof Object)switch(c[k].a){case "conditional_expr":var h=
d.pop(),l=d.pop();d.pop()?d.push(l):d.push(h);break;case "logical_or_expr":h=d.pop();for(l=0;l<c[k].i-1;l++)g=d.pop(),h=h||g;d.push(h);break;case "logical_and_expr":h=d.pop();for(l=0;l<c[k].i-1;l++)g=d.pop(),h=h&&g;d.push(h);break;case "logical_bitor_expr":h=d.pop();for(l=0;l<c[k].i-1;l++)h|=d.pop();d.push(h);break;case "logical_bitxor_expr":h=d.pop();for(l=0;l<c[k].i-1;l++)h^=d.pop();d.push(h);break;case "logical_bitand_expr":h=d.pop();for(l=0;l<c[k].i-1;l++)h&=d.pop();d.push(h);break;case "equal_expr":h=
d.pop();l=d.pop();d.push(l==h);break;case "non_equal_expr":h=d.pop();l=d.pop();d.push(l!=h);break;case "le_expr":h=d.pop();l=d.pop();d.push(l<=h);break;case "ge_expr":h=d.pop();l=d.pop();d.push(l>=h);break;case "l_expr":h=d.pop();l=d.pop();d.push(l<h);break;case "g_expr":h=d.pop();l=d.pop();d.push(l>h);break;case "left_shift_expr":l=d.pop();h=d.pop();d.push(l<<h);break;case "right_shift_expr":l=d.pop();h=d.pop();d.push(l>>h);break;case "add_expr":l=d.pop();h=d.pop();d.push(l+h);break;case "sub_expr":l=
d.pop();h=d.pop();d.push(l-h);break;case "mul_expr":l=d.pop();h=d.pop();d.push(l*h);break;case "div_expr":l=d.pop();h=d.pop();d.push(l/h);break;case "mod_expr":l=d.pop();h=d.pop();d.push(l%h);break;case "pre_inc_expr":case "post_inc_expr":g=d.pop();d.push(++g);break;case "pre_dec_expr":case "post_dec_expr":g=d.pop();d.push(--g);break;case "positive_expr":g=d.pop();d.push(+g);break;case "negative_expr":g=d.pop();d.push(-g);break;case "one_compl_expr":g=d.pop();d.push(~g);break;case "logic_negative_expr":g=
d.pop();d.push(!g);break;default:M.q("Unknown operation type: "+c[k].a)}else{var g=c[k];/^[a-zA-Z_$][a-zA-Z_$0-9]*$/.test(g)?d.push(0):d.push(parseFloat(c[k]))}1==d.length?c=d[0]:(M.q("Incorrect expression: "+c.join(" ")),c=void 0);return c}function h(a,b,c,d){for(var k=0;k<b.length;k++){var f=b[k];switch(f.a){case "node_cond":a:for(var g=a,f=f.c,t=c,J=d,n=0;n<f.length;n++){var m=f[n];switch(m.a){case "node_if":case "node_elif":if(e(m.e,J)){h(g,m.j,t,J);break a}break;case "node_else":h(g,m.j,t,J);
break a;case "node_ifdef":(m.d in v||m.d in J)&&h(g,m.j,t,J);break;case "node_ifndef":m.d in v||m.d in J||h(g,m.j,t,J)}}break;case "txt":g=[];for(t=0;t<f.b.length;t++)J=f.b[t],J in c?g.push(c[J]):g.push(J);l(g,d)}}}function l(b,c){var d=b;u.pc||"frag"!=a||(d=d.join(" "),w&&(d.match(/[^;]*;/)?(d=d.replace(/[^;]*;/,""),w=!1):d=""),d=d.replace(/GLSL_OUT [^;]*;/g,""),d.match(/GLSL_OUT(?:$| [^;]*)/)&&(d=d.replace(/GLSL_OUT(?:$| [^;]*)/,""),w=!0),d=d.replace(/ {2,}/g," "),d=(d=d.trim())?d.split(" "):[]);
b=d;b.length&&(d=f(b,v,m,!1,c),n.push(d.join(" ")))}var g=c.Ah,n=[],v=d(a,c),m={},x={},L=[],J;for(J in g)for(var q in g[J].H)L.push(g[J].H[q]);var w=!1;k(b);var O=0,r=0,U=0;return n.join("\n")}function f(a,b,c,d,k){var e=[];H(a,b,c,d,e,k);return e}function H(a,b,c,d,k,e){for(var f=0;f<a.length;f++){var h=a[f];h in b||e&&h in e?(h=e&&e[h]||b[h],0==h.length&&d?k.push(0):H(h,b,c,d,k,e)):k.push(h)}}function D(a,b,c,d){d=a.createShader(d);a.shaderSource(d,c);a.compileShader(d);k.EG(d,b,c);return d}function w(a){la.deleteProgram(a.Ui);
la.deleteShader(a.dD);la.deleteShader(a.xz);delete S[a.$o]}function E(a,b){!b&&a.length?b=a.length:b||(b=1);switch(b){case 1:return y(a);case 2:return"vec2("+y(a[0])+","+y(a[1])+")";case 3:return"vec3("+y(a[0])+","+y(a[1])+","+y(a[2])+")";case 4:return"vec4("+y(a[0])+","+y(a[1])+","+y(a[2])+","+y(a[3])+")";case 9:return"mat3("+y(a[0])+","+y(a[1])+","+y(a[2])+","+y(a[3])+","+y(a[4])+","+y(a[5])+","+y(a[6])+","+y(a[7])+","+y(a[8])+")";case 16:return"mat4("+y(a[0])+","+y(a[1])+","+y(a[2])+","+y(a[3])+
","+y(a[4])+","+y(a[5])+","+y(a[6])+","+y(a[7])+","+y(a[8])+","+y(a[9])+","+y(a[10])+","+y(a[11])+","+y(a[12])+","+y(a[13])+","+y(a[14])+","+y(a[15])+")";default:M.q("Wrong glsl value dimension")}}function y(a){return a%1?String(a):String(a)+".0"}function A(a,b){for(var c=0;c<a.length;c++)if(a[c][0]==b)return!0;return!1}var G=p("__assets"),x=p("__config"),k=p("__debug"),t=p("__print"),M=p("__util"),u=x.v,v=x.mi,z=x.Od,S={},C={},W=null,F="anchors.glslf anchors.glslv color_id.glslf color_id.glslv shadow.glslf shadow.glslv error.glslf error.glslv grass_map.glslf grass_map.glslv halo.glslf halo.glslv line.glslf line.glslv main.glslf main.glslv main_stack.glslf particle_system.glslf particle_system_stack.glslf particle_system.glslv procedural_skydome.glslf procedural_skydome.glslv special_lens_flares.glslf special_lens_flares.glslv special_skydome.glslf special_skydome.glslv special_water.glslf special_water.glslv debug_view.glslf debug_view.glslv postprocessing/antialiasing.glslf postprocessing/bloom_combine.glslf postprocessing/coc.glslf postprocessing/compositing.glslf postprocessing/depth_pack.glslf postprocessing/dof.glslf postprocessing/glow.glslf postprocessing/bloom_blur.glslf postprocessing/god_rays.glslf postprocessing/god_rays.glslv postprocessing/god_rays_combine.glslf postprocessing/luminance.glslf postprocessing/luminance_av.glslf postprocessing/luminance_trunced.glslf postprocessing/luminance_trunced.glslv postprocessing/motion_blur.glslf postprocessing/outline.glslf postprocessing/performance.glslf postprocessing/postprocessing.glslf postprocessing/postprocessing.glslv postprocessing/smaa.glslf postprocessing/smaa.glslv postprocessing/ssao.glslf postprocessing/ssao_blur.glslf postprocessing/stereo.glslf include/blending.glslf include/caustics.glslf include/color_util.glslf include/depth_fetch.glslf include/dynamic_grass.glslv include/environment.glslf include/fog.glslf include/fxaa.glslf include/halo_color.glslf include/lighting_nodes.glslf include/math.glslv include/mirror.glslf include/nodes.glslf include/nodes.glslv include/pack.glslf include/particles.glslv include/particles_nodes.glslf include/particles_nodes.glslv include/precision_statement.glslf include/procedural.glslf include/refraction.glslf include/scale_texcoord.glslv include/shadow.glslf include/shadow.glslv include/skin.glslv include/std_enums.glsl include/to_world.glslv include/wind_bending.glslv".split(" ");
a.kt=0;a.rD=1;a.qD=2;a.uD=4;a.tD=8;a.sD=16;var K=/(?:^|[^a-zA-Z_])uniform.*?(sampler2D|samplerCube)(?=\s)(.*?\[\s*([0-9]*)\s*\])?/,X=/(?:^|[^a-zA-Z_])(uniform)(?=\s)(.*?\[\s*([0-9]*)\s*\])?/,N=/(?:^|[^a-zA-Z_])(in)(?=\s)\s*(float|vec2|vec3|vec4|mat2|mat3|mat4)\s*(.*?\[\s*([0-9]*)\s*\])?/,L=/(?:^|[^a-zA-Z_])(varying)(?=\s)\s*(float|vec2|vec3|vec4|mat2|mat3|mat4)\s*(.*?\[\s*([0-9]*)\s*\])?/,P=new Int16Array(2),da=null,U=0,ga=0,T=[],la=null,O=!1;a.Ve=function(a){la=a};a.ba=e;a.BJ=c;a.ZQ=function(a,b){for(var c=
a.nh,d=0;d<c.length;d++)if(c[d][0]==b&&1==c[d][1])return!0;return!1};a.oM=function(a){a.nh=[];for(var b="ALPHA ALPHA_CLIP ANAGLYPH BEND_CENTER_ONLY BILLBOARD_PRES_GLOB_ORIENTATION CAUSTICS CSM_BLEND_BETWEEEN_CASCADES CSM_FADE_LAST_CASCADE CSM_SECTION0 CSM_SECTION1 CSM_SECTION2 CSM_SECTION3 DEBUG_SPHERE DEBUG_SPHERE_DYNAMIC DEBUG_VIEW_SPECIAL_SKYDOME DEPTH_RGBA DISABLE_FOG DOUBLE_SIDED_LIGHTING DYNAMIC DYNAMIC_GRASS DYNAMIC_GRASS_COLOR DYNAMIC_GRASS_SIZE FOAM FRAMES_BLENDING BILLBOARD_JITTERED BILLBOARD_SPHERICAL HAIR_BILLBOARD SHADOW_TEX_RES MAIN_BEND_COL MAX_BONES NUM_NORMALMAPS PARALLAX PARALLAX_STEPS PROCEDURAL_FOG PROCEDURAL_SKYDOME REFLECTION REFLECTION_PASS REFLECTION_TYPE REFRACTIVE USE_REFRACTION USE_REFRACTION_CORRECTION SHORE_SMOOTHING SKINNED SKY_COLOR SKY_TEXTURE SSAO_HEMISPHERE SSAO_BLUR_DEPTH SSAO_ONLY SSAO_WHITE STATIC_BATCH TEXTURE_COLOR TEXTURE_NORM TEXTURE_SPEC TEXTURE_STENCIL_ALPHA_MASK VERTEX_ANIM VERTEX_ANIM_MIX_NORMALS_FACTOR VERTEX_COLOR WATER_EFFECTS WIND_BEND DETAIL_BEND SHORE_PARAMS ALPHA_AS_SPEC DEPTH_RGBA MTEX_NEGATIVE MTEX_RGBTOINT NUM_LIGHTS NUM_LFACTORS NUM_LAMP_LIGHTS MAX_STEPS BILLBOARD_ALIGN SHADOW_USAGE POST_EFFECT SSAO_QUALITY TEXTURE_BLEND_TYPE TEXTURE_COORDS AA_METHOD AU_QUALIFIER BILLBOARD BILLBOARD_RANDOM PRECISION EPSILON USE_ENVIRONMENT_LIGHT USE_FOG WO_SKYBLEND WO_SKYPAPER WO_SKYREAL WO_SKYTEX WOMAP_BLEND WOMAP_HORIZ WOMAP_ZENUP WOMAP_ZENDOWN WIREFRAME_QUALITY SIZE_RAMP_LENGTH COLOR_RAMP_LENGTH PARTICLES_SHADELESS NUM_CAST_LAMPS SUN_NUM MAC_OS_SHADOW_HACK USE_COLOR_RAMP HALO_PARTICLES PARTICLE_BATCH HAS_REFRACT_TEXTURE USE_INSTANCED_PARTCLS USE_TBN_SHADING CALC_TBN MAT_USE_TBN_SHADING".split(" "),
c=0;c<b.length;c++){var d=b[c],k;switch(d){case "ALPHA":case "ALPHA_CLIP":case "ANAGLYPH":case "BILLBOARD_PRES_GLOB_ORIENTATION":case "CAUSTICS":case "CSM_SECTION0":case "CSM_SECTION1":case "CSM_SECTION2":case "CSM_SECTION3":case "DEBUG_SPHERE":case "DEBUG_SPHERE_DYNAMIC":case "DEBUG_VIEW_SPECIAL_SKYDOME":case "DEPTH_RGBA":case "DISABLE_FOG":case "DOUBLE_SIDED_LIGHTING":case "DYNAMIC":case "DYNAMIC_GRASS":case "DYNAMIC_GRASS_COLOR":case "DYNAMIC_GRASS_SIZE":case "FOAM":case "FRAMES_BLENDING":case "BILLBOARD_JITTERED":case "MAIN_BEND_COL":case "MAX_BONES":case "MTEX_NEGATIVE":case "MTEX_RGBTOINT":case "NUM_LIGHTS":case "NUM_LFACTORS":case "NUM_NORMALMAPS":case "PARALLAX":case "PARALLAX_STEPS":case "PROCEDURAL_FOG":case "PROCEDURAL_SKYDOME":case "REFLECTION":case "REFLECTION_PASS":case "REFLECTION_TYPE":case "REFRACTIVE":case "USE_REFRACTION":case "USE_REFRACTION_CORRECTION":case "SHORE_SMOOTHING":case "SKINNED":case "SKY_COLOR":case "SKY_TEXTURE":case "SSAO_HEMISPHERE":case "SSAO_BLUR_DEPTH":case "SSAO_ONLY":case "SSAO_WHITE":case "STATIC_BATCH":case "TEXTURE_COLOR":case "TEXTURE_NORM":case "TEXTURE_SPEC":case "TEXTURE_STENCIL_ALPHA_MASK":case "VERTEX_ANIM":case "VERTEX_COLOR":case "WATER_EFFECTS":case "WIND_BEND":case "DETAIL_BEND":case "SHORE_PARAMS":case "BILLBOARD":case "BILLBOARD_RANDOM":case "HAIR_BILLBOARD":case "USE_ENVIRONMENT_LIGHT":case "USE_FOG":case "WO_SKYBLEND":case "WO_SKYPAPER":case "WO_SKYREAL":case "WO_SKYTEX":case "WOMAP_BLEND":case "WOMAP_HORIZ":case "WOMAP_ZENUP":case "WOMAP_ZENDOWN":case "WIREFRAME_QUALITY":case "SIZE_RAMP_LENGTH":case "COLOR_RAMP_LENGTH":case "PARTICLES_SHADELESS":case "SMAA_JITTER":case "NUM_CAST_LAMPS":case "SUN_NUM":case "MAC_OS_SHADOW_HACK":case "USE_COLOR_RAMP":case "HALO_PARTICLES":case "PARTICLE_BATCH":case "HAS_REFRACT_TEXTURE":case "USE_INSTANCED_PARTCLS":case "USE_TBN_SHADING":case "CALC_TBN":case "MAT_USE_TBN_SHADING":k=
0;break;case "ALPHA_AS_SPEC":case "BEND_CENTER_ONLY":case "CSM_BLEND_BETWEEEN_CASCADES":case "CSM_FADE_LAST_CASCADE":case "DEPTH_RGBA":case "BILLBOARD_SPHERICAL":case "NUM_LAMP_LIGHTS":case "MAX_STEPS":k=1;break;case "EPSILON":k="highp"==x.v.precision?1E-6:1E-4;break;case "SHADOW_TEX_RES":k=E(2048);break;case "AA_METHOD":k="AA_METHOD_FXAA_QUALITY";break;case "AU_QUALIFIER":k="NOT_ASSIGNED";break;case "BILLBOARD_ALIGN":k="BILLBOARD_ALIGN_VIEW";break;case "POST_EFFECT":k="POST_EFFECT_NONE";break;case "SHADOW_USAGE":k=
"NO_SHADOWS";break;case "SSAO_QUALITY":k="SSAO_QUALITY_32";break;case "TEXTURE_BLEND_TYPE":k="TEXTURE_BLEND_TYPE_MIX";break;case "TEXTURE_COORDS":k="TEXTURE_COORDS_UV_ORCO";break;case "PRECISION":k=x.v.precision;break;case "VERTEX_ANIM_MIX_NORMALS_FACTOR":k="u_va_frame_factor";break;default:t.error("Unknown directive ("+a.oj+", "+a.zg+"): "+d)}e(a,d,k)}};a.LQ=function(a){return a.oj};a.CQ=function(a){return a.zg};a.UQ=function(a,b){for(var d=b.nh,k=0;k<d.length;k++){var f=d[k][0],h=d[k][1];c(a,f)&&
e(a,f,h)}};a.xJ=function(a){a.status=0;var b=JSON.stringify(a),c=S[b];if(c)return c;var d=a.zg,c=B(z.shaders_dir,a.oj),d=B(z.shaders_dir,d);if(!c||!d)return null;var e=l("vert",c,a),f=l("frag",d,a),c=0;n(f,K)>v.KA&&(c|=1);n(f,X)>v.iv&&(c|=2);n(e,X)>v.nv&&(c|=4);(u.pc?(e.replace(/(.*?)\([^()]*?\)(.*?)/g,"$1$2").match(/(?:^|[^a-zA-Z_])in(?=\s)/g)||[]).length:(e.match(/(?:^|[^a-zA-Z_])attribute(?=\s)/g)||[]).length)>v.LA&&(c|=8);r(f)||(c|=16);a.status=c;if(0===a.status){var c=la,h=D(c,b,e,c.VERTEX_SHADER),
g=D(c,b,f,c.FRAGMENT_SHADER),d=c.createProgram();c.attachShader(d,h);c.attachShader(d,g);c.linkProgram(d);c.validateProgram(d);c.getProgramParameter(d,c.VALIDATE_STATUS)==c.qP&&t.error("shader program is not valid",b);k.FG(d,b,h,g,e,f);a={dD:h,xz:g,Ui:d,attributes:{},Qk:{},Jo:M.pi(),Lv:M.pi(),Mv:{},Bo:!0,Fr:!1,EC:M.pi(),DC:M.pi(),Va:M.ki(a),$o:b,ld:!0};f=c.getProgramParameter(d,c.ACTIVE_ATTRIBUTES);for(e=0;e<f;e++)h=c.getActiveAttrib(d,e).name,a.attributes[h]=c.getAttribLocation(d,h);f=c.getProgramParameter(d,
c.ACTIVE_UNIFORMS);for(e=0;e<f;e++)h=c.getActiveUniform(d,e).name.split("[0]").join(""),a.Qk[h]=c.getUniformLocation(d,h);S[b]=c=a}else c=null;return c};a.MK=function(){O=!1;if(b4w.module_check("shader_texts"))O=!0;else{for(var a=[],b=G.AT_TEXT,c=0;c<F.length;c++){var d=M.Co(z.shaders_dir+F[c]);a.push({id:F[c],type:b,url:d})}b=function(a,b){W||(W={});W[b]=a};a.length?G.enqueue(a,b,function(){O=!0}):t.error("Shaders have not been found.")}};a.GG=function(){return O};a.dQ=function(){return T};a.Lz=
function(){return S};a.cleanup=function(){for(var a in S)w(S[a]);for(var b in C)delete C[b];for(var c in T)delete T[c];da=null};a.PG=w;a.eQ=function(a){var b=a.nh;t.log("Shader: "+a.oj+" "+a.zg+", "+String(b.length)+" directives: ");for(a=0;a<b.length;a++)t.log("  "+b[a][0],b[a][1])};a.D=E;a.Cy=function(a,b){return b in a.Qk?!0:!1};a.reset=function(){la=null}};b4w.module.__geometry=function(a,p){function e(a,b){for(var c=1;c<a.Ga.length;c++){for(var d=a.Ga[c].Md,k=d.a_position,e=d.a_normal,f=b.a_position,h=b.a_normal,l=k.length,g=a.Ga[c].dr,t=0;t<l;t++)f[t]+=g*k[t],h[t]+=g*e[t];d=d.a_tangent;k=b.a_tangent;e=d.length;for(t=0;t<e;t++)k[t]+=g*d[t]}}function c(a){return 65536<a.va?M.Nz()?!1:!0:!1}function b(a){return 0<a.lb.length?!0:!1}function n(a,c,d){if(!b(a))return a;d||u.log('%cDEBUG max vertices exceeded for indexed submesh "'+a.name+'": '+a.va*(c||
1)+", will use drawArrays","color: #aa0");c=a.lb;d=a.va;var k=a.ga,e=a.O,f;for(f in k){var l=k[f],g=w(l,d);k[f]=h(c,l,g)}for(k=0;k<e.length;k++){var t=e[k];for(f in t)l=t[f],g=w(l,d),t[f]=h(c,l,g)}for(k=0;k<a.Ga.length;k++){f=a.Ga[k].Md;for(var n in f)l=f[n],g=w(l,d),f[n]=h(c,l,g)}a.va=c.length;a.lb=new Uint16Array(0);return a}function h(a,b,c){if(0==b.length)return new Float32Array(0);for(var d=new Float32Array(a.length*c),k=0;k<a.length;k++)for(var e=a[k],f=0;f<c;f++)d[c*k+f]=b[c*e+f];return d}
function r(){return{ke:null,Ic:null,jk:0,count:0,vb:{},mode:0,Rk:0,tl:0,vq:0,Uh:null,rf:null,Kl:null,Ga:null,mk:1,ld:!0}}function g(a,b){var c=a.Ic,d=a.vb[b];if(d)return c.subarray(d.offset,d.offset+d.length);z.q("extract_array() failed; invalid name: "+b)}function m(b,c){var d,k;switch(c){case a.Vm:case a.Cp:d=N.TRIANGLES;k=N.STATIC_DRAW;break;case a.sx:d=N.POINTS;k=N.STATIC_DRAW;break;case a.Bp:d=N.TRIANGLES;k=N.DYNAMIC_DRAW;break;case a.lD:d=N.POINTS;k=N.DYNAMIC_DRAW;break;case a.mD:d=N.LINES;
k=N.STATIC_DRAW;break;default:z.q("Wrong draw_mode")}b.mode=d;b.Rk=k}function q(a){a.ke?(a.rf||(a.rf=N.createBuffer()),N.bindBuffer(N.ELEMENT_ARRAY_BUFFER,a.rf),N.bufferData(N.ELEMENT_ARRAY_BUFFER,a.ke,a.Rk),a.tl=a.ke.byteLength):a.tl=0;a.Uh||(a.Uh=N.createBuffer());N.bindBuffer(N.ARRAY_BUFFER,a.Uh);N.bufferData(N.ARRAY_BUFFER,a.Ic,a.Rk);a.vq=a.Ic.byteLength}function B(a){var b=a[0],c;c=a[0];if(c.Dg){var d=z.I(c);d.name="INSTANCED_ARRAY_SUBMESH"}else{for(var d=z.Nc("JOIN_"+a.length+"_SUBMESHES"),
k=0,e=0;e<a.length;e++)k+=a[e].lb.length;d.lb=new Uint32Array(k);var f=k=0,h=0;if(0<a[0].Ga.length)for(var l=0;l<a[0].Ga.length;l++){for(e=0;e<a.length;e++)k+=a[e].Ga[l].Md.a_position.length,f+=a[e].Ga[l].Md.a_normal.length,h+=a[e].Ga[l].Md.a_tangent.length;e={a_position:new Float32Array(k),a_normal:new Float32Array(f),a_tangent:new Float32Array(h)};d.Ga.push({dr:a[0].Ga[l].dr,Md:e})}for(e=k=0;e<a.length;e++)k+=a[e].va;d.va=k;for(var g in c.ga){for(e=k=0;e<a.length;e++)k+=a[e].ga[g].length;d.ga[g]=
new Float32Array(k)}for(g in c.O[0]){for(e=k=0;e<a.length;e++)k+=a[e].O[0][g].length;for(e=0;e<c.O.length;e++)d.O[e]=d.O[e]||{},d.O[e][g]=new Float32Array(k)}}c=d;h=c.Rd;h.K=t.ii(b.Rd.K);h.Z=t.ji(b.Rd.Z);h.U=t.ii(b.Rd.U);h.Ca=t.ji(b.Rd.Ca);var n=l=0,m=[],d=[];g={};e={};for(k=0;k<a.length;k++){var x=a[k],u=x.lb,q=x.va,B=x.ga;t.Zn(x.Rd.K,X);t.Yn(h.K,x.Rd.K);for(f=0;f<X.length;f++)m.push(X[f]);var A=a[k].Dg;if(A){x=A.Gm;q=A.rs;for(f=0;f<x.length;f++)B=x[f],A.Tn||(B=v.multiply(q,x[f],v.create())),d.push(B);
var f=A.jp,r;for(r in f)r in g||(g[r]=[f[r][0]]);x=A.Fk;for(r in x)for((r in e)||(e[r]={Jb:x[r].Jb,data:[]}),q=x[r].data,A=e[r].data,f=0;f<q.length;f++)A.push(q[f])}else{for(f=0;f<u.length;f++)c.lb[l+f]=u[f]+n;var l=l+u.length,y;for(y in B)A=B[y],u=n*w(A,q),c.ga[y].set(A,u);for(f=0;f<x.O.length;f++){var B=x.O[f],D=c.O[f];for(y in B)A=B[y],u=n*w(A,q),D[y].set(A,u)}n+=q}}c.Rd.Z=t.oq(z.f32(m),!0);if(0<c.Ga.length)for(k=0;k<c.Ga.length;k++)for(r=c.Ga[k].Md,f=l=h=y=0;f<a.length;f++)n=a[f].Ga[k].Md,r.a_position.set(n.a_position,
y),r.a_normal.set(n.a_normal,h),r.a_tangent.set(n.a_tangent,l),y+=n.a_position.length,h+=n.a_normal.length,l+=n.a_tangent.length;d.length&&(c.Dg={Gm:d,rs:null,gC:!0,jp:g,Fk:e,Tn:b.Dg.Tn});return c}function d(a,b,c,d){c=c.Rd;var k=t.Wc();c.K||(c.K=t.Wc());for(var e=[],f=d.length,h=0;h<f;h++){k=t.fh(b.Rd.U,d[h],k);t.Yn(c.U,k);k=t.fh(k,a.k.m,k);t.Yn(c.K,k);t.Zn(k,X);for(var l=0;l<X.length;l++)e.push(X[l])}c.Z=t.oq(z.f32(e),!0);c.Ca=t.Ct(c.Z,a.k.m)}function l(a,b,c,d,k,e){var h=a.submeshes[b],l=h.base_length,
g=a.materials[b],v=z.Nc("SUBMESH_"+a.name+"_"+g.name);v.va=l;var m=!1;if(H(c,"a_texcoord")){var x=null,q=a.materials[b];b=a.submeshes[b];if(q.texture_slots.length)switch(q=q.texture_slots[0],q.texture_coords){case "UV":q=a.uv_textures.indexOf(q.uv_layer);0==q?x=new Float32Array(b.texcoord):1==q&&(x=new Float32Array(b.texcoord2));break;case "ORCO":for(var w=a.b4w_bounding_box_source,x=new Float32Array(2*b.base_length),q=(w.max_x+w.min_x)/2,B=(w.max_z+w.min_z)/2,A=w.max_x-w.min_x,w=w.max_z-w.min_z,
r=0,I=0;I<b.position.length;I+=3)x[r++]=(b.position[I]-q)/A+.5,x[r++]=(B-b.position[I+2])/w+.5}null===x&&(x=new Float32Array(2*b.base_length));b=x}else b=new Float32Array(0);if(H(c,"a_orco_tex_coord")){x=a.b4w_bounding_box_source;q=new Float32Array(3*h.base_length);B=x.max_x-x.min_x;A=x.max_y-x.min_y;w=x.max_z-x.min_z;for(I=r=0;I<h.position.length;I+=3)0==B?q[r++]=.5:q[r++]=z.clamp(parseFloat(((h.position[I]-x.min_x)/B).toFixed(5)),0,1),0==w?q[r++]=.5:q[r++]=z.clamp(parseFloat(((x.max_z-h.position[I+
2])/w).toFixed(5)),0,1),0==A?q[r++]=.5:q[r++]=z.clamp(parseFloat(((h.position[I+1]-x.min_y)/A).toFixed(5)),0,1);x=q}else x=new Float32Array(0);var y,q=h.group;if(H(c,"a_influence")&&d){B=new Float32Array(4*l);A=q.length/l;w=new Float32Array(A);for(r=0;r<A;r++)for(y in w[r]=-1,d)if(I=d[y],I.YC===r){w[r]=I.ju;break}var p=3<A?A:4;d=new Float32Array(p);y=new Uint32Array(p);for(var r=new Float32Array(4),I=new Float32Array(p),p=new Uint32Array(p),C=new Float32Array(4),J=0;J<l;J++)d.set(I),y.set(p),r.set(C),
B.set(D(q,A,J,l,w,d,y,r),4*J)}else B=new Float32Array(0);y=B;d=k?z.I(k):{};d.a_color={fk:!0};d.a_color.src=H(c,"a_color")&&a.active_vcol_name?[{name:a.active_vcol_name,tf:7}]:[];k={a_texcoord:b,a_influence:y,a_orco_tex_coord:x};y=h.vertex_colors;b=h.color;x=a.name;q=[];for(B=0;B<y.length;B++)q.push(y[B].name);for(var aa in d)if(B=d[aa].src,B.length){for(w=A=0;w<B.length;w++)A+=z.Jk(B[w].tf);k[aa]=new Float32Array(A*l);for(w=r=0;w<B.length;w++){var V=B[w].name,I=B[w].tf,p=z.AB(I),M=q.indexOf(V);-1==
M&&z.q('vertex color "'+V+'" for mesh "'+x+'" not found.');C=y[M].mask;J=z.Jk(C);(I&C)!==I&&u.error("Wrong color extraction from "+V+" to "+aa+".");for(var F=V=0;F<M;F++)V+=z.Jk(y[F].mask);M=V*l;for(V=0;V<l;V++)for(F=0;3>F;F++)p[F]&&(k[aa][V*A+(r+z.jm(I,F))]=b[M+V*J+z.jm(C,F)]);r+=J}}else k[aa]=new Float32Array(0);aa=a.uv_textures;d=h.texcoord;y=h.texcoord2;if(e)for(var E in e){b=aa.indexOf(E);if(0==b)var K=new Float32Array(d);else 1==b&&(K=new Float32Array(y));k[e[E]]=K}v.ga=k;v.lb=new Uint32Array(h.indices);
e=h.position.length/l/3;K=(E=H(c,"a_normal")&&h.normal.length?!0:!1)&&H(c,"a_tangent")&&h.tangent.length?!0:!1;aa=H(c,"a_shade_tangs")&&h.shade_tangs.length?!0:!1;k=g.texture_slots[0];k=E&&g.texture_slots.length&&H(c,"a_tangent")&&"ORCO"==k.texture_coords&&k.use_map_normal?!0:!1;0<a.b4w_shape_keys.length&&(m=!0);for(d=0;d<e;d++){g=f(h,c,l,E,K,aa,k,d,a.name);if(m)if(y={},y.name=a.b4w_shape_keys[d].name,v.Ga.push(y),0!=d){y.Md=g;y.dr=a.b4w_shape_keys[d].value;continue}else y.Md=f(h,c,l,E,K,aa,k,d,a.name),
y.dr=1;v.O.push(g)}if(1<e&&!m){a=v.O[0];var g={},S;for(S in a)g[S]=new Float32Array(a[S]);v.O.push(g)}H(c,"a_polyindex")&&(n(v,1,!0),v.ga.a_polyindex=G(v));c=h.boundings;h=c.bounding_ellipsoid_axes;c={U:{max_x:c.bounding_box.max_x,max_y:c.bounding_box.max_y,max_z:c.bounding_box.max_z,min_x:c.bounding_box.min_x,min_y:c.bounding_box.min_y,min_z:c.bounding_box.min_z},Ca:t.nn([h[0],0,0],[0,h[1],0],[0,0,h[2]],c.bounding_ellipsoid_center,[0,0,0,1]),K:null,Z:null};v.Rd=c;return v}function f(a,b,c,d,k,e,
f,h,l){var g={},t=new Float32Array(3*c),n=new Float32Array(d?3*c:0),v=new Float32Array(k||f?4*c:0),x=h*c*3;t.set(a.position.subarray(x,x+3*c),0);d&&(x=h*c*3,n.set(a.normal.subarray(x,x+3*c),0));if(k)x=h*c*4,v.set(a.tangent.subarray(x,x+4*c),0);else if(f)for(b=v,u.warn('Not precise tangents calculation for normalmap using GENERATED texture coordinates in mesh: "'+l+'". Please add a UV-map.'),l=0;l<c;l++)d=C,k=W,d[0]=n[3*l],d[1]=n[3*l+1],d[2]=n[3*l+2],S.cross(d,z.AXIS_Z,k),0==S.length(k)&&S.cross(d,
z.AXIS_X,k),S.normalize(k,k),b[4*l]=k[0],b[4*l+1]=k[1],b[4*l+2]=k[2],b[4*l+3]=1;else if(d&&H(b,"a_tangent"))for(v=new Float32Array(4*c),l=0;l<v.length;l++)v[l]=1;e&&(e=new Float32Array(3*c),e.set(a.shade_tangs.subarray(0,3*c),0),g.a_shade_tangs=e);g.a_position=t;g.a_normal=n;g.a_tangent=v;return g}function H(a,b){return-1<a.indexOf(b)?!0:!1}function D(b,c,d,k,e,f,h,l){for(var g=!0,t=0;t<c;t++){var n=b[t*k+d];if(-1!==n){var v=e[t];-1!==v&&(f[t]=n,h[t]=v,g=!1)}}if(g)return l;E(f,h,a.it,!1);for(t=b=
0;4>t;t++)b+=f[t];if(.01>b)return l;for(t=0;4>t;t++)f[t]/=b;if(.01>Math.abs(f[0]-1))l[0]=h[0]+1;else for(t=0;4>t;t++)l[t]=h[t]+f[t];return l}function w(a,b){if(0==b)return 0;var c=a.length,d=c/b;d!=Math.floor(d)&&z.q("Array size mismatch during geometry calculation: array length="+c+", base length="+b);return d}function E(b,c,d,k){for(var e=b.length,f=e,h=!1,l=k?-1:1;1<f||h;){1<f&&(f=Math.floor(f/1.247330950103979));for(var h=!1,g=0;f+g<e;g++)if(d==a.it?0>l*(b[g]-b[g+f]):b[g]<b[g+f]&&k)h=b[g],b[g]=
b[g+f],b[g+f]=h,h=c[g],c[g]=c[g+f],c[g+f]=h,h=!0}}function y(a,b,c){var d=[],k=[];S.subtract(b,a,d);S.subtract(c,a,k);S.normalize(d,d);S.normalize(k,k);return Math.acos(S.dot(d,k))}function A(a,c,d){c||(c=[]);d=d?a.O[0].a_normal:a.O[0].a_position;if(b(a)){a=a.lb;for(var k=a.length/3,e=0;e<k;e++){var f=new Float32Array(9),h=a[3*e];f[0]=d[3*h];f[1]=d[3*h+1];f[2]=d[3*h+2];h=a[3*e+1];f[3]=d[3*h];f[4]=d[3*h+1];f[5]=d[3*h+2];h=a[3*e+2];f[6]=d[3*h];f[7]=d[3*h+1];f[8]=d[3*h+2];c[e]=f}}else for(e=0;e<d.length;e++)f=
new Float32Array(9),f[0]=d[9*e],f[1]=d[9*e+1],f[2]=d[9*e+2],f[3]=d[9*e+3],f[4]=d[9*e+4],f[5]=d[9*e+5],f[6]=d[9*e+6],f[7]=d[9*e+7],f[8]=d[9*e+8],c[e]=f;return c}function G(a){for(var b=new Float32Array(a.va),c=0;c<a.va;c++)b[c]=c%3;return b}function x(a,b,c){var d=S.dist(a,b);a=S.dist(a,c);b=S.dist(b,c);c=(d+a+b)/2;return c*(c-d)*(c-a)*(c-b)}function k(a,b,c,d,k){c-=b;for(var e=0;e<c;e+=d)e%d==k&&vec3.normalize(a.subarray(e+b-k,e+b+1),a.subarray(e+b-k,e+b+1))}var t=p("__boundings"),M=p("__extensions"),
u=p("__print"),v=p("__tsr"),z=p("__util"),S=p("__vec3");new Float32Array(2);var C=new Float32Array(3),W=new Float32Array(3),F=new Float32Array(3),K=new Float32Array(8),X=new Float32Array(24);a.Cp=10;a.sx=20;a.Bp=30;a.lD=40;a.mD=50;a.it=0;a.PE=1;a.Vm=a.Cp;var N=null;a.Ve=function(a){N=a};a.yN=function(a,d,k,f){c(a)&&n(a);var h=a.lb,l=a.va,g=a.O,x={},u;for(u in a.ga)u in f&&!f[u].fk||(x[u]=a.ga[u]);f=r();0<a.Ga.length&&e(a,g[0]);u=a.Dg;if(h.length){var B=h.length;if(65536>=l)var z=new Uint16Array(h),
A=N.UNSIGNED_SHORT;else z=new Uint32Array(h),A=N.UNSIGNED_INT}else B=l,z=null;var y,D=0,G=g.length;for(y in g[0])var p=g[0][y],D=D+p.length*G;for(y in x)p=x[y],D+=p.length;y=D;D=0;if(u){var G=u.Gm.length,D=D+8*G,p=u.Fk,C;for(C in p)D+=p[C].Jb*G;p=u.jp;for(C in p)D+=G}C=new Float32Array(y+D);var G=0,D={},I;for(I in x){var M=x[I];if(p=M.length)C.set(M,G),D[I]={JP:I,Jb:w(M,l),offset:G,frames:1,length:p,We:0,wg:0},G+=p}x=g.length;for(I in g[0])if(M=g[0][I],p=M.length,M=w(M,l),p){D[I]={Jb:M,offset:G,frames:x,
length:p,We:0,wg:0};1<x&&(D[I+"_next"]={Jb:M,offset:G+p,frames:x,length:p,We:0,wg:0});for(var F=0;F<x;F++)M=g[F][I],C.set(M,G),G+=p}if(u){G=u.Gm;x=[];p=u.rs;l=u.Fk;g=u.jp;G=u.Gm;p=u.rs;l=u.Fk;g=u.jp;M=u.gC;for(F=0;F<G.length;F++){I=G[F];M&&p&&!u.Tn&&(I=v.multiply(p,G[F],K));!M&&u.Tn&&S.subtract(G[F],p,G[F]);x.push(I[0],I[1],I[2],I[3],I[4],I[5],I[6],I[7]);for(var E in l){I=l[E].Jb;for(var J=0;J<I;J++)x.push(l[E].data[F*I+J])}for(E in g)x.push(g[E][0])}G=8;for(E in l)G+=l[E].Jb;for(E in g)G++;C.set(x,
y);I={wg:1,Jb:4,We:G,offset:y+4,frames:1,length:0};D.a_part_ts={wg:1,Jb:4,We:G,offset:y,frames:1,length:0};D.a_part_r=I;x=8;for(E in l)I=l[E].Jb,p={wg:1,Jb:I,We:G,offset:y+x,frames:1,length:0},D[E]=p,x+=I;for(E in g)p={wg:1,Jb:1,We:G,offset:y+x,frames:1,length:0},D[E]=p,x++;f.mk=u.Gm.length}f.count=B;f.ke=z;f.Ic=C;f.jk=A;f.vb=D;m(f,k);q(f);d&&b(a)&&(f.Kl={eL:new Float32Array(h.length),fL:new Float32Array(h.length),qI:new Float32Array(h.length/3),iD:new Float32Array(3),XF:t.iG(a.Rd.U)});f.Ga=a.Ga;
return f};a.wN=e;a.oK=c;a.nK=b;a.ts=n;a.GC=function(a,b,c){m(a,b);a.count=c.length;a.ke=c;a.jk=c instanceof Uint16Array?N.UNSIGNED_SHORT:N.UNSIGNED_INT};a.FC=function(a,b,c,d){var k=a.Ic,e=a.vb,f=e[b];f?(c&&f.Jb!=c&&z.q('invalid num_comp for "'+b+'"'),k.set(d,f.offset)):(k=k.length,f=new Float32Array(k+d.length),f.set(a.Ic),f.set(d,k),a.Ic=f,e[b]={Jb:c,offset:k});q(a)};a.JI=g;a.kR=function(a){a.Rk=N.STATIC_DRAW};a.WK=function(a){a.Rk=N.DYNAMIC_DRAW};a.Zw=q;a.NG=function(a){a.rf&&N.deleteBuffer(a.rf);
a.Uh&&N.deleteBuffer(a.Uh)};a.cA=function(a,b){return a.submeshes[b].base_length?!1:!0};a.zw=function(a,b){for(var c=0;c<a.O.length;c++){var d=a.O[c].a_position;v.transform_vectors(d,b,d,0);d=a.O[c].a_normal;0<d.length&&v.transform_dir_vectors(d,b,d,0);d=a.O[c].a_tangent;0<d.length&&v.transform_tangents(d,b,d,0);(d=a.O[c].a_shade_tangs)&&0<d.length&&v.transform_dir_vectors(d,b,d,0)}(c=a.ga.au_center_pos)&&c.length&&v.transform_vectors(c,b,c,0);return a};a.vN=function(a,b){var c=a.ga.au_center_pos;
if(c&&c.length){var d=new Float32Array(c);v.transform_vectors(d,b,d,0);for(var k=0;k<a.O.length;k++)for(var e=0;e<d.length;e++)a.O[k].a_position[e]+=d[e]-c[e];c.set(d)}else z.q('Attribute "au_center_pos" is missing in particle submesh')};a.uN=function(a,b){var c=a.va,d;for(d in b){var k=b[d].length;a.ga[d]=new Float32Array(k*c);for(var e=0;e<c;e++)for(var f=0;f<k;f++)a.ga[d][e*k+f]=b[d][f]}};a.xN=B;a.VK=function(a,b,c,k){if(!a.va)return z.Nc("EMPTY");var e=c.length;65536<a.va*e&&!M.Nz()&&n(a,e);var f=
a.lb,h=a.va,l=a.ga,g=a.O,t;for(t in b){var x=b[t].length,m=x*h;l[t]=new Float32Array(m);for(var u=0;u<h;u++)for(m=0;m<x;m++)l[t][u*x+m]=b[t][m]}b=z.Nc("CLONE_"+e+"_SUBMESHES");b.va=h*e;b.lb=new Uint32Array(f.length*e);for(u=0;u<e;u++)for(x=f.length*u,t=h*u,m=0;m<f.length;m++)b.lb[x+m]=f[m]+t;for(var q in l)for(f=l[q],m=f.length*e,x=w(f,h),b.ga[q]=new Float32Array(m),u=0;u<e;u++)t=h*x*u,b.ga[q].set(f,t);for(q in g[0])for(u=0;u<g.length;u++)for(f=g[u][q],m=f.length*e,x=w(f,h),b.O[u]=b.O[u]||{},b.O[u][q]=
new Float32Array(m),m=0;m<e;m++)switch(l=c[m],t=h*x*m,q){case "a_position":v.transform_vectors(f,l,b.O[u][q],t);break;case "a_normal":v.transform_dir_vectors(f,l,b.O[u][q],t);break;case "a_tangent":v.transform_tangents(f,l,b.O[u][q],t);break;default:z.q("Wrong attribute name: "+q)}d(k,a,b,c);return b};a.oy=d;a.mz=l;a.LI=function(a){var b=a.va,c=a.O[0].a_position,d=new Float32Array(12*b),k=new Float32Array(8*b);a=new Uint32Array(4*a.lb.length);for(var e=new Float32Array(4*b),f=0;f<b;f++){d[12*f]=c[3*
f];d[12*f+1]=c[3*f+1];d[12*f+2]=c[3*f+2];d[12*f+3]=c[3*f];d[12*f+4]=c[3*f+1];d[12*f+5]=c[3*f+2];d[12*f+6]=c[3*f];d[12*f+7]=c[3*f+1];d[12*f+8]=c[3*f+2];d[12*f+9]=c[3*f];d[12*f+10]=c[3*f+1];d[12*f+11]=c[3*f+2];k[8*f]=-.5;k[8*f+1]=-.5;k[8*f+2]=-.5;k[8*f+3]=.5;k[8*f+4]=.5;k[8*f+5]=.5;k[8*f+6]=.5;k[8*f+7]=-.5;a[6*f]=4*f+2;a[6*f+1]=4*f+1;a[6*f+2]=4*f;a[6*f+3]=4*f+2;a[6*f+4]=4*f;a[6*f+5]=4*f+3;var h=Math.random();e[4*f]=h;e[4*f+1]=h;e[4*f+2]=h;e[4*f+3]=h}c=z.Nc("HALO");c.O[0]={};c.va=4*b;c.O[0].a_position=
d;c.ga.a_halo_bb_vertex=k;c.ga.a_random_vals=e;c.lb=a;return c};a.YJ=H;a.nz=function(a,b,c,d){for(var k=[],f=0;f<a.submeshes.length;f++){var e=l(a,f,b,null,c,null);if(e.va){var h=e.Rd;d&&(h.K=t.fh(h.U,d.m),h.Z=t.pl(h.Ca,d.m));k.push(e)}}return 0==k.length?z.Nc("EMPTY"):1==k.length?k[0]:B(k)};a.WN=function(a,b,c){for(var d=a.ke,k=g(a,"a_position"),f=a.Kl,e=f.eL,h=f.fL,f=f.qI,l=d,t=l.length/3,n=0;n<t;n++){var x=l[3*n],u=l[3*n+1],m=l[3*n+2],q=k[3*x+1],w=k[3*x+2],B=k[3*u+1],z=k[3*u+2],A=k[3*m+1],r=k[3*
m+2];e[3*n]=(k[3*x]+k[3*u]+k[3*m])/3;e[3*n+1]=(q+B+A)/3;e[3*n+2]=(w+z+r)/3}v.transform_vectors(e,b,h);b=h.length/3;for(k=0;k<b;k++)e=h[3*k]-c[0],l=h[3*k+1]-c[1],t=h[3*k+2]-c[2],f[k]=e*e+l*l+t*t;c=d;d=f.length;if(!(2>d))for(h=d,k=!1;1<h||k;)for(1<h&&(h=Math.floor(h/1.247330950103979)),k=!1,b=0;h+b<d;b++)0>f[b]-f[b+h]&&(k=f[b],f[b]=f[b+h],f[b+h]=k,k=c,e=b,l=b+h,t=k[3*e],n=k[3*e+1],x=k[3*e+2],k[3*e]=k[3*l],k[3*e+1]=k[3*l+1],k[3*e+2]=k[3*l+2],k[3*l]=t,k[3*l+1]=n,k[3*l+2]=x,k=!0);d=c;N.bindBuffer(N.ELEMENT_ARRAY_BUFFER,
a.rf);N.bufferData(N.ELEMENT_ARRAY_BUFFER,d,N.DYNAMIC_DRAW)};a.$B=E;a.my=function(a,b,c){for(var d=b.length/3,k=a.length/3,f=[],e=Array(3),h=Array(3),l=Array(3),g=0;g<k;g++){for(var t=a[3*g],n=a[3*g+1],x=a[3*g+2],v=0;3>v;v++)e[v]=b[3*t+v],h[v]=b[3*n+v],l[v]=b[3*x+v];if(c)var v=y(e,h,l),u=y(h,l,e),m=Math.PI-v-u;else m=u=v=1;var q=f,w;w=e;var B=l,z=[],A=[],J=[];S.subtract(h,w,z);S.subtract(B,w,A);S.cross(z,A,J);S.normalize(J,J);w=J;for(B=0;3>B;B++)z=3*n+B,A=3*x+B,q[3*t+B]=v*w[B],q[z]=u*w[B],q[A]=m*
w[B]}if(c)for(var aa in c)for(g=c[aa],a=0;3>a;a++){b=3*g[0]+a;for(k=1;k<g.length;k++)e=3*g[k]+a,f[b]+=f[e];for(k=1;k<g.length;k++)e=3*g[k]+a,f[e]=f[b]}for(g=0;g<d;g++){c=g;aa=f;a=new Float32Array(3);for(b=0;3>b;b++)k=3*c+b,a[b]=aa[k];S.normalize(a,a);for(b=0;3>b;b++)k=3*c+b,aa[k]=a[b]}return f};a.ny=function(a,b,c){for(var d={},k=b.length/3,f=0;f<k;f++){var e=String(b[3*f])+String(b[3*f+1])+String(b[3*f+2]);d[e]=[]}k=a.length;for(f=0;f<k;f++)b=a[f],e=String(c[3*b])+String(c[3*b+1])+String(c[3*b+2]),
e in d&&d[e].push(b);return d};a.zu=function(a,b,c,d){var k=A(a,null,!1);if(c)var f=A(a,null,!0);var e=k.length,h=new Float32Array(e),l=C,g=W;for(a=0;a<e;a++){var t=k[a];l.set(t.subarray(0,3));g.set(t.subarray(3,6));F.set(t.subarray(6));h[a]=Math.sqrt(x(l,g,F))}l=new Float32Array(e);l[0]=h[0];for(a=1;a<e;a++)l[a]=l[a-1]+h[a];e=l[h.length-1];h=[];for(a=0;a<b;a++){var g=e*z.yf(d),g=z.aq(l,g,0,l.length-1),t=c?f[g]:k[g],g=a,n=t,v=d,t=void 0,t=new Float32Array(3),u=n[0],m=n[1],q=n[2],w=n[3],B=n[4],r=n[5],
y=n[6],D=n[7],J=n[8],n=z.yf(v),v=z.yf(v);1<n+v&&(n=1-n,v=1-v);var aa=1-n-v,m=aa*m+n*B+v*D,q=aa*q+n*r+v*J;t[0]=aa*u+n*w+v*y;t[1]=m;t[2]=q;h[g]=t}return h};a.jQ=A;a.Dq=G;a.MR=x;a.FB=function(a,b,c){a=a.O[0].a_position;for(var d=0;d<a.length;d+=3)a[d]=(a[d]-c[0])*b[0]+c[0],a[d+1]=(a[d+1]-c[1])*b[1]+c[1],a[d+2]=(a[d+2]-c[2])*b[2]+c[2]};a.Ux=function(a,b,c){var d=a.C[0].P;a=a.k.Og;for(var f=1;f<a.length;f++)a[f].name==b&&(a[f].value=c);for(f=0;f<d.length;f++)if(!d[f].of&&d[f].Ud&&!d[f].lh){c=d[f].aa.vb;
b=d[f].aa.Ic;N.bindBuffer(N.ARRAY_BUFFER,d[f].aa.Uh);var e=c.a_position,h=d[f],l=b,g=a;if(e){for(var t=e.offset,e=e.length+t,n=h.aa.Ga[0].Md.a_position,v=t;v<e;v++)l[v]=n[v-t];for(v=1;v<h.aa.Ga.length;v++){var n=h.aa.Ga[v].Md.a_position,x=g[v].value;if(x)for(var u=t;u<e;u++)l[u]+=x*n[u-t]}N.bufferSubData(N.ARRAY_BUFFER,4*t,l.subarray(t))}e=c.a_normal;h=d[f];l=b;g=a;if(e){t=e.offset;e=e.length+t;n=h.aa.Ga[0].Md.a_normal;for(v=t;v<e;v++)l[v]=n[v-t];for(v=1;v<h.aa.Ga.length;v++)if(n=h.aa.Ga[v].Md.a_normal,
x=g[v].value)for(u=t;u<e;u++)l[u]+=x*n[u-t];k(l,t,e,3,2);N.bufferSubData(N.ARRAY_BUFFER,4*t,l.subarray(t))}g=c.a_tangent;c=d[f];h=a;if(g){l=g.offset;g=g.length+l;e=c.aa.Ga[0].Md.a_tangent;for(t=l;t<g;t++)b[t]=e[t-l];for(t=1;t<c.aa.Ga.length;t++)if(e=c.aa.Ga[t].Md.a_tangent,v=h[t].value)for(n=l;n<g;n++)b[n]+=v*e[n-l];k(b,l,g,4,3);N.bufferSubData(N.ARRAY_BUFFER,4*l,b.subarray(l))}}};a.check_shape_keys=function(a){return a.k.Ud};a.get_shape_keys_names=function(a){var b=[];if(a.k)for(var c=1;c<a.k.Og.length;c++)b.push(a.k.Og[c].name);
return b};a.get_shape_key_value=function(a,b){if(a.k)for(var c=1;c<a.k.Og.length;c++)if(b==a.k.Og[c].name)return a.k.Og[c].value;return 0};a.Pu=function(a,b){var c=a.k.Og;if(c)for(var d=1;d<c.length;d++)if(c[d].name==b)return!0;return!1};a.Jl=function(a){return a&&a.k&&a.k.he?!0:!1};a.draw_line=function(b,c,d){var k=b.aa;if(k){for(var f=d?c.length/3/2:c.length/3-1,e=new Float32Array(12*f),h=new Float32Array(12*f),l=new Uint16Array(6*f),g=0;g<f;g++){if(d)var t=6*g,n=6*g+3;else t=3*g,n=3*(g+1);var v=
c[t],x=c[t+1],t=c[t+2],u=c[n],m=c[n+1],n=c[n+2],w=u-v,B=m-x,z=n-t;e[12*g]=v;e[12*g+1]=x;e[12*g+2]=t;h[12*g]=w;h[12*g+1]=B;h[12*g+2]=z;e[12*g+3]=u;e[12*g+4]=m;e[12*g+5]=n;h[12*g+3]=-w;h[12*g+4]=-B;h[12*g+5]=-z;e[12*g+6]=v;e[12*g+7]=x;e[12*g+8]=t;h[12*g+6]=-w;h[12*g+7]=-B;h[12*g+8]=-z;e[12*g+9]=u;e[12*g+10]=m;e[12*g+11]=n;h[12*g+9]=w;h[12*g+10]=B;h[12*g+11]=z;l[6*g]=4*g;l[6*g+1]=4*g+1;l[6*g+2]=4*g+2;l[6*g+3]=4*g;l[6*g+4]=4*g+3;l[6*g+5]=4*g+1}d=0;for(var A in k.vb)c=k.vb[A],d+=e.length/3*c.Jb;k.Ic=new Float32Array(d);
d=k.Ic;a.GC(k,b.Mf,l);b=0;for(A in k.vb)switch(c=k.vb[A],A){case "a_position":d.set(e,b);c.offset=b;c.length=e.length;b+=c.length;break;case "a_direction":d.set(h,b);c.offset=b;c.length=h.length;b+=c.length;break;default:c.offset=b,c.length=e.length/3*c.Jb,l=new Float32Array(c.length),d.set(l,b),b+=c.length}q(k)}};a.SG=function(a){var b=r();if(a.ke)switch(a.jk){case N.UNSIGNED_SHORT:b.ke=new Uint16Array(a.ke);break;case N.UNSIGNED_INT:b.ke=new Uint32Array(a.ke)}else b.ke=null;b.Ic=a.Ic?new Float32Array(a.Ic):
null;b.jk=a.jk;b.count=a.count;b.vb=z.I(a.vb);b.mode=a.mode;b.Rk=a.Rk;b.tl=a.tl;b.vq=a.vq;b.Uh=null;b.rf=null;b.Kl=z.I(a.Kl);b.Ga=z.I(a.Ga);b.mk=a.mk;b.ld=a.ld;return b};a.reset=function(){N=null}};b4w.module.__objects=function(a,p){function e(a){var b=a.C;a=a.k;for(var c=0;c<b.length;c++){var d=b[c].Ra;d.p.outline&&a.Yf&&S.YL(d)}}function c(a){a.k.Yf=0;a=ma.indexOf(a);-1!=a&&ma.splice(a,1)}function b(a){if(a.Bl)for(var b=a.C,c=0;c<b.length;c++)S.IC(b[c].Ra,a)}function n(a,b){for(var c=a.C,d=b.C,f=0;f<c.length;f++){for(var e=!1,l=0;l<d.length;l++)if(c[f].Ra==d[l].Ra){e=!0;break}e||h(b,c[f].Ra)&&k.en(b,c[f].Ra)}}function h(a,b){return!b.Ix&&"SPEAKER"==a.type||!b.cF&&("LAMP"==a.type||"CAMERA"==
a.type)?!1:!0}function r(a,b){if(a.b4w_hidden_on_load||a.dg_parent&&a.dg_parent.mt||a.parent&&a.parent.mt)return!0;switch(a.type){case "MESH":var c=a.b4w_do_not_batch,d=a.b4w_collision,k=a.b4w_vehicle,f=a.b4w_floating,e=a.b4w_character,h=t.$J(a),J=G.ky(a),n=0<a.data.b4w_shape_keys.length,v=a.b4w_dynamic_geometry;if(!(c=l.ly(a,b)||c||d||k||n||f||h||e||J||v))a:{c=a.data;for(d=0;d<c.materials.length;d++)if(k=c.materials[d],k.b4w_lens_flares||g(k.node_tree)){c=!0;break a}c=!1}return c;case "EMPTY":return c=
G.ky(a),d=a.b4w_do_not_batch,k=Boolean(a.b4w_anchor),l.ly(a,b)||c||d||k;default:return!0}}function g(a){if(!a)return!1;a=a.nodes;for(var b=0;b<a.length;b++){var c=a[b];if("VECT_TRANSFORM"==c.type){var d=c.convert_from,k=c.convert_to,f=c.Qa[0];if(!(!f.dc||"WORLD"==d&&"CAMERA"==k||"CAMERA"==d&&"WORLD"==k||"OBJECT"==d&&"OBJECT"==k))return!0}if("NORMAL_MAP"==c.type&&(d=c.space,f=c.Qa[0],f.dc&&("OBJECT"==d||"BLENDER_OBJECT"==d)))return!0}return!1}function m(a,b){var c=a.animation_data,d=a.data?a.data.animation_data:
null;c&&c.action&&(c=c.action,(c.p.type==l.OBJ_ANIM_TYPE_OBJECT||c.p.type==l.OBJ_ANIM_TYPE_ARMATURE&&"ARMATURE"==b.type||c.p.type==l.VD&&"LAMP"==b.type||c.p.type==l.UD&&"WORLD"==b.type)&&b.mh.push(l.eA(null,c)));d&&d.action&&("SPEAKER"==b.type||"LAMP"==b.type)&&b.mh.push(l.eA(null,d.action));"MESH"==b.type&&b.mh.push.apply(b.mh,l.vJ(a))}function q(a,b,c){b=T[b]||[];for(var d=[],k=0;k<b.length;k++){var f=b[k];if(f.k.ud==c||-1==c)for(var e=f.C,h=0;h<e.length;h++)e[h].Ra==a&&d.push(f)}return d}function B(a,
b,c,d){for(var f=null,e=0;e<b.length;e++){var h=b[e];if((c?h.Ak:h.name)==a&&(h.k.ud==d||-1==d)&&(f=h,!k.get_dg_parent(f)))break}return f}function d(a){T.ALL.push(a);T[a.type]||(T[a.type]=[]);T[a.type].push(a);var b=a.k.Pd;if(null!=b)for(var c=0;c<Z.length;c++){var d=Z[c];d.k.Pd==b&&d.To.push(a)}}var l=p("__animation"),f=p("__batch"),H=p("__boundings"),D=p("__camera"),w=p("__config"),E=p("__constraints"),y=p("__geometry"),A=p("__lights"),G=p("__nla"),x=p("__nodemat"),k=p("__obj_util"),t=p("__particles"),
M=p("__physics"),u=p("__print"),v=p("__primitives"),z=p("__quat"),S=p("__scenes"),C=p("__sfx"),W=p("__transform"),F=p("__textures"),K=p("__tsr"),X=p("__util"),N=p("__vec3"),L=p("__armature"),P=p("__anchors"),da=p("__renderer"),U=w.v,ga=w.fc,T={ALL:[]},la=new Float32Array(24),O=0,Q=0,Z=[],ma=[],ra=new Float32Array(3),ja=new Float32Array(4);a.dt=0;a.bt=1;a.Vc=2;a.DATA_ID_ALL=-1;a.update=function(a){for(var b=T.ARMATURE,d=0;d<ma.length;d++){var k=ma[d],f=k,h=a,l=0,g=f.cB;0==g.vs&&(g.vs=h);h-=g.vs;if(g.Xv&&
h/g.Te>=g.Xv)c(f);else{h%=g.Te;if(h<g.Hv)switch(g=h/(g.Hv/5),h=Math.floor(g),h){case 0:l=(g-h)/2;break;case 1:l=(g-h)/2+.5;break;case 2:l=1;break;case 3:l=1-(g-h)/2;break;case 4:l=.5-(g-h)/2}f.k.Yf=l}k.k.Yf&&e(k)}if(b)for(d=0;d<b.length;d++)a=b[d],a.Av&&(W.u(a),a.Av=!1)};a.set_outline_intensity=function(a,b){a.k.Yf=b;e(a)};a.apply_outline_anim=function(a,b,c,d){var k=a.cB;k.vs=0;k.Hv=b;k.Te=c;k.Xv=d;-1==ma.indexOf(a)&&ma.push(a)};a.clear_outline_anim=c;a.lj=function(a,b){b.mj=a.uuid;b.Hj=!0;m(a,b);
a.mt=b.Da=r(a,b);a.dF=!0;b.le=a.b4w_vehicle;b.is_character=a.b4w_character;b.rk=a.b4w_floating;b.Sk=a.b4w_collision;b.xb=a.b4w_collision_id;b.nq=a.b4w_correct_bounding_offset;var c=a.game;b.Zf={Rr:c.physics_type,rp:c.use_ghost,RC:c.use_sleep,Hg:c.mass,VC:c.velocity_min,UC:c.velocity_max,hu:c.damping,fw:c.rotation_damping,NK:c.lock_location_x,OK:c.lock_location_y,PK:c.lock_location_z,QK:c.lock_rotation_x,RK:c.lock_rotation_y,SK:c.lock_rotation_z,Dn:c.collision_margin,Bn:c.collision_group,En:c.collision_mask,
ax:c.use_collision_bounds,iq:c.collision_bounds_type,pp:c.use_collision_compound};if(c=a.b4w_vehicle_settings)b.we={name:c.name,oe:c.part,BN:c.suspension_rest_length,Ew:c.suspension_compression,Gw:c.suspension_stiffness,Fw:c.suspension_damping,jx:c.wheel_friction,dw:c.roll_influence,lv:c.max_suspension_travel_cm,ao:c.force_max,qn:c.brake_max,wm:c.steering_max,Wl:c.max_speed_angle,On:c.delta_tach_angle,fp:c.speed_ratio,ip:c.steering_ratio,ro:c.inverse_control,$j:c.floating_factor,$k:c.water_lin_damp,
al:c.water_rot_damp,oC:c.synchronize_position};if(c=a.b4w_floating_settings)b.Cl={name:c.name,oe:c.part,$j:c.floating_factor,$k:c.water_lin_damp,al:c.water_rot_damp,oC:c.synchronize_position};if(c=a.b4w_character_settings)b.wy={SO:c.walk_speed,eM:c.run_speed,tN:c.step_height,uK:c.jump_strength,UO:c.waterline};for(c=0;c<a.constraints.length;c++){var e=a.constraints[c];"RIGID_BODY_JOINT"==e.type&&b.Nv.push({target:e.target.xa,yL:e.pivot_type,zL:e.pivot_x,AL:e.pivot_y,BL:e.pivot_z,rd:e.axis_x,sd:e.axis_y,
td:e.axis_z,wO:e.use_limit_x,xO:e.use_limit_y,yO:e.use_limit_z,sO:e.use_angular_limit_x,tO:e.use_angular_limit_y,uO:e.use_angular_limit_z,EK:e.limit_max_x,FK:e.limit_max_y,GK:e.limit_max_z,HK:e.limit_min_x,IK:e.limit_min_y,JK:e.limit_min_z,yK:e.limit_angle_max_x,zK:e.limit_angle_max_y,AK:e.limit_angle_max_z,BK:e.limit_angle_min_x,CK:e.limit_angle_min_y,DK:e.limit_angle_min_z})}c=b.k=k.rl("MESH"===b.type?b.Da?"DYNAMIC":"STATIC":b.type);a.parent?(b.parent=a.parent.xa,"BONE"==a.parent_type&&"ARMATURE"==
a.parent.type&&(b.Go=a.parent_bone),a.pinverse_tsr&&(b.Sr=K.create(),K.copy(a.pinverse_tsr,b.Sr))):a.dg_parent&&(b.parent=a.dg_parent.xa,b.Ri=!0);var e=a.location,h=a.scale[0];X.Sv(a.rotation_quaternion,ja);W.set_translation(b,e);W.set_rotation(b,ja);W.set_scale(b,h);b.qp=a.b4w_use_default_animation;b.yj=l.qt(a.b4w_anim_behavior);a.b4w_object_tags&&(b.zr={title:a.b4w_object_tags.title,description:a.b4w_object_tags.description,category:a.b4w_object_tags.category});a.b4w_viewport_alignment&&(b.Ls={fF:a.b4w_viewport_alignment.alignment,
distance:a.b4w_viewport_alignment.distance});switch(a.type){case "ARMATURE":L.lj(a,b);e=c.be;h=l.jG(e);a.b4w_animation_mixing?(c.Bd=new Float32Array(h.fb),c.Qd=new Float32Array(h.fb),c.Ed=new Float32Array(h.trans),c.Sd=new Float32Array(h.trans)):(c.Bd=h.fb,c.Qd=h.fb,c.Ed=h.trans,c.Sd=h.trans);for(var g in e){var t=e[g];1==t.hq.length&&L.VN(t,!0,h.trans,h.fb)}c.Lo=h;c.ie=0;c.bh=a.b4w_animation_mixing;break;case "MESH":c.qi=a.b4w_do_not_render;c.di=f.VF(a.data.b4w_bounding_box);c.Ng=ga.outlining_overview_mode||
a.b4w_selectable;c.fm=a.b4w_selectable;c.fc=ga.outlining_overview_mode||a.b4w_outlining;c.em=a.b4w_outlining;c.Lr=ga.outlining_overview_mode||a.b4w_outline_on_select;c.Fe=a.b4w_billboard;c.on=a.b4w_pres_glob_orientation;c.Dj="BASIC";c.Cj="SPHERICAL"==a.b4w_billboard_geometry;g=c.xf;g.Mi=a.b4w_outline_settings.outline_duration;g.Ni=a.b4w_outline_settings.outline_period;g.Oi=a.b4w_outline_settings.outline_relapses;c.Ng&&(c.Mj=X.Az(O),O++);for(g=0;g<a.data.b4w_vertex_anim.length;g++)e=a.data.b4w_vertex_anim[g],
b.yc.push({name:e.name,la:e.frame_start,Ka:e.frame_end,LP:e.averaging,MP:e.averaging_interval,gF:e.allow_nla});b.k.yc=b.yc.length?!0:!1;"MESH"!=a.type&&X.q("Wrong object type: "+a.name);g=b.k;if(a.data.b4w_shape_keys.length)for(g.Ud=!0,e=0;e<a.data.b4w_shape_keys.length;e++)h={},h.value=a.data.b4w_shape_keys[e].value,h.name=a.data.b4w_shape_keys[e].name,g.Og.push(h);else g.Ud=!1;c.nd=a.b4w_shadow_cast;c.Tc=a.b4w_shadow_receive;c.gd=a.b4w_shadow_cast_only&&c.nd;c.Rc=a.b4w_reflexible;c.Hc=a.b4w_reflexible_only&&
c.Rc;c.ed=a.b4w_reflective;c.zf=a.b4w_reflection_type;c.If=a.b4w_caustics;c.Fd=a.b4w_wind_bending;c.bl=a.b4w_wind_bending_angle;g=f.VO(a.b4w_wind_bending_angle,c.di,a.scale[0]);c.Ef=g;c.ig=a.b4w_wind_bending_freq;c.Lf=a.b4w_detail_bending_freq;c.Kf=a.b4w_detail_bending_amp;c.Hf=a.b4w_branch_bending_amp;c.hide=a.b4w_hidden_on_load;c.Sf=a.b4w_main_bend_stiffness_col;g=a.b4w_detail_bend_colors;c.Yc={};c.Yc.yA=g.leaves_stiffness_col;c.Yc.xA=g.leaves_phase_col;c.Yc.dB=g.overall_stiffness_col;c.oh=a.b4w_do_not_cull;
c.wl=a.b4w_disable_fogging;c.he=a.b4w_dynamic_geometry;"MESH"!==a.type&&X.q("Wrong object");g=a.data.materials[0];c.ck=g.physics.friction;c.Wj=g.physics.elasticity;c.xk=0;c.Gg=k.et;c.Di=a.b4w_lod_transition;c.Sl=!0;break;case "LINE":c.oh=!0;c.U=H.Wc();c.Ca=H.kf();c.K=H.Wc();c.Z=H.kf();break;case "CAMERA":D.nG(a,b);D.MF(b);break;case "LAMP":A.vK(a,b);break;case "SPEAKER":b.L=C.wH();c=!1;for(g=0;g<b.C.length;g++)if(b.C[g].Ra.rc){c=!0;break}c&&C.lj(a,b);break;case "EMPTY":g=H.Wc(),c.U=g,g=H.Vt(),c.jf=
g,a.field&&(b.Bl={type:a.field.type,kC:a.field.strength}),a.b4w_anchor&&(b.anchor={type:a.b4w_anchor.type,vl:a.b4w_anchor.detect_visibility,Aq:a.b4w_anchor.element_id,cL:a.b4w_anchor.max_width})}d(b)};a.qO=function(a,b){b.mj=a.uuid;b.Hj=!0;m(a,b);a.mt=b.Da=r(a,b);a.dF=!0;b.k=k.rl(b.type);b.qp=a.b4w_use_default_animation;b.yj=l.qt(a.b4w_anim_behavior);d(b)};a.fO=function(a,b){var c=b.k;if(b.parent){!b.Ri&&b.Zf.pp&&b.parent.Zf.pp&&(b.Sk=!1);for(var e=!1,f=0;f<b.C.length;f++)if(b.C[f].Ra.Wb){e=!0;break}if(f=
e)f=b.Zf,f=b.le||b.rk||M.is_character(b)||b.Sk&&!f.rp&&0<f.Hg&&("DYNAMIC"==f.Rr||"RIGID_BODY"==f.Rr);if(f)f=b.Ri?K.copy(c.m,K.create()):c.m,K.multiply(b.parent.k.m,f,c.m),W.set_translation(b,K.get_trans_view(c.m)),W.set_scale(b,K.get_scale(c.m)),W.set_rotation(b,K.get_quat_view(c.m));else if(b.Ri||!b.Go)if(f=K.copy(c.m,K.create()),b.Ls&&"CAMERA"==b.parent.type){f={distance:b.Ls.distance,rotation:K.get_quat_view(f)};switch(b.Ls.fF){case "TOP_LEFT":f.top=0;f.left=0;break;case "TOP":f.top=0;f.left=.5;
break;case "TOP_RIGHT":f.top=0;f.right=0;break;case "LEFT":f.top=.5;f.left=0;break;case "CENTER":f.top=.5;f.left=.5;break;case "RIGHT":f.top=.5;f.right=0;break;case "BOTTOM_LEFT":f.bottom=0;f.left=0;break;case "BOTTOM":f.bottom=0;f.left=.5;break;case "BOTTOM_RIGHT":f.bottom=0,f.right=0}E.append_stiff_viewport(b,b.parent,f)}else E.kF(b,b.parent,f);else f=K.copy(c.m,K.create()),E.lF(b,b.parent,b.Go,f)}if("ARMATURE"==b.type)for(e=a.pose.bones,f=0;f<e.length;f++){var h=e[f],g=h.constraints;if(g)for(var t=
0;t<g.length;t++){var J=g[t];"COPY_TRANSFORMS"!=J.type||J.subtarget||J.mute||E.xF(b,J.target.xa,h.name,X.Gx,X.gt)}}if("MESH"==b.type)var v=l.Jz(a);if(v){g=v.xa;f=g.k.Lo;e=b.k;h=a.data;b.Xp=g;h=h.vertex_groups;if(h.length){var g=g.k.be,t=0,J={},x;for(x in g){var m=X.keysearch("name",x,h);m&&(J[x]={YC:m.index,fi:g[x].fi,ju:t++})}e.gi=J;x=t;h=l.Qz();e.Tf=x;x>2*h?(e.Ai=!1,u.error('too many bones for "'+a.name+'" / '+e.Tf+" bones (max "+h+" with blending, "+2*h+" without blending). Skinning will be disabled.")):
e.Ai=!0}x=l.MI(f.trans,f.fb,c.gi);v.b4w_animation_mixing?(c.Bd=new Float32Array(x.fb),c.Qd=new Float32Array(x.fb),c.Ed=new Float32Array(x.trans),c.Sd=new Float32Array(x.trans)):(c.Bd=x.fb,c.Qd=x.fb,c.Ed=x.trans,c.Sd=x.trans);c.gn=new Float32Array(4);c.fn=z.create();c.Lo=x;c.ie=0}if(c.ed)if(c=b.k,"CUBE"==c.zf)c.fe=Q++;else if("PLANE"==c.zf){a:{v=a.constraints;for(x=0;x<v.length;x++)if(f=v[x],"LOCKED_TRACK"==f.type&&"REFLECTION PLANE"==f.name){if(f.target.xa){v=f.target.xa;break a}u.warn('Reflection plane target "'+
f.target.name+'" for object: "'+b.name+"\" is not present on the scene. Using object's Z-axis.")}v=null}v||(v=X.mp("%reflection%"),v=k.In(v,"EMPTY"),x=k.rl("EMPTY"),v.k=x,n(b,v),E.Tx(v,b,[0,0,0],null,1),d(v));x=null;for(f=0;f<Z.length;f++)if(Z[f]==v){x=f;break}null==x&&(x=Z.length,Z.push(v));v.k.Pd=x;c.Pd=x;v.To.push(b)}};a.aO=b;a.ZP=n;a.wG=h;a.gO=function(a){for(var b=0;b<a.length;b++){var c=a[b];!c.k||"DYNAMIC"!=c.k.type&&"CAMERA"!=c.k.type||W.u(c);c.qp&&l.bB(c)&&(l.apply_def(c),c.X.length&&l.play(c,
null,l.SLOT_ALL))}};a.get_meta_tags=function(a){return X.I(a.zr)};a.cleanup=function(){Q=O=0;Z.length=0;ma.length=0;T={ALL:[]}};a.copy=function(a,b,c){var e=b,h=k.get_dg_parent(a);b=h?k.Bz(h.name,b):b;if(B(b,T.ALL,!1,-1)){for(var h=1,l;;){l="."+(3>String(h).length?("000"+String(h)).slice(-3):String(h));if(!B(b+l,T.ALL,!1,-1))break;h++}u.error('Object "'+b+'" already exists. Name was replaced by "'+b+l+'".');e+=l;b+=l}e=k.In(b,a.type,e);e.Hj=a.Hj;e.Da=a.Da;e.uo=a.uo;e.qp=a.qp;e.k=k.Mt(a.k);e.zr=k.mq(a.zr);
n(a,e);e.Rp=k.Tt(a.Rp);e.parent=k.Tt(a.parent);e.Ri=a.Ri;e.Go=a.Go;e.yc=k.Tt(a.yc);e.yj=a.yj;!a.A||a.le||a.is_character||a.rk||(e.Sk=a.Sk,e.A=null);e.xb=a.xb;e.nq=a.nq;e.Zf=k.mq(a.Zf);b=[];for(h=0;h<a.C.length;h++){var g=e.C[h];l=a.C[h].P;if(c){for(var g=g.P,t=0;t<l.length;t++)if(!l[t].of){var J=k.mq(l[t]);J.aa=y.SG(l[t].aa);g.push(J);b.push(l[t].aa)}for(t=0;t<l.length;t++)if(l[t].of){J=k.mq(l[t]);g.push(J);for(var v=0;v<b.length;v++)b[v]==l[t].aa&&(J.aa=g[v].aa)}for(t=0;t<g.length;t++)g[t].aa&&y.Zw(g[t].aa),
U.pt&&da.QF(g[t]),g[t].Ki=e.mj,f.QN(g[t],f.kG(e.k));F.ZM(g)}else g.P=l}c||(e.k.Uj=!0);k.hw(e,!1);d(e);e.k.fr=!0;e.k.gr=c;e.k.Mj=X.Az(O);O++;return e};a.update_boundings=function(a){for(var b=a.k,c=a.C[0].P,d,k,e,h,l,g,t,n,x,u,m,q,w=[],B=0;B<c.length;B++){var z=c[B];if("MAIN"==z.type){var A=c[0].aa.Ic,r=c[0].aa.vb.a_position.offset;d=h=A[r];k=l=A[r+1];e=g=A[r+2]}}for(B=0;B<c.length;B++)if(z=c[B],z.aa&&z.Z&&z.K){var A=z.aa.Ic,r=z.aa.vb.a_position.offset,O=z.aa.vb.a_position.length+r;t=u=A[r];n=m=A[r+
1];x=q=A[r+2];for(var L=r;L<O;L+=3){var r=A[L],D=A[L+1],G=A[L+2];t=Math.max(r,t);n=Math.max(D,n);x=Math.max(G,x);u=Math.min(r,u);m=Math.min(D,m);q=Math.min(G,q)}z.U.max_x=t.toFixed(3);z.U.max_y=n.toFixed(3);z.U.max_z=x.toFixed(3);z.U.min_x=u.toFixed(3);z.U.min_y=m.toFixed(3);z.U.min_z=q.toFixed(3);H.fh(z.U,b.m,z.K);H.Zn(z.K,la);for(A=w.length=0;A<la.length;A++)w.push(la[A]);z.Z=H.oq(w,!0);z.Ca=H.Ct(z.Z,b.m);"MAIN"==z.type&&(d=Math.max(t,d),k=Math.max(n,k),e=Math.max(x,e),h=Math.min(u,h),l=Math.min(m,
l),g=Math.min(q,g))}t={max_x:parseFloat(d.toFixed(3)),max_y:parseFloat(k.toFixed(3)),max_z:parseFloat(e.toFixed(3)),min_x:parseFloat(h.toFixed(3)),min_y:parseFloat(l.toFixed(3)),min_z:parseFloat(g.toFixed(3))};m=d-h;x=k-l;n=e-g;h=.5*(d+h);u=.5*(k+l);q=.5*(e+g);var p=h,C=q;l=Math.max(m,Math.max(x,n))/2;g=Math.max(m,n)/2;var Y=[h/(m?m:1),u/(x?x:1),q/(n?n:1)],w=.5;if(b.Fe)r=Math.max(Math.abs(t.max_x),Math.abs(t.min_x)),D=Math.max(Math.abs(t.max_y),Math.abs(t.min_y)),G=Math.max(Math.abs(t.max_z),Math.abs(t.min_z)),
e=Math.sqrt(r*r+D*D+G*G),B=Math.sqrt(r*r+D*D),t.max_x=t.max_y=t.max_z=e,t.min_x=t.min_y=t.min_z=-e,g=B,l=e,r=new Float32Array([0,0,0]),d=new Float32Array([l,l,l]),e=new Float32Array([0,0,0]);else{for(B=0;B<c.length;B++)if(z=c[B],"MAIN"==z.type)for(A=z.aa.Ic,O=c[B].aa.vb,r=O.a_position.offset,O=O.a_position.length+r,L=r;L<O;L+=3){var r=A[L],D=A[L+1],G=A[L+2],wa=Math.sqrt((h-r)*(h-r)+(u-D)*(u-D)+(q-G)*(q-G));if(wa>l){var z=h-l*(r-h)/wa,ua=u-l*(D-u)/wa,wa=q-l*(G-q)/wa;h=(z+r)/2;u=(ua+D)/2;q=(wa+G)/2;
l=Math.sqrt((h-r)*(h-r)+(u-D)*(u-D)+(q-G)*(q-G))}ua=Math.sqrt((p-r)*(p-r)+(C-G)*(C-G));ua>g&&(z=p-g*(r-p)/ua,wa=C-g*(G-C)/ua,p=(z+r)/2,C=(wa+G)/2,g=Math.sqrt((p-r)*(p-r)+(C-G)*(C-G)));r/=m?m:1;D/=x?x:1;G/=n?n:1;wa=Math.sqrt((Y[0]-r)*(Y[0]-r)+(Y[1]-D)*(Y[1]-D)+(Y[2]-G)*(Y[2]-G));wa>w&&(z=Y[0]-w*(r-Y[0])/wa,ua=Y[1]-w*(D-Y[1])/wa,wa=Y[2]-w*(G-Y[2])/wa,Y[0]=(z+r)/2,Y[1]=(ua+D)/2,Y[2]=(wa+G)/2,w=Math.sqrt((Y[0]-r)*(Y[0]-r)+(Y[1]-D)*(Y[1]-D)+(Y[2]-G)*(Y[2]-G)))}B=m?m*Y[0]:d;k=x?x*Y[1]:k;e=n?n*Y[2]:e;d=
w*m;A=w*x;O=w*n;r=new Float32Array([h,u,q]);d=new Float32Array([d,A,O]);e=new Float32Array([B,k,e]);g=parseFloat(g.toFixed(3))}b.U=t;f.EM(b,g,g,t);t=H.cq(l,r);b.jf=t;t=H.nn([d[0],0,0],[0,d[1],0],[0,0,d[2]],e);b.Ca=t;W.u(a);if(U.debug_view)for(B=0;B<c.length;B++)if("DEBUG_VIEW"===c[B].type&&c[B].lh){a=v.Gz(t.J);y.FB(a,[t.rd[0],t.sd[1],t.td[2]],t.J);y.ts(a,1,!0);a.ga.a_polyindex=y.Dq(a);f.PN(c[B],a);break}};a.yb=q;a.PJ=function(a,b){for(var c=T.ALL||[],d=[],k=0;k<c.length;k++){var e=c[k];if((e.k.ud==
b||-1==b)&&e.Hj)for(var f=e.C,h=0;h<f.length;h++)f[h].Ra==a&&d.push(e)}return d};a.get_all_objects=function(a){var b=T.ALL;if(-1==a)return b;for(var c=[],d=0;d<b.length;d++){var k=b[d];k.k.ud==a&&c.push(k)}return c};a.get_first_character=function(a){for(var b=T.MESH,c=0;c<b.length;c++){var d=b[c];if(M.is_character(d))for(var k=d.C,e=0;e<k.length;e++)if(k[e].Ra==a)return d}return null};a.gN=function(a){var b=q(a,"LAMP",-1);if(b.length==a.p.oR){for(var c=[],d=0;d<b.length;d++){var e=b[d],e=k.fa(e,a);
c[e.vk]=d}for(d=0;d<c.length-1;d++)for(e=d+1;e<c.length;e++){var f=b[c[d]].Pa,h=b[c[e]].Pa;if(h.Km&&h.Tk&&(!f.Km||!f.Tk)||!f.Km&&(h.Km||!f.Tk&&h.Tk))f=c[d],c[d]=c[e],c[e]=f}for(d=0;d<c.length;d++)e=b[c[d]],k.fa(e,a).vk=d,S.Jm(b[c[d]],a)}};a.NN=function(a){for(var b=q(a,"LAMP",-1),c=q(a,"MESH",-1),d=0;d<c.length;d++)for(var e=k.fa(c[d],a).P,h=0;h<e.length;h++){var l=e[h];"MAIN"==l.type&&(f.RN(l,b,a),f.gc(l))}};a.Jr=function(a,b,c,d,k){for(var e=0;e<a.C.length;e++)for(var f=a.C[e].P,h=0;h<f.length;h++){for(var l=
f[h],g=0;g<l.T.length;g++)l.T[g].ld=b;l.aa.ld=c;l.ld=c;l.La.ld=d;""!==l.Ji&&(l=x.Sz(l.Ji))&&(l.Fy=k)}};a.get_selectable_objects=function(){for(var a=[],b=T.MESH,c=0;c<b.length;c++){var d=b[c];d.k.Ng&&d.Hj&&a.push(d)}return a};a.get_outlining_objects=function(){for(var a=[],b=T.MESH,c=0;c<b.length;c++){var d=b[c];d.k.fc&&d.Hj&&a.push(d)}return a};a.wc=function(b,c,d,e){var f=null,h=T.ALL;switch(b){case a.dt:f=B(c,h,!0,d);break;case a.bt:a:{for(b=0;b<h.length;b++)if(f=h[b],f.Ak==d&&(f.k.ud==e||-1==
e)){var l=k.get_dg_parent(f);if(l&&l.Ak==c)break a}f=null}break;case a.Vc:a:{for(e=0;e<h.length;e++){b=h[e];for(var f=c.length-1,l=b,g=!0;0<=f&&g;)g=l&&l.Ak==c[f]&&(l.k.ud==d||-1==d),l&&(l=k.get_dg_parent(l)),f--;if(g&&!l){f=b;break a}}f=null}}return f};a.get_world_by_name=function(a,b){return B("%meta_world%"+a,T.WORLD,!0,b)};a.pick_object=function(b,c){var d=S.ik();if(!d)return u.error("No active scene"),null;var k=P.wL(b,c);if(k)return k;k=S.xL(d,b,c);if(!k)return null;for(var d=q(d,"MESH",-1),
e=0;e<d.length;e++){var f=d[e].k,h=f.Mj;if(h&&3>Math.abs(255*h[0]-k[0])&&3>Math.abs(255*h[1]-k[1])&&3>Math.abs(255*h[2]-k[2]))return f.fc&&f.Lr&&(ga.outlining_overview_mode?a.apply_outline_anim(d[e],ga.Mi,ga.Ni,ga.Oi):(k=f.xf,a.apply_outline_anim(d[e],k.Mi,k.Ni,k.Oi))),d[e]}return null};a.set_wind_params=function(a,c){for(var d=q(a,"EMPTY",-1),k=0;k<d.length;k++){var e=d[k];if(e.Bl&&"WIND"===e.Bl.type)var f=e}if(!f)return u.error("There is no wind on the scene"),0;"number"==typeof c.wind_dir&&(d=
X.deg_to_rad(c.wind_dir),N.set(Math.sin(d),0,Math.cos(d),ra),X.dir_to_quat(ra,X.AXIS_Y,ja),W.set_rotation(f,ja));"number"==typeof c.wind_strength&&(f.Bl.kC=c.wind_strength);b(f)};a.remove_object=function(a){E.xG(a)&&E.remove(a);var b=T.ALL,c=T[a.type],d=b.indexOf(a);a=c.indexOf(a);-1!=d&&b.splice(d,1);-1!=a&&c.splice(a,1)};a.pL=d;a.qL=function(a){return T[a.type]&&-1<T[a.type].indexOf(a)}};b4w.module.__obj_util=function(a,p){function e(a){a={type:a,id:0,ud:0,m:g.sg(),wp:g.sg(),Ss:g.sg(),pivot:new Float32Array(3),ub:new Float32Array(3),xi:0,yi:0,fr:!1,gr:!1,Mj:null,Yf:0,Dm:!1,xe:q.create(),use_panning:!1,nb:0,Wk:1,Vk:1,Xk:1,dof_distance:0,Qb:0,Pb:0,Sb:0,Rb:0,dof_power:0,Ua:0,Oc:!1,$c:!1,tc:null,NR:!1,eb:null,na:null,ib:null,Gc:null,Fc:null,pe:null,Yj:!0,xf:{Mi:1,Ni:1,Oi:0},fe:-1,Pd:-1,Fb:new Float32Array(4),ck:0,Wj:0,Gg:-1,xk:0,Di:0,qi:!1,nd:!1,Tc:!1,gd:!1,Rc:!1,Hc:!1,ed:!1,zf:"",If:!1,
Fd:!1,wl:!1,he:!1,kc:!1,oh:!1,hide:!1,Sl:!1,Ng:!1,fm:!1,fc:!1,em:!1,Lr:!1,Ll:!1,is_visible:!1,bo:!1,bl:0,Ef:0,ig:0,Lf:0,Kf:0,Hf:0,Sf:"",Yc:null,Bj:!1,Fe:!1,on:!1,Dj:"",Cj:!1,ie:0,time:0,Gs:0,Hs:0,Tf:0,bk:!1,yc:!1,Ud:!1,Og:[],Ai:!1,bh:!1,og:1,cn:0,bn:1,Hm:new Int8Array([-1,-1]),pm:[],xr:[],ls:[],Bd:null,Qd:null,Ed:null,Sd:null,be:null,gi:null,Lo:null,gn:null,fn:null,di:null,U:h.Wc(),K:h.Wc(),jf:h.Vt(),Dc:h.Vt(),mn:null,kn:null,ln:null,Ca:h.kf(),Z:h.kf(),Uj:!1};q.copy(m.AXIS_Y,a.xe);return a}function c(a){if(!(a instanceof
Object))return a;var b=null,d=null,e=null,h=null,g=null;a.T&&(b=a.T,a.T=null);a.Uc&&(d=a.Uc,a.Uc=null);a.Ga&&(e=a.Ga,a.Ga=null);a.La&&(h=a.La,a.La=null);a.Vd&&(g=a.Vd,a.Vd=null);var n;n=a.constructor;switch(n){case Int8Array:case Uint8Array:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:n=new n(a);break;case Array:n=new n(a.length);for(var q=0;q<a.length;q++)n[q]=c(a[q]);break;case WebGLUniformLocation:case WebGLProgram:case WebGLShader:n=a;break;
case WebGLFramebuffer:case WebGLTexture:case WebGLBuffer:n=null;break;case Function:n=a;break;default:for(q in n=new n,a)n[q]=c(a[q])}b&&(n.T=b,a.T=b);d&&(n.Uc=d,a.Uc=d);e&&(n.Ga=e,a.Ga=e);h&&(n.La=h,a.La=h);g&&(n.Vd=m.pi(),a.Vd=g);return n}function b(a,b){for(var c=a.C,d=0;d<c.length;d++){var e=c[d];if(e.Ra==b)return e}return null}function n(a){return a.Ri?a.parent:a.parent?n(a.parent):null}var h=p("__boundings"),r=p("__config"),g=p("__tsr"),m=p("__util"),q=p("__vec3"),B=p("__vec4"),d=r.v;new Float32Array(4);
new Float32Array(4);new Float32Array(4);g.create();g.create();a.et=-1;a.rl=e;a.Mt=function(a){var b=e(a.type);b.id=a.id;b.ud=a.ud;g.copy(a.m,b.m);g.copy(a.wp,b.wp);g.copy(a.Ss,b.Ss);q.copy(a.pivot,b.pivot);q.copy(a.ub,b.ub);b.xi=a.xi;b.yi=a.yi;b.fr=a.fr;b.gr=a.gr;a.Mj&&(b.Mj=q.clone(a.Mj));b.Yf=a.Yf;b.Dm=a.Dm;q.copy(a.xe,b.xe);b.use_panning=a.use_panning;b.nb=a.nb;b.Wk=a.Wk;b.Vk=a.Vk;b.Xk=a.Xk;b.dof_distance=a.dof_distance;b.Qb=a.Qb;b.Pb=a.Pb;b.Sb=a.Sb;b.Rb=a.Rb;b.dof_power=a.dof_power;b.Ua=a.Ua;
b.Oc=a.Oc;b.$c=a.$c;b.tc=a.tc;b.eb=m.I(a.eb);b.na=m.I(a.na);b.ib=m.I(a.ib);b.Gc=m.I(a.Gc);b.Fc=m.I(a.Fc);b.pe=a.pe;b.Yj=a.Yj;b.xf.Mi=a.xf.Mi;b.xf.Ni=a.xf.Ni;b.xf.Oi=a.xf.Oi;b.fe=a.fe;b.Pd=a.Pd;b.Fb=a.Fb;b.ck=a.ck;b.Wj=a.Wj;b.Gg=a.Gg;b.xk=a.xk;b.Di=a.Di;b.qi=a.qi;b.nd=a.nd;b.Tc=a.Tc;b.gd=a.gd;b.Rc=a.Rc;b.Hc=a.Hc;b.ed=a.ed;b.zf=a.zf;b.If=a.If;b.Fd=a.Fd;b.wl=a.wl;b.he=a.he;b.kc=a.kc;b.oh=a.oh;b.hide=a.hide;b.Sl=a.Sl;b.Ng=a.Ng;b.fm=a.fm;b.fc=a.fc;b.em=a.em;b.Lr=a.Lr;b.Ll=a.Ll;b.is_visible=a.is_visible;
b.bo=a.bo;b.bl=a.bl;b.Ef=a.Ef;b.ig=a.ig;b.Lf=a.Lf;b.Kf=a.Kf;b.Hf=a.Hf;b.Sf=a.Sf;b.Yc=a.Yc;b.Bj=a.Bj;b.Fe=a.Fe;b.on=a.on;b.Dj=a.Dj;b.Cj=a.Cj;b.ie=a.ie;b.time=a.time;b.Gs=a.Gs;b.Hs=a.Hs;b.Tf=a.Tf;b.bk=a.bk;b.yc=a.yc;b.Ud=a.Ud;b.Og=m.I(a.Og);b.Ai=a.Ai;b.bh=a.bh;b.og=a.og;b.cn=a.cn;b.bn=a.bn;b.Hm.set(a.Hm);b.pm=m.I(a.pm);b.xr=m.I(a.xr);b.ls=m.I(a.ls);b.Bd=m.I(a.Bd);b.Qd=m.I(a.Qd);b.Ed=m.I(a.Ed);b.Sd=m.I(a.Sd);b.be=m.I(a.be);b.gi=m.I(a.gi);b.Lo=m.I(a.Lo);b.gn=m.I(a.gn);b.fn=m.I(a.fn);b.di=m.I(a.di);h.oi(a.U,
b.U);h.oi(a.K,b.K);h.lq(a.jf,b.jf);h.lq(a.Dc,b.Dc);b.mn=m.I(a.mn);b.kn=m.I(a.kn);b.ln=m.I(a.ln);b.Ca=m.I(a.Ca);b.Z=m.I(a.Z);b.Uj=a.Uj;return b};a.In=function(a,b,c){c||(c=a);return{name:a,mj:m.yu(),Ak:c,type:b,Hj:!1,Da:!1,uo:!1,qp:!1,k:null,Ib:null,L:null,Pa:null,Xp:null,anchor:null,Bl:null,zr:null,C:[],yc:[],ee:m.pi(),St:m.pi(),X:[],To:[],vf:[],Rp:[],cg:null,Lk:[],parent:null,Ri:!1,Go:"",Ls:null,Sr:null,Sk:!1,xb:"",nq:"AUTO",le:!1,is_character:!1,rk:!1,jy:!1,A:null,s:null,mf:null,we:null,Cl:null,
wy:null,Nv:[],Zf:{Rr:"NO_COLLISION",rp:!1,RC:!1,Hg:0,VC:0,UC:0,hu:0,fw:0,NK:!1,OK:!1,PK:!1,QK:!1,RK:!1,SK:!1,Dn:0,Bn:0,En:0,ax:!1,iq:"BOX",pp:!1},cB:{vs:0,Hv:0,Te:0,Xv:0},yj:0,mh:[],Av:!1,QA:!1,yr:[]}};a.Tt=function(a){return a instanceof Array?a.slice():a};a.YP=function(a){for(var b=[],d=0;d<a.length;d++){var e=a[d],h={},g;for(g in e)e[g]==e.K?h.K=c(e.K):e[g]==e.Z?h.Z=c(e.Z):h[g]=e[g];b.push(h)}return b};a.mq=c;a.Da=function(a){return a.Da};a.pk=function(a){return"MESH"==a.type&&a.Da};a.en=function(a,
b){a.C.push({Ra:b,er:!1,P:[],Lg:[],jh:null,mw:[],vk:0,aB:!1,R:[],RB:[]})};a.Vp=function(a,c,d){b(a,c).P.push(d)};a.uR=function(a,b){for(var c=a.C,d=0;d<c.length;d++)if(c[d].Ra==b){c.splice(d,1);break}};a.fa=b;a.KC=function(a,b){for(var c=0;c<a.length;c++)B.copy(b,a[c].k.Fb)};a.hw=function(a,b,c){for(var d=0;d<a.C.length;d++){var e=a.C[d];c&&e.Ra!=c||(e.er=b)}};a.Lq=function(a,b){for(var c=[],e=b?d.JA-1:d.JA,h=0;h<a.length;h++){var g=a[h];g.Pa.Fz&&c.length<e&&c.push(g)}return c.length?c:a[0]?[a[0]]:
[]};a.Ay=function(a,b){if(b.b4w_enable_soft_particles&&0<b.b4w_particles_softness){var c=b.material-1,d=a.data.materials;if(0<=c&&c<d.length&&("ADD"==d[c].game_settings.alpha_blend||"ALPHA"==d[c].game_settings.alpha_blend||"ALPHA_SORT"==d[c].game_settings.alpha_blend))return!0}return!1};a.CG=function(a){a=a.C;for(var b=0;b<a.length;b++)for(var c=a[b].P,d=0;d<c.length;d++)for(var e=c[d].Va.nh,h=0;h<e.length;h++){var g=e[h];if("USE_ZUP_MODEL_MATRIX_INVERSE"==g[0]&&"1"==g[1])return!0}return!1};a.Bz=
function(a,b){return a+"*"+b};a.get_parent=function(a){return a.Ri?null:a.parent};a.get_dg_parent=n;a.Cu=function(a,b){for(var c=[],d=0;d<b.length;d++){var e=b[d];n(e)==a&&c.push(e)}return c};a.get_object_data_id=function(a){return a.k.ud};a.is_mesh=function(a){return"MESH"===a.type};a.is_armature=function(a){return"ARMATURE"===a.type};a.is_speaker=function(a){return"SPEAKER"===a.type};a.is_camera=function(a){return"CAMERA"===a.type};a.is_lamp=function(a){return"LAMP"===a.type};a.is_empty=function(a){return"EMPTY"===
a.type};a.is_line=function(a){return"LINE"===a.type};a.is_world=function(a){return"WORLD"===a.type}};b4w.module.__particles=function(a,p){function e(){B.q("_rand() undefined")}function c(a,b,c,d,e,h){var k=a.wq,g=a.Of,l=a.time;a=a.qB;for(var n=0;n<k.length;n+=4){var v=k[n];if(l>a&&l>=v&&v>a||l<a&&(v>a||l>=v))for(v=0;8>v;v++)g[8*n+v]=d[v],f[v]=d[v];else for(v=0;8>v;v++)f[v]=g[8*n+v];v=H;v[0]=b[3*n];v[1]=b[3*n+1];v[2]=b[3*n+2];q.transform_vec3(v,f,v);e[3*n]=v[0];e[3*n+1]=v[1];e[3*n+2]=v[2];var m=H;m[0]=c[3*n];m[1]=c[3*n+1];m[2]=c[3*n+2];q.transform_dir_vec3(m,f,m);h[3*n]=m[0];h[3*n+1]=m[1];h[3*n+2]=
m[2];for(v=1;4>v;v++)e[3*(n+v)]=e[3*n],e[3*(n+v)+1]=e[3*n+1],e[3*(n+v)+2]=e[3*n+2],h[3*(n+v)]=m[0],h[3*(n+v)+1]=m[1],h[3*(n+v)+2]=m[2]}}function b(a){a?(B.rN(a),e=function(){return B.JL()}):e=function(){return Math.random()}}var n=p("__config"),h=p("__batch"),r=p("__geometry"),g=p("__textures"),m=p("__time"),q=p("__tsr"),B=p("__util"),d=p("__vec3"),l=n.v,f=new Float32Array(8),H=new Float32Array(3),D=[];a.update=function(){for(var a=0;a<D.length;a++)for(var b=D[a],d=b.C,e=0;e<d.length;e++)for(var h=
b,f=d[e].P,k=0;k<f.length;k++){var g=f[k],l=g.Ia;l&&l.Ds&&!g.of&&(c(l,l.nB,l.XA,h.k.m,l.Ov,l.Dv),l.PA=!0)}};a.cm=function(a){a=a.C;for(var b=0;b<a.length;b++)for(var c=a[b].P,d=0;d<c.length;d++)if(c[d].Ia)return!0;return!1};a.$A=function(a){a=a.C;for(var b=0;b<a.length;b++)for(var c=a[b].P,d=0;d<c.length;d++){var e=c[d].Ia;if(e&&"EMITTER"==e.Mr)return!0}return!1};a.dG=function(a){return 0<a.particle_systems.length};a.cG=function(a){for(var b=0;b<a.particle_systems.length;b++)if("EMITTER"==a.particle_systems[b].settings.type)return!0;
return!1};a.$J=function(a){for(var b=0;b<a.particle_systems.length;b++){var c=a.particle_systems[b].settings;if("HAIR"==c.type&&c.b4w_dynamic_grass)return!0}return!1};a.eK=function(a,b,c){var d=a.Ia={name:b.name,Mr:b.settings.type,time:0,qB:-1,Ds:!1,la:0,Ka:0,wC:0,av:0,AA:0,cyclic:0,Hg:0,Bv:0,$z:0,Zj:0,Ke:0,fD:0,size:0,Sx:0,Rx:0,Ky:0,Jy:new Float32Array(16),PA:!1,nB:null,Ov:null,XA:null,Dv:null,wq:null,ku:null,Of:null,eB:null,uC:0,vC:0};d.la=b.settings.frame_start;d.Ka=b.settings.frame_end;d.wC=(d.Ka-
d.la)/m.Qc();d.av=b.settings.lifetime;d.AA=d.av/m.Qc();d.cyclic=b.settings.b4w_cyclic?1:0;d.Hg=b.settings.mass;d.Bv=b.settings.normal_factor;d.$z=9.81*b.settings.effector_weights.gravity;d.Zj=b.settings.b4w_fade_in/m.Qc();d.Ke=b.settings.b4w_fade_out/m.Qc();d.fD=b.settings.effector_weights.wind;d.Ds="WORLD"==b.settings.b4w_coordinate_system?!0:!1;var e,f,k;a.mo?(e=c.halo.size,f=c.halo.hardness,30>f?(f=.5,k=.9):40>f?(f=.1,k=1):50>f?(f=0,k=.8):(f=0,k=.5)):(e=b.settings.particle_size,k=f=1);d.size=e;
d.Sx=f;d.Rx=k;c.use_nodes&&"BILLBOARD"==b.settings.render_type&&(h.Sa(a,"NODES",1),h.Sa(a,"PARTICLE_BATCH",1),a.RR=!0,a.vi=!0);b=b.settings.texture_slots;b[0]&&b[0].use_map_size&&b[0].texture&&"BLEND"==b[0].texture.type&&b[0].texture.use_color_ramp&&l.Tp&&(e=[],g.gG(b[0].texture.color_ramp,g.Fx,e),e=new Uint8Array(e.map(function(a){return B.clamp(255*a,0,255)})),h.BF(a,e,g.Fx),h.Sa(a,"USE_COLOR_RAMP",1));c=c.texture_slots;a=[-1,0,0,0,-1,0,0,0,-1,0,0,0,-1,0,0,0];if(c[0]&&"STRAND"==c[0].texture_coords&&
c[0].texture&&"BLEND"==c[0].texture.type&&c[0].texture.use_color_ramp){c=c[0].texture.color_ramp.elements;b=Math.min(4*c.length,a.length);for(e=0;e<b;e+=4)f=c[e/4],a[e]=f.position,a[e+1]=f.color[0],a[e+2]=f.color[1],a[e+3]=f.color[2];d.Ky=c.length}d.Jy.set(a)};a.hJ=function(a,h,f,g){var l=a.Ia,n=g.m,k=f.settings.count,t=f.settings.frame_start/m.Qc(),q=f.settings.frame_end/m.Qc(),u=f.settings.lifetime/m.Qc(),v=f.settings.lifetime_random,z=f.settings.emit_from,D=f.settings.factor_random;if(f.settings.use_rotations)var p=
f.settings.angular_velocity_mode,H=f.settings.angular_velocity_factor;else p="NONE",H=0;var F=f.settings.b4w_randomize_emission,K=f.settings.b4w_cyclic;l.uC=f.settings.billboard_tilt;l.vC=f.settings.billboard_tilt_random;b(f.seed);var X;h=r.nz(h,["a_position","a_normal"],null,g);switch(z){case "VERT":var N=h.O[0].a_position;X=h.O[0].a_normal;h=N.length/3;z=[];for(f=0;f<k;f++)g=Math.round((h-1)*e()),z.push(g),z.push(g),z.push(g),z.push(g);h=[];for(f=0;f<z.length;f++)h.push(N[3*z[f]]),h.push(N[3*z[f]+
1]),h.push(N[3*z[f]+2]);N=new Float32Array(h);h=[];for(f=0;f<z.length;f++)h.push(X[3*z[f]]),h.push(X[3*z[f]+1]),h.push(X[3*z[f]+2]);X=new Float32Array(h);break;case "FACE":N=[];X=[];f=[];B.cr(0,f);z=r.zu(h,k,!1,f);B.cr(0,f);h=r.zu(h,k,!0,f);for(f=0;f<z.length;f++)N.push(z[f][0],z[f][1],z[f][2]),N.push(z[f][0],z[f][1],z[f][2]),N.push(z[f][0],z[f][1],z[f][2]),N.push(z[f][0],z[f][1],z[f][2]),X.push(h[f][0],h[f][1],h[f][2]),X.push(h[f][0],h[f][1],h[f][2]),X.push(h[f][0],h[f][1],h[f][2]),X.push(h[f][0],
h[f][1],h[f][2]);N=new Float32Array(N);X=new Float32Array(X);break;case "VOLUME":B.q("Particle emission from volume is not supported");break;default:B.q("Wrong emit from option")}X=[N,X];N=X[0];X=X[1];l.nB=new Float32Array(N);l.XA=new Float32Array(X);l.Ov=new Float32Array(N.length);l.Dv=new Float32Array(X.length);z=[];q=(q-t)/k;for(h=0;h<k;h++)f=F?q*h+10*q*(.5-e()):q*h,K||(f+=t),z.push(f),z.push(f),z.push(f),z.push(f);t=new Float32Array(z);l.wq=new Float32Array(t);l.ku=new Float32Array(t);if(l.Ds){l.Of=
new Float32Array(8*t.length);for(F=0;F<8*t.length;F++)for(K=0;8>K;K++)l.Of[8*F+K]=n[K];c(l,N,X,n,N,X)}n=B.Nc("EMITTER_PARTICLES");F=B.Jf();F.a_position=N;F.a_normal=X;n.O[0]=F;a.Mf=r.Bp;a=[];for(F=0;F<k;F++)a.push(4*F,4*F+2,4*F+1,4*F,4*F+3,4*F+2);a=new Uint16Array(a);n.lb=a;a=n.ga;F=[];for(K=0;K<k;K++)F.push(-.5,-.5,-.5,.5,.5,.5,.5,-.5);F=new Float32Array(F);a.a_p_bb_vertex=F;n.va=N.length/3;a=[];v*=u;for(F=0;F<k;F++)K=v*e(),a.push(u-K),a.push(u-K),a.push(u-K),a.push(u-K);u=n.ga;v=[];for(F=0;F<k;F++)K=
Math.random(),v.push(a[4*F],t[4*F],K),v.push(a[4*F+1],t[4*F+1],K),v.push(a[4*F+2],t[4*F+2],K),v.push(a[4*F+3],t[4*F+3],K);v=new Float32Array(v);u.a_p_data=v;u=n.ga;v=[];for(a=0;a<k;a++){t=[e()-.5,e()-.5,e()-.5];d.normalize(t,t);v.push(D*t[0]);v.push(D*t[1]);v.push(D*t[2]);switch(p){case "NONE":v.push(0);break;case "SPIN":case "VELOCITY":v.push(H);break;case "RAND":v.push(2*H*(e()-.5));break;default:B.q("Undefined velocity factor")}t=v.slice(-4);for(F=0;12>F;F++)v.push(t[F%4])}k=new Float32Array(v);
u.a_p_vels=k;l.eB=new Float32Array(n.ga.a_p_data);return n};a.OM=function(a,b,c){a=a.C;for(var d=0;d<a.length;d++)for(var e=a[d].P,f=0;f<e.length;f++){var k=e[f].Ia;k&&k.name==b&&!e[f].of&&(k.qB=k.time,k.time=c)}};a.FL=function(a){for(var b=a.va,c=a.O[0].a_position,d=a.ga.a_texcoord,e=[],f=[],k=0;k<b;k++)f.push(c[3*k]),f.push(c[3*k+1]),e.push(c[3*k+2]);e=new Float32Array(e);f=new Float32Array(f);a.ga.a_lf_dist=e;a.ga.a_lf_bb_vertex=f;a.ga.a_texcoord=d;return a};a.set_size=function(a,b,c){a=a.C;for(var d=
0;d<a.length;d++)for(var e=a[d].P,f=0;f<e.length;f++){var k=e[f].Ia;k&&k.name==b&&(k.size=c)}};a.set_normal_factor=function(a,b,c){a=a.C;for(var d=0;d<a.length;d++)for(var e=a[d].P,f=0;f<e.length;f++){var k=e[f].Ia;k&&k.name==b&&(k.Bv=c)}};a.set_factor=function(a,b,c){a=a.C;for(var d=0;d<a.length;d++)for(var e=a[d].P,f=0;f<e.length;f++){var k=e[f],h=k.Ia;if(h&&h.name==b){var g=h.wq;if(1==c)var l=g;else if(0==c)for(var l=h.ku,n=0;n<l.length;n+=4)l[n]=1E4,l[n+1]=l[n],l[n+2]=l[n],l[n+3]=l[n];else for(var m=
4/c,l=h.ku,q=0,n=0;n<l.length;n+=4)n>=q?(l[n]=g[n],q+=m):l[n]=1E4,l[n+1]=l[n],l[n+2]=l[n],l[n+3]=l[n];k=k.aa;if(k.vb.a_p_data){h=h.eB;for(n=0;n<h.length;n+=3)h[n+1]=l[Math.round(n/3)];r.FC(k,"a_p_data",3,h)}}}};a.pO=function(a,b,c){a=a.C;for(var d=0;d<a.length;d++)for(var e=a[d].P,f=0;f<e.length;f++){var k=e[f].Ia;if(k&&k.Ds)for(var h=0;h<8*k.wq.length;h++)k.Of[8*h]=b[0],k.Of[8*h+1]=b[1],k.Of[8*h+2]=b[2],k.Of[8*h+3]=b[3],k.Of[8*h+4]=c[0],k.Of[8*h+5]=c[1],k.Of[8*h+6]=c[2],k.Of[8*h+7]=c[3]}};a.jO=function(a,
b,c){if(b.Si){for(var d=[],e=0;e<c;e++)d.push(1,0,0,1,1,0,0,1,1,0,0,1,1,0,0,1);a.ga.a_tangent=new Float32Array(d)}if(b.Io){d=[];for(e=0;e<c;e++)d.push(e,e,e,e);a.ga[b.Io.name]=new Float32Array(d)}};a.iO=function(a){-1==D.indexOf(a)&&D.push(a)};a.OL=function(a){a=D.indexOf(a);-1!=a&&D.splice(a,1)};a.cleanup=function(){D.length=0}};b4w.module.__primitives=function(a,p){function e(a,b,c,e){for(var f=[],h=[],n=[],m=[],r=2*c/(a-1),p=2*e/(b-1),A=0;A<a;A++)for(var G=-c+A*r,x=0;x<b;x++)if(h.push(G,0,-e+x*p),n.push(0,1,0),m.push(A/(a-1),x/(b-1)),A&&x){var k=A*b+x,t=k-1,M=(A-1)*b+x,u=M-1;f.push(k,t,M);f.push(t,u,M)}a=g.Jf();a.a_position=new Float32Array(h);a.a_normal=new Float32Array(n);n=g.Nc("GRID_PLANE");n.O[0]=a;n.ga.a_texcoord=new Float32Array(m);n.lb=new Uint32Array(f);n.va=h.length/3;return n}function c(a){var b=a.length;b%4&&
g.q("Wrong array");for(var c=[],e=[],f=0;f<b;f+=4){var h=a[f+1],m=a[f+2],w=a[f+3];n(a[f],e);n(h,e);n(m,e);n(w,e);c.push(f,f+1,f+2);c.push(f,f+2,f+3)}a=g.Jf();a.a_position=new Float32Array(e);b=g.Nc("FROM_QUADS");b.O[0]=a;b.lb=new Uint32Array(c);b.va=e.length/3;return b}function b(a,b){var c=3*b;return[a[c],a[c+1],a[c+2]]}function n(a,b){b.push(a[0],a[1],a[2])}var h=p("__config"),r=p("__geometry");p("__print");var g=p("__util"),m=h.v;a.lJ=function(){var a=g.Nc("LINE"),b=g.Jf();b.a_position=new Float32Array(3);
b.a_direction=new Float32Array(3);a.O[0]=b;a.lb=new Uint32Array(1);a.va=1;return a};a.wQ=function(a,b){var c=e(2,2,a,b);c.name="PLANE";return c};a.vQ=e;a.oJ=function(a,b,c){function e(a,b){return 1==a%2&&(0==b||b==w-1)||1==b%2&&(0==a||a==n-1)?!0:!1}var f=c/=Math.pow(2,a-1),h=c,n=b+1,w=b+1;b=[];c=[];for(var p=[],y=[],A=0,G=0,x=-1,k=[],t=0;t<a;t++){for(var M=2*f/(n-1),u=2*h/(w-1),v=[],z=[],S=0,C=0;C<n;C++){for(var W=-f+C*M,F=[],K=0;K<w;K++){var X=-h+K*u;if(W>-A&&W<A&&X>-G&&X<G)F.push(-1),S++;else{for(var N=
null,L=0;L<k.length;L+=3)if(W==k[L]&&X==k[L+1]){N=k[L+2];break}L=null!==N?N:x+1;e(C,K)?(F.push(-2),S++):(null==N&&(0==K||K==w-1||0==C||C==n-1?(N=t==a-1?M:2*M,v.push(W,X,L)):N=M,c.push(W,N,X),y.push(0,1,0),p.push(1,0,0),x++),F.push(L));if(C&&K)if(1==C)if(e(C-1,K)){if(1<K){var X=L-1,N=z[C-1][K+1],P=N-1;b.push(L,X,P)}else N=z[C-1][K+1],P=N-1;b.push(L,P,N)}else e(C,K)||(X=L-1,N=z[C-1][K],b.push(L,X,N));else if(C==n-1){if(!e(C,K))if(K==w-1)X=L-1,N=z[C-1][K-1],P=z[C-2][K],b.push(L,X,N),b.push(L,N,P);else{var X=
L-1,N=z[C-1][K],P=N-1,da=N+1;b.push(L,X,P);b.push(L,P,N);b.push(L,N,da);2==K&&(da=z[C-2][K-2],b.push(X,da,P))}}else 1==K?e(C,K-1)?(X=z[C-1][K],N=z[C-1][K-1],b.push(L,N,X)):(X=F[K-1],N=z[C-1][K],P=z[C-2][K-1],b.push(L,X,N),b.push(X,P,N)):K==w-1?e(C,K)||(X=F[K-1],N=z[C-1][K-1],P=z[C-2][K],b.push(L,X,N),b.push(L,N,P)):-1!=z[C-1][K]&&-1!=z[C-1][K-1]&&-1!=F[K-1]?(X=F[K-1],N=z[C-1][K],P=z[C-1][K-1],b.push(L,X,N),b.push(X,P,N),K==w-2&&e(C,K+1)&&(da=z[C-1][K+1],b.push(L,N,da))):K==w-2&&e(C,K+1)&&(N=z[C-1][K],
da=z[C-1][K+1],b.push(L,N,da))}}z.push(F)}k=v;A=f;G=h;f*=2;h*=2}if(2E4>A)for(a=-(2*A)/(n-1),c.push(-2E4,a,-2E4),c.push(-2E4,a,2E4),c.push(-A,a,-G),c.push(-A,a,G),c.push(2E4,a,-2E4),c.push(2E4,a,2E4),c.push(A,a,-G),c.push(A,a,G),L=x+1,b.push(L+3,L+2,L+1,L+2,L+0,L+1,L+6,L+4,L+2,L+4,L+0,L+2,L+5,L+7,L+1,L+7,L+3,L+1,L+5,L+4,L+7,L+7,L+4,L+6),C=0;8>C;C++)y.push(0,1,0),p.push(1,0,0);a=g.Jf();a.a_position=new Float32Array(c);a.a_tangent=new Float32Array(p);a.a_normal=new Float32Array(y);f=g.Nc("multigrid_plane");
f.O[0]=a;f.lb=new Uint32Array(b);f.va=c.length/3;m.eD&&(r.ts(f,1,!0),a.a_polyindex=r.Dq(f));return f};a.uQ=function(a){var b=a.length;b%3&&g.q("Wrong array");for(var c=[],e=[],h=0;h<b;h+=3){var m=a[h+1],r=a[h+2];n(a[h],e);n(m,e);n(r,e);c.push(h,h+1,h+2)}a=g.Jf();a.a_position=new Float32Array(e);b=g.Nc("FROM_TRIANGLES");b.O[0]=a;b.lb=new Uint32Array(c);b.va=e.length/3;return b};a.tQ=c;a.iJ=function(a){a=g.JO(a);var b=[];b.push(a[0],a[1],a[2],a[3]);b.push(a[0],a[3],a[5],a[4]);b.push(a[3],a[2],a[6],
a[5]);b.push(a[1],a[7],a[6],a[2]);b.push(a[0],a[4],a[7],a[1]);b.push(a[4],a[5],a[6],a[7]);a=c(b);a.name="FRUSTUM";return a};a.vc=function(){var a=g.Nc("FULLSCREEN_TRI"),b=g.Jf();b.a_position=new Float32Array([0,0,1,0,0,1]);a.O[0]=b;a.lb=new Uint32Array([0,1,2]);a.va=3;return a};a.jJ=function(){var a=g.Nc("FULLSCREEN_QUAD"),b=g.Jf();b.a_position=new Float32Array([-1,1,1,1,-1,-1,1,-1]);a.O[0]=b;a.lb=new Uint32Array([0,2,1,1,2,3]);a.va=4;return a};a.eJ=function(){var a=g.Nc("BILLBOARD"),b=g.Jf();b.a_bb_vertex=
new Float32Array([-.5,-.5,-.5,.5,.5,.5,.5,-.5]);a.O[0]=b;a.lb=new Uint32Array([0,2,1,0,3,2]);a.va=4;return a};a.fJ=function(){var a=g.Nc("CUBEMAP_BOARD"),b=g.Jf();b.a_position=new Float32Array([-1,-1,-1,1,1,1,1,-1]);a.O[0]=b;a.lb=new Uint32Array([0,2,1,0,3,2]);a.va=4;return a};a.Gz=function(a){var c=g.Nc("UV_SPHERE"),d,e,h=[],m=[],p=[];for(e=0;8>=e;e++)for(d=0;16>=d;d++){var w=d/16,E=e/8;m.push(-1*Math.cos(2*w*Math.PI)*Math.sin(E*Math.PI)+a[0],1*Math.cos(E*Math.PI)+a[1],1*Math.sin(2*w*Math.PI)*Math.sin(E*
Math.PI)+a[2])}for(e=w=0;8>e;e++)for(d=0;16>d;d++){var E=b(m,17*e+d+1),y=b(m,17*e+d),A=b(m,17*(e+1)+d),G=b(m,17*(e+1)+d+1);Math.abs(E[1])==1+a[1]?(n(E,h),n(A,h),n(G,h),p.push(w,w+1,w+2),w+=3):Math.abs(A[1])==1+a[1]?(n(E,h),n(y,h),n(A,h),p.push(w,w+1,w+2),w+=3):(n(E,h),n(y,h),n(A,h),n(G,h),p.push(w,w+1,w+2),p.push(w,w+2,w+3),w+=4)}a={};a.a_position=h;m=r.ny(p,m,h);a.a_normal=r.my(p,h,m);a.a_tangent=[];c.ga.a_influence=[];c.ga.a_color=[];c.ga.a_texcoord=[];c.O[0]=a;c.lb=p;c.va=h.length/3;return c};
a.Ez=function(a){var b=g.Nc("INDEX"),c=g.Jf();c.a_index=new Float32Array(a);for(var e=0;e<a;e++)c.a_index[e]=e;b.O[0]=c;b.lb=new Uint16Array(0);b.va=a;return b}};b4w.module.__prerender=function(a,p){function e(a,b){var c=a.Jg;c.is_visible=!1;if(c.hide)return!1;var e=b.o,h=b.type==m.Ac?e.sr:q.cc(e.m,H),f=c.xk,g=c.Gg,h=d.dist(c.Dc.J,h);if(!(h<f?0:g==r.et||h<g+c.Di*c.Dc.Za))return!1;c.is_visible=!0;f=a.Y;b.type==m.ze?c=b.debug_view_mode==n.DV_BOUNDINGS?f.lh:!f.lh:((g=b.type==m.kg&&0==c.Yf)||(e=e.Ag,c.oh?g=!1:(h=c.Dc,g=h.J,B.mN(g,e,h.Za)?g=!0:c.Uj?g=!1:(c=f.Z,g=c.J,g=B.AI(g,e,c.rd,c.sd,c.td)))),c=g?!1:!0);return c}function c(a){var b=a.Ia;if(b&&b.PA){a=a.aa;h.WK(a);
var c=a.Ic,d=a.vb,e=d.a_normal;c.set(b.Ov,d.a_position.offset);c.set(b.Dv,e.offset);h.Zw(a)}}var b=p("__config"),n=p("__debug"),h=p("__geometry"),r=p("__obj_util"),g=p("__renderer"),m=p("__subscene"),q=p("__tsr"),B=p("__util"),d=p("__vec3"),l=b.v,f=[m.pb,m.hc,m.jd,m.Kc,m.df,m.Yd,m.pd,m.Ae,m.Ac,m.Be,m.kg,m.ze,m.Xd,m.Zg],H=new Float32Array(3);a.Vr=function(a){if(-1<f.indexOf(a.type)){for(var b=!1,n=a.type==m.Kc||a.type==m.Yd,B=a.za,r=0;r<B.length;r++){for(var p=B[r],x=p.ha,k=!1,t=0;t<x.length;t++){var M=
x[t],u=M.Y;u.lm&&m.gf(a,M)&&(a.Cr=!0);if(n)for(var v=0;6>v;v++)a.o.Ag=a.Ln[v],M.ou[v]=e(M,a),M.ou[v]&&(k=b=!0,c(u));else M.sb=e(M,a),M.sb&&(k=b=!0,c(u));a.qa&&(u.La.Bo=!0)}p.sb=k}a.qa=!1;switch(a.type){case m.ze:break;default:a.type==m.pb||a.type==m.Be||a.type==m.pd||a.type==m.jd||a.type==m.Kc||b?a.sb=!0:(a.sb&&g.clear(a),a.sb=!1)}if((a.type==m.hc||a.type==m.Ae)&&l.alpha_sort)for(b=q.cc(a.o.m,H),n=a.za,B=0;B<n.length;B++)for(r=n[B].ha,p=0;p<r.length;p++)if(k=r[p],k.sb){x=k.Jg;if((k=k.Y)&&k.bf){k=
k.aa;if(!k)continue;t=k.Kl;M=d.dist(b,t.iD);u=l.alpha_sort_threshold*Math.min(t.XF,1);if(!(M>u||x.bo))continue;h.WN(k,x.m,b);d.copy(b,t.iD)}x.bo=!1}}else{B=a.za;for(r=0;r<B.length;r++)for(x=B[r].ha,t=0;t<x.length;t++)M=x[t],u=M.Y,a.qa&&(u.La.Bo=!0),u.lm&&m.gf(a,M)&&(a.Cr=!0);a.qa=!1}a.Cr&&m.fN(a)}};b4w.module.__print=function(a){function p(a,b){var c=[];-1<a[0].indexOf("%c")?c.push(a[0].replace("%c","%c"+b+": ")):c.push(b+": "+a[0]);for(var d=1;d<a.length;d++)c.push(a[d]);return c}function e(){h++;var a=p(arguments,"B4W ERROR");console.error.apply(console,a)}function c(a){a in g||(g[a]=a,e([a]))}function b(a,b){c(a+"() is deprecated, use "+b+"() instead.")}var n=!1,h=0,r=0,g={};a.PM=function(a){n=a};a.Qe=function(){console.log.apply(console,arguments)};a.log=function(){if(n){var a=p(arguments,
"B4W LOG");console.log.apply(console,a)}};a.error=e;a.uc=c;a.qb=b;a.xg=function(a,e){switch(1<e.length){case !0:c(a+"() is deprecated, use "+e.slice(0,-1).join("(), ")+"() or "+e[e.length-1]+"() instead.");break;case !1:b(a,e[0])}};a.EI=function(){c('Config option "anaglyph_use" is deprecated, use "stereo" instead.')};a.warn=function(){r++;var a=p(arguments,"B4W WARN");console.warn.apply(console,a)};a.info=function(){var a=p(arguments,"B4W INFO");console.info.apply(console,a)};a.HI=function(){h++;
var a=p(arguments,"B4W EXPORT ERROR");console.error.apply(console,a)};a.II=function(){r++;var a=p(arguments,"B4W EXPORT WARNING");console.warn.apply(console,a)};a.time=function(){n&&console.time.apply(console,arguments)};a.timeEnd=function(){n&&console.timeEnd.apply(console,arguments)};a.group=function(){console.group.apply(console,arguments)};a.groupCollapsed=function(){console.groupCollapsed.apply(console,arguments)};a.groupEnd=function(){console.groupEnd.apply(console,arguments)};a.clear=function(){"function"==
typeof console.clear&&console.clear.apply(console,arguments)};a.UJ=function(){return r};a.CJ=function(){return h};a.clear_errors_warnings=function(){h=r=0}};b4w.module.print=b4w.module.__print;b4w.module.__reformer=function(a,p){function e(a){switch(a.type){case "VALTORGB":a.color_ramp||(a.color_ramp={elements:[{position:.5,color:[1,1,1,1]}]},b("node Color Ramp",a,"color_ramp"));break;case "CURVE_RGB":a.curve_mapping||(a.curve_mapping={curves_data:[[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]]],curves_handle_types:["EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED"],curve_extend:[["AUTO","AUTO"],["AUTO","AUTO"],["AUTO","AUTO"],["AUTO","AUTO"]]},b("node RGB Curves",a,
"curve_mapping"));break;case "CURVE_VEC":a.curve_mapping||(a.curve_mapping={curves_data:[[[0,0],[1,1]],[[0,0],[1,1]],[[0,0],[1,1]]],curves_handle_types:["EXTRAPOLATED","EXTRAPOLATED","EXTRAPOLATED"],curve_extend:[["AUTO","AUTO"],["AUTO","AUTO"],["AUTO","AUTO"]]},b("node Vector Curves",a,"curve_mapping"));break;case "MAPPING":a.vector_type||(a.vector_type="POINT",b("node Mapping",a,"vector_type"));break;case "MATERIAL":case "MATERIAL_EXT":"alpha"in a||(a.alpha=1,b("node material",a,"alpha"));"darkness"in
a||(a.darkness=1,b("node material",a,"darkness"));"diffuse_toon_size"in a||(a.diffuse_toon_size=.5,b("node material",a,"diffuse_toon_size"));"diffuse_toon_smooth"in a||(a.diffuse_toon_smooth=.1,b("node material",a,"diffuse_toon_smooth"));"diffuse_intensity"in a||(a.diffuse_intensity=1,b("node material",a,"diffuse_intensity"));"use_tangent_shading"in a||(a.use_tangent_shading=!1,b("node material",a,"use_tangent_shading"));"specular_shader"in a||(a.specular_shader="COOKTORR",b("node material",a,"specular_shader"));
"specular_ior"in a||(a.specular_ior=4,b("node material",a,"specular_ior"));"specular_hardness"in a||(a.specular_hardness=50,b("node material",a,"specular_hardness"));"specular_slope"in a||(a.specular_slope=.1,b("node material",a,"specular_slope"));"specular_toon_size"in a||(a.specular_toon_size=.5,b("node material",a,"specular_toon_size"));"specular_toon_smooth"in a||(a.specular_toon_smooth=.1,b("node material",a,"specular_toon_smooth"));"specular_intensity"in a||(a.specular_intensity=.5,b("node material",
a,"specular_intensity"));"diffuse_shader"in a||(a.diffuse_shader="LAMBERT",b("node material",a,"diffuse_shader"));"roughness"in a||(a.roughness=.5,b("node material",a,"roughness"));"diffuse_fresnel"in a||(a.diffuse_fresnel=.1,b("node material",a,"diffuse_fresnel"));"diffuse_fresnel_factor"in a||(a.diffuse_fresnel_factor=.5,b("node material",a,"diffuse_fresnel_factor"));break;case "MATH":case "MIX_RGB":"use_clamp"in a||(a.use_clamp=!1,b("node "+a.type,a,"use_clamp"));break;case "GROUP":a.node_tree_name=
a.node_tree_name.replace(/\.[0-9]{3,}$/g,"");switch(a.node_tree_name){case "CLAMP":case "LEVELS_OF_QUALITY":case "LINEAR_TO_SRGB":case "NORMAL_VIEW":case "PARALLAX":case "REFLECT":case "REFRACTION":case "REPLACE":case "SMOOTHSTEP":case "SRGB_TO_LINEAR":case "TIME":case "TRANSLUCENCY":case "VECTOR_VIEW":a.node_tree_name="B4W_"+a.node_tree_name}break;case "VECT_TRANSFORM":"convert_from"in a||(a.convert_from="WORLD",b("node "+a.type,a,"convert_from")),"convert_to"in a||(a.convert_to="WORLD",b("node "+
a.type,a,"convert_to")),"vector_type"in a||(a.vector_type="POINT",b("node "+a.type,a,"vector_type"))}}function c(a){if(a=a.nla_tracks)for(var c=0;c<a.length;c++)for(var d=a[c],e=0;e<d.strips.length;e++){var h=d.strips[e];"action"in h||(h.action=null,b("strip",h,"action"));"action_frame_start"in h||(h.action_frame_start=0,b("strip",h,"action_frame_start"));"action_frame_end"in h||(h.action_frame_end=h.frame_end-h.frame_start,b("strip",h,"action_frame_end"));"repeat"in h||(h.repeat=1,b("strip",h,"repeat"));
"use_reverse"in h||(h.use_reverse=!1,b("strip",h,"use_reverse"));"scale"in h||(h.scale=1,b("strip",h,"scale"))}}function b(a,b,c){c=c+">>"+a;c in y||(y[c]={yw:[],yB:"undefined",type:a});y[c].yw.push(b.name)}function n(a,b,c){c=c+">>"+a;c in y||(y[c]={yw:[],yB:"deprecated",type:a});y[c].yw.push(b.name)}function h(a){B.warn(a)}function r(a,b){b||(b=a.name+"_COPY");var c=a.materials,d=a.submeshes;a.materials=null;a.submeshes=null;var e=l.ki(a);a.materials=c;a.submeshes=d;e.name=b;e.materials=a.materials.slice(0);
e.submeshes=[];for(c=0;c<d.length;c++){var h=l.An(d[c]);e.submeshes.push(h)}return e}var g=p("__boundings"),m=p("__curve"),q=p("__mat4"),B=p("__print"),d=p("__quat"),l=p("__util"),f=p("__vec3"),H=p("__vec4"),D=p("__logic_nodes"),w=p("__animation"),E=[5,4],y={};a.By=function(a){return-1!=l.WC(a,E)};a.vG=function(a){y={};var d=a.worlds;if(0==d.length){B.warn('WARNING Datablock world is missing, reexport "'+a.b4w_filepath_blend+'" scene');var f={name:"DEFAULT",horizon_color:new Float32Array([0,0,0]),
zenith_color:new Float32Array([0,0,0]),light_settings:{use_environment_light:!1,environment_energy:1,environment_color:"PLAIN"},fog_settings:{use_fog:!1,intensity:0,depth:25,start:5,height:0,falloff:"INVERSE_QUADRATIC",use_custom_color:!0,color:[.5,.5,.5]},use_sky_paper:!1,use_sky_blend:!1,use_sky_real:!1,texture_slots:[]};d.push(f)}for(var d=a.worlds,k=0;k<d.length;k++){f=d[k];"use_sky_blend"in f||(b("world",f,"use_sky_blend"),f.use_sky_blend=!1);"use_sky_paper"in f||(b("world",f,"use_sky_paper"),
f.use_sky_paper=!1);"use_sky_real"in f||(b("world",f,"use_sky_real"),f.use_sky_real=!1);"b4w_sky_settings"in f&&"rayleigh_brightness"in f.b4w_sky_settings||(b("world",f,"rayleigh_brightness"),f.b4w_sky_settings={render_sky:!1,procedural_skydome:!1,use_as_enviroment_map:!1,color:[.24,.43,.75],rayleigh_brightness:3.3,mie_brightness:.1,spot_brightness:10,scatter_strength:.2,rayleigh_strength:.2,mie_strength:.006,rayleigh_collection_power:.5,mie_collection_power:.5,mie_distribution:.4});"fog_settings"in
f||(b("world",f,"fog_settings"),f.fog_settings={use_fog:!1,intensity:0,depth:25,start:0,height:0,falloff:"QUADRATIC",use_custom_color:!0,color:[.5,.5,.5]},"b4w_fog_color"in f&&(f.fog_settings.use_custom_color=!0,f.fog_settings.color=f.b4w_fog_color),"b4w_fog_density"in f&&0<f.b4w_fog_density&&(f.fog_settings.depth=1/f.b4w_fog_density));"render_sky"in f.b4w_sky_settings||(b("world",f,"render_sky"),f.b4w_sky_settings.render_sky=!1);for(var g=f.texture_slots,m=0;m<g.length;m++){var u=g[m];"blend_type"in
u||(u.blend_type="MIX",b("world_texture_slot",u,"blend_type"));"use_map_blend"in u||(u.use_map_blend=!1,b("world_texture_slot",u,"use_map_blend"));"use_map_horizon"in u||(u.use_map_horizon=!0,b("world_texture_slot",u,"use_map_horizon"));"use_map_zenith_up"in u||(u.use_map_zenith_up=!1,b("world_texture_slot",u,"use_map_zenith_up"));"use_rgb_to_intensity"in u||(u.use_rgb_to_intensity=!1,b("world_texture_slot",u,"use_rgb_to_intensity"));"invert"in u||(u.invert=!1,b("world_texture_slot",u,"invert"));
"color"in u||(u.color=[1,0,1],b("world_texture_slot",u,"color"));"blend_factor"in u||(u.blend_factor=0,b("world_texture_slot",u,"blend_factor"));"horizon_factor"in u||(u.horizon_factor=1,b("world_texture_slot",u,"horizon_factor"));"zenith_up_factor"in u||(u.zenith_up_factor=0,b("world_texture_slot",u,"zenith_up_factor"));"zenith_down_factor"in u||(u.zenith_down_factor=0,b("world_texture_slot",u,"zenith_down_factor"));"default_value"in u||(u.default_value=1,b("world_texture_slot",u,"default_value"))}"b4w_use_default_animation"in
f||(b("world",f,"b4w_use_default_animation"),f.b4w_use_default_animation=!1);"b4w_anim_behavior"in f||(b("world",f,"b4w_anim_behavior"),f.b4w_anim_behavior="CYCLIC")}m=a.scenes;for(k=0;k<m.length;k++)g=m[k],u=g.world,"timeline_markers"in g||(g.timeline_markers=null,b("scene",g,"timeline_markers")),"b4w_reflection_quality"in g||(g.b4w_reflection_quality="MEDIUM",b("scene",g,"b4w_reflection_quality")),"b4w_use_nla"in g||(g.b4w_use_nla=!1,b("scene",g,"b4w_use_nla")),"fps"in g||(g.fps=24,b("scene",g,
"fps")),"b4w_nla_cyclic"in g||(g.b4w_nla_cyclic=!1,b("scene",g,"b4w_nla_cyclic")),"b4w_logic_nodes"in g||(g.b4w_logic_nodes=[],b("scene",g,"b4w_logic_nodes")),"b4w_detect_collisions"in g&&(n("scene",g,"b4w_detect_collisions"),delete g.b4w_detect_collisions),"audio_doppler_speed"in g||(g.audio_doppler_speed=343.3),"audio_doppler_factor"in g||(g.audio_doppler_factor=1),"b4w_dynamic_compressor_settings"in g||(g.b4w_dynamic_compressor_settings={threshold:-24,knee:30,ratio:12,attack:.003,release:.25},
b("scene",g,"b4w_dynamic_compressor_settings")),"b4w_enable_convolution_engine"in g||(g.b4w_enable_convolution_engine=!1),"b4w_enable_bloom"in g||(g.b4w_enable_bloom=!1,b("scene",g,"b4w_enable_bloom")),"b4w_enable_motion_blur"in g||(g.b4w_enable_motion_blur=!1,b("scene",g,"b4w_enable_motion_blur")),"b4w_enable_color_correction"in g||(g.b4w_enable_color_correction=!1,b("scene",g,"b4w_enable_color_correction")),"b4w_antialiasing_quality"in g||(g.b4w_antialiasing_quality="MEDIUM",b("scene",g,"b4w_antialiasing_quality")),
"b4w_tags"in g||(g.b4w_tags={title:"",description:""},b("scene",g,"b4w_tags")),"b4w_enable_object_selection"in g||(g.b4w_enable_object_selection="AUTO",b("scene",g,"b4w_enable_object_selection")),"b4w_enable_outlining"in g||(g.b4w_enable_outlining="AUTO",b("scene",g,"b4w_enable_outlining")),"b4w_enable_glow_materials"in g||(g.b4w_enable_glow_materials="AUTO",b("scene",g,"b4w_enable_glow_materials")),"b4w_enable_anchors_visibility"in g||(g.b4w_enable_anchors_visibility="AUTO",b("scene",g,"b4w_enable_anchors_visibility")),
"b4w_outline_color"in g||(g.b4w_outline_color=[1,1,1],b("scene",g,"b4w_outline_color")),"b4w_outline_factor"in g||(g.b4w_outline_factor="b4w_glow_factor"in g?g.b4w_glow_factor:1,b("scene",g,"b4w_outline_factor")),"b4w_shadow_settings"in g||(b("scene",g,"b4w_shadow_settings"),d=u.b4w_shadow_settings,g.b4w_shadow_settings=d?d:{csm_resolution:2048,self_shadow_polygon_offset:1,b4w_enable_csm:!1,csm_num:1,csm_first_cascade_border:10,first_cascade_blur_radius:3,csm_last_cascade_border:100,last_cascade_blur_radius:1.5,
fade_last_cascade:!0,blend_between_cascades:!0}),d=g.b4w_shadow_settings,"csm_resolution"in d||(b("scene",g,"b4w_shadow_settings.csm_resolution"),d.csm_resolution=2048),"self_shadow_polygon_offset"in d||(b("scene",g,"b4w_shadow_settings.self_shadow_polygon_offset"),d.self_shadow_polygon_offset=1),"self_shadow_normal_offset"in d||(b("scene",g,"b4w_shadow_settings.self_shadow_normal_offset"),d.self_shadow_normal_offset=.01),"b4w_enable_csm"in d||(b("scene",g,"b4w_shadow_settings.b4w_enable_csm"),d.b4w_enable_csm=
!1),"csm_num"in d||(b("scene",g,"b4w_shadow_settings.csm_num"),d.csm_num=1),"csm_first_cascade_border"in d||(b("scene",g,"b4w_shadow_settings.csm_first_cascade_border"),d.csm_first_cascade_border=10),"first_cascade_blur_radius"in d||(b("scene",g,"b4w_shadow_settings.first_cascade_blur_radius"),d.first_cascade_blur_radius=3),"csm_last_cascade_border"in d||(b("scene",g,"b4w_shadow_settings.csm_last_cascade_border"),d.csm_last_cascade_border=100),"last_cascade_blur_radius"in d||(b("scene",g,"b4w_shadow_settings.last_cascade_blur_radius"),
d.last_cascade_blur_radius=1.5),"fade_last_cascade"in d||(b("scene",g,"b4w_shadow_settings.fade_last_cascade"),d.fade_last_cascade=!0),"blend_between_cascades"in d||(b("scene",g,"b4w_shadow_settings.blend_between_cascades"),d.blend_between_cascades=!0),"b4w_ssao_settings"in g||(b("scene",g,"b4w_ssao_settings"),d=u.b4w_ssao_settings,g.b4w_ssao_settings=d?d:{dist_factor:0,samples:16,hemisphere:!1,blur_depth:!1,blur_discard_value:1}),d=g.b4w_ssao_settings,"dist_factor"in d||(b("scene",g,"b4w_ssao_settings.dist_factor"),
d.dist_factor=0),"samples"in d||(b("scene",g,"b4w_ssao_settings.samples"),d.samples=16),"hemisphere"in d||(b("scene",g,"b4w_ssao_settings.hemisphere"),d.hemisphere=!1),"blur_depth"in d||(b("scene",g,"b4w_ssao_settings.blur_depth"),d.blur_depth=!1),"blur_discard_value"in d||(b("scene",g,"b4w_ssao_settings.blur_discard_value"),d.blur_discard_value=1),"b4w_bloom_settings"in g||(b("scene",g,"b4w_bloom_settings"),d=u.b4w_bloom_settings,g.b4w_bloom_settings=d?d:{key:.2,blur:4,edge_lum:1}),"key"in g.b4w_bloom_settings||
(b("scene",g,"b4w_bloom_settings.key"),g.b4w_bloom_settings.key=.2),"blur"in g.b4w_bloom_settings||(b("scene",g,"b4w_bloom_settings.blur"),g.b4w_bloom_settings.blur=4),"edge_lum"in g.b4w_bloom_settings||(b("scene",g,"b4w_bloom_settings.edge_lum"),g.b4w_bloom_settings.edge_lum=1),"b4w_motion_blur_settings"in g||(b("scene",g,"b4w_motion_blur_settings"),d=u.b4w_motion_blur_settings,g.b4w_motion_blur_settings=d?d:{motion_blur_factor:.01,motion_blur_decay_threshold:.01}),"motion_blur_factor"in g.b4w_motion_blur_settings||
(b("scene",g,"b4w_motion_blur_settings.motion_blur_factor"),g.b4w_motion_blur_settings.motion_blur_factor=.01),"motion_blur_decay_threshold"in g.b4w_motion_blur_settings||(b("scene",g,"b4w_motion_blur_settings.motion_blur_decay_threshold"),g.b4w_motion_blur_settings.motion_blur_decay_threshold=.01),"b4w_color_correction_settings"in g||(b("scene",g,"b4w_color_correction_settings"),d=u.b4w_color_correction_settings,g.b4w_color_correction_settings=d?d:{brightness:0,contrast:0,exposure:1,saturation:1}),
"b4w_god_rays_settings"in g||(b("scene",g,"b4w_god_rays_settings"),d=u.b4w_god_rays_settings,g.b4w_god_rays_settings=d?d:{intensity:.7,max_ray_length:1,steps_per_pass:10}),"steps_per_pass"in g.b4w_god_rays_settings||(b("scene",g,"b4w_god_rays_settings.steps_per_pass"),g.b4w_god_rays_settings.steps_per_pass=10),"b4w_glow_settings"in g||(b("scene",g,"b4w_glow_settings"),g.b4w_glow_settings={render_glow_over_blend:!1,small_glow_mask_coeff:2,large_glow_mask_coeff:2,small_glow_mask_width:2,large_glow_mask_width:6},
d=g.b4w_glow_settings,"b4w_render_glow_over_blend"in u&&(d.render_glow_over_blend=u.b4w_render_glow_over_blend),"b4w_small_glow_mask_coeff"in u&&(d.small_glow_mask_coeff=u.b4w_small_glow_mask_coeff),"b4w_large_glow_mask_coeff"in u&&(d.large_glow_mask_coeff=u.b4w_large_glow_mask_coeff),"b4w_small_glow_mask_width"in u&&(d.small_glow_mask_width=u.b4w_small_glow_mask_width),"b4w_large_glow_mask_width"in u&&(d.large_glow_mask_width=u.b4w_large_glow_mask_width)),u=g.b4w_render_shadows,"AUTO"!=u&&"OFF"!=
u&&"ON"!=u&&(g.b4w_render_shadows=u?"ON":"OFF"),u=g.b4w_render_reflections,"OFF"!=u&&"ON"!=u&&(g.b4w_render_reflections=u?"ON":"OFF"),u=g.b4w_render_refractions,"AUTO"!=u&&"OFF"!=u&&"ON"!=u&&(g.b4w_render_refractions=u?"ON":"OFF"),"b4w_render_dynamic_grass"in g||(b("scene",g,"b4w_render_dynamic_grass"),g.b4w_render_dynamic_grass="AUTO"),g.b4w_nla_script&&n("scene",g,"b4w_nla_script"),"audio_distance_model"in g||(b("scene",g,"audio_distance_model"),g.audio_distance_model="INVERSE_CLAMPED");g=a.meshes;
for(k=0;k<g.length;k++){u=g[k];u.b4w_bounding_box||(b("mesh",u,"b4w_bounding_box"),u.b4w_bounding_box={max_x:0,max_y:0,max_z:0,min_x:0,min_y:0,min_z:0});u.b4w_bounding_box_source||(b("mesh",u,"b4w_bounding_box_source"),u.b4w_bounding_box_source=u.b4w_bounding_box);u.uv_textures||(b("mesh",u,"uv_textures"),u.uv_textures=[]);u.b4w_bounding_sphere_center||(u.b4w_bounding_sphere_center=[0,0,0]);u.b4w_bounding_cylinder_center||(u.b4w_bounding_cylinder_center=[0,0,0]);u.b4w_bounding_ellipsoid_center||(u.b4w_bounding_ellipsoid_center=
[0,0,0]);u.b4w_bounding_ellipsoid_axes||(m=u.b4w_bounding_box,u.b4w_bounding_ellipsoid_axes=[(m.max_x-m.min_x)/2,(m.max_y-m.min_y)/2,(m.max_z-m.min_z)/2]);"b4w_shape_keys"in u||(u.b4w_shape_keys=[],b("mesh",u,"b4w_shape_keys"));m=!0;for(d=0;d<u.submeshes.length;d++)f=u.submeshes[d],"boundings"in f||(m=!1,f.boundings={bounding_ellipsoid_axes:u.b4w_bounding_ellipsoid_axes,bounding_ellipsoid_center:u.b4w_bounding_ellipsoid_center,bounding_box:{max_x:u.b4w_bounding_box.max_x,max_y:u.b4w_bounding_box.max_y,
max_z:u.b4w_bounding_box.max_z,min_x:u.b4w_bounding_box.min_x,min_y:u.b4w_bounding_box.min_y,min_z:u.b4w_bounding_box.min_z}});m||b("mesh",u,"submesh_bd");for(var m=u,d=["b4w_apply_scale","b4w_apply_modifiers","b4w_export_edited_normals","b4w_loc_export_vertex_anim","b4w_shape_keys"],f=null,v=0;v<d.length;v++)m[d[v]]&&(f?(m[d[v]]=!1,B.warn('WARNING property "'+d[v]+'" of object "'+m.name+'" has been set to "false". Foreground property "'+f+'" already exists.')):f=d[v]);for(m=0;m<u.b4w_vertex_anim.length;m++)d=
u.b4w_vertex_anim[m],"allow_nla"in d||(b('mesh["b4w_vertex_anim"]',u,"allow_nla"),d.allow_nla=!0)}m=a.cameras;for(k=0;k<m.length;k++)g=m[k],g.type||(g.type="PERSP",b("camera",g,"type")),"b4w_eye_target_dist"in g&&(delete g.b4w_eye_target_dist,n("camera",g,"b4w_eye_target_dist")),"b4w_hover_zero_level"in g||(g.b4w_hover_zero_level=0,b("camera",g,"b4w_hover_zero_level")),"b4w_trans_velocity"in g||(g.b4w_trans_velocity=1,b("camera",g,"b4w_trans_velocity")),"b4w_rot_velocity"in g||(g.b4w_rot_velocity=
1,b("camera",g,"b4w_rot_velocity")),"b4w_zoom_velocity"in g||(g.b4w_zoom_velocity=.1,b("camera",g,"b4w_zoom_velocity")),"b4w_use_target_distance_limits"in g||(g.b4w_use_target_distance_limits=g.b4w_use_distance_limits||!1,b("camera",g,"b4w_use_target_distance_limits")),"b4w_use_zooming"in g||(g.b4w_use_zooming=g.b4w_use_distance_limits||!1,b("camera",g,"b4w_use_zooming")),"b4w_distance_min"in g||(g.b4w_distance_min=1,b("camera",g,"b4w_distance_min")),"b4w_distance_max"in g||(g.b4w_distance_max=100,
b("camera",g,"b4w_distance_max")),"b4w_horizontal_translation_min"in g||(g.b4w_horizontal_translation_min=-100,b("camera",g,"b4w_horizontal_translation_min")),"b4w_horizontal_translation_max"in g||(g.b4w_horizontal_translation_max=100,b("camera",g,"b4w_horizontal_translation_max")),"b4w_vertical_translation_min"in g||(g.b4w_vertical_translation_min=-100,b("camera",g,"b4w_vertical_translation_min")),"b4w_vertical_translation_max"in g||(g.b4w_vertical_translation_max=100,b("camera",g,"b4w_vertical_translation_max")),
"b4w_use_horizontal_clamping"in g||(g.b4w_use_horizontal_clamping=!1,b("camera",g,"b4w_use_horizontal_clamping")),"b4w_rotation_left_limit"in g||(g.b4w_rotation_left_limit=-Math.PI,b("camera",g,"b4w_rotation_left_limit")),"b4w_rotation_right_limit"in g||(g.b4w_rotation_right_limit=Math.PI,b("camera",g,"b4w_rotation_right_limit")),"b4w_horizontal_clamping_type"in g||(g.b4w_horizontal_clamping_type="LOCAL",b("camera",g,"b4w_horizontal_clamping_type")),"b4w_use_vertical_clamping"in g||(g.b4w_use_vertical_clamping=
!1,b("camera",g,"b4w_use_vertical_clamping")),"b4w_rotation_down_limit"in g||(g.b4w_rotation_down_limit=-Math.PI/2,b("camera",g,"b4w_rotation_down_limit")),"b4w_rotation_up_limit"in g||(g.b4w_rotation_up_limit=Math.PI/2,b("camera",g,"b4w_rotation_up_limit")),"b4w_vertical_clamping_type"in g||(g.b4w_vertical_clamping_type="LOCAL",b("camera",g,"b4w_vertical_clamping_type")),"b4w_hover_angle_min"in g||(g.b4w_hover_angle_min=Math.PI/6,b("camera",g,"b4w_hover_angle_min")),"b4w_hover_angle_max"in g||(g.b4w_hover_angle_max=
Math.PI/6,b("camera",g,"b4w_hover_angle_max")),"b4w_enable_hover_hor_rotation"in g||(g.b4w_enable_hover_hor_rotation=!0,b("camera",g,"b4w_enable_hover_hor_rotation")),"b4w_use_panning"in g||(g.b4w_use_panning=!0,b("camera",g,"b4w_use_panning")),"b4w_use_pivot_limits"in g||(g.b4w_use_pivot_limits=!1,g.b4w_pivot_z_min=0,g.b4w_pivot_z_max=10,b("camera",g,"b4w_use_pivot_limits")),"b4w_dof_bokeh"in g||(g.b4w_dof_bokeh=!1,b("camera",g,"b4w_dof_bokeh")),"b4w_dof_bokeh_intensity"in g||(g.b4w_dof_bokeh_intensity=
.3,b("camera",g,"b4w_dof_bokeh_intensity")),"b4w_dof_foreground_blur"in g||(g.b4w_dof_foreground_blur=!1,b("camera",g,"b4w_dof_foreground_blur")),"b4w_dof_front_start"in g||(g.b4w_dof_front_start=0,b("camera",g,"b4w_dof_front_start")),"b4w_dof_front_end"in g||(g.b4w_dof_front_end=g.b4w_dof_front,b("camera",g,"b4w_dof_front_end")),"b4w_dof_rear_start"in g||(g.b4w_dof_rear_start=0,b("camera",g,"b4w_dof_rear_start")),"b4w_dof_rear_end"in g||(g.b4w_dof_rear_end=g.b4w_dof_rear,b("camera",g,"b4w_dof_rear_end"));
m=a.lamps;for(k=0;k<m.length;k++)g=m[k],"b4w_generate_shadows"in g||(g.b4w_generate_shadows=!1,b("lamp",g,"b4w_generate_shadows")),"b4w_dynamic_intensity"in g||(g.b4w_dynamic_intensity=!1,b("lamp",g,"b4w_dynamic_intensity")),"use_diffuse"in g||(g.use_diffuse=!0,b("lamp",g,"use_diffuse")),"use_specular"in g||(g.use_specular=!0,b("lamp",g,"use_specular")),"clip_start"in g||(g.clip_start=.1,b("lamp",g,"clip_start")),"clip_end"in g||(g.clip_end=30,b("lamp",g,"clip_end"));m=a.speakers;for(k=0;k<m.length;k++)g=
m[k],"b4w_behavior"in g||(g.b4w_behavior=g.b4w_background_music?"BACKGROUND_SOUND":"POSITIONAL"),"b4w_auto_play"in g||(g.b4w_auto_play=!1,b("speaker",g,"b4w_auto_play")),"b4w_enable_doppler"in g||(g.b4w_enable_doppler=!1,b("speaker",g,"b4w_enable_doppler")),"b4w_delay"in g||(g.b4w_delay=0),"b4w_delay_random"in g||(g.b4w_delay_random=0),"b4w_volume_random"in g||(g.b4w_volume_random=0),"b4w_pitch_random"in g||(g.b4w_pitch_random=0),"b4w_fade_in"in g||(g.b4w_fade_in=0),"b4w_fade_out"in g||(g.b4w_fade_out=
0),"b4w_loop"in g||(g.b4w_loop=!1),"b4w_loop_start"in g||(g.b4w_loop_start=0,b("speaker",g,"b4w_loop_start")),"b4w_loop_end"in g||(g.b4w_loop_end=0,b("speaker",g,"b4w_loop_end")),g.animation_data&&c(g.animation_data);m=a.textures;for(k=0;k<m.length;k++)g=m[k],"b4w_anisotropic_filtering"in g||(g.b4w_anisotropic_filtering="OFF",b("texture",g,"b4w_anisotropic_filtering")),"b4w_water_foam"in g||(g.b4w_water_foam=!1,b("texture",g,"b4w_water_foam")),"b4w_foam_uv_freq"in g||(g.b4w_foam_uv_freq=[1,1],b("texture",
g,"b4w_foam_uv_freq")),"b4w_foam_uv_magnitude"in g||(g.b4w_foam_uv_magnitude=[1,1],b("texture",g,"b4w_foam_uv_magnitude")),"b4w_parallax_steps"in g||(g.b4w_parallax_steps=5,b("material",g,"b4w_parallax_steps")),"b4w_parallax_lod_dist"in g||(g.b4w_parallax_lod_dist=10,b("material",g,"b4w_parallax_lod_dist")),"b4w_shore_dist_map"in g||(g.b4w_shore_dist_map=!1,b("texture",g,"b4w_shore_dist_map")),"b4w_shore_boundings"in g||(g.b4w_shore_boundings=[1E3,-1E3,1E3,-1E3],b("texture",g,"b4w_shore_boundings")),
"b4w_max_shore_dist"in g||(g.b4w_max_shore_dist=100,b("texture",g,"b4w_max_shore_dist")),"b4w_disable_compression"in g||(g.b4w_disable_compression=!1,b("texture",g,"b4w_disable_compression")),"b4w_source_type"in g||(g.b4w_source_type="",b("texture",g,"b4w_source_type")),"b4w_source_id"in g||(g.b4w_source_id="",b("texture",g,"b4w_source_id")),"b4w_source_size"in g||(g.b4w_source_size=1024,b("texture",g,"b4w_source_size")),"b4w_enable_canvas_mipmapping"in g||(g.b4w_enable_canvas_mipmapping=!0,b("texture",
g,"b4w_enable_canvas_mipmapping")),"b4w_nla_video"in g||(g.b4w_nla_video=!1,b("texture",g,"b4w_nla_video"));m=a.images;for(k=0;k<m.length;k++)g=m[k],"colorspace_settings_name"in g||(g.colorspace_settings_name="sRGB",b("image",g,"colorspace_settings_name"));d=a.materials;for(k=0;k<d.length;k++){f=d[k];"ALPHA_ANTIALIASING"==f.game_settings.alpha_blend&&(f.game_settings.alpha_blend="CLIP");"use_tangent_shading"in f||(f.use_tangent_shading=!1,b("material",f,"use_tangent_shading"));"b4w_node_mat_type"in
f&&n("material",f,"b4w_node_mat_type");"b4w_skydome"in f&&n("material",f,"b4w_skydome");"b4w_procedural_skydome"in f&&n("material",f,"b4w_procedural_skydome");"b4w_lens_flares"in f||(f.b4w_lens_flares=!1,b("material",f,"b4w_lens_flares"));"LENS_FLARES"===f.name&&(f.b4w_lens_flares||B.warn('"LENS_FLARES" material name has been found. Enable the "Lens Flare" property for this material.'),f.b4w_lens_flares=!0);f.b4w_water&&("b4w_water_shore_smoothing"in f||(f.b4w_water_shore_smoothing=!1,b("material",
f,"b4w_water_shore_smoothing")),"b4w_water_dynamic"in f||(f.b4w_water_dynamic=!1,b("material",f,"b4w_water_dynamic")),"b4w_waves_height"in f||(f.b4w_waves_height=1,b("material",f,"b4w_waves_height")),"b4w_waves_length"in f||(f.b4w_waves_length=1,b("material",f,"b4w_waves_length")),"b4w_water_dst_noise_scale0"in f||(f.b4w_water_dst_noise_scale0=.05,b("material",f,"b4w_water_dst_noise_scale0")),"b4w_water_dst_noise_scale1"in f||(f.b4w_water_dst_noise_scale1=.03,b("material",f,"b4w_water_dst_noise_scale1")),
"b4w_water_dst_noise_freq0"in f||(f.b4w_water_dst_noise_freq0=1.3,b("material",f,"b4w_water_dst_noise_freq0")),"b4w_water_dst_noise_freq1"in f||(f.b4w_water_dst_noise_freq1=1,b("material",f,"b4w_water_dst_noise_freq1")),"b4w_water_dir_min_shore_fac"in f||(f.b4w_water_dir_min_shore_fac=.4,b("material",f,"b4w_water_dir_min_shore_fac")),"b4w_water_dir_freq"in f||(f.b4w_water_dir_freq=.5,b("material",f,"b4w_water_dir_freq")),"b4w_water_dir_noise_scale"in f||(f.b4w_water_dir_noise_scale=.05,b("material",
f,"b4w_water_dir_noise_scale")),"b4w_water_dir_noise_freq"in f||(f.b4w_water_dir_noise_freq=.07,b("material",f,"b4w_water_dir_noise_freq")),"b4w_water_dir_min_noise_fac"in f||(f.b4w_water_dir_min_noise_fac=.5,b("material",f,"b4w_water_dir_min_noise_fac")),"b4w_water_dst_min_fac"in f||(f.b4w_water_dst_min_fac=.2,b("material",f,"b4w_water_dst_min_fac")),"b4w_water_waves_hor_fac"in f||(f.b4w_water_waves_hor_fac=5,b("material",f,"b4w_water_waves_hor_fac")),"b4w_water_absorb_factor"in f||(f.b4w_water_absorb_factor=
6,b("material",f,"b4w_water_absorb_factor")),"b4w_water_fog_color"in f||(f.b4w_water_fog_color=[.5,.7,.7],b("material",f,"b4w_water_fog_color")),"b4w_foam_factor"in f||(f.b4w_foam_factor=5,b("material",f,"b4w_foam_factor")),"b4w_generated_mesh"in f||(f.b4w_generated_mesh=!1,b("material",f,"b4w_generated_mesh")),"b4w_water_num_cascads"in f||(f.b4w_water_num_cascads=5,b("material",f,"b4w_water_num_cascads")),"b4w_water_subdivs"in f||(f.b4w_water_subdivs=64,b("material",f,"b4w_water_subdivs")),"b4w_water_detailed_dist"in
f||(f.b4w_water_detailed_dist=1E3,b("material",f,"b4w_water_detailed_dist")),"b4w_water_enable_caust"in f||(f.b4w_water_enable_caust=!1,b("material",f,"b4w_water_enable_caust")),"b4w_water_caust_scale"in f||(f.b4w_water_caust_scale=.25,b("material",f,"b4w_water_caust_scale")),"b4w_water_caust_brightness"in f||(f.b4w_water_caust_brightness=.5,b("material",f,"b4w_water_caust_brightness")));"b4w_dynamic_grass_size"in f||(f.b4w_dynamic_grass_size="");"b4w_dynamic_grass_color"in f||(f.b4w_dynamic_grass_color=
"");"diffuse_intensity"in f||(f.diffuse_intensity=1,b("material",f,"diffuse_intensity"));"b4w_use_ghost"in f||(f.b4w_use_ghost=!1);"b4w_collision_margin"in f||(f.b4w_collision_margin=.04,b("material",f,"b4w_collision_margin"));"b4w_collision_group"in f||(f.b4w_collision_group=128,b("material",f,"b4w_collision_group"));"b4w_collision_mask"in f||(f.b4w_collision_mask=127,b("material",f,"b4w_collision_mask"));"b4w_do_not_render"in f||(f.b4w_do_not_render=!1,b("material",f,"b4w_do_not_render"));"HALO"!=
f.type||"b4w_halo_sky_stars"in f||(f.b4w_halo_sky_stars=!1,b("material",f,"b4w_halo_sky_stars"));"HALO"!=f.type||"b4w_halo_stars_blend_height"in f||(f.b4w_halo_stars_blend_height=10,b("material",f,"b4w_halo_stars_blend_height"));"HALO"!=f.type||"b4w_halo_stars_min_height"in f||(f.b4w_halo_stars_min_height=0,b("material",f,"b4w_halo_stars_min_height"));"specular_shader"in f||(f.specular_shader="COOKTORR",b("material",f,"specular_shader"));"diffuse_shader"in f||(f.diffuse_shader="LAMBERT",b("material",
f,"diffuse_shader"));"roughness"in f||(f.roughness=.5,b("material",f,"roughness"));"diffuse_fresnel"in f||(f.diffuse_fresnel=.1,b("material",f,"diffuse_fresnel"));"diffuse_fresnel_factor"in f||(f.diffuse_fresnel_factor=.5,b("material",f,"diffuse_fresnel_factor"));"specular_slope"in f||(f.specular_slope=.2,b("material",f,"specular_slope"));"specular_toon_size"in f||(f.specular_toon_size=.5,b("material",f,"specular_toon_size"));"specular_toon_smooth"in f||(f.specular_toon_smooth=.1,b("material",f,"specular_toon_smooth"));
"specular_alpha"in f||(f.specular_alpha=1,b("material",f,"specular_alpha"));"b4w_wettable"in f||(f.b4w_wettable=!1,b("material",f,"b4w_wettable"));"b4w_refractive"in f||(f.b4w_refractive=!1,b("material",f,"b4w_refractive"));"b4w_refr_bump"in f||(f.b4w_refr_bump=0,b("material",f,"b4w_refr_bump"));"b4w_shallow_water_col"in f||(f.b4w_shallow_water_col=[0,.8,.3],b("material",f,"b4w_shallow_water_col"));"b4w_shore_water_col"in f||(f.b4w_shore_water_col=[0,.9,.2],b("material",f,"b4w_shore_water_col"));
"b4w_shallow_water_col_fac"in f||(f.b4w_shallow_water_col_fac=1,b("material",f,"b4w_shallow_water_col_fac"));"b4w_shore_water_col_fac"in f||(f.b4w_shore_water_col_fac=.5,b("material",f,"b4w_shore_water_col_fac"));"b4w_water_sss_strength"in f||(f.b4w_water_sss_strength=5.9,b("material",f,"b4w_water_sss_strength"));"b4w_water_sss_width"in f||(f.b4w_water_sss_width=.45,b("material",f,"b4w_water_sss_width"));"b4w_render_above_all"in f||(f.b4w_render_above_all=!1,b("material",f,"b4w_render_above_all"));
"b4w_water_norm_uv_velocity"in f||(f.b4w_water_norm_uv_velocity=.05,b("material",f,"b4w_water_norm_uv_velocity"));"specular_ior"in f||(f.specular_ior=1,b("material",f,"specular_ior"));"darkness"in f||(f.darkness=0,b("material",f,"darkness"));"diffuse_toon_size"in f||(f.diffuse_toon_size=0,b("material",f,"diffuse_toon_size"));"diffuse_toon_smooth"in f||(f.diffuse_toon_smooth=0,b("material",f,"diffuse_toon_smooth"));g=f.texture_slots;for(m=0;m<g.length;m++)u=g[m],"blend_type"in u||(u.blend_type="MIX",
b("texture_slot",u,"blend_type"));if(f.node_tree){g=f.node_tree.nodes;for(m=0;m<g.length;m++)e(g[m]);f.node_tree.animation_data&&c(f.node_tree.animation_data)}}u=a.node_groups;for(k=0;k<u.length;k++)for(g=u[k].node_tree.nodes,m=0;m<g.length;m++)e(g[m]);g=a.objects;for(k=0;k<g.length;k++){u=g[k];switch(u.type){case "MESH":"b4w_dynamic_geometry"in u||(u.b4w_dynamic_geometry=!1);"b4w_reflexible"in u||(u.b4w_reflexible=!1);"b4w_reflexible_only"in u||(u.b4w_reflexible_only=!1);"b4w_reflective"in u||(u.b4w_reflective=
!1);"b4w_reflection_type"in u||(u.b4w_reflection_type="PLANE",b("object",u,"b4w_reflection_type"));"b4w_wind_bending"in u||(u.b4w_wind_bending=!1,b("object",u,"b4w_wind_bending"));"b4w_wind_bending_angle"in u||(u.b4w_wind_bending_angle=10,u.b4w_wind_bending_freq=.25,b("object",u,"wind bending params"));"b4w_detail_bending_amp"in u||(u.b4w_detail_bending_amp=.1,u.b4w_branch_bending_amp=.3,b("object",u,"detail bending params"));"b4w_detail_bending_freq"in u||(u.b4w_detail_bending_freq=1,b("object",
u,"b4w_detail_bending_freq"));"b4w_main_bend_stiffness_col"in u||(u.b4w_main_bend_stiffness_col="",b("object",u,"b4w_main_bend_stiffness_col"));"b4w_detail_bend_colors"in u||(u.b4w_detail_bend_colors={leaves_stiffness_col:"",leaves_phase_col:"",overall_stiffness_col:""},b("object",u,"b4w_detail_bend_colors"));"b4w_caustics"in u||(u.b4w_caustics=!1);"vertex_groups"in u&&u.vertex_groups.length&&u.data&&0==u.data.vertex_groups.length&&(u.data.vertex_groups=u.vertex_groups,delete u.vertex_groups,b("object",
u,"vertex_groups"));"b4w_vertex_anim"in u&&u.b4w_vertex_anim.length&&u.data&&0==u.data.b4w_vertex_anim.length&&(u.data.b4w_vertex_anim=u.b4w_vertex_anim,delete u.b4w_vertex_anim,b("object",u,"b4w_vertex_anim"));"b4w_do_not_render"in u||(u.b4w_do_not_render=!1);"b4w_hidden_on_load"in u||(u.b4w_hidden_on_load=!1);"use_ghost"in u.game||(u.game.use_ghost=!1);"use_sleep"in u.game||(u.game.use_sleep=!1);"velocity_min"in u.game||(u.game.velocity_min=0);"velocity_max"in u.game||(u.game.velocity_max=0);"collision_group"in
u.game||(u.game.collision_group=1);"collision_mask"in u.game||(u.game.collision_mask=255);m=u;d=m.game;f=d.collision_bounds_type;d.use_collision_bounds&&"BOX"!=f&&"CYLINDER"!=f&&"CONE"!=f&&"SPHERE"!=f&&"CAPSULE"!=f&&"EMPTY"!=f&&(B.error("Wrong collision bounds type "+f+". Disable physics for object "+m.name),m.b4w_collision=!1,m.b4w_floating=!1,m.b4w_vehicle=!1,m.b4w_character=!1);"b4w_vehicle_settings"in u?u.b4w_vehicle_settings&&("steering_ratio"in u.b4w_vehicle_settings||(u.b4w_vehicle_settings.steering_ratio=
10),"steering_max"in u.b4w_vehicle_settings||(u.b4w_vehicle_settings.steering_max=1),"inverse_control"in u.b4w_vehicle_settings||(u.b4w_vehicle_settings.inverse_control=!1),"force_max"in u.b4w_vehicle_settings||(u.b4w_vehicle_settings.force_max=1500),"brake_max"in u.b4w_vehicle_settings||(u.b4w_vehicle_settings.brake_max=100),"speed_ratio"in u.b4w_vehicle_settings||(u.b4w_vehicle_settings.speed_ratio=.027),"max_speed_angle"in u.b4w_vehicle_settings||(u.b4w_vehicle_settings.max_speed_angle=Math.PI),
"delta_tach_angle"in u.b4w_vehicle_settings||(u.b4w_vehicle_settings.delta_tach_angle=4.43),"suspension_compression"in u.b4w_vehicle_settings||(u.b4w_vehicle_settings.suspension_compression=4.4),"suspension_stiffness"in u.b4w_vehicle_settings||(u.b4w_vehicle_settings.suspension_stiffness=20),"suspension_damping"in u.b4w_vehicle_settings||(u.b4w_vehicle_settings.suspension_damping=2.3),"wheel_friction"in u.b4w_vehicle_settings||(u.b4w_vehicle_settings.wheel_friction=1E3),"roll_influence"in u.b4w_vehicle_settings||
(u.b4w_vehicle_settings.roll_influence=.1),"max_suspension_travel_cm"in u.b4w_vehicle_settings||(u.b4w_vehicle_settings.max_suspension_travel_cm=30),"floating_factor"in u.b4w_vehicle_settings||(u.b4w_vehicle_settings.floating_factor=3),"floating_factor"in u.b4w_vehicle_settings||(u.b4w_vehicle_settings.floating_factor=3),"water_lin_damp"in u.b4w_vehicle_settings||(u.b4w_vehicle_settings.water_lin_damp=.9),"water_rot_damp"in u.b4w_vehicle_settings||(u.b4w_vehicle_settings.water_rot_damp=.9)):(u.b4w_vehicle_settings=
null,b("object",u,"b4w_vehicle_settings"));"b4w_floating_settings"in u?u.b4w_floating_settings&&("floating_factor"in u.b4w_floating_settings||(u.b4w_floating_settings.floating_factor=3),"water_lin_damp"in u.b4w_floating_settings||(u.b4w_floating_settings.water_lin_damp=.8),"water_rot_damp"in u.b4w_floating_settings||(u.b4w_floating_settings.water_rot_damp=.8)):(u.b4w_floating_settings=null,b("object",u,"b4w_floating_settings"));"b4w_character_settings"in u?u.b4w_character_settings&&("walk_speed"in
u.b4w_character_settings||(u.b4w_character_settings.walk_speed=4),"run_speed"in u.b4w_character_settings||(u.b4w_character_settings.run_speed=8),"step_height"in u.b4w_character_settings||(u.b4w_character_settings.step_height=.25),"jump_strength"in u.b4w_character_settings||(u.b4w_character_settings.jump_strength=5),"waterline"in u.b4w_character_settings||(u.b4w_character_settings.waterline=0)):(u.b4w_character_settings=null,b("object",u,"b4w_character_settings"));"b4w_selectable"in u||(u.b4w_selectable=
!1,b("object",u,"b4w_selectable"));"b4w_outlining"in u||(u.b4w_outlining=!1,b("object",u,"b4w_outlining"));"b4w_outline_on_select"in u||(u.b4w_outline_on_select=!1,b("object",u,"b4w_outline_on_select"));"b4w_billboard"in u||(u.b4w_billboard=!1,b("object",u,"b4w_billboard"));"b4w_billboard_geometry"in u||(u.b4w_billboard_geometry="SPHERICAL",b("object",u,"b4w_billboard_geometry"));"b4w_pres_glob_orientation"in u||(u.b4w_pres_glob_orientation=!1,b("object",u,"b4w_pres_glob_orientation"));"b4w_outline_settings"in
u||("b4w_glow_settings"in u?u.b4w_outline_settings=u.b4w_glow_settings:(u.b4w_outline_settings={},u.b4w_outline_settings.outline_duration=1,u.b4w_outline_settings.outline_period=1,u.b4w_outline_settings.outline_relapses=0),b("object",u,"b4w_outline_settings"));"b4w_lod_transition"in u||(u.b4w_lod_transition=.01,b("object",u,"b4w_lod_transition"));"lod_levels"in u||(u.lod_levels=[],b("object",u,"lod_levels"));"b4w_animation_mixing"in u||(u.b4w_animation_mixing=!1,b("object",u,"b4w_animation_mixing"));
break;case "EMPTY":"b4w_anchor"in u||(u.b4w_anchor=null,b("object",u,"b4w_anchor")),!u.b4w_anchor||"max_width"in u.b4w_anchor||(u.b4w_anchor.max_width=250)}"collision_margin"in u.game||(u.game.collision_margin=.04,b("object",u,"collision_margin"));"b4w_anim_behavior"in u||(u.b4w_anim_behavior=u.b4w_cyclic_animation?"CYCLIC":"FINISH_STOP",b("object",u,"b4w_anim_behavior"));if(!("rotation_quaternion"in u)){m=[0,0,0,1];l.euler_to_quat(u.rotation_euler,m);var d=m,f=m[0],v=m[1],q=m[2];d[0]=m[3];d[1]=f;
d[2]=v;d[3]=q;u.rotation_quaternion=m;b("object",u,"rotation_quaternion")}"webgl_do_not_batch"in u&&(u.b4w_do_not_batch=u.webgl_do_not_batch)&&n("object",u,"webgl_do_not_batch");"b4w_shadow_cast_only"in u||(u.b4w_shadow_cast_only=!1,b("object",u,"b4w_shadow_cast_only"));"b4w_correct_bounding_offset"in u||(u.b4w_correct_bounding_offset="AUTO",b("object",u,"b4w_correct_bounding_offset"));d=u.particle_systems;for(m=0;m<d.length;m++)f=d[m],v=f.settings,"use_rotation_dupli"in v||(v.use_rotation_dupli=
!1,b("particle_settings",v,"use_rotation_dupli")),"use_whole_group"in v||(v.use_whole_group=!1,b("particle_settings",v,"use_whole_group")),f.transforms||(f.transforms=new Float32Array,b("particle_system",f,"transforms")),"b4w_billboard_align"in v||(v.b4w_billboard_align="VIEW",b("particle_settings",v,"b4w_billboard_align")),"b4w_dynamic_grass"in v||(v.b4w_dynamic_grass=!1,b("object",v,"b4w_dynamic_grass")),"b4w_dynamic_grass_scale_threshold"in v||(v.b4w_dynamic_grass_scale_threshold=.01,b("object",
v,"b4w_dynamic_grass_scale_threshold")),"b4w_initial_rand_rotation"in v||(v.b4w_initial_rand_rotation=!1,b("particle_settings",v,"b4w_initial_rand_rotation")),"b4w_rotation_type"in v||(v.b4w_rotation_type="Z",b("particle_settings",v,"b4w_rotation_type")),"b4w_rand_rotation_strength"in v||(v.b4w_rand_rotation_strength=1,b("particle_settings",v,"b4w_rand_rotation_strength")),"b4w_hair_billboard"in v||(v.b4w_hair_billboard=!1,b("particle_settings",v,"b4w_hair_billboard")),"b4w_hair_billboard_type"in
v||(v.b4w_hair_billboard_type="BASIC",b("particle_settings",v,"b4w_hair_billboard_type")),"b4w_hair_billboard_jitter_amp"in v||(v.b4w_hair_billboard_jitter_amp=0,b("particle_settings",v,"b4w_hair_billboard_jitter_amp")),"b4w_hair_billboard_jitter_freq"in v||(v.b4w_hair_billboard_jitter_freq=0,b("particle_settings",v,"b4w_hair_billboard_jitter_freq")),"b4w_hair_billboard_geometry"in v||(v.b4w_hair_billboard_geometry="SPHERICAL",b("particle_settings",v,"b4w_hair_billboard_geometry")),"b4w_wind_bend_inheritance"in
v||(v.b4w_wind_bend_inheritance="PARENT",b("particle_settings",v,"b4w_wind_bend_inheritance")),"b4w_shadow_inheritance"in v||(v.b4w_shadow_inheritance="PARENT",b("particle_settings",v,"b4w_shadow_inheritance")),"b4w_reflection_inheritance"in v||(v.b4w_reflection_inheritance="PARENT",b("particle_settings",v,"b4w_reflection_inheritance")),"b4w_vcol_from_name"in v||(v.b4w_vcol_from_name="",b("particle_settings",v,"b4w_vcol_from_name")),"b4w_vcol_to_name"in v||(v.b4w_vcol_to_name="",b("particle_settings",
v,"b4w_vcol_to_name")),"b4w_coordinate_system"in v||(v.b4w_coordinate_system="LOCAL",b("particle_settings",v,"b4w_coordinate_system")),"b4w_allow_nla"in v||(v.b4w_allow_nla=!0,b("particle_settings",v,"b4w_allow_nla")),"b4w_enable_soft_particles"in v||(v.b4w_enable_soft_particles=!1,b("particle_settings",v,"b4w_enable_soft_particles")),"b4w_particles_softness"in v||(v.b4w_particles_softness=1,b("particle_settings",v,"b4w_particles_softness")),"billboard_tilt"in v||(v.billboard_tilt=0,b("particle_settings",
v,"billboard_tilt")),"billboard_tilt_random"in v||(v.billboard_tilt_random=0,b("particle_settings",v,"billboard_tilt_random")),"use_rotations"in v||(v.use_rotations=!1,b("particle_settings",v,"use_rotations"));"constraints"in u||(u.constraints=[],b("object",u,"constraints"));d=u.modifiers;for(m=0;m<d.length;m++){a:{f=d[m];switch(f.type){case "ARRAY":if(!("fit_type"in f)){B.error("WARNING Incomplete modifier "+String(f.type)+' for "'+u.name+'", reexport "'+a.b4w_filepath_blend+'" scene');f=!1;break a}}f=
!0}f||(d.splice(m,1),m--)}"animation_data"in u||(u.animation_data={action:null,nla_tracks:[]},b("object",u,"animation_data"));u.animation_data&&("action"in u.animation_data||(u.animation_data.action=null,h("no action in animation data "+u.name)),"nla_tracks"in u.animation_data||(u.animation_data.nla_tracks=[],h("no NLA in animation data "+u.name)),c(u.animation_data));"b4w_collision_id"in u||(u.b4w_collision_id="",b("object",u,"b4w_collision_id"));"b4w_viewport_alignment"in u||(u.b4w_viewport_alignment=
null,b("object",u,"b4w_viewport_alignment"));"pinverse_tsr"in u||(u.pinverse_tsr=null,b("object",u,"pinverse_tsr"));"b4w_cluster_data"in u||(u.b4w_cluster_data={cluster_id:-1},b("object",u,"b4w_cluster_data"));(0>u.scale[0]||0>u.scale[1]||0>u.scale[2])&&h('negative scale for object "'+u.name+'", can lead to some errors');m=u.scale;0==m[0]&&0==m[1]&&0==m[2]?m=!0:(d=Math.abs((m[1]-m[2])/m[1]),m=.005>Math.abs((m[0]-m[1])/m[0])&&.005>d);m||h("non-uniform scale for object "+u.name)}for(var r in y)k=y[r],
m=r.match(/.*?(?=>>|$)/i)[0],B.warn('Property "'+String(m)+'" is '+k.yB+' for "'+k.type+'". To fix this, reexport '+a.b4w_filepath_blend)};a.sG=function(a,b){"num_channels"in a||(a.num_channels=1,h('B4W Warning: no channels number in animation fcurve for "'+b.name+'" action, reexport scene'))};a.HF=function(a){var b;a:{b=a.modifiers;for(var c=0;c<b.length;c++){var e=b[c].type;if("ARRAY"==e||"CURVE"==e){b=!0;break a}}b=!1}if(!b)return null;b=r(a.data,a.data.name+"_MOD");a=a.modifiers;for(c=0;c<a.length;c++){var h=
a[c];switch(h.type){case "ARRAY":for(var e=b,n=h,u=0,v=0,z=0,B=new Float32Array(16),h=[],w=1;w<n.count;w++){n.use_constant_offset&&(u+=n.constant_offset_displace[0],v+=n.constant_offset_displace[1],z+=n.constant_offset_displace[2]);if(n.use_relative_offset)var p=e.b4w_bounding_box,u=u+(p.max_x-p.min_x)*n.relative_offset_displace[0],v=v+(p.max_y-p.min_y)*n.relative_offset_displace[1],z=z+(p.max_z-p.min_z)*n.relative_offset_displace[2];l.GN(u,v,z,B);for(var D=p=r(e),y=B,E=0;E<D.submeshes.length;E++){var N=
D.submeshes[E];l.im(N.position,y,N.position,0);l.KO(N.normal,y,N.normal);l.CN(N.tangent,y,N.tangent)}h.push(p)}for(w=0;w<h.length;w++)for(n=e,u=h[w],v=0;v<n.submeshes.length;v++){z=n.submeshes[v];B=u.submeshes[v];p=z.base_length;D=z.indices.length;z.base_length+=B.base_length;for(var L in z)if("base_length"!=L&&"boundings"!=L)if("indices"==L)for(z[L]=l.LN(z[L],B[L]),y=D;y<z.indices.length;y++)z.indices[y]+=p;else"vertex_colors"!=L&&(z[L]=l.UI(z[L],B[L]))}break;case "CURVE":for(var e=b,w=m.zH(h.object),
n=new Float32Array(16),v=w.zi?4:3,u=new Float32Array(v),v=new Float32Array(v),z=new Float32Array(3),B=new Float32Array(4),p=new Float32Array(4),D=new Float32Array(3),y=new Float32Array(3),E=new Float32Array(3),N=new Float32Array(4),P=new Float32Array(4),da=0;da<e.submeshes.length;da++){var U=e.submeshes[da],ga=U.position,T=U.normal,U=U.tangent,la;a:{la=h.deform_axis;switch(la){case "POS_X":case "NEG_X":la=0;break a;case "POS_Y":case "NEG_Y":la=1;break a;case "POS_Z":case "NEG_Z":la=2;break a;default:l.q("Wrong deform axis value "+
la)}la=void 0}D[0]=0;D[1]=0;D[2]=0;D[la]=1;for(var O=m.pN(w),Q=0;Q<ga.length/3;Q++){E[0]=ga[3*Q];E[1]=ga[3*Q+1];E[2]=ga[3*Q+2];var Z=E[la],ma=m.oN(w,Z);m.qN(w,ma,u);z[0]=u[0];z[1]=u[1];z[2]=u[2];m.nN(w,ma,v);y[0]=v[0];y[1]=0;y[2]=v[2];f.normalize(y,y);d.rotationTo(D,y,B);0>Z?(u[0]=y[0],u[1]=y[1],u[2]=y[2],f.scale(u,Z,u),f.add(z,u,z)):Z>O&&(u[0]=y[0],u[1]=y[1],u[2]=y[2],f.scale(u,Z-O,u),f.add(z,u,z));q.fromRotationTranslation(B,z,n);w.zi&&(d.setAxisAngle(D,u[3],p),f.transformQuat(E,p,E));E[la]=0;f.transformMat4(E,
n,E);ga[3*Q]=E[0];ga[3*Q+1]=E[1];ga[3*Q+2]=E[2];T.length&&(N[0]=T[3*Q],N[1]=T[3*Q+1],N[2]=T[3*Q+2],N[3]=0,H.transformMat4(N,n,N),T[3*Q]=N[0],T[3*Q+1]=N[1],T[3*Q+2]=N[2]);U.length&&(P[0]=U[3*Q],P[1]=U[3*Q+1],P[2]=U[3*Q+2],P[3]=0,H.transformMat4(P,n,P),U[3*Q]=P[0],U[3*Q+1]=P[1],U[3*Q+2]=P[2])}}}g.KL(b)}return b};a.nH=function(){return{name:"DEFAULT",uuid:l.yu(),use_nodes:!1,diffuse_shader:"LAMBERT",diffuse_color:[.8,.8,.8],diffuse_intensity:1,alpha:1,raytrace_transparency:{fresnel:0,fresnel_factor:1.25},
raytrace_mirror:{reflect_factor:0,fresnel:0,fresnel_factor:1.25},specular_alpha:1,specular_color:[1,1,1],specular_intensity:.5,specular_shader:"COOKTORR",specular_hardness:50,specular_slope:.2,emit:0,ambient:1,use_vertex_color_paint:!1,b4w_water:!1,b4w_water_shore_smoothing:!1,b4w_water_dynamic:!1,b4w_generated_mesh:!1,b4w_refr_bump:0,b4w_refractive:!1,b4w_waves_height:1,b4w_water_fog_color:[.5,.5,.5],b4w_water_fog_density:.06,b4w_water_num_cascads:5,b4w_water_subdivs:64,b4w_water_detailed_dist:1E3,
b4w_terrain:!1,b4w_collision:!1,b4w_collision_id:"",b4w_double_sided_lighting:!1,b4w_water_enable_caust:!1,b4w_water_caust_scale:.25,b4w_water_caust_brightness:.5,physics:{friction:.5,elasticity:0},type:"SURFACE",use_transparency:!1,use_shadeless:!1,offset_z:0,b4w_render_above_all:!1,game_settings:{alpha_blend:"OPAQUE",use_backface_culling:!0},halo:{size:.5,hardness:50,b4w_halo_rings_color:[1,1,1],b4w_halo_lines_color:[1,1,1],b4w_halo_stars_blend_height:10,b4w_halo_stars_min_height:0},node_tree:null,
texture_slots:[]}};a.NF=function(a,b){function c(b,d){for(var e in b){var f=b[e],k=f[0];if(1<f.length)for(var g=1;g<f.length;g++)k+="*"+f[g];for(g=0;g<a.length;g++)if(f=a[g],f.name==k)for(var h in d)f[h]=d[h]}}for(var d=b.b4w_logic_nodes,e=0;e<d.length;e++)for(var f=d[e],g=0;g<f.length;g++){var l=f[g],n={register1:"variable1",register2:"variable2",registerd:"variabled"},m;for(m in n)m in l&&(l[n[m]]=l[m]);for(var q in l.variables)"boolean"!=typeof l.variables[q][0]&&(l.variables[q]=[!1,l.variables[q]]);
0<=["MATH","CONDJUMP","PAGEPARAM","REGSTORE"].indexOf(l.type)&&("variable1"in l&&(l.variables.v1=[!1,l.variable1]),"variable2"in l&&(l.variables.v2=[!1,l.variable2]),"variabled"in l&&(l.variables.vd=[!1,l.variabled]));switch(l.type){case "SELECT":for(var B=0;B<a.length;B++)n=a[B],n.name==l.object&&(n.b4w_selectable=!0);l.bools||(l.bools={});l.bools.not_wait||(l.bools.not_wait=!1);h('Logic nodes type "SELECT" is deprecated');break;case "SWITCH_SELECT":c(l.objects_paths,{b4w_selectable:!0});if(l.links instanceof
Array){h('Format of a "SWITCH_SELECT" node is outdated. It is recommended to reexport the scene "'+b.name+'"');var n={},r=0;for(B in l.objects_paths)n[B]=l.links[r],r++;l.links=n}break;case "SELECT_PLAY":h('Logic nodes type "SELECT_PLAY" is deprecated, node will be muted. To fix this, reexport the scene "'+b.name+'"');l.mute=!0;break;case "SELECT_PLAY_ANIM":h('Logic nodes type "SELECT_PLAY_ANIM" is deprecated');break;case "SHOW":case "HIDE":case "SET_SHADER_NODE_PARAM":case "INHERIT_MAT":c(l.objects_paths,
{b4w_do_not_batch:!0});break;case "PLAY":b.b4w_use_nla=!0;break;case "MOVE_TO":c(l.objects_paths,{b4w_do_not_batch:!0});break;case "TRANSFORM_OBJECT":c(l.objects_paths,{b4w_do_not_batch:!0});break;case "OUTLINE":c(l.objects_paths,{b4w_outlining:!0});break;case "CONDJUMP":l.condition&&(l.common_usage_names.condition=l.condition);if("cnd"in l.floats)l.common_usage_names.condition=l.floats.cnd;else switch(l.common_usage_names.condition){case "GEQUAL":l.common_usage_names.condition=D.wx;break;case "LEQUAL":l.common_usage_names.condition=
D.yx;break;case "GREATER":l.common_usage_names.condition=D.xx;break;case "LESS":l.common_usage_names.condition=D.zx;break;case "NOTEQUAL":l.common_usage_names.condition=D.Ax;break;case "EQUAL":l.common_usage_names.condition=D.vx}void 0!=l.number1&&(l.input1=l.number1);void 0!=l.number2&&(l.input2=l.number2);l.bools||(l.bools={});void 0===l.bools.str&&(l.bools.str=!1,l.floats.inp1=l.input1,l.floats.inp2=l.input2);break;case "SEND_REQ":l.bools||(l.bools={});l.strings||(l.strings={});void 0===l.bools.ct&&
(l.bools.ct=!1);void 0!=l.url&&(l.bools.url=!1,l.strings.url=l.url);break;case "MATH":void 0!=l.number1&&(l.input1=l.number1);void 0!=l.number2&&(l.input2=l.number2);void 0!=l.input1&&(l.floats.inp1=l.input1);void 0!=l.input2&&(l.floats.inp2=l.input2);break;case "REGSTORE":l.floats||(l.floats={});l.strings||(l.strings={});void 0!=l.number1&&(l.input1=l.number1);if(void 0!=l.input1)switch(typeof l.input1){case "number":l.floats.inp1=l.input1;l.common_usage_names.variable_type="NUMBER";break;default:l.strings.inp1=
l.input1,l.common_usage_names.variable_type="STRING"}switch(l.common_usage_names.variable_type){case "NUMBER":l.common_usage_names.variable_type=D.SD;break;case "STRING":l.common_usage_names.variable_type=D.TD}break;case "PAGEPARAM":l.bools||(l.bools={});void 0===l.bools.hsh&&(l.bools.hsh=!1);l.floats||(l.floats={});void 0===l.floats.ptp&&(l.floats.ptp=0);break;case "PLAY_ANIM":c(l.objects_paths,{b4w_do_not_batch:!0});l.bools||(l.bools={});void 0===l.bools.env&&(l.bools.env=!1);(n=l.common_usage_names.param_anim_behavior)||
(n="FINISH_STOP");l.common_usage_names.param_anim_behavior=w.qt(n);break;case "STOP_ANIM":l.bools||(l.bools={});void 0===l.bools.env&&(l.bools.env=!1);break;case "STRING":if("cnd"in l.floats)l.common_usage_names.condition=l.floats.cnd;else switch(l.common_usage_names.condition){case "GEQUAL":l.common_usage_names.condition=D.wx;break;case "LEQUAL":l.common_usage_names.condition=D.yx;break;case "GREATER":l.common_usage_names.condition=D.xx;break;case "LESS":l.common_usage_names.condition=D.zx;break;
case "NOTEQUAL":l.common_usage_names.condition=D.Ax;break;case "EQUAL":l.common_usage_names.condition=D.vx}break;case "REDIRECT":void 0!=l.url&&(l.bools.url=!1,l.strings.url=l.url);break;case "ENTRYPOINT":l.bools||(l.bools={});void 0===l.bools.js&&(l.bools.js=!1);l.bools.js&&(l.mute=!0);break;case "JS_CALLBACK":for(m in l=l.common_usage_names.js_cb_params,l)switch(l[m]){case "OBJECT":l[m]=D.ND;break;case "VARIABLE":l[m]=D.OD}}}}};b4w.module.__scenegraph=function(a,p){function e(a,b){var c=[];C.gg(a,function(b,d,e){-1<c.indexOf(e)?C.WL(a,b,d,e,A(e)):c.push(e)});C.ma(a,function(a,d){for(var e=0;e<d.Ha.length;e++){var f=d.Ha[e];b||d.type!=F.jd&&d.type!=F.Kc&&d.type!=F.Ae||(f.ve=!0);-1<c.indexOf(f)?d.Ha[e]=A(f):c.push(f)}})}function c(a,c){C.ma(a,function(b,d){d.type==F.lx&&C.Ug(a,b,function(a,b){if(b.type==F.Yh)for(var c=0;c<b.Ha.length;c++){var d=b.Ha[c];d.pa=K.G;d.oa=K.G}});c||C.Ug(a,b,function(a,b,c){"DEPTH"==c.from&&(c.ve=
!0)})});C.ma(a,function(c){var d={};b(a,c,d);for(var e in d){c=d[e];for(var f=c[0],k=0;k<c.length;k++)if(c[k].pa==K.G){f=c[k];break}for(var g=c[0],k=0;k<c.length;k++)if(c[k].oa==K.G){g=c[k];break}for(var h=c[0],k=0;k<c.length;k++)if(!c[k].ve){h=c[k];break}for(k=0;k<c.length;k++)c[k].pa=f.pa,c[k].oa=g.oa,c[k].ve=h.ve}})}function b(a,c,d){C.Ug(a,c,function(c,e,f){f.ic&&f.from==f.to&&(d[f.from]=d[f.from]||[],-1==d[f.from].indexOf(f)&&d[f.from].push(f),b(a,c,d))});C.hj(a,c,function(a,b,c){c.ic&&(d[c.from]=
d[c.from]||[],-1==d[c.from].indexOf(c)&&d[c.from].push(c))});c=C.Na(a,c);if(c.type==F.Yh)for(var e=0;e<c.Ha.length;e++){var f=c.Ha[e];d[f.from].push(f)}}function n(a){var b=[F.Yh,F.ht,F.Ip,F.jd,F.Kc],c=C.Nw(a),d=[];C.ma(c,function(a,f){for(var e=0;e<f.Ha.length;e++){var k=f.Ha[e];-1<b.indexOf(f.type)&&(k.Bs=!0);var l=q(d,k,h(k));k.Ja=l;f.Sg[e]=l}for(e=0;e<f.Sg.length;e++)l=f.Sg[e],m(d,l);C.hj(c,a,function(e,k,l){-1<b.indexOf(f.type)&&(l.Bs=!0);l.Ja||((e=r(c,a,l.from))&&l.ic&&!l.Ja?g(d,e):e=q(d,l,
h(l)),l.Ja=e)});C.Ug(c,a,function(a,b,c){m(d,c.Ja)});C.hj(c,a,function(a,b,c){c.Ja&&"NONE"==c.to&&m(d,c.Ja)})})}function h(a){a=X.ki(a);delete a.to;delete a.ic;delete a.Ja;return JSON.stringify(a)}function r(a,b,c){var d=null;C.Ug(a,b,function(a,b,e){if(e.ic&&e.from==e.to&&e.from==c&&e.Ja)return d=e.Ja,!0});C.hj(a,b,function(a,b,e){if(e.ic&&e.from==c&&e.Ja)return d=e.Ja,!0});return d}function g(a,b){for(var c=0;c<a.length;c++){var d=a[c];d.Jw===b&&d.So++}}function m(a,b){for(var c=0;c<a.length;c++){var d=
a[c];d.Jw===b&&d.So&&d.So--}}function q(a,b,c){if(b.Ho)return g(a,b.Ho.Ja),b.Ho.Ja;if(b.Bs)return B(b);for(var d=null,e=0;e<a.length;e++){var f=a[e];if(f.id==c&&0===f.So){d=f;break}}if(d&&!L.oz)return d.So++,d.Jw;b=B(b);a.push({id:c,So:1,Jw:b});return b}function B(a){var b=a.Mk*a.size,c=a.Nk*a.size;switch(a.from){case "COLOR":if(a.ve){var d=K.Jn("COLOR_RB",a.Hi?K.Op:K.Np);K.resize(d,b,c)}else d=K.Jn("COLOR",K.uj),K.resize(d,b,c),K.jw(d,a.pa,a.oa);return d;case "DEPTH":return a.ve?(d=K.Jn("DEPTH_RB",
a.Hi?K.Mp:K.Lp),K.resize(d,b,c)):(d=K.Jn("DEPTH_TEX",K.il),K.resize(d,b,c),K.jw(d,a.pa,a.oa)),d;case "CUBEMAP":return d=K.eH(b);case "SCREEN":case "NONE":return null;default:X.q("Wrong slink param: "+a.from)}}function d(a,b){var c=!1;C.gg(a,function(d,e,f){if(f&&(d=C.Na(a,d),e=C.Na(a,e),b(f,!1,d,e)))return c=!0});c||C.ma(a,function(a,c){for(var d=0;d<c.Ha.length;d++)if(b(c.Ha[d],!0,c,null))return!0})}function l(a){C.ma(a,function(b,c){if(c.type!=F.hl){var d=c.o;C.hj(a,b,function(a,b,c){c.ic&&c.Ja&&
(v.gs(d,c.from,c.Ja),c.from==c.to&&b.o&&v.gs(b.o,c.from,c.Ja))});for(var e=0;e<c.Ha.length;e++){var f=c.Ha[e];f.ic&&f.from==f.to&&v.gs(d,f.from,c.Sg[e])}!d.Zb&&!d.ge||d.je||(d.je=W.SL(d.Zb,d.ge))}});C.ma(a,function(b,c){if(c.type==F.fl||c.type==F.Ws){var d=k(a,c);c.o.co=d[0].o.je}})}function f(a){var b=null,c=0;C.ma(a,function(a,d){if(d.type==N.AN){if(c==N.zN)return b=d,!0;c++}});return b}function H(a,b){var c=C.Uf(a,b),d=F.Xc("NONE"),e=C.F(a,d),f=C.ko(a)[0];C.gg(a,function(b,c){c==f&&C.LL(a,b,f,
b,e)});var k=D(b,a);C.gg(a,function(e,f,g){if(e==c){if(k){e=F.pq();C.F(a,e);f=y("COLOR","RESOLVE",1,1,1,!0);f.Hi=!0;f.ve=!0;var h=y("DEPTH","RESOLVE",1,1,1,!0);h.Hi=!0;h.ve=!0;C.r(a,b,e,f);C.r(a,b,e,h);b=e}C.r(a,b,d,y(N.aN,"u_color",g.size,g.Mk,g.Nk,g.np));return!0}});C.qd(a,e,f,y("SCREEN","NONE",.5,.5,.5,!0))}function D(a,b){var c=!1,d=C.Uf(b,a);C.Kg(b,d)&&(c=C.Bg(b,d,0),d=C.Ne(b,d,c,0),"COLOR"==d.from&&"COLOR"==d.to||"DEPTH"==d.from&&"DEPTH"==d.to?(d=C.Na(b,c),c=D(d,b)):c="RESOLVE"==d.to);return c}
function w(a,b,c,d){for(var e=c.R,f=b.no,k=b.Mg.Lg,g=b.Mg.Tr,h=C.ss(a,C.MJ(a,d),C.zp),l=[],n=[],m=[],h=C.clone(h,function(b){var d;if(-1<da.indexOf(b.type))n.push(b),d=b;else{d=F.TG(b);if(d.type==F.jd)for(var h=0;h<k.length;h++)if(k[h][0]==b){k[h]=[b,d];d.o.Fb=b.o.Fb;c.R.push(d.o);break}if(b.type==F.df)for(h=0;h<k.length;h++){if(g[h][0]==b){g[h]=[b,d];d.o=k[h][1].o;break}}else-1<e.indexOf(b.o)&&(f?(v.wr(b.o,v.Zd),v.wr(d.o,v.$d)):(v.wr(b.o,v.qc),v.wr(d.o,v.Bc)),e.push(d.o));var u=C.Uf(a,b);C.Ug(a,
u,function(a,b,c){-1<da.indexOf(b.type)&&l.push([b,d,c])});for(h=0;h<b.Ha.length;h++)d.Ha[h].Ho=b.Ha[h];b=!0;for(h=0;h<C.br(a,u);h++){var t=C.hk(a,u,h),t=C.Na(a,t);-1==da.indexOf(t.type)&&(b=!1)}b&&m.push(d)}return d},function(a){var b=A(a,!0);b.Ho=a;return b}),u=0;u<n.length;u++)C.ag(h,C.Uf(h,n[u]));C.Kt(h);b=F.YH(f);var u=C.F(a,b),t=F.$t();C.F(a,t);var q=y("COLOR","COPY",1,1,1,!0);C.r(a,d,t,q);var B=y("COLOR","u_sampler_left",1,1,1,!0);B.Bs=!0;B.pa=K.G;B.oa=K.G;C.r(a,t,b,B);d.Tb||(d=F.$t(),C.F(h,
d),B=y("COLOR","COPY",1,1,1,!0),B.Ho=q,q=C.ko(h)[0],q=C.Na(h,q),C.r(h,q,d,B));d=y("COLOR","u_sampler_right",1,1,1,!0);d.pa=K.G;d.oa=K.G;C.AF(h,a,[C.ko(h)[0],u,d]);for(u=0;u<l.length;u++)C.r(a,l[u][0],l[u][1],l[u][2]);h=y("SCREEN","NONE",0,0,0,!1);for(u=0;u<m.length;u++)C.r(a,t,m[u],h);f&&E(a,.5,1);return b}function E(a,b,c){var d=[];C.ma(a,function(b,c){if(-1==da.indexOf(c.type)&&c.Ha.length&&G(a,c,F.Kp))for(var e=0;e<c.Ha.length;e++){var f=c.Ha[e];-1==d.indexOf(f)&&d.push(f)}});C.gg(a,function(b,
c,e){b=C.Na(a,b);c=C.Na(a,c);-1==da.indexOf(b.type)&&G(a,c,F.Kp)&&-1==d.indexOf(e)&&d.push(e)});for(var e=0;e<d.length;e++)d[e].Mk*=b,d[e].Nk*=c}function y(a,b,c,d,e,f){return{from:a,to:b,size:c,Mk:d,Nk:e,np:f,ic:!0,Ja:null,Hi:!1,ve:!1,pa:K.Hd,oa:K.Hd,Bs:!1}}function A(a,b){if(b){var c=a.Ja;a.Ja=null}a.Ja&&X.q("Failed to clone slink with attached texture");var d=X.ki(a);b&&(a.Ja=c,d.Ja=c);return d}function G(a,b,c){if(b.type==c)return!0;b=t(a,b);for(var d=0;d<b.length;d++)if(G(a,b[d],c))return!0;
return!1}function x(a,b,c){if(b.type==c)return!0;b=k(a,b);for(var d=0;d<b.length;d++)if(x(a,b[d],c))return!0;return!1}function k(a,b){var c=C.Uf(a,b);c==C.ft&&X.q("Subscene not in graph");for(var d=[],e=C.br(a,c),f=0;f<e;f++){var k=C.hk(a,c,f);k!=c&&d.push(C.Na(a,k))}return d}function t(a,b){var c=C.Uf(a,b);c==C.ft&&X.q("Subscene not in graph");for(var d=[],e=C.Kg(a,c),f=0;f<e;f++){var k=C.Bg(a,c,f);k!=c&&d.push(C.Na(a,k))}return d}function M(a){var b=[],c=[];d(a,function(a){a.Ja&&-1==b.indexOf(a.Ja)&&
(b.push(a.Ja),c.push(a.Ja,b.length-1))});return c}function u(a,b){var c;c=""+(a.from+"\\n");c+="NONE"!=a.to?a.to+"\\n":"";c+="(";if(a.np){var d=a.Mk,e=a.Nk;Math.round(d)!=d&&(d=d.toFixed(2));Math.round(e)!=e&&(e=e.toFixed(2));c+=(1==d?"":d)+"Sx"+((1==e?"":e)+"S")}else d=a.Mk,e=a.Nk,c+=a.size*d+"x"+a.size*e;if("SCREEN"!=a.from){c+=" ";if(a.ve)c+="RR";else{var d=a.pa,e=a.oa,f="";d==K.G?f+="L":d==K.Hd&&(f+="N");e==K.G?f+="L":e==K.Hd&&(f+="N");c+=f}for(d=0;d<b.length;d+=2)b[d]==a.Ja&&(c+=" "+b[d+1])}return c+
")\\n"}var v=p("__camera"),z=p("__config"),S=p("__debug"),C=p("__graph"),W=p("__renderer"),F=p("__subscene"),K=p("__textures"),X=p("__util"),N=z.uq,L=z.v,P=z.Kk,da=[F.$g,F.Ac,F.Kc,F.Yd];a.HG=function(a){switch(a.to){case "COLOR":case "CUBEMAP":case "DEPTH":case "SCREEN":case "OFFSCREEN":case "RESOLVE":case "COPY":case "NONE":return!1;default:return!0}};a.KN=d;a.tH=function(a,b,d,g){function h(c){var d=v.jc(Qa,!0);b.R.push(d);d=F.Qj(c,d,!1,G,I,Ca,na,ya,a.Oh);C.F(m,d);c==F.Ae?(C.r(m,u[0],d,y("COLOR",
"COLOR",1,1,1,!0)),d.Ha.push(y("DEPTH","DEPTH",1,1,1,!0))):(c=wa&&u[0].type==F.fl?Hb:u[0],C.r(m,c,d,xa),C.r(m,c,d,ua));Ta&&(C.r(m,Ta,d,Ya),C.r(m,Ta,d,jb));for(c=0;c<B.length;c++)C.r(m,B[c],d,z[c]);Nc&&C.r(m,Nc,d,Rb);if(r.length){var e=r.length;for(c=0;c<e;c++)C.r(m,r[c],d,x[c])}if(p.length)for(c=0;c<p.length;c++)C.r(m,p[c],d,D[c]);fc&&C.r(m,fc,d,Oc);return d}var m=C.create(),u=[],q=[],B=[],z=[],r=[],x=[],p=[],D=[],I=a.wK,G=a.oc,M=a.shore_smoothing,E=a.cN,J=a.ssao,aa=a.god_rays,V=a.Mg,ca=a.GA,pa=a.aG,
W=a.motion_blur,da=a.ql,ia=a.antialiasing,na=a.kx,Ca=a.hD,ya=a.od,va=a.dL,Ma=a.rG,Fa=a.VJ,Ja=a.sL,Ka=a.dof,Oa=a.nI,Ba=a.refractions,Y=Boolean(g.length),wa=1<L.xc,ua=y("COLOR","COLOR",1,1,1,!0),xa=y("DEPTH","DEPTH",1,1,1,!0);if(wa){A(xa);var gc=A(xa);ua.Hi=!0;ua.ve=!0;xa.Hi=!0;xa.ve=!0}var Qa=b.R[0];if(ya){v.Xw(Qa,ya);for(var ba=0;ba<ya.Rf.length;ba++)for(var $b=ya.csm_num,sa=0;sa<$b;sa++){var R=F.TH(sa,ba,ya,I);C.F(m,R);B.push(R);var Ra=ya.csm_resolution,za=R.o;b.RB.push(za);za.width=Ra;za.height=
Ra;R.Xa=!1;z.push(y("DEPTH","u_shadow_map"+(0<ba?ba:sa),Ra,1,1,!1));(S.yG()||L.TB)&&R.Ha.push(y("COLOR","COLOR",Ra,1,1,!1))}}if(V&&V.YA&&!Y)for(sa=0;sa<V.YA;sa++){za=v.Ec(v.kd);za.width=a.kh;za.height=a.kh;v.hs(za,90,.1,100);v.bj(za,za.$a);var Da=F.Qj(F.Kc,za,!1,G,I,Ca,na,null,a.Oh);Da.Rj=X.kJ();for(ba=0;6>ba;ba++)Da.Ln.push(v.hH());C.F(m,Da);var La=y("CUBEMAP","u_cube_reflection",a.kh,1,1,!1);La.pa=K.G;La.oa=K.G;D.push(La);if(V.bA){var bb=F.Qj(F.Yd,za,!1,G,I,Ca,na,null,a.Oh);bb.Rj=Da.Rj;bb.Ln=Da.Ln;
C.F(m,bb);var Bb=y("DEPTH","DEPTH",a.kh,1,1,!1),ta=y("COLOR","COLOR",a.kh,1,1,!1);C.r(m,Da,bb,Bb);C.r(m,Da,bb,ta);p.push(bb);V.du.push(bb)}else{var Ua=y("DEPTH","DEPTH",a.kh,1,1,!1);Da.Ha.push(Ua);p.push(Da)}V.jh.push(Da)}if(V&&0<V.xB.length&&!Y)for(ba=0;ba<V.xB.length;ba++)za=v.jc(Qa,!0),za.Fb=new Float32Array(4),b.R.push(za),Da=F.Qj(F.jd,za,!1,G,I,Ca,na,null,a.Oh),C.F(m,Da),La=y("COLOR","u_plane_reflection",a.Gk,1,1,!0),La.pa=K.G,La.oa=K.G,x.push(La),V.bA?(bb=F.Qj(F.df,za,!1,G,I,Ca,na,null,a.Oh),
C.F(m,bb),Bb=y("DEPTH","DEPTH",a.Gk,1,1,!0),ta=y("COLOR","COLOR",a.Gk,1,1,!0),ta.pa=K.Hd,ta.oa=K.Hd,C.r(m,Da,bb,Bb),C.r(m,Da,bb,ta),V.Tr.push([bb]),r.push(bb)):(Ua=y("DEPTH","DEPTH",a.Gk,1,1,!0),Da.Ha.push(Ua),r.push(Da)),V.Lg.push([Da]);if(a.kc){var Ta=F.MH();C.F(m,Ta);Ra=P.Oq;Ta.o.width=Ra;Ta.o.height=Ra;var Ya=y("DEPTH","u_grass_map_depth",Ra,1,1,!1);Ya.pa=K.G;Ya.oa=K.G;var jb=y("COLOR","u_grass_map_color",Ra,1,1,!1);jb.pa=K.G;jb.oa=K.G}else jb=Ya=Ta=null;if(Oa&&ya){var kb=v.jc(Qa,!0);b.R.push(kb);
var Na=F.UH(kb,I);C.F(m,Na);Na.self_shadow_normal_offset=ya.self_shadow_normal_offset;for(sa=0;sa<B.length;sa++)R=B[sa],C.r(m,R,Na,z[sa]);var Xc=y("COLOR","u_color",1,1,1,!0),Yc=y("DEPTH","u_depth",1,1,1,!0);if(J){var Ac=v.jc(Qa,!0);b.R.push(Ac);var Ib=a.sN,Za=F.WH(Ac,Ca,Ib);C.F(m,Za);var ac=y("COLOR","u_ssao_mask",1,1,1,!0);C.r(m,Na,Za,Xc);C.r(m,Na,Za,Yc);var dd=v.jc(Qa,!0);b.R.push(dd);var Bc=F.XH(dd,Ib);C.F(m,Bc);var Pc=y("COLOR","u_shadow_mask",1,1,1,!0);C.r(m,Za,Bc,ac);C.r(m,Na,Bc,Yc)}wa?Na.Ha.push(y("DEPTH",
"DEPTH",1,1,1,!0)):Na.Ha.push(xa);Ta&&(C.r(m,Ta,Na,Ya),C.r(m,Ta,Na,jb))}else Na=null;var Hb=F.Qj(F.pb,Qa,!0,G,I,Ca,na,null,a.Oh);C.F(m,Hb);if(wa){var wb=F.pq();C.F(m,wb);q.push(wb);var uc=y("COLOR","RESOLVE",1,1,1,!0);uc.Hi=!0;uc.ve=!0;var vc=y("DEPTH","RESOLVE",1,1,1,!0);vc.Hi=!0;vc.ve=!0;C.r(m,Hb,wb,uc);C.r(m,Hb,wb,vc)}else q.push(Hb);Na&&(ac?C.r(m,Bc,Hb,Pc):ya?C.r(m,Na,Hb,y("COLOR","u_shadow_mask",1,1,1,!0)):X.q("Internal error"));Ta&&(C.r(m,Ta,Hb,Ya),C.r(m,Ta,Hb,jb));if(r.length)for(var mc=r.length,
ba=0;ba<mc;ba++)C.r(m,r[ba],Hb,x[ba]);if(p.length)for(ba=0;ba<p.length;ba++)C.r(m,p[ba],Hb,D[ba]);u=q;q=[];if(!Y&&a.UG){za=v.jc(Qa,!0);za.width=1;za.height=1;b.R.push(za);var Pb=F.Ry(za,!1,I);C.F(m,Pb);if(a.jg){za=v.jc(Qa,!0);za.width=1;za.height=1;b.R.push(za);var nc=F.Ry(za,!0,I);C.F(m,nc);C.r(m,Pb,nc,y("COLOR","COLOR",1,1,1,!1));C.r(m,Pb,nc,y("DEPTH","DEPTH",1,1,1,!1))}}else Pb=null;if(!ca.refractions&&!Ba||Y)fc=null;else{if(wa)fc=wb;else{var fc=F.$t();C.F(m,fc);C.r(m,u[0],fc,y("COLOR","COPY",
1,1,1,!0))}var Oc=y("COLOR","u_refractmap",1,1,1,!0)}if(Oa&&(Ba||M||E)){var Cc=v.jc(Qa,!0);b.R.push(Cc);var Nc=F.JH(Cc);C.F(m,Nc);C.r(m,wa?wb:Hb,Nc,y("DEPTH","u_depth",1,1,1,!0));var Rb=y("COLOR","u_scene_depth",1,1,1,!0);Rb.pa=K.Hd;Rb.oa=K.Hd}else Nc=null;if(a.Mq){var Qc=h(F.hc);q.push(Qc);u=q;q=[]}if(a.sh){var hd=v.jc(Qa,!0);b.R.push(hd);var Cb=F.Qj(F.pd,hd,!1,G,I,Ca,na);C.F(m,Cb);Nc&&C.r(m,Nc,Cb,Rb);fc&&C.r(m,fc,Cb,Oc);Ta&&(C.r(m,Ta,Cb,Ya),C.r(m,Ta,Cb,jb));if(r.length)for(mc=r.length,ba=0;ba<mc;ba++)C.r(m,
r[ba],Cb,x[ba]);if(p.length)for(ba=0;ba<p.length;ba++)C.r(m,p[ba],Cb,D[ba]);C.r(m,wa?wb:Hb,Cb,wa?gc:xa);var rb=F.Xc("X_GLOW_BLUR");rb.rb="GLOW_MASK_SMALL";rb.Df=a.ui.small_glow_mask_width;var jd=y("COLOR","u_color",1,1,1,!0);jd.pa=K.G;jd.oa=K.G;C.F(m,rb);C.r(m,Cb,rb,jd);var oc=F.Xc("Y_GLOW_BLUR");oc.rb="GLOW_MASK_SMALL";oc.Df=a.ui.small_glow_mask_width;var ed=y("COLOR","u_color",1,.5,.5,!0);ed.pa=K.G;ed.oa=K.G;C.F(m,oc);C.r(m,rb,oc,ed);var fd=F.Xc("X_GLOW_BLUR");fd.rb="GLOW_MASK_LARGE";fd.Df=a.ui.large_glow_mask_width;
var Dc=y("COLOR","u_color",1,.5,.5,!0);Dc.pa=K.G;Dc.oa=K.G;C.F(m,fd);C.r(m,oc,fd,Dc);var hc=F.Xc("Y_GLOW_BLUR");hc.rb="GLOW_MASK_LARGE";hc.Df=a.ui.large_glow_mask_width;var Zc=y("COLOR","u_color",1,.25,.25,!0);Zc.pa=K.G;Zc.oa=K.G;C.F(m,hc);C.r(m,fd,hc,Zc);var $c=v.jc(Qa,!0);b.R.push($c);var Sb=F.KH($c,a);C.F(m,Sb);var Ec=y("COLOR","u_src_color",1,1,1,!0);if(a.Mq)if(wa){var xb=F.pq();C.F(m,xb);C.r(m,Qc,xb,uc);C.r(m,Qc,xb,vc);C.r(m,xb,Sb,Ec)}else C.r(m,Qc,Sb,Ec);else C.r(m,wa?wb:Hb,Sb,Ec);C.r(m,a.Mq?
Qc:Hb,Sb,xa);var pb=y("COLOR","u_glow_mask_small",1,.5,.5,!0);pb.pa=K.G;pb.oa=K.G;C.r(m,oc,Sb,pb);var bc=y("COLOR","u_glow_mask_large",1,.25,.25,!0);bc.pa=K.G;bc.oa=K.G;C.r(m,hc,Sb,bc);u=[Sb];q=[]}a.Mq||(Qc=h(F.hc),q.push(Qc),u=q,q=[]);if(L.debug_view){za=v.jc(Qa,!0);b.R.push(za);var Sa=F.IH(za);q.push(Sa);C.F(m,Sa);C.r(m,u[0],Sa,ua);C.r(m,u[0],Sa,xa);Ta&&(C.r(m,Ta,Sa,Ya),C.r(m,Ta,Sa,jb));S.nM(Sa);u=q;q=[]}if(wa){var Zb=F.pq();C.F(m,Zb);q.push(Zb);C.r(m,u[0],Zb,uc);C.r(m,u[0],Zb,vc);u=q;q=[]}var Tc=
u.slice(0);if(!Y&&a.hF){za=v.jc(Qa,!0);b.R.push(za);var Db=F.EH(za);C.F(m,Db);C.r(m,u[0],Db,wa?gc:xa)}if(aa&&Oa&&!Y){var Qb=Fa.Vl,Jb=Fa.Uu,ic=Fa.ym,eb=u[0],jc=G?!0:!1,Fc=y("DEPTH","u_input",1,1,1,!0);Fc.pa=K.G;Fc.oa=K.G;var Kb=y("COLOR","u_input",1,.25,.25,!0);Kb.pa=K.G;Kb.oa=K.G;var Tb=Qb/ic,pc=v.jc(Qa,!0);b.R.push(pc);var Uc=F.au(pc,jc,Qb,!0,Tb,I,ic);C.F(m,Uc);C.r(m,eb,Uc,Fc);var Tb=Qb/ic*.5,Eb=v.jc(Qa,!0);b.R.push(Eb);var Ub=F.au(Eb,jc,Qb,!1,Tb,I,ic);C.F(m,Ub);C.r(m,Uc,Ub,Kb);var Tb=Qb/ic*.25,
fb=v.jc(Qa,!0);b.R.push(fb);var Pa=F.au(fb,jc,Qb,!1,Tb,I,ic);C.F(m,Pa);C.r(m,Ub,Pa,Kb);var yb=F.LH(Jb,I);q.push(yb);C.F(m,yb);C.r(m,eb,yb,y("COLOR","u_main",1,1,1,!0));C.r(m,Pa,yb,y("COLOR","u_god_rays",1,1,1,!0));u=q;q=[]}if(pa&&!Y){var eb=u[0],Lb=F.NH();C.F(m,Lb);C.r(m,eb,Lb,y("COLOR","u_input",1,1,1,!0));var Vb=F.FH();C.F(m,Vb);Vb.o.width=L.Vn?2:1;Vb.o.height=L.Vn?2:1;var Fb=y("COLOR","u_input",1,.25,.25,!0);Fb.pa=K.G;Fb.oa=K.G;var Wb=y("COLOR","u_luminance",1,.25,.25,!0);Wb.pa=K.G;Wb.oa=K.G;C.r(m,
Lb,Vb,Fb);var Mb=pa.key,Gc=pa.wI,Xb=v.jc(Qa,!0);b.R.push(Xb);var wc=F.OH(Mb,Gc,I,Xb);C.F(m,wc);C.r(m,eb,wc,y("COLOR","u_main",1,1,1,!0));C.r(m,Lb,wc,Wb);C.r(m,Vb,wc,y("COLOR","u_average_lum",1,1,1,!1));var zb=y("COLOR","u_color",1,.25,.25,!0);zb.pa=K.G;zb.oa=K.G;rb=F.Qy("X_BLUR");C.F(m,rb);C.r(m,wc,rb,zb);oc=F.Qy("Y_BLUR");C.F(m,oc);C.r(m,rb,oc,zb);var Hc=F.GH(pa.blur);C.F(m,Hc);var lb=y("COLOR","u_bloom",1,.25,.25,!0);lb.pa=K.G;lb.oa=K.G;C.r(m,oc,Hc,lb);C.r(m,eb,Hc,y("COLOR","u_main",1,1,1,!0));
q.push(Hc);u=q;q=[]}if(Ka&&Oa&&!Y){var eb=u[0],Va=v.jc(Qa,!0);b.R.push(Va);if(d.Oc){var cb=y("COLOR","u_color",1,1,1,!0);cb.pa=K.G;cb.oa=K.G;var qc=y("DEPTH","u_depth",1,1,1,!0);qc.pa=K.G;qc.oa=K.G;var xc=y("COLOR","u_color",1,.5,.5,!0);xc.pa=K.Hd;xc.oa=K.Hd;zb=y("COLOR","u_color",1,.5,.5,!0);zb.pa=K.Hd;zb.oa=K.Hd;var mb=y("COLOR","u_blurred1",1,.5,.5,!0);mb.pa=K.G;mb.oa=K.G;var sb=y("COLOR","u_blurred2",1,.5,.5,!0);sb.pa=K.G;sb.oa=K.G;var Ab=Tc[0];if(d.$c){var Ga=v.jc(Qa,!0);b.R.push(Ga);var nb=
F.Zt(Ga,"COC_FOREGROUND");Ga.dof_distance=d.dof_distance;Ga.tc=d.tc;Ga.Qb=d.Qb;Ga.Pb=d.Pb;Ga.Sb=d.Sb;Ga.Rb=d.Rb;Ga.dof_power=d.dof_power;Ga.Oc=d.Oc;Ga.Ua=d.Ua;Ga.$c=d.$c;Ga.dof_on=!0;C.F(m,nb);C.r(m,eb,nb,cb);C.r(m,Ab,nb,qc);var db=F.Xc("X_ALPHA_BLUR");C.F(m,db);C.r(m,nb,db,xc);var cc=F.Xc("Y_ALPHA_BLUR");C.F(m,cc);C.r(m,db,cc,zb);var Ha=v.jc(Qa,!0),gb=F.Zt(Ha,"COC_COMBINE");b.R.push(Ha);Ha.dof_distance=d.dof_distance;Ha.tc=d.tc;Ha.Qb=d.Qb;Ha.Pb=d.Pb;Ha.Sb=d.Sb;Ha.Rb=d.Rb;Ha.dof_power=d.dof_power;
Ha.Oc=d.Oc;Ha.Ua=d.Ua;Ha.$c=d.$c;Ha.dof_on=!0;C.F(m,gb);C.r(m,eb,gb,cb);C.r(m,Ab,gb,qc);C.r(m,cc,gb,y("COLOR","u_coc_fg",1,.5,.5,!0))}else Ha=v.jc(Qa,!0),b.R.push(Ha),gb=F.Zt(Ha,"COC_ALL"),Ha.dof_distance=d.dof_distance,Ha.tc=d.tc,Ha.Qb=d.Qb,Ha.Pb=d.Pb,Ha.Sb=d.Sb,Ha.Rb=d.Rb,Ha.dof_power=d.dof_power,Ha.Oc=d.Oc,Ha.Ua=d.Ua,Ha.$c=d.$c,Ha.dof_on=!0,C.F(m,gb),C.r(m,eb,gb,cb),C.r(m,Ab,gb,qc);var $a=F.Xc("X_DOF_BLUR");$a.o.Ua=d.Ua;C.F(m,$a);C.r(m,gb,$a,xc);var Nb=F.Xc("Y_DOF_BLUR");Nb.o.Ua=d.Ua;C.F(m,Nb);
C.r(m,$a,Nb,zb);var ib=F.Xc("Y_DOF_BLUR");ib.o.Ua=d.Ua;C.F(m,ib);C.r(m,$a,ib,zb);var Wa=F.Sy(Va);Va.dof_distance=d.dof_distance;Va.tc=d.tc;Va.Qb=d.Qb;Va.Pb=d.Pb;Va.Sb=d.Sb;Va.Rb=d.Rb;Va.dof_power=d.dof_power;Va.Oc=d.Oc;Va.Ua=d.Ua;Va.$c=d.$c;Va.dof_on=!0;q.push(Wa);C.F(m,Wa);C.r(m,eb,Wa,y("COLOR","u_sharp",1,1,1,!0));C.r(m,Nb,Wa,mb);C.r(m,ib,Wa,sb)}else{var tb=y("COLOR","u_color",1,1,1,!0);tb.pa=K.G;tb.oa=K.G;var ob=y("COLOR","u_color",1,1,1,!0);ob.pa=K.G;ob.oa=K.G;$a=F.Xc("X_BLUR");C.F(m,$a);C.r(m,
eb,$a,tb);var hb=F.Xc("Y_BLUR");C.F(m,hb);C.r(m,$a,hb,ob);var Ic=Tc[0],Wa=F.Sy(Va);Va.dof_distance=d.dof_distance;Va.tc=d.tc;Va.Qb=d.Qb;Va.Pb=d.Pb;Va.Sb=d.Sb;Va.Rb=d.Rb;Va.dof_power=d.dof_power;Va.Oc=d.Oc;Va.Ua=d.Ua;Va.$c=d.$c;Va.dof_on=!0;q.push(Wa);C.F(m,Wa);C.r(m,eb,Wa,y("COLOR","u_sharp",1,1,1,!0));C.r(m,hb,Wa,y("COLOR","u_blurred",1,1,1,!0));C.r(m,Ic,Wa,y("DEPTH","u_depth",1,1,1,!0))}u=q;q=[]}if(a.jg){var kc=h(F.Ae);q.push(kc);u=q;q=[]}if(W&&!Y){var ad=u[0],ub=F.PH(va.mb_decay_threshold,va.mb_factor);
q.push(ub);C.F(m,ub);C.r(m,ad,ub,y("COLOR","u_mb_tex_curr",1,1,1,!0));ub.Ha.push(y("COLOR","u_mb_tex_accum",1,1,1,!0));u=q;q=[]}if(!Y&&a.outline){var eb=u[0],dc=v.jc(Qa,!0);b.R.push(dc);var ec=F.RH(dc,I);C.F(m,ec);var yc=F.Xc("X_EXTEND"),Xa=y("COLOR","u_color",1,1,1,!0),ab=y("COLOR","u_outline_mask",1,1,1,!0);yc.so=!0;C.F(m,yc);C.r(m,ec,yc,Xa);var Jc=y("COLOR","u_color",1,.5,.5,!0);Jc.pa=K.G;Jc.oa=K.G;var Yb=F.Xc("Y_EXTEND");Yb.so=!0;C.F(m,Yb);C.r(m,yc,Yb,Jc);$a=F.Xc("X_BLUR");$a.so=!0;C.F(m,$a);
C.r(m,Yb,$a,Jc);var qb=y("COLOR","u_color",1,.25,.25,!0);qb.pa=K.G;qb.oa=K.G;var lc=y("COLOR","u_outline_mask_blurred",1,.25,.25,!0);lc.pa=K.G;lc.oa=K.G;hb=F.Xc("Y_BLUR");hb.so=!0;C.F(m,hb);C.r(m,$a,hb,qb);var Kc=F.QH(Ja);C.F(m,Kc);C.r(m,eb,Kc,y("COLOR","u_outline_src",1,1,1,!0));C.r(m,ec,Kc,ab);C.r(m,hb,Kc,lc);q.push(Kc);u=q;q=[]}e(m,Oa);if((a.anaglyph_use||a.no)&&!Y){var bd=w(m,a,b,u[0]);q.push(bd);u=q;q=[]}if(da&&!Y){var eb=u[0],zc=F.HH(Ma.brightness,Ma.contrast,Ma.exposure,Ma.saturation);C.F(m,
zc);C.r(m,eb,zc,y("COLOR","u_color",1,1,1,!0));q.push(zc);u=q;q=[]}if(ia){eb=u[0];if(L.smaa){var vb=y("COLOR","u_color",1,1,1,!0);vb.pa=K.G;vb.oa=K.G;var Rc=F.bu(F.Hp,a);C.F(m,Rc);C.r(m,eb,Rc,vb);var Lc=F.bu(F.Ym,a);C.F(m,Lc);C.r(m,Rc,Lc,vb);var rc=y("COLOR","u_search_tex",1,1,1,!1),cd=y("COLOR","u_area_tex",1,1,1,!1);rc.pa=K.G;rc.oa=K.G;cd.pa=K.G;cd.oa=K.G;Lc.Ha.push(rc);Lc.Ha.push(cd);var Ob=F.bu(F.Ip,a);C.F(m,Ob);C.r(m,eb,Ob,vb);var sc=y("COLOR","u_blend",1,1,1,!0);sc.pa=K.G;sc.oa=K.G;C.r(m,Lc,
Ob,sc);q.push(Ob)}else{var Vc=F.DH(a);C.F(m,Vc);var kd=y("COLOR","u_color",1,1,1,!0);kd.pa=K.G;kd.oa=K.G;C.r(m,eb,Vc,kd);q.push(Vc)}u=q;q=[]}var nd=C.Uf(m,u[0]);if(u[0].type==F.Yh||u[0].type==F.fl)var ld=!0;else ld=!1,C.Ug(m,nd,function(a,b,c){if(c.from==c.to)return ld=!0});if(ld){var gd=F.Xc("NONE");C.F(m,gd);C.r(m,u[0],gd,y("COLOR","u_color",1,1,1,!0));q.push(gd);u=q;q=[]}q.push(u[0]);Pb&&(nc?q.push(nc):q.push(Pb));Db&&q.push(Db);if(!Y&&a.os.procedural_skydome){var Gb=F.VH(I,a.os);C.F(m,Gb);q.push(Gb)}var Mc=
F.Ty();C.F(m,Mc);for(sa=0;sa<q.length;sa++){var tc=q[sa];switch(tc.type){case F.Xd:case F.Zg:C.r(m,tc,Mc,y("COLOR","NONE",1,1,1,!1));C.r(m,tc,Mc,y("DEPTH","NONE",1,1,1,!1));break;case F.Zh:C.r(m,tc,Mc,y("CUBEMAP","u_sky",P.sl,1,1,!1));break;case F.cl:C.r(m,tc,Mc,y("COLOR","NONE",1,1,1,!0));break;default:if(Y){var od=g[0].p,Wc=y("COLOR","OFFSCREEN",1,1,1,!0);Wc.Ja=od;C.r(m,q[sa],Mc,Wc);for(ba=1;ba<g.length;ba++){var md=g[ba].p,Sc=F.Xc("NONE");C.F(m,Sc);C.r(m,q[sa],Sc,y("COLOR","SCALE",1,1,1,!0));var pd=
md.Jh/od.Jh,Wc=y("COLOR","OFFSCREEN",1,pd,pd,!0);Wc.Ja=md;C.r(m,Sc,Mc,Wc)}}else C.r(m,q[sa],Mc,y("SCREEN","NONE",1,1,1,!0))}}wb&&!t(m,wb).length&&(C.ag(m,C.Uf(m,wb)),C.Kt(m));e(m,Oa);c(m,Oa);if(N.enabled){var qd=f(m);qd&&H(m,qd)}n(m);l(m);ya&&C.ma(m,function(a,b){if(b.type==F.Be||b.type==F.hc||b.type==F.Ae){for(var c=0,d=k(m,b),e=0,f=0;f<d.length;f++){var g=d[f];g.type==F.Ac&&(e++,b.Dk=b.Dk||[],b.Dk[0<g.dg?g.dg:c]=g.o.Ya,c++)}b.Fs&&b.Es||(L.vr?b.cx=new Float32Array(9*e):(b.Fs=new Float32Array(4*e),
b.Es=new Float32Array(4*e)))}});return m};a.jL=E;a.fd=function(a,b,c){var d=a.Df;a.Kw[0]=b*a.gb[0]*d;a.Kw[1]=c*a.gb[1]*d};a.nc=function(a,b){a.Df=b};a.rH=function(){var a=C.create(),b=F.SH(),c=v.Ec(v.Lc);c.width=1024;c.height=1024;b.o=c;C.F(a,b);c=F.Ty();C.F(a,c);C.r(a,b,c,y("COLOR","NONE",1024,1,1,!1));n(a);l(a);return a};a.SI=function(a){var b=null;C.ma(a,function(a,c){return c.o&&null===c.o.je?(b=c,!0):!1});return b};a.bb=function(a,b,c){a=k(a,b);for(b=0;b<a.length;b++)if(a[b].type==c)return a[b];
return null};a.Hu=function(a,b,c){a=k(a,b);b=[];for(var d=0;d<a.length;d++)a[d].type==c&&b.push(a[d]);return b};a.NQ=G;a.PQ=x;a.JJ=k;a.NJ=t;a.$b=function(a,b){var c=null;C.ma(a,function(a,d){return d.type==b?(c=d,!0):!1});return c};a.iI=function(a){var b="digraph scenegraph {\n",b=b+"    ",b=b+'size="11.7,16.5";\n',b=b+"    ",b=b+'ratio="fill";\n',b=b+"    ",b=b+'node [shape=box margin="0.25,0.055"];\n',c=M(a);C.ma(a,function(a,d){var e=b+="    ",f=F.Cw(d);if(d.o){for(var f=f+"\\n",k=0;k<c.length;k+=
2){var g=d.o.Zb;c[k]==g&&(f=K.Ol(g)?f+("CR"+c[k+1]+" "):f+("C"+c[k+1]+" "))}for(k=0;k<c.length;k+=2)g=d.o.ge,c[k]==g&&(f=K.Ol(g)?f+("DR"+c[k+1]):f+("D"+c[k+1]))}d.Ha.length&&(f+="\\n-----\\n");for(k=0;k<d.Ha.length;k++)f+=u(d.Ha[k],c);k=d.type==F.hl?"dotted":d.enqueue?"solid":"dashed";b=e+(String(a)+' [label="'+f+'" color="black" style="'+(k+",bold")+'"];\n')});C.gg(a,function(a,d,e){b+="    ";b+=String(a)+" -> "+String(d)+' [label="'+u(e,c)+'" style="'+(e.ic?"solid":"dotted")+'"];\n'});return b+=
"}"};a.uH=function(a){a=C.FN(a);for(var b=[],c=0;c<a.length;c++){var d=a[c];d.enqueue&&b.push(d)}return b}};b4w.module.__subscene=function(a,p){function e(a,b){a.Ir=b;a.bv=new Float32Array(3*b);a.pr=new Float32Array(3*b);a.or=new Float32Array(3*b);a.cv=new Float32Array(0==b%2?2*b:2*b+2)}function c(a){a={type:a,rb:"",kb:!1,fB:!1,tt:!1,Dr:!1,Nn:0,Ie:0,Sj:[],debug_view_mode:0,debug_colors_seed:0,Xy:1,nu:!1,time:0,o:null,Rj:null,Ln:[],za:[],Ha:[],Sg:[],Vh:new Float32Array(3),yd:new Float32Array(3),Ld:new Float32Array(4),nf:new Float32Array(4),Jd:new Float32Array(16),WB:0,ph:0,Ir:0,bv:null,pr:null,or:null,cv:null,
Oe:new Float32Array(3),cf:new Float32Array(3),XB:new Float32Array(4),mC:new Float32Array([0,0,0]),Dw:new Float32Array(3),nC:new Float32Array(4),VB:new Float32Array(3),Eo:0,pu:0,so:!1,Dh:new Float32Array(3),Wg:!1,Gt:0,Xg:null,fx:0,gx:0,qj:0,oc:null,If:!1,sy:0,ty:new Float32Array(2),ry:0,procedural_skydome:!1,use_as_environment_lighting:!1,mie_brightness:0,rayleigh_brightness:0,spot_brightness:0,mie_strength:0,rayleigh_strength:0,scatter_strength:0,mie_collection_power:0,rayleigh_collection_power:0,
mie_distribution:0,qm:new Float32Array(3),ssao_hemisphere:0,ssao_blur_depth:0,ssao_blur_discard_value:0,um:0,tm:0,sm:0,fC:0,ssao_only:0,ssao_white:0,brightness:0,contrast:0,exposure:0,saturation:0,god_rays_intensity:0,Vl:0,Zr:0,ym:0,cu:0,self_shadow_polygon_offset:0,self_shadow_normal_offset:0,Fs:null,Es:null,cx:null,Dk:null,Tb:!1,yz:"",bloom_key:0,bloom_blur:0,bloom_edge_lum:0,xt:0,uu:0,mb_decay_threshold:0,mb_factor:0,NA:0,Ur:"",Hy:"",rK:new Float32Array(2),small_glow_mask_width:0,large_glow_mask_width:0,
small_glow_mask_coeff:0,large_glow_mask_coeff:0,Kw:new Float32Array(2),gb:new Float32Array(2),Tj:new Float32Array(4),chromatic_aberration_coefs:new Float32Array(4),enable_hmd_stereo:!1,dg:0,Cr:!0,sb:!0,enqueue:!0,Xa:!0,ab:!0,md:!0,qa:!0,Df:1};a.gb[0]=1;a.gb[1]=1;a.Tj[2]=.5;a.Tj[3]=.5;return a}function b(a,b){return a==b?0:a>b?1:-1}function n(a,c){return-b(a.Ff,c.Ff)||b(a.Se,c.Se)||b(a.La.$o,c.La.$o)}var h=p("__camera"),r=p("__config"),g=p("__util"),m=r.fc,q=r.Kk;a.pb=0;a.hc=1;a.Ae=2;a.jd=3;a.Kc=4;
a.df=5;a.Yd=6;a.pd=7;a.Ac=8;a.Be=9;a.$g=10;a.Ab=11;a.Um=12;a.Xm=13;a.fl=14;a.Xd=15;a.Zg=16;a.ze=17;a.cl=18;a.rx=19;a.Jp=20;a.jt=21;a.lx=22;a.Ym=23;a.Hp=24;a.ht=25;a.Ip=26;a.Vs=27;a.Yh=28;a.Us=29;a.Wm=30;a.kg=31;a.el=32;a.Xh=33;a.Dp=34;a.Zh=35;a.Ws=36;a.Kp=37;a.LUMINANCE=38;a.jD=39;a.Ep=40;a.Tm=41;a.UE=42;a.hl=43;a.Gp=44;a.TH=function(a,b,l,f){var m=c(8);m.cu=a;m.self_shadow_polygon_offset=l.self_shadow_polygon_offset;m.dg=b;switch(l.Rf[b]){case "SPOT":case "POINT":m.o=h.Ec(h.kd);a=g.rad_to_deg(l.dC[b]);
h.hs(m.o,a,l.zn[b],l.yn[b]);break;default:m.o=h.Ec(h.$h)}e(m,f);return m};a.TG=function(a){var b=a.o;a.o=null;var c=g.I(a);a.o=b;c.o=h.jc(b,!0);return c};a.MH=function(){var a=c(10);a.o=h.Ec(h.ah);return a};a.Xc=function(a){var b=c(11);b.Xa=!1;b.ab=!1;b.md=!1;b.Tb=!0;b.o=h.Ec(h.Lc);b.Ur=a;switch(a){case "NONE":b.gb[0]=1;b.gb[1]=1;break;case "GRAYSCALE":b.gb[0]=1;b.gb[1]=1;break;case "X_BLUR":b.gb[0]=1;b.gb[1]=0;break;case "Y_BLUR":b.gb[0]=0;b.gb[1]=1;break;case "X_GLOW_BLUR":b.gb[0]=1;b.gb[1]=0;break;
case "Y_GLOW_BLUR":b.gb[0]=0;b.gb[1]=1;break;case "X_DOF_BLUR":b.gb[0]=1;b.gb[1]=1;break;case "Y_DOF_BLUR":b.gb[0]=1;b.gb[1]=1;break;case "X_ALPHA_BLUR":b.gb[0]=1;b.gb[1]=0;b.Df=3;break;case "Y_ALPHA_BLUR":b.gb[0]=0;b.gb[1]=1;b.Df=3;break;case "X_EXTEND":b.gb[0]=1;b.gb[1]=0;break;case "Y_EXTEND":b.gb[0]=0;b.gb[1]=1;break;default:g.q("Wrong postprocessing effect: "+a)}return b};a.Qy=function(a){var b=c(12);b.Xa=!1;b.ab=!1;b.md=!1;b.o=h.Ec(h.Lc);b.Ur=a;b.Tb=!0;switch(a){case "X_BLUR":b.gb[0]=1;b.gb[1]=
0;break;case "Y_BLUR":b.gb[0]=0;b.gb[1]=1;break;default:g.q("Wrong postprocessing effect for bloom blur: "+a)}return b};a.KH=function(a,b){var e=c(13);e.Xa=!1;e.ab=!1;e.md=!1;e.small_glow_mask_coeff=b.ui.small_glow_mask_coeff;e.large_glow_mask_coeff=b.ui.large_glow_mask_coeff;e.small_glow_mask_width=b.ui.small_glow_mask_width;e.large_glow_mask_width=b.ui.large_glow_mask_width;e.o=a;e.Tb=!0;return e};a.Qj=function(a,b,h,f,m,n,q,r,p){var A=c(a);0==a?(A.Xa=!0,A.ab=h,A.kb=!1):1==a?(A.Xa=!1,A.ab=!1,A.kb=
!0):2==a?(A.Xa=!1,A.ab=!0,A.kb=!0):3==a||4==a?(A.Xa=!0,A.ab=!0,A.kb=!1):5==a||6==a?(A.Xa=!1,A.ab=!1,A.kb=!0):7==a?(A.Xa=!0,A.ab=!1,A.kb=!0):g.q("wrong main subscene type");A.kb&&r&&(A.self_shadow_normal_offset=r.self_shadow_normal_offset);A.o=b;if(a=q.rw)A.XB.set([a.ZF,a.cK,a.YO,a.XO]),A.VB.set(a.color),A.WB=a.hb;A.Oe.set(q.Oe);A.cf.set(q.cf);A.ph=q.ph;A.Ld=n.Ld;A.nf=n.nf;f&&(A.oc=f,f.Ld&&(A.Xg=new Float32Array(f.Ld)),A.fx=f.waves_height,A.gx=f.waves_length,A.qj=f.qj,f.If&&p&&(A.If=!0,A.sy=f.pG,A.ry=
f.oG,A.ty.set(f.qG)));e(A,m);return A};a.pq=function(){var a=c(14);a.Tb=!0;a.o=h.Ec(h.Lc);return a};a.Ry=function(a,b,g){var f=c(15);b&&(f.type=16,f.Xa=!1,f.ab=!0);f.enqueue=!1;f.o=a;e(f,g);return f};a.IH=function(a){var b=c(17);b.sb=!1;b.Xa=!1;b.ab=!1;b.o=a;return b};a.EH=function(a){var b=c(18);b.Xa=!0;b.ab=!1;b.o=a;return b};a.UH=function(a,b){var g=c(9);g.o=a;e(g,b);return g};a.JH=function(a){var b=c(19);b.Xa=!1;b.ab=!1;b.o=a;b.Tb=!0;return b};a.WH=function(a,b,e){var f=c(20);f.Xa=!1;f.ab=!1;
f.md=!1;f.o=a;f.Ld=b.Ld;f.Xg=new Float32Array(b.Ld);f.um=e.radius_increase;f.ssao_hemisphere=e.aK;f.tm=e.influence;f.sm=e.dist_factor;f.fC=e.fM;f.Tb=!0;return f};a.XH=function(a,b){var e=c(21);e.Xa=!1;e.ab=!1;e.md=!1;e.o=a;e.ssao_blur_depth=b.bG;e.ssao_blur_discard_value=b.iy;e.Tb=!0;return e};a.DH=function(a){var b=c(22);b.Xa=!1;b.ab=!1;b.md=!1;b.Df=1/a.re;b.yz=a.Jx;b.o=h.Ec(h.Lc);b.Tb=!0;return b};a.bu=function(a,b){var e=c(a);e.Xa=23==a||24==a?!0:!1;e.ab=!1;e.md=!1;e.Df=1/b.re;e.o=h.Ec(h.Lc);23==
a&&(e.sK=new Float32Array(4));e.Tb=!0;return e};a.HH=function(a,b,e,f){var g=c(27);g.Xa=!1;g.ab=!1;g.md=!1;g.o=h.Ec(h.Lc);g.brightness=a;g.contrast=b;g.exposure=e;g.saturation=f;g.Tb=!0;return g};a.PH=function(a,b){var e=c(28);e.Xa=!1;e.ab=!1;e.md=!1;e.o=h.Ec(h.Lc);e.tt=!0;e.mb_decay_threshold=a;e.mb_factor=b;e.Tb=!0;return e};a.Zt=function(a,b){var e=c(29);e.Xa=!1;e.ab=!1;e.md=!1;e.o=a;e.Df=e.o.dof_power;e.Hy=b;e.Tb=!0;return e};a.Sy=function(a){var b=c(30);b.Xa=!1;b.ab=!1;b.md=!1;b.o=a;b.Df=b.o.dof_power;
b.Tb=!0;return b};a.RH=function(a,b){var g=c(31);g.md=!1;g.o=a;e(g,b);return g};a.QH=function(a){var b=c(32);m.outlining_overview_mode?b.Dh.set(m.Dh):b.Dh.set(a.Dh);b.Eo=a.Eo;b.uu=5;b.xt=3;b.md=!1;b.o=h.Ec(h.Lc);b.Tb=!0;return b};a.au=function(a,b,g,f,h,m,n){var q=c(33);q.Xa=!1;q.ab=!1;q.md=!1;q.Oe=new Float32Array([1,1,1]);q.cf=new Float32Array([1,1,1]);q.ph=1;q.fB=f;q.Wg=b;q.Zr=h;q.Vl=g;q.ym=n;q.o=a;e(q,m);return q};a.LH=function(a,b){var g=c(34);g.Xa=!1;g.ab=!1;g.md=!1;g.o=h.Ec(h.Lc);g.god_rays_intensity=
a;e(g,b);g.Tb=!0;return g};a.VH=function(a,b){var l=c(35);l.enqueue=!1;l.Xa=!1;l.ab=!1;l.md=!1;var f=h.Ec(h.Lc);f.width=q.sl;f.height=q.sl;l.o=f;l.Rj=g.gJ();e(l,a);l.Oe=new Float32Array([1,1,1]);l.cf=new Float32Array([1,1,1]);l.ph=1;l.qm.set(b.qm);l.procedural_skydome=b.procedural_skydome;l.use_as_environment_lighting=b.use_as_environment_lighting;l.rayleigh_brightness=b.rayleigh_brightness;l.mie_brightness=b.mie_brightness;l.spot_brightness=b.spot_brightness;l.scatter_strength=b.scatter_strength;
l.rayleigh_strength=b.rayleigh_strength;l.mie_strength=b.mie_strength;l.rayleigh_collection_power=b.rayleigh_collection_power;l.mie_collection_power=b.mie_collection_power;l.mie_distribution=b.mie_distribution;return l};a.$t=function(){var a=c(36);a.Xa=!1;a.ab=!1;a.o=h.Ec(h.Lc);a.Tb=!0;return a};a.YH=function(a){var b=c(37);b.Xa=!1;b.ab=!1;b.rb=a?"HMD":"ANAGLYPH";b.o=h.Ec(h.Lc);b.Tb=!0;return b};a.NH=function(){var a=c(38);a.Xa=!1;a.ab=!1;a.o=h.Ec(h.Lc);a.Tb=!0;return a};a.FH=function(){var a=c(39);
a.Xa=!1;a.ab=!1;a.o=h.Ec(h.Lc);a.Tb=!0;return a};a.OH=function(a,b,g,f){var h=c(40);h.Xa=!1;h.ab=!1;h.bloom_key=a;h.bloom_edge_lum=b;h.o=f;e(h,g);h.Tb=!0;return h};a.GH=function(a){var b=c(41);b.Xa=!1;b.ab=!1;b.o=h.Ec(h.Lc);b.bloom_blur=a;b.Tb=!0;return b};a.bQ=function(a){var b=c(42);b.Xa=!1;b.ab=!1;b.o=a;b.Tb=!0;return b};a.Ty=function(){var a=c(43);a.enqueue=!1;return a};a.SH=function(){var a=c(44);a.Tb=!0;return a};a.Cw=function(a){switch(a.type){case 0:return"MAIN OPAQUE";case 1:return"MAIN BLEND";
case 2:return"MAIN XRAY";case 3:return"MAIN PLANE REFLECT";case 4:return"MAIN CUBE REFLECT";case 5:return"MAIN PLANE REFLECT BLEND";case 6:return"MAIN CUBE REFLECT BLEND";case 7:return"MAIN GLOW";case 8:return"SHADOW CAST";case 9:return"SHADOW RECEIVE";case 10:return"GRASS MAP";case 11:return"POSTPROCESSING ("+a.Ur.replace(/_/g," ")+")";case 12:return"BLOOM BLUR";case 13:return"GLOW COMBINE";case 14:return"RESOLVE";case 15:return"COLOR PICKING";case 16:return"COLOR PICKING XRAY";case 17:return"DEBUG VIEW";
case 18:return"ANCHOR VISIBILITY";case 19:return"DEPTH PACK";case 20:return"SSAO";case 21:return"SSAO BLUR";case 22:return"ANTIALIASING";case 23:return"SMAA BLENDING WEIGHT CALCULATION";case 24:return"SMAA EDGE DETECTION";case 25:return"SMAA RESOLVE";case 26:return"SMAA NEIGHBORHOOD BLENDING";case 27:return"COMPOSITING";case 28:return"MOTION BLUR";case 29:return"COC";case 30:return"DOF";case 31:return"OUTLINE MASK";case 32:return"OUTLINE";case 33:return"GOD RAYS";case 34:return"GOD RAYS COMBINE";
case 35:return"SKY";case 36:return"COPY";case 37:return"STEREO";case 38:return"LUMINANCE";case 39:return"AVERAGE LUMINANCE";case 40:return"LUMINANCE TRUNCED";case 41:return"BLOOM";case 42:return"VELOCITY";case 44:return"PERFORMANCE";case 43:return"SINK";default:return"UNKNOWN"}};a.gf=function(a,b){for(var c=b.Y,e=c.La,g=0;g<a.za.length;g++){var h=a.za[g].ha,m=h.indexOf(b);-1!=m&&(h.splice(m,1),h.length||a.za.splice(g,1))}c.lm=0;a:{g=a.za;for(h=0;h<g.length;h++)if(m=g[h],m.La==e&&(a.kb?c.Se:0)==m.Se){g=
m;break a}g=null}if(g)g.ha.push(b);else return a.za.push({La:e,ha:[b],Ff:c.Ff,Se:c.Se,sb:!0}),!0;return!1};a.Cg=function(a,b){return{sb:!0,ou:[!0,!0,!0,!0,!0,!0],Jg:b,Y:a}};a.fN=function(a){a.za.sort(n);a.Cr=!1}};b4w.module.__textures=function(a,p){function e(){return{name:"",type:0,source:"",dp:"",width:0,height:0,Gn:1,tw:!1,kl:!0,Jh:1024,Xj:!1,Id:null,Ta:0,Wa:null,Wd:null,tk:!1,hg:-1,sa:null,Gi:0,Qf:0,la:0,tb:0,si:0,uf:!1,bg:1,Sc:null,Xo:0,Wo:0,Ih:-1,Zo:!1,aj:-1,Om:!1,$w:!1,Sh:!1,Lm:!1,repeat:!0,ld:!0}}function c(c,d,f,g){var k=c.type,h=new Uint8Array([204,204,204,255]),l=e();switch(k){case "DATA_TEX2D":case "IMAGE":var m=I.createTexture(),n=I.TEXTURE_2D;I.bindTexture(n,m);I.texImage2D(n,0,I.RGBA,1,1,0,
I.RGBA,I.UNSIGNED_BYTE,h);c.image&&("Non-Color"==c.image.colorspace_settings_name&&(l.tw=!0),"MOVIE"==c.image.source&&(l.tk=!0,l.la=c.frame_start,l.tb=c.frame_offset,l.si=c.frame_duration,l.$w=c.use_auto_refresh,l.Sh=c.use_cyclic,l.Gi=c.movie_length,l.Lm=c.b4w_nla_video,0!=l.tb&&P.warn('Frame offset for texture "'+c.name+'" has a nonzero value. Can lead to undefined behaviour for mobile devices.')));break;case "NONE":m=I.createTexture();n=I.TEXTURE_2D;I.bindTexture(n,m);if("NONE"==c.b4w_source_type)return null;
if("SCENE"==c.b4w_source_type)if(c.b4w_source_id&&(f=U.keysearch("name",c.b4w_source_id,f)))l.Jh=c.b4w_source_size,f.ef=f.ef||[],f.ef.push(c),I.texImage2D(n,0,I.RGBA,1,1,0,I.RGBA,I.UNSIGNED_BYTE,h);else return null;break;case "ENVIRONMENT_MAP":m=I.createTexture();n=I.TEXTURE_CUBE_MAP;I.bindTexture(n,m);f="POSITIVE_X NEGATIVE_X POSITIVE_Y NEGATIVE_Y POSITIVE_Z NEGATIVE_Z".split(" ");for(var u=0;6>u;u++)I.texImage2D(I["TEXTURE_CUBE_MAP_"+f[u]],0,I.RGBA,1,1,0,I.RGBA,I.UNSIGNED_BYTE,h);break;case "BLEND":return null;
case "NODE_TEX":m=I.createTexture();n=I.TEXTURE_2D;I.bindTexture(n,m);I.texImage2D(n,0,I.RGBA,1,1,0,I.RGBA,I.UNSIGNED_BYTE,h);break;default:return P.error('texture "'+c.name+'" has unsupported type "'+k+'"'),null}"NONE"==k&&(!c.b4w_enable_canvas_mipmapping||"CANVAS"!=c.b4w_source_type)||"DATA_TEX2D"==k||"IMAGE"==k&&"MOVIE"==c.image.source||"NODE_TEX"==k?I.texParameteri(n,I.TEXTURE_MIN_FILTER,I.LINEAR):I.texParameteri(n,I.TEXTURE_MIN_FILTER,Ia[Q.Em]);I.texParameteri(n,I.TEXTURE_MAG_FILTER,I.LINEAR);
h=n;f=c.b4w_anisotropic_filtering;"DEFAULT"===f&&(f=d);"OFF"!==f&&Q.anisotropic_filtering&&(d=L.tJ())&&(f=parseFloat(f.split("x")[0]),I.texParameterf(h,d.TEXTURE_MAX_ANISOTROPY_EXT,f));"REPEAT"!=c.extension||c.b4w_shore_dist_map?(l.repeat=!1,I.texParameteri(n,I.TEXTURE_WRAP_S,I.CLAMP_TO_EDGE),I.texParameteri(n,I.TEXTURE_WRAP_T,I.CLAMP_TO_EDGE)):(I.texParameteri(n,I.TEXTURE_WRAP_S,I.REPEAT),I.texParameteri(n,I.TEXTURE_WRAP_T,I.REPEAT));l.type=a.uj;l.width=1;l.height=1;l.Wa=m;l.Ta=n;"CANVAS"==c.b4w_source_type&&
"NONE"==k?(k=c.b4w_source_id,m=c.b4w_source_size,l.Xj=c.b4w_enable_canvas_mipmapping,l.dp=k,l.source="CANVAS",n=document.createElement("canvas"),n.width=m,n.height=m,l.Id=n.getContext("2d"),g in ea||(ea[g]={}),ea[g][k]=l,b(l)):"SCENE"==c.b4w_source_type&&"NONE"==k?(l.dp=c.b4w_source_id,l.source="SCENE"):(l.source=k,I.generateMipmap(n),I.bindTexture(n,null));l.name=c.name;return c.p=l}function b(a){"CANVAS"!=a.source&&U.q("Wrong texture");var b=a.Ta;I.bindTexture(b,a.Wa);var c=f(a),d=H(a),e=D(a),g=
a.Id.canvas;I.pixelStorei(I.UNPACK_FLIP_Y_WEBGL,!0);I.texImage2D(b,0,d,c,e,g);I.pixelStorei(I.UNPACK_FLIP_Y_WEBGL,!1);a.Xj&&I.generateMipmap(b);I.bindTexture(b,null);a.width=g.width;a.height=g.height}function n(a){var b=a.Ta;I.bindTexture(b,a.Wa);I.pixelStorei(I.UNPACK_FLIP_Y_WEBGL,!0);4!=a.sa.length?a.uf?g(a,a.sa,a.width*a.bg,a.height*a.bg,!1):I.texImage2D(b,0,I.RGBA,I.RGBA,I.UNSIGNED_BYTE,a.sa):I.texImage2D(b,0,I.RGBA,1,1,0,I.RGBA,I.UNSIGNED_BYTE,a.sa);I.bindTexture(b,null)}function h(a){var b=
a.Ta;I.bindTexture(b,a.Wa);I.pixelStorei(I.UNPACK_FLIP_Y_WEBGL,!0);a.uf?g(a,a.Sc[a.Ih],a.width*a.bg,a.height*a.bg,!1):I.texImage2D(b,0,I.RGBA,I.RGBA,I.UNSIGNED_BYTE,a.Sc[a.Ih]);I.bindTexture(b,null)}function r(){ra||(ra=document.createElement("canvas"));return ra}function g(a,b,c,d,e){e||(q(I.TEXTURE_2D),I.texImage2D(I.TEXTURE_2D,0,I.RGBA,I.RGBA,I.UNSIGNED_BYTE,b));I.bindTexture(I.TEXTURE_2D,null);ga.uI(a,c,d,oa,ja)}function m(a,b,c,d){for(var e=0;6>e;e++){var f=d[e],g=r();g.width=c;g.height=c;var k=
g.getContext("2d");"POSITIVE_Y"==f[0]||"NEGATIVE_Y"==f[0]?(k.translate(0,c),k.scale(1,-1)):(k.translate(c,0),k.scale(-1,1));k.drawImage(a,f[1]*b,f[2]*b,b,b,0,0,c,c);I.texImage2D(I["TEXTURE_CUBE_MAP_"+f[0]],0,I.RGBA,I.RGBA,I.UNSIGNED_BYTE,g)}}function q(a){oa||(oa=I.createFramebuffer());I.bindTexture(a,null);ja||(ja=I.createTexture());I.bindTexture(a,ja);I.texParameteri(a,I.TEXTURE_WRAP_S,I.CLAMP_TO_EDGE);I.texParameteri(a,I.TEXTURE_WRAP_T,I.CLAMP_TO_EDGE);I.texParameteri(a,I.TEXTURE_MAG_FILTER,I.LINEAR);
I.texParameteri(a,I.TEXTURE_MIN_FILTER,I.LINEAR)}function B(a,b,c,e,f){var k=a.source,h=a.Wa,n=a.Ta,u=1,t=1;I.bindTexture(n,h);if(4==b.length){var v=!0;b=new Uint8Array([255*b[0],255*b[1],255*b[2],255*b[3]])}if("IMAGE"==k)if(v)I.texImage2D(n,0,I.RGBA,1,1,0,I.RGBA,I.UNSIGNED_BYTE,b),a.width=1,a.height=1;else if(c){t=X.Zz(b);v=U.xn(t.width)||U.xn(t.height);if(t.width>Z.ec||t.height>Z.ec){P.error('Texture "'+e+'" has unsupported size: '+t.width+"x"+t.height+". Max available: "+Z.ec+"x"+Z.ec+".");return}u=
t.width;t=t.height;v&&(a.uf=!0,q(n),u=l(u*a.bg),t=l(t*a.bg));X.rO(I,L.Tz(),b,!0);a.uf&&(g(a,null,u,t,!0),I.bindTexture(n,h),I.generateMipmap(n));a.width=u;a.height=t;a.Gn=X.yJ(b)}else{I.pixelStorei(I.UNPACK_FLIP_Y_WEBGL,!0);a.tk?Q.Yo?(u=b[0].width,t=b[0].height):(u=b.videoWidth,t=b.videoHeight):(u=b.width,t=b.height);a.width=u;a.height=t;if(u>Z.ec||u>Z.ec)P.warn('Texture "'+e+'" has unsupported size: '+u+"x"+t+". Max available: "+Z.ec+"x"+Z.ec+". Reduced image size will be used."),a.bg=Math.min(Z.ec/
u,Z.ec/t),a.uf=!0;a.tk&&(Q.Yo?(f in ka||(ka[f]={}),ka[f][a.name]=a,a.Sc=b,a.Xo=b.length,a.Qf=a.Wo*a.Gi/b.length,b=b[0]):(f in ka||(ka[f]={}),ka[f][a.name]=a,a.sa=b,a.sa.loop=a.Sh,a.Qf=b.duration?a.Gi/b.duration:da.Qc(),ma.fz||(b.playbackRate=da.Qc()/a.Qf,ma.Ey&&2<b.playbackRate&&(b.playbackRate=2)),d(a)));u=l(a.width*a.bg);t=l(a.height*a.bg);a.uf?(e=r(),h=e.getContext("2d"),e.width=u,e.height=t,h.drawImage(b,0,0,a.width,a.height,0,0,u,t),I.texImage2D(n,0,I.RGBA,I.RGBA,I.UNSIGNED_BYTE,e)):U.xn(a.width)||
U.xn(a.height)?(g(a,b,u,t,!1),a.uf=!0):I.texImage2D(n,0,I.RGBA,I.RGBA,I.UNSIGNED_BYTE,b);h=a.Wa;I.bindTexture(n,h);a.tk||I.generateMipmap(n);I.bindTexture(n,null);a.width=u;a.height=t}else if("ENVIRONMENT_MAP"==k)if(u=[["POSITIVE_X",2,0],["NEGATIVE_X",0,0],["POSITIVE_Y",1,1],["NEGATIVE_Y",0,1],["POSITIVE_Z",1,0],["NEGATIVE_Z",2,1]],v){for(e=0;6>e;e++)I.texImage2D(I["TEXTURE_CUBE_MAP_"+u[e][0]],0,I.RGBA,1,1,0,I.RGBA,I.UNSIGNED_BYTE,b);a.width=3;a.height=2}else{I.pixelStorei(I.UNPACK_FLIP_Y_WEBGL,!1);
if(b.width%3||b.height%2){P.error('Cubemap texture "'+e+'" has unsupported size: '+b.width+"x"+b.height+". The width must be multiple of three and the height - multiple of two.");return}t=b.width/3;if(t>Z.Ei)P.warn('Cubemap texture "'+e+'" has unsupported size: '+b.width+"x"+b.height+". Max available: "+3*Z.Ei+"x"+2*Z.Ei+". Reduced image size will be used."),e=l(Z.Ei/t*t),a.uf=!0;else if(e=l(t),3*e>Z.ec||2*e>Z.ec)a.uf=!0;if(a.uf||Q.aw)m(b,t,e,u);else{v=b;h=e;q(I.TEXTURE_2D);I.texImage2D(I.TEXTURE_2D,
0,I.RGBA,I.RGBA,I.UNSIGNED_BYTE,v);I.bindTexture(I.TEXTURE_2D,null);for(v=0;6>v;v++)I.texImage2D(I.TEXTURE_CUBE_MAP_POSITIVE_X+v,0,I.RGBA,h,h,0,I.RGBA,I.UNSIGNED_BYTE,null);I.bindTexture(a.Ta,null);I.bindFramebuffer(I.FRAMEBUFFER,oa);for(v=0;6>v;v++)ga.tI(a,I.TEXTURE_CUBE_MAP_POSITIVE_X+v,h,t,ja,v);I.bindFramebuffer(I.FRAMEBUFFER,null);I.bindTexture(a.Ta,a.Wa);I.texParameteri(a.Ta,I.TEXTURE_MIN_FILTER,Ia[Q.Em]);I.texParameteri(a.Ta,I.TEXTURE_MAG_FILTER,I.LINEAR)}N.AG()&&(P.warn("Firefox detected, setting max cubemap size to 256, use canvas for resizing."),
m(b,t,F.Bx,u));a.width=3*e;a.height=2*e;I.generateMipmap(n)}else if("DATA_TEX2D"==k||"NODE_TEX"==k)I.texImage2D(n,0,I.RGBA,b.width,b.height,0,I.RGBA,I.UNSIGNED_BYTE,b.data),a.width=b.width,a.height=b.height;I.bindTexture(n,null)}function d(a){a.sa.pR=function(){n(a)}}function l(a){return U.xn(a)?U.clamp(Math.pow(2,parseInt(a).toString(2).length),2,Z.ec):a}function f(b){var c;switch(b.type){case a.uj:c=I.RGBA;break;case a.Pp:c=I.RGB;break;case a.Zm:c=I.RGBA;break;case a.$m:c=I.RGB;break;case a.il:c=
I.DEPTH_COMPONENT;break;default:U.q("Wrong texture type")}return c}function H(b){var c;switch(b.type){case a.uj:c=Q.pc?I.RGBA8:I.RGBA;break;case a.Pp:c=Q.pc?I.RGB8:I.RGB;break;case a.Zm:c=Q.pc?I.RGBA8:I.RGBA;break;case a.$m:c=Q.pc?I.RGB8:I.RGB;break;case a.il:c=Q.pc?I.DEPTH_COMPONENT24:I.DEPTH_COMPONENT;break;default:U.q("Wrong texture type")}return c}function D(b){var c;switch(b.type){case a.uj:c=I.UNSIGNED_BYTE;break;case a.Pp:c=I.UNSIGNED_BYTE;break;case a.Zm:c=I.FLOAT;break;case a.$m:c=I.FLOAT;
break;case a.il:c=I.UNSIGNED_INT;break;default:U.q("Wrong texture type")}return c}function w(a){return a&&a.name&&a.Wd?!0:!1}function E(a,b){var d=null;switch(a){case "SSAO_TEXTURE":d={name:"special_ssao_texture",type:"DATA_TEX2D",extension:"REPEAT",b4w_anisotropic_filtering:"OFF"};c(d,null,b,0);d.image={filepath:null};break;case "NODE_TEX":d={name:"",type:"NODE_TEX",extension:"CLIP",b4w_anisotropic_filtering:"OFF"},c(d,null,b,0),d.image={filepath:null}}return d}function y(a,b){if(b in ka&&a in ka[b]){var c=
ka[b][a];c.sa?c.sa.play():c.Sc&&(c.Zo=!0);return!0}return!1}function A(a,b){if(b in ka&&a in ka[b]){var c=ka[b][a];c.sa?c.sa.pause():c.Sc&&(c.Zo=!1);return!0}return!1}function G(a,b){if(b in ka&&a in ka[b]){var c=ka[b][a];c.sa?c.sa.currentTime=c.tb/c.Qf:c.Sc&&(c.Ih=k(c,c.tb),h(c));return!0}return!1}function x(a){return a.sa?!a.sa.paused:a.Sc?a.Zo:!1}function k(a,b){return Math.round(b*a.Xo/a.Gi)}function t(a,b){if(T.Da(a))return M(a,b);for(var c=a.yr,d=0;d<c.length;d++){var e=M(c[d],b);if(e)return e}return null}
function M(a,b){var c=a.C;if(c.length)for(var c=c[0].P,d=0;d<c.length;d++){var e=c[d];if("MAIN"==e.type)for(var f=0;f<e.T.length;f++)if(e.T[f].name==b)return e.T[f]}return null}function u(a,b,c){a=a.C;if(a.length){a=a[0].P;for(var d=0;d<a.length;d++){var e=a[d];if("MAIN"==e.type)for(var f=0;f<e.T.length;f++)if(e.T[f].name==b)return e.T[f]=c,!0}}return!1}function v(a,b){var c=a.C;if(c.length)for(var c=c[0].P,d=0;d<c.length;d++){var e=c[d];if("MAIN"==e.type)for(var f=0;f<e.T.length;f++){var g=e.T[f];
-1==ha.indexOf(g.source)&&-1==b.indexOf(g.name)&&b.push(g.name)}}}function z(a,b,c){var d=a.elements;a=a.interpolation;for(var e=0;e<b;e++){var f=e/(b-1),g=S(d,f,!0),k=C(d,f,!0);if(g&&k)if("CONSTANT"==a)c.push.apply(c,g.color);else{var h=c,l=g,m=k;l==m?h.push.apply(h,l.color):(h.push(la.qr(m.color[0],m.position,l.color[0],l.position,f)),h.push(la.qr(m.color[1],m.position,l.color[1],l.position,f)),h.push(la.qr(m.color[2],m.position,l.color[2],l.position,f)),h.push(la.qr(m.color[3],m.position,l.color[3],
l.position,f)))}k&&!g&&c.push.apply(c,k.color);g&&!k&&c.push.apply(c,g.color)}}function S(a,b,c){for(var d=null,e=0;e<a.length;e++){var f=c?b-a[e].position:b-a[e][1][0];0<=f&&(d?f<=(c?b-d.position:b-a[e][1][0])&&(d=a[e]):d=a[e])}return d}function C(a,b,c){for(var d=null,e=0;e<a.length;e++){var f=c?a[e].position-b:a[e][1][0]-b;0<=f&&(d?f<=(c?d.position-b:d[1][0]-b)&&(d=a[e]):d=a[e])}return d}function W(a,b){var c=a.texture,d=c.p,c=c.image;d&&b&&c&&B(d,b,c.Ce,c.filepath);return d}var F=p("__compat"),
K=p("__config"),X=p("__dds"),N=p("__debug"),L=p("__extensions"),P=p("__print"),da=p("__time"),U=p("__util"),ga=p("__renderer"),T=p("__obj_util"),la=p("__curve"),O=p("__vec3"),Q=K.v,Z=K.mi,ma=K.L,ra=null,ja=null,oa=null;a.Hd=0;a.G=0;a.TE=0;a.RE=0;a.SE=0;a.QE=0;a.uj=10;a.Pp=20;a.Zm=30;a.$m=40;a.il=50;a.Np=60;a.Lp=70;a.Op=80;a.Mp=90;a.qx=128;a.kD=128;a.Fx=128;var ha=["NONE","NODE_TEX","SSAO_TEXTURE"],ea={},ka={},I=null,Ia;a.Ve=function(b){Ia=[b.NEAREST_MIPMAP_NEAREST,b.NEAREST_MIPMAP_LINEAR,b.LINEAR_MIPMAP_NEAREST,
b.LINEAR_MIPMAP_LINEAR];a.Hd=b.NEAREST;a.G=b.LINEAR;a.TE=b.NEAREST_MIPMAP_NEAREST;a.RE=b.LINEAR_MIPMAP_NEAREST;a.SE=b.NEAREST_MIPMAP_LINEAR;a.QE=b.LINEAR_MIPMAP_LINEAR;I=b};a.yQ=function(a,b){return b in ea&&a in ea[b]?ea[b][a].Id:null};a.PR=function(a,c){return c in ea&&a in ea[c]?(b(ea[c][a]),!0):!1};a.Jn=function(b,c){var d=e();d.name=b;d.type=c;d.source="NONE";if(c==a.Np||c==a.Lp||c==a.Op||c==a.Mp)d.Wd=I.createRenderbuffer();else{var f=I.TEXTURE_2D,g=I.createTexture();I.bindTexture(f,g);I.texParameteri(f,
I.TEXTURE_MAG_FILTER,I.LINEAR);I.texParameteri(f,I.TEXTURE_MIN_FILTER,I.LINEAR);I.texParameteri(f,I.TEXTURE_WRAP_S,I.CLAMP_TO_EDGE);I.texParameteri(f,I.TEXTURE_WRAP_T,I.CLAMP_TO_EDGE);I.bindTexture(f,null);d.Ta=f;d.Wa=g}return d};a.eH=function(b){var c=I.createTexture(),d=I.TEXTURE_CUBE_MAP;I.bindTexture(d,c);I.texParameteri(d,I.TEXTURE_MAG_FILTER,I.LINEAR);I.texParameteri(d,I.TEXTURE_MIN_FILTER,I.LINEAR);I.texParameteri(d,I.TEXTURE_WRAP_S,I.CLAMP_TO_EDGE);I.texParameteri(d,I.TEXTURE_WRAP_T,I.CLAMP_TO_EDGE);
for(var f="TEXTURE_CUBE_MAP_POSITIVE_X TEXTURE_CUBE_MAP_NEGATIVE_X TEXTURE_CUBE_MAP_POSITIVE_Y TEXTURE_CUBE_MAP_NEGATIVE_Y TEXTURE_CUBE_MAP_POSITIVE_Z TEXTURE_CUBE_MAP_NEGATIVE_Z".split(" "),g=0;6>g;g++)I.texImage2D(I[f[g]],0,I.RGBA,b,b,0,I.RGBA,I.UNSIGNED_BYTE,null);I.bindTexture(d,null);d=e();d.name="CUBEMAP";d.type=a.uj;d.source="NONE";d.width=3*b;d.height=2*b;d.Gn=1;d.Wa=c;d.Ta=I.TEXTURE_CUBE_MAP;return d};a.jw=function(a,b,c){if(!w(a)){var d=a.Ta;I.bindTexture(d,a.Wa);b&&I.texParameteri(d,I.TEXTURE_MIN_FILTER,
b);c&&I.texParameteri(d,I.TEXTURE_MAG_FILTER,c);I.bindTexture(d,null)}};a.BQ=function(b){if(w(b))return{min:a.Hd,UK:a.Hd};var c=b.Ta;I.bindTexture(c,b.Wa);b=I.getTexParameter(c,I.TEXTURE_MIN_FILTER);var d=I.getTexParameter(c,I.TEXTURE_MAG_FILTER);I.bindTexture(c,null);return{min:b,UK:d}};a.resize=function(b,c,d){c=Math.max(c,Q.Vn?2:1);d=Math.max(d,Q.Vn?2:1);if(b.width!=c||b.height!=d){switch(b.type){case a.Np:I.bindRenderbuffer(I.RENDERBUFFER,b.Wd);I.renderbufferStorage(I.RENDERBUFFER,I.RGB565,c,
d);I.bindRenderbuffer(I.RENDERBUFFER,null);break;case a.Lp:I.bindRenderbuffer(I.RENDERBUFFER,b.Wd);I.renderbufferStorage(I.RENDERBUFFER,I.DEPTH_COMPONENT16,c,d);I.bindRenderbuffer(I.RENDERBUFFER,null);break;case a.Op:I.bindRenderbuffer(I.RENDERBUFFER,b.Wd);I.renderbufferStorageMultisample(I.RENDERBUFFER,Q.xc,I.RGBA8,c,d);I.bindRenderbuffer(I.RENDERBUFFER,null);break;case a.Mp:I.bindRenderbuffer(I.RENDERBUFFER,b.Wd);I.renderbufferStorageMultisample(I.RENDERBUFFER,Q.xc,I.DEPTH_COMPONENT24,c,d);I.bindRenderbuffer(I.RENDERBUFFER,
null);break;default:var e=b.Ta;I.bindTexture(e,b.Wa);var g=f(b),k=H(b),h=D(b);I.texImage2D(e,0,k,c,d,0,g,h,null);I.bindTexture(e,null)}c>Z.ec||d>Z.ec?U.q('Slink texture "'+b.name+'" has unsupported size: '+c+"x"+d+". Max available: "+Z.ec+"x"+Z.ec+"."):(b.width=c,b.height=d)}};a.ZH=c;a.NC=n;a.MC=h;a.Cs=B;a.mI=function(a){I.deleteTexture(a)};a.Pl=function(a){return a&&a.name&&(a.Wa||a.Wd)?!0:!1};a.Ol=w;a.$Q=function(b){return b.type==a.Zm||b.type==a.$m?!0:!1};a.SJ=function(b){var c=0;switch(b.type){case a.uj:case a.Pp:c=
4;break;case a.Zm:case a.$m:c=16;break;case a.il:c=3;break;case a.Np:case a.Lp:c=2;break;case a.Op:c=4*Q.xc;break;case a.Mp:c=3*Q.xc}return c};a.pJ=E;a.cleanup=function(){if(!Q.Yo)for(var a in ka)for(var b in ka[a])ka[a][b].sa.pause(),ka[a][b].sa.src="",ka[a][b].sa.load();ea={};ka={}};a.pause=function(){for(var a in ka)for(var b in ka[a]){var c=ka[a][b];x(c)&&(A(b,a),c.Om=!0)}};a.reset=function(){for(var a in ka)for(var b in ka[a])G(b,a),ka[a][b].Om=!1};a.play=function(a){for(var b in ka)for(var c in ka[b]){var d=
ka[b][c];if(!a||d.Om)y(c,b),d.Om=!1}};a.ex=function(a,b){return b in ka&&a in ka[b]?ka[b][a].Lm:!1};a.play_video=y;a.pause_video=A;a.reset_video=G;a.vM=function(a,b,c){c in ka&&a in ka[c]&&(a=ka[c][a],a.sa?a.sa.currentTime=b/a.Qf:a.Sc&&(a.Ih=b,h(a)))};a.bD=x;a.cD=function(a){return a.sa||a.Sc?a.sa?2<=a.sa.readyState:!0:0};a.ZC=function(a){return a.sa||a.Sc?a.sa?Math.round(a.sa.currentTime*a.Qf):a.Ih:0};a.aD=function(a){return a.sa||a.Sc?a.sa?a.tb:k(a,a.tb):0};a.MO=function(a){if(!a.sa&&!a.Sc)return 0;
var b=Math.min(a.si,a.Gi-a.tb);return a.sa?a.tb+b:k(a,a.tb+b)};a.fs=function(a,b){return Math.round(b*a.Wo*(da.Qc()/a.Qf))};a.$C=function(a){return Math.min(a.si,a.Gi-a.tb)};a.LO=k;a.wJ=function(a,b){var c=t(a,b);return c&&"CANVAS"==c.source?c.Id:null};a.ZN=function(a,c){var d=t(a,c);return d&&"CANVAS"==d.source?(b(d),!0):!1};a.get_texture_names=function(a){var b=[];if(T.Da(a))v(a,b);else{a=a.yr;for(var c=0;c<a.length;c++)v(a[c],b)}return b};a.ZM=function(a){for(var c={},d=0;d<a.length;d++){for(var f=
a[d].T,g=[],k=0;k<f.length;k++){var h=f[k];if("CANVAS"==h.source)if(h.name in c)h=c[h.name];else{var l=f[k],h=e();h.name=l.name;h.source="CANVAS";h.width=l.width;h.height=l.height;h.Xj=l.Xj;h.type=l.type;l=document.createElement("canvas");l.width=h.width;l.height=h.height;h.Id=l.getContext("2d");h.Ta=I.TEXTURE_2D;h.Wa=I.createTexture();I.bindTexture(I.TEXTURE_2D,h.Wa);h.Xj?I.texParameteri(I.TEXTURE_2D,I.TEXTURE_MIN_FILTER,Ia[Q.Em]):I.texParameteri(I.TEXTURE_2D,I.TEXTURE_MIN_FILTER,I.LINEAR);I.texParameteri(I.TEXTURE_2D,
I.TEXTURE_MAG_FILTER,I.LINEAR);I.bindTexture(I.TEXTURE_2D,null);l=h;l.Id.drawImage(f[k].Id.canvas,0,0);b(l);c[h.name]=h}g.push(h)}a[d].T=g}};a.cH=function(a,b){for(var c=[],d=0;d<a.length;d++)z(a[d].data.value.color_ramp,b,c);return new Uint8Array(c.map(function(a){return U.clamp(255*a,0,255)}))};a.gG=z;a.aI=function(a,b){for(var c=new Float32Array(3),d=new Float32Array(3),e=[],f=0;f<a.length;f++){for(var g=a[f].data.value,k=[],h=g.curve_mapping.curves_data,l=g.curve_mapping.curve_extend,m=g.curve_mapping.curves_handle_types,
g=0;g<h.length;g++){for(var n=l[g],u=h[g],t=[],v=m[g],q=0;q<u.length;q++)t.push([new Float32Array(3),new Float32Array(u[q].concat(0)),new Float32Array(3)]);la.Ft(t[0],null,t[1],v[0],v[0]);for(q=1;q<t.length-1;q++)la.Ft(t[q],t[q-1],t[q+1],v[q],v[q]);la.Ft(t[t.length-1],t[t.length-2],null,v[t.length-1],v[t.length-1]);if(2<t.length){if("AUTO"==v[0]){O.subtract(t[0][2],t[0][1],c);q=O.length(c);O.copy(t[1][0],d);d[0]<t[0][1][0]&&(d[0]=t[0][1][0]);O.subtract(d,t[0][1],d);var z=O.length(d);1E-8<z&&(O.scale(d,
q/z,d),O.add(t[0][1],d,t[0][2]),O.subtract(t[0][1],d,t[0][0]))}u=t.length-1;"AUTO"==v[0]&&(O.subtract(t[u][0],t[u][1],c),q=O.length(c),O.copy(t[u-1][2],d),d[0]>t[u][1][0]&&(d[0]=t[u][1][0]),O.subtract(d,t[u][1],d),z=O.length(d),1E-8<z&&(O.scale(d,q/z,d),O.add(t[u][1],d,t[u][0]),O.subtract(t[u][1],d,t[u][2])))}for(u=0;u<t.length-1;u++)la.WG(t[u][1],t[u][2],t[u+1][0],t[u+1][1]);u=[];3>=h.length?(q=Math.round(-b/2),v=Math.round(b/2)):(q=0,v=b);for(;q<v;q++){var z=q/(v-1),r=S(t,z,!1),x=C(t,z,!1);r&&x?
u.push(la.dy(z,r[1],r[2],x[0],x[1],.001)):x&&!r?"EXTRAPOLATED"==n?(z=x[1][0]==x[2][0]?x[1][1]:la.BA(z,x[1],x[2]),u.push(z)):u.push(x[1][1]):r&&!x&&("EXTRAPOLATED"==n?(z=r[0][0]==r[1][0]?r[1][1]:la.BA(z,r[0],r[1]),u.push(z)):u.push(r[1][1]))}k.push(u)}e.push(k)}c=[];for(q=0;q<e.length;q++)for(k=e[q],g=0;g<k[0].length;g++)3>=k.length?(d=U.clamp(127.5*(k[0][g]+1),0,255),f=U.clamp(127.5*(k[1][g]+1),0,255),h=U.clamp(127.5*(k[2][g]+1),0,255),u=255):(d=U.clamp(255*k[0][g],0,255),f=U.clamp(255*k[1][g],0,
255),h=U.clamp(255*k[2][g],0,255),u=U.clamp(255*k[3][g],0,255)),c.push(d,f,h,u);return new Uint8Array(c)};a.change_image=function(a,b,c){var d=t(a,b);if(d){if("WORLD"!=a.type){var f;f=e();f.name=d.name;f.type=d.type;f.source=d.source;f.dp=d.dp;f.width=d.width;f.height=d.height;f.Gn=d.Gn;f.tw=d.tw;f.kl=d.kl;f.Jh=d.Jh;f.Xj=d.Xj;f.Id=d.Id;f.Ta=d.Ta;f.Wa=d.Wa;f.Wd=d.Wd;f.tk=d.tk;f.hg=d.hg;f.sa=d.sa;f.Gi=d.Gi;f.Qf=d.Qf;f.la=d.la;f.tb=d.tb;f.si=d.si;f.uf=d.uf;f.bg=d.bg;f.Sc=d.Sc;f.Xo=d.Xo;f.Wo=d.Wo;f.Ih=
d.Ih;f.Zo=d.Zo;f.aj=d.aj;f.Om=d.Om;f.$w=d.$w;f.Sh=d.Sh;f.Lm=d.Lm;f.repeat=d.repeat;f.ld=d.ld;var g=f;I.bindTexture(d.Ta,d.Wa);var k=I.getTexParameter(d.Ta,I.TEXTURE_MAG_FILTER),h=I.getTexParameter(d.Ta,I.TEXTURE_MIN_FILTER),l=I.getTexParameter(d.Ta,I.TEXTURE_WRAP_S),d=I.getTexParameter(d.Ta,I.TEXTURE_WRAP_T);g.Wa=I.createTexture();I.bindTexture(g.Ta,g.Wa);I.texParameteri(g.Ta,I.TEXTURE_MAG_FILTER,k);I.texParameteri(g.Ta,I.TEXTURE_MIN_FILTER,h);I.texParameteri(g.Ta,I.TEXTURE_WRAP_S,l);I.texParameteri(g.Ta,
I.TEXTURE_WRAP_T,d);I.bindTexture(g.Ta,null);d=f;if(T.Da(a))u(a,b,d);else for(a=a.yr,g=0;g<a.length&&!u(a[g],b,d);g++);}else f=d;B(f,c,!1,c.src,0);return!0}return!1};a.Pc=W;a.Dz=function(a,b){var c={texture:E("NODE_TEX",null)};return W(c,{width:b,height:a.length/(4*b),data:a})};a.ZL=function(){I=null}};b4w.module.__assets=function(a,p){function e(){return H.hA()?p(H.Od.dq).data:null}function c(){var a={Qp:null,eF:function(b){switch(a.responseType){case "json":case "text":return b;case "arraybuffer":b=atob(b);for(var c=b.length,d=new Int8Array(c),e=0;e<c;e++)d[e]=b.charCodeAt(e);return d.buffer;default:return b}},status:0,readyState:0,response:"",responseType:"",onreadystatechange:null,overrideMimeType:function(){},addEventListener:function(){},open:function(b,c){a.Qp=c;a.readyState=1},send:function(){a.status=
404;a.readyState=4;var b=e();b&&a.Qp in b&&(a.status=200,b[a.Qp]&&(a.response=a.eF(b[a.Qp])));if("[object Function]"==={}.toString.call(a.onreadystatechange))a.onreadystatechange()}};return a}function b(b){for(var c=0,d=0;d<b.length;d++){var e=b[d];20===e.state&&c++;if(c>=x.bL)break;if(10===e.state)switch(e.state=20,c++,e.type){case a.AT_ARRAYBUFFER:n(e,"arraybuffer");break;case a.AT_JSON:n(e,"json");break;case a.AT_TEXT:n(e,"text");break;case a.AT_AUDIOBUFFER:h(e);break;case a.AT_IMAGE_ELEMENT:r(e);
break;case a.AT_AUDIO_ELEMENT:g(e);break;case a.yp:m(e);break;case a.xp:q(e);break;default:y.q("Wrong asset type: "+e.type)}}}function n(b,d){var f=e(),g=f&&b.url in f?new c:new XMLHttpRequest,f=null;if("GET"==b.qe)g.open("GET",b.url,!0);else if("POST"==b.qe)switch(g.open("POST",b.url,!0),b.Ti){case a.nx:f="text/plain";break;case a.mx:f="application/json"}if(b.Pi)for(var k in b.Pi)"Content-Type"==k?f=b.Pi[k]:g.setRequestHeader(k,b.Pi[k]);f&&g.setRequestHeader("Content-Type",f);"text"==d?(g.overrideMimeType("text/plain"),
g.responseType="text"):"json"==d?(g.overrideMimeType("application/json"),g.responseType="text"):g.responseType=d;g.onreadystatechange=function(){if(40!=b.state&&4==g.readyState){if(200==g.status||0==g.status){var a=g.response;if(a){if("json"==d&&"string"==typeof a)try{a=JSON.parse(a,b.tK)}catch(c){w.error(c+" (parsing JSON "+b.url+")");b.Cc(null,b.id,b.type,b.url,b.Kb);return}b.Cc(a,b.id,b.type,b.url,b.Kb)}else w.error("empty responce when trying to get "+b.url),b.Cc(null,b.id,b.type,b.url,b.Kb)}else w.error(g.status+
" when trying to get "+b.url),b.Cc(null,b.id,b.type,b.url,b.Kb);b.state=30}};g.addEventListener("progress",function(a){a.lengthComputable&&b.sB(a.loaded/a.total)},!1);g.send(b.Eh)}function h(a){"GET"!=a.qe&&y.q("Unsupported request type for audio buffer");var b=e(),d=b&&a.url in b?new c:new XMLHttpRequest;d.open("GET",a.url,!0);d.responseType="arraybuffer";d.onreadystatechange=function(){if(40!=a.state&&4==d.readyState)if(200==d.status||0==d.status){var b=d.response;b?E.lI(b,function(b){a.Cc(b,a.id,
a.type,a.url,a.Kb);a.state=30},function(){a.Cc(null,a.id,a.type,a.url,a.Kb);w.error("failed to decode "+a.url);a.state=30}):(a.Cc(null,a.id,a.type,a.url,a.Kb),w.error("empty responce when trying to get "+a.url),a.state=30)}else a.Cc(null,a.id,a.type,a.url,a.Kb),w.error(d.status+" when trying to get "+a.url),a.state=30};d.send(a.Eh)}function r(a){"GET"!=a.qe&&y.q("Unsupported request type for image element");var b=document.createElement("img");G.allow_cors&&(b.crossOrigin="Anonymous");b.onload=function(){40!=
a.state&&(a.Cc(b,a.id,a.type,a.url,a.Kb),a.state=30)};b.addEventListener("error",function(){40!=a.state&&(a.Cc(null,a.id,a.type,a.url,a.Kb),w.error("could not load image: "+a.url),a.state=30)},!1);var c=e();if(c&&a.url in c)if(c[a.url]){var f=d(a.url);b.src="data:"+f+";base64,"+c[a.url]}else D.is_ie11()?(c=document.createEvent("CustomEvent"),c.initCustomEvent("error",!1,!1,null)):c=new CustomEvent("error"),b.dispatchEvent(c);else b.src=a.url}function g(a){"GET"!=a.qe&&y.q("Unsupported request type for audio element");
var b=document.createElement("audio");G.allow_cors&&(b.crossOrigin="Anonymous");b.addEventListener("loadeddata",function(){40!=a.state&&(a.Cc(b,a.id,a.type,a.url,a.Kb),a.state=30)},!1);b.addEventListener("error",function(){40!=a.state&&(a.Cc(null,a.id,a.type,a.url,a.Kb),w.error("could not load sound: "+a.url),a.state=30)},!1);b.addEventListener("stalled",function(){40!=a.state&&(a.Cc(null,a.id,a.type,a.url,a.Kb),w.error("could not load sound: "+a.url),a.state=30)},!1);var c=e();if(c&&a.url in c)if(c[a.url]){var d=
l(a.url);b.src="data:"+d+";base64,"+c[a.url];40!=a.state&&(a.Cc(b,a.id,a.type,a.url,a.Kb),a.state=30)}else D.is_ie11()?(c=document.createEvent("CustomEvent"),c.initCustomEvent("error",!1,!1,null)):c=new CustomEvent("error"),b.dispatchEvent(c);else b.src=a.url,G.is_mobile_device&&b.load();G.qv&&(b.autoplay=!0,b.pause());setTimeout(function(){b.eN=1},5E3)}function m(a){function b(){40!=a.state&&(a.Cc(null,a.id,a.type,a.url),w.error("could not load video: "+a.url,a.Kb),a.state=30)}"GET"!=a.qe&&y.q("Unsupported request type for video element");
var c=document.createElement("video");c.muted=!0;if(G.allow_cors||G.is_mobile_device)c.crossOrigin="Anonymous";c.addEventListener("loadeddata",function(){c.removeEventListener("error",b,!1);40!=a.state&&(a.Cc(c,a.id,a.type,a.url,a.Kb),a.state=30)},!1);c.addEventListener("error",b,!1);var d=e();if(d&&a.url in d)if(d[a.url]){var g=f(a.url);c.src="data:"+g+";base64,"+d[a.url];40!=a.state&&c.addEventListener("loadeddata",function(){a.Cc(c,a.id,a.type,a.url,a.Kb);a.state=30},!1)}else D.is_ie11()?(d=document.createEvent("CustomEvent"),
d.initCustomEvent("error",!1,!1,null)):d=new CustomEvent("error"),c.dispatchEvent(d);else c.src=a.url,G.is_mobile_device&&c.load();G.qv&&(c.autoplay=!0,c.pause());setTimeout(function(){c.eN=1},1E4)}function q(b){function d(a){b.Cc(a,b.id,b.type,b.url,b.Kb);b.state=30}"GET"!=b.qe&&y.q("Unsupported request type for seq video element");var f=e(),g=f&&b.url in f?new c:new XMLHttpRequest;if(null==b.Ti&&null==b.Eh)g.open("GET",b.url,!0);else switch(g.open("POST",b.url,!0),b.Ti){case a.nx:g.setRequestHeader("Content-type",
"text/plain");break;case a.mx:g.setRequestHeader("Content-type","application/json")}g.responseType="arraybuffer";g.onreadystatechange=function(){if(40!=b.state&&4==g.readyState)if(200==g.status||0==g.status){var a=g.response;a?B(a,d):(b.Cc(null,b.id,b.type,b.url,b.Kb),w.error("empty responce when trying to get "+b.url),b.state=30)}else b.Cc(null,b.id,b.type,b.url,b.Kb),w.error(g.status+" when trying to get "+b.url),b.state=30};g.addEventListener("progress",function(a){a.lengthComputable&&b.sB(a.loaded/
a.total)},!1);g.send(b.Eh)}function B(a,b){for(var c=new Int32Array(a),d=new Int8Array(a),e=c[3],f={images:[],hy:[],Qf:c[4]},g=20,k=0;k<e;k++){var h=c[g/4],l=new Blob([d.subarray(g+4,g+4+h)],{type:"image/jpg"}),m=document.createElement("img");m.src=window.URL.createObjectURL(l);f.images.push(m);f.hy.push(l);g+=h+8-h%4}m.onload=function(){for(var a=0;a<f.images.length;a++)window.URL.revokeObjectURL(f.images[a].src);delete f.hy;b(f)}}function d(a){var b="image";switch(y.Eu(a).toLowerCase()){case "jpeg":case "jpg":b+=
"/jpeg";break;case "png":b+="/png"}return b}function l(a){var b="audio";switch(y.Eu(a).toLowerCase()){case "ogv":case "ogg":b+="/ogg";break;case "mp3":b+="/mpeg";break;case "m4v":case "mp4":b+="/mp4";break;case "webm":b+="/webm"}return b}function f(a){var b="video";switch(y.Eu(a).toLowerCase()){case "ogv":b+="/ogg";break;case "webm":b+="/webm";break;case "m4v":b+="/mp4"}return b}var H=p("__config"),D=p("__compat"),w=p("__print"),E=p("__sfx"),y=p("__util"),A=p("__version"),G=H.v,x=H.hf;a.AT_ARRAYBUFFER=
10;a.AT_JSON=20;a.AT_TEXT=30;a.AT_AUDIOBUFFER=40;a.AT_IMAGE_ELEMENT=50;a.AT_AUDIO_ELEMENT=60;a.yp=70;a.xp=80;a.mx=a.AT_JSON;a.nx=a.AT_TEXT;var k=[],t=0,M={};a.gp=function(a){a=a.split(".");var b=Array(2);b[0]=a.slice(0,-1).join(".");b[1]=String(a.slice(-1));return b};a.JQ=function(a){if(M[a])return M[a];var b=x.prevent_caching?a+A.timestamp():a,c=new XMLHttpRequest;c.overrideMimeType("text/plain");c.open("GET",b,!1);c.send(null);if(200==c.status||0==c.status){b=c.responseText;if(b.length)return M[a]=
b;y.q("Error XHR: responce is empty, GET "+a)}else y.q("Error XHR: "+c.status+", GET "+a)};a.cleanup=function(){for(var a=0;a<k.length;a++)k[a].state=40;k=[];t=0;M={}};a.enqueue=function(a,c,d,f,g){for(var h=0;h<a.length;h++){var l=a[h],l={id:l.id,type:l.type,url:l.url,qe:l.qe?l.qe:"GET",Ti:l.Ti?l.Ti:null,Pi:l.Pi?l.Pi:null,Eh:l.Eh?l.Eh:null,Kb:l.Kb?l.Kb:null,state:10,Cc:c||function(){},gB:d||function(){},sB:f||function(){},tK:g||null,hB:t};if(x.prevent_caching){var m=e();m&&l.url in m||(l.url+=A.timestamp())}k.push(l)}b(k);
t++};a.update=function(){b(k);for(var a=k,c=0,d=!0,e=0;e<a.length;e++){var f=a[e];f.hB===a[c].hB?30!==f.state&&(d=!1):(d&&(a[e-1].gB(),d=e-c,a.splice(c,d),e-=d),c=e,d=30===a[e].state?!0:!1);e===a.length-1&&d&&(a[e].gB(),a.splice(c))}};a.BG=function(a){return"png"==a||"jpg"==a||"jpeg"==a||"gif"==a||"bmp"==a||"dds"==a?!0:!1}};b4w.module.__loader=function(a,p){function e(b,e,f,g){var h=y,l=D.create(),m;for(m in e){var n=c(e[m]);(g&&n.Ub||!b&&n.mc)&&d(n);D.F(l,n)}for(m in e)for(n=e[m],n.name=m,b=0;b<n.H.length;b++)D.r(l,e[n.H[b]],n,null);e=c({name:"out",Eb:a.nD,Yb:function(a,b,c,d,e){b.mb&&(h.ww=!0);H(b)||(b.status=2);b.DA(b.id,!0);e(b,c);w.log("%cTHREAD "+b.id+": LOADED CALLBACK","color: #f0f;")},Vb:5});if(f)f=D.ko(l);else{m=D.clone(l);do{f=D.ko(m);n=[];for(b=0;b<f.length;b++){g=f[b];var q=D.Na(m,g);q.Mb&&n.push(g)}for(b=
0;b<n.length;b++)D.ag(m,n[b]);n.length&&D.Kt(m)}while(n.length)}D.F(l,e);for(b=0;b<f.length;b++)g=f[b],q=D.Na(l,g),e.H.push(q.name),D.r(l,q,e,null);return l}function c(a){a.Mb=a.Mb||!1;a.Eb||0===a.Eb||(a.Eb=a.Gd);a.H=a.H||[];a.qk=a.qk||!1;a.qw=a.qw||!1;a.Vb=a.Vb||0;a.Ub=a.Ub||!1;a.mc=a.mc||!1;a.status=0;a.iR=0;a.ev=0;a.un=a.un||null;return a}function b(a,b){for(var c=[],d=[],e=0;e<b.length;e++){var f=b[e];D.Na(a.Qg,f).qk&&(D.hj(a.Qg,f,function(d){var e=!0;D.Ug(a.Qg,d,function(a,b){if(!b.qk)return e=
!1,1});e&&-1==c.indexOf(d)&&-1==b.indexOf(d)&&c.push(d)}),d.push(e))}for(e=d.length-1;0<=e;e--)b.splice(d[e],1);return c}function n(a){function c(b,d){var e=D.Na(a.Qg,b),f=D.Na(a.Qg,d),g=f.Eb-e.Eb;0==g&&(g=e.Mb-f.Mb);return g}var d=[],e=a.Mh,f=!1;do{var g=b(a,e);d.push.apply(d,e);0<g.length&&(f=!0);e=g}while(0<g.length);f&&d.sort(c);a.Mh=d;return a.Mh.length}function h(a,b,c){if(b.qw)return b.qk=!0,g(a,b),!1;if(!b.Yb&&!b.hi&&!b.tn)return g(a,b),!1;if(0==b.status&&(b.status++,b.Yb))return b.Yb(c,a,
b,b.un,g,m),!0;if(1==b.status){if(b.hi)return b.hi(c,a,b,b.un,g,m),!0;b.status++}return 2==b.status&&(b.status++,b.tn)?(b.tn(c,a,b,b.un,g,m),!0):!1}function r(a){if(0==a.qs)return 100;var b=0;D.ma(a.Qg,function(c,d){a.do_not_load_resources&&d.Ub||(b+=d.ev*d.Vb)});return E.trunc(100*b/a.qs)}function g(a,b){b.qk=!0;b.status=3;q(a,b,1)}function m(a,b,c){1>c?q(a,b,c):b.status++}function q(a,b,c){var d=y;if(b.Yb||b.hi||b.tn)if(b.ev=c,b=r(a),a.Wy!=b||1==c)a.vw(b,performance.now()-a.xC),a.Wy=b,d.gv=!0}function B(a,
b){var c=null;D.ma(a.Qg,function(a,d){if(d.name==b)return c=d,1});return c}function d(a){a.qw=!0;a.ev=1}function l(a){a.vw=null;a.Rt=null;a.Qg=null;a.Mh=null}function f(){return 0==y.Sp}function H(a){return a&&(3==a.status||4==a.status)}var D=p("__graph"),w=p("__print"),E=p("__util");a.Gd=0;a.tj=1;a.nD=2;var y=null;a.Uz=function(){return y};a.vH=function(){var a={Tg:[],gu:0,Sp:0,ww:!1,gv:!1};return y=a};a.$H=function(a,b,c,d,f,g,h,l){var m=y,n=m.Tg.length,q={id:n,mb:0==n,status:0,yg:b,fy:"",DA:c||
function(){},CA:l||!1,SR:g,xC:0,Wy:0,qs:0,$v:!1,vw:d||function(){},Rt:f||function(){},Qg:null,Mh:null,Qu:!1,Ou:!1,Ru:!1};a=e(q.mb,a,g,h);q.Qg=a;b=[];c=D.QJ(a);for(d=0;d<c.length;d++)b.push(c[d]);q.Mh=b;D.ma(a,function(a,b){!(b.Yb||b.hi||b.tn)||q.do_not_load_resources&&b.Ub||(q.qs+=b.Vb)});m.Tg.push(q);m.Sp++;return q.id};a.lO=function(b){var c=y;if(c&&!f())if(c.gv)c.gv=!1;else{var d=performance.now();do{var e=c.Tg[c.gu],g=b[e.id];if(!H(e))if(0==e.status&&(e.status=1,e.xC=performance.now(),e.vw(0,
0)),n(e)){var m=e,q=m.Mh.length;do{var v=D.Na(m.Qg,m.Mh[0]),r=h(m,v,g);v.Eb==a.tj&&(m.$v=!0);v=m.Mh.shift();m.Mh.push(v);q--}while(!r&&0!=q)}else m=c,q=e,q.Rt(g,q),q.status=3,m.Sp--,l(q);c.ww&&(c.gu=(c.gu+1)%c.Tg.length);if(e.$v){e.$v=!1;break}}while(16>performance.now()-d)}};a.Kx=function(a){var b=y;a.Rt(null,a);a.status=3;b.Sp--;l(a);a.status=4;a.mb&&(b.ww=!0);a.DA(a.id,!1)};a.GR=m;a.ns=function(a,b){var c=B(a,b);null!==c&&d(c)};a.qk=f;a.DN=H;a.is_primary_loaded=function(a){var b=y;if(!b)return!1;
a|=0;return b.Tg[a]&&(3==b.Tg[a].status||2==b.Tg[a].status)};a.WJ=function(){w.error("Debug mode isn't enabled. Can not retrieve the graph.")};a.cleanup=function(){y=null}};b4w.module.__logic_nodes=function(a,p){function e(){return function(a,b,c,d){c=d[0];var e=d[1];d=d[2];if(-2==c.state){for(var f=0;f<c.es;f++)if(G.get_sensor_value(a,b,f))for(var g=0;g<c.ds.length;g++)if(c.ds[g]==f){e.zk==c.tC?(D.is_play(e.ja)&&(c.state=-1),d.Ye.Pe||(c.state=1,c.bp=c.rr[g])):(c.state=1,c.bp=c.rr[g]);return}c.state=0}}}function c(){return function(a,b,c,d){c=d[0];var e=d[1];d=d[2];for(var f=0;f<c.es;f++)if(G.get_sensor_value(a,b,f)&&f==c.IB){if(D.is_play(e.ja)&&e.zk==c.tC)c.state=-1;
else if(!d.Ye.Pe||c.W.no_wait)c.state=1;return}c.state=0}}function b(a,b){return{name:a.name,type:a.type,label:a.label,wa:a.slot_idx_order,bp:a.slot_idx_jump,la:a.frame_range[0],Ka:a.frame_range[1],YI:a.frame_range_mask?a.frame_range_mask[0]:!0,XI:a.frame_range_mask?a.frame_range_mask[1]:!0,state:-1,es:-1,IB:-1,tL:a.param_name,rL:a.operation,mute:a.mute,Sn:a.object,obj:null,Cb:null,Nb:null,Db:{},ff:a.anim_name,Xb:l.SLOT_0,vL:a.parse_json_vars,uL:a.parse_json_paths,cd:a.objects_paths,WA:a.nodes_paths,
bc:a.floats,W:a.bools,da:a.variables,Nh:a.strings,hv:a.materials_names,QB:a.shader_nd_type,Ge:a.common_usage_names,CI:a.encode_json_vars,BI:a.encode_json_paths,tC:b,rB:la[a.type]?la[a.type]:g,Xr:!1,ws:0,ds:null,KK:a.links,rr:[]}}function n(a,b,c){return a[0]?b[a[1]]:c[a[1]]}function h(a,b,c,d){a[0]?b[a[1]]=d:c[a[1]]=d}function r(a,b,c){switch(b.state){case 2:c.ea=a.wa}}function g(a,b,c){switch(b.state){case 1:E.error("Unknown node type: "+a.type);break;case 2:c.ea=a.wa}}function m(a){return w.wc(w.Vc,
a.Sn||[],0)}function q(a,c){var d=a.b4w_logic_nodes,e=c.Ad;c.state=1;for(var f=0;f<d.length;f++){var g={N:[],Ye:{Ra:a,ea:0,Pe:!1,Lw:f,B:{R1:0,R2:0,R3:0,R4:0,R5:0,R6:0,R7:0,R8:0}}};e.push(g);for(var k=e[e.length-1],h=d[f],l=0;l<h.length;l++){var m=b(h[l],k);k.N.push(m)}for(h=0;h<k.N.length;h++)m=k.N[h],m.rB(m,c,g.Ye,0,0)}var d=a.timeline_markers,n;for(n in d)c.cp.push(d[n]);c.cp.sort(function(a,b){return a-b});c.state=2;X.push(c)}function B(a,b){switch(b){case 0:return Boolean(Number(a))?Number(a):
0;case 1:return String(a);default:return null}}function d(a){switch(typeof a){case "string":return B(a,1);case "number":return B(a,0);default:return B(a,1)}}var l=p("__animation"),f=p("__assets"),H=p("__camera"),D=p("__nla"),w=p("__objects"),E=p("__print"),y=p("__scenes"),A=p("__config"),G=p("__controls"),x=p("__batch"),k=p("__geometry"),t=p("__mat3"),M=p("__mat4"),u=p("__physics"),v=p("__quat"),z=p("__sfx"),S=p("__time"),C=p("__transform"),W=p("__tsr"),F=p("__util"),K=p("__vec3"),X=[],N={},L=new Float32Array(4);
new Float32Array(4);var P=new Float32Array(3),da=new Float32Array(3),U=new Float32Array(2),ga=new Float32Array(9),T=new Float32Array(16);a.SD=0;a.TD=1;a.wx=0;a.yx=1;a.xx=2;a.zx=3;a.Ax=4;a.vx=5;a.ND=0;a.OD=1;var la={ENTRYPOINT:function(a,b,c){switch(b.state){case 2:c.ea=a.wa}},HIDE:function(a,b,c){switch(b.state){case 1:a.obj=m(a);break;case 2:y.vn(a.obj,!0),c.ea=a.wa}},SHOW:function(a,b,c){switch(b.state){case 1:a.obj=m(a);break;case 2:y.vn(a.obj,!1),c.ea=a.wa}},PAGEPARAM:function(a,b,c){switch(b.state){case 2:var d=
a.da.vd;b=b.B;var e=c.B,f;a:{f=a.tL;var g=a.bc.ptp,k=a.W.hsh,l=A.get("url_params");if(l&&f in l)f=Number(l[f]);else{if(k=k?location.hash:location.search)for(k=k.slice(1).split("&"),l=0;l<k.length;l++){var m=k[l].split("=");if(1<m.length&&m[0]==f){f=B(m[1],g);break a}}f=0}}h(d,b,e,f);c.ea=a.wa}},SWITCH_SELECT:function(a,b,c){switch(b.state){case 1:a:{c=b.Ad[c.Lw];var d=w.get_selectable_objects();a.ds=[];a.rr=[];for(var f in a.cd){var g=w.wc(w.Vc,a.cd[f],0),k=d.indexOf(g);if(-1==k){E.error("logic script error: non-selectable object:",
a.cd[f][a.cd[f].length-1]);break a}a.ds.push(k);a.rr.push(a.KK[f])}a.state=-1;a.es=d.length;f=[];for(k=0;k<d.length;k++)f.push(G.create_selection_sensor(d[k],!1));G.create_sensor_manifold(g,"LOGIC_NODES_SWITCH_SELECT_"+a.label,G.CT_SHOT,f,G.$y,e(),[a,b,c])}break;case 2:if(-1==a.state){b=b.Ad[c.Lw].N;for(g=0;g<b.length;g++)d=b[g],"SWITCH_SELECT"==d.type&&(d.state=-1);a.state=-2}-1<a.state&&(c.ea=a.state?a.bp:a.wa,a.state=-1)}},SELECT:function(a,b,d){switch(b.state){case 1:d=b.Ad[d.Lw];var e=m(a),f=
w.get_selectable_objects(),g=f.indexOf(e);if(-1==g)E.error("logic script error: non-selectable object:",a.Sn[a.Sn.length-1]);else{a.state=-1;a.es=f.length;a.IB=g;for(var g=[],k=0;k<f.length;k++)g.push(G.create_selection_sensor(f[k],!1));G.create_sensor_manifold(e,"LOGIC_NODES_SELECT_"+a.label,G.CT_SHOT,g,G.$y,c(),[a,b,d])}break;case 2:if(-1<a.state){d.ea=a.state?a.bp:a.wa;a.state=-1;break}a.W.not_wait&&(d.ea=a.wa)}},PLAY:function(a,b,c,d){switch(b.state){case 1:D.xw();a.state=-1;a.W.not_wait||(a.W.not_wait=
!1);break;case 2:switch(a.state){case -1:if(D.is_play(b.ja))if(b.eu==b.zk&&c.Pe)break;else{var e=b.zk;if(e){e.Ye.ea=e.N[e.Ye.ea].wa;e.N[e.Ye.ea].state=-1;for(var e=b.zk.N,f=0;f<e.length;f++){var g=e[f];"PLAY"==g.type&&(g.state=-1)}}}c.Pe=!a.W.not_wait;b.zk=b.eu;a.state=0;a.YI&&(D.KM(a.la),D.KB(d));if(a.XI)D.kw(a.Ka);else{d=D.get_frame(d);var e=-1,k;for(k in b.cp)if(d<b.cp[k]){e=k;break}0<=e?D.kw(b.cp[e]):D.kw(D.get_frame_end())}D.mB(null);a.W.not_wait&&(c.ea=a.wa,a.state=-1,c.Pe=!1);break;case 0:D.is_play()||
(c.ea=a.wa,a.state=-1,c.Pe=!1);break;case 1:c.ea=a.wa;a.state=-1;b.zk=null;c.Pe=!1;break;default:F.q("Unknown state of "+a.name),a.state=-1}}},REDIRECT:function(a,b,c){switch(b.state){case 2:window.location.href=a.W.url?B(n(a.da.url,b.B,c.B),1):a.Nh.url,b.state=3}},MATH:function(a,b,c){switch(b.state){case 2:var d=-1==a.da.v1[1]?a.bc.inp1:B(n(a.da.v1,b.B,c.B),0),e=-1==a.da.v2[1]?a.bc.inp2:B(n(a.da.v2,b.B,c.B),0),f=0;switch(a.rL){case "ADD":f=d+e;break;case "MUL":f=d*e;break;case "SUB":f=d-e;break;
case "DIV":0==e&&F.q("Division by zero in Logic script");f=d/e;break;case "RAND":f=Math.random()*(e-d)+d}h(a.da.vd,b.B,c.B,f);c.ea=a.wa}},CONDJUMP:function(a,b,c){switch(b.state){case 2:var d=a.W.str?1:0,e=a.W.str?a.Nh:a.bc,f=-1==a.da.v1[1]?e.inp1:B(n(a.da.v1,b.B,c.B),d);b=-1==a.da.v2[1]?e.inp2:B(n(a.da.v2,b.B,c.B),d);d=!1;switch(a.Ge.condition){case 5:f==b&&(d=!0);break;case 4:f!=b&&(d=!0);break;case 3:f<b&&(d=!0);break;case 2:f>b&&(d=!0);break;case 1:f<=b&&(d=!0);break;case 0:f>=b&&(d=!0)}c.ea=
d?a.bp:a.wa}},REGSTORE:function(a,b,c){switch(b.state){case 2:h([a.W.gl||a.da.vd[0],a.da.vd[1]],b.B,c.B,(1==a.Ge.variable_type?a.Nh:a.bc).inp1),c.ea=a.wa}},PLAY_ANIM:function(a,b,c){switch(b.state){case 1:a.obj=a.W.env?w.get_world_by_name(a.Sn[0],0):m(a);break;case 2:switch(0!=a.state||l.is_play(a.obj,a.Xb)||(a.state=1),a.state){case -1:for(var d in b.Ad){var e=b.Ad[d].Ye.ea;-1!=e&&(e=b.Ad[d].N[e],"PLAY_ANIM"==e.type&&e!=a&&0==e.state&&e.obj==a.obj&&(e.state=1))}b=a.Ge.param_anim_behavior;if(""==
a.ff)l.apply_def(a.obj),l.set_behavior(a.obj,b,a.Xb);else{a:{for(e=d=0;8>e;e++){var f=a.obj.X[e];if(f&&f.dh&&f.dh==a.ff)if(0==d)d=1;else{d=!1;break a}}d=1==d?!0:!1}d||(a.Xb=l.bN(a.obj,a.ff),l.apply(a.obj,null,a.ff,a.Xb),l.set_behavior(a.obj,b,a.Xb))}a.W.not_wait||(c.Pe=!0);l.play(a.obj,null,a.Xb);a.state=0;a.W.not_wait&&(c.ea=a.wa,a.state=-1);break;case 0:break;case 1:a.W.not_wait||(c.Pe=!1);c.ea=a.wa;a.state=-1;break;default:F.q("Unknown state of "+a.name),a.state=-1}}},SELECT_PLAY:r,SEND_REQ:function(a,
b,c){function d(a,e,f,g,k){a=JSON.stringify(a);h(k[0].da.dst,b.B,c.B,a);k[0].state=1}switch(b.state){case 2:switch(a.state){case -1:a.state=0;var e=a.W.url?B(n(a.da.url,b.B,c.B),1):a.Nh.url,g={};a.W.ct&&(g["Content-Type"]=a.Nh.ct);"GET"==a.Ge.request_type?f.enqueue([{id:e,type:f.AT_JSON,url:e,Pi:g,Kb:[a,c.B]}],d,null,null,null):"POST"==a.Ge.request_type&&f.enqueue([{id:e,type:f.AT_JSON,url:e,Pi:g,qe:"POST",Ti:f.AT_JSON,Eh:B(n(a.da.dst1,b.B,c.B),1),Kb:[a,c.B]}],d,null,null,null);break;case 1:a.state=
-1,c.ea=a.wa}}},INHERIT_MAT:function(a,b,c){switch(b.state){case 1:for(b=0;2>b;b++)a.Db["id"+b]=w.wc(w.Vc,a.cd["id"+b],0);break;case 2:x.inherit_material(a.Db.id0,a.hv.id0,a.Db.id1,a.hv.id1),c.ea=a.wa}},SET_SHADER_NODE_PARAM:function(a,b,c){switch(b.state){case 1:a.cd.id0&&(a.Db.id0=w.wc(w.Vc,a.cd.id0,0),a.WA.id0.unshift(a.hv.id0));break;case 2:var d=a.Db.id0,e=a.WA.id0,f=e[0],g=x.Ma(d,f,"MAIN");c.ea=a.wa;if(null===g){E.error('Material "'+f+'" was not found in the object "'+d.name+'".');break}if("ShaderNodeRGB"==
a.QB){var k=x.Il(g.Vf,e);x.set_nodemat_rgb(d,f,k,a.W.id0?B(n(a.da.id0,b.B,c.B),0):a.bc.id0,a.W.id1?B(n(a.da.id1,b.B,c.B),0):a.bc.id1,a.W.id2?B(n(a.da.id2,b.B,c.B),0):a.bc.id2)}"ShaderNodeValue"==a.QB&&(k=x.Il(g.Wf,e),x.set_nodemat_value(d,f,k,a.W.id0?B(n(a.da.id0,b.B,c.B),0):a.bc.id0))}},DELAY:function(a,b,c,d,e){switch(b.state){case 2:-1==a.state?(a.state=0,a.ws=0,c.Pe=!0):0==a.state&&(a.ws+=e,(a.W.dl?B(n(a.da.dl,b.B,c.B),0):a.bc.dl)<a.ws&&(a.state=-1,c.ea=a.wa,c.Pe=!1))}},APPLY_SHAPE_KEY:function(a,
b,c){switch(b.state){case 1:b=a.Db.id0=w.wc(w.Vc,a.cd.id0,0);c=a.Ge.sk;k.check_shape_keys(b)?k.Pu(b,c)||(E.error("Wrong key name:",c),a.mute=!0):(E.error("No shape keys in object:",b.name),a.mute=!0);break;case 2:k.Ux(a.Db.id0,a.Ge.sk,a.W.skv?B(n(a.da.skv,b.B,c.B),0):a.bc.skv),c.ea=a.wa}},OUTLINE:function(a,b,c){switch(b.state){case 1:var d=a.Db.id0=w.wc(w.Vc,a.cd.id0,0);d&&d.k&&d.k.fc||(E.error("Can't evaluate 'Outline' logic node: wrong object"),a.mute=!0);break;case 2:d=a.Db.id0;switch(a.Ge.outline_operation){case "PLAY":b=
d.k.xf;w.apply_outline_anim(d,b.Mi,b.Ni,b.Oi);break;case "STOP":w.clear_outline_anim(d);break;case "INTENSITY":d.k.Yf=a.W["in"]?B(n(a.da["in"],b.B,c.B),0):a.bc["in"]}c.ea=a.wa}},MOVE_CAMERA:function(a,b,c){function d(a,b,c,e){switch(H.get_move_style(a)){case H.MS_TARGET_CONTROLS:H.set_trans_pivot(a,b,c);break;case H.MS_EYE_CONTROLS:case H.MS_STATIC:C.set_tsr(a,e);break;case H.MS_HOVER_CONTROLS:K.sub(c,b,P),K.normalize(P,P),H.set_hover_pivot(a,c),c=b=0,da[0]=P[0],da[1]=0,da[2]=P[2],b=K.dot(da,P),c=
Math.acos(b/(K.length(da)*K.length(P))),b=P[2]?Math.atan(P[0]/P[2]):0<P[0]?0:Math.PI,0<P[2]&&0<P[0]?U[1]=-(Math.PI+U[1]):0<P[2]&&0>P[0]?U[1]=-(Math.PI+U[1]):0>P[2]&&0>P[0]?(U[0]+=Math.PI,b=-(Math.PI-b)):0>P[2]&&0<P[0]&&(U[0]+=Math.PI,b-=Math.PI),H.rotate_hover_camera(a,b+Math.PI,-c,!0,!0)}C.u(a);u.sync_transform(a)}function e(a,b,c,d){M.lookAt(b,c,F.AXIS_Y,T);M.invert(T,T);M.rotateX(T,Math.PI/2,T);t.fromMat4(T,ga);v.fromMat3(ga,L);v.normalize(L,L);a=W.get_scale(a.k.m);W.set_sep(b,a,L,d)}switch(b.state){case 1:a.Db.ca=
w.wc(w.Vc,a.cd.id0,0);a.Db.tr=w.wc(w.Vc,a.cd.id1,0);a.Db.ta=w.wc(w.Vc,a.cd.id2,0);a.state=-1;a.Nb={CC:new Float32Array(3),BC:new Float32Array(3),Wu:new Float32Array(3),Iw:new Float32Array(3),sC:new Float32Array(3),Vu:new Float32Array(3),jj:new Float32Array(8),Vg:new Float32Array(8),qo:new Float32Array(8)};break;case 2:var f=a.Db.ca,g=W.get_trans_view(a.Db.tr.k.m),k=W.get_trans_view(a.Db.ta.k.m);switch(a.state){case -1:b=a.W.dur?B(n(a.da.dur,b.B,c.B),0):a.bc.dur;if(0==b){e(f,g,k,a.Nb.Vg);d(f,g,k,a.Nb.Vg);
c.ea=a.wa;break}c=W.get_trans_view(f.k.m);K.copy(c,a.Nb.CC);var h=H.get_move_style(f);h==H.MS_HOVER_CONTROLS?K.copy(f.k.ub,a.Nb.Iw):h==H.MS_STATIC||h==H.MS_EYE_CONTROLS?(W.copy(f.k.m,a.Nb.jj),e(f,g,k,a.Nb.Vg)):K.copy(f.k.pivot,a.Nb.Iw);K.copy(g,a.Nb.BC);K.copy(k,a.Nb.sC);a.state=0;var l=S.animate(0,1,1E3*b,function(b){y.ya()&&(h==H.MS_STATIC||h==H.MS_EYE_CONTROLS?W.interpolate(a.Nb.jj,a.Nb.Vg,F.smooth_step(b),a.Nb.qo):(a.Nb.Vu=K.lerp(a.Nb.Iw,a.Nb.sC,F.smooth_step(b),a.Nb.Vu),a.Nb.Wu=K.lerp(a.Nb.CC,
a.Nb.BC,F.smooth_step(b),a.Nb.Wu)),d(f,a.Nb.Wu,a.Nb.Vu,a.Nb.qo),1==b&&(a.state=1))});break;case 1:S.clear_animation(l),a.state=-1,c.ea=a.wa}}},SET_CAMERA_MOVE_STYLE:function(a,b,c){switch(b.state){case 2:b=y.gk(c.Ra),C.u(b),u.sync_transform(b),c.ea=a.wa}},MOVE_TO:function(a,b,c){function d(a,b){C.set_tsr(a,b);C.u(a);u.sync_transform(a)}switch(b.state){case 1:a.Db.ob=w.wc(w.Vc,a.cd.id0,0);a.Db.de=w.wc(w.Vc,a.cd.id1,0);a.state=-1;a.Cb={ez:new Float32Array(8),lu:new Float32Array(8),fA:new Float32Array(8)};
break;case 2:var e=a.Db.ob;W.copy(a.Db.ob.k.m,a.Cb.ez);W.copy(a.Db.de.k.m,a.Cb.lu);switch(a.state){case -1:b=a.W.dur?B(n(a.da.dur,b.B,c.B),0):a.bc.dur;if(0==b){d(e,a.Cb.lu);c.ea=a.wa;break}a.state=0;var f=S.animate(0,1,1E3*b,function(b){y.ya()&&(a.Cb.WQ=W.interpolate(a.Cb.ez,a.Cb.lu,F.smooth_step(b),a.Cb.fA),d(e,a.Cb.fA),1==b&&(a.state=1))});break;case 1:S.clear_animation(f),a.state=-1,c.ea=a.wa}}},TRANSFORM_OBJECT:function(a,b,c){function d(a,b,c){0==c?C.set_tsr(a,b):C.set_tsr_rel(a,b);C.u(a);u.sync_transform(a)}
switch(b.state){case 1:a.Db.ob=w.wc(w.Vc,a.cd.id0,0);a.state=-1;a.Cb={ps:0,jj:new Float32Array(8),Vg:new Float32Array(8),qo:new Float32Array(8)};break;case 2:var e=a.Db.ob;switch(a.state){case -1:da[0]=a.W.trx?B(n(a.da.trx,b.B,c.B),0):a.bc.trx;da[1]=a.W["try"]?B(n(a.da["try"],b.B,c.B),0):a.bc["try"];da[2]=a.W.trz?B(n(a.da.trz,b.B,c.B),0):a.bc.trz;P[0]=a.W.rox?B(n(a.da.rox,b.B,c.B),0):a.bc.rox;P[1]=a.W.roy?B(n(a.da.roy,b.B,c.B),0):a.bc.roy;P[2]=a.W.roz?B(n(a.da.roz,b.B,c.B),0):a.bc.roz;var f=a.W.sc?
n(a.da.sc,b.B,c.B):a.bc.sc;if(a.W["try"]||a.W.trz)U[1]=-da[1],da[1]=da[2],da[2]=U[1];if(a.W.roy||a.W.roz)U[1]=-P[1],P[1]=P[2],P[2]=U[1];F.euler_to_quat(P,L);W.set_sep(da,f,L,a.Cb.Vg);a.Cb.ps=a.Ge.space_type;switch(a.Cb.ps){case 0:C.get_tsr(e,a.Cb.jj);break;case 1:C.get_tsr_rel(e,a.Cb.jj);break;case 2:C.get_tsr_rel(e,a.Cb.jj),W.multiply(a.Cb.jj,a.Cb.Vg,a.Cb.Vg)}b=a.W.dur?B(n(a.da.dur,b.B,c.B),0):a.bc.dur;if(0==b){d(e,a.Cb.Vg,a.Cb.ps);c.ea=a.wa;break}a.state=0;f=S.animate(0,1,1E3*b,function(b){y.ya()&&
(W.interpolate(a.Cb.jj,a.Cb.Vg,F.smooth_step(b),a.Cb.qo),d(e,a.Cb.qo,a.Cb.ps),1==b&&(a.state=1))});break;case 1:S.clear_animation(f),a.state=-1,c.ea=a.wa}}},SPEAKER_PLAY:function(a,b,c){switch(b.state){case 1:a.obj=w.wc(w.Vc,a.cd.id0,0);void 0==a.W.not_wait&&(a.W.not_wait=!0);break;case 2:switch(z.is_playing(a.obj)||0!=a.state||(a.state=1),a.state){case -1:for(var d in b.Ad){var e=b.Ad[d].Ye.ea;-1!=e&&(e=b.Ad[d].N[e],"SPEAKER_PLAY"==e.type&&e!=a&&0==e.state&&e.obj==a.obj&&(e.state=1))}a.W.not_wait||
(c.Pe=!0);z.play_def(a.obj);a.state=0;break;case 0:a.W.not_wait&&(c.ea=a.wa,a.state=-1);break;case 1:a.W.not_wait||(c.Pe=!1);c.ea=a.wa;a.state=-1;break;default:F.q("Unknown state of "+a.name),a.state=-1}}},SPEAKER_STOP:function(a,b,c){switch(b.state){case 1:a.obj=w.wc(w.Vc,a.cd.id0,0);break;case 2:z.stop(a.obj),c.ea=a.wa}},STOP_ANIM:function(a,b,c){switch(b.state){case 1:a.obj=a.W.env?w.get_world_by_name(a.Sn[0],0):m(a);break;case 2:l.stop(a.obj,l.SLOT_ALL),a.W.rst&&l.set_first_frame(a.obj,l.SLOT_ALL),
c.ea=a.wa}},STOP_TIMELINE:function(a,b,c,d){switch(b.state){case 2:a.W.rst&&D.KB(d),D.xw(),c.ea=a.wa}},CONSOLE_PRINT:function(a,b,c){switch(b.state){case 2:var d={},e;for(e in a.da)d[a.da[e][1]]=n(a.da[e],b.B,c.B);E.log(a.Ge.msg,JSON.stringify(d));c.ea=a.wa}},STRING:function(a,b,c){switch(b.state){case 2:var d=a.W.id0?B(n(a.da.id0,b.B,c.B),1):a.Nh.id0,e=a.W.id1?B(n(a.da.id1,b.B,c.B),1):a.Nh.id1,f=0;switch(a.bc.sop){case 0:f=d+e;break;case 1:f=d.indexOf(e);break;case 2:f=d.replace(e,a.W.id2?B(n(a.da.id2,
b.B,c.B),1):a.Nh.id2);break;case 3:f=d.substring(0,d.indexOf(e));h(a.da.dst1,b.B,c.B,d.substring(d.indexOf(e)+1,d.length));""==n(vars.dst,b.B,c.B)&&(f=n(vars.dst1,b.B,c.B),h(vars.dst1,b.B,c.B,""));break;case 4:switch(a.Ge.condition){case 5:f=d==e?1:0;break;case 4:f=d!=e?1:0;break;case 3:f=d<e?1:0;break;case 2:f=d>e?1:0;break;case 1:f=d<=e?1:0;break;case 0:f=d>=e?1:0}}h(a.da.dst,b.B,c.B,f);c.ea=a.wa}},GET_TIMELINE:function(a,b,c,d){switch(b.state){case 2:d=a.W.nla?B(D.get_frame(d),0):B(S.get_frame(d),
0),h(a.da.vd,b.B,c.B,d),c.ea=a.wa}},JSON:function(a,b,c){function e(a,b,c,f){for(var g=0;g<b.length;g++){for(var k=b[g].split("."),h=a,l=c[g],m=0;m<k.length&&(h=h[k[m]],void 0!==h&&null!==h);m++);h=d(h);f[l]=h}}function f(a,b,c,e){e||(e={});for(var g=0;g<b.length;g++){var k=b[g].split("."),h=e,l=c[g];if(!(!l in a)){for(var m=0;m<k.length-1;m++)void 0===h[k[m]]&&(h[k[m]]=isNaN(k[m+1])?{}:[]),h=h[k[m]];h[k[k.length-1]]=d(a[l])}}}switch(b.state){case 2:switch(a.Ge.json_operation){case "PARSE":try{var g=
JSON.parse(B(n(a.da.jsn,b.B,c.B),1));e(g,a.uL,a.vL,c.B)}catch(k){E.error("logic script error: non valid JSON string")}break;case "ENCODE":g={},f(c.B,a.BI,a.CI,g),g=B(JSON.stringify(g),1),h(a.da.jsn,b.B,c.B,g)}c.ea=a.wa}},JS_CALLBACK:function(a,b,c){switch(b.state){case 2:for(var e=a.W.cb?B(n(a.da.cb,b.B,c.B),1):a.Nh.cb,f=[],g=0,k="id"+g,l=a.Ge.js_cb_params;k in l;)k=0==l[k]?w.wc(w.Vc,a.cd[k],0):n(a.da[k],b.B,c.B),f.push(k),g++,k="id"+g;l=[];g=0;for(k="out"+g;k in a.da;)k=n(a.da[k],b.B,c.B),l.push(k),
g++,k="out"+g;if(e in N)for(N[e](f,l),e=0;e<l.length;e++)k="out"+e,k in a.da&&h(a.da[k],b.B,c.B,d(l[e]));else E.error("logic script error: no custom callback with id "+e);c.ea=a.wa}},EMPTY:r};a.dK=function(a,b){var c={ud:b,GB:a.name,state:0,zk:null,Ra:a,eu:null,Ad:[],cp:[],B:{}};a.CP=c;q(a,c)};a.update=function(a,b){var c=D.RJ();if(!(0>=c))for(var d=0;d<X.length;d++)for(var e=d,f=a,g=b,k=c,h=X[e],l=0;l<X[e].Ad.length;l++){h.eu=X[e].Ad[l];var m=X[e].Ad[l],n=h,t=f,q=g,J=k,v=m.N;if(v.length){for(var u=
0;u<v.length;u++)v[u].Xr=!1;for(u=0;u<v.length;u++){if(0<=m.Ye.ea)var r=v[m.Ye.ea];else break;if(r.Xr)break;if(r.mute)if("ENTRYPOINT"==r.type)break;else m.Ye.ea=r.wa,r.Xr=!0;else r.rB(r,n,m.Ye,t,q,J),r.Xr=!0}}}};a.nF=function(a,b){N[a]=b};a.NL=function(a){delete N[a]};a.dM=function(a,b){for(var c=0;c<X.length;c++)if(X[c].GB==a){for(var c=X[c],d=0;d<c.Ad.length;d++){var e=c.Ad[d].N[0];if(e.name==b){e.W.js&&(e.mute=!1);c.Ad[d].Ye.ea=0;break}}break}};a.cleanup=function(){X.length=0;N={}}};b4w.module.__math=function(a,p){function e(a,b){for(var c=a[1],e=1,g=2;g<a.length;g++)4!=g&&8!=g&&Math.abs(a[g])>Math.abs(c)&&(c=a[g],e=g);for(var h=Math.floor(e/3),e=e%3,c=.5*Math.atan(2*c/(a[3*h+h]-a[3*e+e])),g=0;g<b.length;g++)b[g]=0==g||4==g||8==g?1:0;b[e+3*h]=-Math.sin(c);b[h+3*e]=Math.sin(c);b[h+3*h]=Math.cos(c);b[e+3*e]=Math.cos(c);return b}function c(a){return Math.sqrt(a[1]*a[1]+a[2]*a[2]+a[5]*a[5])}var b=p("__mat3"),n=p("__vec3"),h=new Float32Array(3),r=new Float32Array(9),g=new Float32Array(9),
m=new Float32Array(9),q=new Float32Array(9);a.get_pline_directional_vec=function(a,b){b=b||new Float32Array(3);b[0]=a[3];b[1]=a[4];b[2]=a[5];return b};a.get_pline_initial_point=function(a,b){b=b||new Float32Array(3);return n.copy(a,b)};a.set_pline_initial_point=function(a,b){n.copy(b,a)};a.set_pline_directional_vec=function(a,b){n.normalize(b,h);a[3]=h[0];a[4]=h[1];a[5]=h[2]};a.calc_pline_point=function(a,b,c){c=c||new Float32Array(3);c[0]=a[0]+a[3]*b;c[1]=a[1]+a[4]*b;c[2]=a[2]+a[5]*b};a.lG=function(a,
b){for(var c=0;c<a.length;c+=3)b[0]+=a[c],b[1]+=a[c+1],b[2]+=a[c+2];return n.scale(b,3/a.length,b)};a.hG=function(a,b,c){for(var e=0;e<c.length;e++)c[e]=0;for(e=0;e<a.length;e+=3){var g=a[e]-b[0],h=a[e+1]-b[1],m=a[e+2]-b[2];c[0]+=g*g;c[1]+=g*h;c[2]+=g*m;c[4]+=h*h;c[5]+=h*m;c[8]+=m*m}c[3]=c[1];c[6]=c[2];c[7]=c[5];for(e=0;e<c.length;e++)c[e]*=3/a.length;return c};a.QI=function(a,d){var h=b.copy(a,r);if(5E-4>c(h))return b.identity(d);var f=e(h,g),n=b.transpose(f,m);b.multiply(h,n,q);b.multiply(f,q,h);
for(var p=b.copy(f,d),w=1;5E-4<=c(h)&&100>w;)f=e(h,g),n=b.transpose(f,m),b.multiply(h,n,q),b.multiply(f,q,h),b.multiply(f,p,p),w++;return p};a.point_plane_dist=function(a,b){return b[0]*a[0]+b[1]*a[1]+b[2]*a[2]+b[3]}};b4w.module.__nla=function(a,p){function e(){return{type:"CLIP",la:0,Ka:0,Hh:!1,paused:!1,ff:"",dn:"",Xb:0,bm:null,bi:0,vj:0,lz:0,kz:0,QC:!1,scale:1,repeat:1,Mx:0}}function c(a,b,d){if(a.animation_data){var e=a.animation_data.nla_tracks;if(e)for(var f=0;f<e.length;f++)e[f].bm=d,b.push(e[f])}a=a.nodes;for(f=0;f<a.length;f++)if(e=a[f],e.node_group){var g=e.node_group.node_tree;if(g){var h=d.slice();h.push(e.name);c(g,b,h)}}}function b(a,b){var c=Math.round(a)-b.la;b.Sh&&(c%=b.si,0>c&&(c+=b.si));return b.tb+
c}function n(a,b){var c=(b-G)*E.Qc()+a.tb;c>a.la?(c-=a.la,a.cyclic&&(c%=a.Ka-a.la+1),c+=a.la):c=a.la;return c}function h(a,b){a=y.clamp(a,b.la,b.Ka);var c=a==b.Ka?b.Mx:b.bi+(a-b.la)/b.scale%(b.vj-b.bi);b.QC&&(c=b.vj-c+b.bi);return c}function r(a,b){for(var c=[],d=0;d<a.length;d++){var f=a[d],g=f.strips;if(g)for(var h=0;h<g.length;h++){var l=g[h],m=e();m.type=l.type;m.la=l.frame_start;m.Ka=l.frame_end;m.Xb=b;m.bi=l.action_frame_start;m.vj=l.action_frame_end;m.QC=l.use_reverse;m.scale=l.scale;m.repeat=
l.repeat;l.action&&(m.ff=l.action.name,m.dn=l.action.uuid,m.bm=f.bm);c.push(m)}}return c}function g(a){return("SPEAKER"==a.type||"LAMP"==a.type)&&a.data.animation_data&&a.data.animation_data.nla_tracks.length?!0:!1}function m(a){if("MESH"!=a.type||!a.data)return!1;a=a.data.materials;if(!a)return!1;for(var b=0;b<a.length;b++){var c=a[b],d=c.node_tree;if(c=c.use_nodes&&d)a:{if(d.animation_data&&(c=d.animation_data.nla_tracks)&&c.length){c=!0;break a}d=d.nodes;for(c=0;c<d.length;c++);c=!1}if(c)return!0}return!1}
function q(a,b){var c=H.get_active();if(c.ja){var d=n(c.ja,b);c.ja.tb-=d-a;c.ja.El=!0}}var B=p("__animation");p("__config");var d=p("__objects"),l=p("__obj_util"),f=p("__print"),H=p("__scenes"),D=p("__sfx"),w=p("__textures"),E=p("__time"),y=p("__util"),A=[],G=-1;a.lj=function(a,b){var d;d=null;for(var f=b.C.length-1;0<=f;f--){var h=b.C[f];if(h.Ra.b4w_use_nla&&(d=h,h.Ra.Ix))break}if(d){d.aB=!0;var m=0;if((f=a.animation_data)&&f.nla_tracks.length){var n=f.nla_tracks;if(l.is_armature(b)||l.is_camera(b)||
l.is_mesh(b)||l.is_empty(b)||l.is_lamp(b)||l.is_speaker(b)||l.is_world(b))n=r(n,m),n.length&&(b.vf=b.vf.concat(n),m++)}g(a)&&(n=a.data.animation_data.nla_tracks,n=r(n,m),n.length&&(b.vf=b.vf.concat(n),m++));if(l.is_mesh(b))for(h=a.data.materials,f=0;f<h.length;f++){var q=h[f];if(q.use_nodes&&q.node_tree&&(n=[],c(q.node_tree,n,[q.name]),n=r(n,m),n.length)){for(var q=m,w=n,p=B.rJ(),D=[],A=0,E=0;E<w.length;E++){var G=w[E];""!=G.dn?G=y.keysearch("uuid",G.dn,p):(G=G.ff,G=y.keysearch("name",G,p)||y.keysearch("name",
G+"_B4W_BAKED",p));if(G){var G=G.fcurves,L=[],P;for(P in G)L.push(P);D.push(L)}}for(E=0;E<D.length;E++){p=!1;for(G=0;G<E;G++)if(y.LF(D[E],D[G])){w[E].Xb=w[G].Xb;p=!0;break}p||(w[E].Xb=m+A++)}m=q+A;b.vf=b.vf.concat(n)}}if(!l.is_world(b)){for(f=0;f<a.particle_systems.length;f++)h=a.particle_systems[f],P=h.settings,"EMITTER"==P.type&&P.b4w_allow_nla&&(P=e(),P.type="CLIP",P.la=d.Ra.frame_start,P.Ka=d.Ra.frame_end+1,P.ff=h.name,P.Xb=m,P.bi=P.la,P.vj=P.Ka,b.vf.push(P),m++);h=m+1;for(f=0;f<b.yc.length;f++)n=
b.yc[f],n.gF&&(m=h,P=e(),P.type="CLIP",P.la=d.Ra.frame_start,P.Ka=d.Ra.frame_end+1,P.ff=n.name,P.Xb=m,P.bi=P.la,P.vj=P.Ka,b.vf.push(P))}}};a.kO=function(a,b,c){a.ja||(a.ja={la:a.frame_start,Ka:a.frame_end,tb:0,zo:-1,No:a.frame_end,Oo:a.frame_start,Mm:null,cyclic:b,Db:[],T:[],GB:a.name,Bi:!1,El:!1,cw:!0},A.push(a.ja));b=a.ja;for(var g=d.PJ(a,c),h=0;h<g.length;h++){var l=g[h];if(l.vf.length){for(var m=0;m<l.C.length;m++){var n=l.C[m];n.Ra==a&&n.aB&&b.Db.push(l)}for(var m=l.vf,n=b,q=l.name,r=0;r<m.length;r++){var w=
m[r];n.la>w.Ka||n.Ka<w.la?(f.warn("NLA: Strip is out of scene range: "+(q+" ["+w.la+":"+w.Ka+"]")),m.splice(r,1),r--):w.ff||"CLIP"!=w.type||(f.warn('NLA: no action in strip for object "'+q+'".'),m.splice(r,1),r--)}l=l.vf;m=b;for(n=0;n<l.length;n++){for(var q=l[n],r=m.la,w=m.Ka+1,B=0;B<l.length;B++){var p=l[B];q.Xb==p.Xb&&(p.Ka<=q.la&&(r=q.la),p.la>=q.Ka&&(w=Math.min(w,p.la)))}q.lz=r;q.kz=w;q.Mx=0===q.repeat%1?q.vj:q.bi+q.repeat%1*(q.vj-q.bi)}}}a=a.p.Nm;for(h=0;h<a.length;h++)g=a[h].p,g.Lm&&(g.sa||
g.Sc)&&g.hg==c&&(l=e(),l.type="VIDEO",g.Sh?(l.la=0,l.Ka=b.Ka):(l.la=y.clamp(g.la,0,b.Ka),l.Ka=y.clamp(g.la+g.si,0,b.Ka)),l.ff=a[h].name,b.T.push(g))};a.start=function(){G=0};a.RJ=function(){return G};a.HQ=function(a){return a.ja?a.ja.tb:null};a.wR=function(a,b){return a.ja?(a.ja.tb=b,!0):!1};a.update=function(a,c){if(!(0>G)){0==G&&(G=a);for(var d=0;d<A.length;d++){var e=A[d];e.Bi&&(e.tb-=E.Qc()*c);var f=n(e,a);if((!e.Bi||e.El)&&f>=e.No)if(e.cyclic){var f=e,g=a;f.Mm&&f.Mm();q(f.Oo,g);f.cw=!0;f=n(f,
g)}else{var g=e,l=f;g.Bi=!0;g.tb-=l-g.No;g.Mm&&g.Mm()}if(!e.Bi||e.El){for(var g=e,l=f,m=0;m<g.Db.length;m++){for(var r=g.Db[m],p=r.vf,F=0;F<p.length;F++){var K=p[F];"SOUND"==K.type&&l<g.zo-1E-6&&(K.Hh=!1)}for(F=0;F<p.length;F++)switch(K=p[F],K.type){case "CLIP":if(K.lz<=l&&l<K.kz&&!K.Hh){var H=r,N=K,L=N.bm;""!=N.dn?B.FF(H,L,N.dn,N.Xb):B.apply(H,L,N.ff,N.Xb);B.set_behavior(H,B.AB_FINISH_STOP,N.Xb);L=h(N.la,N);B.set_frame(H,L,N.Xb);for(H=0;H<p.length;H++)p[H]!=K&&p[H].Xb==K.Xb&&(p[H].Hh=!1);K.Hh=!0}K.Hh&&
(H=r,N=h(l,K),1E-6<Math.abs(N-B.Mz(H,K.Xb))&&B.set_frame(H,N,K.Xb));break;case "SOUND":(l<g.zo-1E-6||g.zo<K.la)&&K.la<=l&&l<K.Ka&&!K.Hh&&(H=r,L=K,N=(L.la-l)/E.Qc(),L=(L.Ka-L.la)/E.Qc(),D.play(H,N,L),K.Hh=!0),g.zo<K.Ka&&K.Ka<=l&&K.Hh&&(K.Hh=!1)}}g=a;l=e;m=f;for(r=0;r<l.T.length;r++)if(p=l.T[r],p.sa||p.Sc){F=w.ZC(p);K=p;H=y.clamp(b(m,K),K.tb,K.tb+w.$C(K)-1);K.Sc&&(H=w.LO(K,H),H==K.Xo&&H--);K=H;H=w.aD(p);L=N=!1;if(l.El||l.cw)L=!0;if(!l.Bi){var P;P=b(m,p);P=p.tb<=P&&P<=p.tb+w.$C(p);var da=w.bD(p);p.Sh&&
K==H&&(L=!0);da||F==K||(L=!0);P&&!da?w.play_video(p.name,p.hg):P&&da?N=!0:!P&&da&&(p.sa&&F<K?N=!0:w.pause_video(p.name,p.hg))}L?(w.vM(p.name,K,p.hg),p.Sc&&(p.aj=w.fs(p,g))):N&&w.cD(p)&&(p.sa?w.NC(p):(F=w.fs(p,g),F!=p.aj&&(p.Ih=K,w.MC(p)),p.aj=F))}e.zo=f}e.El=!1;e.cw=!1}}};a.cleanup=function(){A.length=0;G=-1};a.ky=function(a){var b=a.animation_data;return b&&b.nla_tracks.length||g(a)||m(a)?!0:!1};a.set_frame=q;a.get_frame=function(a){var b=H.get_active();return b.ja?n(b.ja,a):-1};a.xw=function(){var a=
H.get_active();if(a.ja){a.ja.Bi=!0;for(var a=a.ja.T,b=0;b<a.length;b++){var c=a[b];w.pause_video(c.name,c.hg)}}};a.mB=function(a){var b=H.get_active();b.ja&&(b.ja.Bi=!1,b.ja.Mm=a?a:null)};a.get_frame_start=function(){var a=H.get_active();return a.ja?a.ja.la:-1};a.get_frame_end=function(){var a=H.get_active();return a.ja?a.ja.Ka:-1};a.is_play=function(){var a=H.get_active();return a.ja?!a.ja.Bi:!1};a.check_nla=function(){var a=H.get_active();return a.ja?a.b4w_use_nla:!1};a.check_logic_nodes=function(){var a=
H.get_active();return a.ja?0<a.b4w_logic_nodes.length:!1};a.set_range=function(a,b){var c=H.get_active();if(c.ja)c.ja.Oo=a,c.ja.No=b;else return!1};a.kw=function(a){var b=H.get_active();b.ja&&(b.ja.No=a)};a.KM=function(a){var b=H.get_active();b.ja&&(b.ja.Oo=a)};a.reset_range=function(){var a=H.get_active();if(a.ja)a=a.ja,a.Oo=a.la,a.No=a.Ka;else return!1};a.set_cyclic=function(a){var b=H.get_active();if(b.ja)b.ja.cyclic=a;else return!1};a.clear_callback=function(){var a=H.get_active();a.ja&&(a.ja.Mm=
null)};a.KB=function(a){var b=H.get_active().ja;b&&(b.tb=-(a-G)*E.Qc()+b.Oo,b.El=!0)};a.get_frame_end=function(){var a=H.get_active().ja;return a?a.Ka:null}};b4w.module.__camera=function(a,p){function e(a,b,c,d,e){J.set_translation(a,b);c&&y(a,b,c);k(a,d);t(a,e)}function c(a,b,c,d,e,f,g,h){var l=a.k;J.set_translation(a,b);l.pivot.set(c);y(a,b,c);k(a,d);t(a,e);z(a,f);S(a,g);l.use_panning=h}function b(a,b,c,d,e,f,g,h){var k=a.k;J.set_translation(a,b);k.ub.set(c);y(a,b,c);v(a,d);M(a,e);C(a,f);W(a,g);k.Yj=h}function n(a,b,c){var d=a.k,e=aa.get_trans_view(d.m),f=aa.get_quat_view(d.m),d=Fa;d.set(V.AXIS_Y);d[3]=0;a=l(a,Ea)[1];f=V.quat_to_dir(f,V.AXIS_MY,na);
ka.set_pline_initial_point(Ba,e);ka.set_pline_directional_vec(Ba,f);if(!V.line_plane_intersect(d,-b,Ba,c)||Math.abs(a)<fa)Ia.warn("Active hover camera view vector and the supporting plane are parallel to each other. Hover pivot will be set based on the camera position."),c[0]=e[0],c[1]=0,c[2]=e[2];return c}function h(b){for(var c=b.k,d=0;d<b.C.length;d++){var e=b.C[d].R[0];if(e.type==a.ae)switch(c.nb){case a.MS_TARGET_CONTROLS:var f=aa.get_trans_view(c.m);c.xi=ca.dist(f,c.pivot);c.yi=e.top;break;
case a.MS_HOVER_CONTROLS:f=aa.get_trans_view(c.m),c.xi=ca.dist(f,c.ub),c.yi=e.top}}}function r(a){a={type:a,name:"",UB:1,width:0,height:0,je:null,co:null,Zb:null,ge:null,$a:0,ad:0,near:0,far:0,left:0,right:0,top:0,bottom:0,zd:pa.create(),m:new Float32Array(9),jb:new Float32Array(16),Ya:new Float32Array(16),Jc:new Float32Array(16),Ks:new Float32Array(16),Pv:new Float32Array(16),Af:new Float32Array(16),ye:aa.sg(),tp:aa.sg(),Js:aa.sg(),Qo:aa.sg(),Ro:aa.sg(),$r:aa.sg(),ap:aa.sg(),dof_distance:0,Qb:0,
Pb:0,Sb:0,Rb:0,dof_power:0,Ua:0,tc:null,gz:!1,$c:!1,dof_on:!1,sr:new Float32Array(3),Ag:m(),ej:0,te:0,Fb:null,tg:null,Kn:null,qq:new Float32Array(4),gm:new Float32Array(4)};a.zd[0]=a.zd[2]=45;a.zd[1]=a.zd[3]=55;return a}function g(a,b){var c=r(a.type);c.name=a.name;c.UB=a.UB;c.width=a.width;c.height=a.height;b||(c.je=a.je,c.co=a.co,c.Zb=a.Zb,c.ge=a.ge);c.$a=a.$a;c.ad=a.ad;c.near=a.near;c.far=a.far;c.left=a.left;c.right=a.right;c.top=a.top;c.bottom=a.bottom;pa.copy(a.zd,c.zd);aa.copy(a.m,c.m);ea.copy(a.jb,
c.jb);ea.copy(a.Ya,c.Ya);ea.copy(a.Jc,c.Jc);ea.copy(a.Ks,c.Ks);ea.copy(a.Pv,c.Pv);ea.copy(a.Af,c.Af);aa.copy(a.ye,c.ye);aa.copy(a.tp,c.tp);aa.copy(a.Js,c.Js);aa.copy(a.Qo,c.Qo);aa.copy(a.Ro,c.Ro);aa.copy(a.$r,c.$r);aa.copy(a.ap,c.ap);c.dof_distance=a.dof_distance;c.Qb=a.Qb;c.Pb=a.Pb;c.Sb=a.Sb;c.Rb=a.Rb;c.dof_power=a.dof_power;c.Ua=a.Ua;c.tc=a.tc;c.gz=a.gz;c.$c=a.$c;c.dof_on=a.dof_on;ca.copy(a.sr,c.sr);var d=a.Ag,e=c.Ag;pa.copy(d.left,e.left);pa.copy(d.right,e.right);pa.copy(d.top,e.top);pa.copy(d.bottom,
e.bottom);pa.copy(d.near,e.near);pa.copy(d.far,e.far);c.ej=a.ej;c.te=a.te;a.Fb&&(c.Fb=pa.clone(a.Fb));if(a.tg){d=a.tg.length;c.tg=Array(d);for(e=0;e<d;e++)c.tg[e]=ca.clone(a.tg[e]);c.Kn=new Float32Array(a.Kn)}pa.copy(a.qq,c.qq);pa.copy(a.gm,c.gm);return c}function m(){return{left:new Float32Array([0,0,0,0]),right:new Float32Array([0,0,0,0]),top:new Float32Array([0,0,0,0]),bottom:new Float32Array([0,0,0,0]),near:new Float32Array([0,0,0,0]),far:new Float32Array([0,0,0,0])}}function q(b){switch(b){case "STATIC":return a.MS_STATIC;
case "TARGET":return a.MS_TARGET_CONTROLS;case "EYE":return a.MS_EYE_CONTROLS;case "HOVER":return a.MS_HOVER_CONTROLS;default:V.q("Unknown move style")}}function B(b){var c=r(b);if(b==a.Lc)return c;switch(b){case a.kd:H(c,40,.1,1E3);break;case a.ae:H(c,2.5,.1,1E3);break;case a.lg:break;case a.ah:break;case a.$h:break;case a.qc:case a.Bc:case a.Zd:case a.$d:V.q("Stereo camera may only be created from perspective one");break;default:V.q("Unknown camera type")}return c}function d(b,c,d){b.type!=a.qc&&
b.type!=a.Bc&&b.type!=a.Zd&&b.type!=a.$d&&V.q("set_stereo_params(): wrong camera type");if(b.type==a.qc||b.type==a.Bc)b.ej=c;b.te=d;U(b,b.$a);if(qa.ya()&&(c=qa.get_active(),b=c.p.od))for(c=I.fa(qa.gk(c),c).R,d=0;d<c.length;d++)Q(c[d],b)}function l(a,b){var c=aa.get_quat_view(a.k.m);return f(c,b)}function f(a,b){var c=V.quat_to_dir(a,V.AXIS_Y,na),d=V.quat_to_dir(a,V.AXIS_Z,Ca),e=-Math.asin(c[1]/ca.length(c)),c=Math.abs(e)>Math.PI/4?ca.scale(d,-V.sign(e),ya):ca.scale(c,-V.sign(d[1]),ya),f=Math.atan(Math.abs(c[0]/
c[2]));0<d[1]&&(e=V.sign(e)*Math.PI-e);d=f;0>c[2]&&(d=Math.PI-d);0>c[0]&&(d=2*Math.PI-d);b[0]=d;b[1]=e;return b}function H(b,c,d,e,f){switch(b.type){case a.kd:case a.qc:case a.Bc:b.ad=c;b.$a=1;break;case a.ae:b.top=c;b.$a=1;break;case a.lg:delete b.ad;b.ad=c;b.$a=f/c;break;case a.ah:b.top=c;b.$a=f/c;break;case a.Zd:case a.$d:break;default:Ia.error("set_frustum(): Unsupported camera type: "+b.type)}b.near=d;b.far=e}function D(b,c){var d=aa.cc(c.k.m,na),e=aa.xd(c.k.m,va),d=ea.fromRotationTranslation(e,
d,Ka);ea.rotateX(d,-Math.PI/2,d);ea.invert(d,b.jb);if(qa.ya())var f=qa.get_active(),f=qa.Ba(f,"STEREO");if(b.type==a.qc||f&&f.enable_hmd_stereo&&b.type==a.Zd)b.jb[12]+=b.te/2;else if(b.type==a.Bc||f&&f.enable_hmd_stereo&&b.type==a.$d)b.jb[12]-=b.te/2;if(b.Fb){aa.from_mat4(b.jb,b.Qo);aa.yC(b.Qo,b.Ro);aa.invert(b.Ro,b.$r);var f=b.Fb[0],d=b.Fb[1],e=b.Fb[2],g=b.Fb[3],h=Ka;h[0]=1-2*f*f;h[1]=-2*f*d;h[2]=-2*f*e;h[3]=0;h[4]=-2*f*d;h[5]=1-2*d*d;h[6]=-2*d*e;h[7]=0;h[8]=-2*f*e;h[9]=-2*d*e;h[10]=1-2*e*e;h[11]=
0;h[12]=-2*f*g;h[13]=-2*d*g;h[14]=-2*e*g;h[15]=1;ea.multiply(b.jb,h,b.jb);U(b,b.$a,!0);f=Fa;d=Ka;ea.invert(b.jb,d);ea.transpose(d,d);pa.transformMat4(b.Fb,d,f);d=Ja;d[0]=(V.sign(f[0])+b.Ya[8])/b.Ya[0];d[1]=(V.sign(f[1])+b.Ya[9])/b.Ya[5];d[2]=-1;d[3]=(1+b.Ya[10])/b.Ya[14];pa.scale(f,2/(f[0]*d[0]+f[1]*d[1]+f[2]*d[2]+f[3]*d[3]),f);b.Ya[2]=f[0];b.Ya[6]=f[1];b.Ya[10]=f[2]+1;b.Ya[14]=f[3]}aa.from_mat4(b.jb,b.ye);aa.yC(b.ye,b.tp);aa.invert(b.tp,b.Js);T(b);ga(b);aa.copy(c.k.m,b.m)}function w(b,c,d,e){ea.lookAt(c,
d,e,b.jb);d=qa.get_active();d=qa.Ba(d,"STEREO");qa.ya()&&(d=qa.get_active(),d=qa.Ba(d,"STEREO"));if(b.type==a.qc||d&&d.enable_hmd_stereo&&b.type==a.Zd)b.jb[12]+=b.te/2;else if(b.type==a.Bc||d&&d.enable_hmd_stereo&&b.type==a.$d)b.jb[12]-=b.te/2;aa.from_mat4(b.jb,b.ye);T(b);ga(b);aa.set_trans(c,b.m)}function E(a,b,c){c=ca.subtract(c,b,na);ca.length(c)&&(ca.normalize(c,c),c=V.CB(V.AXIS_MY,c,va),J.set_rotation(a,c));J.set_translation(a,b)}function y(a,b,c){var d=a.k,e=x(a);E(a,b,c);e?(b=ca.copy(d.xe,
na),ca.negate(b,b),oa.correct_up(a,b,!0)):oa.correct_up(a,d.xe,!0)}function A(a,b){var c=a.k,d=b.R;d||V.q("Wrong object");for(var e=b.RB,f=0;f<e.length;f++){var g=e[f];ca.copy(aa.get_trans_view(c.m),g.sr)}for(f=0;f<d.length;f++)if(g=d[f],D(g,a),V.Al(g.Jc,g.Ag),g.tc&&g.dof_on){var e=aa.get_trans_view(c.m),h=J.get_translation(g.tc,na),e=ca.dist(e,h);g.dof_distance=e}}function G(b){var c=b.k;c.nb==a.MS_TARGET_CONTROLS&&(c.Dm=x(b))}function x(a){a=aa.get_quat_view(a.k.m);return 0<V.quat_to_dir(a,V.AXIS_Z,
na)[1]}function k(b,c){var d=b.k;if(c){d.eb=d.eb||{};d.eb.left=c.left;d.eb.right=c.right;d.eb.Tl=c.left;d.eb.km=c.right;d.eb.camera_space=Boolean(c.camera_space);var e=b.k;!(d=e.eb)||e.nb!=a.MS_EYE_CONTROLS&&e.nb!=a.MS_TARGET_CONTROLS||(e=l(b,Ea),d.camera_space?(d.left+=e[0],d.right+=e[0]):(d.Tl-=e[0],d.km-=e[0]),d.left=V.angle_wrap_0_2pi(d.left),d.right=V.angle_wrap_0_2pi(d.right),d.Tl=V.angle_wrap_0_2pi(d.Tl),d.km=V.angle_wrap_0_2pi(d.km))}else d.eb=null}function t(a,b){var c=a.k;b?(c.na=c.na||
{},c.na.down=b.down,c.na.up=b.up,c.na.xl=b.down,c.na.Im=b.up,c.na.camera_space=Boolean(b.camera_space),u(a)):c.na=null}function M(a,b){var c=a.k;if(!b){var d=l(a,Ea);b={down:d[1],up:d[1]}}c.na=c.na||{};c.na.down=b.down;c.na.up=b.up;u(a);c.ib&&c.na&&da(a)}function u(b){var c=b.k,d=c.na;if(d)switch(c.nb){case a.MS_EYE_CONTROLS:case a.MS_TARGET_CONTROLS:b=l(b,Ea);d.camera_space?(d.up+=b[1],d.down+=b[1]):(d.Im-=b[1],d.xl-=b[1]);d.up=V.angle_wrap_periodic(d.up,-Math.PI,Math.PI);d.down=V.angle_wrap_periodic(d.down,
-Math.PI,Math.PI);d.Im=V.angle_wrap_periodic(d.Im,-Math.PI,Math.PI);d.xl=V.angle_wrap_periodic(d.xl,-Math.PI,Math.PI);break;case a.MS_HOVER_CONTROLS:d.up=V.angle_wrap_periodic(d.up,-Math.PI,Math.PI),d.down=V.angle_wrap_periodic(d.down,-Math.PI,Math.PI),d.up=V.clamp(d.up,-Math.PI/2,0),d.down=V.clamp(d.down,-Math.PI/2,0)}}function v(a,b){var c=a.k;if(!b){var d=J.dm(a,c.ub);b={min:d,max:d}}c.ib=c.ib||{};c.ib.min=b.min;c.ib.max=b.max;c.ib&&c.na&&da(a)}function z(a,b){var c=a.k;b?(c.ib=c.ib||{},c.ib.min=
b.min,c.ib.max=b.max):c.ib=null}function S(a,b){var c=a.k;b?(c.pe=c.pe||{},c.pe.min_y=b.min_y,c.pe.max_y=b.max_y):c.pe=null}function C(a,b){var c=a.k;b?(c.Fc=c.Fc||{},c.Fc.min=b.min,c.Fc.max=b.max):c.Fc=null}function W(a,b){var c=a.k;b?(c.Gc=c.Gc||{},c.Gc.min=b.min,c.Gc.max=b.max):c.Gc=null}function F(b){var c=b.k;if(I.is_camera(b))for(var d=b.C,e=0;e<d.length;e++){var f=d[e].R;if(f[0].type===a.ae){switch(c.nb){case a.MS_TARGET_CONTROLS:var g=aa.get_trans_view(c.m),g=ca.dist(g,c.pivot),g=g/c.xi*c.yi;
break;case a.MS_HOVER_CONTROLS:g=aa.get_trans_view(c.m);g=ca.distance(g,c.ub);g=g/c.xi*c.yi;break;default:g=f[0].top}for(var h=0;h<f.length;h++){var k=f[h];k.top=g;U(k,k.$a)}A(b,d[e])}}}function K(b){var c=b.k,d=c.nb;if(d===a.MS_TARGET_CONTROLS||d===a.MS_EYE_CONTROLS){if(c.eb){var e=c.eb.left,f=c.eb.right,g=l(b,Ea);(g=d==a.MS_TARGET_CONTROLS?V.Ij(g[0],e,f):V.Ij(g[0],f,e))&&(d==a.MS_TARGET_CONTROLS?N(b,g,0):X(b,g,0))}c.na&&(e=c.na.down,f=c.na.up,g=l(b,Ea),(g=d==a.MS_TARGET_CONTROLS?V.Ij(g[1],f,e):
V.Ij(g[1],e,f))&&(d==a.MS_TARGET_CONTROLS?N(b,0,g):X(b,0,g)));if(d===a.MS_TARGET_CONTROLS&&c.ib){var g=b.k,e=aa.get_trans_view(g.m),f=ca.subtract(e,g.pivot,na),h=ca.length(f);h>g.ib.max?(ca.scale(f,g.ib.max/h,f),ca.add(g.pivot,f,e)):h<g.ib.min&&(h=aa.get_quat_view(g.m),h=V.quat_to_dir(h,V.AXIS_MY,Ca),ca.scale(h,100*g.ib.min,h),ca.add(f,h,f),ca.scale(f,-g.ib.min/ca.length(f),f),ca.add(g.pivot,f,e))}}d===a.MS_TARGET_CONTROLS&&c.pe&&(c=b.k,g=c.pivot[1],e=V.clamp(c.pivot[1],c.pe.min_y,c.pe.max_y),e!=
g&&(g=ca.set(0,e-g,0,na),ca.add(c.pivot,g,c.pivot),c=aa.get_trans_view(c.m),ca.add(c,g,c)));d===a.MS_HOVER_CONTROLS&&(d=b.k,d.Fc&&(g=V.clamp(d.ub[0],d.Fc.min,d.Fc.max)-d.ub[0],d.ub[0]+=g,c=aa.get_trans_view(d.m),c[0]+=g),d.Gc&&(g=V.clamp(d.ub[2],d.Gc.min,d.Gc.max)-d.ub[2],d.ub[2]+=g,c=aa.get_trans_view(d.m),c[2]+=g),d=b.k,c=l(b,Ea)[1],(d=V.Ij(c,d.na.up,d.na.down))&&L(b,0,d))}function X(a,b,c,d,e){var f=a.k,g=b,h=c;if(d||e)a=l(a,ia),d&&(g=b-a[0]),e&&(h=c-a[1]);if(g||h)b=Aa.identity(va),g&&(g=Aa.setAxisAngle(f.xe,
g,Ma),Aa.multiply(b,g,b)),f=aa.get_quat_view(f.m),h&&(g=V.quat_to_dir(f,V.AXIS_X,na),h=Aa.setAxisAngle(g,h,Ma),Aa.normalize(h,h),Aa.multiply(b,h,b)),Aa.multiply(b,f,f)}function N(a,b,c,d,e){var f=a.k,g=b,h=c;if(d||e){var k=l(a,ia);d&&(g=b-k[0]);e&&(h=c-k[1])}P(a,a.k.pivot,g,h);a=l(a,ia);a=V.angle_wrap_periodic(a[1],-Math.PI,Math.PI);f.Dm=Math.abs(a)>Math.PI/2}function L(a,b,c,d,e){var f=a.k,g=b,h=c;if(d||e){var k=l(a,ia);d&&(g=b-k[0]);e&&(h=c-k[1])}f.Yj||(g=0);P(a,f.ub,g,h);h&&da(a)}function P(a,
b,c,d){var e=a.k;if(c||d){var f=Aa.identity(va);c&&(c=Aa.setAxisAngle(V.AXIS_Y,c,Ma),Aa.multiply(f,c,f));O(a);a=aa.get_quat_view(e.m);d&&(c=V.quat_to_dir(a,V.AXIS_X,na),d=Aa.setAxisAngle(c,d,Ma),Aa.normalize(d,d),Aa.multiply(f,d,f));e=aa.get_trans_view(e.m);V.bM(e,b,f,e);Aa.multiply(f,a,a)}}function da(a){var b=a.k,c=l(a,Ea)[1],d=a.k;a=d.na;d=d.ib;a.down-a.up?(c=(a.down-c)/(a.down-a.up),c=Math.max(c,0)):c=0;c=c*(d.max-d.min)+d.min;a=aa.get_trans_view(b.m);d=aa.get_quat_view(b.m);d=V.quat_to_dir(d,
V.AXIS_MY,na);ca.normalize(d,d);ca.scale(d,c,d);ca.subtract(b.ub,d,a)}function U(b,c,d){switch(b.type){case a.kd:c||V.q("No aspect ratio"),b.$a=c;case a.lg:ea.perspective(V.deg_to_rad(b.ad),b.$a,b.near,b.far,b.Ya);break;case a.ae:c||V.q("No aspect ratio"),b.$a=c;case a.ah:c=b.top*b.$a;ea.ortho(-c,c,-b.top,b.top,b.near,b.far,b.Ya);break;case a.$h:ea.ortho(b.left,b.right,b.bottom,b.top,b.near,b.far,b.Ya);break;case a.qc:case a.Bc:c||V.q("No aspect ratio");b.$a=c;var e=Math.tan(b.ad*Math.PI/360);c=b.near*
e;var f=b.$a*b.ej*e;b.type==a.qc?(e=f-b.te/2,f+=b.te/2):(e=f+b.te/2,f-=b.te/2);e=-(b.near/b.ej*e);f*=b.near/b.ej;ea.frustum(e,f,-c,c,b.near,b.far,b.Ya);b.left=e;b.right=f;break;case a.Zd:case a.$d:if(qa.ya())if(e=qa.get_active(),(e=qa.Ba(e,"STEREO"))&&e.enable_hmd_stereo){c=Math.tan(V.deg_to_rad(b.zd[0]));var e=Math.tan(V.deg_to_rad(b.zd[1])),f=Math.tan(V.deg_to_rad(b.zd[2])),g=Math.tan(V.deg_to_rad(b.zd[3]));b.top=b.near*c;b.right=b.near*e;b.bottom=-b.near*f;b.left=-b.near*g;ea.frustum(b.left,b.right,
b.bottom,b.top,b.near,b.far,b.Ya)}else c||(c=b.$a),ea.perspective(V.deg_to_rad(b.ad),c,b.near,b.far,b.Ya);break;case a.Lc:return;default:V.q("Wrong camera type: "+b.type)}d||(T(b),ga(b))}function ga(a){ea.copy(a.jb,a.Af);a.Af[12]=0;a.Af[13]=0;a.Af[14]=0;a.Af[15]=1;ea.multiply(a.Ya,a.Af,a.Af);ea.invert(a.Af,a.Af)}function T(a){ea.copy(a.jb,a.Jc);ea.multiply(a.Ya,a.Jc,a.Jc);ea.invert(a.Jc,a.Ks)}function la(b,c,d,e,f){e||(e=new Float32Array(24));c||(c=b.near);d||(d=b.far);var g,h,k,l,m,n,q,J;switch(b.type){case a.Lc:V.q("Extraction from NONE camera is not possible");
break;case a.kd:case a.lg:g=c*Math.tan(b.ad*Math.PI/360);l=-g;h=g*b.$a;k=-h;m=d/c*g;J=-m;n=m*b.$a;q=-n;break;case a.ae:case a.ah:k=b.top*b.$a;g=m=b.top;h=n=k;l=J=-b.top;k=q=-k;break;case a.$h:g=m=b.top;h=n=b.right;l=J=b.bottom;k=q=b.left;break;case a.qc:case a.Bc:m=c/b.near;g=c*Math.tan(b.ad*Math.PI/360);l=-g;h=b.right*m;k=b.left*m;q=d/c;m=g*q;J=-m;n=h*q;q*=k;break;case a.Zd:case a.$d:m=c/b.near;g=b.top*m;l=b.bottom*m;h=b.right*m;k=b.left*m;q=d/c;m=g*q;J=l*q;n=h*q;q*=k;break;default:V.q("Wrong camera type: "+
b.type)}e[0]=k;e[1]=l;e[2]=-c;e[3]=h;e[4]=l;e[5]=-c;e[6]=h;e[7]=g;e[8]=-c;e[9]=k;e[10]=g;e[11]=-c;e[12]=q;e[13]=J;e[14]=-d;e[15]=q;e[16]=m;e[17]=-d;e[18]=n;e[19]=m;e[20]=-d;e[21]=n;e[22]=J;e[23]=-d;f&&(c=Ka,ea.invert(b.jb,c),V.im(e,c,e,0));return e}function O(b){return I.is_camera(b)&&b.k&&b.k.nb==a.MS_HOVER_CONTROLS}function Q(a,b){if(b.enable_csm){var c=b.csm_num;if(!a.tg){var d=b.csm_num;a.tg=Array(d);for(var e=0;e<d;e++)a.tg[e]=new Float32Array(3);a.Kn=new Float32Array(d)}for(d=0;d<c;d++){var e=
0==d?a.near:Z(b,a,d-1),f=Z(b,a,d),e=la(a,e,f,Oa),e=ja.FJ(e);a.tg[d].set(e.J);a.Kn[d]=e.Za;a.qq[d]=ca.length(e.J);a.gm[d]=ma(b.first_cascade_blur_radius,b.last_cascade_blur_radius,c,d)}}else a.gm[0]=b.first_cascade_blur_radius}function Z(a,b,c){var d=a.csm_num,e=V.clamp(a.csm_first_cascade_border,b.near,b.far);a=V.clamp(a.csm_last_cascade_border,b.near,b.far);return V.clamp(ma(e,a,d,c),b.near,b.far)}function ma(a,b,c,d){switch(d){case 0:break;case c-1:a=b;break;default:a=0==a?0:a*Math.pow(b/a,d/(c-
1))}return a}function ra(a,b){b||(b=new Float32Array(3));var c=aa.get_trans_view(a.k.m);ca.copy(c,b);return b}var ja=p("__boundings");p("__config");var oa=p("__constraints"),ha=p("__container"),ea=p("__mat4"),ka=p("__math"),I=p("__obj_util"),Ia=p("__print"),Aa=p("__quat"),qa=p("__scenes"),J=p("__transform"),aa=p("__tsr"),V=p("__util"),ca=p("__vec3"),pa=p("__vec4");a.Lc=10;a.kd=20;a.ae=30;a.lg=40;a.ah=50;a.$h=60;a.qc=70;a.Bc=80;a.Zd=90;a.$d=100;a.MS_STATIC=0;a.MS_TARGET_CONTROLS=2;a.MS_EYE_CONTROLS=
3;a.MS_HOVER_CONTROLS=4;var fa=V.deg_to_rad(.5),Ea=new Float32Array(2),ia=new Float32Array(2),na=new Float32Array(3),Ca=new Float32Array(3),ya=new Float32Array(3),va=new Float32Array(4),Ma=new Float32Array(4),Fa=new Float32Array(4),Ja=new Float32Array(4),Ka=new Float32Array(16),Oa=new Float32Array(24),Ba=new Float32Array(6);a.nG=function(d,f){var k=f.k,l=d.data;switch(l.type){case "PERSP":var m=B(a.kd);if(l.angle_y)var J=V.rad_to_deg(l.angle_y);H(m,J,l.clip_start,l.clip_end);break;case "ORTHO":m=
B(a.ae),H(m,l.ortho_scale/2,l.clip_start,l.clip_end)}m.name=f.name;J=f.C;J[0].R.push(m);for(var t=1;t<J.length;t++){var r=g(m,!1);J[t].R.push(r)}k.nb=q(l.b4w_move_style);k.dof_distance=l.dof_distance;m=l.dof_object;k.tc=m?m.xa:null;k.Qb=l.b4w_dof_front_start;k.Pb=l.b4w_dof_front_end;k.Sb=l.b4w_dof_rear_start;k.Rb=l.b4w_dof_rear_end;k.dof_power=l.b4w_dof_power;k.Oc=l.b4w_dof_bokeh;k.Ua=l.b4w_dof_bokeh_intensity;k.$c=l.b4w_dof_foreground_blur;k.Wk=l.b4w_trans_velocity;k.Vk=l.b4w_rot_velocity;k.Xk=l.b4w_zoom_velocity;
m=f.k.nb;J=d.data;t=null;m!=a.MS_TARGET_CONTROLS&&m!=a.MS_EYE_CONTROLS||!J.b4w_use_horizontal_clamping||(t={left:J.b4w_rotation_left_limit,right:J.b4w_rotation_right_limit,camera_space:"LOCAL"==J.b4w_horizontal_clamping_type},m==a.MS_EYE_CONTROLS&&(t.left*=-1,t.right*=-1));m=t;J=f.k.nb;t=d.data;r=null;J!=a.MS_TARGET_CONTROLS&&J!=a.MS_EYE_CONTROLS||!t.b4w_use_vertical_clamping?J==a.MS_HOVER_CONTROLS&&t.b4w_use_zooming&&(t.b4w_hover_angle_min<=t.b4w_hover_angle_max?(r={down:t.b4w_hover_angle_min,up:t.b4w_hover_angle_max},
r.down*=-1,r.up*=-1):Ia.error("Wrong angle limits for the HOVER camera. Disabling angle limits.")):(r={down:t.b4w_rotation_down_limit,up:t.b4w_rotation_up_limit,camera_space:"LOCAL"==t.b4w_vertical_clamping_type},J==a.MS_TARGET_CONTROLS&&(r.down*=-1,r.up*=-1));var J=r,t=f.k.nb,r=d.data,v=null;t==a.MS_TARGET_CONTROLS&&r.b4w_use_target_distance_limits&&r.b4w_distance_min<=r.b4w_distance_max?v={min:r.b4w_distance_min,max:r.b4w_distance_max}:t===a.MS_HOVER_CONTROLS&&r.b4w_use_zooming&&(r.b4w_distance_min<=
r.b4w_distance_max?v={min:r.b4w_distance_min,max:r.b4w_distance_max}:Ia.error("Wrong distance limits for the HOVER camera. Disabling distance limits."));t=v;r=d.data;v=null;f.k.nb==a.MS_HOVER_CONTROLS&&r.b4w_use_horizontal_clamping&&r.b4w_horizontal_translation_min<=r.b4w_horizontal_translation_max&&(v={min:r.b4w_horizontal_translation_min,max:r.b4w_horizontal_translation_max});var r=v,u=d.data,v=null;f.k.nb==a.MS_HOVER_CONTROLS&&u.b4w_use_vertical_clamping&&u.b4w_vertical_translation_min<=u.b4w_vertical_translation_max&&
(v={min:u.b4w_vertical_translation_min,max:u.b4w_vertical_translation_max},u=-v.min,v.min=-v.max,v.max=u);var u=d.data,w=null;f.k.nb==a.MS_TARGET_CONTROLS&&u.b4w_use_pivot_limits&&(w={min_y:u.b4w_pivot_z_min,max_y:u.b4w_pivot_z_max});u=w;switch(k.nb){case a.MS_EYE_CONTROLS:k=aa.get_trans_view(f.k.m);e(f,k,null,m,J);break;case a.MS_TARGET_CONTROLS:k=aa.get_trans_view(f.k.m);c(f,k,l.b4w_target,m,J,t,u,l.b4w_use_panning);break;case a.MS_HOVER_CONTROLS:k=aa.get_trans_view(f.k.m),m=n(f,d.data.b4w_hover_zero_level,
Ca),b(f,k,m,t,J,r,v,l.b4w_enable_hover_hor_rotation)}K(f);h(f)};a.UM=e;a.WM=c;a.VM=b;a.po=h;a.jc=g;a.hH=m;a.mR=q;a.Ec=B;a.OP=function(a,b){switch(b){case "COLOR":case "CUBEMAP":return Boolean(a.Zb);case "DEPTH":return Boolean(a.ge);case "SCREEN":return!Boolean(a.Zb)&&!Boolean(a.ge);default:V.q("Wrong attachment type: "+b)}};a.gs=function(a,b,c){switch(b){case "COLOR":case "CUBEMAP":a.Zb=c;break;case "DEPTH":a.ge=c;break;case "SCREEN":a.Zb=null;a.ge=null;break;default:V.q("Wrong attachment type: "+
b)}};a.xQ=function(a,b){switch(b){case "COLOR":case "CUBEMAP":return a.Zb;case "DEPTH":return a.ge;case "SCREEN":return null;default:V.q("Wrong attachment type: "+b)}};a.wr=function(b,c){(b.type!=a.kd||c!=a.qc&&c!=a.Bc&&c!=a.Zd&&c!=a.$d)&&V.q("make_stereo(): wrong camera type");b.type=c;d(b,6,.065)};a.MM=d;a.get_camera_angles=l;a.Kz=f;a.get_camera_angles_char=function(a,b){l(a,b);b[0]=V.angle_wrap_0_2pi(b[0]+Math.PI);b[1]*=-1;return b};a.hs=H;a.xM=function(b,c,d,e,f,g,h){switch(b.type){case a.$h:b.left=
c;b.right=d;b.bottom=e;b.top=f;b.near=g;b.far=h;break;default:Ia.error("set_frustum_asymmetric(): Unsupported camera type: "+b.type)}};a.get_move_style=function(a){return a.k.nb};a.RM=D;a.yR=w;a.lw=function(a,b,c){var d=na;d[0]=0;d[1]=-1;d[2]=0;ca.transformQuat(d,c,d);d[0]+=b[0];d[1]+=b[1];d[2]+=b[2];var e=Ca;e[0]=0;e[1]=0;e[2]=-1;ca.transformQuat(e,c,e);w(a,b,d,e)};a.set_look_at=E;a.FM=y;a.YN=A;a.XN=function(b){var c=b.k;K(b);F(b);switch(c.nb){case a.MS_TARGET_CONTROLS:var e=aa.get_trans_view(c.m),
f=aa.get_quat_view(c.m);oa.cM(e,f,c.pivot);for(f=0;f<b.C.length;f++)for(var g=b.C[f].R,h=0;h<g.length;h++){var k=g[h];k.type!=a.qc&&k.type!=a.Bc||d(k,ca.dist(e,c.pivot),k.te)}oa.correct_up(b,c.xe);break;case a.MS_EYE_CONTROLS:b.Ib||oa.correct_up(b,c.xe)}G(b)};a.Yw=G;a.JB=k;a.MB=t;a.hover_set_vertical_limits=M;a.hover_set_distance_limits=v;a.pM=z;a.IM=S;a.zM=C;a.QM=W;a.hO=F;a.rotate_eye_camera=X;a.rotate_target_camera=N;a.rotate_hover_camera=L;a.aR=function(b){switch(b.type){case a.kd:case a.ae:case a.qc:case a.Bc:return!0;
default:return!1}};a.Hz=function(b){switch(b.type){case a.kd:case a.lg:case a.qc:case a.Bc:return V.deg_to_rad(b.ad);default:return Ia.error("get_angular_diameter(): Unsupported camera type: "+b.type),0}};a.bj=U;a.kM=function(b,c,d,e,f){var g=1/Math.max(f,e);switch(b.type){case a.kd:case a.lg:f/=2;e/=2;d=-(d-f)/f*Math.tan(V.deg_to_rad(b.ad)/2);c=(c-e)/e*Math.tan(V.deg_to_rad(b.ad)/2)*b.$a;e=b.near*(d+g);f=b.near*(c+g);d=b.near*(d-g);c=b.near*(c-g);ea.frustum(c,f,d,e,b.near,b.far,b.Ya);break;case a.ae:case a.ah:b.right=
b.top*b.$a;d=-d/f;c/=e;e=b.top+(d+g)*(b.top+b.top);f=-b.right+(c+g)*(b.right+b.right);d=b.top+(d-g)*(b.top+b.top);c=-b.right+(c-g)*(b.right+b.right);ea.ortho(c,f,d,e,b.near,b.far,b.Ya);break;case a.$h:d=-d/f,c/=e,e=b.top+(d+g)*(b.top-b.bottom),f=b.left+(c+g)*(b.right-b.left),d=b.top+(d-g)*(b.top-b.bottom),c=b.left+(c-g)*(b.right-b.left),ea.ortho(c,f,d,e,b.near,b.far,b.Ya)}ea.copy(b.jb,b.Jc);ea.multiply(b.Ya,b.Jc,b.Jc);V.Al(b.Jc,b.Ag)};a.Et=ga;a.qy=T;a.KI=la;a.MF=function(a){a=a.k;var b=ja.Wc();b.min_x=
-1;b.max_x=1;b.min_y=-1;b.max_y=1;b.min_z=-1;b.max_z=1;a.U=b;var c=ja.cq(1,V.f32([0,0,0]));a.jf=c;a.kn=ja.ay(1,b);a.mn=ja.cy(1,b);a.ln=ja.by(1,b)};a.is_static_camera=function(b){return I.is_camera(b)&&b.k&&b.k.nb==a.MS_STATIC};a.is_target_camera=function(b){return I.is_camera(b)&&b.k&&b.k.nb==a.MS_TARGET_CONTROLS};a.is_eye_camera=function(b){return I.is_camera(b)&&b.k&&b.k.nb==a.MS_EYE_CONTROLS};a.is_hover_camera=O;a.is_ortho_camera=function(b){return I.is_camera(b)&&b.k&&b.C[0].R[0].type==a.ae};
a.Xw=Q;a.eI=Z;a.project_point=function(b,c,d){b=b.C[0].R[0];switch(b.type){case a.kd:case a.lg:case a.ae:case a.ah:case a.qc:case a.Bc:case a.Zd:case a.$d:var e=Fa;e.set(c);e[3]=1;pa.transformMat4(e,b.Jc,e);c=-e[1]/e[3];d[0]=(e[0]/e[3]+1)/2*b.width;d[1]=(c+1)/2*b.height;ha.NO(d[0],d[1],d,b);2<d.length&&(d[2]=(e[2]/Math.abs(e[3])+1)/2);return d;default:return Ia.error("Non-compatible camera"),d}};a.DJ=function(a){return a.C[0].R[0]};a.Hl=function(b,c){switch(b.type){case a.kd:case a.lg:case a.qc:case a.Bc:var d=
Math.tan(V.deg_to_rad(b.ad)/2);switch(c){case "LEFT":return-d*b.$a;case "RIGHT":return d*b.$a;case "TOP":return d;case "BOTTOM":return-d}break;case a.ae:case a.ah:switch(c){case "LEFT":return-b.top*b.$a;case "RIGHT":return b.top*b.$a;case "TOP":return b.top;case "BOTTOM":return-b.top}break;case a.$h:switch(c){case "LEFT":return b.left;case "RIGHT":return b.right;case "TOP":return b.top;case "BOTTOM":return b.bottom}break;case a.Zd:case a.$d:switch(c){case "LEFT":return Math.tan(V.deg_to_rad(b.zd[3]));
case "RIGHT":return Math.tan(V.deg_to_rad(b.zd[1]));case "TOP":return Math.tan(V.deg_to_rad(b.zd[0]));case "BOTTOM":return Math.tan(V.deg_to_rad(b.zd[2]))}break;default:V.q("Unknown camera type")}};a.qK=function(b){switch(b.type){case a.ae:case a.ah:case a.$h:return!0;default:return!1}};a.get_fov=function(b,c){switch(b.type){case a.kd:case a.lg:case a.qc:case a.Bc:var d=V.deg_to_rad(b.ad);return c?d*b.$a:d;default:return 0}};a.set_trans_pivot=function(a,b,c){a=a.k;aa.set_trans(b,a.m);ca.copy(c,a.pivot)};
a.set_hover_pivot=function(a,b){var c=a.k,d=ca.subtract(b,c.ub,na),e=aa.get_trans_view(c.m),d=ca.add(d,e,d);J.set_translation(a,d);ca.copy(b,c.ub)};a.NM=function(a,b){var c=a.k,d=ca.subtract(b,c.pivot,na),e=aa.get_trans_view(c.m),d=ca.add(d,e,d);J.set_translation(a,d);ca.copy(b,c.pivot)};a.get_eye=ra;a.set_move_style=function(c,d){c.k.nb=d;c.k.eb=null;c.k.na=null;c.k.ib=null;c.k.Fc=null;c.k.Gc=null;h(c);switch(d){case a.MS_HOVER_CONTROLS:var e=aa.get_trans_view(c.k.m),f=n(c,0,Ca);b(c,e,f,null,null,
null,null,c.k.Yj);break;case a.MS_TARGET_CONTROLS:e=ra(c,na),f=aa.get_quat_view(c.k.m),f=V.quat_to_dir(f,V.AXIS_MY,Ca),f=ca.scaleAndAdd(e,f,10,f),ca.copy(f,c.k.pivot)}};a.Rs=function(a){a=a.k;a.nb=0;ca.set(0,0,0,a.pivot);ca.set(0,0,0,a.ub);a.Dm=!1;a.use_panning=!1;a.eb=null;a.na=null;a.ib=null;a.Fc=null;a.Gc=null;a.pe=null;a.Yj=!0};a.set_eye_distance=function(a,b){for(var c=0;c<a.length;c++){var e=a[c];70!=e.type&&80!=e.type&&90!=e.type&&100!=e.type||d(e,e.ej,b)}};a.set_hmd_fov=function(a,b,c){var d=
qa.get_active();a=I.fa(a,d).R;for(d=0;d<a.length;d++){var e=a[d];if(90==e.type||100==e.type)90==e.type&&pa.copy(b,e.zd),100==e.type&&pa.copy(c,e.zd),e.Fb||U(e),T(e),ga(e)}}};b4w.module.__lights=function(a,p){function e(a){n.scale(a.color,a.Je,a.Fn)}p("__print");var c=p("__tsr"),b=p("__util"),n=p("__vec3"),h=new Float32Array(3);new Float32Array(3);a.vK=function(a,g){var m=a.data,q=g.Pa={name:"",type:m.type,oB:new Float32Array(3),direction:new Float32Array(3),color:new Float32Array(3),Fn:new Float32Array(3),az:0,Ok:0,hp:0,zn:.1,yn:30,Fz:!1,RA:!1,iz:!1,Km:!0,Tk:!0,Je:1,distance:25,lQ:"INVERSE_SQUARE"};q.name=g.name;q.Km=m.use_diffuse;q.Tk=m.use_specular;var p=c.get_quat_view(g.k.m),
p=b.quat_to_dir(p,b.AXIS_Y,h);n.normalize(p,p);q.direction.set(p);q.color[0]=m.color[0];q.color[1]=m.color[1];q.color[2]=m.color[2];q.Je=q.az=m.energy;e(q);q.distance=m.distance;q.zn=m.clip_start;q.yn=m.clip_end;if("POINT"===q.type||"SPOT"===q.type)q.distance=m.distance;"SPOT"===q.type?(q.hp=m.spot_blend,q.Ok=m.spot_size):"POINT"===q.type&&(q.Ok=Math.PI/2);q.Fz=m.b4w_generate_shadows;q.iz=m.b4w_dynamic_intensity};a.set_light_color=function(a,b){a.color[0]=b[0];a.color[1]=b[1];a.color[2]=b[2];e(a)};
a.CM=function(a,b){a.hp=b};a.BM=function(a,b){a.distance=b};a.DM=function(a,b){a.Ok=b};a.set_light_energy=function(a,b){a.Je=b;e(a)};a.cO=function(a){var e=a.Pa;if(e){a=c.get_quat_view(a.k.m);b.quat_to_dir(a,b.AXIS_Y,e.direction);n.normalize(e.direction,e.direction);if("SUN"==e.type){a=Math.acos(n.dot(e.oB,b.lt));var h=Math.acos(n.dot(e.direction,b.lt));e.RA=Math.floor(a/.025)!=Math.floor(h/.025)?!0:!1}n.copy(e.direction,e.oB)}}};b4w.module.__scenes=function(a,p){function e(a){for(var b=0;b<a.length;b++){var c=a[b];if(!c.ef||!c.ef.length)return c}return null}function c(){Ib||Da.q("No active scene available");return Ib}function b(a,b,c){if(!ta.xq||!n(a,b,c))return null;c=a.b4w_shadow_settings;var d={};c.csm_resolution>Ua.ec?(d.csm_resolution=Ua.ec,xa.error("Shadow map texture has unsupported size. Changed to "+Ua.ec+".")):d.csm_resolution=c.csm_resolution;a=Ba.Lq(b,ta.ssao&&a.b4w_enable_ssao);d.self_shadow_polygon_offset=c.self_shadow_polygon_offset;
d.self_shadow_normal_offset=c.self_shadow_normal_offset;d.enable_csm=c.b4w_enable_csm&&1==a.length;d.Rf=[];d.dC=[];d.rI=[];d.zn=[];d.yn=[];for(b=0;b<a.length;b++)d.Rf.push(a[b].Pa.type),d.dC.push(a[b].Pa.Ok),d.rI.push(a[b].Pa.distance),d.zn.push(a[b].Pa.zn),d.yn.push(a[b].Pa.yn),"SPOT"!=d.Rf[b]&&"POINT"!=d.Rf[b]||!d.enable_csm||(xa.warn("Generating shadows for SPOT or POINT light. Disabling Cascaded Shadow Maps"),d.enable_csm=!1);d.enable_csm?(d.csm_num=c.csm_num,d.csm_first_cascade_border=c.csm_first_cascade_border,
d.first_cascade_blur_radius=c.first_cascade_blur_radius,d.csm_last_cascade_border=c.csm_last_cascade_border,d.last_cascade_blur_radius=c.last_cascade_blur_radius,d.fade_last_cascade=c.fade_last_cascade,d.blend_between_cascades=c.blend_between_cascades):(d.csm_num=1,d.csm_first_cascade_border=c.csm_first_cascade_border,d.first_cascade_blur_radius=c.first_cascade_blur_radius,d.csm_last_cascade_border=c.csm_last_cascade_border,d.last_cascade_blur_radius=c.last_cascade_blur_radius,d.fade_last_cascade=
!1,d.blend_between_cascades=!1);return d}function n(a,b,c){if(0!=b.length&&ta.shadows)switch(a.b4w_render_shadows){case "OFF":return!1;case "ON":return!0}else return!1;var d=!1,e=!1;a=ta.ssao&&a.b4w_enable_ssao;if(0==b.length&&!a)return!1;for(b=0;b<c.length;b++){var f=c[b];f.b4w_shadow_cast&&(d=!0);f.b4w_shadow_receive&&(e=!0);if((a||d)&&e)return!0}return!1}function h(a){for(var b=0;b<a.length;b++)if("SUN"==a[b].Pa.type)return!0;return!1}function r(a){if(!ta.shore_smoothing)return!1;a=ra(a);for(var b=
0;b<a.length;b++){var c=a[b];if(c.b4w_water&&c.b4w_water_shore_smoothing)return!0}return!1}function g(a){for(var b=0;b<a.length;b++)for(var c=a[b].particle_systems,d=0;d<c.length;d++)if(Ba.Ay(a[b],c[d].settings))return!0;return!1}function m(a){for(var b=ra(a),c=[],d=0;d<b.length;d++){var e=b[d];if(e.b4w_water){for(var f={},g=0;g<a.length;g++)for(var h=a[g],k=h.data.materials,l=0;l<k.length;l++)k[l]==e&&(f.qj=h.location[1]);f.Ld=e.b4w_water_fog_color.slice(0);f.Ld.push(e.b4w_water_fog_density);e.b4w_water_dynamic?
(f.Un=!0,f.waves_height=e.b4w_waves_height,f.waves_length=e.b4w_waves_length,f.dst_noise_scale0=e.b4w_water_dst_noise_scale0,f.dst_noise_scale1=e.b4w_water_dst_noise_scale1,f.dst_noise_freq0=e.b4w_water_dst_noise_freq0,f.dst_noise_freq1=e.b4w_water_dst_noise_freq1,f.dir_min_shore_fac=e.b4w_water_dir_min_shore_fac,f.dir_freq=e.b4w_water_dir_freq,f.dir_noise_scale=e.b4w_water_dir_noise_scale,f.dir_noise_freq=e.b4w_water_dir_noise_freq,f.dir_min_noise_fac=e.b4w_water_dir_min_noise_fac,f.dst_min_fac=
e.b4w_water_dst_min_fac,f.waves_hor_fac=e.b4w_water_waves_hor_fac):(f.Un=!1,f.waves_height=0,f.waves_length=0);f.If=e.b4w_water_enable_caust;f.pG=e.b4w_water_caust_scale;f.oG=e.b4w_water_caust_brightness;f.qG=new Float32Array([.3,.7]);f.cj=null;e=e.texture_slots;for(g=0;g<e.length;g++)h=e[g].texture,!0===h.b4w_shore_dist_map&&"FILE"==h.image.source&&(f.cj=h.image,f.ow=h.image.size[0],f.kv=h.b4w_max_shore_dist,h=h.b4w_shore_boundings,f.nm=[(h[0]+h[1])/2,(h[2]+h[3])/2],f.om=[h[0]-h[1],h[2]-h[3]]);c.push(f)}}if(0<
c.length){f=c[0];if(!f.Un)for(d=0;d<c.length;d++)c[d].Un&&(f=c[d]);return f}return null}function q(a){function b(a){if(a){a=a.nodes;for(var d=0;d<a.length;d++){var e=a[d];"GROUP"==e.type&&e.node_group&&b(e.node_group.node_tree);"GROUP"==e.type&&"B4W_REFRACTION"==e.node_tree_name&&(c.refractions=!0)}}}var c={refractions:!1};a=ra(a);for(var d=0;d<a.length;d++){var e=a[d];e.b4w_refractive&&(c.refractions=!0);e.node_tree&&b(e.node_tree)}return c}function B(a,b,c){if(ta.reflections)switch(a.b4w_render_reflections){case "OFF":return!1}else return!1;
a=[];for(var d=0,e=!1,f=0;f<b.length;f++){var g=b[f];g.k.ed&&"CUBE"==g.k.zf&&d++;if(g.To.length){for(var h=null,k=0;k<a.length;k++)if(a[k]==g){h=k;break}null==h&&a.push(g)}}for(f=0;f<c.length;f++){a:if(b=c[f],b.b4w_reflexible){b=b.data.materials;for(g=0;g<b.length;g++)if(h=b[g].game_settings.alpha_blend,"OPAQUE"!=h&&"CLIP"!=h){b=!0;break a}b=!1}else b=void 0;b&&(e=!0)}return{xB:a,YA:d,jh:[],du:[],Lg:[],Tr:[],bA:e}}function d(a,b){var c=a.b4w_sky_settings,d={};d.QL=c.render_sky;d.procedural_skydome=
c.procedural_skydome&&b;d.use_as_environment_lighting=c.use_as_environment_lighting;d.qm=c.color;d.rayleigh_brightness=c.rayleigh_brightness;d.mie_brightness=c.mie_brightness;d.spot_brightness=c.spot_brightness;d.scatter_strength=c.scatter_strength;d.rayleigh_strength=c.rayleigh_strength;d.mie_strength=c.mie_strength;d.rayleigh_collection_power=c.rayleigh_collection_power;d.mie_collection_power=c.mie_collection_power;d.mie_distribution=c.mie_distribution;d.Rc=c.reflexible;d.Hc=c.reflexible_only;!b&&
c.procedural_skydome&&xa.warn("There is no sun on the scene. Procedural sky won't be rendered");return d}function l(a){var b={};a=a.b4w_ssao_settings;b.radius_increase=a.radius_increase;b.aK=a.hemisphere;b.bG=a.blur_depth;b.iy=a.blur_discard_value;b.influence=a.influence;b.dist_factor=a.dist_factor;b.fM=a.samples;return b}function f(a){if(!(ta.bloom&&a.b4w_enable_bloom&&a.p.Oh))return null;var b={};a=a.b4w_bloom_settings;b.blur=a.blur;b.wI=a.edge_lum;b.key=a.key;return b}function H(a){var b={};a=
a.b4w_motion_blur_settings;b.mb_decay_threshold=a.motion_blur_decay_threshold;b.mb_factor=a.motion_blur_factor;return b}function D(a){var b={};a=a.b4w_color_correction_settings;b.brightness=a.brightness;b.contrast=a.contrast;b.exposure=a.exposure;b.saturation=a.saturation;return b}function w(a){var b={};a=a.b4w_god_rays_settings;b.Uu=a.intensity;b.Vl=a.max_ray_length;b.ym=a.steps_per_pass;return b}function E(a){var b={};b.Dh=a.b4w_outline_color;b.Eo=a.b4w_outline_factor;return b}function y(a){var b=
{};a=a.b4w_glow_settings;b.small_glow_mask_coeff=a.small_glow_mask_coeff;b.large_glow_mask_coeff=a.large_glow_mask_coeff;b.small_glow_mask_width=a.small_glow_mask_width;b.large_glow_mask_width=a.large_glow_mask_width;return b}function A(a,b){var c=a.light_settings,d={};d.ph=c.environment_energy;d.bx=c.use_environment_light;d.qu=c.environment_color;d.Oe=a.horizon_color.slice(0);d.cf=a.zenith_color.slice(0);d.FO=a.use_sky_paper;d.EO=a.use_sky_blend;d.GO=a.use_sky_real;d.YB=null;d.rw=null;d.ru=null;
if(d.bx&&"SKY_TEXTURE"==d.qu&&(!b.procedural_skydome||!b.use_as_environment_lighting)){for(var c=null,e=0;e<a.texture_slots.length;e++)if(a.texture_slots[e].texture.b4w_use_as_environment_lighting){c=a.texture_slots[e];break}c?d.ru=c:(xa.warn("environment lighting is set to 'Sky Texture', but there is no world texture with 'Sky Texture Usage' property set to 'ENVIRONMENT_LIGHTING'"),d.bx=!1)}for(e=0;e<a.texture_slots.length;e++)if(a.texture_slots[e].texture.b4w_use_as_skydome){c=a.texture_slots[e];
d.YB=c;d.rw={ZF:c.blend_factor,cK:c.horizon_factor,YO:c.zenith_up_factor,XO:c.zenith_down_factor,color:c.color,hb:c.default_value,invert:c.invert,DO:c.use_rgb_to_intensity,$F:c.blend_type,zO:c.use_map_blend,AO:c.use_map_horizon,CO:c.use_map_zenith_up,BO:c.use_map_zenith_down};break}return d}function G(a){var b=a.fog_settings,c={};c.vO=b.use_fog;c.Uu=b.intensity;c.depth=b.depth;c.start=b.start;c.height=b.height;c.NI=b.falloff;c.color=b.use_custom_color?b.color.slice(0):a.horizon_color.slice(0);a=c.color;
c.Ld=new Float32Array([a[0],a[1],a[2],1/c.depth]);c.nf=new Float32Array([c.Uu,c.depth,c.start,c.height]);return c}function x(a,b){if(!ta.kc)return!1;switch(a.b4w_render_dynamic_grass){case "OFF":return!1;case "ON":return!0}for(var c=!1,d=!1,e=0;e<b.length;e++){for(var f=b[e],g=f.data.materials,h=0;h<g.length;h++)g[h].b4w_terrain&&(c=!0);f=f.particle_systems;for(h=0;h<f.length;h++)g=f[h].settings,"HAIR"==g.type&&g.b4w_dynamic_grass&&(d=!0);if(c&&d)return!0}return!1}function k(a,b){if(Ta.outlining_overview_mode)return!0;
if(ta.enable_selectable)switch(a.b4w_enable_object_selection){case "OFF":return!1;case "ON":return!0;case "AUTO":for(var c=0;c<b.length;c++)if(b[c].xa.k.Ng)return!0;return!1}else return!1}function t(a,b){if(Ta.outlining_overview_mode)return!0;if(ta.enable_outlining)switch(a.b4w_enable_outlining){case "OFF":return!1;case "ON":return!0;case "AUTO":for(var c=0;c<b.length;c++)if(b[c].xa.k.fc)return!0;return!1}else return!1}function M(a,b){if(ta.sh)switch(a.b4w_enable_glow_materials){case "OFF":return!1;
case "ON":return!0;case "AUTO":for(var c=0;c<b.length;c++)for(var d=b[c].data.materials,e=0;e<d.length;e++)if(Ka.zy(d[e]))return!0;return!1}else return!1}function u(a,b){if(ta.refractions)switch(a.b4w_render_refractions){case "OFF":return!1;case "ON":return!0;case "AUTO":return b.refractions}else return!1}function v(a){for(var b=0;b<a.length;b++)for(var c=a[b].data.materials,d=0;d<c.length;d++){var e=c[d],f=e.game_settings.alpha_blend;if(e.b4w_render_above_all&&"OPAQUE"!=f&&"CLIP"!=f)return!0}return!1}
function z(a,b){switch(a.b4w_enable_anchors_visibility){case "OFF":return!1;case "ON":return!0;case "AUTO":for(var c=0;c<b.length;c++){var d=b[c].xa;if(d.anchor&&d.anchor.vl)return!0}return!1}}function S(a,b,c){var d=va.Uf(a,b);va.Ug(a,d,function(a,b,d){if(d.ic){switch(d.from){case "COLOR":case "CUBEMAP":var e=b.o.Zb;break;case "DEPTH":e=b.o.ge;break;case "SCREEN":e=null;break;case R.Kc:return;default:Da.q("Wrong slink")}switch(d.to){case "COLOR":case "CUBEMAP":case "DEPTH":case "NONE":case "SCREEN":case "OFFSCREEN":case "RESOLVE":case "COPY":case "u_cube_reflection":case "u_plane_reflection":break;
default:e||Da.q("Connection of SCREEN is forbidden"),e.Wd&&Da.q("Batch texture can't use renderbuffer"),sa.Cy(c.La,d.to)&&fa.ml(c,e,d.to)}}});for(a=0;a<b.Ha.length;a++){var d=b.Ha[a],e=b.Sg[a];switch(d.to){case "COLOR":case "CUBEMAP":case "DEPTH":case "NONE":case "SCREEN":case "OFFSCREEN":case "RESOLVE":case "COPY":break;default:e.Wd&&Da.q("Batch texture can't use renderbuffer"),sa.Cy(c.La,d.to)&&fa.ml(c,e,d.to)}}}function C(a,b,c,d,e,f){for(var g=b.k,h=Ba.fa(b,e).P,k=0;k<h.length;k++){var l=h[k];
if(!(l.gd||l.Hc||"MAIN"!=l.type&&"NODES_GLOW"!=l.type&&"PARTICLES"!=l.type&&"LINE"!=l.type)&&("OPAQUE"==l.rb&&"OPAQUE"==d||"BLEND"==l.rb&&"BLEND"==d||"XRAY"==l.rb&&"XRAY"==d||"NODES_GLOW"==l.type&&"GLOW"==d)){if(!f&&(W(l,a,b,c,d,e),!fa.gc(l)))if("DEBUG"===Bb.type())fa.Wp(l,"error.glslv","error.glslf"),fa.gc(l);else continue;R.gf(a,R.Cg(l,g));S(c,a,l);F(l)}}}function W(a,b,c,d,e,f){var g=c.k,h=f.p,k=Ba.fa(c,f),l="NO_SHADOWS";c=oa(f,[R.Ac]);if(c.length&&a.Tc){switch(e){case "OPAQUE":l="SHADOW_MAPPING_OPAQUE";
break;case "BLEND":case "XRAY":l="SHADOW_MAPPING_BLEND";break;case "COLOR_ID":case "REFLECT":case "GLOW":l="NO_SHADOWS";break;case "SHADOW":l="SHADOW_MASK_GENERATION";break;default:Da.q("Wrong subscene type")}for(var m=0;m<c.length;m++)fa.Wx(a,f.p.od)}c=a.Va;sa.ba(c,"SHADOW_USAGE",l);a.kc&&(m=ba.$b(d,R.$g))&&K(a,m,g);if("SHADOW"!=a.type&&"COLOR_ID"!=e||a.vi){e=b.Ir;sa.ba(c,"NUM_LIGHTS",e);sa.ba(c,"NUM_LFACTORS",0==e%2?e/2:Math.floor(e/2)+1);sa.ba(c,"REFLECTION_PASS",0);sa.ba(c,"SSAO_ONLY",0);sa.ba(c,
"INVERT_FRONTFACING",0);if(e=h.oc)sa.ba(c,"WATER_EFFECTS",1),sa.ba(c,"WAVES_HEIGHT",sa.D(e.waves_height)),sa.ba(c,"WAVES_LENGTH",sa.D(e.waves_length)),sa.ba(c,"WATER_LEVEL",sa.D(e.qj));if(b.If&&g.If){sa.ba(c,"CAUSTICS",1);if(m=h.od){g=m.Rf;for(m=l=0;m<g.length;m++)"SUN"==g[m]&&(l=m);sa.ba(c,"SUN_NUM",l)}sa.ba(c,"CAUST_SCALE",sa.D(b.sy));sa.ba(c,"CAUST_SPEED",sa.D(b.ty,2));sa.ba(c,"CAUST_BRIGHT",sa.D(b.ry))}b=k.jh;k=k.Lg;if(-1!==a.Uc.indexOf("u_mirrormap"))sa.ba(c,"REFLECTION_TYPE","REFL_MIRRORMAP");
else if(a.ed&&b)b=b.o.Zb,fa.ml(a,b,"u_cube_reflection"),sa.ba(c,"REFLECTION_TYPE","REFL_CUBE");else if(a.ed&&k)for(m=0;m<k.length;m++)b=k[m].o.Zb,fa.ml(a,b,"u_plane_reflection"),sa.ba(c,"REFLECTION_TYPE","REFL_PLANE");else sa.ba(c,"REFLECTION_TYPE","REFL_NONE");(k=ba.$b(d,R.Zh))?a.Wr?(b=k.o.Zb,fa.ml(a,b,"u_sky")):(a.Jd=k.Jd,sa.ba(c,"PROCEDURAL_FOG",1)):sa.ba(c,"PROCEDURAL_FOG",0);b=h.kx;b.bx&&(sa.ba(c,"USE_ENVIRONMENT_LIGHT",1),"SKY_TEXTURE"==b.qu?(b=b.ru?Ra.Pc(b.ru,!1):k.o.Zb,sa.ba(c,"SKY_TEXTURE",
1),fa.ml(a,b,"u_sky_texture")):"SKY_COLOR"==b.qu&&sa.ba(c,"SKY_COLOR",1));b=h.hD;b.vO&&(sa.ba(c,"USE_FOG",1),sa.ba(c,"FOG_TYPE",b.NI));a.Xi&&a.kb?(ta.xq&&sa.ba(c,"USE_REFRACTION_CORRECTION",1),"MAIN"==a.type&&a.vi||"NODES_GLOW"==a.type?(sa.ba(c,"REFRACTIVE",1),h.refractions?sa.ba(c,"USE_REFRACTION",1):sa.ba(c,"USE_REFRACTION",0)):h.refractions?sa.ba(c,"REFRACTIVE",1):sa.ba(c,"REFRACTIVE",0),(h.GA.refractions||h.refractions)&&sa.ba(c,"HAS_REFRACT_TEXTURE",1)):(sa.ba(c,"REFRACTIVE",0),sa.ba(c,"USE_REFRACTION",
0),sa.ba(c,"USE_REFRACTION_CORRECTION",0));a.Wg&&(ta.shore_smoothing&&a.Pm&&ba.$b(d,R.rx)?sa.ba(c,"SHORE_SMOOTHING",1):sa.ba(c,"SHORE_SMOOTHING",0),a.water_dynamic&&e&&e.waves_height?sa.ba(c,"DYNAMIC",1):sa.ba(c,"DYNAMIC",0));"PARTICLES"==a.type&&(sa.ba(c,"SIZE_RAMP_LENGTH",a.Ia.CR),sa.ba(c,"COLOR_RAMP_LENGTH",a.Ia.Ky));if(!a.of)for(a=a.T,d=0;d<a.length;d++)if(b=a[d],"SCENE"==b.source)for(h=0;h<Za.length;h++)for(c=Za[h],k=Za[h].ef,e=0;e<k.length;e++)k[e].p==b&&va.r(ac,c,f,null)}}function F(a){8<a.T.length&&
xa.warn(a.type,"too many textures used - "+a.T.length+' (max 8), materials "'+a.lc.join(", ")+'"')}function K(a,b,c){a.yd=b.yd;var d=b.yd[0],e=b.yd[1],f=b.yd[2];c=c.U;c=Math.max(c.max_x-c.min_x,c.max_z-c.min_z);f=0==f?c:Math.max(f,c);b.yd[2]=f;b=b.o;ia.hs(b,f/2,-e,-d,f/2);ia.bj(b);d=a.lo||0;d=0==d?c:Math.max(d,c);a.lo=d}function X(a,b,c,d,e,f){for(var g=b.k,h=Ba.fa(b,e).P,k=0;k<h.length;k++){var l=h[k];if(("MAIN"==l.type||"PARTICLES"==l.type||"LINE"==l.type)&&"REFLECT"==l.rb&&l.kb==d){if(a.type==
R.jd||a.type==R.df){var m;a:{var n=e.p.Mg.Lg;for(m=0;m<n.length;m++)for(var Y=0;Y<n[m].length;Y++)if(n[m][Y]==a)break a;n=e.p.Mg.Tr;for(m=0;m<n.length;m++)for(Y=0;Y<n[m].length;Y++)if(n[m][Y]==a)break a;m=null}if(m==g.Pd)continue}else if(m=pa(e,a),m==g.fe)continue;if(!f&&(W(l,a,b,c,"REFLECT",e),m=l.Va,sa.ba(m,"WATER_EFFECTS",0),sa.ba(m,"REFLECTION_PASS",1),sa.ba(m,"TEXTURE_NORM",0),a.type==R.jd&&sa.ba(m,"INVERT_FRONTFACING",1),!fa.gc(l)))if("DEBUG"===Bb.type())fa.Wp(l,"error.glslv","error.glslf"),
fa.gc(l);else continue;R.gf(a,R.Cg(l,g))}}}function N(a){Z(a);var b=ha(a,R.pb),c=!0,d=a.p.od;va.ma(a.p.Oa,function(e,f){f.type===R.Ac&&(P(f,a,b.o,d,c),c=!1)})}function L(a){va.ma(a.p.Oa,function(a,b){b.type===R.el&&(b.pu=1)})}function P(a,b,c,d,e){if(0!=a.za.length){var f=a.o,g=za.cc(c.m,Pc);za.set_trans(g,f.m);za.copy(c.ye,f.ap);if("SUN"===d.Rf[a.dg]||"HEMI"===d.Rf[a.dg]){g=nc;Ea.ZO(g);for(var h=0;h<a.za.length;h++)for(var k=a.za[h].ha,l=0;l<k.length;l++){var m=k[l].Jg;0==h&&0==l?Ea.oi(m.K,g):Ea.Yn(g,
m.K)}g=Ea.Zn(g,mc);Da.im(g,f.jb,g);if(d.enable_csm){b=La.copy(c.tg[a.cu],Pc);d=Ja.invert(c.jb,vc);Da.im(b,d,b);Da.im(b,f.jb,b);a=c.Kn[a.cu];if(e)for(Oc=0,Cc=-Infinity,e=2;e<g.length;e+=3)Oc=Math.min(Oc,g[e]),Cc=Math.max(Cc,g[e]);e=nc;e.max_x=b[0]+a;e.max_y=b[1]+a;e.max_z=Cc;e.min_x=b[0]-a;e.min_y=b[1]-a;e.min_z=Oc}else{c=e=nc;d=Pb;d.set(g);g=dd/9;h=Ja.identity(vc);Ja.rotate(h,g,Da.AXIS_MZ,h);l=k=-1;for(m=0;10>m;m++){var n=Ea.WF(d,fc),Y=(n.max_x-n.min_x)*(n.max_y-n.min_y);if(-1==k||Y<k)k=Y,l=m,Ea.oi(n,
c);Da.im(d,h,d)}c=l*g;0<c&&(g=Ja.identity(vc),Ja.rotate(g,c,Da.AXIS_MZ,g),Ja.multiply(g,f.jb,f.jb),za.from_mat4(f.jb,f.ye));c=e.max_x-e.min_x;g=e.max_y-e.min_y;c&&g&&(d=Math.abs(c-g)/2,2<c/g?(e.max_y+=d,e.min_y-=d):2<g/c&&(e.max_x+=d,e.min_x-=d));e.max_x+=.005;e.max_y+=.005;e.max_z+=.005;e.min_x-=.005;e.min_y-=.005;e.min_z-=.005;da(a,b.p.Oa)}ia.xM(f,e.min_x,e.max_x,e.min_y,e.max_y,-e.max_z,-e.min_z);ia.bj(f);Da.Al(f.Jc,f.Ag)}else"SPOT"!==d.Rf[a.dg]&&"POINT"!==d.Rf[a.dg]||ia.bj(f,f.$a)}}function da(a,
b){for(var c=a.o,d=ba.NJ(b,a),e=0;e<d.length;e++){var f=d[e];if(f.type==R.pb||f.type==R.Be||f.type==R.hc||f.type==R.Ae)if(ta.vr)f.cx.set(c.ye,9*a.dg);else{var g=za.get_trans_view(c.ye),h=za.get_scale(c.ye),k=za.get_quat_view(c.ye);bb.set(g[0],g[1],g[2],h,uc);f.Fs.set(uc,4*a.dg);f.Es.set(k,4*a.dg)}}}function U(a,b,c,d,e){for(var f=b.k,g=Ba.fa(b,d).P,h=0;h<g.length;h++){var k=g[h];if("COLOR_ID"==k.type&&(a.type==R.Xd&&"COLOR_ID"==k.rb||a.type==R.Zg&&"COLOR_ID_XRAY"==k.rb)){if(!e&&(W(k,a,b,c,"COLOR_ID",
d),fa.Sa(k,"USE_OUTLINE",0),!fa.gc(k)))continue;R.gf(a,R.Cg(k,f))}}}function ga(a,b,c,d,e){if(!d&&(e.kc&&(d=ba.$b(c,R.$g))&&K(e,d,b),!fa.gc(e)))if("DEBUG"===Bb.type())fa.Wp(e,"error.glslv","error.glslf"),fa.gc(e);else return;R.gf(a,R.Cg(e,b));S(c,a,e);F(e)}function T(a,b){la(a,b);for(var c=0;c<a.ee.length;c++)a.ee[c].parent==a&&T(a.ee[c],b)}function la(a,b){a.k.hide=b;if(Ba.is_lamp(a))for(var c=0;c<a.C.length;c++)for(var d=a.C[c],e=oa(d.Ra,kb),f=0;f<e.length;f++)Q(a,d,e[f])}function O(a,b){for(var c=
oa(b,kb),d=a.Pa,e=a.k,f=Ba.fa(a,b),g=f.vk,h=za.get_trans_view(e.m),e=za.get_quat_view(e.m),k=0;k<c.length;k++){var l=c[k];l.pr.set(h,3*g);l.bv.set(d.direction,3*g);l.or.set(d.Fn,3*g);switch(d.type){case "SUN":l.nC.set(e);l.mC=d.Fn;l.type===R.Zh?(l.Dr=d.RA,La.copy(d.direction,l.Dw),ma(b,l)):La.copy(d.direction,l.Dw);break;case "HEMI":case "POINT":case "SPOT":break;default:xa.error("Unknown light type: "+d.type+'".')}Q(a,f,l);for(var l=l.za,m=0;m<l.length;m++)for(var n=l[m].ha,Y=0;Y<n.length;Y++){var q=
n[Y].Y;q.Ci&&fa.AM(q,a)}}c=ha(b,R.pb).o;f=f.mw;d=b.p.od;for(k=0;k<f.length;k++)l=f[k],ia.lw(l.o,h,e),P(l,b,c,d,!0),da(l,b.p.Oa)}function Q(a,b,c){var d=a.k;a=a.Pa;b=b.vk;var e=Bc;e[0]=a.Km&&!d.hide?1:0;e[1]=a.Tk&&!d.hide?1:0;c.cv.set(e,2*b);c.qa=!0}function Z(a){var b=Oa.yb(a,"LAMP",Oa.DATA_ID_ALL),b=Ba.Lq(b,ta.ssao&&a.b4w_enable_ssao);if(b.length)for(var c=0;c<b.length;c++)for(var d=b[c],e=d.k,f=za.cc(e.m,Pc),e=za.xd(e.m,wb),g=0;g<d.C.length;g++){var h=d.C[g],k=h.mw;if(h.Ra==a)for(h=0;h<k.length;h++)ia.lw(k[h].o,
f,e)}}function ma(a,b){wa.Vr(b);Qa.yl(b);if(b.Dr)for(var c=oa(a,Na),d=0;d<c.length;d++)for(var e=c[d].za,f=0;f<e.length;f++)for(var g=e[f].ha,h=0;h<g.length;h++){var k=g[h];k.sb&&(k=k.Y,fa.tG(k)&&Qa.TN(k))}}function ra(a){for(var b=[],c=0;c<a.length;c++)for(var d=a[c].data,e=0;e<d.materials.length;e++){var f=d.materials[e];-1==b.indexOf(f)&&b.push(f)}return b}function ja(a,b,c){for(var d=a.p,e=Ba.fa(a.ai,a).R,f=0;f<e.length;f++){var g=e[f];ia.bj(g,b/c);d.od&&ia.Xw(g,d.od)}d.od&&(d.Er=!0,ha(a,R.Be).qa=
!0,ha(a,R.hc).qa=!0);var h=d.Oa;ba.KN(h,function(d,e,f){if(d.np){var g=d.Mk*b,k=d.Nk*c;if(e)for(e=0;e<f.Ha.length;e++)f.Ha[e]==d&&Ra.resize(d.Ja,g,k);else switch(Ra.Pl(d.Ja)&&Ra.resize(d.Ja,g,k),d=f.o,d.width=g,d.height=k,f.type){case R.Wm:ea(a,{dof_power:f.o.dof_power});break;case R.Xm:I(a,{small_glow_mask_width:f.small_glow_mask_width,large_glow_mask_width:f.large_glow_mask_width});break;case R.Tm:ka(a,{bloom_blur:f.bloom_blur});break;case R.el:f=ba.bb(h,f,R.Ab);g=ba.bb(h,f,R.Ab);k=ba.bb(h,g,R.Ab);
d=ba.bb(h,k,R.Ab);ba.fd(f,1/b,1/c);ba.fd(g,1/b,1/c);ba.fd(k,1/b,1/c);ba.fd(d,1/b,1/c);break;default:ba.fd(f,1/b,1/c)}}})}function oa(a,b){for(var c=[],d=0;d<b.length;d++){var e=b[d];va.ma(a.p.Oa,function(a,b){b.type==e&&c.push(b)})}return c}function ha(a,b){return ba.$b(a.p.Oa,b)}function ea(a,b){var c=ha(a,R.Wm);if(!c)return xa.error("DOF is not enabled on the scene. Check camera settings"),0;var d=c.o.Oc,e=d?oa(a,[R.Us]):[],f=a.p.Oa;if("boolean"==typeof b.dof_on&&(c.o.dof_on=b.dof_on,d))for(var g=
0;g<e.length;g++)e[g].o.dof_on=b.dof_on;if("number"==typeof b.dof_distance&&(c.o.dof_distance=b.dof_distance,d))for(g=0;g<e.length;g++)subs_coc.o.dof_distance=b.dof_distance;if("number"==typeof b.Qb&&(c.o.Qb=b.Qb,d))for(g=0;g<e.length;g++)e[g].o.Qb=b.Qb;if("number"==typeof b.Pb&&(c.o.Pb=b.Pb,d))for(g=0;g<e.length;g++)e[g].o.Pb=b.Pb;if("number"==typeof b.Sb&&(c.o.Sb=b.Sb,d))for(g=0;g<e.length;g++)e[g].o.Sb=b.Sb;if("number"==typeof b.Rb&&(c.o.Rb=b.Rb,d))for(g=0;g<e.length;g++)e[g].o.Rb=b.Rb;"number"==
typeof b.Ua&&(c.o.Ua=b.Ua,d&&(e=ba.Hu(f,c,R.Ab),e[0].o.Ua=b.Ua,e[1].o.Ua=b.Ua,e[0]=ba.bb(f,e[0],R.Ab),e[0].o.Ua=b.Ua));if("number"==typeof b.dof_power)if(d){d=b.dof_power;c.o.dof_power=d;var d=d/2,g=c.o.width,h=c.o.height,k=[1/g,0],l=[1/g*.5,1/h*.866],m=[-1/g*.5,1/h*.866],e=ba.Hu(f,c,R.Ab);ba.nc(e[0],d);ba.fd(e[0],m[0],m[1]);ba.nc(e[1],d);ba.fd(e[1],l[0],l[1]);e[0]=ba.bb(f,e[0],R.Ab);ba.nc(e[0],d);ba.fd(e[0],k[0],k[1]);c.o.$c&&(e[0]=ba.bb(f,e[0],R.Us),e[0]=ba.bb(f,e[0],R.Ab),ba.fd(e[0],1/g,1/h),e[0]=
ba.bb(f,e[0],R.Ab),ba.fd(e[0],1/g,1/h))}else c.o.dof_power=b.dof_power,e=ba.bb(f,c,R.Ab),f=ba.bb(f,e,R.Ab),ba.nc(e,c.o.dof_power),ba.fd(e,1/c.o.width,1/c.o.height),ba.nc(f,c.o.dof_power),ba.fd(f,1/c.o.width,1/c.o.height)}function ka(a,b){var c=ha(a,R.Ep),d=ha(a,R.Tm);if(!c||!d)return xa.error("Bloom is not enabled on the scene"),0;"number"==typeof b.bloom_key&&(c.bloom_key=b.bloom_key,c.qa=!0);"number"==typeof b.bloom_edge_lum&&(c.bloom_edge_lum=b.bloom_edge_lum,c.qa=!0);if("number"==typeof b.bloom_blur){var e=
a.p.Oa,c=ba.bb(e,d,R.Um),e=ba.bb(e,c,R.Um);d.bloom_blur=b.bloom_blur;ba.nc(c,b.bloom_blur);ba.fd(c,1/d.o.width,1/d.o.height);ba.nc(e,b.bloom_blur);ba.fd(e,1/d.o.width,1/d.o.height)}}function I(a,b){var c=ha(a,R.Xm);if(!c)return xa.error("Glow is not enabled on the scene"),null;for(var d=a.p.Oa,e=ba.JJ(d,c),f=0;f<e.length;++f){var g=e[f];if(g.type==R.Ab&&"GLOW_MASK_LARGE"==g.rb)var h=g;if(g.type==R.Ab&&"GLOW_MASK_SMALL"==g.rb)var k=g}e=ba.bb(d,h,R.Ab);d=ba.bb(d,k,R.Ab);"number"==typeof b.small_glow_mask_coeff&&
(c.small_glow_mask_coeff=b.small_glow_mask_coeff,c.qa=!0);"number"==typeof b.large_glow_mask_coeff&&(c.large_glow_mask_coeff=b.large_glow_mask_coeff,c.qa=!0);"number"==typeof b.small_glow_mask_width&&(c.small_glow_mask_width=b.small_glow_mask_width,ba.nc(k,b.small_glow_mask_width),ba.fd(k,1/c.o.width,1/c.o.height),k.qa=!0,ba.nc(d,b.small_glow_mask_width),ba.fd(d,1/c.o.width,1/c.o.height),d.qa=!0);"number"==typeof b.large_glow_mask_width&&(c.large_glow_mask_width=b.large_glow_mask_width,ba.nc(h,b.large_glow_mask_width),
ba.fd(h,1/c.o.width,1/c.o.height),h.qa=!0,ba.nc(e,b.large_glow_mask_width),ba.fd(e,1/c.o.width,1/c.o.height),e.qa=!0)}function Ia(a,b,c){var d=a.p,e=d.oc;if(!e.Un)return e.qj;var f=e.waves_height,g=e.waves_length,h=e.qj,k=La.length(d.Vh);a=ha(a,R.pb).time;k&&(a*=k);var l=Bc;l[0]=20/g*(b-.25*a);l[1]=20/g*(c-.25*a);k=Da.uy(l);l[0]=17/g*(c+.1*a);l[1]=17/g*(b+.1*a);var l=Da.uy(l),k=k+l-1,m=e.dst_noise_scale0,l=e.dst_noise_scale1,n=e.dst_noise_freq0,Y=e.dst_noise_freq1,q=Bc;q[0]=m*(b+n*a);q[1]=m*(c+n*
a);m=Da.sw(q);q[0]=l*(c-Y*a);q[1]=l*(b-Y*a);l=Da.sw(q);l*=f*m;if(e.cj)if(Y=(b-e.nm[0])/e.om[0],q=(e.nm[1]+c)/e.om[1],Y+=.5,q+=.5,1<Y||0>Y||1<q||0>q)e=l;else{var d=Da.Iz(d.nw,e.ow,Y,q),q=e.dir_freq,J=e.dir_noise_scale,t=e.dir_noise_freq,m=e.dir_min_noise_fac,Y=e.dst_min_fac,n=g/e.kv/Math.PI;c=[J/g*(b+t*a),J/g*(c+t*a)];b=Math.sqrt(d);e=f*Math.max(d,e.dir_min_shore_fac)*Math.sin(b/n+q*a)*Math.max(Da.sw(c),m);f=Math.max(b,Y);e=e*(1-f)+l*f;k*=d}else e=l;return h+(e+.05*k)}function Aa(a,b){a.so&&a.type==
R.Ab&&b.sb!=a.sb&&(a.sb=b.sb);b.sb||a.type!=R.el||(a.pu=0)}function qa(a,b,c,d){var e=va.Na(a,b);ia.gs(e.o,c,d);e.tt=!0;va.hj(a,b,function(b,e,f){f.ic&&f.from==c&&ba.HG(f)&&J(a,b,f.to,d)});va.Ug(a,b,function(b,e,f){f.ic&&f.from==c&&f.from==f.to&&qa(a,b,c,d)})}function J(a,b,c,d){a=va.Na(a,b).za;for(b=0;b<a.length;b++)for(var e=a[b].ha,f=0;f<e.length;f++)fa.XL(e[f].Y,d,c)}function aa(a){var b=ha(a,R.$g);if(b){var c=b.o,d=a.ai.k;a=za.cc(d.m,Pc);var e=Hb;e[0]=0;e[1]=-b.yd[2]/2;e[2]=0;b=za.xd(d.m,wb);
La.transformQuat(e,b,e);e[0]+=a[0];e[1]=0;e[2]+=a[2];gc.identity(b);ia.lw(c,e,b)}}function V(a,b){va.ma(a,function(c,d){if(d.type==R.Yh){d.Ha[0]&&d.Sg[0]||Da.q("Wrong MOTION_BLUR subscene");var e=d.Ha[0],f=d.Sg[0];d.Sg[0]=d.o.Zb;va.hj(a,c,function(b,c,d){d.ic&&J(a,b,d.to,f)});qa(a,c,e.from,f);J(a,c,e.to,d.Sg[0]);d.NA=Math.exp(-b/d.mb_factor)}})}function ca(a){return a.p.Vh}function pa(a,b){if(!a.p.Mg)return null;for(var c=a.p.Mg.jh,d=0;d<c.length;d++)if(c[d]==b)return d;c=a.p.Mg.du;for(d=0;d<c.length;d++)if(c[d]==
b)return d;return null}var fa=p("__batch"),Ea=p("__boundings"),ia=p("__camera"),na=p("__config"),Ca=p("__container"),ya=p("__debug"),va=p("__graph"),Ma=p("__hud"),Fa=p("__input"),Ja=p("__mat4"),Ka=p("__nodemat"),Oa=p("__objects"),Ba=p("__obj_util"),Y=p("__physics"),wa=p("__prerender"),ua=p("__primitives"),xa=p("__print"),gc=p("__quat"),Qa=p("__renderer"),ba=p("__scenegraph"),$b=p("__sfx"),sa=p("__shaders"),R=p("__subscene"),Ra=p("__textures"),za=p("__tsr"),Da=p("__util"),La=p("__vec3"),bb=p("__vec4"),
Bb=p("__version"),ta=na.v,Ua=na.mi,Ta=na.fc,Ya=na.Kk,jb=[R.$g,R.Ac,R.pb,R.hc,R.Ae,R.pd,R.jd,R.Kc,R.df,R.Yd,R.Xd,R.Zg,R.Be,R.kg,R.ze];a.wP=jb;var kb=[R.pb,R.hc,R.Ae,R.pd,R.jd,R.Kc,R.Xh,R.Dp,R.Zh,R.df,R.Yd,R.Ep,R.Be,R.Ac,R.Xd,R.Zg,R.kg],Na=[R.pb,R.Jp,R.hc,R.Ae,R.pd,R.jd,R.Kc,R.df,R.Yd],Xc=[R.Ac,R.pb,R.hc,R.Ae,R.pd,R.jd,R.Kc,R.df,R.Yd,R.Xd,R.Zg,R.Be,R.Xh,R.kg,R.ze],Yc=[R.pb,R.hc,R.Ae,R.pd,R.jd,R.Kc,R.df,R.Yd],Ac=null,Ib=null,Za=[],ac=null,dd=Math.PI/2,Bc=new Float32Array(2),Pc=new Float32Array(3),Hb=
new Float32Array(3),wb=new Float32Array(4),uc=new Float32Array(4),vc=new Float32Array(16),mc=new Float32Array(24),Pb=new Float32Array(24),nc=Ea.Wc(),fc=Ea.Wc(),Oc=0,Cc=-Infinity;a.aQ=function(){return{}};a.set_active=function(a){Ib=a;$b.jM(a)};a.HL=function(a,b){var c=a.p,d=ba.uH(c.Oa);if(a==b){ja(a,Ca.Xz(),Ca.Wz());for(var e=0;e<d.length;e++)a.p.Ik.push(d[e])}else for(e=a.ef[0],ja(a,e.p.Jh,e.p.Jh),e=0;e<d.length;e++)b.p.Ik.push(d[e]);d=oa(a,Xc);for(e=0;e<d.length;e++)d[e].Vh.set(c.Vh);for(e=0;e<
c.Ik.length;e++)c.Ik[e].type==R.Ac&&Qa.yl(c.Ik[e])};a.ik=function(){Ac||(Ac=e(Za));return Ac};a.Eq=e;a.get_active=c;a.ya=function(){return Ib?!0:!1};a.gk=function(a){return a.ai};a.io=function(){return Za};a.Iu=function(){if(1==Za.length)return Za;for(var a=0;a<Za.length;a++){var b=Za[a].p.Oa;va.ma(b,function(b,c){for(var d=c.za,e=0;e<d.length;e++)for(var f=d[e].ha,g=0;g<f.length;g++){for(var h=f[g].Y.T,k=null,l=0;l<h.length;l++)if("SCENE"==h[l].source&&h[l].dp==Za[a].name&&c.type!=R.Ws){xa.error('Texture-scene loop detected. A scene is rendered to texture "'+
h[l].name+'" yet this texture belongs to the same scene.');va.Uf(ac,Za[a]);k=f[g].Y;break}k&&(k.T=[],k.Uc=[],fa.SN(k,null),fa.gc(k))}})}for(var c=[],a=0;a<Za.length;a++)if(b=Za[a],!b.ef.length){b=va.Uf(ac,b);va.DI(ac,b);b=va.ss(ac,b,va.zp);b=va.Nw(b);va.ma(b,function(a,b){c.push(b)});break}return c};a.qF=function(a,c,e,n,Y){a.ef=a.ef||[];a.ja=null;var J=a.p,wa=Ba.fa(a.ai,a),p=a.ai.k;J.Nm=[];var V=a.world;J.wK=e.length;J.Oh=h(e);J.os=d(V,J.Oh);J.kx=A(V,J.os);J.hD=G(V);if(V=!a.ef.length)a:{if("HMD"==
ta.stereo){if(wa.R[0].type!=ia.kd){xa.warn("Head-mounted display stereo is disabled for the non-perspective camera");ta.stereo="NONE";V=!1;break a}if(!Fa.can_use_device(Fa.DEVICE_HMD)){xa.warn("Head-mounted display stereo is disabled for the non-WebVR and non-mobile devices");ta.stereo="NONE";V=!1;break a}}V="HMD"==ta.stereo}J.no=V;if(V=!a.ef.length)wa.R[0].type!=ia.kd&&"ANAGLYPH"==ta.stereo?(xa.warn("Anaglyph stereo is disabled for the non-perspective camera"),ta.stereo="NONE",V=!1):V="ANAGLYPH"==
ta.stereo;J.anaglyph_use=V;J.hF=!J.no&&!J.anaglyph_use&&z(a,Y);J.Mg=B(a,c,n);J.aG=f(a);J.dL=H(a);J.rG=D(a);J.VJ=w(a);J.sL=E(a);J.ui=y(a);J.dof=ta.dof&&(0<p.dof_distance||p.tc);J.motion_blur=ta.motion_blur&&a.b4w_enable_motion_blur;J.ql=ta.ql&&a.b4w_enable_color_correction;J.antialiasing=ta.antialiasing&&1==ta.xc&&"NONE"!=a.b4w_antialiasing_quality;J.ssao=ta.ssao&&a.b4w_enable_ssao;J.god_rays=ta.god_rays&&a.b4w_enable_god_rays&&J.Oh;J.nI=ta.xq;J.Mq=a.b4w_glow_settings.render_glow_over_blend;J.sN=l(a);
Y=q(n);J.GA=Y;J.refractions=u(a,Y);J.od=b(a,e,n);J.oc=m(n);J.jg=v(n);J.cN=g(n);J.shore_smoothing=r(n);J.kc=x(a,n);J.UG=!J.no&&!J.anaglyph_use&&k(a,n);J.outline=t(a,n);J.sh=M(a,n);switch(a.b4w_reflection_quality){case "LOW":J.kh=Ya.Uy;J.Gk=Ya.kB;break;case "MEDIUM":J.kh=Ya.gI;J.Gk=Ya.DL;break;case "HIGH":J.kh=Ya.fI;J.Gk=Ya.CL;break;default:J.kh=Ya.Uy,J.Gk=Ya.kB}if(Ca.mK())xa.log("%cENABLE HIDPI MODE","color: #00a"),J.Jx="AA_QUALITY_LOW",J.re=1,ta.xc=1;else if(1<ta.xc)xa.log("%cENABLE MSAA RENDERING: "+
ta.xc+"x","color: #00a"),J.re=1;else{J.Jx="AA_QUALITY_"+a.b4w_antialiasing_quality;switch(a.b4w_antialiasing_quality){case "LOW":J.antialiasing&&(J.re=1);break;case "MEDIUM":ta.quality==na.P_LOW||ta.quality==na.P_HIGH?J.re=1:ta.quality==na.P_ULTRA&&(J.re=1.33);break;case "HIGH":ta.quality==na.P_LOW?J.re=1:ta.quality==na.P_HIGH?J.re=1.33:ta.quality==na.P_ULTRA&&(J.re=2);break;case "NONE":ta.quality==na.P_LOW||ta.quality==na.P_HIGH?J.re=1:ta.quality==na.P_ULTRA&&(J.re=2)}ta.quality==na.P_CUSTOM&&(J.re=
1)}e=a.ef.sort(function(a,b){return b.p.Jh-a.p.Jh});J.Oa=ba.tH(J,wa,p,e);J.Ik=[];J.Er=!1;J.yv=!1;J.zv=!1;J.Vh=new Float32Array(3);Za.push(a);ac||(ac=va.create());va.F(ac,a);for(J=0;J<c.length;J++)Ba.hw(c[J],!0,a);a=Ca.get_container();Ca.resize(a.clientWidth,a.clientHeight,!0)};a.rF=function(a,b,c){for(var d=0;d<b.length;d++)b[d].p&&b[d].p.tk&&(b[d].p.hg=c,a.p.Nm.push(b[d]))};a.Gu=function(a){return a.p.Oa};a.Cz=function(a){va.ma(a,function(b,c){var d=null;switch(c.type){case R.Ab:d=fa.Yt(c.Ur);break;
case R.Jp:d=fa.AH(c);break;case R.jt:d=fa.BH(c);break;case R.rx:d=fa.fH();break;case R.Xh:ba.bb(a,c,R.fl)||ba.bb(a,c,R.ze)||ba.bb(a,c,R.hc)||ba.bb(a,c,R.Xh);d=fa.jH(c.fB,c.Wg,c.ym);break;case R.Dp:ba.bb(a,c,R.fl)||ba.bb(a,c,R.ze)||ba.bb(a,c,R.hc);ba.bb(a,c,R.Xh);d=fa.kH();break;case R.Yh:d=fa.oH();break;case R.Us:d=fa.bH(c.Hy);break;case R.Wm:var d=fa.gH(c),e=c.o.dof_power;if(c.o.Oc){var e=e/2,f=ba.Hu(a,c,R.Ab);ba.nc(f[0],e);ba.nc(f[1],e);f[0]=ba.bb(a,f[0],R.Ab);ba.nc(f[0],e)}else{var f=ba.bb(a,c,
R.Ab),g=ba.bb(a,f,R.Ab);ba.nc(f,e);ba.nc(g,e)}break;case R.el:var d=fa.pH(),e=ba.bb(a,c,R.Ab),f=ba.bb(a,e,R.Ab),g=ba.bb(a,f,R.Ab),h=ba.bb(a,g,R.Ab);ba.nc(f,c.xt);ba.nc(e,c.xt);ba.nc(h,c.uu*c.Eo);ba.nc(g,c.uu*c.Eo);break;case R.Xm:d=fa.iH();break;case R.Vs:d=fa.dH();break;case R.lx:d=fa.YG(c);break;case R.ht:case R.Hp:case R.Ym:case R.Ip:d=fa.yH(c.type);break;case R.Kp:d=fa.CH(c.rb);break;case R.Zh:d=fa.sH();break;case R.LUMINANCE:d=fa.lH();break;case R.jD:d=fa.ZG();break;case R.Ep:d=fa.mH();break;
case R.Um:d=fa.$G();break;case R.Tm:d=ba.bb(a,c,R.Um);e=ba.bb(a,d,R.Um);ba.nc(d,c.bloom_blur);ba.nc(e,c.bloom_blur);d=fa.aH();break;case R.UE:d=fa.bI();break;case R.cl:d=fa.XG();break;case R.Gp:d=fa.qH()}d&&(e=R.Cg(d,Ba.rl("NONE")),R.gf(c,e),S(a,c,d),F(d))})};a.append_object=function(a,b,c){switch(b.type){case "MESH":case "LINE":case "WORLD":var d=a.p.Oa,e=b.k;!ba.$b(d,R.Ac)&&e.Tc&&(e.Tc=!1);e=oa(a,jb);c&&b.Sk&&Y.append_object(b,a);for(var f=0;f<e.length;f++){var g=e[f],h=b,k=d,l=a,m=c;switch(g.type){case R.pb:C(g,
h,k,"OPAQUE",l,m);break;case R.hc:C(g,h,k,"BLEND",l,m);break;case R.Ae:C(g,h,k,"XRAY",l,m);break;case R.pd:C(g,h,k,"GLOW",l,m);break;case R.jd:case R.Kc:X(g,h,k,!1,l,m);break;case R.df:case R.Yd:X(g,h,k,!0,l,m);break;case R.Be:for(var n=Ba.fa(h,l).P,J=0;J<n.length;J++){var q=n[J];if("SHADOW"==q.type&&"RECEIVE"==q.rb&&q.Tc){if(!m&&(W(q,g,h,k,"SHADOW",l),!fa.gc(q)))continue;R.gf(g,R.Cg(q,h.k));S(k,g,q);F(q)}}break;case R.Ac:for(var n=!1,J=h.k,h=Ba.fa(h,l).P,q=ba.$b(k,R.$g),t=0;t<h.length;t++){var r=
h[t];if("SHADOW"==r.type&&"CAST"==r.rb){n=!0;if(!m){var v=g.Ir;fa.Sa(r,"NUM_LIGHTS",v);fa.Sa(r,"NUM_LFACTORS",0==v%2?v/2:Math.floor(v/2)+1);sa.ba(r.Va,"SHADOW_USAGE","SHADOW_CASTING");r.kc&&q&&K(r,q,J);fa.Sa(r,"SHADOW_TEX_RES",sa.D(l.p.od.csm_resolution));if(!fa.gc(r))continue}R.gf(g,R.Cg(r,J))}}n&&(h=l.p.od,m=ba.$b(k,R.pb),P(g,l,m.o,h,!0));break;case R.Xd:U(g,h,k,l,m);break;case R.Zg:U(g,h,k,l,m);break;case R.kg:n=h.k;J=Ba.fa(h,l).P;for(q=0;q<J.length;q++)if(t=J[q],"COLOR_ID"==t.type&&"OUTLINE"==
t.rb){if(!m&&(W(t,g,h,k,"COLOR_ID",l),fa.Sa(t,"USE_OUTLINE",1),!fa.gc(t)))continue;R.gf(g,R.Cg(t,n))}break;case R.$g:k=h.k;h=Ba.fa(h,l).P;for(l=0;l<h.length;l++)if(n=h[l],"GRASS_MAP"==n.type){if(!m&&!fa.gc(n))if("DEBUG"===Bb.type())fa.Wp(n,"error.glslv","error.glslf"),fa.gc(n);else continue;R.gf(g,R.Cg(n,k));n=g.o;r=k.K;J=g.yd[0];q=g.yd[1];t=g.yd[2];0==J&&0==q?(J=r.min_y,q=r.max_y):(J=Math.min(J,r.min_y),q=Math.max(q,r.max_y));r=1E-4*(q-J);J-=r;q+=r;g.yd[0]=J;g.yd[1]=q;ia.hs(n,t/2,-q,-J,t/2);ia.bj(n)}break;
case R.ze:for(n=h.k,h=Ba.fa(h,l).P,l=0;l<h.length;l++)J=h[l],"DEBUG_VIEW"==J.type&&ga(g,n,k,m,J)}}break;case "LAMP":O(b,a),Oa.gN(a)}Ba.hw(b,!0,a)};a.iw=function(a){a.p.Er=!0};a.mO=function(a,b){va.ma(b,function(b,c){if(c.type===R.Ac){var d=za.cc(a.m,Pc);za.set_trans(d,c.o.m);za.copy(a.ye,c.o.ap)}})};a.QR=da;a.zJ=function(a,b){for(var c=a.p.od,d=new Float32Array(c.csm_num),e=0;e<c.csm_num;e++)d[e]=ia.eI(c,b,e);return d};a.EP=ga;a.vy=T;a.vn=la;a.is_hidden=function(a){return a.k.hide};a.PL=function(a){for(var b=
0;b<a.C.length;b++)for(var c=oa(a.C[b].Ra,jb),b=0;b<c.length;b++)for(var d=c[b].za,e=0;e<d.length;e++)for(var f=d[e].ha,g=f.length-1;0<=g;g--){var h=f[g];h.Jg==a.k&&(h.Y&&fa.Gy(h.Y),f.splice(g,1))}};a.bO=function(a,b){for(var c=a.Pa,d=Ba.fa(a,b).vk,e=oa(b,kb),f=0;f<e.length;f++){var g=e[f];g.or.set(c.Fn,3*d);g.qa=!0}};a.Jm=O;a.cleanup=function(){for(var a=0;a<Za.length;a++){var b=Za[a];va.ma(b.p.Oa,function(a,b){if(b.type!=R.hl){var c=b.o;Qa.RL(c.je,c.Zb,c.ge,c.width,c.height);for(var c=b.za,d=0;d<
c.length;d++)for(var e=c[d].ha,f=0;f<e.length;f++){var g=e[f].Y;g&&fa.Gy(g)}}});b.p.Oa=[];b.p.Ik=[]}Ib=Ac=null;Za.length=0;ac=null};a.FA=function(a,b,c){a=ia.KI(a,a.near,a.far,null,!0);var d=ua.iJ(a);a=Ba.rl("DYNAMIC");a.K=a.U={max_x:1E12,min_x:-1E12,max_y:1E12,min_y:-1E12,max_z:1E12,min_z:-1E12};a.Dc=a.jf=Ea.YF();var e=a.Dc.Za;a.Z=a.Ca=Ea.nn([e,0,0],[0,e,0],[0,0,e],a.Dc.J);c=fa.xH(d,c);R.gf(b,R.Cg(c,a))};a.IQ=function(a){return[a.frame_start,a.frame_end]};a.NB=function(a,b,c){Ca.XM(a,b,c);Ib&&ja(Ib,
a,b)};a.zR=ja;a.Bw=oa;a.Ba=ha;a.get_environment_colors=function(a){a=ha(a,R.pb);var b=a.Oe,c=a.cf,d=[],e=[];d[0]=b[0];d[1]=b[1];d[2]=b[2];e[0]=c[0];e[1]=c[1];e[2]=c[2];return[a.ph,d,e]};a.set_environment_colors=function(a,b,c,d){a=oa(a,kb);for(var e=0;e<a.length;e++){var f=a[e];f.Oe.set(c);f.cf.set(d);f.ph=b;f.qa=!0}};a.get_sky_params=function(a){if(a=ha(a,R.Zh)){var b={};b.color=Array(3);La.copy(a.qm,b.color);b.procedural_skydome=a.procedural_skydome;b.use_as_environment_lighting=a.use_as_environment_lighting;
b.rayleigh_brightness=a.rayleigh_brightness;b.mie_brightness=a.mie_brightness;b.spot_brightness=a.spot_brightness;b.scatter_strength=a.scatter_strength;b.rayleigh_strength=a.rayleigh_strength;b.mie_strength=a.mie_strength;b.rayleigh_collection_power=a.rayleigh_collection_power;b.mie_collection_power=a.mie_collection_power;b.mie_distribution=a.mie_distribution;return b}return null};a.set_sky_params=function(a,b){var c=ha(a,R.Zh);c&&("number"==typeof b.procedural_skydome&&(c.procedural_skydome=b.procedural_skydome),
"number"==typeof b.use_as_environment_lighting&&(c.use_as_environment_lighting=b.use_as_environment_lighting),"object"==typeof b.color&&c.qm.set(b.color),"number"==typeof b.rayleigh_brightness&&(c.rayleigh_brightness=b.rayleigh_brightness),"number"==typeof b.mie_brightness&&(c.mie_brightness=b.mie_brightness),"number"==typeof b.spot_brightness&&(c.spot_brightness=b.spot_brightness),"number"==typeof b.scatter_strength&&(c.scatter_strength=b.scatter_strength),"number"==typeof b.rayleigh_strength&&(c.rayleigh_strength=
b.rayleigh_strength),"number"==typeof b.mie_strength&&(c.mie_strength=b.mie_strength),"number"==typeof b.rayleigh_collection_power&&(c.rayleigh_collection_power=b.rayleigh_collection_power),"number"==typeof b.mie_collection_power&&(c.mie_collection_power=b.mie_collection_power),"number"==typeof b.mie_distribution&&(c.mie_distribution=b.mie_distribution),c.qa=!0,c.Dr=!0,ma(a,c))};a.FQ=function(a){return oa(a,Na)[0].nf[0]};a.DQ=function(a){return oa(a,Na)[0].nf[1]};a.GQ=function(a){return oa(a,Na)[0].nf[2]};
a.EQ=function(a){return oa(a,Na)[0].nf[3]};a.tM=function(a,b){for(var c=oa(a,Na),d=0;d<c.length;d++){var e=c[d];e.nf[0]=b;e.qa=!0}};a.rM=function(a,b){for(var c=oa(a,Na),d=0;d<c.length;d++){var e=c[d];e.nf[1]=b;e.qa=!0}};a.uM=function(a,b){for(var c=oa(a,Na),d=0;d<c.length;d++){var e=c[d];e.nf[2]=b;e.qa=!0}};a.sM=function(a,b){for(var c=oa(a,Na),d=0;d<c.length;d++){var e=c[d];e.nf[3]=b;e.qa=!0}};a.get_fog_color_density=function(a,b){var c=b||[],d=oa(a,Na)[0].Ld;c[0]=d[0];c[1]=d[1];c[2]=d[2];c[3]=
d[3];return c};a.set_fog_color_density=function(a,b){for(var c=oa(a,Na),d=0;d<c.length;d++){var e=c[d];e.Ld.set(b);e.qa=!0}};a.get_ssao_params=function(a){var b=ha(a,R.Jp);a=ha(a,R.jt);if(!b)return null;var c=b.za[0].ha[0].Y,d={};d.ssao_quality=fa.bd(c,"SSAO_QUALITY")[1];d.ssao_hemisphere=b.ssao_hemisphere;d.ssao_blur_depth=a.ssao_blur_depth;d.iy=a.ssao_blur_discard_value;d.radius_increase=b.um;d.influence=b.tm;d.dist_factor=b.sm;d.ssao_only=b.ssao_only;d.ssao_white=fa.bd(c,"SSAO_WHITE")[1];return d};
a.set_ssao_params=function(a,b){var c=ha(a,R.Jp),d=ha(a,R.jt);if(!c)return xa.error("SSAO is not enabled on the scene"),0;if("string"==typeof b.ssao_quality){var e=c.za[0].ha[0].Y;fa.Sa(e,"SSAO_QUALITY",b.ssao_quality);fa.gc(e)}"number"==typeof b.ssao_hemisphere&&(e=c.za[0].ha[0].Y,fa.Sa(e,"SSAO_HEMISPHERE",b.ssao_hemisphere),fa.gc(e));"number"==typeof b.ssao_blur_depth&&(e=d.za[0].ha[0].Y,fa.Sa(e,"SSAO_BLUR_DEPTH",b.ssao_blur_depth),fa.gc(e));"number"==typeof b.ssao_blur_discard_value&&(d.ssao_blur_discard_value=
b.ssao_blur_discard_value);"number"==typeof b.um&&(c.um=b.um);"number"==typeof b.tm&&(c.tm=b.tm);"number"==typeof b.sm&&(c.sm=b.sm);if("number"==typeof b.ssao_only){c=ha(a,R.pb);c.ssao_only=b.ssao_only;for(var f=c.za,g=0;g<f.length;g++)for(var h=f[g].ha,k=0;k<h.length;k++)e=h[k].Y,fa.Sa(e,"SSAO_ONLY",b.ssao_only),fa.gc(e)}"number"==typeof b.ssao_white&&(e=c.za[0].ha[0].Y,fa.Sa(e,"SSAO_WHITE",b.ssao_white),fa.gc(e));c.qa=!0;d.qa=!0};a.get_dof_params=function(a){a=ha(a,R.Wm);if(!a)return null;var b=
{};b.dof_distance=a.o.dof_distance;b.Qb=a.o.Qb;b.Pb=a.o.Pb;b.Sb=a.o.Sb;b.Rb=a.o.Rb;b.dof_power=a.o.dof_power;b.Oc=a.o.Oc;b.Ua=a.o.Ua;b.tc=a.o.tc;return b};a.set_dof_params=ea;a.get_god_rays_params=function(a){var b=oa(a,[R.Xh]);a=ha(a,R.Dp);if(!b||!a)return null;var c={};c.god_rays_max_ray_length=b[0].Vl;c.god_rays_intensity=a.god_rays_intensity;c.god_rays_steps=fa.bd(b[0].za[0].ha[0].Y,"STEPS_PER_PASS")[1];return c};a.set_god_rays_params=function(a,b){var c=oa(a,[R.Xh]),d=ha(a,R.Dp);if(!c||!d)return xa.error("God Rays are not enabled on the scene"),
0;"number"==typeof b.god_rays_intensity&&(d.god_rays_intensity=b.god_rays_intensity);if("number"==typeof b.god_rays_max_ray_length)for(var e=b.god_rays_max_ray_length,f=0;f<c.length;f++)c[f].Vl=e,c[f].Zr=e/c[f].ym/(f+1),c[f].qa=!0;if("number"==typeof b.god_rays_steps)for(var g=sa.D(b.god_rays_steps,1),e=c[0].Vl,f=0;f<c.length;f++){c[f].ym=g;c[f].Zr=e/g/(f+1);c[f].qa=!0;var h=c[f].za[0].ha[0].Y;fa.Sa(h,"STEPS_PER_PASS",g);fa.gc(h)}d.qa=!0};a.get_bloom_params=function(a){var b=ha(a,R.Ep);a=ha(a,R.Tm);
if(!b||!a)return null;var c={};c.bloom_key=b.bloom_key;c.bloom_edge_lum=b.bloom_edge_lum;c.bloom_blur=a.bloom_blur;return c};a.set_bloom_params=ka;a.get_glow_material_params=function(a){a=ha(a,R.Xm);if(!a)return null;var b={};b.small_glow_mask_coeff=a.small_glow_mask_coeff;b.large_glow_mask_coeff=a.large_glow_mask_coeff;b.small_glow_mask_width=a.small_glow_mask_width;b.large_glow_mask_width=a.large_glow_mask_width;return b};a.set_glow_material_params=I;a.get_wind_params=function(a){var b=ca(a);a=
La.length(b);if(0==a)return null;var b=Da.rad_to_deg(Math.atan2(b[0],b[2])),c={};c.wind_dir=b;c.wind_strength=a;return c};a.gM=function(a){a.p.yv=!0};a.get_water_surface_level=Ia;a.get_water_mat_params=function(a,b){var c=a.p.oc,d=ha(a,R.pb);d&&c&&(b.waves_height=c.waves_height,b.waves_length=c.waves_length,d.Xg&&(b.water_fog_density=d.Xg[3],c=b.water_fog_color=[],c[0]=d.Xg[0],c[1]=d.Xg[1],c[2]=d.Xg[2]))};a.set_water_params=function(a,b){var c=a.p.oc;if(!c)return xa.error("set_water_params() - no water parameters on the scene"),
null;"number"==typeof b.dst_noise_scale0&&(c.dst_noise_scale0=b.dst_noise_scale0);"number"==typeof b.dst_noise_scale1&&(c.dst_noise_scale1=b.dst_noise_scale1);"number"==typeof b.dst_noise_freq0&&(c.dst_noise_freq0=b.dst_noise_freq0);"number"==typeof b.dst_noise_freq1&&(c.dst_noise_freq1=b.dst_noise_freq1);"number"==typeof b.dir_min_shore_fac&&(c.dir_min_shore_fac=b.dir_min_shore_fac);"number"==typeof b.dir_freq&&(c.dir_freq=b.dir_freq);"number"==typeof b.dir_noise_scale&&(c.dir_noise_scale=b.dir_noise_scale);
"number"==typeof b.dir_noise_freq&&(c.dir_noise_freq=b.dir_noise_freq);"number"==typeof b.dir_min_noise_fac&&(c.dir_min_noise_fac=b.dir_min_noise_fac);"number"==typeof b.dst_min_fac&&(c.dst_min_fac=b.dst_min_fac);"number"==typeof b.waves_hor_fac&&(c.waves_hor_fac=b.waves_hor_fac);"number"==typeof b.water_dynamic&&(c.Un=b.water_dynamic);for(var d=oa(a,Yc),e=0;e<d.length;e++){var f=d[e];"number"==typeof b.water_fog_density&&c.Ld&&(f.Xg[3]=b.water_fog_density);"object"==typeof b.water_fog_color&&c.Ld&&
f.Xg.set(b.water_fog_color);"number"==typeof b.waves_height&&(f.fx=b.waves_height);"number"==typeof b.waves_length&&(f.gx=b.waves_length);f.qa=!0}};a.get_shore_dist=function(a,b,c){var d=a.p.oc;if(!d.cj)return 100;var e=d.kv;a=d.qj;var f=(b[0]-d.nm[0])/d.om[0],g=(d.nm[1]+b[2])/d.om[1],f=f+.5,g=g+.5;if(1<f||0>f||1<g||0>g)b=1;else return d=e*Da.Iz(Ib.p.nw,d.ow,f,g),b=(a-b[1])*c,b=Math.sqrt(d*d+b*b)};a.update=function(a,b){for(var d=c().ai.k,e=0;e<Za.length;e++){var f=Za[e],g=f.p.Oa,h=f.p;if(h.oc)var k=
za.get_trans_view(d.m),l=k[1]-Ia(f,k[0],k[2]);for(k=0;k<h.Nm.length;k++){var m=h.Nm[k].p,n=m.sa,Y=m.Sc;if(!(f.b4w_use_nla&&m.Lm||!n&&!Y)&&Ra.bD(m)){var J=Ra.ZC(m),q=Ra.aD(m);n&&ta.is_mobile_device&&(q-=5);var t=Ra.MO(m);J>=t&&m.Sh||J<q?(Ra.reset_video(m.name,m.hg),Y&&(m.aj=Ra.fs(m,a))):J>=t&&!m.Sh?Ra.pause_video(m.name,m.hg):Ra.cD(m)&&(n?Ra.NC(m):(n=Ra.fs(m,a),n!=m.aj&&(Ra.MC(m),m.Ih++),m.aj=n))}}va.ma(g,function(b,c){-1<Xc.indexOf(c.type)&&(c.time=a);h.oc&&(c.Gt=l)})}for(e=0;e<Za.length;e++)if(f=
Za[e],h=f.p,g=h.Oa,d=h.Ik,d.length)for(h.Er&&(N(f),h.Er=!1),h.yv&&(aa(f),h.yv=!1),h.zv&&(L(f),h.zv=!1),h.motion_blur&&V(g,b),f=ba.$b(g,R.kg),k=0;k<d.length;k++)g=d[k],wa.Vr(g),f&&Aa(g,f),Qa.yl(g);ta.show_hud_debug_info&&Ma.$M(Za,b)};a.YL=function(a){a.p.zv=!0};a.Au=function(a){var b=[];va.ma(a.p.Oa,function(a,c){b.push(c)});return b};a.get_cam_water_depth=function(){var a=ha(Ib,R.hc),b=Ib;return a||b.p.oc?a.Gt:null};a.LC=function(a){va.ma(a.p.Oa,function(a,b){b.qa=!0})};a.mM=function(a,b){a.debug_view_mode=
b;a.sb=b!=ya.DV_NONE;a.kb=b==ya.DV_TRANSPARENT_WIREFRAME;a.qa=!0;for(var d=c(),e=0;e<Yc.length;e++){var f=ha(d,Yc[e]);f&&(f.nu=b==ya.DV_RENDER_TIME)}};a.lM=function(a,b){a.debug_colors_seed=b;a.qa=!0};a.LM=function(a,b){a.Xy=b;a.qa=!0};a.SM=function(a,b){for(var c=a.za,d=0;d<c.length;d++)for(var e=c[d].ha,f=0;f<e.length;f++){var g=e[f].Y;La.copy(b,g.wireframe_edge_color);g.qa=!0}};a.IC=function(a,b){var c=b.Bl,d=a.p.Vh;if(c&&"WIND"==c.type&&d){var e=za.get_quat_view(b.k.m);Da.quat_to_dir(e,Da.AXIS_Y,
d);La.normalize(d,d);La.scale(d,c.kC,d);c=oa(a,Xc);for(e=0;e<c.length;e++)c[e].Vh.set(d);return!0}return!1};a.xL=function(a,b,c){var d=ha(a,R.Xd);if(d){var e=Ca.get_canvas();ia.kM(d.o,b,c,e.clientWidth,e.clientHeight);wa.Vr(d);d.sb&&Qa.yl(d);if(a=ha(a,R.Zg))Ja.copy(d.o.Ya,a.o.Ya),Ja.copy(d.o.Jc,a.o.Jc),Da.Al(a.o.Jc,a.o.Ag),wa.Vr(a),a.sb&&Qa.yl(a);if(d.sb||a&&a.sb)return Qa.Wv(a?a.o.je:d.o.je,0,0)}else xa.error("Object Selection is not available on the scene");return null};a.set_outline_color=function(a){var b=
c();if(b=ha(b,R.el))b.Dh.set(a),b.qa=!0};a.MQ=ca;a.get_meta_tags=function(a){var b={title:"",description:""};a.b4w_tags&&(b.title=a.b4w_tags.title,b.description=a.b4w_tags.description);return b};a.HC=function(a,b){var c=Pc;La.negate(b,c);for(var d=0;6>d;d++){var e=a.Rj[d],f=a.Ln[d],g=a.o;Ja.translate(Da.vD[d],c,e);Ja.multiply(g.Ya,e,g.Jc);Da.Al(g.Jc,f)}};a.JC=function(a,b,c){Da.HN(b,c,Da.AXIS_Y,a.o.Fb)};a.OF=function(a,b,c){var d=a.p.od,e=a.p.Mg;c=Ba.Lq(c,ta.ssao&&a.b4w_enable_ssao);if(e)for(var f=
0;f<b.length;f++){var g=b[f],h=Ba.fa(g,a);if(-1!=g.k.Pd){var k=e.Lg,l=e.Tr,g=g.k.Pd;l.length?h.Lg=l[g]:k.length&&(h.Lg=k[g])}else-1!=g.k.fe&&(k=e.jh,l=e.du,g=g.k.fe,l.length?h.jh=l[g]:k.length&&(h.jh=k[g]))}for(f=0;f<c.length;f++)if(h=Ba.fa(c[f],a),d)for(b=oa(a,[R.Ac]),e=0;e<b.length;e++)f==b[e].dg&&h.mw.push(b[e])};a.marker_frame=function(a,b){return a.timeline_markers[b]};a.set_hmd_params=function(a){var b=c();if(b=ha(b,R.Kp))a.distortion_coefs&&(b.Tj[0]=a.distortion_coefs[0],b.Tj[1]=a.distortion_coefs[1],
b.qa=!0),a.chromatic_aberration_coefs&&(b.chromatic_aberration_coefs[0]=a.chromatic_aberration_coefs[0],b.chromatic_aberration_coefs[1]=a.chromatic_aberration_coefs[1],b.chromatic_aberration_coefs[2]=a.chromatic_aberration_coefs[2],b.chromatic_aberration_coefs[3]=a.chromatic_aberration_coefs[3],b.qa=!0),a.base_line_factor&&(b.Tj[2]=a.base_line_factor,b.qa=!0),a.inter_lens_factor&&(b.Tj[3]=a.inter_lens_factor,b.qa=!0),a.enable_hmd_stereo&&(b.enable_hmd_stereo=a.enable_hmd_stereo,b.qa=!0)};a.OA=function(b,
c){for(var d=Za,e=0;e<d.length;e++)ba.jL(a.Gu(d[e]),b,c)}};b4w.module.__physics=function(a,p){function e(a,b){for(var c=a.ee,d=0;d<c.length;d++)c[d].Zf.pp&&b.push(c[d]),e(c[d],b)}function c(a,b,c){for(var d=a.Wb.ha,e=0;e<d.length;e++)for(var f=d[e].A,g=0;g<f.ce.length;g++){var h=f.ce[g];"ANY"!=h.xb&&c!=h.xb||A(h,a,b)}}function b(a,b,c){if(F.er(a))switch(b){case F.ED:var d=n(a);d.Wb.gD=!0;F.S(a,F.uE,Date.now()-performance.now(),O.max_fps,O.Dt?Q.uz:0);break;case F.FD:X.Qe("URANIUM:",c.slice(1));break;case F.AD:X.error(c);break;case F.BD:W.fbmsg.apply(this,
c.slice(1));break;case F.KD:var e=h(c.M);if(e){a=c.trans;d=c.quat;b=c.Eg;var f=c.ng,e=e.A;e.rq=c.time;U.set_sep(a,1,d,e.fu);T.copy(b,e.Eg);T.copy(f,e.ng)}break;case F.HD:(a=h(c.Ht))&&U.set_sep(c.trans,1,c.quat,a.s.Mo[c.Qv]);break;case F.CD:if(d=h(c[1]))a=c[4],d=d.mf.bq[c[2]],da.set_translation(d,c[3]),da.set_rotation(d,a),da.u(d);break;case F.LD:if(e=h(c[1]))e.s.speed=c[2];break;case F.wD:d=n(a);r(d,c.Ej,c.Fj,c.result,null,null,0);break;case F.yD:d=n(a);r(d,c.Ej,c.Fj,c.result,c.Lj,c.coll_norm,c.coll_dist);
break;case F.xD:if(e=h(c[1]))a=e.A,a.Kj&&a.Kj(c[2]);break;case F.tx:case F.ID:d=n(a);if(a=d.Wb.Vi[c.id])if(d=h(c.ol),b==F.tx)b=a.callback,b(a.id,c.hit_fract,d,c.hit_time);else{b=c.hit_fract;var f=c.hit_time,e=c.hit_pos,g=a.callback;e?g(a.id,b,d,f,e,c.hit_norm):g(a.id,b,d,f)}break;case F.JD:k(id);break;case F.GD:a=ra.indexOf(a);console.log("Physics #"+a+" Ping: OUT "+(c[2]-c[1]).toFixed(3)+" ms, IN "+(performance.now()-c[2]).toFixed(3)+" ms, ALL "+(performance.now()-c[1]).toFixed(3)+" ms");break;case F.DD:ma=
c[1];break;case F.zD:a=ra.indexOf(a);console.log("Worker: #"+String(a));console.log(c[1]);break;default:X.error("Wrong message: "+b)}}function n(a){for(var b=0;b<ra.length;b++)if(ra[b]==a)return ja[b]}function h(a){return oa[a]||null}function r(a,b,c,d,e,f,k){a=a.Wb.ha;for(var l=0;l<a.length;l++)for(var m=a[l].A,n=0;n<m.ce.length;n++){for(var q=m.ce[n],t=q.Qi,r=!1,v=0;v<t.length;v++){var u=t[v];if(u[0]===b&&u[1]===c){q.Fo[v]=d;r=!0;break}}r&&(t=g(q),e&&q.yt!=b&&(r=e,v=f,u=k,r[0]+=v[0]*u,r[1]+=v[1]*
u,r[2]+=v[2]*u,v[0]*=-1,v[1]*=-1,v[2]*=-1),q.callback(t,t?q.yt==b?h(c):h(b):null,e,f,k))}}function g(a){a=a.Fo;for(var b=!1,c=0;c<a.length;c++)b=b||a[c];return b}function m(){ka.body++;return ka.body}function q(a){var b=ea.indexOf(a);return-1==b?(ea.push(a),ea.length-1):b}function B(a,b){return{M:a,type:b,Hg:0,hr:!1,dj:!0,le:!1,is_character:!1,kK:!1,kq:null,xb:"",Cn:0,WP:{},ce:[],Kj:null,rq:0,fu:new Float32Array([0,0,0,1,0,0,0,1]),Eg:new Float32Array(3),ng:new Float32Array(3),fq:new Float32Array(3),
rn:new Float32Array(4)}}function d(a,b){switch(a){case "BOX":var c=b.U;break;case "CYLINDER":c=b.mn;break;case "CONE":c=b.ln;break;case "SPHERE":c=b.jf;break;case "CAPSULE":c=b.kn}return c}function l(a){if(!a)return null;var b={};"number"===typeof a.min_x&&(b.min_x=a.min_x);"number"===typeof a.min_y&&(b.min_y=a.min_y);"number"===typeof a.min_z&&(b.min_z=a.min_z);"number"===typeof a.max_x&&(b.max_x=a.max_x);"number"===typeof a.max_y&&(b.max_y=a.max_y);"number"===typeof a.max_z&&(b.max_z=a.max_z);"object"===
typeof a.J&&(b.center=a.J);"number"===typeof a.Za&&(b.radius=a.Za);"number"===typeof a.height&&(b.height=a.height);return b}function f(a,b,c,d,e){var f=U.get_trans_view(a.k.m),g=U.invert(b.k.m,Aa),h=new Float32Array(3);U.transform_vec3(f,g,h);switch(b.s.type){case 10:b=b.we;a=a.k.U;F.S(e,F.YD,c,h,b.BN,b.dw,(a.max_y-a.min_y)/2,d);break;case 20:F.S(e,F.XD,c,h,a.JR)}}function H(a){return a.A&&a.A.kq}function D(a,b,c,d,e,f,g,h,k,l){var m;ka.Ib++;m=ka.Ib.toString(16);var n=b.A.M;F.S(w(n),F.eE,m,a,h,n,
c,d,e.A.M,f,g,k,l);b.A.kq=m}function w(a){for(var b=0;b<ja.length;b++)for(var c=ja[b].Wb.ha,d=0;d<c.length;d++)if(c[d].A.M==a)return ra[b];return null}function E(a){var b=a.A;if(b=b?0===b.Hg?!0:!0===b.hr?!0:!1===b.dj?!0:"RIGID_BODY"!==b.type&&"DYNAMIC"!==b.type?!0:!1:!1)var b=U.cc(a.k.m,I),c=U.xd(a.k.m,Ia),b=b[0]!=a.A.fq[0]||b[1]!=a.A.fq[1]||b[2]!=a.A.fq[2]||c[0]!=a.A.rn[0]||c[1]!=a.A.rn[1]||c[2]!=a.A.rn[2]||c[3]!=a.A.rn[3];if(b){var b=a.A,d=a.k,c=F.Rz(F.Fp);c.M=b.M;var e=U.cc(d.m,c.trans),d=U.xd(d.m,
c.quat);T.copy(e,b.fq);N.copy(d,b.rn);"DYNAMIC"==b.type&&N.identity(c.quat);F.S(w(b.M),F.Fp)}a=a.ee;for(b=0;b<a.length;b++)E(a[b])}function y(a,b,c,d,e){e=e||new Float32Array(3);a=U.get_quat_view(a.k.m);e[0]=b;e[1]=c;e[2]=d;T.transformQuat(e,a,e)}function A(a,b,c){var d=a.Qi,e=a.Fo,f=a.yt,g=[],h=a.xb;g||ga.q("At least one destination required");for(var k=0;k<b.Wb.ha.length;k++){var l=b.Wb.ha[k];if("ANY"==h||l.A.xb==h)l=l.A.M,g&&-1==g.indexOf(l)&&g.push(l)}for(b=0;b<g.length;b++)h=g[b],f<h&&!G(d,f,
h)?(d.push([f,h]),e.push(!1)):f>h&&!G(d,h,f)&&(d.push([h,f]),e.push(!1));F.S(c,F.WD,f);F.S(c,F.dE,d,a.qg)}function G(a,b,c){for(var d=0;d<a.length;d++)if(a[d][0]==b&&a[d][1]==c)return!0;return!1}function x(a){a.A&&a.A.Kj&&(a=a.A,F.S(w(a.M),F.qE,a.M),a.Kj=null)}function k(a){var b=M(a),c=t(a).Wb;c.Vi[a]&&(delete c.Vi[a],c.Vv.splice(c.Vv.indexOf,1),F.S(b,F.zE,a))}function t(a){for(var b=0;b<ja.length;b++){var c=ja[b];if(c.Wb.Vi[a])return c}return null}function M(a){for(var b=0;b<ja.length;b++)if(ja[b].Wb.Vi[a])return ra[b];
return null}function u(a,b,c){if(b.xm){a=a.A.M;var d=b.zl*b.ao,e=b.pn*b.qn,f=-b.vm*b.wm*2*Math.PI/b.ip;b.ro&&(f*=-1);switch(b.type){case 10:F.S(c,F.ME,a,d,e,f);break;case 20:F.S(c,F.LE,a,d,e,f)}}}function v(a){return a.le&&"CHASSIS"==a.we.oe}function z(a){return a.le&&"HULL"==a.we.oe}function S(a){return a.rk&&"MAIN_BODY"==a.Cl.oe}var C=p("__config"),W=p("__debug"),F=p("__ipc"),K=p("__obj_util"),X=p("__print"),N=p("__quat"),L=p("__scenes"),P=p("__subscene"),da=p("__transform"),U=p("__tsr"),ga=p("__util"),
T=p("__vec3"),la=p("__version"),O=C.A,Q=C.v,Z=C.hf,ma=0,ra=[],ja=[],oa={},ha=[],ea=["ANY"],ka={body:0,Ib:0,vB:0},I=new Float32Array(3);new Float32Array(4);var Ia=new Float32Array(4);new Float32Array(16);var Aa=U.create(),qa=U.create();a.fK=function(a){a.Wb={gD:!1,ha:[],Vi:{},Vv:[]};var c=O.op;Z.prevent_caching&&(c+=la.timestamp());X.log("%cLOAD PHYSICS","color: #0a0",O.sp?"Using Separate Worker Thread,":"Using Same Thread,","Max FPS: "+O.max_fps);X.log("%cPHYSICS PATH","color: #0a0",c);var d=F.cI(c,
!O.sp);F.RF(d,b);ra.push(d);ja.push(a);O.ping&&setInterval(function(){F.S(d,F.wE,performance.now())},1E3)};a.IG=function(a){return a.Wb?a.Wb.gD:!0};a.cleanup=function(){for(var a=0;a<ra.length;a++)F.terminate(ra[a]);ra.length=0;ja.length=0;oa={};ha.length=0;ea.length=0;for(var b in ka)ka[b]=0};a.append_object=function(a,b){a.k||ga.q("No object render: "+a.name);var g;a:{for(var h=0;h<ja.length;h++)if(ja[h]==b){g=ra[h];break a}g=void 0}var k=[];a.Zf.pp&&e(a,k);var n=b.Wb.ha;if(v(a)||z(a)||a.is_character||
S(a)||a.Sk){var t,r=a,w=g,p=r.k,x=r.Zf,L=x.Rr,y=m();if("CAMERA"==r.type)var A=x.ax?x.iq:"BOX",I=d(A,p),C=p.ck,G=p.Wj,C=.5,G=0;else if("EMPTY"==r.type)A="EMPTY",I=null,G=C=0;else{var A=x.ax?x.iq:"BOX",I=d(A,p),E=U.get_scale(p.m);if(1!=E){var Y=I;switch(A){case "BOX":Y.min_x*=E;Y.max_x*=E;Y.min_y*=E;Y.max_y*=E;Y.min_z*=E;Y.max_z*=E;break;case "CYLINDER":case "CONE":case "CAPSULE":Y.height*=E;Y.Za*=E;break;case "SPHERE":Y.Za*=E}}C=p.ck;G=p.Wj}var wa=U.get_trans_view(p.m),ua=U.get_quat_view(p.m),P=x.rp,
M=x.RC,ka=x.Hg,ba=x.VC,W=x.UC,da=x.hu,R=x.fw,T=r.xb,O=q(T),Q=x.Dn,ma=x.Bn,la=x.En,Z=p.jf.Za,ea=l(I),Ua=r.nq,Ta;var Ya=A;if(k.length){var jb=[],kb={};kb.quat=new Float32Array([0,0,0,1]);kb.trans=new Float32Array(3);kb.worker_bounding=ea;kb.bounding_type=Ya;jb.push(kb);var Na=U.invert(p.m,Aa),Xc=Ia,Yc=U.get_quat_view(p.m);N.invert(Yc,Xc);for(var Ac=0;Ac<k.length;Ac++){var Ib={},Za=k[Ac],ac=Za.Zf.iq,dd=new Float32Array(4),Bc=new Float32Array(3),Pc=U.get_trans_view(Za.k.m),Hb=U.get_quat_view(Za.k.m);
U.transform_vec3(Pc,Na,Bc);N.multiply(Xc,Hb,dd);Ib.trans=Bc;Ib.quat=dd;Ib.bounding_type=ac;Ib.worker_bounding=l(d(ac,Za.k));jb.push(Ib)}Ta=jb}else Ta=[];F.S(w,F.aE,y,wa,ua,L,P,M,ka,ba,W,da,R,O,Q,ma,la,A,ea,Z,C,G,Ta,Ua);oa[y]=r;ha.push(r);var wb=B(y,"BOUNDING");wb.type=L;wb.Hg=ka;wb.hr=P;wb.xb=T;wb.Cn=O;t=wb;a.A=t;var uc={Y:null,A:t};n.push(uc);c(b,g,t.xb)}else for(var vc=K.fa(a,b).P,mc=0;mc<vc.length;mc++){var Pb=vc[mc],nc;if(nc="PHYSICS"==Pb.type){var fc;a:{for(var Oc=b.Wb.ha,Cc=0;Cc<Oc.length;Cc++){var Nc=
Oc[Cc].Y;if(Nc&&Nc.id==Pb.id){fc=!0;break a}}fc=!1}nc=!fc}if(nc)if(Pb.Xe.va)if(Pb.Wg&&b.p.oc){var Rb=Pb,Qc=b,hd=g,Cb=Qc.p.oc;F.S(hd,F.jE,Cb.qj);if(Rb.TO){var rb={};rb.dst_noise_scale0=Rb.dst_noise_scale0;rb.dst_noise_scale1=Rb.dst_noise_scale1;rb.dst_noise_freq0=Rb.dst_noise_freq0;rb.dst_noise_freq1=Rb.dst_noise_freq1;rb.dir_min_shore_fac=Rb.dir_min_shore_fac;rb.dir_freq=Rb.dir_freq;rb.dir_noise_scale=Rb.dir_noise_scale;rb.dir_noise_freq=Rb.dir_noise_freq;rb.dir_min_noise_fac=Rb.dir_min_noise_fac;
rb.dst_min_fac=Rb.dst_min_fac;rb.waves_hor_fac=Rb.waves_hor_fac;var jd=Cb.waves_height,oc=Cb.waves_length;Cb.cj?F.S(hd,F.Cx,rb,Cb.om[0],Cb.om[1],Cb.nm[0],Cb.nm[1],Cb.kv,jd,oc,Cb.ow,Qc.p.nw):F.S(hd,F.Cx,rb,0,0,0,0,0,jd,oc,0,null)}}else{var ed;if(Pb.rp){var fd=a,Dc=Pb,hc=g,Zc=m(),$c=Dc.Xe,Sb=$c.O[0].a_position,Ec=$c.lb||null,xb=Dc.xb,pb=q(xb),bc=Dc.Dn,Sa=Dc.Bn,Zb=Dc.En,Tc=U.get_trans_view(fd.k.m);F.S(hc,F.gE,Zc,Sb,Ec,Tc,pb,bc,Sa,Zb);var Db=B(Zc,"STATIC_MESH");Db.hr=!0;Db.xb=xb;Db.Cn=pb;ed=Db}else{var Qb=
a,Jb=Pb,ic=g,eb=m(),jc=Jb.Xe,Fc=jc.O[0].a_position,Kb=jc.lb||null,Tb=U.get_trans_view(Qb.k.m),pc=Jb.ck,Uc=Jb.Wj,Eb=Jb.xb,Ub=q(Eb);F.S(ic,F.iE,eb,Fc,Kb,Tb,pc,Uc,Ub,Jb.Dn,Jb.Bn,Jb.En);var fb=B(eb,"STATIC_MESH");fb.xb=Eb;fb.Cn=Ub;ed=fb}t=ed;a.A=t;uc={Y:Pb,A:t};n.push(uc);c(b,g,t.xb)}else X.error("Object "+a.name+" has collision material with no assigned vertices")}if(v(a)||z(a)){var Pa=a,yb=g,Lb=Pa.A.M;v(Pa)?(Pa.s.type=10,F.S(yb,F.bE,Lb,Pa.s.Ew,Pa.s.Gw,Pa.s.Fw,Pa.s.jx,Pa.s.lv)):z(Pa)&&(Pa.s.type=20,
F.S(yb,F.$D,Lb,Pa.s.$j,Pa.s.$k,Pa.s.al));if(Pa.s.Hk){var Vb=Pa.s.Hk;switch(Pa.s.type){case 10:f(Vb[1],Pa,Lb,!0,yb);f(Vb[0],Pa,Lb,!0,yb);f(Vb[3],Pa,Lb,!1,yb);f(Vb[2],Pa,Lb,!1,yb);break;case 20:for(var Fb=0;Fb<Vb.length;Fb++)f(Vb[Fb],Pa,Lb,!1,yb)}}u(a,a.s,g)}else if(a.is_character){var Wb=g,Mb=a.k,Gc=a.A,Xb=Mb.U.max_y-Mb.U.min_y,wc=Gc.M,zb=a.wy,Hc=zb.SO,lb=zb.eM,Va=zb.tN,cb=zb.uK,qc=zb.UO,xc=ga.pI(a);F.S(Wb,F.cE,wc,xc,Xb,Hc,lb,Va,cb,qc);Gc.is_character=!0}else if(S(a)){var mb=a,sb=g,Ab=mb.A.M;F.S(sb,
F.fE,Ab,mb.mf.$j,mb.mf.$k,mb.mf.al);if(mb.mf.bq)for(var Ga=mb.mf.bq,nb=0;nb<Ga.length;nb++){var db=Ga[nb],cc=U.get_trans_view(db.k.m),Ha=U.invert(mb.k.m,Aa),gb=new Float32Array(3);U.transform_vec3(cc,Ha,gb);F.S(sb,F.ZD,Ab,gb,db.jy)}mb.A.kK=!0}for(mc=0;mc<ha.length;mc++)if(a=ha[mc],a.A){var $a=a;if(!H($a))for(var Nb=0;Nb<$a.Nv.length;Nb++){var ib=$a.Nv[Nb],Wa=ib.target,tb=ib.yL;if(Wa.A){var ob=new Float32Array([ib.zL,ib.AL,ib.BL]),hb,Ic=new Float32Array([ib.rd,ib.sd,ib.td]);hb=ga.euler_to_quat(Ic,
new Float32Array(4));var kc=U.identity(Aa),kc=U.set_trans(ob,kc),kc=U.set_quat(hb,kc),ad=U.multiply($a.k.m,kc,Aa),ub=U.invert(Wa.k.m,qa),dc=U.multiply(ub,ad,ub),ec=U.get_trans_view(dc),yc=U.get_quat_view(dc),Xa=ib,ab={};ab.use_limit_x=Xa.wO;ab.use_limit_y=Xa.xO;ab.use_limit_z=Xa.yO;ab.use_angular_limit_x=Xa.sO;ab.use_angular_limit_y=Xa.tO;ab.use_angular_limit_z=Xa.uO;ab.limit_max_x=Xa.EK;ab.limit_min_x=Xa.HK;ab.limit_max_y=Xa.FK;ab.limit_min_y=Xa.IK;ab.limit_max_z=Xa.GK;ab.limit_min_z=Xa.JK;ab.limit_angle_max_x=
Xa.yK;ab.limit_angle_min_x=Xa.BK;ab.limit_angle_max_y=Xa.zK;ab.limit_angle_min_y=Xa.CK;ab.limit_angle_max_z=Xa.AK;ab.limit_angle_min_z=Xa.DK;D(tb,$a,ob,hb,Wa,ec,yc,ab,null,null)}}}};a.RI=h;a.update=function(a,b){for(var c=0;c<ra.length;c++){var d=ra[c],e=a;d&&F.lA(d)&&F.S(d,F.NE,e,b);for(var f=0;f<ha.length;f++){var g=ha[f],h=g.A;if(h.dj&&h.rq){var k=F.lA(d)?e-h.rq:performance.now()/1E3-h.rq,k=Math.min(k,10/O.max_fps),k=k-1/O.max_fps;Q.lL&&(k=0);var l=Aa;U.gK(h.fu,k,h.Eg,h.ng,Aa);da.set_tsr(g,l);
da.u(g);E(g);if(g.s)for(var h=g,k=h.s.Hk,l=h.k.m,m=Aa,n=0;n<k.length;n++){var q=k[n];U.multiply(l,h.s.Mo[n],m);da.set_tsr(q,m);da.u(q)}g.s&&g.s.xm&&(m=g,k=m.s,h=k.xm)&&(n=m.s.hC,U.multiply(m.k.m,m.s.iC,h.k.m),l=I,U.transform_dir_vec3(n,m.k.m,l),m=Ia,N.setAxisAngle(l,-k.vm*k.wm*2*Math.PI,m),k=U.get_quat_view(h.k.m),N.multiply(m,k,k),da.u(h));g.s&&g.s.uw&&(m=g,k=m.s,h=k.uw)&&(n=m.s.bC,U.multiply(m.k.m,m.s.cC,h.k.m),l=I,U.transform_dir_vec3(n,m.k.m,l),m=Ia,n=Math.abs(k.speed)*k.fp,n>k.Wl&&(n=k.Wl),N.setAxisAngle(l,
-n,m),k=U.get_quat_view(h.k.m),N.multiply(m,k,k),N.normalize(k,k),da.u(h));g.s&&g.s.Hw&&(l=g,h=l.s,g=h.Hw)&&(m=l.s.pC,U.multiply(l.k.m,l.s.qC,g.k.m),k=I,U.transform_dir_vec3(m,l.k.m,k),l=Ia,N.setAxisAngle(k,-Math.abs(h.zl)*h.On,l),h=U.get_quat_view(g.k.m),N.multiply(l,h,h),N.normalize(h,h),da.u(g))}}F.EL(d);d=ja[c];(e=d.p.oc)&&0<e.waves_height&&(d=L.Ba(d,P.pb),e=T.length(d.Vh),F.S(ra[c],F.KE,d.time*e))}};a.qJ=function(){return ja[0]};a.pause=function(){for(var a=0;a<ra.length;a++)F.S(ra[a],F.vE)};
a.resume=function(){for(var a=0;a<ra.length;a++)F.S(ra[a],F.AE)};a.enable_simulation=function(a){(a=a.A)||ga.q("No object physics");if(!a.dj){var b=a.M,c=w(b);a.dj=!0;F.S(c,F.tE,b)}};a.disable_simulation=function(a){(a=a.A)||ga.q("No object physics");if(a.dj){var b=a.M,c=w(b);a.dj=!1;F.S(c,F.sE,b)}};a.cs=function(a){return Boolean(a.Wb)};a.ia=function(a){return Boolean(a.A)};a.has_dynamic_physics=function(a){return(a=a.A)&&a.dj&&("RIGID_BODY"==a.type||"DYNAMIC"==a.type)&&0<a.Hg&&0==a.hr?!0:!1};a.has_simulated_physics=
function(a){return(a=a.A)&&a.dj?!0:!1};a.set_gravity=function(a,b){var c=a.A.M;F.S(w(c),F.JE,c,b)};a.ZJ=H;a.apply_constraint=D;a.clear_constraint=function(a){a=a.A;F.S(w(body_a),F.yE,a.kq);a.kq=null};a.pull_to_constraint_pivot=function(b,c,d,e,f,g){c=U.set_sep(c,1,d,Aa);f=U.set_sep(f,1,g,qa);U.invert(c,c);U.multiply(f,c,c);da.get_tsr(e,f);U.multiply(f,c,c);da.set_tsr(b,c);da.u(b);e=U.get_trans_view(b.k.m);f=U.get_quat_view(b.k.m);a.set_transform(b,e,f)};a.set_transform=function(a,b,c){var d=a.A,e=
F.Rz(F.Fp),f=U.cc(a.k.m,e.trans);a=U.xd(a.k.m,e.quat);U.set_sep(f,1,a,d.fu);e.M=d.M;T.copy(b,e.trans);N.copy(c,e.quat);F.S(w(d.M),F.Fp)};a.sync_transform=E;a.apply_velocity=function(a,b,c,d){var e=I;y(a,b,c,d,e);a=a.A.M;b=Math.abs(0);c=Math.abs(0);d=Math.abs(0);var f=Math.abs(e[0]),g=Math.abs(e[1]),h=Math.abs(e[2]);e[0]=f?e[0]/f*Math.max(f,b):0;e[1]=g?e[1]/g*Math.max(g,c):0;e[2]=h?e[2]/h*Math.max(h,d):0;F.S(w(a),F.Ex,a,e[0],e[1],e[2])};a.apply_velocity_world=function(a,b,c,d){a=a.A.M;F.S(w(a),F.Ex,
a,b,c,d)};a.apply_force=function(a,b,c,d,e){var f=I;e?(f[0]=b,f[1]=c,f[2]=d):y(a,b,c,d,f);a=a.A.M;F.S(w(a),F.kE,a,f[0],f[1],f[2])};a.apply_torque=function(a,b,c,d){var e=I;y(a,b,c,d,e);a=a.A.M;F.S(w(a),F.mE,a,e[0],e[1],e[2])};a.set_character_move_dir=function(a,b,c){a=a.A.M;F.S(w(a),F.DE,a,b,c)};a.set_character_move_type=function(a,b){var c=a.A.M;F.S(w(c),F.EE,c,b)};a.set_character_walk_velocity=function(a,b){var c=a.A.M;F.S(w(c),F.IE,c,b)};a.set_character_run_velocity=function(a,b){var c=a.A.M;F.S(w(c),
F.GE,c,b)};a.set_character_fly_velocity=function(a,b){var c=a.A.M;F.S(w(c),F.BE,c,b)};a.character_jump=function(a){a=a.A.M;F.S(w(a),F.oE,a)};a.character_rotation_inc=function(a,b,c){a=a.A.M;F.S(w(a),F.pE,a,b,c)};a.set_character_rotation=function(a,b,c){a=a.A.M;F.S(w(a),F.FE,a,b,c)};a.set_character_rotation_h=function(a,b){var c=a.A.M;F.S(w(c),F.CE,c,b)};a.set_character_rotation_v=function(a,b){var c=a.A.M;F.S(w(c),F.HE,c,b)};a.append_collision_test=function(a,b,c,d){var e=a.A,f=e.M;b=b||"ANY";for(var g=
0;g<e.ce.length;g++)if(a=e.ce[g],a.xb==b&&a.callback==c)return;a={yt:f,qg:d||!1,xb:b,callback:c,Qi:[],Fo:[]};e.ce.push(a);b=w(f);A(a,n(b),b)};a.remove_collision_test=function(a,b,c){a=a.A;for(var d=w(a.M),e=n(d),f=0;f<a.ce.length;f++){var h=a.ce[f];if(h.xb==b&&h.callback==c){if(g(h)){var k=T.set(0,0,0,I);h.callback(!1,null,k,k,0)}a.ce.splice(f,1);f--;for(var k=d,h=h.Qi,l=e.Wb.ha,m=0;m<l.length;m++)for(var q=l[m].A,t=0;t<q.ce.length;t++)for(var r=q.ce[t],v=0;v<r.Qi.length;v++)for(var u=r.Qi[v],p=0;p<
h.length;p++){var z=h[p];u[0]==z[0]&&u[1]==z[1]&&(h.splice(p,1),p--)}h.length&&F.S(k,F.Dx,h)}}};a.apply_collision_impulse_test=function(a,b){a.A&&a.A.Kj&&x(a);var c=a.A;F.S(w(c.M),F.lE,c.M);c.Kj=b};a.clear_collision_impulse_test=x;a.append_ray_test=function(a,b,c,d,e,f,g,h,k){var l;ka.vB++;l=ka.vB;d=d||"ANY";a={id:l,M:a?a.A.M:0,from:new Float32Array(b),to:new Float32Array(c),xb:d,Cn:q(d),Zx:f,fG:g,qg:h,ar:k,callback:e};b=w(a.M)||ra[0];c=n(b).Wb;l=a.id;c.Vi[l]=a;c.Vv.push(a);F.S(b,F.hE,a.id,a.M,a.from,
a.to,a.Cn,a.Zx,a.fG,a.qg,a.ar);return l};a.remove_ray_test=k;a.change_ray_test_from_to=function(a,b,c){var d=M(a),e=t(a).Wb.Vi[a];e&&!e.Zx&&(e.from.set(b),e.to.set(c),F.S(d,F.nE,a,b,c))};a.mA=function(a){return t(a).Wb.Vi[a]?!0:!1};a.vehicle_throttle=function(a,b){var c=a.s;c.zl=b;u(a,c,w(a.A.M))};a.vehicle_steer=function(a,b){var c=a.s;c.vm=b;u(a,c,w(a.A.M))};a.vehicle_brake=function(a,b){var c=a.s;c.pn=b;u(a,c,w(a.A.M))};a.is_vehicle_chassis=v;a.is_vehicle_hull=z;a.jK=function(a){if(!a.le)return!1;
a=a.we.oe;return"WHEEL_FRONT_LEFT"==a||"WHEEL_FRONT_RIGHT"==a||"WHEEL_BACK_LEFT"==a||"WHEEL_BACK_RIGHT"==a?!0:!1};a.iK=function(a){return a.le?"BOB"==a.we.oe?!0:!1:!1};a.lK=function(a){return a.rk?"BOB"==a.Cl.oe?!0:!1:!1};a.oA=function(a){return a.le&&"STEERING_WHEEL"==a.we.oe?!0:!1};a.nA=function(a){return a.le&&"SPEEDOMETER"==a.we.oe?!0:!1};a.pA=function(a){return a.le&&"TACHOMETER"==a.we.oe?!0:!1};a.get_vehicle_speed=function(a){return a.s.speed};a.WO=function(a){switch(a){case "WHEEL_FRONT_LEFT":return 0;
case "WHEEL_FRONT_RIGHT":return 1;case "WHEEL_BACK_LEFT":return 2;case "WHEEL_BACK_RIGHT":return 3}};a.is_character=function(a){return a.is_character};a.bR=S;a.EJ=function(){return ma};a.kI=function(){for(var a=0;a<ra.length;a++)F.S(ra[a],F.rE)};a.remove_object=function(a){if("BOUNDING"==a.A.type){var b=ha.indexOf(a);-1==b&&X.error("Object "+a.name+" doesn't have bounding physics");delete oa[c];ha.splice(b,1)}for(var c=a.A.M,b=w(c),d=n(b),e=c,f=d.Wb.ha,h=[],k=0;k<f.length;k++)for(var l=f[k].A,m=0;m<
l.ce.length;m++)for(var q=l.ce[m],t=0;t<q.Qi.length;t++){var r=q.Qi[t],v=q.Fo[t];if(r[0]==e||r[1]==e)q.Qi.splice(t,1),q.Fo.splice(t,1),t--,v&&!g(q)&&(v=T.set(0,0,0,I),q.callback(!1,null,v,v,0)),h.push(r)}h.length&&F.S(b,F.Dx,h);a.A&&a.A.Kj&&x(a);a=d.Wb.ha;for(d=0;d<a.length;d++)a[d].A.M==c&&(a.splice(d,1),d--);F.S(b,F.xE,c)}};b4w.module.__data=function(a,p){function e(a,b){Ra[b.id]=null;za[b.id]=null}function c(a,b,c){var d;a instanceof ArrayBuffer&&(a=Ia.Zz(a));d=a.width;a=a.height;ya.log("%cLOAD IMAGE "+d+"x"+a,"color: #"+(2048<d||2048<a?"a00":1024<d||1024<a?"aa0":"0a0"),b);-1==b.indexOf(Da)&&c&&ya.warn("image",b,"is not from app root.")}function b(a,b,c,d,e,f){(d=b.yg)||xa.q("Nothing requested");ha.enqueue([{id:d,type:ha.AT_JSON,url:d}],function(d,f,g,h){if(d){ya.log("%cLOAD METADATA","color: #616",h);f=xa.jC(d.b4w_format_version);
switch(xa.WC(f,ba.yk)){case -1:f[0]<ba.yk[0]?xa.q("JSON version is too old relative to B4W engine: "+xa.nj(f)+", required: "+xa.nj(ba.yk)+". Reexport scene with the latest B4W addon to fix it."):ya.warn("JSON version is a bit old relative to B4W engine: "+ +xa.nj(f)+", required: "+xa.nj(ba.yk)+". Some compatibility issues can occur. Reexport scene with the latest B4W addon to fix it.");break;case 1:f[0]>ba.yk[0]?xa.q("B4W engine version is too old relative to JSON. Can't load the scene. Update your engine version to fix it."):
ya.warn("B4W engine version is a bit old relative to JSON. Some compatibility issues can occur. Update your engine version to fix it.")}ba.fv=f;for(var k in d)a[k]=d[k];b.mb&&(La=Fa.Eq(a.scenes));(d=a.binaries[0].binfile)?b.fy=d:(aa.ns(b,"load_binaries"),aa.ns(b,"prepare_bindata"));ba.is_mobile_device||aa.ns(b,"mobile_media_start");ba.antialiasing&&ba.smaa||aa.ns(b,"load_smaa_textures");if(a.b4w_export_errors)for(d=0;d<a.b4w_export_errors.length;d++)k=a.b4w_export_errors[d],(b.mb&&"PRIMARY"==k.type||
"ALL"==k.type)&&ya.HI(k.text+" See more details in https://www.blend4web.com/doc/en/addon.html#non-critical-export-errors");if(a.b4w_export_warnings)for(d=0;d<a.b4w_export_warnings.length;d++)k=a.b4w_export_warnings[d],(b.mb&&"PRIMARY"==k.type||"ALL"==k.type)&&ya.II(k.text+" See more details in https://www.blend4web.com/doc/en/addon.html#other-messages");e(b,c)}else aa.Kx(b)},null,function(a){f(b,c,a)})}function n(a,b,c,d,e,f){(d=Z(b.yg)+b.fy)||xa.q("Binary data is missing");ha.enqueue([{id:d,type:ha.AT_ARRAYBUFFER,
url:d}],function(d,f,h,k){d?(ya.log("%cLOAD BINARY","color: #616",k),a.bin_data=d,d=g(d),f=xa.jC(a.b4w_format_version),d[0]!=f[0]&&xa.q("BIN version does not match to JSON version: "+xa.nj(d)+", required: "+xa.nj(ba.yk)+". Couldn't load the scene. Reexport scene to fix it."),d[1]!=f[1]&&ya.warn("BIN version does not match to JSON version: "+ +xa.nj(d)+", required: "+xa.nj(ba.yk)+". Some compatibility issues can occur. Reexport scene to fix it."),e(b,c)):aa.Kx(b)},null,function(a){f(b,c,a)})}function h(a,
b,c,d,e){Ka.GG()&&e(b,c)}function r(a,b,c,d,e){d=a.bin_data;var f=a.binaries[0],h=a.objects,k=a.meshes;a=a.actions;for(var l=xa.zG(),n=g(d),n=5<=n[0]&&4<n[1]?12:0,Y=["indices"],q=["normal","tangent"],t=["color","group"],r=["position","texcoord","texcoord2","shade_tangs"],v=0;v<k.length;v++)for(var u=k[v].submeshes,wa=0;wa<u.length;wa++)for(var w in u[wa]){var J=u[wa][w][1];if(-1!=Y.indexOf(w)){var p=4*u[wa][w][0]+f["int"]+n,z=u[wa],B=w,x=d;if(l)var L=new Uint32Array(x,p,J);else for(var L=new Uint32Array(J),
x=new DataView(x),D=0;D<J;D++)L[D]=x.getUint32(p+4*D,!0);z[B]=L}else if(-1!=r.indexOf(w))p=4*u[wa][w][0]+f["float"]+n,u[wa][w]=m(d,p,J,l);else if(-1!=q.indexOf(w)){p=2*u[wa][w][0]+f["short"]+n;z=u[wa];B=w;x=d;L=new Float32Array(J);x=new DataView(x);for(D=0;D<J;D++)L[D]=x.getInt16(p+2*D,!0)/32767;z[B]=L}else if(-1!=t.indexOf(w)){p=2*u[wa][w][0]+f.ushort+n;z=u[wa];B=w;x=d;L=new Float32Array(J);x=new DataView(x);for(D=0;D<J;D++)L[D]=x.getUint16(p+2*D,!0)/65535;z[B]=L}}for(w=0;w<h.length;w++)for(k=h[w].particle_systems,
Y=0;Y<k.length;Y++)q=k[Y],q.transforms=m(d,4*q.transforms[0]+f["float"]+n,q.transforms[1],l);for(h=0;h<a.length;h++){w=a[h];k=w.fcurves;Y=w.frame_range;t=Y[0];r=Y[1];v=oa.uJ(t,r);Y=null;0>v&&(v=0);var wa=u=!1,y;for(y in k)u|=-1<y.indexOf("rotation_euler"),wa|=-1<y.indexOf("rotation_quaternion");q=[];for(y in k)if(u&&wa&&-1<y.indexOf("rotation_euler"))delete k[y];else{var J=k[y],A;for(A in J)p=J[A],z=m(d,f["float"]+4*p.bin_data_pos[0]+n,p.bin_data_pos[1],l),B=new Float32Array(v),null===Y&&(Y=new Int8Array(v)),
oa.JF(p,z,B,Y,t,r),p.De=B;-1<y.indexOf("rotation_euler")&&(oa.OI(k[y]),q.push(y))}for(t=0;t<q.length;t++)r=q[t],v=r.replace("euler","quaternion"),k[v]=k[r],delete k[r];w.aF=Y}e(b,c)}function g(a){var b=new Uint8Array(a,0,4),c=(new Uint32Array(a,4,1))[0];a=(new Uint32Array(a,8,1))[0];for(var d=0;d<b.length;d++)if("B4WB"[d]!=String.fromCharCode(b[d])){c=5;a=4;break}return[c,a]}function m(a,b,c,d){if(d)d=new Float32Array(a,b,c);else{d=new Float32Array(c);a=new DataView(a);for(var e=0;e<c;e++)d[e]=a.getFloat32(b+
4*e,!0)}return d}function q(a,b,c,d,e){var g=a.cameras,h=a.groups,k=a.materials,m=a.meshes,n=a.node_groups,q=a.objects,t=a.particles,r=a.scenes,v=a.speakers,u=a.lamps,w=a.textures,wa=a.worlds;n||(ya.warn('"node_groups" datablock undefined. reexport main scene.'),n=a.node_groups=[]);for(var J="actions armatures cameras curves groups images lamps materials meshes node_groups objects particles scenes sounds speakers textures worlds".split(" "),p={},z=0;z<J.length;z++)for(var x=a[J[z]],L=0;L<x.length;L++){var D=
x[L];p[D.uuid]=D}for(var y=0;y<r.length;y++){for(var V=r[y],I=V.objects,C=0;C<I.length;C++)G(I,C,p);V.camera&&G(V,"camera",p);V.world&&G(V,"world",p)}for(y=0;y<h.length;y++)for(var aa=h[y].objects,C=0;C<aa.length;C++)G(aa,C,p);for(y=0;y<q.length;y++){var ua=q[y];ua.dupli_group&&G(ua,"dupli_group",p);ua.parent&&G(ua,"parent",p);ua.dg_parent&&G(ua,"dg_parent",p);if(ua.animation_data){var E=ua.animation_data;E.action&&G(E,"action",p);if(E.nla_tracks)for(C=0;C<E.nla_tracks.length;C++)for(var P=E.nla_tracks[C],
H=0;H<P.strips.length;H++)P.strips[H].action&&G(P.strips[H],"action",p)}switch(ua.type){case "MESH":ua.data||xa.q("mesh not found for object "+ua.name);G(ua,"data",p);for(var M=!1,K=ua.modifiers,C=0;C<K.length;C++){var na=K[C];"ARMATURE"==na.type?(M&&ya.warn('Object "'+ua.name+'" has more than one armature modifiers. Only the first one will be used.'),M=!0,G(na,"object",p)):"CURVE"==na.type&&G(na,"object",p)}var gc=ua.particle_systems;if(gc)for(C=0;C<gc.length;C++)G(gc[C],"settings",p);break;case "ARMATURE":G(ua,
"data",p);for(var ba=ua.pose.bones,R=ua.data.bones,C=0;C<ba.length;C++){var ka=ba[C];ka.bone=R[ka.bone];var N=ka.constraints;if(N)for(H=0;H<N.length;H++){var ca=N[H];ca.target&&G(ca,"target",p)}for(var X=ka.parent_recursive,H=0;H<X.length;H++)X[H]=ba[X[H]]}break;case "LAMP":case "CAMERA":case "SPEAKER":case "CURVE":G(ua,"data",p)}if(N=ua.constraints)for(C=0;C<N.length;C++)ca=N[C],ca.target&&G(ca,"target",p);var U=ua.lod_levels;if(U)for(C=0;C<U.length;C++){var W=U[C];W.object&&G(W,"object",p)}}for(y=
0;y<m.length;y++)for(var da=m[y].materials,C=0;C<da.length;C++)G(da,C,p);for(y=0;y<k.length;y++){for(var Oa=k[y],S=Oa.texture_slots,C=0;C<S.length;C++)G(S[C],"texture",p);var $b=Oa.node_tree;$b&&A($b,p)}for(y=0;y<n.length;y++)($b=n[y].node_tree)&&A($b,p);for(y=0;y<w.length;y++){var Qa=w[y],fa=Qa.type;"IMAGE"!=fa&&"ENVIRONMENT_MAP"!=fa||G(Qa,"image",p)}for(y=0;y<g.length;y++){var Ia=g[y];Ia.dof_object&&G(Ia,"dof_object",p)}for(y=0;y<v.length;y++){var pa=v[y];pa.sound&&G(pa,"sound",p);if(pa.animation_data&&
(E=pa.animation_data,E.action&&G(E,"action",p),E.nla_tracks))for(C=0;C<E.nla_tracks.length;C++)for(P=E.nla_tracks[C],H=0;H<P.strips.length;H++)P.strips[H].action&&G(P.strips[H],"action",p)}for(y=0;y<t.length;y++){for(var T=t[y],S=T.texture_slots,C=0;C<S.length;C++)G(S[C],"texture",p);T.dupli_group&&G(T,"dupli_group",p);T.dupli_object&&G(T,"dupli_object",p)}for(y=0;y<u.length;y++){var O=u[y];if(O.animation_data&&(E=O.animation_data,E.action&&G(E,"action",p),E.nla_tracks))for(C=0;C<E.nla_tracks.length;C++)for(P=
E.nla_tracks[C],H=0;H<P.strips.length;H++)P.strips[H].action&&G(P.strips[H],"action",p)}for(y=0;y<wa.length;y++){var Q=wa[y];if(S=Q.texture_slots)for(C=0;C<S.length;C++)G(S[C],"texture",p);if(Q.animation_data&&(E=Q.animation_data,E.action&&G(E,"action",p),E.nla_tracks))for(C=0;C<E.nla_tracks.length;C++)for(P=E.nla_tracks[C],H=0;H<P.strips.length;H++)P.strips[H].action&&G(P.strips[H],"action",p)}va.vG(a);for(var Da=a.textures,Ra=b.mb?a.scenes[0].b4w_anisotropic_filtering:La.b4w_anisotropic_filtering,
ma=0;ma<Da.length;ma++)b.mb||"SCENE"!=Da[ma].b4w_source_type||(Da[ma].b4w_source_id=""),Ba.ZH(Da[ma],Ra,a.scenes,b.id);for(var Ma={},ga=a.objects,Ea=0;Ea<ga.length;Ea++){var Aa=ga[Ea];if("MESH"===Aa.type&&!Aa.particle_systems.length)for(var ja=Aa.data,ra=ja.name,ha=ja.submeshes,la=ja.materials,Z=0;Z<ha.length;Z++)0!==ha[Z].base_length||Ma[ra]||(la[Z]&&ya.warn('material "'+la[Z].name+'" is not assigned to any face (object "'+Aa.name+'").'),Ma[ra]=!0)}for(var ea=a.meshes,qa=0;qa<ea.length;qa++){var ta=
ea[qa];ta.materials.length||ta.uv_textures.length&&ya.warn('mesh "'+ta.name+'" has a UV map but has no exported material.')}a.materials.push(va.nH());for(var bb=a.meshes,Ka=xa.keysearch("name","DEFAULT",a.materials),Ua=0;Ua<bb.length;Ua++){var Na=bb[Ua];0==Na.materials.length&&Na.materials.push(Ka)}for(var Bb=a.actions,Ta=b.id,Ya=0;Ya<Bb.length;Ya++){var kb=Bb[Ya];kb.bF=Ta;oa.jF(kb)}for(var cc=a.scenes,Ha=0;Ha<cc.length;Ha++){for(var gb=cc[Ha],$a=[],Nb=[],ib=cc[Ha].objects,Wa=0;Wa<ib.length;Wa++){var tb=
ib[Wa];F(ib,tb,null,$a,Nb);var ob=tb.dupli_group;if(ob)for(var hb=ob.objects,Ic=0;Ic<hb.length;Ic++)F(hb,hb[Ic],tb,$a,Nb)}for(Wa=0;Wa<Nb.length;Wa++)for(var kc=Nb[Wa],ad=[gb],ub=0;ub<ad.length;ub++){for(var dc=ad[ub].objects,ec=0;ec<dc.length;ec++){var yc=dc[ec].dupli_group;if(yc){var Xa=yc.objects,ab=Xa.indexOf(kc);-1<ab&&Xa.splice(ab,1)}}var ab=dc.indexOf(kc);-1<ab&&dc.splice(ab,1)}for(Wa=0;Wa<$a.length;Wa++)xa.EF($a[Wa][0],$a[Wa][1])}!b.mb&&1<a.scenes.length&&(a.scenes=[Fa.Eq(a.scenes)],ya.warn("loading data contains multiple scenes.",
"Only the first one will be loaded."));var Jc=b.mb?La:Fa.Eq(a.scenes);Y.wM(La.fps);1<a.scenes.length&&(a.scenes.splice(a.scenes.indexOf(La),1),a.scenes.unshift(La));for(var Yb=0;Yb<a.scenes.length;Yb++){var qb=a.scenes[Yb];qb.p={};qb.Ix=qb==Jc;qb.cF=b.mb;sa.enabled&&qb.b4w_enable_physics&&(b.mb||!Ca.cs(La)&&qb==Fa.Eq(a))&&Ca.fK(qb)}for(var lc=0;lc<a.scenes.length;lc++){for(var Kc=a.scenes[lc],bd=B(Kc),zc=0;zc<bd.length;zc++){var vb=bd[zc];ia.wG(vb,Kc,a)&&(vb.Mc||(vb.Mc=[]),vb.Mc.push(b.mb?Kc:La))}for(var Rc=
bd,Lc=0;Lc<Rc.length;Lc++){var rc=Rc[Lc];if(rc.Mc&&"WORLD"!=rc.type)for(var cd=rc.particle_systems,Ob=0;Ob<cd.length;Ob++){var sc=cd[Ob].settings;if("HAIR"==sc.type)if("OBJECT"==sc.render_type){var Vc=sc.dupli_object;Vc.Mc||(Vc.Mc=rc.Mc.slice())}else if("GROUP"==sc.render_type)for(var kd=sc.dupli_group,nd=0;nd<kd.objects.length;nd++)Vc=kd.objects[nd],Vc.Mc||(Vc.Mc=rc.Mc.slice())}}}for(var ld=a.scenes,gd=[],Gb=0;Gb<ld.length;Gb++)l(ld[Gb].objects,0,b.mb,gd);za[b.id]=[];for(Gb=0;Gb<gd.length;Gb++)for(var Mc=
gd[Gb],tc=0;tc<Mc.length;tc++)for(var od=Mc[tc],Wc=0;Wc<od.length;Wc++)za[b.id].push(od[Wc]);for(var md=a.particles,Gb=0;Gb<md.length;Gb++){var Sc=md[Gb].dupli_object;Sc&&(Sc.Hx=!0,za[b.id].push(Sc));var pd=md[Gb].dupli_group;if(pd)for(var qd=pd.objects,tc=0;tc<qd.length;tc++)Sc=qd[tc],Sc.Hx=!0,za[b.id].push(Sc)}for(var rd=za[b.id],Gb=rd.length-1;0<=Gb;Gb--)rd[Gb].Mc||rd.splice(Gb,1);for(var zd=za[b.id],lc=0;lc<zd.length;lc++)if(vb=zd[lc],!b.mb&&vb.parent&&-1<jb.indexOf(vb.parent.type)&&(vb.parent=
""),"MESH"==vb.type){var sd=va.HF(vb);sd&&(a.meshes.push(sd),vb.data=sd)}for(var td=0;td<a.scenes.length;td++){var Ad=a.scenes[td],ud=Ad.world;ud.Mc||(ud.Mc=[]);ud.Mc.push(b.mb?Ad:La)}for(var vd=0;vd<a.scenes.length;vd++){var wd=a.scenes[vd];if(wd.b4w_use_logic_editor){var Bd=B(wd);va.NF(Bd,wd)}}for(var xd=0;xd<a.scenes.length;xd++){var Cd=a.scenes[xd],yd=b.mb?Cd:La;Boolean(f(b.id,yd,"SPEAKER").length)&&!yd.rc&&Ja.SF(yd)}e(b,c)}function B(a){var b=[];-1==a.objects.indexOf(a.camera)&&a.objects.push(a.camera);
d(a.objects,"ALL",b);return b}function d(a,b,c){for(var e=0;e<a.length;e++){var f=a[e];"ALL"!=b&&b!=f.type||c.push(f);(f=f.dupli_group)&&d(f.objects,b,c)}}function l(a,b,c,d){d[b]=d[b]||[];for(var e=d[b],f=0;f<a.length;f++){var g=a[f],h=ra(g);e[h]=e[h]||[];(c||-1==jb.indexOf(g.type))&&-1==e[h].indexOf(g)&&e[h].push(g);(g=g.dupli_group)&&l(g.objects,b+1,c,d)}}function f(a,b,c){var d=[];a=za[a];for(var e=0;e<a.length;e++){var f=a[e];if(f.type==c||"ALL"==c)for(var g=0;g<f.Mc.length;g++)b==f.Mc[g]&&d.push(f)}return d}
function H(a,b,c,d,e){var f=za[b.id],g=a.worlds;d=b.id;for(var h=0;h<f.length;h++){for(var k=f[h],l=na.In(k.name,k.type,k.origin_name),m=0;m<k.Mc.length;m++)na.en(l,k.Mc[m]);k.xa=l;ia.lj(k,l);l.k.ud=d;l.uo=k.Hx||!1}for(d=0;d<g.length;d++){h=g[d];k="%meta_world%"+h.name;k=na.In(k,"WORLD",k);for(l=0;l<h.Mc.length;l++)na.en(k,h.Mc[l]);h.xa=k;ia.qO(h,k)}d=ia.get_all_objects(b.id);for(h=0;h<f.length;h++)k=f[h],l=k.xa,ca.lj(k,l);for(h=0;h<g.length;h++)k=g[h],ca.lj(k,k.xa);if(b.mb)for(g=b.id,h=0;h<a.scenes.length;h++)for(var k=
a.scenes[h],l=0,m=ia.yb(k,"LAMP",g),n=0;n<m.length;n++)na.fa(m[n],k).vk=l++;for(h=0;h<f.length;h++)k=f[h],l=k.xa,l.uo||(ia.fO(k,l),wa.u(l));for(a=0;a<f.length;a++)if(g=f[a],h=g.xa,na.is_mesh(h)&&(k=g.lod_levels.length))for(l=h,m=0;m<k;m++)if(n=g.lod_levels[m].object){n=n.xa;n.k.Di=h.k.Di;l.k.Gg=g.lod_levels[m].distance;n.k.xk=g.lod_levels[m].distance;if(g.lod_levels[m+1])n.k.Gg=g.lod_levels[m+1].distance;else{n.k.Sl=!0;n.k.Gg=na.et;break}l.k.Sl=!1;l=n}else{l.k.Sl=!0;l.k.Gg=g.lod_levels[m].distance;
break}for(f=0;f<d.length;f++)if(a=d[f],"MESH"==a.type&&(g=a.Xp)){var g=g.k,h=a.k.gi,k=[],Y;for(Y in h)l=h[Y],k.push(4*l.ju,4*l.fi);g.xr.push(k);g.pm.push(a.k)}f=Y=-1;a=oa.Qz();for(g=0;g<d.length;g++)h=d[g],k=h.k,na.is_mesh(h)&&k.Ai&&(h=k.Tf,h>Y&&(Y=h),a>=h&&h>f&&(f=h));for(g=0;g<d.length;g++)h=d[g],k=h.k,na.is_mesh(h)&&k.Ai&&(k.bk=!0,Y<a?k.Tf=Y:k.Tf<=a?k.Tf=f:(ya.warn('too many bones for "'+h.name+'" / '+k.Tf+" bones (max "+a+" with blending, "+2*a+" without blending). Blending between frames will be disabled."),
k.Tf=Y,k.bk=!1),k.bk=k.bk&&!Qa.wz);for(Y=0;Y<d.length;Y++)if(f=d[Y],f.le)if(a=f.we,"CHASSIS"==a.oe){f.s={};f.s.ao=a.ao;f.s.qn=a.qn;f.s.Ew=a.Ew;f.s.Gw=a.Gw;f.s.Fw=a.Fw;f.s.jx=a.jx;f.s.dw=a.dw;f.s.lv=a.lv;f.s.zl=0;f.s.pn=1;f.s.vm=0;f.s.speed=0;f.s.Hk=[];f.s.Mo=[];f.s.xm=null;h=(g=na.get_dg_parent(f))?na.Cu(g,d):d;for(g=0;g<h.length;g++)k=h[g],k.le&&(l=k.we,Ca.jK(k)&&a.name==l.name?(l=Ca.WO(k.we.oe),f.s.Hk[l]=k,f.s.Mo[l]=new Float32Array(8)):Ca.oA(k)&&a.name==l.name?(f.s.xm=k,f.s.wm=l.wm,f.s.ip=l.ip,
f.s.ro=l.ro,l=ua.invert(f.k.m,ua.create()),k=ua.multiply(l,k.k.m,l),f.s.iC=k,l=new Float32Array([1,0,0]),ua.transform_dir_vec3(l,k,l),f.s.hC=l):Ca.nA(k)&&a.name==l.name?(f.s.uw=k,f.s.fp=l.fp,f.s.Wl=l.Wl,l=ua.invert(f.k.m,ua.create()),k=ua.multiply(l,k.k.m,l),f.s.cC=k,l=new Float32Array([1,0,0]),ua.transform_dir_vec3(l,k,l),f.s.bC=l):Ca.pA(k)&&a.name==l.name&&(f.s.Hw=k,f.s.On=l.On,l=ua.invert(f.k.m,ua.create()),k=ua.multiply(l,k.k.m,l),f.s.qC=k,l=new Float32Array([1,0,0]),ua.transform_dir_vec3(l,k,
l),f.s.pC=l));4!=f.s.Hk.length&&xa.q("Not enough wheels for chassis "+f.name)}else if("HULL"==a.oe)for(f.s={},f.s.Hk=[],f.s.Mo=[],f.s.ao=a.ao,f.s.qn=a.qn,f.s.$j=a.$j,f.s.$k=a.$k,f.s.al=a.al,f.s.zl=0,f.s.pn=1,f.s.vm=0,f.s.speed=0,f.s.xm=null,h=(g=na.get_dg_parent(f))?na.Cu(g,d):d,g=0;g<h.length;g++)k=h[g],k.le&&(l=k.we,Ca.iK(k)&&a.name==l.name?(f.s.Hk.push(k),f.s.Mo.push(new Float32Array(8))):Ca.oA(k)&&a.name==l.name?(f.s.xm=k,f.s.wm=l.wm,f.s.ip=l.ip,f.s.ro=l.ro,l=ua.invert(f.k.m,ua.create()),k=ua.multiply(l,
k.k.m,l),f.s.iC=k,l=new Float32Array([1,0,0]),ua.transform_dir_vec3(l,k,l),f.s.hC=l):Ca.nA(k)&&a.name==l.name?(f.s.uw=k,f.s.fp=l.fp,f.s.Wl=l.Wl,l=ua.invert(f.k.m,ua.create()),k=ua.multiply(l,k.k.m,l),f.s.cC=k,l=new Float32Array([1,0,0]),ua.transform_dir_vec3(l,k,l),f.s.bC=l):Ca.pA(k)&&a.name==l.name&&(f.s.Hw=k,f.s.On=l.On,l=ua.invert(f.k.m,ua.create()),k=ua.multiply(l,k.k.m,l),f.s.qC=k,l=new Float32Array([1,0,0]),ua.transform_dir_vec3(l,k,l),f.s.pC=l));for(Y=0;Y<d.length;Y++)if(f=d[Y],f.rk&&(a=f.Cl,
"MAIN_BODY"==a.oe))for(f.mf={},f.mf.$j=a.$j,f.mf.$k=a.$k,f.mf.al=a.al,f.mf.bq=[],g=(g=na.get_dg_parent(f))?na.Cu(g,d):d,h=0;h<g.length;h++)k=g[h],k.rk&&(l=k.Cl,Ca.lK(k)&&a.name==l.name&&(f.mf.bq.push(k),k.jy=k.Cl.oC));e(b,c)}function D(a,b,c,d,e){for(d=0;d<a.scenes.length;d++){var g=a.scenes[d];g.ai=g.camera.xa}for(d=0;d<a.scenes.length;d++){var g=b.mb?a.scenes[d]:La,h=b.mb?ia.yb(g,"LAMP",b.id):ia.yb(g,"LAMP",0),k=ia.yb(g,"ALL",b.id),l=f(b.id,g,"MESH"),m=f(b.id,g,"EMPTY");f(b.id,g,"WORLD");b.mb&&
Fa.qF(g,k,h,l,m);for(var k=!1,n=0;n<m.length;n++)for(var Y=m[n].xa,q=Y.C,t=0;t<q.length;t++){var r=q[t].Ra,v=Fa.IC(r,Y);g.name==r.name&&(k=k||v)}b.mb&&g.p.oc&&!k&&ya.warn('Scene "'+g.name+'" has water but has no wind.');m=[];Fa.set_active(g);ea.nJ(g,l,h,m);n=f(b.id,g,"LINE");ea.mJ(g,n);Y=Fa.Gu(g);if(b.mb){n=g.p.os;if(n.QL||n.procedural_skydome)k=g.world.xa,ea.vF(g,n,k),ea.Wt(k,Y,g);Fa.Cz(Y)}for(n=0;n<l.length;n++)ea.Wt(l[n].xa,Y,g);for(n=0;n<m.length;n++)ea.Wt(m[n],Y,g),ia.pL(m[n]);k=ia.yb(g,"ALL",
b.id);Fa.OF(g,k,h);for(n=0;n<k.length;n++)Y=k[n],Y.k.Ud&&ia.update_boundings(Y),na.CG(Y)&&(Y.QA=!0)}Fa.rF(La,a.textures,b.id);b.mb&&La.p.Nm.length&&(b.Qu=!0);d=a.materials;if($b.iu&&ba.PC)for(a=0;a<d.length;a++){l=d[a];n=l.texture_slots;for(g=0;g<n.length;g++)if(m=n[g],Y=m.texture,"IMAGE"==Y.type||"ENVIRONMENT_MAP"==Y.type)h=Y.image,h.Ce||(-1<h.filepath.indexOf(".dds")?h.Ce=!0:(h.Ce=!Y.b4w_disable_compression&&!m.use_map_normal&&"ENVIRONMENT_MAP"!=Y.type&&!Y.b4w_shore_dist_map&&"MOVIE"!=h.source,
h.Ce&&(h.filepath+=".dds")));if(g=l.node_tree)for(l=g.nodes,g=0;g<l.length;g++)h=l[g],"TEXTURE"==h.type&&(n=h.texture)&&(h=n.image)&&!h.Ce&&(h.Ce=n.p.kl&&!n.b4w_disable_compression&&"MOVIE"!=h.source&&"ENVIRONMENT_MAP"!=n.type,h.Ce&&(h.filepath+=".dds"))}else for(a=a.images,d=0;d<a.length;d++)g=a[d],g.Ce=Boolean("FILE"==g.source&&-1<g.filepath.indexOf(".dds"));e(b,c)}function w(a,b,c,d,e){d=a.groups;for(var f=a.objects,g={},h={},k={},l={},m=0;m<d.length;m++){var n=d[m];g[n.uuid]=n;k[n.uuid]=n}for(m=
0;m<f.length;m++)n=f[m],h[n.uuid]=n,l[n.uuid]=n;a=a.scenes;for(m=0;m<a.length;m++)E(a[m].objects,null,l,k,null);for(var Y in k)Y in g||d.push(k[Y]);for(Y in l)Y in h||f.push(l[Y]);e(b,c)}function E(a,b,c,d,e){for(var f=[],g=0;g<a.length;g++){var h=a[g],k=c[h.uuid];if(h=k.proxy){b&&-1==f.indexOf(h.uuid)&&f.push(h.uuid);for(var l=c[h.uuid],m=l.constraints,h=0;h<m.length;h++){var n=xa.ki(m[h]);n.name+="_CLONE";k.constraints.push(n)}"b4w_proxy_inherit_anim"in k&&!k.b4w_proxy_inherit_anim||(k.animation_data&&
(l.animation_data=xa.ki(k.animation_data)),l.b4w_use_default_animation=k.b4w_use_default_animation,l.b4w_auto_skel_anim=k.b4w_auto_skel_anim,l.b4w_anim_behavior=k.b4w_anim_behavior,l.b4w_cyclic_animation=k.b4w_cyclic_animation)}}for(g=0;g<f.length;g++)k=xa.IJ(a,f[g]),-1<k&&a.splice(k,1);f={};if(b)for(g=0;g<a.length;g++)h=a[g],k=c[h.uuid],m=xa.ki(k),l="origin_name"in k?k.origin_name:k.name,m.name=na.Bz(b.name,l),m.origin_name=l,m.dg_parent={uuid:b.uuid},y(m),c[m.uuid]=m,f[h.uuid]=m.uuid,h.uuid=m.uuid,
e&&e[k.uuid]&&(m.b4w_cluster_data=e[k.uuid]);for(g=0;g<a.length;g++)h=a[g],k=c[h.uuid],k.dupli_group&&(h=k.dupli_group,e=d[h.uuid],m=xa.ki(e),m.name=xa.mp(e.name+"_CLONE"),m.uuid=V.dA("Group"+m.name),d[m.uuid]=m,h.uuid=m.uuid,E(m.objects,k,c,d,k.b4w_cluster_data));if(b)for(g=0;g<a.length;g++){h=a[g];k=c[h.uuid];k.parent&&k.parent.uuid in f?k.parent.uuid=f[k.parent.uuid]:k.parent&&(ya.warn("Object's \""+k.name+'" parent is not in dupli group. Disabling parenting.'),k.parent=null);m=k.constraints;for(h=
0;h<m.length;h++)b=m[h],b.target&&b.target.uuid in f&&(b.target.uuid=f[b.target.uuid]);if(b=k.pose)for(d=b.bones,h=0;h<d.length;h++)if(e=d[h].constraints)for(m=0;m<e.length;m++)b=e[m],b.target&&b.target.uuid in f&&(b.target.uuid=f[b.target.uuid]);b=k.modifiers;for(h=0;h<b.length;h++)d=b[h],d.object&&d.object.uuid in f&&(d.object.uuid=f[d.object.uuid]);if((k=k.lod_levels)&&k.length)for(h=0;h<k.length;h++)b=k[h],b.object&&b.object.uuid in f&&(b.object.uuid=f[b.object.uuid])}for(var Y in f)bb[Y]=f[Y]}
function y(a){a.uuid=V.dA("Object"+a.name)}function A(a,b){for(var c=a.nodes,d=0;d<c.length;d++){var e=c[d];"TEXTURE"==e.type&&e.texture&&G(e,"texture",b);"LAMP"==e.type&&e.lamp&&(e.lamp.uuid in bb&&(e.lamp.uuid=bb[e.lamp.uuid]),b[e.lamp.uuid]||(e.lamp=null));"GROUP"==e.type&&e.node_group&&G(e,"node_group",b)}e=a.links;for(d=0;d<e.length;d++){var f=e[d];x(f,"from_node",c);x(f,"to_node",c);k(f,"from_socket",f.from_node.outputs);k(f,"to_socket",f.to_node.inputs)}if(c=a.animation_data)if(c.action&&G(c,
"action",b),c.nla_tracks)for(d=0;d<c.nla_tracks.length;d++)for(e=c.nla_tracks[d],f=0;f<e.strips.length;f++)e.strips[f].action&&G(e.strips[f],"action",b)}function G(a,b,c){(c=c[a[b].uuid])||ya.error("Dangling link found:",b,a);a[b]=c}function x(a,b,c){c=xa.keysearch("name",a[b].name,c);a[b]=c}function k(a,b,c){c=xa.keysearch("identifier",a[b].identifier,c);a[b]=c}function t(a,b,d,e,f,g){e=Z(b.yg);for(var h=a.images,k={},l=[],m=0;m<h.length;m++){var n=h[m],Y=n.uuid;if("FILE"===n.source||"MOVIE"===n.source){var q=
u(n,a.textures);if(!q.length)ya.warn("image ",n.name," has no users.");else if(!q[0].b4w_shore_dist_map){q=xa.Co(e+n.filepath);if("FILE"===n.source){var t=n.Ce?ha.AT_ARRAYBUFFER:ha.AT_IMAGE_ELEMENT,r=ha.gp(q),v=r[1].toLowerCase();if(!ha.BG(v)){ya.error("image ",n.name," has unsupported format.");continue}$b.pv&&ba.use_min50&&("dds"==r[1]?(q=ha.gp(r[0]),q=q[0]+".min50."+q[1]+".dds"):q=r[0]+".min50."+r[1])}else if("MOVIE"===n.source)if(ba.Yo)r=ha.gp(q),q=r[0]+".altconv.seq",t=ha.xp;else{var r=ha.gp(q),
v=r[1].toLowerCase(),w=Ja.detect_video_container(v);if(""==w){ya.error("failed to load video file (unsupported format)",q);continue}q=w!=v?r[0]+".altconv."+w:r[0]+"."+r[1];t=ha.yp}l.push({id:Y,type:t,url:q});k[Y]=n}}}if(l.length){var wa=0;ha.enqueue(l,function(e,f,h,m){if(e){if(h==ha.yp||h==ha.xp){if(h==ha.yp)var n=e.videoWidth,Y=e.videoHeight;else n=e.images[0].width,Y=e.images[0].height;ya.log("%cLOAD VIDEO "+n+"x"+Y,"color: #"+(2048<n||2048<Y?"a00":1024<n||1024<Y?"aa0":"0a0"),m);-1==m.indexOf(Da)&&
ya.warn("video",m,"is not from app root.")}else c(e,m,!0);f=k[f];m=u(f,a.textures);for(n=0;n<m.length;n++){var Y=m[n],q=Y.image.filepath;h==ha.xp?(Y.p.Wo=e.Qf,Ba.Cs(Y.p,e.images,f.Ce,q,b.id)):Ba.Cs(Y.p,e,f.Ce,q,b.id)}}e=++wa/l.length;g(b,d,e)},function(){ya.log("%cLOADED ALL IMAGES","color: #0a0");f(b,d)})}else f(b,d)}function M(a,b,c,d,e){a=Fa.Iu();for(d=0;d<a.length;d++){var f=a[d];if(f.b4w_use_nla){var g=f.b4w_nla_cyclic;f.b4w_use_logic_editor&&(g=!1);ca.kO(f,g,b.id)}}e(b,c)}function u(a,b){for(var c=
[],d=0;d<b.length;d++){var e=b[d];e.image===a&&c.push(e)}return c}function v(a,b,c,d,e,f){a=Z(b.yg);var g=[],h={};d=ia.get_all_objects(b.id);for(var k=0;k<d.length;k++){var l=d[k];if(z(l)){var m=l.L.mj;"BACKGROUND_MUSIC"==Ja.Ju(l)?(m=xa.yu(),b.Ou=!0):"NONE"!=Ja.Ju(l)&&ba.Su&&(b.Ru=!0);if(!(m in h)){h[m]=[];var n=xa.Co(a+l.L.yg);switch(Ja.aC(l)){case Ja.Ts:var Y=ha.AT_AUDIOBUFFER;break;case Ja.ox:Y=ha.AT_AUDIO_ELEMENT}var q=ha.gp(n),t=q[1].toLowerCase(),r=Ja.detect_audio_container(t);""!=r?(n=r!=t?
q[0]+".altconv."+r:q[0]+"."+q[1],g.push({id:m,type:Y,url:n})):ya.error("failed to load audio file (unsupported format)",n)}h[m].push(l)}}if(g.length){var v=0;ha.enqueue(g,function(a,d,e,k){if(a)for(ya.log("%cLOAD SOUND","color: #0aa",k),-1==k.indexOf(Da)&&ya.warn("sound",k,"is not from app root."),d=h[d],e=0;e<d.length;e++)Ja.oO(d[e],a);a=++v/g.length;f(b,c,a)},function(){ya.log("%cLOADED ALL SOUNDS","color: #0aa");e(b,c)})}else e(b,c)}function z(a){return na.is_speaker(a)&&Ja.aC(a)!=Ja.px}function S(a,
b,c){a=ia.yb(a,"SPEAKER",b);for(b=0;b<a.length;b++){var d=a[b];na.is_speaker(d)&&(Ja.hK(d)||c)&&Ja.play_def(d)}}function C(a,b){for(var c=a.p.Nm,d=0;d<c.length;d++){var e=c[d].p;a.b4w_use_nla&&c[d].b4w_nla_video||!c[d].use_auto_refresh||b!=e.hg||(Ba.reset_video(e.name,b),Ba.play_video(e.name,b))}}function W(a,b,c,d,e){ca.start();ya.log("%cSTART NLA","color: #0a0");e(b,c)}function F(a,b,c,d,e){if(b.lod_levels&&b.lod_levels.length)for(var f=b.lod_levels.length,g=0;g<f;g++){var h=b.lod_levels[g],k=h.object;
if(k){var l=xa.An(k);l.name=b.name+"_LOD_"+String(g+1);l.b4w_cluster_data=b.b4w_cluster_data;y(l);l.lod_levels=[];c&&(l.dg_parent=c);d.push([a,l]);e.push(k);h.object=l}}}function K(a,b,c,d,e){d=!0;for(var f=0;f<a.scenes.length;f++)if(!Ca.IG(a.scenes[f])){d=!1;break}d&&(e(b,c),ya.log("%cPHYSICS READY","color: #0a0"))}function X(a,b,c,d,e){for(d=0;d<a.scenes.length;d++){var f=a.scenes[d];if(b.mb)var g=Ca.cs(f);else g=Ca.cs(La)||Ca.cs(f),f=La;if(sa.enabled&&g)for(g=0;g<kb.length;g++)for(var h=ia.yb(f,
kb[g],b.id),k=0;k<h.length;k++){var l=h[k];l.k.ud==b.id&&(Ca.append_object(l,f),b.CA&&Ca.ia(l)&&Ca.disable_simulation(l))}}e(b,c)}function N(a,b,d,e,f){var g={};e=[];for(var h=a.scenes,k=0;k<a.scenes.length;k++){var l=h[k];if(l.p.oc&&(l=l.p.oc.cj)&&"FILE"===l.source){var m=l.uuid,n=xa.Co(Z(b.yg)+l.filepath);e.push({id:m,type:l.Ce?ha.AT_ARRAYBUFFER:ha.AT_IMAGE_ELEMENT,url:n});g[m]=l}}e.length?ha.enqueue(e,function(d,e,f,k){if(d){c(d,k,!0);e=g[e];k=u(e,a.textures);for(f=0;f<k.length;f++){var l=k[f];
Ba.Cs(l.p,d,e.Ce,l.image.filepath,b.id)}for(f=0;f<h.length;f++)if(k=h[f],k.p.oc&&(l=k.p.oc.cj,l===e)){var m=d,n=document.createElement("canvas"),l=e.size[0],Y=e.size[1];n.width=l;n.height=Y;n=n.getContext("2d");n.drawImage(m,0,0);m=n.getImageData(0,0,l,Y).data;n=new Float32Array(4);n[0]=1/16581375;n[1]=1/65025;n[2]=1/255;n[3]=1;for(var l=l*Y,Y=new Float32Array(l),q=0;q<l;q++)Y[q]=n[1]*m[4*q+2]+n[2]*m[4*q+3];k.p.nw=Y}}else for(e=g[e],f=0;f<h.length;f++)k=h[f],l=k.p.oc.cj,l===e&&(k.p.oc.cj=null,ya.warn("image",
l.filepath," was not found. Disabling water shore effects."))},function(){f(b,d)}):f(b,d)}function L(a,b,d,e,f){e=a.scenes[0];a=[];for(var g=[Oa.Hp,Oa.Ym,Oa.Ip,Oa.ht],h=0;h<g.length;h++){var k=Fa.Ba(e,g[h]);k&&a.push(k)}if(a.length){e=[];h=ha.AT_IMAGE_ELEMENT;e.push({id:"SEARCH_TEXTURE",type:h,yg:ka.Od.smaa_search_texture_path});e.push({id:"AREA_TEXTURE",type:h,url:ka.Od.smaa_area_texture_path});for(h=0;h<a.length;h++)if(g=a[h],g.type==Oa.Ym){a=g.Ha;for(h=0;h<a.length;h++)if(g=a[h],"u_search_tex"==
g.to)var l=g.Ja;else if("u_area_tex"==g.to)var m=g.Ja;break}e.length?ha.enqueue(e,function(a,d,e,f){a&&(c(a,f,!1),d="SEARCH_TEXTURE"==d?l:m,d.source="IMAGE",d.KP=!0,Ba.Cs(d,a,-1!=f.indexOf(".dds")?1:0,f,b.id),Ba.jw(d,Ba.G,Ba.G))},function(){f(b,d)}):f(b,d)}else f(b,d)}function P(a,b,c,d){for(c=0;c<a.scenes.length;c++){var e=a.scenes[c];b.mb||(e=La);for(var f=ia.yb(e,"LAMP",b.id),g=0;g<f.length;g++){var h=f[g];h.k.ud==b.id&&d.ot.push({Ra:e,obj:h})}f=ia.yb(e,"ALL",b.id);for(g=0;g<f.length;g++)h=f[g],
"LAMP"!=h.type&&h.k.ud==b.id&&(b.CA&&na.is_mesh(h)&&Fa.vn(h,!0),d.ot.push({Ra:e,obj:h}))}}function da(a,b,c,d,e,f){var g=d.ot;e=d.ZA;if(g.length){a=g[e].obj;var h=g[e].Ra;e=na.fa(a,h);Fa.append_object(h,a,!1);!a.anchor||h.p.no||h.p.anaglyph_use||ja.append(a);d=++d.ZA/g.length;g=e.jh;if(-1!=a.k.fe&&g){var k=gc.copy(a.k.Dc.J,Bb);Fa.HC(g,k)}g=a.To;if(g.length&&h.p.Mg)for(h=ua.get_trans_view(a.k.m),a=ua.get_quat_view(a.k.m),e=e.Lg,k=0;k<e.length;k++)Fa.JC(e[k],h,a),na.KC(g,e[k].o.Fb)}else d=1;f(b,c,d)}
function U(a,b,c,d,e){if(b.mb){d=Fa.ik();var f=Fa.Iu();for(a=0;a<f.length;a++)Fa.HL(f[a],d);Fa.set_active(d)}else Fa.LC(La);d=ia.get_all_objects(b.id);ia.gO(d);for(f=0;f<d.length;f++){var g=d[f];for(a=0;a<g.C.length;a++)for(var h=g.C[a].P,k=0;k<h.length;k++)null==h[k].La&&h.splice(k--,1)}e(b,c)}function ga(a,b,c,d,e){if(b.mb)for(a=Fa.Iu(),d=0;d<a.length;d++){var f=a[d];f.b4w_use_logic_editor&&pa.dK(f,b.id)}e(b,c)}function T(a,b,c,d,e){if(b.mb)for(d=0;d<a.scenes.length;d++)C(a.scenes[d],b.id),S(a.scenes[d],
b.id,!1);else C(La,b.id),S(La,b.id,!1);e(b,c)}function la(a,b,c,d,e){for(d=0;d<a.scenes.length;d++)a.scenes[d].camera=null;ba.media_auto_activation&&(b.Qu||b.Ou||b.Ru)?ta||O(a,e,b,c):e(b,c)}function O(a,b,c,d){function e(){if(!h){h=!0;c.Qu&&(Ba.play(),Ba.pause(),Ba.reset());if(c.Ou){if(c.mb)for(var f=0;f<a.scenes.length;f++)S(a.scenes[f],c.id,!0);else S(La,c.id,!0);Ja.pause()}c.Ru&&Ja.lB();Q();b(c,d)}}var f=Na.parentElement;Ta=f.style.zIndex;f.style.zIndex="999";ta=document.createElement("div");ta.style.position=
"relative";ta.style.height="88px";ta.style.width="88px";var g=Math.round(Na.offsetWidth/2-44);ta.style.top=Math.round(Na.offsetHeight/2-44).toString()+"px";ta.style.left=g.toString()+"px";ta.style.backgroundImage="url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALAAAACwCAYAAACvt+ReAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAbrwAAG68BXhqRHAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAABVDSURBVHic7Z15kF1Vncc/v05Ys7JIQJZ0GLaAgCzCQARGFMIwZKTiqCPBAbTEEodBhYKALJKSVWYsCpTBcgCLAdQBHWZACCCyhCElIRiWEMOSBZAkCglJOoTQyW/++J3Xfe95971+273v3fvOp6qr+5573+vT3d8+93vP+Z3fTwjUhKoKsC0wLvKxDTA68rEVMNK9ZDiwpft6PdDvvl4LvA+sBt5zn1cCy4EVwDJgpYhouj9RMZB2d6ATUdWtgD2BXvcxARgPbJ5RFzYAS4BFwGL38YqIvJ/R988NQcCAqm4LHADsA+yLibannX1KYBMm6JeBBcA8EVnZ3i61n64UsKoOAyYCh7iPCeTvd6HA68BcYA6wQEQ2trdL2ZO3P1rDqGoPsD9wNHAkMKqBt1nNoFctfV7j2ldj/rbPXdsvIuvd994S88QAIzCfHPXOHyHurRvt21PALOAFEdnUwHvkjsILWFV7gcnAUcDYWl8GvAEsZNCDLhKR91rfw4RvrjoWuyv0us97ALtS+99rFfAEMFNElqTRx06hkAJ2I94ngRMwXzsUmzCxzsP85csisja9HtaPqo7CbM9EzK/vRW1/vwXATODJ0h2hSBRKwO5hbAom3KFuw2uAZzD/+JyIrEm5ey1FVUcDB2Ee/hPU9vM+ANwnIu+m3L3MKISAVXU3YCrwNwx6zSTWArOBJ7Gn+P4q1+YGVR0OfByzSX+N+exKfAg8DtwtIm9m0L1UybWAVfWjwJcw4Vb6WRT4A3YbnV0U0VZCVTfDRDwZOJDKv5dNwGPAXSLydja9az25FLCqbg9MA44FhlW4bDXwIPYgszyrvnUSqrojJuRqlqof+C1wp4i8k1XfWkWuBKyqmwN/D3wRW7ZN4m3gfzHhfpBV3zoZNyofBXwem81I4gPgHsxabMiqb82SGwGr6lHAV7A50yQWA3cCT4c4gmRcPMeRwCnY0ngSK4BbRGRWZh1rgo4XsJtZOAvzdUm8CfwSeKxbJu+bxQl5EnAqsEuFy+YAPxKRP2fWsQboWAG7X/JJwGkMRnVFWQXcDjwchNsYbnVyMibkMQmXvA/8DLi/U+9qHSlg95B2HvCxhNP9wG+AO0SkL+F8oE7cws9UzCNvlnDJAuA6EVmWacdqoOMErKpHA98keS7zReAGEXkr2151B6q6C3A2sF/C6bWYpXgy215Vp2MErKpbYMI9NuF0H3ArNrPQkbeyouCs2wnA6SQPIo8AN3XKDE9HCFhVdwK+iwWv+DwLXF+k5c88oKrbAecAByecfh24shMsRdsFrKqHYn53pHdqAzYtdk8YdduDG40nA18DtvBOrwP+TURmZ96xCG0VsKp+DrtV+f1YDFwrIkuz7lOgHBeSej6wm38KmzP+deadcrRFwG765kxsmszncexBrXChf3nGzVScg63o+cwEftyOHSGZC9htmLwAONQ71Y/9N/9P1n0K1I6qngycQXkMyjPANVkPPJkKWFVHApcDe3un1mIPBc9n2Z9AY6jqgcBFlM9SLAAuy3J+PjMBu20yM4DdvVPLge+JyBtZ9SXQPC4G+zJsD1+U14BLs9p+lYmAXTzDFZRHQi0EZojIqiz6EWgtqroNcCmWQyPKUuDiLKY+Uxewqo4BrqL8CfZF4PKQrCPfuIe7S7Dg+ShvARekPTilKmBVHYGNvHt4p54FrshT3GmgMm4V9SJsf16URcBFae43TE3Abrbh+5Q/sM0Gri761p5uwwXNTwcO904twOxEKrMTqaRPcvO851Eu3uewqZYg3oIhIh9iVnGOd2ofYLrLhtRy0sr/dSbl/4nzMdvwYUrfM9Bm3MB0JfCCd+pQbFNCy2m5gN3ysL/CthCbWgmrawXHPdfMAF7xTk12iyAtpaUCVtXDsNiGKMuxqbIg3i7BzSzNwPbXRfmqC95qGS0TsKqOA75N/MGwjzDP25W41K+XYausA83AeS58tiW0RMCRucBo7oF+zPMWOrlcoDJudfUqIBrkMxK40KVIaJpWjcBnUR6MfkuIbQiIyDzgNq95d+AbrXj/pgWsqpMo3wb0eIgqC5Rw8cL+Xrrj3P7HpmhKwKr6EeBfvOYlwA3NvG+gkFyPxUhEOcvtQG+YhgXstpucSzykbgO2kyLMOARiOE1ci2XHLDES+I7TUkM0MwJPoTxvw63hoS1QCRFZjCVKiXIAcGKj79mQgJ11+LLX/BxwX6MdCXQN92K7N6Kc1qiVaHQE/ibx7JB9wA/D7uHAUDiN3MhgMRyArWlwqbluAbsskf5qyq0hb0OgVlwe4tu85sPcjFZd1CVgN/l8htf8IrYrNRCohwexAK8oX3OxxTVT7wg8FdghctyPbYEP1iFQF04zNzBYQxpge+Cz9bxPzQJ2qYb+wWu+NyTaCzSKW2q+32v+gttDWRP1jMDTiOfpXYUllg4EmuFOrJ5JiS2xDPI1UZOAXTWgT3vNt4f8vIFmcRq63Wv+jCtQMyS1jsCnEM/E8haWZjO3qOrDqrp/u/sRAGwSIFqzbjjwj7W8cEgBuwQWftDFfxagMvpngLmqerNbmAm0CVci4ude87GquvNQr61lBP6cd90SrCJ6ERiO7d/7o6pe0KoY1UBDPI5lJS3Rg2mvKlUF7J4Gj/Ga7yjgtNk2wNXAC6r6+XZ3phtxmvqF1/wpl/2nIkONwFOI1x7+E/B0/d3LDXsBvwz+uG08hRWqLLEZySl4B6goYLdN6ASv+b8LOPomEfxxG3Be+F6v+cRqq3PVRuCjie9xWwM82nj3ckfwx+3hYeLzwqNITqoNVBfw8d7xg10aqB78cYa46kd+bM3kStcnCtjVRNgn2gQ81Gznck7wx9kxE9NciYluOreMSiOwr/g/iMjbiVd2H8Efp4wr3+XvaPcdAZAgYJeYz/ccIVwyTvDH6ePf8Y9x2oyRNALvD4yNHPdhKVED5QR/nB5PY7XoSmwD7OtflCRgf9n4/0I61CEJ/rjFuCSB/sBZNhsRE7DL4XqEd01Rlo2zIPjj1uJrb5JvI/wReCIwOnK8GpiXQseKTPDHrWMutv5QYix2txvAF7Bf42BOsA8NE/xxkzjtzfWaYxr1BezvNvbTxQfqJ/jj5njWO45pdEDALuqnN3JuE5asJNAagj9ujGeJL2rs4YpmAvER+EDiyakXplkeqUsJ/rhOXMXP16JNRFKaRQU80XtteHhLj+CP68PX4sB8cE9So+Pl1LoTKBH8cW34WowL2BUlHB+5QIE/pt+vgCP44+rMJ+6DJ7h49YEReE/io/Ebwf9mTvDHFRCR1dhO+BLDcOWLS6Lt9V7j1/gKZEfwx8ks9I4nwKCAd/dOLkq9O4GhCP44jp84vRcqj8BBwJ1D8MeGr8legB5Xn8CPdg9lAjqL4I/jOSMAxquq9ADbAtFfyJpQWbNj6Vp/7BKoR3PxbQmM7QHGedcuy6xXgUbpVn+83DselyRg/6JA59Jt/tjX5g5BwPmnm/xx4gjs5576S0adCbSWbvDHK7zj7XqI78AAy7weyC9F9serveNRSQIOS8jFoIj+2Bfw6CDgYlM0f+xrc3QPVnC52kWB/FMUf+yPwCN7sBysUT7IqDOB7Mm7P97gHW+eJOCwC7n45NUff+gdb5YkYP+iQDHJoz9OFPBwrzGMwN1FnvxxooADgRLvt7sD9dJD+Yjrj8iBYrMSmA7sLyL3tbszQ1Bmd4djw/Lm3kX+016gePQDtwAXi8if292ZGqko4ChhBC4+jwDfFpEX292ROqlJwBVLGgVyz0Lg3BxYhUr4MyUbeihfeRtFoGjkyedWoyzsYTgJ68sZdSaQPnn0udVIFHBZhE9GnQmkS159bjV8bb4XBFw88u5zq+Hb27XDMX8UZfuMOhNoLSuBa4AfugIpRWQH7/id4ZTvM9oxo84EWkPRfG41fG0uTxKwr/JA51JEn1sNX5uJAg4jcOdTZJ9bjbId9D3Au8SD2EdFaxAEOoqizOfWjapuC4yINL0PvNcjIgos9a7vzapjgZroB34C7C0i1xT4Ia0aE7zjJSIyUPUwMfNfoCN4BDhIRL7eBQ9p1ej1jhfBYODOYu+kr/ZA9nSrz63EeO94CQwK2B+B90y9O4FKdMN8biPs5R0vhkEBvwJsxGoPAOyqqqNCnYxM6ab53LpQ1dHAzpGmjcCr4DK0i8h64jZCgH0y6l8g+Nyh2Jd4Ec7XnWZjlYkq1uIKpMZCYIqIHNdFixGN4GvxpdIX1QScx8QXeaFr53Mb5EDveECr0e1Dz2PF5EpD9d6qOsbVqg20huBz60RVxxCvoqUkjcAishJ4PXKhAB9Pu4NdRPC5jXEIcf/7SrSGi58XYm7CiwPNEXxuc/ganBM98AU8xzs+TFXDLuXGCD63SZz2fAHHBllfwAuI79AYSbAR9RLiFlrHwcTT/67CKzkbE7CIbASe8t7kk6l0rZgEn9tajvaOZ4nIpmhDUm60Wd7xEarqJ5QIxAk+t8W4bJmHec2+NhMF/DwWI1xiBHB467pWKILPTY8jga0jx+8SmT4rUSZgFx/sK/2ElnYt/wSfmz7HecdPOG3GqJRedaZ3fKCq7tSSbuWf4HNTRlV3BA7wmh9KujZRwCKyBJuRGGgCjm9J7/JL8LnZMZn44sV8EfF3DQGVR2AoH4VPUNUtm+1ZDgk+N0NUdQvKLauvxQGqCfgJ4nnTRgHHNt613BF8bns4jngGnjUkzD6UqChgEfkA+I3XPFVVu6EsQfC5bcBp67Ne831Oi4kMJcb7iecP3hE4orHu5YLgc9vLJCA6WbAB02BFqgpYRN4FHveap6mqJF2fY4LPbTNu9D3Fa340GnmWRC124G4guny3G+VLfHkl+NzO4Rhg18jxRuBXQ71oSAGLyJvAY17zNFUdlnB5nngAOCD43PbjRt8ves2/E5E/DfXaWh/I7iJejuuj5HxeWEROFBF/G1WgPZwI7BI57gd+XssLaxKwiLwN/NZrPlVVRyRdHwjUiqqOBKZ5zQ+LyLJaXl/PlNidwPrI8RjgS3W8PhBIYhrxed/12B2/JmoWsIi8gz3QRTlJVXdJuj4QGApV3Q34W6/5F272qybqXZT4FfF8wsOBbxVwWi2QMk4z/0x8Z/wy4N563qcuAbtpplu95n0I4ZaB+jmR8oQlP613KrPuZWERmQX83ms+XVW3q/e9At2Jqm4PnOY1zxaR2fW+V6NxDTcCfZHjEQQrEaiBiHWI7rZYB/x7I+/XkICdyb7daz4ImNLI+wW6ipOBQ72220TkL428WTORZfcDL3htp6tqbxPvGSgwqro78E9e8zxsVbQhGhaw25/0r8DaSPPmwPldGvgeqIKqbgWcD0R3uK/BEnmX7XWrlaZie92wf4PXvBtwbvDDgRJOC+cQXy4G+HGj1qFE08HpIvIUFgAe5QjKA5MD3ctUyhPkzBSRJ5t941btrriJeGZLgDNU1c/rGugyVPUgyn3vq8DNrXj/lgjYbfn4PvG8asOA74aHuu7FLRVPZ7D2CpjvvapVsdct298mIiuAHxAPft8auERVt2nV9wnkA1dZ83vEq2sqcJ2I+OWNG6alGzRF5DnKl5rHAZe6p9BAF6CqWwOXUV6c+6ci8mwrv1fLdxiLyK8Bf1/ZnsCMML1WfFxeh0uBv/JOPSgidQXq1EJaW+R/Avjr2hOBi13WwUABcQmpLwQ+5p2agz3ot5xUBOxyuF5HPD0VWLLsC0K61uLh/qYXUb5MPB+42uWebjmpLja4LUdXAHt4p54HZpSK1QXyjbMNF2PxMFEWAReKyNryV7WG1FfLXJnQq7EVuigvAZeLyLq0+xBID/dccwnltdzeBKYPldehWVJPEyUiq7H/Tj+74H7AFWGKLb+4qbJrKBfvUuCitMULGYzAJdzu0xmUVx1/BxuJ/ZW8QAfjFim+R/lU2WvApVkVyMw04MZ54sspLyTeB1wpIvOy7E+gMdzy8HTiixRgD2yXi0hf+avSIfOIMeeZLgA+4Z3aiC2C3NtMeF0gPVxU2VQstsHPzPR74NqsH8zbEvLoUgmdCZyUcHo2FiOa2X9xYGjcwPMtksuuPQjclNZUWTXaGrOrqicDX03ox1Lsv3lx5p0KlOF2UpxPeTzvJuA/0lhhq5W2B52r6gHYL2esd+pD4A7gnmAp2oOzDFOAM4jvpACLKvuBiPj1tTOl7QIGUNVx2CqOv34OVhv3epcZKJARbuv7OZQvToDNNFzZyqiyRukIAcNAZcZvUF4fDGyW4mfAA2E0Thc36v4d9qC2dcIlM4GbOyWXcscIuISqTgLOJl7kucR84AYReSPbXnUHbm73bCzwymcNcKPbQtYxdJyAYeD29R3Ki92B5Y69D7grzFS0BrfIdAqW7ml4wiXzsJmhpjZgpkFHChhqupWtxpKrPNSO6Zsi4LLsnwCcSjzFaYl1wG10sHXrWAGXcOvtX8cq2CSxHPgvTMibKlwTiOAGh0nAl4GdK1z2DPCjThx1o3S8gEs4b/wVbItSEkuxxMizOnW0aDduAWkSZhd2rXDZMmxu9+nMOtYEuREwDET8n4jd8pJsBdiIfC82Iod4YwaCzY8CvkD5YkSJ9Vj+57s7ZYahFnIl4BLOVkwDPk3yQwfYU/ODmJDfzqpvnYSq7oQVzp5MsscFeyh+GHsorjkzeqeQSwGXUNUdsTodn6JybLNiO0BmYjloczO6NIKbTz8SqyK1P5X/xhuB32HCbfuCRKPkWsAlXJ2OqZiQq+23W4cFC80C5opIf5Vrc4OzCAdhNuFwKtsrsCX6R7El+iHrsHU6hRBwCbe74yTMJ1e6ZZbow56052JiTn33QCtR1bHAwcAh2EbKoUqercFS4t6Xt5+1GoUScAm3yfAo7Dbq12FIfAmWr+t5bLXvZbcVqmNQ1THYCtm+2Bae3ant7zcfeAh4slrV97xSSAFHccujx2P1nbet9WXAW1j1+iVY4sIlWT3kuHoj44EJQC+WGKaecmbvAk9gGSALvexeeAGXcJP3+2Ej8yTKwzdroQ+bJ12BTdetwFYE10Q+r8PiZPtL03guGHw49qC5NWZvRkc+74DNb5c+GqmAugrz9rOAl7plLrxrBBzFTejvhXnHQ7C8FXn7XSjwCvCs+1jYjSuRefujpYLzl/tj/nIi5i/9PV/tZiNmZV7Gcmq8mNXO304mCDgBd8vfA/OfvZgXHQ9klZxwPbAY89+L3NevhpXFcoKA68BN05V86g7Adgz62NGYd90KG72Hua8B3sdG0H5MnH2YZy755ncY9NTLijTNlTb/Dz+sKh/f1rAbAAAAAElFTkSuQmCC')";
ta.style.backgroundSize="88px";Ua=document.createElement("div");Ua.style.position="relative";Ua.style.height=Na.offsetHeight.toString()+"px";Ua.style.width=Na.offsetWidth.toString()+"px";Ua.style.background="rgba(0, 0, 0, 0.5)";Ua.style.zIndex="999";f.appendChild(Ua);Ua.appendChild(ta);ta.addEventListener("touchstart",e,!1);ta.addEventListener("click",e,!1);var h=!1}function Q(){if(ta){var a=Na.parentElement;a.style.zIndex=Ta;Ua.removeChild(ta);a.removeChild(Ua);ta=Ua=null;Ta=0}}function Z(a){(a=
a.split("/").slice(0,-1).join("/"))&&(a+="/");return a}function ma(a){oa.is_animated(a)&&oa.remove(a);fa.OL(a);ia.clear_outline_anim(a);I.check_sensor_manifold(a)&&I.remove_sensor_manifold(a);Ca.ia(a)&&Ca.remove_object(a);Fa.PL(a);na.is_speaker(a)&&Ja.iN(a);ja.is_anchor(a)&&ja.remove(a)}function ra(a){var b=oa.Jz(a);return(a=b&&b.parent==a?null:a.parent||b)?1+ra(a):0}var ja=p("__anchors"),oa=p("__animation"),ha=p("__assets"),ea=p("__batch"),ka=p("__config"),I=p("__controls"),Ia=p("__dds"),Aa=p("__debug"),
qa=p("__extensions"),J=p("__input"),aa=p("__loader"),V=p("__md5"),ca=p("__nla"),pa=p("__logic_nodes"),fa=p("__particles"),Ea=p("__nodemat"),ia=p("__objects"),na=p("__obj_util"),Ca=p("__physics"),ya=p("__print"),va=p("__reformer"),Ma=p("__renderer"),Fa=p("__scenes"),Ja=p("__sfx"),Ka=p("__shaders"),Oa=p("__subscene"),Ba=p("__textures"),Y=p("__time"),wa=p("__transform"),ua=p("__tsr"),xa=p("__util"),gc=p("__vec3"),Qa=ka.zj,ba=ka.v,$b=ka.hf,sa=ka.A,R=ka.L,Ra=null,za=null,Da="",La=null,bb={},Bb=new Float32Array(3),
ta=null,Ua=null,Ta=0,Ya=!1,jb=["LAMP","CAMERA"],kb=["MESH","CAMERA","EMPTY"],Na=null;a.is_primary_loaded=function(a){return aa.is_primary_loaded(a)};a.update=function(){aa.lO(Ra)};a.TM=function(a){Na=a};a.dO=function(a,b){if(ta){Ua.style.height=b.toString()+"px";Ua.style.width=a.toString()+"px";var c=Math.round(a/2-44);ta.style.top=Math.round(b/2-44).toString()+"px";ta.style.left=c.toString()+"px"}};a.load=function(a,c,d,f,g){var k={load_main:{Eb:aa.tj,Mb:!1,H:[],Ub:!1,Vb:500,mc:!1,Yb:b},duplicate_objects:{Eb:aa.Gd,
Mb:!1,H:["load_main"],Ub:!1,Vb:50,mc:!1,Yb:w},load_binaries:{Eb:aa.tj,Mb:!1,H:["load_main"],Ub:!1,Vb:500,mc:!1,Yb:n},wait_for_shaders:{Eb:aa.Gd,Mb:!1,H:[],Ub:!1,Vb:50,mc:!0,hi:h},prepare_bindata:{Eb:aa.Gd,Mb:!1,H:["duplicate_objects","load_binaries"],Ub:!1,Vb:100,mc:!1,Yb:r},prepare_bpy_data:{Eb:aa.Gd,Mb:!1,H:["duplicate_objects","prepare_bindata"],Ub:!1,Vb:100,mc:!1,Yb:q},process_objects:{Eb:aa.Gd,Mb:!1,H:["prepare_bpy_data"],Ub:!1,Vb:150,mc:!1,Yb:H},process_scenes:{Eb:aa.Gd,Mb:!1,H:["process_objects",
"wait_for_shaders"],Ub:!1,Vb:300,mc:!1,Yb:D},load_smaa_textures:{Eb:aa.tj,Mb:!1,H:["process_scenes"],Ub:!1,Vb:30,mc:!0,Yb:L},load_shoremap:{Eb:aa.tj,Mb:!1,H:["process_scenes"],Ub:!1,Vb:30,mc:!0,Yb:N},load_textures:{Eb:aa.tj,Mb:!0,H:["process_scenes"],Ub:!0,Vb:500,mc:!1,Yb:t},update_scenes_nla:{Eb:aa.Gd,Mb:!1,H:["process_scenes","load_textures"],Ub:!1,Vb:50,mc:!1,Yb:M},wait_physics_workers:{Eb:aa.Gd,Mb:!1,H:["load_shoremap"],Ub:!1,Vb:20,mc:!1,hi:K},add_physics_objects:{Eb:aa.Gd,Mb:!1,H:["wait_physics_workers"],
Ub:!1,Vb:50,mc:!1,Yb:X},add_objects:{Eb:aa.Gd,Mb:!1,H:["add_physics_objects"],Ub:!1,Vb:600,mc:!1,Yb:P,hi:da,tn:U,un:{ot:[],ZA:0}},init_logic_nodes:{Eb:aa.Gd,Mb:!1,H:["update_scenes_nla","add_objects"],Ub:!1,Vb:50,mc:!1,Yb:ga},load_speakers:{Eb:aa.tj,Mb:!0,H:["add_objects"],Ub:!0,Vb:100,mc:!1,Yb:v},mobile_media_start:{Eb:aa.Gd,Mb:!1,H:["load_textures","update_scenes_nla","load_speakers","init_logic_nodes"],Ub:!0,Vb:5,mc:!1,Yb:la,hi:la},synchronize_media:{Eb:aa.Gd,Mb:!0,H:["mobile_media_start"],Ub:!0,
Vb:50,mc:!1,Yb:T},start_nla:{Eb:aa.Gd,Mb:!0,H:["mobile_media_start"],Ub:!1,Vb:5,mc:!0,Yb:W}},l=aa.Uz();l||(l=aa.vH(),Ra={},za={},bb={});Ra[l.Tg.length]={};return aa.$H(k,a,c,d,e,f||R.Yx,ba.do_not_load_resources,g)};a.unload=function(a){var b=aa.Uz();if(!b||!b.Tg.length||a&&!aa.DN(b.Tg[a]))ya.error("Unable to unload data!");else{if(0==a)ya.log("%cUNLOAD ALL","color: #00a"),ja.cleanup(),oa.cleanup(),Ja.cleanup(),ca.cleanup(),ea.cleanup(),Fa.cleanup(),aa.cleanup(),I.cleanup(),Ca.cleanup(),ia.cleanup(),
xa.cleanup(),Ma.cleanup(),Ea.cleanup(),Ka.cleanup(),qa.cleanup(),ha.cleanup(),Ba.cleanup(),pa.cleanup(),fa.cleanup(),J.cleanup(),Aa.cleanup(),za=null,bb={},Ra=La=null,Ya=!1;else{ya.log("%cUNLOAD DATA "+a,"color: #00a");oa.ML(a);for(var b=ia.get_all_objects(ia.DATA_ID_ALL),c=0;c<b.length;c++){var d=b[c];na.get_object_data_id(d)!=a&&ia.Jr(d,!1,!1,!1,!1)}b=ia.get_all_objects(a);for(c=b.length-1;0<=c;c--)d=b[c],ma(d),ia.remove_object(d);b=ia.get_all_objects(ia.DATA_ID_ALL);for(c=0;c<b.length;c++)ia.Jr(b[c],
!0,!0,!0,!0)}Q()}};a.GL=ma;a.set_debug_resources_root=function(a){Da=a};a.activate_media=function(){Ya||ba.media_auto_activation||(Ba.play(),Ba.pause(),Ba.reset(),S(La,ia.DATA_ID_ALL,!0),Ja.pause(),ba.Su&&Ja.lB(),Ya=!0)};a.reset=function(){Na=null}};b4w.module.__batch=function(a,p){function e(a){a={type:a,rb:"",id:0,Uo:0,Jj:-1,Ki:"",sq:-1,ul:-1,Mn:0,Ie:0,Sj:[],T:[],Uc:[],lc:[],Oj:[],Th:null,zc:{},La:null,Va:{oj:null,zg:null,nh:[],Ah:[],status:qa.kt},Ji:"",jn:[],aa:null,Vd:ca.pi(),Ud:!1,lh:!1,tq:!1,num_vertices:0,num_triangles:0,lr:0,mr:0,Nq:0,lo:0,yd:new Float32Array(3),Jd:new Float32Array(16),Ff:!1,kb:!1,Qt:!1,Ea:!1,jg:!1,wb:!1,Td:!1,he:!1,nd:!1,gd:!1,Tc:!1,Rc:!1,Hc:!1,ed:!1,kc:!1,Wr:!1,Mf:Z.Vm,bf:!1,sn:!1,of:!1,Rv:"",SB:"",Tq:!1,Xq:0,Uq:0,
Yq:0,Zq:0,Wq:new Float32Array(3),Vq:new Float32Array(3),mo:!1,Gf:0,Nf:0,vg:1,reflect_factor:0,Lh:0,ep:1,parallax_scale:0,ug:0,mg:1,Hr:0,Ao:0,Se:0,as:0,Kd:Array(2),Dd:new Float32Array(3),Rg:new Float32Array(3),Cf:new Float32Array(3),Zc:new Float32Array(4),Me:new Float32Array(4),Ci:null,Rl:null,xo:null,wo:null,yo:null,vi:!1,wireframe_edge_color:pa.create(),Wg:!1,water_dynamic:!1,Pm:!1,Ns:!1,Os:0,Ps:0,Ms:0,rj:.1,shallow_water_col_fac:0,shore_water_col_fac:0,foam_factor:0,Hq:new Float32Array(2),Gq:new Float32Array(2),
$n:new Float32Array(2),shallow_water_col:new Float32Array(3),shore_water_col:new Float32Array(3),Ch:null,Xi:!1,Ia:null,Ul:0,xj:null,Si:!1,Io:null,Bh:null,Wf:null,SA:null,Nd:null,Vf:null,TA:null,U:null,Ca:null,K:null,Z:null,ld:!0,lm:0};a.Zc[3]=1;a.Qt=!0;a.Ea=!0;a.Ul=1;return a}function c(a){var b=e(a.type);b.rb=a.rb;b.id=a.id;b.Uo=a.Uo;b.Jj=a.Jj;b.Ki=a.Ki;b.sq=a.sq;b.ul=a.ul;b.Mn=a.Mn;b.Ie=a.Ie;b.Sj=[];b.T=a.T.slice();b.Uc=a.Uc.slice();b.lc=a.lc.slice();b.Oj=a.Oj.slice();b.Th=ca.I(a.Th);b.zc=ca.I(a.zc);
b.La=a.La;b.Va=ca.I(a.Va);b.Ji=a.Ji;b.jn=Ia.RG(a.jn);b.aa=a.aa;b.Ud=a.Ud;b.lh=a.lh;b.tq=a.tq;b.num_vertices=a.num_vertices;b.num_triangles=a.num_triangles;b.lr=a.lr;b.mr=a.mr;b.Nq=a.Nq;b.lo=a.lo;b.yd=a.yd;b.Jd=a.Jd;b.Ff=a.Ff;b.kb=a.kb;b.Qt=a.Qt;b.Ea=a.Ea;b.jg=a.jg;b.wb=a.wb;b.Td=a.Td;b.he=a.he;b.nd=a.nd;b.gd=a.gd;b.Tc=a.Tc;b.Rc=a.Rc;b.Hc=a.Hc;b.ed=a.ed;b.kc=a.kc;b.Wr=a.Wr;b.Mf=a.Mf;b.bf=a.bf;b.sn=a.sn;b.of=a.of;b.Rv=a.Rv;b.SB=a.SB;b.Tq=a.Tq;b.Xq=a.Xq;b.Uq=a.Uq;b.Yq=a.Yq;b.Zq=a.Zq;pa.copy(a.Wq,b.Wq);
pa.copy(a.Vq,b.Vq);b.mo=a.mo;b.Gf=a.Gf;b.Nf=a.Nf;b.vg=a.vg;b.reflect_factor=a.reflect_factor;b.Lh=a.Lh;b.ep=a.ep;b.parallax_scale=a.parallax_scale;b.ug=a.ug;b.mg=a.mg;b.Hr=a.Hr;b.Ao=a.Ao;b.Se=a.Se;b.as=a.as;b.Kd=a.Kd.slice();pa.copy(a.Dd,b.Dd);pa.copy(a.Rg,b.Rg);pa.copy(a.Cf,b.Cf);fa.copy(a.Zc,b.Zc);fa.copy(a.Me,b.Me);b.Ci=ca.I(a.Ci);a.Rl&&(b.Rl=new Float32Array(a.Rl),b.xo=new Float32Array(a.xo),b.wo=new Float32Array(a.wo),b.yo=new Float32Array(a.yo));b.vi=a.vi;pa.copy(a.wireframe_edge_color,b.wireframe_edge_color);
b.Wg=a.Wg;b.water_dynamic=a.water_dynamic;b.Pm=a.Pm;b.Ns=a.Ns;b.Os=a.Os;b.Ps=a.Ps;b.Ms=a.Ms;b.rj=a.rj;b.shallow_water_col_fac=a.shallow_water_col_fac;b.shore_water_col_fac=a.shore_water_col_fac;b.foam_factor=a.foam_factor;b.Hq.set(a.Hq);b.Gq.set(a.Gq);b.$n.set(a.$n);pa.copy(a.shallow_water_col,b.shallow_water_col);pa.copy(a.shore_water_col,b.shore_water_col);b.Ch=ca.I(a.Ch);b.Xi=a.Xi;b.Ia=ca.I(a.Ia);b.Ul=a.Ul;a.xj&&(b.xj=new Float32Array(a.xj));b.Si=a.Si;b.Io=ca.I(a.Io);b.Bh=ca.I(a.Bh);b.Wf=ca.I(a.Wf);
b.SA=ca.I(a.SA);b.Nd=ca.I(a.Nd);b.Vf=ca.I(a.Vf);b.TA=ca.I(a.TA);b.U=T.ii(a.U);b.Ca=T.ji(a.Ca);b.K=T.ii(a.K);b.Z=T.ji(a.Z);b.ld=a.ld;b.lm=a.lm;return b}function b(a){switch(a.type){case "MAIN":case "PARTICLES":case "LINE":a.rb=a.kb?a.jg?"XRAY":"BLEND":"OPAQUE";break;case "SHADOW":a.rb=a.gd?"CAST":"RECEIVE";break;case "COLOR_ID":a.rb=a.jg?"COLOR_ID_XRAY":"COLOR_ID"}}function n(a,b){for(var c=[],d=0;d<a.length;d++){var e=a[d],f=e.xa.k,h=T.Wc();T.oi(f.di,h);var k=e.data.b4w_bounding_cylinder_radius,l=
e.data.b4w_bounding_sphere_radius,m=e.data.b4w_bounding_sphere_center,n=e.data.b4w_bounding_ellipsoid_axes,q=e.data.b4w_bounding_ellipsoid_center;if(f.Fe){var k=Math.max(Math.abs(h.max_x),Math.abs(h.min_x)),l=Math.max(Math.abs(h.max_y),Math.abs(h.min_y)),t=Math.max(Math.abs(h.max_z),Math.abs(h.min_z)),t=Math.sqrt(k*k+l*l+t*t),k=Math.sqrt(k*k+l*l);h.max_x=h.max_y=h.max_z=t;h.min_x=h.min_y=h.min_z=-t;l=t;m[0]=m[1]=m[2]=0;n[0]=n[1]=n[2]=t;q[0]=q[1]=q[2]=0}f.U=h;t=T.fh(h,f.m);f.K=t;g(f,k,k,h);h=T.cq(l,
ca.f32(m));f.jf=h;T.At(h,f.m,f.Dc);n=T.nn([n[0],0,0],[0,n[1],0],[0,0,n[2]],q);f.Ca=n;n=T.pl(n,f.m);f.Z=n;c=c.concat(r(e,f,b))}return c}function h(a,b){for(var c=[],d=[],e={},f=0;f<a.length;f++){var g=a[f],h=g.xa.k,k=T.Wc();T.oi(h.di,k);var l=T.fh(k,h.m),m=T.cq(g.data.b4w_bounding_sphere_radius,ca.f32(g.data.b4w_bounding_sphere_center));T.At(m,h.m,h.Dc);var n=g.data.b4w_bounding_ellipsoid_axes,n=T.nn([n[0],0,0],[0,n[1],0],[0,0,n[2]],g.data.b4w_bounding_ellipsoid_center),q=T.pl(n,h.m);h.U=k;h.K=l;h.jf=
m;h.Ca=n;h.Z=q;k={};k.nd=h.nd;k.gd=h.gd;k.Tc=h.Tc;k.Ng=h.Ng;k.fm=h.fm;k.fc=h.fc;k.em=h.em;k.xf=h.xf;k.Rc=h.Rc;k.Hc=h.Hc;k.ed=h.ed;k.fe=h.fe;k.Pd=h.Pd;k.zf=h.zf;k.If=h.If;k.Fd=h.Fd;k.Sf=h.Sf;k.Yc=h.Yc;k.Fe=h.Fe;k.Dj=h.Dj;k.Cj=h.Cj;k.kc=h.kc;k.oh=h.oh;k.wl=h.wl;k.he=h.he;k.Jj=g.b4w_cluster_data.cluster_id;k.Gg=h.Gg;k.xk=h.xk;k.Di=h.Di;k.qi=h.qi;h=JSON.stringify(k);e[h]=e[h]||[];e[h].push(g)}for(var v in e){k=JSON.parse(v);delete k.Jj;var g=e[v],h=oa.rl("STATIC"),u;for(u in k)h[u]=k[u];h.ud=a[0].xa.k.ud;
h.Ef=0;h.ig=0;h.Lf=0;h.Kf=0;h.Hf=0;h.hide=!1;for(f=0;f<g.length;f++){var w=g[f].xa;0==f?(T.oi(w.k.K,h.K),T.lq(w.k.Dc,h.Dc)):(T.Yn(h.K,w.k.K),T.GI(h.Dc,w.k.Dc))}h.Z=T.kf();h.Ca=T.kf();T.oi(w.k.K,h.U);T.lq(w.k.Dc,h.jf);d.push({k:h,eG:g})}for(e=0;e<d.length;e++)for(f=d[e].k,v=d[e].eG,u=0;u<v.length;u++){w=v[u];g=w.xa.k;h=r(w,f,b);k=V.create();g.Fe&&!g.on?(l=V.get_trans_view(g.m),V.set_trans(l,k)):V.copy(g.m,k);l={};if(f.Fd||f.Fe)l.au_center_pos=[k[0],k[1],k[2]];f.Fd&&(l.au_wind_bending_amp=[g.Ef],l.au_wind_bending_freq=
[w.b4w_wind_bending_freq],l.au_detail_bending_amp=[w.b4w_detail_bending_amp],l.au_detail_bending_freq=[w.b4w_detail_bending_freq],l.au_branch_bending_amp=[w.b4w_branch_bending_amp]);for(m=0;m<h.length;m++){var J=h[m].k,n=h[m].Xe,q=h[m].Y;J.Ll?n.Dg||(J.Fe?Z.vN(n,k):Z.zw(n,k)):("COLOR_ID"==q.type&&(h[m].k=g,q.Ki=w.uuid,t(q,g),J=K(g),F(q,J)),n=Z.zw(n,k),Z.uN(n,l))}c=c.concat(h)}return c}function r(a,b,c){var d=[],f=m(c,b,!b.qi,!1),g=K(b),h=a.data,k=h.materials,l=Array(k.length),n=Array(k.length),r=Aa.$b(c,
J.pb),u=!1;r&&(u=r.pr.length?!0:!1);for(var w=0;w<f.length;w++)for(var p=f[w],B=0;B<k.length;B++){var x=k[B];if((!x.b4w_lens_flares||u)&&!Z.cA(h,B)){var L=e(p);"COLOR_ID"==p&&(L.sn=!(a.b4w_do_not_render||x.b4w_do_not_render));"MAIN"==p?l[B]=L:"DEBUG_VIEW"==p&&(n[B]=L);L.Jj=a.b4w_cluster_data.cluster_id;if(W(L,x)){"SHADOW"==p&&l[B]&&(L.Td=l[B].Td);L.Mf=b.Ud||b.he?Z.Bp:Z.Vm;t(L,b);for(var y=L,D=a.particle_systems,A=0;A<D.length;A++){var aa=D[A].settings.b4w_vcol_from_name,E=D[A].settings.b4w_vcol_to_name;
""!==aa&&""!==E&&(y.zc[aa]={fk:!1,src:[{name:aa,tf:7}]})}"DYNAMIC"==b.type&&(L.Ki=a.uuid);F(L,g);var G=Z.mz(h,B,L.Oj,b.gi,L.zc,L.Th);!x.use_tangent_shading||"a_shade_tangs"in G.O[0]||(z(L,"CALC_TBN",1),v(L,"a_normal"));var H=G.Rd;H.K=T.fh(H.U,a.xa.k.m);H.Z=T.pl(H.Ca,a.xa.k.m);x.b4w_lens_flares&&(G=ha.FL(G));d.push({Y:L,Xe:G,ne:[x.name],k:b,Ue:[a]})}}}for(w=0;w<n.length;w++)n[w]&&(n[w].ul=l[w].id,F(n[w],n[w].Uo));var P=a.particle_systems;if(0<P.length&&d.length){for(var M=!1,na=!1,w=0;w<P.length;w++){var Ba=
P[w],ka=Ba.settings;ka.use_render_emitter&&(M=!0);"HAIR"!=ka.type||"OBJECT"!=ka.render_type&&"GROUP"!=ka.render_type&&Ba.transforms.length||(na=!0);if(M&&na)break}var ya=d[0].Y.zc,N;if(na){var X;if(1<k.length){for(var U=a.xa.k,da={},S=0;S<P.length;S++){var Oa=P[S].settings;if("HAIR"==Oa.type&&("OBJECT"==Oa.render_type||"GROUP"==Oa.render_type)){var Ca=Oa.b4w_vcol_from_name,fa=Oa.b4w_vcol_to_name;""!==Ca&&""!==fa&&(da[Ca]=ca.I(ya[Ca]))}}"a_bending_col_main"in ya&&(da.a_bending_col_main=ca.I(ya.a_bending_col_main));
"a_bending_col_detail"in ya&&(da.a_bending_col_detail=ca.I(ya.a_bending_col_detail));X=Z.nz(h,[],da,U)}else X=d[0].Xe;N=X}else N=null;for(var Ia,va=N,Q=a.xa,ma=[],Ma=a.particle_systems,ga=a.data,Fa=0;Fa<Ma.length;Fa++){var ja=Ma[Fa],ra=ja.settings;if(ra.count)if("EMITTER"==ra.type){if("DYNAMIC"==b.type){var ia=e("PARTICLES");ia.U=b.U;ia.Ca=b.Ca;ia.K=b.K;ia.Z=b.Z;var la,Ja=ga.materials,ea=ja.settings.material-1;ea>=Ja.length&&(O.warn('Wrong material used for rendering particle system "'+ja.name+'"'),
ea=0);la=Ja[ea];"HALO"===ja.settings.render_type&&"HALO"===la.type&&(ia.mo=!0);q(ia,la);var Ka=ia,Dc=a,hc=ja.settings;switch(hc.b4w_billboard_align){case "VIEW":z(Ka,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW");break;case "XY":z(Ka,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_XY");break;case "YZ":z(Ka,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_YZ");break;case "ZX":z(Ka,"BILLBOARD_ALIGN","BILLBOARD_ALIGN_ZX");break;default:ca.q("Wrong billboard align value")}z(Ka,"BILLBOARD",0);var Zc=hc.b4w_enable_soft_particles&&oa.Ay(Dc,
hc);z(Ka,"SOFT_PARTICLES",0<hc.b4w_particles_softness&&Zc&&Ea.xq?1:0);z(Ka,"SOFT_STRENGTH",qa.D(hc.b4w_particles_softness));qa.ba(Ka.Va,"WORLD_SPACE","WORLD"==hc.b4w_coordinate_system?1:0);ia.he=!0;ia.Ki=Q.name+"_"+ra.uuid;ia.Rv=ja.name;F(ia,g);ha.eK(ia,ja,la);var $c=ha.hJ(ia,ga,ja,Q.k);ha.jO($c,ia,ra.count);ha.iO(Q);t(ia,Q.k);ma.push({Y:ia,Xe:$c,ne:[la.name],k:b,Ue:[a]})}}else if("HAIR"==ra.type){var Sb=ca.cr(ja.seed);ra.b4w_dynamic_grass&&(b.oh=!0);var Ec=I.By(Ea.fv)&&!ra.b4w_initial_rand_rotation&&
!ra.b4w_hair_billboard,xb=4;Ec&&(xb=8);if(ja.transforms.length)var pb=ja.transforms;else for(var bc=Z.zu(va,ra.count,!1,Sb),pb=new Float32Array(bc.length*xb),Sa=0;Sa<bc.length;Sa++){var Zb=.75+.5*ca.yf(Sb);pb[Sa*xb]=bc[Sa][0];pb[Sa*xb+1]=bc[Sa][1];pb[Sa*xb+2]=bc[Sa][2];pb[Sa*xb+3]=Zb;Ec&&(pb[Sa*xb+4]=1,pb[Sa*xb+5]=0,pb[Sa*xb+6]=0,pb[Sa*xb+7]=0)}var Tc=Aa.$b(c,J.$g)?!0:!1;if("OBJECT"==ra.render_type)var Db=[m(c,ra.dupli_object.xa.k,!b.qi,!0)],Qb=C(a,b,ya,va,[ra.dupli_object],Db,[pb],ra,ja,Tc,Sb,!1),
ma=ma.concat(Qb);else if("GROUP"==ra.render_type){for(var Jb=ra.dupli_group.objects,Db=[],Sa=0;Sa<Jb.length;Sa++){var ic=m(c,Jb[Sa].xa.k,!b.qi,!0);Db.push(ic)}for(var eb=!1,jc=[],Sa=0;Sa<Jb.length;Sa++)jc.push(Jb[Sa].xa);if(ra.use_whole_group){for(var Fc,Kb=pb,Tb=jc,pc=Ec,Uc=xb,Eb={},Ub=new Float32Array([0,0,0,1]),fb=0;fb<Kb.length;fb+=Uc)for(var Pa=0;Pa<Tb.length;Pa++){var yb=pa.create(),Lb=V.get_scale(Tb[Pa].k.m),Vb=V.get_trans_view(Tb[Pa].k.m);pa.scale(Vb,Lb,yb);var Fb=pa.clone([Kb[fb],Kb[fb+1],
Kb[fb+2]]);Eb[Pa]||(Eb[Pa]=new Float32Array(Kb.length));pc&&(Eb[Pa][fb+4]=Ub[0]=Kb[fb+4],Eb[Pa][fb+5]=Ub[1]=Kb[fb+5],Eb[Pa][fb+6]=Ub[2]=Kb[fb+6],Eb[Pa][fb+7]=Ub[3]=Kb[fb+7],ca.Sv(Ub,Ub),ca.IN(yb,Ub,yb));pa.add(Fb,yb,Fb);Eb[Pa][fb]=Fb[0];Eb[Pa][fb+1]=Fb[1];Eb[Pa][fb+2]=Fb[2];Eb[Pa][fb+3]=Kb[fb+3]}Fc=Eb;eb=!0}else{var Wb;if(ra.use_group_count){for(var Mb=pb,Gc=jc,Xb=ra.dupli_weights,wc=Sb,zb=Ec,Hc=xb,lb={},Va=[],cb=0;cb<Gc.length;cb++)for(var qc=Gc[cb],xc=qc.Ak||qc.name,mb=0;mb<Xb.length;mb++){var sb=
Xb[mb];xc==sb.name&&Va.push(sb)}Xb.length!=Va.length&&O.error("dupli weights match failed");for(cb=0;cb<Mb.length;cb+=Hc){for(var Ab,Ga=Va,nb=[0],db=0;db<Ga.length;db++)nb[db+1]=nb[db]+Ga[db].count;for(var cc=nb[nb.length-1]*ca.yf(wc),Ha=0,db=0;db<nb.length;db++)if(cc>=nb[db]&&cc<nb[db+1]){Ha=db;break}Ab=Ha;lb[Ab]=lb[Ab]||[];lb[Ab].push(Mb[cb],Mb[cb+1],Mb[cb+2],Mb[cb+3]);zb&&lb[Ab].push(Mb[cb+4],Mb[cb+5],Mb[cb+6],Mb[cb+7])}for(Ab in lb)lb[Ab]=new Float32Array(lb[Ab]);Wb=lb}else{for(var gb=pb,$a=Sb,
Nb=Ec,ib=xb,Wa=jc.length,tb={},ob=0;ob<gb.length;ob+=ib){var hb=Math.floor(Wa*ca.yf($a));tb[hb]=tb[hb]||[];tb[hb].push(gb[ob],gb[ob+1],gb[ob+2],gb[ob+3]);Nb&&tb[hb].push(gb[ob+4],gb[ob+5],gb[ob+6],gb[ob+7])}for(hb in tb)tb[hb]=new Float32Array(tb[hb]);Wb=tb}Fc=Wb}Qb=C(a,b,ya,va,Jb,Db,Fc,ra,ja,Tc,Sb,eb);ma=ma.concat(Qb)}"INSTANCE"==ra.b4w_wind_bend_inheritance&&Q.k.Fd&&O.warn('Emitter object "'+Q.name+"\" has a particle system with wind bending inheritance from the particle instance. Wind bending on the emitter isn't disabled. Expect unforeseen behavior.")}else ca.q("Unknown particle settings type")}Ia=
ma;d=M?d.concat(Ia):Ia}return d}function g(a,b,c,d){a.mn=T.cy(b,d);a.kn=T.ay(c,d);a.ln=T.by(b,d)}function m(a,b,c,d){var e=[];d||(b.Ng&&Aa.$b(a,J.Xd)||b.fc&&Aa.$b(a,J.kg))&&e.push("COLOR_ID");c&&(e.push("MAIN"),e.push("NODES_GLOW"),Aa.$b(a,J.ze)&&e.push("DEBUG_VIEW"),Aa.$b(a,J.Be)&&e.push("SHADOW"),Aa.$b(a,J.$g)&&e.push("GRASS_MAP"));e.push("PHYSICS");if(b.gd||b.Hc)for(a=null,b.gd&&(a=["MAIN","NODES_GLOW","COLOR_ID","PHYSICS","DEBUG_VIEW"]),b.Hc&&(b=["COLOR_ID","PHYSICS","SHADOW","DEBUG_VIEW"],a=
null!==a?ca.KF(a,b):b),b=a,a=0;a<b.length;a++)c=e.indexOf(b[a]),-1!==c&&e.splice(c,1);return e}function q(a,b){var c;switch(a.type){case "MAIN":if(b.b4w_do_not_render)c=!1;else{if(b.use_nodes&&"HALO"!=b.type)E(a,b,"MAIN");else{l(a,b);c=b.game_settings.alpha_blend;a.jg=b.b4w_render_above_all&&"OPAQUE"!=c&&"CLIP"!=c;a.Se=b.offset_z;a.Rg.set([1,1,1]);var e=b.texture_slots;fa.set(b.diffuse_color[0],b.diffuse_color[1],b.diffuse_color[2],b.alpha,a.Zc);if(b.b4w_lens_flares){N(a,"special_lens_flares.glslv",
"special_lens_flares.glslf");v(a,"a_position");v(a,"a_texcoord");var g=aa.Pc(e[0],null);L(a,g)}else{N(a,"main.glslv","main_stack.glslf");b.use_shadeless||(c=ja.Xt(b.uuid,b.name,{Td:b.use_shadeless,Pn:b.diffuse_shader,rm:b.specular_shader,Uk:b.use_tangent_shading}),a.Va.Ah=ja.jq(c));var h=f("use_map_color_diffuse",e),m=f("use_map_color_spec",e),n=f("use_map_normal",e),q=f("use_map_mirror",e),t=f("use_stencil",e);c=h[0];m=m[0];n=n[0];q=q[0];h=h[1];e=t[0]&&f("use_rgb_to_intensity",e)[0];if(c){switch(c.blend_type){case "MIX":z(a,
"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":z(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}g=aa.Pc(c,null);L(a,g,"u_colormap0");a.ug=c.diffuse_color_factor;a.mg=c.use_map_alpha?c.alpha_factor:0;a.Rg.set(c.scale)}t=c&&c==m;m&&(t||(g=aa.Pc(m,null),L(a,g,"u_specmap0")),a.Lh=m.specular_color_factor);if(n&&(v(a,"a_normal"),v(a,"a_tangent"),a.Si=!0,g=aa.Pc(n,null),L(a,g,"u_normalmap0"),a.Hr=n.normal_factor,g=n.texture,g.b4w_use_map_parallax&&Ea.Nr)){var r=qa.D(g.b4w_parallax_steps),
u=qa.D(g.b4w_parallax_lod_dist);z(a,"PARALLAX",1);z(a,"PARALLAX_STEPS",r);z(a,"PARALLAX_LOD_DIST",u);a.parallax_scale=g.b4w_parallax_scale}q&&(g=aa.Pc(q,null),L(a,g,"u_mirrormap"),a.Ao=q.mirror_factor);if(q=c&&h&&e?1:0)g=aa.Pc(h,null),L(a,g,"u_colormap1"),g=aa.Pc(e,null),L(a,g,"u_stencil0");(g=c||m||n)&&a.Rg.set(g.scale);z(a,"TEXTURE_SPEC",void 0==m?0:1);z(a,"ALPHA_AS_SPEC",t?1:0);z(a,"TEXTURE_STENCIL_ALPHA_MASK",q);v(a,"a_position");v(a,"a_normal");(c||m||n)&&v(a,"a_texcoord");if(b.b4w_water){a.Wg=
!0;a.water_dynamic=b.b4w_water_dynamic;b.b4w_water_shore_smoothing&&!a.kb?(O.warn('Material: "'+b.name+'" is opaque.',"Disabling shore smoothing."),a.Pm=!1):a.Pm=b.b4w_water_shore_smoothing;N(a,"special_water.glslv","special_water.glslf");q=ja.Xt(b.uuid,b.name,{Td:!1,Pn:b.diffuse_shader,rm:b.specular_shader,Uk:b.use_tangent_shading});a.Va.Ah=ja.jq(q);v(a,"a_position");Ea.eD?(v(a,"a_polyindex"),a.Ea=!0,pa.set(0,0,0,a.wireframe_edge_color),Q.Vz()?z(a,"DEBUG_WIREFRAME",1):z(a,"DEBUG_WIREFRAME",2)):z(a,
"DEBUG_WIREFRAME",0);t=b.texture_slots;q=f("use_map_normal",t);g=f("use_map_mirror",t)[0];q.length&&(r=aa.Pc(q[0]),L(a,r,"u_normalmap0"),a.rj=b.b4w_water_norm_uv_velocity);z(a,"NUM_NORMALMAPS",q.length);a.Ch=Array(q.length);for(r=0;r<q.length;r++)a.Ch[r]=new Float32Array(2),a.Ch[r].set([q[r].scale[0],q[r].scale[1]]);g&&(r=aa.Pc(g),L(a,r,"u_mirrormap"),a.Ao=g.mirror_factor);g=null;if(Ea.Dl)for(r=0;r<t.length;r++){var J=t[r];if(!0===J.texture.b4w_water_foam){g=J;break}}g&&(z(a,"FOAM",1),r=aa.Pc(g),
L(a,r,"u_foam"),a.foam_factor=b.b4w_foam_factor,a.Hq.set(g.texture.b4w_foam_uv_freq),a.Gq.set(g.texture.b4w_foam_uv_magnitude),a.$n[0]=g.scale[0],a.$n[1]=g.scale[1]);for(r=0;r<t.length;r++)if(J=t[r],!0===J.texture.b4w_shore_dist_map){var p=J;break}p&&Ea.Tp&&(p=aa.Pc(p),L(a,p,"u_shore_dist_map"),z(a,"SHORE_PARAMS",1),p=J.texture.b4w_shore_boundings,z(a,"MAX_SHORE_DIST",qa.D(J.texture.b4w_max_shore_dist)),z(a,"SHORE_MAP_SIZE_X",qa.D(p[0]-p[1])),z(a,"SHORE_MAP_SIZE_Y",qa.D(p[2]-p[3])),z(a,"SHORE_MAP_CENTER_X",
qa.D((p[0]+p[1])/2)),z(a,"SHORE_MAP_CENTER_Y",qa.D((p[2]+p[3])/2)));if(b.b4w_generated_mesh)z(a,"GENERATED_MESH",1),a.Ns=!0,a.Os=b.b4w_water_num_cascads,a.Ps=b.b4w_water_subdivs,a.Ms=b.b4w_water_detailed_dist;else{v(a,"a_normal");if(g||q.length)v(a,"a_texcoord"),v(a,"a_tangent"),a.Si=!0;z(a,"GENERATED_MESH",0)}if(b.b4w_water_dynamic){var J=qa.D(b.b4w_water_dst_noise_scale0),p=qa.D(b.b4w_water_dst_noise_scale1),q=qa.D(b.b4w_water_dst_noise_freq0),t=qa.D(b.b4w_water_dst_noise_freq1),g=qa.D(b.b4w_water_dir_min_shore_fac),
r=qa.D(b.b4w_water_dir_freq),u=qa.D(b.b4w_water_dir_noise_scale),x=qa.D(b.b4w_water_dir_noise_freq),y=qa.D(b.b4w_water_dir_min_noise_fac),C=qa.D(b.b4w_water_dst_min_fac),A=qa.D(b.b4w_water_waves_hor_fac);z(a,"DST_NOISE_SCALE_0",J);z(a,"DST_NOISE_SCALE_1",p);z(a,"DST_NOISE_FREQ_0",q);z(a,"DST_NOISE_FREQ_1",t);z(a,"DIR_MIN_SHR_FAC",g);z(a,"DIR_FREQ",r);z(a,"DIR_NOISE_SCALE",u);z(a,"DIR_NOISE_FREQ",x);z(a,"DIR_MIN_NOISE_FAC",y);z(a,"DST_MIN_FAC",C);z(a,"WAVES_HOR_FAC",A)}D(a,b);w(a,b);a.shallow_water_col.set(b.b4w_shallow_water_col);
a.shore_water_col.set(b.b4w_shore_water_col);a.shallow_water_col_fac=b.b4w_shallow_water_col_fac;a.shore_water_col_fac=b.b4w_shore_water_col_fac;z(a,"ABSORB",qa.D(b.b4w_water_absorb_factor));z(a,"SSS_STRENGTH",qa.D(b.b4w_water_sss_strength));z(a,"SSS_WIDTH",qa.D(b.b4w_water_sss_width))}"HALO"===b.type&&(N(a,"halo.glslv","halo.glslf"),B(a,b),a.Oj=["a_position"]);b.use_tangent_shading&&"MAIN"==a.type&&(z(a,"USE_TBN_SHADING",1),v(a,"a_shade_tangs"));z(a,"TEXCOORD",0);z(a,"NORMAL_TEXCOORD",0);c&&d(a,
c,"TEXTURE_COLOR0_CO");h&&d(a,h,"TEXTURE_COLOR1_CO");e&&d(a,e,"TEXTURE_STENCIL_ALPHA_MASK_CO");m&&d(a,m,"TEXTURE_SPEC_CO");n&&d(a,n,"TEXTURE_NORM_CO");z(a,"SHADELESS",b.use_shadeless?1:0);a.Td=b.use_shadeless}c=b.game_settings.alpha_blend;z(a,"ALPHA","OPAQUE"===c?0:1);z(a,"ALPHA_CLIP","CLIP"===c?1:0);z(a,"DOUBLE_SIDED_LIGHTING",b.b4w_double_sided_lighting?1:0);b.use_vertex_color_paint?(z(a,"VERTEX_COLOR",1),v(a,"a_color")):z(a,"VERTEX_COLOR",0);a.Gf=b.ambient;a.vg=b.diffuse_intensity;a.Nf=b.emit;
a.Cf.set(b.specular_color);a.ep=b.specular_alpha;D(a,b);w(a,b);b.b4w_wettable?z(a,"WETTABLE",1):z(a,"WETTABLE",0);H(a,b);b.b4w_refractive&&!a.kb?(O.warn('Material "'+b.name+'" is not blend. Disabling refractions.'),a.Xi=!1):a.Xi=b.b4w_refractive;a.as=b.b4w_refr_bump}c=!0}break;case "NODES_GLOW":c=E(a,b,"GLOW");break;case "SHADOW":if(b.b4w_lens_flares||b.b4w_water||b.b4w_do_not_render||"HALO"===b.type)c=!1;else if(l(a,b),a.kb)c=!1;else{m=b.game_settings.alpha_blend;b.use_nodes&&"CLIP"==m?E(a,b,"SHADOW"):
(N(a,"shadow.glslv","shadow.glslf"),fa.set(b.diffuse_color[0],b.diffuse_color[1],b.diffuse_color[2],b.alpha,a.Zc));v(a,"a_position");v(a,"a_normal");z(a,"ALPHA","OPAQUE"===m?0:1);a.Rg.set([1,1,1]);if((c=f("use_map_color_diffuse",b.texture_slots)[0])&&"CLIP"===m){switch(c.blend_type){case "MIX":z(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":z(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}a.Rg.set(c.scale);z(a,"TEXTURE_COLOR",1);v(a,"a_texcoord");if("IMAGE"==c.texture.p.source||
"ENVIRONMENT_MAP"==c.texture.p.source||"CANVAS"==c.texture.p.source)m=aa.Pc(c),L(a,m,"u_colormap0");"NONE"==c.texture.p.source&&(m=aa.Pc(c),L(a,m,"u_colormap0"))}else z(a,"TEXTURE_COLOR",0);c=!0}break;case "PHYSICS":b.b4w_collision?(a.rp=b.b4w_use_ghost,a.xb=b.b4w_collision_id,a.Dn=b.b4w_collision_margin,a.Bn=b.b4w_collision_group,a.En=b.b4w_collision_mask,a.ck=b.physics.friction,a.Wj=b.physics.elasticity,c=!0):b.b4w_water?(a.Wg=!0,a.TO=b.b4w_water_dynamic,a.dst_noise_scale0=b.b4w_water_dst_noise_scale0,
a.dst_noise_scale1=b.b4w_water_dst_noise_scale1,a.dst_noise_freq0=b.b4w_water_dst_noise_freq0,a.dst_noise_freq1=b.b4w_water_dst_noise_freq1,a.dir_min_shore_fac=b.b4w_water_dir_min_shore_fac,a.dir_freq=b.b4w_water_dir_freq,a.dir_noise_scale=b.b4w_water_dir_noise_scale,a.dir_noise_freq=b.b4w_water_dir_noise_freq,a.dir_min_noise_fac=b.b4w_water_dir_min_noise_fac,a.dst_min_fac=b.b4w_water_dst_min_fac,a.waves_hor_fac=b.b4w_water_waves_hor_fac,c=!0):c=!1;break;case "COLOR_ID":if(b.b4w_lens_flares||"HALO"===
b.type)c=!1;else{l(a,b);a.bf=!1;a.Ea=!0;a.kb=!1;m=b.game_settings.alpha_blend;a.jg=b.b4w_render_above_all&&"OPAQUE"!=m&&"CLIP"!=m;b.use_nodes&&"CLIP"==m?E(a,b,"COLOR_ID"):(N(a,"color_id.glslv","color_id.glslf"),fa.set(b.diffuse_color[0],b.diffuse_color[1],b.diffuse_color[2],b.alpha,a.Zc));v(a,"a_position");z(a,"ALPHA","OPAQUE"===m?0:1);a.Rg.set([1,1,1]);c=f("use_map_color_diffuse",b.texture_slots)[0];m="CLIP"===m?1:0;z(a,"ALPHA_CLIP",m);if(c&&m){switch(c.blend_type){case "MIX":z(a,"TEXTURE_BLEND_TYPE",
"TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":z(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}a.Rg.set(c.scale);z(a,"TEXTURE_COLOR",1);v(a,"a_texcoord");if("IMAGE"==c.texture.p.source||"ENVIRONMENT_MAP"==c.texture.p.source)m=aa.Pc(c),L(a,m,"u_colormap0");"NONE"==c.texture.p.source&&(m=aa.Pc(c),L(a,m,"u_colormap0"))}else z(a,"TEXTURE_COLOR",0);c=!0}break;case "GRASS_MAP":!b.b4w_terrain||b.b4w_do_not_render?c=!1:(l(a,b),a.kb=!1,a.bf=!1,a.Ea=!0,N(a,"grass_map.glslv","grass_map.glslf"),v(a,
"a_position"),c=b.b4w_dynamic_grass_size?b.b4w_dynamic_grass_size:null,m=b.b4w_dynamic_grass_color?b.b4w_dynamic_grass_color:null,a.zc.a_grass_size={fk:!0,src:[]},c?(a.zc.a_grass_size.src.push({name:c,tf:4}),z(a,"DYNAMIC_GRASS_SIZE",1)):z(a,"DYNAMIC_GRASS_SIZE",0),a.zc.a_grass_color={fk:!0,src:[]},m?(a.zc.a_grass_color.src.push({name:m,tf:7}),z(a,"DYNAMIC_GRASS_COLOR",1)):z(a,"DYNAMIC_GRASS_COLOR",0),c=!0);break;case "DEBUG_VIEW":c=k(a,b);break;case "PARTICLES":a:if(b.b4w_do_not_render)c=!1;else{c=
b.texture_slots;if(a.mo)N(a,"particle_system.glslv","particle_system_stack.glslf"),z(a,"HALO_PARTICLES",1),B(a,b);else{m={Td:!1,Pn:b.diffuse_shader,rm:b.specular_shader,Uk:b.use_tangent_shading};if(b.use_nodes){N(a,"particle_system.glslv","particle_system.glslf");E(a,b,"PARTICLES");c=!0;break a}N(a,"particle_system.glslv","particle_system_stack.glslf");m=ja.Xt(b.uuid,b.name,m);a.Va.Ah=ja.jq(m);if(c=f("use_map_color_diffuse",c)[0]){z(a,"TEXTURE_COLOR",1);switch(c.blend_type){case "MIX":z(a,"TEXTURE_BLEND_TYPE",
"TEXTURE_BLEND_TYPE_MIX");break;case "MULTIPLY":z(a,"TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY")}a.ug=c.diffuse_color_factor;a.mg=c.use_map_alpha?c.alpha_factor:0;c=aa.Pc(c);L(a,c)}}fa.set(b.diffuse_color[0],b.diffuse_color[1],b.diffuse_color[2],b.alpha,a.Zc);a.Gf=b.ambient;a.vg=b.diffuse_intensity;a.Nf=b.emit;a.Cf.set(b.specular_color);a.ep=b.specular_alpha;v(a,"a_position");v(a,"a_normal");c=b.game_settings.alpha_blend;z(a,"ALPHA","OPAQUE"===c?0:1);z(a,"ALPHA_CLIP","CLIP"===c?1:0);z(a,"PARTICLES_SHADELESS",
b.use_shadeless?1:0);D(a,b);w(a,b);l(a,b);c=b.game_settings.alpha_blend;a.jg=b.b4w_render_above_all&&"OPAQUE"!=c&&"CLIP"!=c;a.Se=b.offset_z;c=!0}break;default:ca.q("Wrong batch type: "+a.type)}return c}function B(a,b){var c=b.halo;z(a,"NUM_RINGS",c.ring_count);z(a,"NUM_LINES",c.line_count);z(a,"NUM_STARS",c.star_tip_count);z(a,"SKY_STARS",b.b4w_halo_sky_stars?1:0);a.Xq=c.size;a.Uq=c.hardness/20;a.Wq.set(c.b4w_halo_rings_color);a.Vq.set(c.b4w_halo_lines_color);a.Yq=1/b.b4w_halo_stars_blend_height;
a.Zq=b.b4w_halo_stars_min_height;a.Tq=!0}function d(a,b,c){switch(b.texture_coords){case "UV":case "ORCO":z(a,c,"TEXTURE_COORDS_UV_ORCO");z(a,"TEXCOORD",1);break;case "NORMAL":z(a,c,"TEXTURE_COORDS_NORMAL");z(a,"NORMAL_TEXCOORD",1);break;default:z(a,c,0)}}function l(a,b){var c=b.game_settings,d=c.alpha_blend;switch(d){case "ALPHA_SORT":a.kb=!0;a.bf=!0;a.Ea=!0;a.Ff=!1;break;case "ALPHA":a.kb=!0;a.bf=!1;a.Ea=!0;a.Ff=!1;break;case "CLIP":a.kb=!1;a.bf=!1;a.Ea=!0;a.Ff=!0;break;case "ADD":a.kb=!0;a.bf=
!1;a.Ea=!1;a.Ff=!1;break;case "OPAQUE":a.kb=!1;a.bf=!1;a.Ea=!0;a.Ff=!1;break;default:ca.q("Unknown alpha blend mode: "+d)}a.wb=c.use_backface_culling}function f(a,b){for(var c=[],d=b.length,e=0;e<d;e++){var f=b[e];1==f[a]&&f.texture&&f.texture.p&&c.push(f)}return c}function H(a,b){var c=b.raytrace_transparency;a.Me[0]=c.fresnel;a.Me[1]=1-c.fresnel_factor/5;c=b.raytrace_mirror;a.reflect_factor=c.reflect_factor;a.Me[2]=c.fresnel;a.Me[3]=1-c.fresnel_factor/5}function D(a,b){var c,d=0;switch(b.specular_shader){case "PHONG":case "COOKTORR":c=
b.specular_hardness;break;case "WARDISO":c=b.specular_slope;break;case "TOON":c=b.specular_toon_size;d=b.specular_toon_smooth;break;case "BLINN":c=b.specular_ior;d=b.specular_hardness;break;default:O.error("unsupported specular shader: "+b.specular_shader+' (material "'+b.name+'")'),c=b.specular_hardness}a.Dd[0]=b.specular_intensity;a.Dd[1]=c;a.Dd[2]=d}function w(a,b){switch(b.diffuse_shader){case "LAMBERT":a.Kd[0]=0;a.Kd[1]=0;break;case "OREN_NAYAR":a.Kd[0]=b.roughness;a.Kd[1]=0;break;case "FRESNEL":a.Kd[0]=
b.diffuse_fresnel;a.Kd[1]=b.diffuse_fresnel_factor;break;case "MINNAERT":a.Kd[0]=b.darkness;a.Kd[1]=0;break;case "TOON":a.Kd[0]=b.diffuse_toon_size;a.Kd[1]=b.diffuse_toon_smooth;break;default:O.error("unsupported diffuse shader: "+b.diffuse_shader+' (material "'+b.name+'")'),a.Kd[0]=0,a.Kd[1]=0}}function E(a,b,c){if(!b.use_nodes||b.b4w_do_not_render)return!1;var d;switch(c){case "MAIN":N(a,"main.glslv","main.glslf");d=!1;break;case "GLOW":N(a,"main.glslv","main.glslf");d=!0;break;case "SHADOW":N(a,
"shadow.glslv","shadow.glslf");d=!1;break;case "COLOR_ID":N(a,"color_id.glslv","color_id.glslf"),d=!1}var e=b.node_tree;c=ja.VG(e,b.uuid,!1,b.name,c);if(!c.Oa)return O.error('Failed to create node graph for material "'+b.name+'", disable nodes'),x(a,b),!0;a.Ji=c.id;a.vi=!0;z(a,"NODES",1);z(a,"DOUBLE_SIDED_LIGHTING",b.b4w_double_sided_lighting?1:0);v(a,"a_position");b.use_orco_tex_coord&&v(a,"a_orco_tex_coord");l(a,b);a.Se=b.offset_z;var f=b.game_settings.alpha_blend;d?(z(a,"ALPHA",1),z(a,"ALPHA_CLIP",
0)):(z(a,"ALPHA","OPAQUE"===f?0:1),z(a,"ALPHA_CLIP","CLIP"===f?1:0));a.jg=b.b4w_render_above_all&&"OPAQUE"!=f&&"CLIP"!=f;fa.set(b.diffuse_color[0],b.diffuse_color[1],b.diffuse_color[2],b.alpha,a.Zc);a.Nf=b.emit;a.Gf=b.ambient;H(a,b);b.b4w_wettable?z(a,"WETTABLE",1):z(a,"WETTABLE",0);var g=null,h=!1;ma.ma(c.Oa,function(c,d){switch(d.type){case "UVMAP":case "TEX_COORD_UV":case "GEOMETRY_UV":case "UV_MERGED":var e=d.data.name,f=d.data.value;a.Th||(a.Th={});a.Th[f]=e;break;case "GEOMETRY_VC":case "GEOMETRY_VC1":case "GEOMETRY_VC2":case "GEOMETRY_VC3":e=
d.data.name;a.zc[e]={fk:!0,src:[{name:d.data.value}]};f=0;if("GEOMETRY_VC"==d.type)f=7;else for(var k=0;k<d.Qa.length;k++){var l="RGB".indexOf(d.Qa[k].identifier);-1<l&&(f|=1<<2-l)}a.zc[e].src[0].tf=f;break;case "TEX_COORD_NO":case "GEOMETRY_NO":v(a,"a_normal");break;case "MATERIAL_BEGIN":d.data.value.Uk&&(z(a,"USE_TBN_SHADING",1),"PARTICLES"!=a.type?v(a,"a_shade_tangs"):a.Si=!0);v(a,"a_normal");h=!0;break;case "TEXTURE_COLOR":case "TEXTURE_ENVIRONMENT":e=d.data.name;f=d.data.value;if(!f.p){O.warn('Wrong texture "'+
d.data.value.name+'" in material "'+b.name+'".');x(a,b);break}!1!==f.p.kl&&(f.p.kl="TEXTURE_ENVIRONMENT"!=d.type?!0:!1);L(a,f.p,e);break;case "TEXTURE_NORMAL":case "B4W_PARALLAX":z(a,"CALC_TBN_SPACE",1);v(a,"a_normal");v(a,"a_tangent");a.Si=!0;e=d.data.name;f=d.data.value;f.p.kl=!1;L(a,f.p,e);break;case "NORMAL_MAP":v(a,"a_normal");switch(Number(d.Ob[0][1])){case ja.RD:z(a,"CALC_TBN_SPACE",1);v(a,"a_tangent");a.Si=!0;break;case ja.QD:case ja.PD:z(a,"USE_ZUP_MODEL_MATRIX",1)}break;case "LAMP":d.data&&
(a.Ci=d.data);break;case "B4W_REFRACTION":a.kb?a.Xi=!0:(a.Xi=!0,O.warn('Material "'+b.name+'" is not blend. Disabling refractions.'));break;case "VALTORGB":case "CURVE_VEC":case "CURVE_RGB":g||(g=d.data.Ja);break;case "PARTICLE_INFO":"PARTICLES"==a.type&&d.data&&(a.Io=d.data);break;case "VECT_TRANSFORM":switch(Number(d.Ob[1][1])){case ja.$E:z(a,"USE_ZUP_MODEL_MATRIX_INVERSE",1);break;case ja.ZE:z(a,"USE_ZUP_VIEW_MATRIX",1);break;case ja.YE:z(a,"USE_ZUP_MODEL_MATRIX",1);break;case ja.XE:z(a,"USE_ZUP_MODEL_MATRIX",
1);z(a,"USE_ZUP_VIEW_MATRIX",1);break;case ja.WE:z(a,"USE_ZUP_VIEW_MATRIX_INVERSE",1);break;case ja.VE:z(a,"USE_ZUP_MODEL_MATRIX_INVERSE",1),z(a,"USE_ZUP_VIEW_MATRIX_INVERSE",1)}break;case "B4W_VECTOR_VIEW":z(a,"USE_ZUP_VIEW_MATRIX",1);break;case "B4W_REFLECT":z(a,"USE_ZUP_VIEW_MATRIX_INVERSE",1)}});g&&L(a,g,"u_nodes_texture");h||(a.Td=!0);d=a.Va.Ah=ja.jq(c.Oa);y(e,a);e=a.Wf;c=a.Vf;for(f=0;f<d.length;f++){var k=d[f];switch(k.id){case "VALUE":var m=k.Or[0];if(m)for(var n=0;n<e.length;n+=2)if(e[n]==
m){k.Ob.push(["VALUE_IND",e[n+1]]);break}break;case "RGB":if(m=k.Or[0])for(n=0;n<c.length;n+=2)if(c[n]==m){k.Ob.push(["RGB_IND",c[n+1]]);break}}}z(a,"NUM_VALUES",a.Bh.length);z(a,"NUM_RGBS",a.Nd.length);return!0}function y(a,b){var c=[],d=[],e=[],f=[];A(a,"",c,d,e,f);b.Bh=c;b.Wf=d;b.Nd=e;b.Vf=f}function A(a,b,c,d,e,f){for(var g=0;g<a.nodes.length;g++){var h=a.nodes[g];if("VALUE"==h.type){var k=G(b,h.name);c.push(h.outputs[0].default_value);d.push(k,d.length/2)}else"RGB"==h.type?(k=G(b,h.name),h=h.outputs[0].default_value.slice(0,
3),e.push(h[0],h[1],h[2]),f.push(k,f.length/2)):"GROUP"==h.type&&A(h.node_group.node_tree,G(b,h.name),c,d,e,f)}}function G(a,b){var c;return c=(a?a+"%join%":"")+b}function x(a,b){switch(a.type){case "SHADOW":N(a,"shadow.glslv","shadow.glslf");break;case "COLOR_ID":N(a,"color_id.glslv","color_id.glslf");break;default:N(a,"main.glslv","main_stack.glslf")}z(a,"SHADELESS",1);v(a,"a_position");v(a,"a_normal");fa.set(1,0,1,1,a.Zc);if(b){var c=b.game_settings.alpha_blend;z(a,"ALPHA","OPAQUE"===c?0:1);z(a,
"ALPHA_CLIP","CLIP"===c?1:0);z(a,"VERTEX_COLOR",0);a.Se=b.offset_z;l(a,b)}return!0}function k(a,b){if(b&&(b.b4w_lens_flares||b.b4w_do_not_render))return!1;N(a,"debug_view.glslv","debug_view.glslf");v(a,"a_position");v(a,"a_normal");v(a,"a_polyindex");a.Ea=!0;pa.set(0,0,0,a.wireframe_edge_color);return!0}function t(a,b){if("PHYSICS"!==a.type){"DYNAMIC"==b.type?(b.Ll?z(a,"AU_QUALIFIER","GLSL_IN"):z(a,"AU_QUALIFIER","uniform"),z(a,"STATIC_BATCH",0)):(z(a,"AU_QUALIFIER","GLSL_IN"),z(a,"STATIC_BATCH",
1));"DEBUG_VIEW"==a.type&&(Q.Vz()?z(a,"WIREFRAME_QUALITY",1):z(a,"WIREFRAME_QUALITY",0),a.lh?(z(a,"DEBUG_SPHERE",1),a.tq?z(a,"DEBUG_SPHERE_DYNAMIC",1):z(a,"DEBUG_SPHERE_DYNAMIC",0)):z(a,"DEBUG_SPHERE",0),z(a,"ALPHA",1));b.Ud&&(a.Ud=b.Ud);b.Fd?(""!==b.Sf?(a.zc.a_bending_col_main={fk:!0,src:[{name:b.Sf,tf:4}]},v(a,"a_bending_col_main"),""!==b.Yc.yA&&""!==b.Yc.xA&&""!==b.Yc.dB?(a.zc.a_bending_col_detail={fk:!0,src:[{name:b.Yc.yA,tf:4},{name:b.Yc.xA,tf:2},{name:b.Yc.dB,tf:1}]},v(a,"a_bending_col_detail"),
v(a,"a_normal"),z(a,"DETAIL_BEND",1)):z(a,"DETAIL_BEND",0),z(a,"MAIN_BEND_COL",1)):z(a,"MAIN_BEND_COL",0),z(a,"WIND_BEND",1)):z(a,"WIND_BEND",0);b.Bj?z(a,"BEND_CENTER_ONLY",1):z(a,"BEND_CENTER_ONLY",0);z(a,"BILLBOARD_PRES_GLOB_ORIENTATION",b.on|0);b.Fe?z(a,"BILLBOARD",1):z(a,"BILLBOARD",0);b.Fe&&b.Ll?z(a,"HAIR_BILLBOARD",1):z(a,"HAIR_BILLBOARD",0);b.Cj?z(a,"BILLBOARD_SPHERICAL",1):z(a,"BILLBOARD_SPHERICAL",0);switch(b.Dj){case "RANDOM":z(a,"BILLBOARD_RANDOM",1);z(a,"BILLBOARD_JITTERED",0);break;case "JITTERED":z(a,
"BILLBOARD_RANDOM",0);z(a,"BILLBOARD_JITTERED",1);break;default:z(a,"BILLBOARD_RANDOM",0),z(a,"BILLBOARD_JITTERED",0)}b.kc&&Ea.Tp?z(a,"DYNAMIC_GRASS",1):z(a,"DYNAMIC_GRASS",0);a.kc=b.kc;"PARTICLES"!=a.type&&(a.he=b.he);a.nd=b.nd;a.gd=b.gd;a.Tc=b.Tc&&!a.Td&&!(a.kb&&Ea.mu);a.Rc=b.Rc;a.Hc=b.Hc;a.ed=b.ed;b.Ai?(v(a,"a_influence"),z(a,"SKINNED",1),Ea.ms?(z(a,"DISABLE_TANGENT_SKINNING",1),z(a,"FRAMES_BLENDING",0)):(z(a,"DISABLE_TANGENT_SKINNING",0),b.bk?z(a,"FRAMES_BLENDING",1):z(a,"FRAMES_BLENDING",0)),
z(a,"MAX_BONES",b.Tf)):(z(a,"SKINNED",0),z(a,"FRAMES_BLENDING",0),z(a,"DISABLE_TANGENT_SKINNING",0));b.yc?(z(a,"VERTEX_ANIM",1),Ea.XC?z(a,"VERTEX_ANIM_MIX_NORMALS_FACTOR",.5):z(a,"VERTEX_ANIM_MIX_NORMALS_FACTOR","u_va_frame_factor")):z(a,"VERTEX_ANIM",0);b.Ai&&b.yc&&ca.q("Skinning and vertex animation are mutually exlusive");b.wl?z(a,"DISABLE_FOG",1):z(a,"DISABLE_FOG",0)}}function M(a,b,c){if(b.length){for(var d=oa.Lq(b,Ea.ssao&&c.b4w_enable_ssao),e=a.Va,f=0,g=0;g<a.Va.Ah.length;g++){var h=a.Va.Ah[g];
if("LIGHTING_LAMP"==h.id){var k=b[f++%b.length],l=k.Pa;"AREA"==l.type&&(k=b[f++%b.length],l=k.Pa);var m=oa.fa(k,c);if("SPOT"==l.type||"POINT"==l.type)var n=Math.cos(l.Ok/2);if("SPOT"==l.type)var q=l.hp*(1-n);m=m.vk;k=d.indexOf(k);h.Ob=[["LAMP_TYPE",l.type],["LAMP_IND",m],["LAMP_LIGHT_FACT_IND",Math.floor(m/2)],["LAMP_FAC_CHANNELS",0==m%2?"rg":"ba"],["LAMP_SPOT_SIZE",qa.D(n||.01)],["LAMP_SPOT_BLEND",qa.D(q||.01)],["LAMP_LIGHT_DIST",qa.D(l.distance)],["LAMP_SHADOW_MAP_IND",k]]}}if(a.Ci){c=0;for(var t in a.Ci)c++;
a.Rl=new Float32Array(3*c);a.xo=new Float32Array(3*c);a.wo=new Float32Array(3*c);a.yo=new Float32Array(4*c);qa.ba(e,"NUM_LAMP_LIGHTS",c);for(g=0;g<b.length;g++)u(a,b[g])}}}function u(a,b){if(b.mj in a.Ci){var c=a.Ci[b.mj],d=V.get_trans_view(b.k.m);a.Rl.set(d,3*c);a.xo.set(b.Pa.direction,3*c);a.wo.set(b.Pa.Fn,3*c);var d=Ma,e=b.Pa;d[0]=-1;d[1]=-1;d[2]=-1;d[3]=e.Tk?1:0;switch(e.type){case "POINT":d[2]=e.distance;break;case "SPOT":d[2]=e.distance;var f=d[0]=Math.cos(e.Ok/2);d[1]=e.hp*(1-f)}a.yo.set(d,
4*c)}}function v(a,b){var c=a.Oj;-1==c.indexOf(b)&&c.push(b)}function z(a,b,c){qa.ba(a.Va,b,c)}function S(a,b){if("PHYSICS"==a.type)0<b.Ga.length&&Z.wN(b,b.O[0]),a.Xe=b;else{var c=a.bf,d=a.Mf;a.Tq&&"PARTICLES"!=a.type&&(b=Z.LI(b));a.Ns&&(b=ea.oJ(a.Os,a.Ps,a.Ms));c=Z.yN(b,c,d,a.zc);a.aa=c;a.he||c.Kl||a.Ud||(c.ke=null,c.Ic=null);c=b.O.length;a.num_vertices=b.va*c;a:switch(a.Mf){case Z.Vm:case Z.Cp:case Z.Bp:d=!0;break a;default:d=!1}d?Z.nK(b)?a.num_triangles=b.lb.length/3*c:a.num_triangles=b.va/3*c:
a.num_triangles=0}}function C(a,b,c,d,f,g,h,k,l,m,n,q){var r=a.xa,v=[],u=k.b4w_dynamic_grass;if(!m&&u)return v;for(var w="INSTANCE"==k.b4w_wind_bend_inheritance,p="INSTANCE"==k.b4w_shadow_inheritance,J="INSTANCE"==k.b4w_reflection_inheritance,B=[],x=[],L=0;L<f.length;L++){var y=f[L].xa.k,D=oa.Mt(b);D.Fe=k.b4w_hair_billboard;D.Dj=k.b4w_hair_billboard_type;D.Cj="SPHERICAL"==k.b4w_hair_billboard_geometry;D.kc=u;D.Ll=!0;w?(D.Fd=y.Fd,D.bl=y.bl,D.ig=y.ig,D.Lf=y.Lf,D.Sf=y.Sf,D.Kf=y.Kf,D.Hf=y.Hf,D.Ef=y.Ef,
D.Yc=y.Yc,D.Bj=!1):(D.Fd=r.k.Fd,D.bl=r.k.bl,D.ig=r.k.ig,D.Lf=r.k.Lf,D.Sf=r.k.Sf,D.Kf=r.k.Kf,D.Hf=r.k.Hf,D.Ef=r.k.Ef,D.Yc=r.k.Yc,D.Bj=!0);p?(D.nd=y.nd,D.gd=y.gd,D.Tc=y.Tc):(D.nd=r.k.nd,D.gd=r.k.gd,D.Tc=r.k.Tc);J?(D.Rc=y.Rc,D.Hc=y.Hc,D.ed=y.ed,D.fe=y.fe,D.Pd=y.Pd,D.zf=y.zf):(D.Rc=r.k.Rc,D.Hc=r.k.Hc,D.ed=r.k.ed,D.fe=r.k.fe,D.Pd=r.k.Pd,D.zf=r.k.zf);B.push(D);var C=h[L];C||(C=new Float32Array);q&&ca.cr(l.seed,n);var A=new Float32Array(3),aa=new Float32Array([0,0,0,1]),E=[],G=I.By(Ea.fv)&&!k.b4w_initial_rand_rotation&&
!k.b4w_hair_billboard,H=4;G&&(H=8);for(var P=0;P<C.length;P+=H){A[0]=C[P];A[1]=C[P+1];A[2]=C[P+2];var M=C[P+3]*V.get_scale(y.m);if(k.b4w_initial_rand_rotation){switch(k.b4w_rotation_type){case "XYZ":var Ba=new Float32Array([ca.yf(n),ca.yf(n),ca.yf(n)]);pa.normalize(Ba,Ba);break;case "Z":Ba=new Float32Array([0,1,0]);break;default:ca.q("Unsupported random rotation type: "+k.b4w_rotation_type)}ka.setAxisAngle(Ba,k.b4w_rand_rotation_strength*(2*Math.PI*ca.yf(n)-Math.PI),aa)}else if(G&&(aa.set(C.subarray(P+
4,P+8)),ca.Sv(aa,aa),!k.use_whole_group))if(k.use_rotation_dupli){var ya=V.get_quat_view(y.m);ka.multiply(aa,ya,aa)}else ka.multiply(aa,na,aa);var N=V.set_sep(A,M,aa,V.create());E.push(N)}x.push(E)}for(var X={},L=0;L<f.length;L++){var U=f[L],da=g[L],D=B[L],Oa={};D.Fd&&(Oa.au_wind_bending_amp=[D.Ef],Oa.au_wind_bending_freq=[D.ig],Oa.au_detail_bending_freq=[D.Lf],Oa.au_detail_bending_amp=[D.Kf],Oa.au_branch_bending_amp=[D.Hf],D.Ef=0,D.ig=0,D.Lf=0,D.Kf=0,D.Hf=0);var S=K(D),E=x[L];if(E.length){for(var Ca=
U.data,fa=Ca.materials,Ia=Array(fa.length),va=Array(fa.length),P=0;P<fa.length;P++)if(!Z.cA(Ca,P))for(var T=0;T<da.length;T++){var Q=da[T],ma=e(Q),Ma=fa[P];"COLOR_ID"==Q&&(ma.sn=!(U.b4w_do_not_render||Ma.b4w_do_not_render));"MAIN"==Q?Ia[P]=ma:"DEBUG_VIEW"==Q&&(va[P]=ma);ma.Jj=a.b4w_cluster_data.cluster_id;if(W(ma,Ma)){"SHADOW"==Q&&Ia[P]&&(ma.Td=Ia[P].Td);ma.Mf=Z.Vm;t(ma,D);ma.Ki=k.uuid;"JITTERED"==k.b4w_hair_billboard_type&&(ma.lr=k.b4w_hair_billboard_jitter_amp,ma.mr=k.b4w_hair_billboard_jitter_freq);
u&&(ma.Nq=k.b4w_dynamic_grass_scale_threshold);w||(delete ma.zc.a_bending_col_main,delete ma.zc.a_bending_col_detail);F(ma,S);var ga=Z.mz(Ca,P,ma.Oj,b.gi,ma.zc,ma.Th),Fa=r.k.m,ra=Ea.Px&&1==f.length;if(ra){var ja=ca.I(ga);Z.oy(r,ga,ja,E);ja.Dg={Gm:E,rs:Fa,gC:"STATIC"==b.type,jp:Oa,Fk:{},Tn:u};if(D.Fd&&D.Bj){var ia=pa.fromValues(0,0,0);V.transform_vec3(ia,r.k.m,ia);for(var Aa=[],la=0;la<E.length;la++)Aa.push(ia[0],ia[1],ia[2]);ja.Dg.Fk.a_emitter_center={Jb:3,data:Aa}}Z.oy(r,ga,ga,E)}else{var ha=ja=
Z.VK(ga,Oa,E,r),Ja=E;ha.ga.au_center_pos=new Float32Array(3*ha.va);for(var ea=Ja.length,qa=ha.va/ea,Ka=0;Ka<ea;Ka++)for(var pb=Ja[Ka],bc=3*qa*Ka,Sa=0;Sa<qa;Sa++)ha.ga.au_center_pos[bc+3*Sa]=pb[0],ha.ga.au_center_pos[bc+3*Sa+1]=pb[1],ha.ga.au_center_pos[bc+3*Sa+2]=pb[2];ja=ha;if(D.Fd&&D.Bj){var Zb=ja,Tc=r.k.m;Zb.ga.a_emitter_center=new Float32Array(3*Zb.va);var Db=pa.fromValues(0,0,0);V.transform_vec3(Db,Tc,Db);for(var Qb=0;Qb<Zb.va;Qb++)Zb.ga.a_emitter_center[3*Qb]=Db[0],Zb.ga.a_emitter_center[3*
Qb+1]=Db[1],Zb.ga.a_emitter_center[3*Qb+2]=Db[2];ja=Zb}}var Jb=k.b4w_vcol_from_name,ic=k.b4w_vcol_to_name,eb=ma,jc=c,Fc=!w,Kb=Ca,Tb=[];if(""!==Jb&&""!==ic){var pc,Uc=ic,Eb=eb.zc,Ub=[],fb=void 0;for(fb in Eb)for(var Pa=Eb[fb].src,yb=0,Lb=0;Lb<Pa.length;Lb++){var Vb=Pa[Lb].tf;Uc==Pa[Lb].name&&Ub.push(fb,Vb,yb);yb+=ca.Jk(Vb)}pc=Ub;if(0<pc.length)for(var Fb=0;Fb<pc.length;Fb+=3)Tb.push({Wn:Jb,Bq:7,Pr:pc[Fb],Qr:pc[Fb+1],yq:pc[Fb+2]});else Z.YJ(eb.Oj,"a_color")&&ic==Kb.active_vcol_name&&Tb.push({Wn:Jb,
Bq:7,Pr:"a_color",Qr:7,yq:0})}Fc&&("a_bending_col_main"in jc&&Tb.push({Wn:"a_bending_col_main",Bq:4,Pr:"a_bending_col_main",Qr:4,yq:0}),"a_bending_col_detail"in jc&&Tb.push({Wn:"a_bending_col_detail",Bq:7,Pr:"a_bending_col_detail",Qr:7,yq:0}));for(var Wb=ja,Mb=E,Gc=d,Xb=Tb,wc=ma.zc,zb=ra,Hc=!1,lb=0;lb<Xb.length;lb++){var Va=Xb[lb].Wn,cb=Gc.ga[Va];if(cb&&0<cb.length){Hc=!0;break}}if(zb)var qc=Wb.Dg.Fk;if(Hc){var xc,mb=r.k.U,sb=Gc.O[0].a_position,Ab=Mb,Ga=X,nb=new Float32Array(3),db=new Float32Array(3),
cc=new Uint32Array(Ab.length);if(!("verts_indices"in Ga)){Ga.gh=new Float32Array(3);Ga.eh=new Float32Array(3);Ga.dx=new Uint32Array(sb.length/3);Ga.Do=new Uint32Array(sb.length/3);Ga.gh[0]=(mb.max_x-mb.min_x)/20;Ga.gh[1]=(mb.max_y-mb.min_y)/20;Ga.gh[2]=(mb.max_z-mb.min_z)/20;Ga.eh[0]=mb.min_x;Ga.eh[1]=mb.min_y;Ga.eh[2]=mb.min_z;for(var Ha=0;Ha<sb.length/3;Ha++){var gb=ca.trunc((sb[3*Ha]-Ga.eh[0])/Ga.gh[0]),$a=ca.trunc((sb[3*Ha+1]-Ga.eh[1])/Ga.gh[1]),Nb=ca.trunc((sb[3*Ha+2]-Ga.eh[2])/Ga.gh[2]),gb=
ca.clamp(gb,0,19),$a=ca.clamp($a,0,19),Nb=ca.clamp(Nb,0,19);Ga.dx[Ha]=Ha;Ga.Do[Ha]=Nb*Math.pow(20,2)+20*$a+gb}Z.$B(Ga.Do,Ga.dx,Z.it,!0);Ga.Yk=new Uint32Array(Math.pow(20,3));for(Ha=0;Ha<Ga.Do.length;Ha++)Ga.Yk[Ga.Do[Ha]]++;delete Ga.Do;for(Ha=1;Ha<Ga.Yk.length;Ha++)Ga.Yk[Ha]+=Ga.Yk[Ha-1]}for(var ib=0;ib<Ab.length;ib++){nb[0]=Ab[ib][0];nb[1]=Ab[ib][1];nb[2]=Ab[ib][2];for(var Wa=1E10,tb=-1,ob=ca.trunc((nb[0]-Ga.eh[0])/Ga.gh[0]),hb=ca.trunc((nb[1]-Ga.eh[1])/Ga.gh[1]),Ic=ca.trunc((nb[2]-Ga.eh[2])/Ga.gh[2]),
ob=ca.clamp(ob,0,19),hb=ca.clamp(hb,0,19),Ic=ca.clamp(Ic,0,19),kc=Ic*Math.pow(20,2)+20*hb+ob,ad=Ga.Yk[kc],ub=0==kc?0:Ga.Yk[kc-1];ub<ad;ub++){var dc=Ga.dx[ub];db[0]=sb[3*dc];db[1]=sb[3*dc+1];db[2]=sb[3*dc+2];pa.sub(db,nb,db);var ec=pa.sqrLen(db);ec<=Wa&&(Wa=ec,tb=dc)}if(-1==tb)for(ub=0;ub<sb.length/3;ub++)db[0]=sb[3*ub],db[1]=sb[3*ub+1],db[2]=sb[3*ub+2],pa.sub(db,nb,db),ec=pa.sqrLen(db),ec<=Wa&&(Wa=ec,tb=ub);cc[ib]=tb}xc=cc;for(var yc=Wb.va/Mb.length,lb=0;lb<Xb.length;lb++){var Xa=Xb[lb].Pr,ab=Xb[lb].Qr,
Va=Xb[lb].Wn,Jc=Xb[lb].Bq,cb=Gc.ga[Va];switch(Xa){case "a_bending_col_main":var Yb=1;break;case "a_bending_col_detail":Yb=3;break;case "a_color":Yb=3;break;default:for(var qb=Yb=0;qb<wc[Xa].src.length;qb++)Yb+=ca.Jk(wc[Xa].src[qb].tf)}if(cb&&0<cb.length){var lc=ca.Jk(Jc),Kc=ca.Jk(ab),bd=Jc&ab,zc=ca.AB(bd);bd!=ab&&O.error("Wrong color extraction from "+Va+" to "+Xa+".");if(zb)for(qc[Xa]={Jb:Yb,data:[]},qb=0;qb<Mb.length;qb++)for(vb=xc[qb],Rc=vb*lc,Ob=0;Ob<zc.length;Ob++)zc[Ob]&&(sc=ca.jm(Jc,Ob),qc[Xa].data.push(cb[Rc+
sc]));else{if("a_bending_col_main"==Xa||"a_bending_col_detail"==Xa)Wb.ga[Xa]=new Float32Array(Wb.va*Kc);for(qb=0;qb<Mb.length;qb++){var vb=xc[qb],Rc=vb*lc,Lc=qb*yc*Yb;if(-1!=vb)for(var rc=0;rc<yc;rc++)for(var cd=rc*Yb,Ob=0;Ob<zc.length;Ob++)if(zc[Ob]){var sc=ca.jm(Jc,Ob);Wb.ga[Xa][Lc+cd+(Xb[lb].yq+ca.jm(ab,Ob))]=cb[Rc+sc]}}}}else Wb.ga[Xa]=new Float32Array(0)}}ja=Wb;z(ma,"USE_INSTANCED_PARTCLS",ja.Dg?1:0);v.push({Y:ma,Xe:ja,ne:[Ma.name],k:D,Ue:[a]})}}for(P=0;P<va.length;P++)va[P]&&(va[P].ul=Ia[P].id,
F(va[P],va[P].Uo))}}return v}function W(a,b){var c=!0;"NODES_GLOW"==a.type&&(c=ja.zy(b));return c=c&&q(a,b)}function F(a,b){var c=null,d=null,e=a.U,f=a.Ca,g=a.K,h=a.Z,k=a.Vd;a.U=null;a.Ca=null;a.K=null;a.Z=null;a.Vd=null;for(var l=0;l<a.T.length;l++){var m=a.T[l].Id;m&&(c||(c={}),c[l]=m,a.T[l].Id=null);if(m=a.T[l].sa)d||(d={}),d[l]=m,a.T[l].sa=null}a.id=0;a.Uo=b;a.id=ca.py(a,b);a.U=e;a.Ca=f;a.K=g;a.Z=h;a.Vd=k;if(c)for(var n in c)a.T[n].Id=c[n];if(d)for(n in d)a.T[n].sa=d[n]}function K(a){var b=a.be;
a.be=null;var c=ca.py(a,0);a.be=b;return c}function X(a,b,c,d,f){var g=e("DEBUG_VIEW");N(g,"debug_view.glslv","debug_view.glslf");g.lh=!0;g.Ea=!0;g.Ki=c;d&&(g.tq=!0);t(g,b);b=K(b);F(g,b);c=d?a.J:pa.create();b=ea.Gz(c);var h=pa.fromValues(pa.length(a.rd),pa.length(a.sd),pa.length(a.td));Z.FB(b,h,c);d||(V.set_trans(a.J,Fa),d=pa.normalize(a.rd,Ca),c=pa.normalize(a.sd,ya),a=pa.normalize(a.td,va),a=ca.zI(d,c,a,Ka),ra.invert(a,a),a=ka.fromMat3(a,Ma),V.set_quat(a,Fa),V.set_scale(1,Fa),Z.zw(b,Fa));g.U=T.ii(f.U);
g.Ca=T.ji(f.Ca);g.K=T.ii(f.K);g.Z=T.ji(f.Z);Z.ts(b,1,!0);b.ga.a_polyindex=Z.Dq(b);S(g,b);return g}function N(a,b,c){a.Va.oj=b;a.Va.zg=c;qa.oM(a.Va)}function L(a,b,c){1==a.T.length&&0==a.Uc.length&&a.Uc.push("default0");c=c||"default"+String(a.T.length);-1==a.Uc.indexOf(c)&&(a.T.push(b),a.Uc.push(c));a.La&&Ia.Xx(a)}function P(a){a.Va||ca.q("No shaders info for batch "+a.name);var b=a.La?a.La.$o:null;a.La=qa.xJ(a.Va);var c=a.Va;if(c.status===qa.kt){var c=a.La.attributes,d=a.aa.vb,e;for(e in c)d[e]||
ca.q('missing data for "'+e+'" attribute')}c=a.Va;c.status&qa.rD&&O.error("Texture limit exceeded for shader - "+a.Va.zg+', materials: "'+a.lc.join(", ")+'"');c.status&qa.qD&&O.error("Fragment uniform limit exceeded for shader - "+a.Va.zg+', materials: "'+a.lc.join(", ")+'"');c.status&qa.uD&&O.error("Vertex uniform limit exceeded for shader - "+a.Va.oj+', materials: "'+a.lc.join(", ")+'"');c.status&qa.tD&&O.error("Vertex attribute limit exceeded for shader - "+a.Va.oj+', materials: "'+a.lc.join(", ")+
'"');c.status&qa.sD&&("MAIN"!=a.type||a.vi||O.error("Varying limit exceeded for shader - "+a.Va.zg+', materials: "'+a.lc.join(", ")+'"'),"MAIN"==a.type&&a.vi||"NODES_GLOW"==a.type)&&(c=e=0,a.Th&&(e=ca.jo(a.Th)),a.zc&&(c=ca.jo(a.zc)),O.error("Varying limit exceeded for node shader - "+a.Va.zg+", uv: "+e+", vc: "+c+', materials: "'+a.lc.join(", ")+'"'));return a.Va.status===qa.kt?(Ia.PF(a.La),Ia.st(a),Ia.Xx(a),a.La.$o!=b&&(a.lm=1),!0):!1}function da(a,b,c){a=a.C[0].P;for(var d=0;d<a.length;d++)if(a[d].type==
c&&!a[d].of&&-1!=a[d].lc.indexOf(b))return a[d];return null}function U(a,b,c){a=a.C[0].P;for(var d=0;d<a.length;d++)if(a[d].type==c&&a[d].of&&-1!=a[d].lc.indexOf(b))return a[d];return null}function ga(a,b){a.Zc.set(b.Zc);a.vg=b.vg;a.Cf.set(b.Cf);a.Lh=b.Lh;a.Dd.set(b.Dd);a.Nf=b.Nf;a.Gf=b.Gf;a.ug=b.ug;a.mg=b.mg;a.reflect_factor=b.reflect_factor;a.Me.set(b.Me);a.parallax_scale=b.parallax_scale;a.shallow_water_col.set(b.shallow_water_col);a.shallow_water_col_fac=b.shallow_water_col_fac;a.shore_water_col.set(b.shore_water_col);
a.shore_water_col_fac=b.shore_water_col_fac;a.foam_factor=b.foam_factor;a.rj=b.rj}var T=p("__boundings"),la=p("__config"),O=p("__print"),Q=p("__extensions"),Z=p("__geometry"),ma=p("__graph"),ra=p("__mat3"),ja=p("__nodemat"),oa=p("__obj_util"),ha=p("__particles"),ea=p("__primitives"),ka=p("__quat"),I=p("__reformer"),Ia=p("__renderer"),Aa=p("__scenegraph"),qa=p("__shaders"),J=p("__subscene"),aa=p("__textures"),V=p("__tsr"),ca=p("__util"),pa=p("__vec3"),fa=p("__vec4"),Ea=la.v,ia=["MAIN"],na=new Float32Array([0,
-Math.sqrt(.5),0,Math.sqrt(.5)]),Ca=new Float32Array(3),ya=new Float32Array(3),va=new Float32Array(3),Ma=new Float32Array(4),Fa=V.create(),Ja=new Float32Array(24),Ka=ra.create();a.$O=Oa;var Oa="u_colormap0 u_colormap1 u_stencil0 u_specmap0 u_normalmap0 u_mirrormap".split(" "),Ba={};a.TF=function(a){return Ba[a]||null};a.UF=function(a,b){Ba[a]=b};a.VQ=e;a.nJ=function(a,c,d,e){for(var f=[],g=[],k=0;k<c.length;k++){var l=c[k],m=l.xa;m.uo||(oa.Da(m)?f.push(l):g.push(l))}for(var k=[],k=k.concat(n(f,a.p.Oa)),
m=k=k.concat(h(g,a.p.Oa)),f=[],g=[],q={},k=0;k<m.length;k++){var t=m[k].Y,r=m[k].k,v=null;if(t.id in q){var u=q[t.id],w=g[u].Y,p=g[u].k,J=null,z=null,B=t.U,x=t.Ca,L=t.K,D=t.Z;t.U=null;t.Ca=null;t.K=null;t.Z=null;var y=w.U,C=w.Ca,A=w.K,V=w.Z;w.U=null;w.Ca=null;w.K=null;w.Z=null;for(l=0;l<t.T.length;l++){var I=t.T[l].Id;I&&(J||(J={}),J[l]=I,t.T[l].Id=null);if(I=t.T[l].sa)z||(z={}),z[l]=I,t.T[l].sa=null}ca.lC(t,w)&&ca.lC(r,p)&&(v=g[u]);t.U=B;t.Ca=x;t.K=L;t.Z=D;w.U=y;w.Ca=C;w.K=A;w.Z=V;if(J)for(l in J)t.T[l].Id=
J[l];if(z)for(l in z)t.T[l].sa=z[l];if(!v){do t.id++;while(q[t.id])}}v||(v={Y:t,k:m[k].k,Ue:[],Aw:[],ne:[]},q[t.id]=g.length,g.push(v));v.Ue=v.Ue.concat(m[k].Ue);m[k].Xe&&m[k].Xe.va&&v.Aw.push(m[k].Xe);if(v.ne.length)for(l=0;l<m[k].ne.length;l++)t=m[k].ne[l],-1==v.ne.indexOf(t)&&v.ne.push(t);else v.ne=m[k].ne;Z.$B(v.ne,v.Aw,Z.PE,!1)}for(k=0;k<g.length;k++){m=g[k].Aw;if(0==m.length)l=ca.Nc(ca.mp("%empty"));else if(1==m.length)l=m[0];else{q=[];for(l=0;l<m.length;l++)Z.oK(m[l])||q.push(l);if(q.length<
m.length)for(l=0;l<q.length;l++)Z.ts(m[q[l]]);l=Z.xN(m)}"PARTICLES"!=g[k].Y.type&&(m=l.Rd,g[k].Y.U=T.ii(m.U),g[k].Y.Ca=T.ji(m.Ca),g[k].Y.K=T.ii(m.K),g[k].Y.Z=T.ji(m.Z));f.push({Y:g[k].Y,k:g[k].k,Xe:l,ne:g[k].ne,Ue:g[k].Ue})}for(g=0;g<f.length;g++)if(m=f[g].Y,m.lc=f[g].ne,S(m,f[g].Xe),M(m,d,a),"STATIC"==f[g].k.type&&"COLOR_ID"!=m.type){k=ca.mp("%meta%"+m.type+"%"+m.lc.join("%")+"%");q=oa.In(k,"MESH");q.k=oa.Mt(f[g].k);oa.en(q,a);oa.Vp(q,a,m);e.push(q);v=[];for(l=0;l<f[g].Ue.length;l++){k=f[g].Ue[l];
k=k.xa;T.Zn(k.k.K,Ja);for(t=0;t<Ja.length;t++)v.push(Ja[t]);"MAIN"==m.type&&k.yr.push(q)}q.k.Z=T.oq(ca.f32(v),!0);q.k.Ca=T.Ct(q.k.Z,q.k.m);T.xy(m.Z,q.k.Dc)&&(q.k.Uj=!0)}else for(q=[],l=0;l<f[g].Ue.length;l++)k=f[g].Ue[l],k=k.xa,-1==q.indexOf(k.name)&&(oa.Vp(k,a,m),q.push(k.name),T.xy(m.Z,k.k.Dc)&&(k.k.Uj=!0));if(Ea.debug_view){for(g=0;g<f.length;g++)if(d=f[g].k,"DYNAMIC"==d.type&&(k=f[g].Ue[0].xa,-1<ia.indexOf(f[g].Y.type))){l=oa.fa(k,a);m=l.P;q=!1;for(l=0;l<m.length;l++)m[l].lh&&(q=!0);q||(d=X(d.Ca,
d,k.name,!0,d),oa.Vp(k,a,d))}for(g=0;g<e.length;g++)k=e[g],d=k.k,l=oa.fa(k,a),m=l.P,-1<ia.indexOf(m[0].type)&&(d=X(m[0].Z,d,k.name,!1,m[0]),oa.Vp(k,a,d));for(g=0;g<f.length;g++)m=f[g].Y,"DEBUG_VIEW"==m.type&&(m.sq=g)}for(g=0;g<c.length;g++)for(l=oa.fa(c[g].xa,a),m=l.P,l=0;l<m.length;l++)b(m[l]);for(g=0;g<e.length;g++)for(l=oa.fa(e[g],a),m=l.P,l=0;l<m.length;l++)b(m[l])};a.vF=function(a,d,f){var g=a.p.kx,h=e("MAIN");N(h,"special_skydome.glslv","special_skydome.glslf");if(d.procedural_skydome)z(h,"PROCEDURAL_SKYDOME",
1),h.Wr=!0;else{var l=g.rw;if(l){z(h,"WO_SKYTEX",1);var m=aa.Pc(g.YB,null);L(h,m,"u_sky");l.invert&&z(h,"MTEX_NEGATIVE",1);l.DO&&z(h,"MTEX_RGBTOINT",1);z(h,"BLENDTYPE",l.$F);l.zO&&z(h,"WOMAP_BLEND",1);l.AO&&z(h,"WOMAP_HORIZ",1);l.CO&&z(h,"WOMAP_ZENUP",1);l.BO&&z(h,"WOMAP_ZENDOWN",1)}g.EO&&z(h,"WO_SKYBLEND",1);g.FO&&z(h,"WO_SKYPAPER",1);g.GO&&z(h,"WO_SKYREAL",1)}d.Rc&&(h.Rc=!0,d.Hc&&(h.Hc=!0));h.Se=99999;v(h,"a_position");d=ea.jJ();S(h,d);b(h);g=oa.fa(f,a);f.k.oh=!0;h.Ca=T.kf();h.Z=T.kf();h.U=T.Wc();
h.K=T.Wc();f=K(f.k);F(h,f);g.P.push(h);Aa.$b(a.p.Oa,J.ze)&&(a=c(h),a.type="DEBUG_VIEW",a.rb="",k(a),z(a,"DEBUG_VIEW_SPECIAL_SKYDOME",1),d.ga.a_polyindex=Z.Dq(d),S(a,d),a.ul=h.id,F(a,f),g.P.push(a))};a.Wt=function(a,b,d){d=oa.fa(a,d).P;var e=[];Aa.$b(b,J.Ac);var f=Aa.$b(b,J.jd),g=Aa.$b(b,J.Kc),h=Aa.$b(b,J.kg);b=Aa.$b(b,J.Xd);for(var k=0;k<d.length;k++){var l=d[k],m=null;"SHADOW"==l.type&&"RECEIVE"==l.rb&&l.nd&&(m=c(l),m.rb="CAST");"MAIN"!=l.type&&"PARTICLES"!=l.type||!f&&!g||!l.Rc||(m=c(l),m.rb="REFLECT",
m.Xi=!1,m.bf&&(m.bf=!1,m.Ea=!1),m.Ia=l.Ia);"COLOR_ID"==l.type&&l.sn&&h&&a.k.fc&&(b&&a.k.Ng?(m=c(l),m.rb="OUTLINE"):l.rb="OUTLINE");m&&(m.of=!0,F(m,a.k.id),e.push(m))}d.push.apply(d,e)};a.EM=g;a.VO=function(a,b,c){b?b=c*(b.max_y-b.min_y):(b=1,ca.q("No bounding box for mesh"));if(0==b)return 0;a=b*Math.tan(ca.deg_to_rad(a));return.5*(Math.sqrt(2*Math.sqrt(4*a+1)+2)/2-1)/b};a.VF=function(a){return{max_x:a.max_x,min_x:a.min_x,max_y:a.max_y,min_y:a.min_y,max_z:a.max_z,min_z:a.min_z}};a.BF=function(a,b,
c){b=aa.Dz(b,c);L(a,b,"u_color_ramp_tex")};a.SN=x;a.RN=M;a.AM=u;a.Wx=function(a,b){z(a,"CSM_SECTION0",0);z(a,"CSM_SECTION1",0);z(a,"CSM_SECTION2",0);z(a,"CSM_SECTION3",0);z(a,"NUM_CAST_LAMPS",0);if(b){z(a,"NUM_CAST_LAMPS",b.Rf.length);Ea.vr&&z(a,"MAC_OS_SHADOW_HACK",1);for(var c=0;c<b.csm_num;c++)z(a,"CSM_SECTION"+String(c),1);z(a,"SHADOW_TEX_RES",qa.D(b.csm_resolution));z(a,"CSM_FADE_LAST_CASCADE",b.fade_last_cascade?1:0);z(a,"CSM_BLEND_BETWEEN_CASCADES",b.blend_between_cascades?1:0)}else z(a,"SHADOW_TEX_RES",
0),z(a,"CSM_FADE_LAST_CASCADE",0),z(a,"CSM_BLEND_BETWEEN_CASCADES",0)};a.Sa=z;a.bd=function(a,b){return qa.BJ(a.Va,b)};a.PN=S;a.QN=F;a.kG=K;a.Wp=N;a.ml=L;a.XL=function(a,b,c){c=a.Uc.indexOf(c);-1<c&&(a.T[c]=b)};a.xH=function(a,b){var c=e("MAIN");c.kb=!0;fa.set(b[0],b[1],b[2],.5,c.Zc);c.Mf=Z.Cp;S(c,a);N(c,"main.glslv","main_stack.glslf");z(c,"SHADELESS",1);P(c);return c};a.gc=P;a.mJ=function(a,c){for(var d=0;d<c.length;d++){var f=c[d].xa,g=e("LINE");N(g,"line.glslv","line.glslf");g.kb=!0;var h=ea.lJ();
S(g,h);b(g);g.U=T.Wc();g.K=T.Wc();g.Ca=T.kf();g.Z=T.kf();oa.en(f,a);oa.fa(f,a).P.push(g);P(g)}};a.tG=function(a){return a.La.Jo.length?a.La.Mv.u_cube_fog?!0:!1:!1};a.fH=function(){var a=e("DEPTH_PACK");a.wb=!0;a.Ea=!1;var b=ea.vc();S(a,b);N(a,"postprocessing/postprocessing.glslv","postprocessing/depth_pack.glslf");P(a);return a};a.Yt=function(a){var b=e("POSTPROCESSING");N(b,"postprocessing/postprocessing.glslv","postprocessing/postprocessing.glslf");switch(a){case "NONE":z(b,"POST_EFFECT","POST_EFFECT_NONE");
break;case "GRAYSCALE":z(b,"POST_EFFECT","POST_EFFECT_GRAYSCALE");break;case "X_BLUR":z(b,"POST_EFFECT","POST_EFFECT_X_BLUR");break;case "Y_BLUR":z(b,"POST_EFFECT","POST_EFFECT_Y_BLUR");break;case "X_GLOW_BLUR":z(b,"POST_EFFECT","POST_EFFECT_X_GLOW_BLUR");break;case "Y_GLOW_BLUR":z(b,"POST_EFFECT","POST_EFFECT_Y_GLOW_BLUR");break;case "X_DOF_BLUR":z(b,"POST_EFFECT","POST_EFFECT_X_DOF_BLUR");break;case "Y_DOF_BLUR":z(b,"POST_EFFECT","POST_EFFECT_Y_DOF_BLUR");break;case "X_ALPHA_BLUR":z(b,"POST_EFFECT",
"POST_EFFECT_X_ALPHA_BLUR");break;case "Y_ALPHA_BLUR":z(b,"POST_EFFECT","POST_EFFECT_Y_ALPHA_BLUR");break;case "X_EXTEND":z(b,"POST_EFFECT","POST_EFFECT_X_EXTEND");break;case "Y_EXTEND":z(b,"POST_EFFECT","POST_EFFECT_Y_EXTEND");break;case "FLIP_CUBEMAP_COORDS":z(b,"POST_EFFECT","FLIP_CUBEMAP_COORDS");break;default:ca.q("Wrong postprocessing effect: "+a)}b.wb=!0;b.Ea=!1;a=ea.vc();S(b,a);P(b);return b};a.AH=function(a){var b=e("SSAO");b.Ea=!1;b.wb=!0;var c=ea.vc();S(b,c);N(b,"postprocessing/postprocessing.glslv",
"postprocessing/ssao.glslf");z(b,"SSAO_QUALITY","SSAO_QUALITY_"+a.fC);z(b,"SSAO_HEMISPHERE",a.ssao_hemisphere?1:0);a={texture:aa.pJ("SSAO_TEXTURE",a)};c={width:4,height:4,data:new Uint8Array([150,123,254,0,127,3,97,0,164,246,99,0,155,177,14,0,54,83,221,0,2,142,143,0,32,57,79,0,49,160,32,0,57,232,115,0,178,216,203,0,70,196,218,0,241,164,82,0,225,58,85,0,233,88,189,0,144,25,203,0,117,73,12,0])};a=aa.Pc(a,c);L(b,a,"u_ssao_special_tex");P(b);return b};a.BH=function(a){var b=e("SSAO_BLUR");b.Ea=!1;b.wb=
!0;var c=ea.vc();S(b,c);N(b,"postprocessing/postprocessing.glslv","postprocessing/ssao_blur.glslf");z(b,"SSAO_BLUR_DEPTH",a.ssao_blur_depth?1:0);P(b);return b};a.bH=function(a){var b=e("COC");b.Ea=!1;b.wb=!0;var c=ea.vc();S(b,c);N(b,"postprocessing/postprocessing.glslv","postprocessing/coc.glslf");z(b,"DEPTH_RGBA",1);switch(a){case "COC_ALL":z(b,"COC_TYPE","COC_ALL");break;case "COC_FOREGROUND":z(b,"COC_TYPE","COC_FOREGROUND");break;case "COC_COMBINE":z(b,"COC_TYPE","COC_COMBINE")}P(b);return b};
a.gH=function(a){var b=e("DOF");b.Ea=!1;b.wb=!0;var c=ea.vc();S(b,c);N(b,"postprocessing/postprocessing.glslv","postprocessing/dof.glslf");a.o.Oc?z(b,"DOF_TYPE","DOF_BOKEH"):(z(b,"DOF_TYPE","DOF_SIMPLE"),z(b,"DEPTH_RGBA",1));P(b);return b};a.pH=function(){var a=e("OUTLINE");a.Ea=!1;a.wb=!0;var b=ea.vc();S(a,b);N(a,"postprocessing/postprocessing.glslv","postprocessing/outline.glslf");P(a);return a};a.iH=function(){var a=e("GLOW_COMBINE");a.Ea=!1;a.wb=!0;var b=ea.vc();S(a,b);N(a,"postprocessing/postprocessing.glslv",
"postprocessing/glow.glslf");P(a);return a};a.jH=function(a,b,c){var d=e("GOD_RAYS");d.Ea=!1;d.wb=!0;var f=ea.eJ();S(d,f);N(d,"postprocessing/god_rays.glslv","postprocessing/god_rays.glslf");z(d,"DEPTH_RGBA",a?1:0);z(d,"WATER_EFFECTS",b?1:0);z(d,"STEPS_PER_PASS",qa.D(c,1));P(d);return d};a.kH=function(){var a=e("GOD_RAYS_COM");a.Ea=!1;a.wb=!0;var b=ea.vc();S(a,b);N(a,"postprocessing/postprocessing.glslv","postprocessing/god_rays_combine.glslf");z(a,"SAFARI_CANVAS_ALPHA_HACK",Ea.DB?1:0);P(a);return a};
a.sH=function(){var a=e("SKY");a.Ea=!1;a.wb=!0;var b=ea.fJ();S(a,b);N(a,"procedural_skydome.glslv","procedural_skydome.glslf");z(a,"WATER_EFFECTS",1);P(a);return a};a.YG=function(a){var b=e("ANTIALIASING");b.Ea=!1;b.wb=!0;var c=ea.vc();S(b,c);N(b,"postprocessing/postprocessing.glslv","postprocessing/antialiasing.glslf");Ea.tB?(z(b,"AA_METHOD","AA_METHOD_FXAA_QUALITY"),z(b,"AA_QUALITY",a.yz)):z(b,"AA_METHOD","AA_METHOD_FXAA_LIGHT");P(b);return b};a.yH=function(a){var b=e("SMAA"),c=ea.vc();S(b,c);N(b,
"postprocessing/smaa.glslv","postprocessing/smaa.glslf");z(b,"AA_METHOD","AA_METHOD_SMAA_HIGH");z(b,"SMAA_PASS",a);z(b,"SMAA_PREDICATION",0);z(b,"SMAA_REPROJECTION",0);P(b);b.Ea=!1;b.wb=!0;return b};a.dH=function(){var a=e("COMPOSITING");a.Ea=!1;a.wb=!0;var b=ea.vc();S(a,b);N(a,"postprocessing/postprocessing.glslv","postprocessing/compositing.glslf");P(a);return a};a.oH=function(){var a=e("MOTION_BLUR");a.wb=!0;a.Ea=!1;var b=ea.vc();S(a,b);N(a,"postprocessing/postprocessing.glslv","postprocessing/motion_blur.glslf");
P(a);return a};a.CH=function(a){var b=e("STEREO");b.wb=!0;b.Ea=!1;var c=ea.vc();S(b,c);N(b,"postprocessing/postprocessing.glslv","postprocessing/stereo.glslf");z(b,"ANAGLYPH","ANAGLYPH"===a?1:0);P(b);return b};a.lH=function(){var a=e("LUMINANCE");a.Ea=!1;a.wb=!0;var b=ea.vc();S(a,b);N(a,"postprocessing/postprocessing.glslv","postprocessing/luminance.glslf");P(a);return a};a.ZG=function(){var a=e("LUMINANCE");a.Ea=!1;a.wb=!0;var b=ea.vc();S(a,b);N(a,"postprocessing/postprocessing.glslv","postprocessing/luminance_av.glslf");
P(a);return a};a.mH=function(){var a=e("LUMINANCE_X_BLUR");a.Ea=!1;a.wb=!0;var b=ea.vc();S(a,b);N(a,"postprocessing/luminance_trunced.glslv","postprocessing/luminance_trunced.glslf");P(a);return a};a.$G=function(){var a=e("POSTPROCESSING");a.wb=!0;a.Ea=!1;var b=ea.vc();S(a,b);N(a,"postprocessing/postprocessing.glslv","postprocessing/bloom_blur.glslf");P(a);return a};a.aH=function(){var a=e("BLOOM");a.Ea=!1;a.wb=!0;var b=ea.vc();S(a,b);N(a,"postprocessing/postprocessing.glslv","postprocessing/bloom_combine.glslf");
P(a);return a};a.bI=function(){var a=e("VELOCITY");a.Ea=!1;a.wb=!0;var b=ea.vc();S(a,b);N(a,"postprocessing/postprocessing.glslv","postprocessing/velocity.glslf");P(a);return a};a.XG=function(){var a=e("ANCHOR_VISIBILITY");a.Ea=!0;a.wb=!0;a.Mf=Z.sx;N(a,"anchors.glslv","anchors.glslf");var b=ea.Ez(1);S(a,b);z(a,"ANCHOR_NUM",1);P(a);a.xj=new Float32Array(3);return a};a.qH=function(){var a=e("PERFORMANCE");a.Ea=!1;a.wb=!0;var b=ea.vc();S(a,b);N(a,"postprocessing/postprocessing.glslv","postprocessing/performance.glslf");
z(a,"POST_EFFECT","POST_EFFECT_X_BLUR");P(a);return a};a.ON=function(a,b){var c=b.length/3;if(c!=a.xj.length/3){var d=ea.Ez(c);S(a,d);z(a,"ANCHOR_NUM",c);P(a)}a.xj=b};a.Fu=function(a){if(!a.C.length)return null;a=a.C[0];return a.P.length?a.P[0]:null};a.Ma=da;a.Le=U;a.xR=ga;a.PP=function(a,b){for(var c=a.C[0].P,d=0;d<c.length;d++)if(c[d].type==b)return!0;return!1};a.Gy=function(a){for(var b=a.T,c=0;c<b.length;c++){var d=b[c];d.ld&&aa.mI(d.Wa)}a.aa.ld&&Z.NG(a.aa);a.ld&&a.Vd.length&&Ia.QG(a);a.La.ld&&
qa.PG(a.La);a.Ji&&(b=ja.Sz(a.Ji))&&b.Fy&&ja.OG(a.Ji)};a.inherit_material=function(a,b,c,d){for(var e=["MAIN","SHADOW","COLOR_ID"],f=!1,g=0;g<e.length;g++){var h=e[g],k=da(a,b,h),l=da(c,d,h);if(k&&l){var f=!0,m=U(c,d,h);"MAIN"==h&&(ga(l,k),m&&ga(m,k));for(h=0;h<l.Uc.length;h++){var n=l.Uc[h];if(-1!==Oa.indexOf(n)){var q=k.Uc.indexOf(n);-1!==q&&(l.T[h]=k.T[q],m&&(n=m.Uc.indexOf(n),-1!==n&&(m.T[n]=k.T[q])))}}}}f||O.error("Wrong objects for inheriting material!")};a.set_nodemat_value=function(a,b,c,d){for(var e=
0;e<a.C.length;e++)for(var f=a.C[e].P,g=0;g<f.length;g++){var h=f[g];-1!=h.lc.indexOf(b)&&h.Bh&&(h.Bh[c]=d)}};a.set_nodemat_rgb=function(a,b,c,d,e,f){for(var g=0;g<a.C.length;g++)for(var h=a.C[g].P,k=0;k<h.length;k++){var l=h[k];-1!=l.lc.indexOf(b)&&l.Nd&&(l.Nd[3*c]=d,l.Nd[3*c+1]=e,l.Nd[3*c+2]=f)}};a.get_nodemat_value=function(a,b){return a.Bh[b]};a.get_nodemat_rgb=function(a,b,c){c[0]=a.Nd[3*b];c[1]=a.Nd[3*b+1];c[2]=a.Nd[3*b+2];return c};a.Il=function(a,b){var c;c=b[1];for(var d=2;d<b.length;d++)c+=
"%join%"+b[d];for(d=0;d<a.length;d+=2)if(a[d]==c)return a[d+1];return null};a.cleanup=function(){Ba={}}};b4w.module.__nodemat=function(a,p){function e(a,b,k,n,q){var u=Ea.get_active(),u=h(b,q,u.uuid);if(u in va)return va[u];var w={Oa:null,id:u,Fy:!0};if("SHADOW"!=q&&"COLOR_ID"!=q){b=J.create();for(var p=a.nodes,z=0;z<p.length;z++)if(null==S(b,p[z],0,n,q))return va[u]=null,w;if(k&&-1==v(a,b,"GROUP_OUTPUT","group"))return w;z=ra(b);p=k?a.links:a.links.slice();if(!ja(b,p,z))return w;if(k)return w.Oa=b,w;for(z=0;z<p.length;z++){k=p[z];for(var x=l(k.from_node,b),L=l(k.to_node,b),y=0;y<x.length;y++)for(var C=
0;C<L.length;C++){var A=x[y],V=L[C],I=J.Na(b,A),F=J.Na(b,V);if(!Z(b,A,V,I,F,k))return va[u]=null,w}}d(b);a="GLOW"==q?v(a,b,"B4W_GLOW_OUTPUT","material",!0):v(a,b,"OUTPUT","material",!1,!0);-1==a&&(b=g(),a=0);f(b);a=J.ss(b,a,J.zp);c(a,n);m(a);D(a);t(a);B(a,n,q);Ia(a)}else n=e(a,b,k,n,"MAIN"),n=J.clone(n.Oa,function(a){var b=ia.An(a);b.H=ia.I(a.H);b.Qa=ia.I(a.Qa);return b}),a=v(a,n,"OUTPUT","material",!1,!0),r(n,a),a=J.ss(n,a,J.zp),m(a);w.Oa=a;return va[u]=w}function c(a,c){var d=[];J.ma(a,function(a,
b){"MATERIAL"!=b.type&&"MATERIAL_EXT"!=b.type||d.push({oL:a,node:b})});for(var e=0;e<d.length;++e){var f=d[e].oL,g=d[e].node,h=J.ho(a);J.ll(a,h,g.data.YK);var k=J.ho(a);J.ll(a,k,g.data.ZK);J.qd(a,h,k,[4,2]);for(var l={5:["LIGHTING_APPLY",10],6:["LIGHTING_APPLY",6],7:["MATERIAL_END",3],8:["MATERIAL_END",4],9:["MATERIAL_END",5]},m=J.br(a,f),n=[],q=[],t=[],r={},v=0;v<m;v++){var u=J.hk(a,f,v);u in r||(r[u]=0);var w=J.Ne(a,u,f,r[u]++);n.push([u,f,w]);var p=l[w[1]];if(p)switch(p[0]){case "MATERIAL_END":q.push([u,
k,[w[0],p[1]]]);break;case "LIGHTING_APPLY":t.push([u,[w[0],p[1]]])}else q.push([u,h,w])}b(a,g.data.value,h,k,t,c);for(v=0;v<n.length;v++)J.bs(a,n[v][0],n[v][1],n[v][2]);for(v=0;v<q.length;v++)J.qd(a,q[v][0],q[v][1],q[v][2]);g=J.Kg(a,f);h=[];l=[];m={};for(v=0;v<g;v++)n=J.Bg(a,f,v),n in m||(m[n]=0),w=J.Ne(a,f,n,m[n]++),h.push([f,n,w]),l.push([k,n,w]);for(v=0;v<h.length;v++)J.bs(a,h[v][0],h[v][1],h[v][2]);for(v=0;v<l.length;v++)J.qd(a,l[v][0],l[v][1],l[v][2]);J.ag(a,f)}}function b(a,b,c,d,e,f){var g=
{name:"LIGHTING_AMBIENT",type:"LIGHTING_AMBIENT"},h=S(a,g,0,f,null),k=h;n(a,c,h,"E");n(a,c,h,"A");n(a,c,h,"D");h=Ea.get_active();h=ca.yb(h,"LAMP",ca.DATA_ID_ALL);if(!b.Td)for(var l,m,q,t=0;t<h.length;t++){q=h[t].Pa;g={name:"LIGHTING_LAMP",type:"LIGHTING_LAMP"};l=S(a,g,0,f,null);g={name:"LIGHTING_APPLY",type:"LIGHTING_APPLY"};m=S(a,g,0,f,null);n(a,k,m,"color");n(a,k,m,"specular");n(a,l,m,"ldir");n(a,c,m,"normal");n(a,c,m,"D");n(a,c,m,"S");n(a,l,m,"lcolorint");n(a,c,l,"shadow_factor");k="COOKTORR"==
b.rm?"SPECULAR_PHONG":"SPECULAR_"+b.rm;g={name:k,type:k,use_tangent_shading:b.Uk};k=S(a,g,0,f,null);n(a,l,k,"ldir");n(a,l,k,"lfac");n(a,c,k,"normal");n(a,k,m,"sfactor");n(a,l,k,"norm_fac");n(a,c,k,"sp_params");k="HEMI"==q.type?"DIFFUSE_LAMBERT":"DIFFUSE_"+b.Pn;g={name:k,type:k,use_tangent_shading:b.Uk};q=S(a,g,0,f,null);n(a,l,q,"ldir");n(a,l,q,"lfac");n(a,c,q,"normal");n(a,l,q,"norm_fac");n(a,q,m,"lfactor");"DIFFUSE_LAMBERT"!=k&&n(a,c,q,"dif_params");for(l=0;l<e.length;l++)J.qd(a,e[l][0],m,e[l][1]);
k=m}n(a,k,d,"color");n(a,k,d,"specular")}function n(a,b,c,d){for(var e=J.Na(a,b),f=J.Na(a,c),g,h=0;h<f.H.length;h++)if(d==f.H[h].identifier){g=h;break}for(var k,h=0;h<e.Qa.length;h++)if(d==e.Qa[h].identifier){k=h;break}void 0!=g&&void 0!=k&&J.qd(a,b,c,[k,g])}function h(a,b,c){switch(b){case "GLOW":return a+c+"11";case "COLOR_ID":case "SHADOW":return a+c+"00";default:return a+c+"10"}}function r(a,b){J.gg(a,function(c,d,e){var f=J.Na(a,d);d==b&&"Color"==f.H[e[1]].identifier&&J.bs(a,c,d,e)})}function g(){var a=
J.create(),b={data:null,Ob:[],V:[],H:[{hb:new Float32Array([0,0,0]),identifier:"Color",dc:!1,name:"Color"},{hb:1,identifier:"Alpha",dc:!1,name:"Alpha"}],Qa:[],type:"OUTPUT",pj:[]};J.ll(a,0,b);return a}function m(a){J.ma(a,function(b,c){for(var d=c.H,e=c.Qa,f=0;f<d.length;f++)q(a,d[f],b,f,1);for(f=0;f<e.length;f++)q(a,e[f],b,f,0)})}function q(a,b,c,d,e){if(b.dc){var f=!0;J.gg(a,function(a,b,g){if(!e&&a==c&&g[0]==d||e&&b==c&&g[1]==d)f=!1});f&&(b.dc=!1)}}function B(a,b,c){var d=[];J.gg(a,function(e,
f,g){var h=J.Na(a,e),k=J.Na(a,f),h=ia.is_vector(h.Qa[g[0]].hb),k=ia.is_vector(k.H[g[1]].hb);if(h!=k){var l,m={default_value:[0,0,0],identifier:"Vector",is_linked:!0,name:"Vector"},n={default_value:0,identifier:"Value",is_linked:!0,name:"Value"};h&&!k?l=z("vector_to_scalar","B4W_VECTOSCAL",[m],[n]):!h&&k&&(l=z("scalar_to_vector","B4W_SCALTOVEC",[n],[m]));S(a,l,0,b,c);d.push([e,f,a.N[a.N.length-2],g])}});for(var e=0;e<d.length;++e)J.bs(a,d[e][0],d[e][1],d[e][3]),J.qd(a,d[e][0],d[e][2],[d[e][3][0],0]),
J.qd(a,d[e][2],d[e][1],[0,d[e][3][1]])}function d(a){var b=[];J.ma(a,function(c,d){switch(d.type){case "B4W_TRANSLUCENCY":J.gg(a,function(e,f,g){var h=J.Na(a,f);e==c&&"MATERIAL_EXT"==h.type&&"Translucency"==d.Qa[g[0]].name&&b.push(e,f,[g[0]+1,g[1]+1])})}});for(var c=0;c<b.length;c+=3)J.qd(a,b[c],b[c+1],b[c+2])}function l(a,b){var c=[];J.ma(b,function(b,d){d.name==a.name&&c.push(b)});if(c.length)return c;ia.q("Node not found")}function f(a){var b=[];J.ma(a,function(a,c){"B4W_PARALLAX"!=c.type&&"REROUTE"!=
c.type||b.push(a,c)});for(var c=0;c<b.length;c+=2){var d=b[c],e=b[c+1];if("B4W_PARALLAX"==e.type){var f=H(a,d);if(-1!=f){var g=J.hk(a,f,0);J.Yi(a,f,d,-1);-1!=g&&J.Yi(a,g,f,-1);d=J.Na(a,f);e.data=d.data;e.V[0]=d.V[0];J.ag(a,f)}e.H.splice(1,1)}else if("REROUTE"==e.type){for(var e=J.hk(a,d,0),h=J.Kg(a,d),f=[],g=[],k=[],l=0;l<h;l++){var m=J.Bg(a,d,l),n=g.indexOf(m);-1!=n?k[n]+=1:(g.push(m),k.push(1),f.push(d,m))}if(-1!=e)for(h=J.Ne(a,e,d,0)[0],l=0;l<g.length;l++)for(m=0;m<k[l];m++)n=J.Ne(a,d,g[l],m)[1],
J.qd(a,e,g[l],[h,n]);for(l=0;l<f.length;l+=2)J.Yi(a,f[l],f[l+1],-1)}}}function H(a,b){for(var c=a.Aa,d=0;d<c.length;d+=3)if(c[d+1]==b&&1==c[d+2][1])return c[d];return-1}function D(a){E(a);G(a);w(a)}function w(a){var b=[],c="",d="",e={};J.ma(a,function(a,f){if("GEOMETRY_UV"==f.type||"UVMAP"==f.type||"TEX_COORD_UV"==f.type){b.push(a,f);var g=f.data.value;c?c==g||d||(d=g,e[d]=0):(c=g,e[c]=0);e[g]++}});for(var f in e)if(2>e[f]){for(var g=0;g<b.length;g+=2)b[g+1].data.value==f&&b.splice(g,2);delete e[f];
c==f&&(c=d,d="");d==f&&(d="")}if(!(3>b.length)){var g={default_value:[0,0,0],identifier:"UV_geom",is_linked:!1,name:"UV_geom"},h={default_value:[0,0,0],identifier:"UV_cycles",is_linked:!1,name:"UV_cycles"};f=z("merged_uv","UV_MERGED",[],[g,h]);f.uv_layer=c;S(a,f,0,"",void 0);var l=a.N[a.N.length-2];f=a.N[a.N.length-1];if(d){h=z("merged_uv","UV_MERGED",[],[g,h]);h.uv_layer=d;S(a,h,0,"",void 0);var m=a.N[a.N.length-2],h=a.N[a.N.length-1]}else h=null;for(var n=-1,q=null,g=0;g<b.length;g+=2){var t=b[g],
r=b[g+1];k(r,b[1])?(n=l,q=f):h&&(n=m,q=h);for(var v=[],u=J.Kg(a,t),w={},p=0;p<u;p++){var B=J.Bg(a,t,p);B in w||(w[B]=0);var x=J.Ne(a,t,B,w[B]++);v.push(t,B,x);x=x.splice(0,x.length);switch(r.type){case "GEOMETRY_UV":x[0]=0;q.Qa[0].dc=!0;break;case "UVMAP":case "TEX_COORD_UV":x[0]=1,q.Qa[1].dc=!0}J.qd(a,n,B,x)}for(var p=0;p<v.length;p+=3)J.Yi(a,v[p],v[p+1],0);J.ag(a,t)}}}function E(a){var b=[];J.ma(a,function(a,c){"GEOMETRY_VC"!=c.type&&"GEOMETRY_NO"!=c.type&&"GEOMETRY_FB"!=c.type&&"GEOMETRY_VW"!=
c.type&&"GEOMETRY_GL"!=c.type&&"GEOMETRY_LO"!=c.type&&"GEOMETRY_OR"!=c.type||b.push(a,c)});for(var c=[],d=0;d<b.length;d+=2){for(var e=b[d],f=b[d+1],g=!0,h=0;h<c.length;h++){var k=c[h];if(x(f,k.Ee)){g=[];h=J.Kg(a,e);for(n=0;n<h;n++){var l=J.Bg(a,e,n),m=J.Ne(a,e,l,0);g.push(e,l,m);J.qd(a,k.id,l,m)}for(var n=0;n<g.length;n+=3)J.Yi(a,g[n],g[n+1],0);J.ag(a,e);g=!1;break}}g&&(k={id:e,Ee:f},c.push(k))}}function y(a){for(var b={},c=0;c<a.N.length;c+=2){var d=a.N[c];b[d]={hn:{},jA:!1}}for(c=0;c<a.Aa.length;c+=
3)b[a.Aa[c+1]].hn[a.Aa[c]]=!0;for(d in b)A(d,b);for(d in b)b[d]=Object.keys(b[d].hn).map(function(a){return parseInt(a)});return b}function A(a,b){var c=b[a];if(!c.jA){var d=ia.I(c),e;for(e in c.hn){A(e,b);var c=b[e],f;for(f in c.hn)d.hn[f]=!0}d.jA=!0;b[a]=d}}function G(a){var b=[];J.ma(a,function(a,c){"TEXTURE_COLOR"!=c.type&&"TEXTURE_NORMAL"!=c.type||b.push(a,c)});if(b.length){for(var c=y(a),d=[],e=0;e<b.length;e+=2){for(var f=b[e],g=b[e+1],h=!0,k=0;k<d.length;k++){var l=d[k];if(!(3<=l.Xl.length||
!x(g,l.Ee)||-1<c[f].indexOf(l.id)||-1<c[l.id].indexOf(f))){for(var m=!1,n=0;n<l.Xl.length;n++){var q=l.Xl[n].id;if(-1<c[f].indexOf(q)||-1<c[q].indexOf(f)){m=!0;break}}if(!m){for(var k=[],q=J.br(a,f),t={},n=0;n<q;n++)m=J.hk(a,f,n),m in t||(t[m]=0),h=J.Ne(a,m,f,t[m]++),k.push(m,f,h);for(var q=[],t=J.Kg(a,f),r={},n=0;n<t;n++)m=J.Bg(a,f,n),m in r||(r[m]=0),h=J.Ne(a,f,m,r[m]++),q.push(f,m,h);h=k.concat(q);for(n=0;n<h.length;n+=3)J.Yi(a,h[n],h[n+1],0);J.ag(a,f);n={id:f,Ee:g,xI:k,yI:q};l.Xl.push(n);h=!1;
break}}}h&&(l={id:f,Ee:g,Xl:[]},d.push(l))}for(e=0;e<d.length;e++){l=d[e];c=l.Xl.length;for(k=0;k<c;k++){g=l.Xl[k];n=g.Ee;f=g.xI;g=g.yI;l.Ee.H[k+1].dc=n.H[0].dc;l.Ee.H[k+1].hb=n.H[0].hb;l.Ee.Qa[2*(k+1)].dc=n.Qa[0].dc;l.Ee.Qa[2*(k+1)].hb=n.Qa[0].hb;l.Ee.Qa[2*(k+1)+1].dc=n.Qa[1].dc;l.Ee.Qa[2*(k+1)+1].hb=n.Qa[1].hb;for(n=0;n<f.length;n+=3)m=f[n],h=f[n+2],h[1]+=k+1,J.qd(a,m,l.id,h);for(n=0;n<g.length;n+=3)m=g[n+1],h=g[n+2],h[0]+=2*(k+1),J.qd(a,l.id,m,h);l.Ee.Ob.push(["USE_uv"+(k+2),1])}J.ag(a,l.id);J.ll(a,
l.id,l.Ee)}}}function x(a,b){if(a.type!==b.type)return!1;switch(a.type){case "GEOMETRY_VC":return a.data.value==b.data.value;case "GEOMETRY_NO":case "GEOMETRY_FB":case "GEOMETRY_VW":case "GEOMETRY_GL":case "GEOMETRY_LO":case "GEOMETRY_OR":return!0;case "TEXTURE_COLOR":case "TEXTURE_NORMAL":return a.data.value.uuid==b.data.value.uuid;default:return!1}}function k(a,b){var c=["GEOMETRY_UV","TEX_COORD_UV","UVMAP"];return-1!=c.indexOf(a.type)&&-1!=c.indexOf(b.type)?a.data.value==b.data.value:!1}function t(a){var b=
[],c=[];J.ma(a,function(a,d){"GEOMETRY_VC"==d.type&&b.push(a,d);"GEOMETRY_VW"==d.type&&c.push(a,d)});M(a,b);u(a,c)}function M(a,b){for(var c=0;c<b.length;c+=2){for(var d=b[c],e=b[c+1],f=!1,g=[],h=[],k=[[],[],[]],l=J.Kg(a,d),m=0;m<l;m++){var n=J.Bg(a,d,m);if("SEPRGB"!=J.Na(a,n).type){f=!1;break}g.push(d,n);for(var q={},t=J.Kg(a,n),f=0;f<t;f++){var r=J.Bg(a,n,f);r in q||(q[r]=0);var v=J.Ne(a,n,r,q[r]++);g.push(n,r);k[v[0]].push(d,r,v)}h.push(n);f=!0}if(f){for(m=d=l=0;m<k.length;m++)k[m].length&&(l++,
d|=1<<2-m);if(l){e.type+=l;e.Qa=[];for(m=0;m<k.length;m++)if(k[m].length)for(e.Qa.push({hb:0,identifier:"RGB"[m],dc:!0,name:"RGB"[m]}),f=0;f<k[m].length;f+=3)k[m][f+2][0]=ia.jm(d,m);for(m=0;m<g.length;m+=2)J.Yi(a,g[m],g[m+1],0);for(m=0;m<h.length;m++)J.ag(a,h[m]);for(m=0;m<k.length;m++)for(f=0;f<k[m].length;f+=3)J.qd(a,k[m][f],k[m][f+1],k[m][f+2])}}}}function u(a,b){for(var c=0;c<b.length;c+=2){for(var d=b[c],e=!0,f=[],g=J.Kg(a,d),h=0;h<g;h++){var k=J.Bg(a,d,h);if("B4W_REFLECT"==J.Na(a,k).type){var l=
J.Ne(a,d,k,0),m=J.Ne(a,d,k,1);l&&1==l[1]||m&&1==m[1]?e=!1:f.push(d,k)}else e=!1}for(h=0;h<f.length;h+=2)g=a,l=f[h],k=f[h+1],m=J.Na(g,k),m.type+="_WORLD",J.Yi(g,l,k,0),m.H.splice(0,1),l=J.hk(g,k,0),l!=J.ft&&(J.Ne(g,l,k,0)[1]=0);e&&J.ag(a,d)}}function v(a,b,c,d,e,f){a=a.nodes;for(var g=null,h=0;h<a.length;h++){var k=a[h];e?"GROUP"==k.type&&k.node_tree_name==c&&(g=k):k.type==c&&(g=k)}return g?l(g,b)[0]:(f||pa.error('No "'+c+'" node in node '+d),-1)}function z(a,b,c,d){return{name:a,type:b,inputs:c,outputs:d}}
function S(a,b,c,d,e){var f=b.name,g=b.type,h=[],k=[],l=[],m=[],n=null,q=[];switch(g){case "BSDF_ANISOTROPIC":case "BSDF_DIFFUSE":case "BSDF_GLOSSY":case "BSDF_GLASS":case "BSDF_HAIR":case "BSDF_TRANSPARENT":case "BSDF_TRANSLUCENT":case "BSDF_REFRACTION":case "BSDF_TOON":case "BSDF_VELVET":case "SUBSURFACE_SCATTERING":case "EMISSION":case "AMBIENT_OCCLUSION":case "VOLUME_ABSORPTION":case "VOLUME_SCATTER":case "BUMP":case "BLACKBODY":case "WAVELENGTH":case "SEPXYZ":case "COMBXYZ":case "LIGHT_FALLOFF":case "TEX_IMAGE":case "TEX_ENVIRONMENT":case "TEX_SKY":case "TEX_NOISE":case "TEX_WAVE":case "TEX_MUSGRAVE":case "TEX_GRADIENT":case "TEX_MAGIC":case "TEX_CHECKER":case "TEX_BRICK":case "WIREFRAME":case "LAYER_WEIGHT":case "TANGENT":case "LIGHT_PATH":case "ATTRIBUTE":case "HOLDOUT":case "HAIR_INFO":case "OBJECT_INFO":case "SCRIPT":case "NEW_GEOMETRY":k=
la(b);l=O(b);pa.warn(g+" node is not fully supported.");break;case "BRIGHTCONTRAST":case "ADD_SHADER":case "MIX_SHADER":k=la(b);l=O(b);break;case "UVMAP":var t=b.uv_layer;t||(g="EMPTY_UV");if("EMPTY_UV"!=g){var n=K("param_"+g+"_a"),r=K("param_"+g+"_v");h.push(Q(n));h.push(Q(r));m.push(Q(r));n={name:n,value:t}}l=O(b);break;case "UV_MERGED":n=K("param_UV_MERGED_a");r=K("param_UV_MERGED_v");h.push(Q(n));h.push(Q(r));l.push(U(b,"UV_geom"));l.push(U(b,"UV_cycles"));m.push(Q(r));n={name:n,value:b.uv_layer};
break;case "CAMERA":k=[];l=O(b);break;case "COMBRGB":case "COMBHSV":k=la(b);l=O(b);break;case "CURVE_RGB":case "CURVE_VEC":"CURVE_RGB"==g?(Aa(b,0,0)&&q.push(["READ_R",1]),Aa(b,1,0)&&q.push(["READ_G",1]),Aa(b,2,0)&&q.push(["READ_B",1]),Aa(b,3,0)&&q.push(["READ_A",1])):(Aa(b,0,-1)&&q.push(["READ_R",1]),Aa(b,1,-1)&&q.push(["READ_G",1]),Aa(b,2,-1)&&q.push(["READ_B",1]));k=la(b);l=O(b);n={value:b};break;case "PARTICLE_INFO":k=la(b);l=O(b);for(r=0;r<b.outputs.length;r++){var v=b.outputs[r],u=v.identifier,
w=Q("v_param_PART_INFO_"+u.replace(" ",""));if(v.is_linked)switch(u){case "Size":q.push(["PART_INFO_SIZE",fa.D(1)]);break;case "Age":q.push(["PART_INFO_AGE",fa.D(1)]);break;case "Lifetime":q.push(["PART_INFO_LT",fa.D(1)]);break;case "Location":q.push(["PART_INFO_LOC",fa.D(1)]);break;case "Index":n=t=Q("a_param_PART_INFO_"+v.identifier.replace(" ",""));q.push(["PART_INFO_IND",fa.D(1)]);break;case "Velocity":q.push(["PART_INFO_VEL",fa.D(1)]);break;case "Angular Velocity":q.push(["PART_INFO_A_VEL",fa.D(1)])}"Age"!=
u&&"Lifetime"!=u&&"Size"!=u&&(h.push(w),m.push(w))}t&&h.push(t);break;case "GEOMETRY":if(!X(b))return!0;g=N(b,c);if(!g)return pa.error("Geometry output is not supported"),null;switch(g){case "GEOMETRY_UV":(t=b.uv_layer)||(g="EMPTY_UV");"EMPTY_UV"!=g&&(n=K("param_GEOMETRY_UV_a"),r=K("param_GEOMETRY_UV_v"),h.push(Q(n)),h.push(Q(r)),m.push(Q(r)),n={name:n,value:t});l.push(U(b,"UV"));break;case "GEOMETRY_VC":(t=b.color_layer)||(g="EMPTY_VC");"EMPTY_VC"!=g&&(n=K("param_GEOMETRY_VC_a"),r=K("param_GEOMETRY_VC_v"),
h.push(Q(n)),h.push(Q(r)),m.push(Q(r)),n={name:n,value:t});l.push(U(b,"Vertex Color"));break;case "GEOMETRY_NO":l.push(U(b,"Normal"));break;case "GEOMETRY_FB":l.push(U(b,"Front/Back"));break;case "GEOMETRY_VW":l.push(U(b,"View"));break;case "GEOMETRY_GL":l.push(U(b,"Global"));break;case "GEOMETRY_LO":l.push(U(b,"Local"));break;case "GEOMETRY_OR":t=K("param_GEOMETRY_OR_v"),h.push(Q(t)),l.push(U(b,"Orco")),m.push(Q(t))}break;case "TEX_COORD":if(!X(b))return!0;g=L(b,c);if(!g)return pa.error("Texture coordinate output is not supported"),
null;switch(g){case "TEX_COORD_UV":(t=b.uv_layer)||(g="EMPTY_UV");"EMPTY_UV"!=g&&(n=K("param_TEX_COORD_UV_a"),r=K("param_TEX_COORD_UV_v"),h.push(Q(n)),h.push(Q(r)),m.push(Q(r)),n={name:n,value:b.uv_layer});l.push(U(b,"UV"));break;case "TEX_COORD_NO":l.push(U(b,"Normal"));break;case "TEX_COORD_GE":t=K("param_TEX_COORD_GE_v");h.push(Q(t));l.push(U(b,"Generated"));m.push(Q(t));break;case "TEX_COORD_OB":l.push(U(b,"Object"));pa.warn('Output "Object" of node "Texture Coordinate" doesn\'t supported fully.');
break;case "TEX_COORD_CA":l.push(U(b,"Camera"));break;case "TEX_COORD_WI":l.push(U(b,"Window"));pa.warn('Output "Window" of node "Texture Coordinate" doesn\'t supported fully.');break;case "TEX_COORD_RE":l.push(U(b,"Reflection")),pa.warn('Output "Reflection" of node "Texture Coordinate" doesn\'t supported fully.')}break;case "GROUP":t=b.node_tree_name;switch(t){case "B4W_LINEAR_TO_SRGB":if(!C(b,[1],[1])){n=W(b,d,e);break}g="B4W_LINEAR_TO_SRGB";break;case "B4W_NORMAL_VIEW":case "B4W_VECTOR_VIEW":if(!C(b,
[1],[1])){n=W(b,d,e);break}g="B4W_VECTOR_VIEW";break;case "B4W_SRGB_TO_LINEAR":if(!C(b,[1],[1])){n=W(b,d,e);break}g="B4W_SRGB_TO_LINEAR";break;case "B4W_REFLECT":if(!C(b,[1,1],[1])){n=W(b,d,e);break}g="B4W_REFLECT";break;case "B4W_REFRACTION":if(!C(b,[1,0],[1])){n=W(b,d,e);break}g="B4W_REFRACTION";break;case "B4W_PARALLAX":if(!C(b,[1,1,0,0,0],[1])){n=W(b,d,e);break}g="B4W_PARALLAX";r=K("temp_texture");m.push(Q(r));break;case "B4W_CLAMP":if(!C(b,[1],[1])){n=W(b,d,e);break}g="B4W_CLAMP";break;case "B4W_TRANSLUCENCY":if(!C(b,
[0,0,0,0,0],[0])){n=W(b,d,e);break}g="B4W_TRANSLUCENCY";break;case "B4W_TIME":if(!C(b,[],[0])){n=W(b,d,e);break}g="B4W_TIME";break;case "B4W_SMOOTHSTEP":if(!C(b,[0,0,0],[0])){n=W(b,d,e);break}g="B4W_SMOOTHSTEP";break;case "B4W_GLOW_OUTPUT":g="B4W_GLOW_OUTPUT";break;default:n=W(b,d,e)}k=la(b);l=O(b);"B4W_TRANSLUCENCY"==t&&(t=T("TranslucencyParams","TranslucencyParams",[0,0,0,0]),t.dc=l[0].dc,l.push(t));break;case "LAMP":n=b.lamp;if(!n)return pa.error("There is no lamp in node: "+b.name),null;l.push(U(b,
"Color"));l.push(U(b,"Light Vector"));l.push(U(b,"Distance"));l.push(U(b,"Visibility Factor"));n.uuid in Fa?q.push(["LAMP_INDEX",String(Fa[n.uuid])]):(Fa[n.uuid]=Ja,q.push(["LAMP_INDEX",String(Ja++)]));n=Fa;break;case "LIGHTING_AMBIENT":k=[T("E","E",[0,0,0],!0),T("A","A",[0,0,0],!0),T("D","D",[0,0,0],!0)];l=[T("color","color",[0,0,0],!0),T("specular","specular",[0,0,0],!0)];break;case "LIGHTING_BEGIN":l=[T("E","E",[0,0,0],!0),T("A","A",[0,0,0],!0),T("D","D",[0,0,0],!0),T("S","S",[0,0,0],!0),T("normal",
"normal",[0,0,0],!0),T("dif_params","dif_params",[0,0],!0),T("sp_params","sp_params",[0,0],!0),T("shadow_factor","shadow_factor",0,!0),T("translucency_color","translucency_color",0,!0),T("translucency_params","translucency_params",[0,0,0,0],!0)];break;case "LIGHTING_END":k=[T("color","color",[0,0,0],!0),T("specular","specular",[0,0,0],!0)];break;case "LIGHTING_LAMP":k=[T("shadow_factor","shadow_factor",0,!0)];l=[T("ldir","ldir",[0,0,0],!0),T("lfac","lfac",[0,0],!0),T("lcolorint","lcolorint",[0,0,
0],!0),T("norm_fac","norm_fac",0,!0)];break;case "DIFFUSE_LAMBERT":k=[T("ldir","ldir",[0,0,0],!0),T("lfac","lfac",[0,0],!0),T("normal","normal",[0,0,0],!0),T("norm_fac","norm_fac",0,!0)];l=[T("lfactor","lfactor",0,!0)];b.use_tangent_shading&&q.push(["MAT_USE_TBN_SHADING",1]);break;case "DIFFUSE_FRESNEL":case "DIFFUSE_MINNAERT":case "DIFFUSE_OREN_NAYAR":case "DIFFUSE_TOON":k=[T("ldir","ldir",[0,0,0],!0),T("lfac","lfac",[0,0],!0),T("normal","normal",[0,0,0],!0),T("norm_fac","norm_fac",0,!0),T("dif_params",
"dif_params",[0,0],!0)];l=[T("lfactor","lfactor",0,!0)];b.use_tangent_shading&&q.push(["MAT_USE_TBN_SHADING",1]);break;case "SPECULAR_BLINN":case "SPECULAR_PHONG":k=[T("ldir","ldir",[0,0,0],!0),T("lfac","lfac",[0,0],!0),T("normal","normal",[0,0,0],!0),T("norm_fac","norm_fac",0,!0),T("sp_params","sp_params",[0,0],!0)];l=[T("sfactor","sfactor",0,!0)];b.use_tangent_shading&&q.push(["MAT_USE_TBN_SHADING",1]);break;case "SPECULAR_TOON":case "SPECULAR_WARDISO":k=[T("ldir","ldir",[0,0,0],!0),T("lfac","lfac",
[0,0],!0),T("normal","normal",[0,0,0],!0),T("norm_fac","norm_fac",0,!0),T("sp_params","sp_params",[0,0],!0)];l=[T("sfactor","sfactor",0,!0)];b.use_tangent_shading&&q.push(["MAT_USE_TBN_SHADING",1]);break;case "LIGHTING_APPLY":k=[T("color","color",[0,0,0,0],!0),T("specular","specular",[0,0,0],!0),T("lfactor","lfactor",0,!0),T("sfactor","sfactor",0,!0),T("ldir","ldir",[0,0,0],!0),T("normal","normal",[0,0,0],!0),T("translucency_params","translucency_params",[0,0,0,0],!0),T("D","D",[0,0,0],!0),T("S",
"S",[0,0,0],!0),T("lcolorint","lcolorint",[0,0,0],!0),T("translucency_color","translucency_color",0,!0)];l=[T("color","color",[0,0,0,0],!0),T("specular","specular",[0,0,0],!0)];break;case "NORMAL":k=la(b);l=O(b);t=U(b,"Normal");m.push(Q(K("param_NORMAL_Normal"),t.hb,3));break;case "MAPPING":t=b.vector_type;g="MAPPING";k.push(da(b,"Vector"));l.push(U(b,"Vector"));var r=ia.f32(b.rotation),v=ia.f32(b.scale),u=ia.f32(b.translation),w=aa.create(),p=ia.FI(r);"TEXTURE"==t&&(v[0]=v[0]||1,v[1]=v[1]||1,v[2]=
v[2]||1);var z=new Float32Array([v[0],0,0,0,v[1],0,0,0,v[2]]);aa.multiply(p,z,w);w=ia.XK(w,V.create());switch(t){case "POINT":w[12]=u[0];w[13]=u[1];w[14]=u[2];break;case "TEXTURE":w[12]=u[0];w[13]=u[1];w[14]=u[2];w=V.invert(w,w);break;case "NORMAL":V.invert(w,w),V.transpose(w,w)}switch(t){case "NORMAL":q.push(["MAPPING_IS_NORMAL",1]);case "TEXTURE":q.push(["MAPPING_TRS_MATRIX",fa.D(w,16)]);break;case "POINT":0!==na.length(r)?q.push(["MAPPING_TRS_MATRIX",fa.D(w,16)]):(0!==na.length(v)&&q.push(["MAPPING_SCALE",
fa.D(v,3)]),0!==na.length(u)&&q.push(["MAPPING_TRANSLATION",fa.D(u,3)]));break;case "VECTOR":0!==na.length(r)?q.push(["MAPPING_TRS_MATRIX",fa.D(w,16)]):0!==na.length(v)&&q.push(["MAPPING_SCALE",fa.D(v,3)])}b.use_min&&q.push(["MAPPING_MIN_CLIP",fa.D(b.min,3)]);b.use_max&&q.push(["MAPPING_MAX_CLIP",fa.D(b.max,3)]);break;case "MATERIAL":case "MATERIAL_EXT":n=[];t=[];r=[];v=[T("E","E",[0,0,0],!0),T("A","A",[0,0,0],!0),T("D","D",[0,0,0],!0),T("S","S",[0,0,0],!0),T("normal","normal",[0,0,0],!0),T("dif_params",
"dif_params",[0,0],!0),T("sp_params","sp_params",[0,0],!0),T("shadow_factor","shadow_factor",0,!0)];u=[T("color","color",[0,0,0],!0),T("specular","specular",[0,0,0],!0),T("normal","normal",[0,0,0],!0)];w=[U(b,"Color"),U(b,"Alpha"),U(b,"Normal")];p=[];z=da(b,"Color");z.hb.splice(3);r.push(z);k.push(z);z=da(b,"Spec");z.hb.splice(3);r.push(z);k.push(z);(z=da(b,"DiffuseIntensity"))||(z=da(b,"Refl"));z.hb=b.diffuse_intensity;r.push(z);k.push(z);var B=da(b,"Normal");B.hb.splice(3);r.push(B);k.push(B);"MATERIAL_EXT"==
g?((z=da(b,"Emit"))||(z=T("Emit","Emit",0)),r.push(z),k.push(z),(z=da(b,"Translucency"))?(z.hb=0,z.name="Translucency",z.identifier="Translucency"):z=T("Translucency","Translucency",0),k.push(z),(z=da(b,"Translucency"))?(z.hb=[0,0,0,0],z.name="TranslucencyParams",z.identifier="TranslucencyParams"):z=T("TranslucencyParams","TranslucencyParams",[0,0,0,0]),k.push(z),l=da(b,"Reflectivity"),z=da(b,"Ray Mirror"),l?(z=l,l="Reflectivity"):z?l="Ray Mirror":(z=l,l="Reflectivity"),z||(z=T(l,l,0)),k.push(z),
u.push(z),(z=da(b,"SpecTra"))||(z=T("SpecTra","SpecTra",0)),k.push(z),u.push(z),(z=da(b,"Alpha"))||(z=T("Alpha","Alpha",b.alpha)),k.push(z),u.push(z),w.push(U(b,"Diffuse")),w.push(U(b,"Spec")),n.push(["MATERIAL_EXT",1]),t.push(["MATERIAL_EXT",1])):(r.push(T("emit_intensity","emit_intensity",0)),u.push(T("reflect_factor","reflect_factor",0)),u.push(T("specular_alpha","specular_alpha",0)),u.push(T("alpha_in","alpha_in",0)),w.push(T("diffuse_out","diffuse_out",0)),w.push(T("spec_out","spec_out",0)),
n.push(["MATERIAL_EXT",0]),t.push(["MATERIAL_EXT",0]));p.push(Q(K("param_MATERIAL_alpha"),b.alpha));p.push(Q(K("param_MATERIAL_spec_alpha"),b.specular_alpha));l=w;B.dc&&n.push(["USE_MATERIAL_NORMAL",1]);b.use_diffuse&&(n.push(["USE_MATERIAL_DIFFUSE",1]),t.push(["USE_MATERIAL_DIFFUSE",1]));b.use_specular&&t.push(["USE_MATERIAL_SPECULAR",1]);var z=[],x=0;switch(b.specular_shader){case "COOKTORR":case "PHONG":B=b.specular_hardness;break;case "WARDISO":B=b.specular_slope;break;case "TOON":B=b.specular_toon_size;
x=b.specular_toon_smooth;break;case "BLINN":B=b.specular_ior;x=b.specular_hardness;break;default:pa.error("unsupported specular shader: "+b.specular_shader+' (material "'+b.material_name+'")'),B=b.specular_hardness}var D,y;switch(b.diffuse_shader){case "LAMBERT":y=D=0;break;case "OREN_NAYAR":D=b.roughness;y=0;break;case "FRESNEL":D=b.diffuse_fresnel;y=b.diffuse_fresnel_factor;break;case "MINNAERT":D=b.darkness;y=0;break;case "TOON":D=b.diffuse_toon_size;y=b.diffuse_toon_smooth;break;default:pa.error("unsupported diffuse shader: "+
b.diffuse_shader+' (material "'+b.material_name+'")'),y=D=0}z.push(Q(K("param_MATERIAL_diffuse"),[D,y],2));z.push(Q(K("param_MATERIAL_spec"),[b.specular_intensity,B,x],3));n.push(["SHADELESS_MAT",b.use_shadeless?1:0]);B={name:b.name,value:{rm:b.specular_shader,Pn:b.diffuse_shader,Td:b.use_shadeless,Uk:b.use_tangent_shading}};n={name:b.name,value:{rm:b.specular_shader,Pn:b.diffuse_shader,Td:b.use_shadeless,Uk:b.use_tangent_shading},YK:{name:"material_begin",type:"MATERIAL_BEGIN",H:r,Qa:v,V:z,data:B,
Ob:n,pj:[]},ZK:{name:"material_end",type:"MATERIAL_END",H:u,Qa:w,V:p,data:B,Ob:t,pj:[]}};break;case "MATH":switch(b.operation){case "ADD":g="MATH_ADD";break;case "SUBTRACT":g="MATH_SUBTRACT";break;case "MULTIPLY":g="MATH_MULTIPLY";break;case "DIVIDE":g="MATH_DIVIDE";break;case "SINE":g="MATH_SINE";break;case "COSINE":g="MATH_COSINE";break;case "TANGENT":g="MATH_TANGENT";break;case "ARCSINE":g="MATH_ARCSINE";break;case "ARCCOSINE":g="MATH_ARCCOSINE";break;case "ARCTANGENT":g="MATH_ARCTANGENT";break;
case "POWER":g="MATH_POWER";break;case "LOGARITHM":g="MATH_LOGARITHM";break;case "MINIMUM":g="MATH_MINIMUM";break;case "MAXIMUM":g="MATH_MAXIMUM";break;case "ROUND":g="MATH_ROUND";break;case "LESS_THAN":g="MATH_LESS_THAN";break;case "GREATER_THAN":g="MATH_GREATER_THAN";break;case "MODULO":g="MATH_MODULO";break;case "ABSOLUTE":g="MATH_ABSOLUTE";break;default:return pa.error("Unsupported MATH operation: "+b.operation),null}q.push(["MATH_USE_CLAMP",Number(b.use_clamp)]);k=la(b);l=O(b);break;case "MIX_RGB":switch(b.blend_type){case "MIX":g=
"MIX_RGB_MIX";break;case "ADD":g="MIX_RGB_ADD";break;case "MULTIPLY":g="MIX_RGB_MULTIPLY";break;case "SUBTRACT":g="MIX_RGB_SUBTRACT";break;case "SCREEN":g="MIX_RGB_SCREEN";break;case "DIVIDE":g="MIX_RGB_DIVIDE";break;case "DIFFERENCE":g="MIX_RGB_DIFFERENCE";break;case "DARKEN":g="MIX_RGB_DARKEN";break;case "LIGHTEN":g="MIX_RGB_LIGHTEN";break;case "OVERLAY":g="MIX_RGB_OVERLAY";break;case "DODGE":g="MIX_RGB_DODGE";break;case "BURN":g="MIX_RGB_BURN";break;case "HUE":g="MIX_RGB_HUE";break;case "SATURATION":g=
"MIX_RGB_SATURATION";break;case "VALUE":g="MIX_RGB_VALUE";break;case "COLOR":g="MIX_RGB_COLOR";break;case "SOFT_LIGHT":g="MIX_RGB_SOFT_LIGHT";break;case "LINEAR_LIGHT":g="MIX_RGB_LINEAR_LIGHT";break;default:return pa.error("Unsupported MIX_RGB blend type: "+b.blend_type),null}q.push(["MIX_RGB_USE_CLAMP",Number(b.use_clamp)]);k=la(b);l=O(b);break;case "OUTPUT":k=la(b);l=[];break;case "RGB":t=b.name;t={name:"-1",value:t};m.push(t);l.push(U(b,"Color"));break;case "SEPRGB":case "SEPHSV":k=la(b);l=O(b);
break;case "TEXTURE":g=P(b);if("TEXTURE_EMPTY"==g)l.push(U(b,"Color")),l.push(U(b,"Normal")),l.push(U(b,"Value"));else if("TEXTURE_ENVIRONMENT"==g)k.push(da(b,"Vector")),l.push(U(b,"Color")),l.push(U(b,"Value"));else{if("TEXTURE_NORMAL"==g&&"ENVIRONMENT_MAP"==b.texture.type)return pa.error("Wrong output for ENVIRONMENT_MAP texture: "+b.name),null;for(n=0;4>n;++n)n?(z=T("Vector"+n,"Vector"+n,[0,0,0]),"TEXTURE_COLOR"==g&&(r=T("Color"+n,"Color"+n,[0,0,0]),v=T("Value"+n,"Value"+n,0),t=b.texture.image,
u=!1,t&&"Non-Color"==t.colorspace_settings_name&&(u=!0),q.push(["NON_COLOR",Number(u)])),"TEXTURE_NORMAL"==g&&(r=T("Normal"+n,"Normal"+n,[0,0,0]),v=T("Value"+n,"Value"+n,0))):(z=da(b,"Vector"),"TEXTURE_COLOR"==g&&(r=U(b,"Color"),v=U(b,"Value"),t=b.texture.image,u=!1,t&&"Non-Color"==t.colorspace_settings_name&&(u=!0),q.push(["NON_COLOR",Number(u)])),"TEXTURE_NORMAL"==g&&(r=U(b,"Normal"),v=U(b,"Value"))),k.push(z),l.push(r),l.push(v)}r=K("param_TEXTURE_texture");m.push(Q(r));n={name:r,value:b.texture};
break;case "VALTORGB":k=la(b);l=O(b);n={value:b};t=b.color_ramp.interpolation;"CONSTANT"!=t&&"LINEAR"!=t&&pa.warn("Color Ramp node is not fully supported.");break;case "VALUE":g="VALUE";t=b.name;t={name:"-1",value:t};m.push(t);l.push(U(b,"Value"));break;case "VECT_MATH":switch(b.operation){case "ADD":g="VECT_MATH_ADD";break;case "SUBTRACT":g="VECT_MATH_SUBTRACT";break;case "AVERAGE":g="VECT_MATH_AVERAGE";break;case "DOT_PRODUCT":g="VECT_MATH_DOT_PRODUCT";break;case "CROSS_PRODUCT":g="VECT_MATH_CROSS_PRODUCT";
break;case "NORMALIZE":g="VECT_MATH_NORMALIZE";break;default:return pa.error("Unsupported VECT_MATH operation: "+b.operation),null}k=la(b);l=O(b);break;case "VECT_TRANSFORM":switch(b.vector_type){case "POINT":q.push(["VECTOR_TYPE",fa.D(0)]);break;case "VECTOR":q.push(["VECTOR_TYPE",fa.D(1)]);break;case "NORMAL":q.push(["VECTOR_TYPE",fa.D(2)]);break;default:return pa.error("Unsupported VECT_TRANSFORM vector_type: "+b.vector_type),null}k=b.convert_from;l=b.convert_to;if("WORLD"==k)if("WORLD"==l)k=0;
else if("OBJECT"==l)k=1;else if("CAMERA"==l)k=2;else return pa.error("Unsupported VECT_TRANSFORM convert_to: "+b.convert_to),null;else if("OBJECT"==k)if("WORLD"==l)k=3;else if("OBJECT"==l)k=4;else if("CAMERA"==l)k=5;else return pa.error("Unsupported VECT_TRANSFORM convert_to: "+b.convert_to),null;else if("CAMERA"==k)if("WORLD"==l)k=6;else if("OBJECT"==l)k=7;else if("CAMERA"==l)k=8;else return pa.error("Unsupported VECT_TRANSFORM convert_to: "+b.convert_to),null;else return pa.error("Unsupported VECT_TRANSFORM convert_from: "+
b.convert_from),null;q.push(["CONVERT_TYPE",fa.D(k)]);k=la(b);l=O(b);break;case "NORMAL_MAP":t=0;switch(b.space){case "TANGENT":t=0;break;case "OBJECT":t=1;break;case "WORLD":t=2;break;case "BLENDER_OBJECT":t=3;break;case "BLENDER_WORLD":t=4;break;default:return pa.error("Unsupported NORMAL_MAP space: "+b.space),null}q.push(["SPACE",fa.D(t)]);k.push(da(b,"Strength"));k.push(da(b,"Color"));l.push(U(b,"Normal"));break;default:k=la(b),l=O(b)}g={name:f,type:g,pj:h,H:k,Qa:l,V:m,data:n,Ob:q};f=J.ho(a);
J.ll(a,J.ho(a),g);if(!(g="GEOMETRY"!=b.type&&"TEX_COORD"!=b.type)){a:{g=b.outputs;for(m=h=0;m<g.length;m++)if(g[m].is_linked&&h++>c){g=!0;break a}g=!1}g=!g}return g||null!=S(a,b,++c,d,e)?f:null}function C(a,b,c){for(var d=a.inputs,e=a.outputs,f=a.node_tree_name,g=0;g<b.length;g++){var h=d[g],k=b[g];if(!h||h.default_value instanceof Array!=k)return pa.warn('Wrong inputs for custom node group "'+a.name+'" of type: "',f,'".Processing as general node group.'),!1}for(g=0;g<c.length;g++)if(b=e[g],d=c[g],
!b||b.default_value instanceof Array!=d)return pa.warn('Wrong outputs for custom node group "'+a.name+'" of type: "',f,'".Processing as general node group.'),!1;return!0}function W(a,b,c){var d=a.node_group.node_tree,f={},g;for(g in d)if("links"==g||"nodes"==g){f[g]=[];for(var h=0;h<d[g].length;h++){f[g][h]={};for(var k in d[g][h])if("links"==g){f[g][h][k]={};for(var l in d[g][h][k])f[g][h][k][l]=F(d[g][h][k][l])}else f[g][h][k]=F(d[g][h][k])}}else f[g]=F(d[g]);d=a.node_tree_name;if("B4W_REPLACE"==
d||"B4W_LEVELS_OF_QUALITY"==d)g=z("Group input","GROUP_INPUT",[],a.inputs),h=z("Group output","GROUP_OUTPUT",a.outputs,[]),k=null,k="B4W_REPLACE"==d||"B4W_LEVELS_OF_QUALITY"==d&&(Ka.quality==qa.P_LOW||Ka.wu)?{from_node:g,from_socket:g.outputs[1],to_node:h,to_socket:h.inputs[0]}:{from_node:g,from_socket:g.outputs[0],to_node:h,to_socket:h.inputs[0]},f.nodes=[g,h],f.links=[k];d=a.name;g=f.nodes;h=f.links;for(k=0;k<g.length;k++)g[k].name=ma(g[k].type,d,g[k].name);for(k=0;k<h.length;k++)h[k].from_node.name=
ma(h[k].from_node.type,d,h[k].from_node.name),h[k].to_node.name=ma(h[k].to_node.type,d,h[k].to_node.name);return{mL:e(f,a.node_group.uuid,!0,b,c).Oa,nL:f.links}}function F(a){var b=typeof a;return"string"!=b&&"number"!=b&&"boolean"!=b&&a?ia.An(a):a}function K(a){ya[a]||(ya[a]=0);var b=a+"_"+ya[a],b=b.replace(/ /g,"_").replace(/\//g,"_");ya[a]++;return b}function X(a){a=a.outputs;for(var b=0;b<a.length;b++)if(a[b].is_linked)return!0;return!1}function N(a,b){for(var c=a.outputs,d=0,e=0;e<c.length;e++){var f=
c[e];if(f.is_linked&&!(d++<b))switch(f.identifier){case "UV":return"GEOMETRY_UV";case "Vertex Color":return"GEOMETRY_VC";case "Normal":return"GEOMETRY_NO";case "Front/Back":return"GEOMETRY_FB";case "View":return"GEOMETRY_VW";case "Global":return"GEOMETRY_GL";case "Local":return"GEOMETRY_LO";case "Orco":return"GEOMETRY_OR";default:return null}}}function L(a,b){for(var c=a.outputs,d=0,e=0;e<c.length;e++){var f=c[e];if(f.is_linked&&!(d++<b))switch(f.identifier){case "Camera":return"TEX_COORD_CA";case "Generated":return"TEX_COORD_GE";
case "Normal":return"TEX_COORD_NO";case "Object":return"TEX_COORD_OB";case "Reflection":return"TEX_COORD_RE";case "UV":return"TEX_COORD_UV";case "Window":return"TEX_COORD_WI";default:return null}}}function P(a){if(!a.texture)return"TEXTURE_EMPTY";for(var b=a.outputs,c=!1,d=!1,e=!1,f=0;f<b.length;f++){var g=b[f];if(g.is_linked)switch(g.identifier){case "Color":c=!0;break;case "Normal":d=!0;break;case "Value":e=!0;break;default:ia.q("Unknown texture output")}}if(c)return d&&pa.warn('Node "'+a.name+
'" has both Color and Normal outputs. Normal will be omitted'),"ENVIRONMENT_MAP"==a.texture.type?"TEXTURE_ENVIRONMENT":"TEXTURE_COLOR";if(d)return"TEXTURE_NORMAL";if(e)return"ENVIRONMENT_MAP"==a.texture.type?"TEXTURE_ENVIRONMENT":"TEXTURE_COLOR"}function da(a,b){for(var c=a.inputs,d=0;d<c.length;d++){var e=c[d];if(e.identifier==b)return ga(e)}return null}function U(a,b){for(var c=a.outputs,d=0;d<c.length;d++){var e=c[d];if(e.identifier==b)return ga(e)}return null}function ga(a){var b=a.name,c=a.identifier,
d=a.is_linked;a=a.default_value;a=ia.is_vector(a)?a.slice(0):a;return{name:b,identifier:c,dc:d,hb:a}}function T(a,b,c,d){return{name:a,identifier:b,dc:d||!1,hb:c}}function la(a){for(var b=[],c=0;c<a.inputs.length;c++){var d=ga(a.inputs[c]);d.hb.length&&d.hb.splice(3);b.push(d)}return b}function O(a){for(var b=[],c=0;c<a.outputs.length;c++){var d=ga(a.outputs[c]);b.push(d)}return b}function Q(a,b,c){b=null===b||void 0===b?null:fa.D(b,c);return{name:a,value:b}}function Z(a,b,c,d,e,f){var g=[],h=f.from_socket.identifier;
f=f.to_socket.identifier;var k=d.Qa;for(d=0;d<k.length;d++)if(k[d].identifier==h){g.push(d);break}e=e.H;for(d=0;d<e.length;d++)if(e[d].identifier==f){g.push(d);break}2==g.length&&J.qd(a,b,c,g);return!0}function ma(a,b,c){return"GROUP_INPUT"==a?b+"*GI*"+c:"GROUP_OUTPUT"==a?b+"*GO*"+c:b+"%join%"+c}function ra(a){var b=[];J.ma(a,function(a,c){"GROUP"==c.type&&b.push(c)});return b}function ja(a,b,c){for(var d=0;d<c.length;d++){var e=c[d].data.mL,f=c[d].data.nL;if(!e)return!1;J.ma(e,function(b,c){J.ll(a,
J.ho(a),c)});for(e=0;e<f.length;e++)b.push(f[e]);I(c[d],b,a)}return!0}function oa(a,b,c,d,e,f){switch(a.type){case "GROUP":a.name==b&&d.push(c);break;case "GROUP_INPUT":a.name.indexOf(b+"*GI*")||e.push(c);break;case "GROUP_OUTPUT":a.name.indexOf(b+"*GO*")||f.push(c)}}function ha(a,b,c){for(var d=[],e=0;e<c.length;e++){for(var f=c[e],g=null,h=0;h<b.length;h++)if(f.from_socket.identifier==b[h].to_socket.identifier){g=b[h];break}g?(f.from_node=g.from_node,f.from_socket=g.from_socket):d.push(f)}for(e=
0;e<b.length;e++)a.splice(a.indexOf(b[e]),1);return d}function ea(a,b){if(b.length)for(var c=b[0].from_node.name,d=0;d<a.length;d++)a[d].from_node.name==c&&b.push(a[d])}function ka(a,b,c,d){for(var e=0;e<d.length;e++){for(var f=d[e],g,h=0;h<c.H.length;h++)if(f.from_socket.identifier==c.H[h].identifier){g=c.H[h].hb;break}for(var h=f,k=b,m=g,n=l(h.to_node,k),q=0;q<n.length;q++)for(var t=J.Na(k,n[q]),r=0;r<t.H.length;r++){var v=t.H[r];if(v.identifier==h.to_socket.identifier){t=v.hb instanceof Object?
0:1;if((m instanceof Object?0:1)==t)v.hb=m;else switch(t){case 0:v=v.hb;v[0]=v[1]=v[2]=m;break;case 1:v.hb=(m[0]+m[1]+m[2])/3}break}}f=a.indexOf(f);-1!=f&&a.splice(f,1)}}function I(a,b,c){for(var d=a.name,e=[],f=[],g=[],h=[],k=0;k<b.length;k++){var l=b[k];oa(l.from_node,d,l,e,g,h);oa(l.to_node,d,l,f,g,h)}f=ha(b,f,g);e=ha(b,h,e);ea(b,f);ka(b,c,a,f);if(e.length){var m;J.ma(c,function(a,b){"GROUP_OUTPUT"!=b.type||b.name.indexOf(d+"*GO*")||(m=b)});ka(b,c,m,e)}}function Ia(a){var b=[],c=[];J.ma(a,function(a,
d){switch(d.type){case "VALTORGB":b.push(d);break;case "CURVE_VEC":case "CURVE_RGB":c.push(d)}});var d=0,e=a=null,f=b.length+c.length;if(b.length){a=Ca.cH(b,Ca.kD);for(var g=0;g<b.length;g++)b[g].Ob.push(["NODE_TEX_ROW",fa.D((d+.5)/f)]),d++}if(c.length)for(e=Ca.aI(c,Ca.qx),g=0;g<c.length;g++)c[g].Ob.push(["NODE_TEX_ROW",fa.D((d+.5)/f)]),d++;g=null;a&&e?(g=new Uint8Array(a.length+e.length),g.set(a),g.set(e,a.length)):g=a?a:e;a=g?Ca.Dz(g,Ca.qx):null;for(g=0;g<b.length;g++)b[g].data.Ja=a;for(g=0;g<c.length;g++)c[g].data.Ja=
a}function Aa(a,b,c){a=a.curve_mapping.curves_data[b];return 2==a.length&&a[0][0]<c+.01&&a[0][1]<c+.01&&.99<a[1][0]&&.99<a[1][1]?!1:!0}var qa=p("__config");p("__debug");var J=p("__graph"),aa=p("__mat3"),V=p("__mat4"),ca=p("__objects"),pa=p("__print"),fa=p("__shaders"),Ea=p("__scenes"),ia=p("__util"),na=p("__vec3"),Ca=p("__textures"),ya={},va={},Ma={},Fa={},Ja=0;new Float32Array(4);var Ka=qa.v;a.BP=0;a.$E=1;a.ZE=2;a.YE=3;a.AP=4;a.XE=5;a.WE=6;a.VE=7;a.zP=8;a.RD=0;a.QD=1;a.vP=2;a.PD=3;a.uP=4;a.Sz=function(a){return va[a]};
a.OG=function(a){delete va[a]};a.VG=e;a.Xt=function(a,c,d){var e=Ea.get_active();a=h(a,"MAIN",e.uuid);if(a in Ma)return Ma[a];var e=J.create(),f={name:"LIGHTING_BEGIN",type:"LIGHTING_BEGIN"},g=S(e,f,0,c,null),f={name:"LIGHTING_END",type:"LIGHTING_END"},f=S(e,f,0,c,null);b(e,d,g,f,[[g,[8,10]],[g,[9,6]]],c);m(e);return Ma[a]=e};a.jq=function(a){var b=[],c={};ya={};var d=J.Nw(a);J.ma(d,function(a,d){var e;e=[];for(var f=[],g=[],h=[],k=[],l=[],m=0;m<d.H.length;m++){var n=d.H[m];if(n.dc)e.push(null),f.push(null);
else{e.push(K("in_"+d.type+"_"+n.identifier.replace(/\./g,"")));var q=fa.D(n.hb,0);Ka.PB&&(0<=d.type.indexOf("MIX_RGB_")&&("Color1"==n.identifier||"Color2"==n.identifier||"Fac"==n.identifier)||0<=d.type.indexOf("MATH_")&&("Value"==n.identifier||"Value_001"==n.identifier)||0<=d.type.indexOf("VECT_MATH_")&&"Vector_001"==n.identifier||0<=d.type.indexOf("LIGHTING_APPLY")||0<=d.type.indexOf("MATERIAL_END")||0<=d.type.indexOf("MATERIAL_BEGIN"))&&(n=q,n=n.replace(/(,)/g,"$1 "),n=n.replace(/(^|[^0-9]|\s)(0\.0)($|[^0-9]|\s)/g,
"$1ZERO_VALUE_NODES$3"),n=n.replace(/(^|[^0-9]|\s)(1\.0)($|[^0-9]|\s)/g,"$1UNITY_VALUE_NODES$3"),q=n=n.replace(/\s+/g,""));f.push(q)}}for(m=0;m<d.Qa.length;m++)n=d.Qa[m],n.dc?g.push(null):g.push(K("out_"+d.type+"_"+n.identifier.replace(/\./g,"")));for(m=0;m<d.V.length;m++)n=d.V[m],h.push(n.name),k.push(n.value);for(m=0;m<d.pj.length;m++)l.push(d.pj[m].name);e={id:d.type,H:e,Tu:f,Qa:g,V:h,Or:k,pj:l,Ob:JSON.parse(JSON.stringify(d.Ob))};b.push(e);c[a]=e});J.gg(d,function(a,b,e){var f=J.Na(d,a);J.Na(d,
b);var g=f.Qa[e[0]];a=c[a].Qa;b=c[b].H;f=a[e[0]]||K("out_"+f.type+"_"+g.identifier.replace(/\./g,""));a[e[0]]=f;b[e[1]]=f});return b};a.zy=function(a){if(a.node_tree)for(var b=0;b<a.node_tree.nodes.length;b++){var c=a.node_tree.nodes[b];if("GROUP"==c.type&&"B4W_GLOW_OUTPUT"==c.node_tree_name)return!0}return!1};a.cleanup=function(){for(var a in va)delete va[a];for(a in Ma)delete Ma[a];for(var b in Fa)delete Fa[b];Ja=0}};b4w.module.__animation=function(a,p){function e(a,b){var c=a.X[b];c&&c.vu&&c.Xn&&(c.Xn=!1,c.vu(a,b))}function c(a,b,c){c=a.X[c];c.type=30;var d=b.la,e=b.Ka-d+1;c.start=d;c.length=e;c.He=d;c.dh=b.name;for(e=d=0;e<a.yc.length;e++){var f=a.yc[e];if(f==b)break;else d+=f.Ka-f.la+1}c.SC=d}function b(a,b){a.type=50;a.dh=b.name;a.start=b.la;a.length=b.Ka-a.start;b.cyclic||(a.length+=b.av)}function n(a){return a.replace(/_B4W_BAKED$/,"")}function h(a,b){return{bm:a,action:b}}function r(a,b,c){if(a.animation_data){var d=
a.animation_data.action;d&&60==d.p.type&&b.push(h(c,d))}a=a.nodes;for(d=0;d<a.length;d++){var e=a[d];if(e.node_group){var f=e.node_group.node_tree;if(f){var g=c.slice();g.push(e.name);r(f,b,g)}}}}function g(a){return ga.is_mesh(a)&&a.k.yc?!0:!1}function m(a,b,c){var d=a.X;if(-1==c)for(c=0;8>c;c++){var e=d[c];e&&(e.He=b,B(a,0,c,!0))}else if(e=d[c])e.He=b,B(a,0,c,!0)}function q(a,b,c){if(-1==b)for(b=0;8>b;b++){var d=a[b];d&&c(d)}else(d=a[b])&&c(d)}function B(a,b,c,d){y(a,b,c,d);e(a,c);a.k.bh&&(x(a,
b),G(a,b))}function d(a,b,c,d){var e=c.frame_range;if(e[0]>e[1])return O.warn('Incompatible action "'+c.name+'" has been applied to object "'+a.name+'"'),!1;var g=c.p,h=a.X[d];h.dh=c.name;h.nt=e;h.Nx=g.jB;h.Lx=g.ey;h.hh.set(g.hh);h.start=e[0];h.length=e[1]-e[0];h.He=e[0];switch(g.type){case 10:if(ga.is_armature(a)){h.type=10;var m=l(a,b,c);if(!m){for(var m=a.k.be,e=[],n=[],q=c.p.Ev,r=0;r<q;r++){for(var v in m){var u=m[v],p=u.ys,J=c.p.zt[v];J?ea.copy(J.subarray(8*r,8*r+8),p):ea.identity(p);u.zs=!1}u=
k(m);e.push(u.trans);n.push(u.fb)}m={trans:e,fb:n};f(a,b,c,m)}h.trans=m.trans;h.fb=m.fb;b=m;h=a.k;m=h.pm;e=a.X[d];v=e.pw;a:{n=h.ls;for(q=0;q<n.length;q+=2)if(c==n[q]){n=n[q+1];break a}n=null}if(n)e.pw=n;else{for(e=0;e<m.length;e++){n=m[e].gi;q=[];r=[];u=b.trans;p=b.fb;for(J=0;J<u.length;J++){var z=t(u[J],p[J],n);q.push(z.trans);r.push(z.fb)}v.push({trans:q,fb:r})}h.ls.push(c,v)}h.bh&&(c=h.Hm,d>c[1]?(b=c[1],c[1]=d,c[0]=b):d>c[0]&&d<c[1]&&(c[0]=d),H(a))}break;case 40:ga.is_speaker(a)&&(h.volume=g.V.volume||
null,h.pitch=g.V.pitch||null,h.type=40);break;case 70:ga.is_lamp(a)&&(h.color=g.V.color||null,h.Je=g.V.energy||null,h.type=70);break;case 60:if("MESH"==a.type){h.type=60;v=l(a,b,c);if(!v){v=[];e=[];n=[];q=[];r=[];u=c.p;p=b?b[0]:null;for(m in u.V){J=b;z=m.match(/"(.*?)"/)[1];if(J&&1<J.length){for(var B=J[1],x=2;x<J.length;x++)B=B+"%join%"+J[x];B+="%join%"+z}else B=z;J=B;for(z=0;z<a.C.length;z++)for(B=a.C[z].P,x=0;x<B.length;x++){var L=B[x];if(!p||-1!=L.lc.indexOf(p)){var y=L.Vf,C=w(m,J,u,e,v,L.Wf),
y=w(m,J,u,q,n,y);(C||y)&&r.push(L)}}}v={HO:v,values:e,$L:n,aM:q,Gr:r};f(a,b,c,v)}h.Wf=v.HO;h.VA=v.values;h.Vf=v.$L;h.UA=v.aM;h.Gr=v.Gr}break;case 20:if(m=g.V.tsr){h.type=20;v=l(a,b,c);if(!v){v=c.p.Ev;e=[];n=[];for(q=0;q<v;q++)e.push(m.subarray(8*q,8*q+4)),n.push(m.subarray(8*q+4,8*q+8));v={trans:e,fb:n};f(a,b,c,v)}h.trans=v.trans;h.fb=v.fb;T.cm(a)&&T.pO(a,h.trans[0],h.fb[0])}else return O.warn('Incompatible action "'+c.name+'" has been applied to object "'+a.name+'"'),!1;break;case 80:ga.is_world(a)&&
(h.Je=g.V["light_settings.environment_energy"]||null,h.Oe=g.V.horizon_color||null,h.cf=g.V.zenith_color||null,h.sz=g.V["mist_settings.intensity"]||null,h.qz=g.V["mist_settings.depth"]||null,h.tz=g.V["mist_settings.start"]||null,h.rz=g.V["mist_settings.height"]||null,h.pz=g.V.b4w_fog_color||null,h.type=80)}ga.is_armature(a)&&10!=g.type&&D(a,d);return!0}function l(a,b,c){a=a.Rp;b=b?b.join("%join%"):null;for(var d=0;d<a.length;d+=3)if(c==a[d]&&b==a[d+1])return a[d+2];return null}function f(a,b,c,d){a.Rp.push(c,
b?b.join("%join%"):null,d)}function H(a){var b=a.k.Hm;if(-1!=b[0]&&-1!=b[1]){var c=a.X;a=c[b[1]].He;var d=Math.floor(a),e=a-d,b=c[b[0]];a=b.He;d=Math.floor(a);b.He=d+e}}function D(a,b){var c=a.k.Hm,d=c[1];c[0]=-1;c[1]=-1;if(-1!=b)for(var e=a.X;0<=d;d--){var f=e[d];if(f&&10==f.type)if(d>c[1])c[1]=d;else{d>c[0]&&(c[1]=d);break}}}function w(a,b,c,d,e,f){if(!f)return!1;for(var g=!1,h=0;h<f.length;h+=2)b==f[h]&&(e.push(f[h+1]),d.push(new Float32Array(c.V[a])),g=!0);return g}function E(a){a=a.p;for(var b in a.V)if(-1!=
b.indexOf("nodes"))return!0;return!1}function y(a,b,c,d){if((c=a.X[c])&&null!=c.type&&(c.play||d)){var e=a.k,f=c.He,g=c.start,h=c.length,f=f+c.speed*b*oa.Qc(),k=c.type,l=c.speed;if(0<=l&&f>=g+h||0>l&&f<g)switch(d||(c.Xn=!0),c.behavior){case 10:f=0<=l?(f-g)%h+g:g+h-1E-6;break;case 20:f=0<=l?g:g+h-1E-6;c.play=!1;break;case 30:f=0<=l?g+h-1E-6:g,c.play=!1}c.He=f;switch(k){case 10:if(!e.bh){d=A(c);b=d[0];var m=d[1];d=d[2];e.Bd=c.fb[b];e.Qd=c.fb[m];e.Ed=c.trans[b];e.Sd=c.trans[m];e.ie=d;d=e.pm;c=c.pw;for(var n=
0;n<d.length;n++){var q=d[n],t=c[n];q.Bd=t.fb[b];q.Qd=t.fb[m];q.Ed=t.trans[b];q.Sd=t.trans[m];q.ie=e.ie}ha.u(a)}break;case 20:d=A(c);var e=J,m=d[0],n=d[1],q=d[2],t=c.trans,r=t[m][1],f=t[m][2],g=t[n][1],h=t[n][2];e[0]=(1-q)*t[m][0]+q*t[n][0];e[1]=(1-q)*r+q*g;e[2]=(1-q)*f+q*h;m=V;f=d[0];n=d[1];q=d[2];t=c.fb;r=ca;r[0]=t[f][0];r[1]=t[f][1];r[2]=t[f][2];r[3]=t[f][3];f=pa;f[0]=t[n][0];f[1]=t[n][1];f[2]=t[n][2];f[3]=t[n][3];Q.slerp(r,f,q,m);n=d[2];q=c.trans;d=(1-n)*q[d[0]][3]+n*q[d[1]][3];a.parent&&a.Sr&&
(n=fa,ea.set_sep(e,d,m,n),ea.multiply(a.Sr,n,n),ea.cc(n,e),ea.xd(n,m),d=ea.get_scale(n));c.Uw&&(n=aa,ha.get_translation(a,n),ka.smooth_v(e,n,b,c.Uw,e));c.Tv&&(n=ca,ha.get_rotation(a,n),ka.ZB(m,n,b,c.Tv,m));f=c.hh;f[0]&&ha.set_translation_rel(a,e);f[1]&&ha.set_rotation_rel(a,m);f[2]&&ha.set_scale_rel(a,d);ha.u(a);la.sync_transform(a);break;case 30:d=c.He-c.start;0>d&&(d=0);d>=c.length&&(d=c.length);a=Math.floor(d);b=a+1;d-=a;10!=c.behavior&&b==c.length&&(b=--a,d=1);c=c.SC;qa[0]=a+c;qa[1]=b+c;qa[2]=
d;d=qa;e.Gs=d[0];e.Hs=d[2];break;case 40:d=A(c);b=d[0];e=d[1];d=d[2];c.volume&&ra.set_volume(a,(1-d)*c.volume[b]+d*c.volume[e]);c.pitch&&ra.playrate(a,(1-d)*c.pitch[b]+d*c.pitch[e]);break;case 50:b=10==c.behavior?(f-g)/oa.Qc():f/oa.Qc();T.OM(a,c.dh,b);break;case 60:d=A(c);b=d[0];e=d[1];d=d[2];t=c.VA;r=c.Wf;a=c.UA;m=c.Vf;n=c.Gr;for(c=0;c<r.length;c++)for(f=t[c],q=r[c],g=(1-d)*f[b]+d*f[e],f=0;f<n.length;f++)n[f].Bh[q]=g;for(c=0;c<m.length;c++)for(t=a[c],q=m[c],t=I.lerp(t.subarray(3*b,3*b+3),t.subarray(3*
e,3*e+3),d,J),f=0;f<n.length;f++)n[f].Nd[3*q]=t[0],n[f].Nd[3*q+1]=t[1],n[f].Nd[3*q+2]=t[2];break;case 70:d=A(c);b=d[0];e=d[1];d=d[2];f=c.hh;(h=c.Je)&&f[0]&&U.set_light_energy(a.Pa,(1-d)*h[b]+d*h[e]);(c=c.color)&&f[1]&&(J[0]=(1-d)*c[3*b]+d*c[3*e],J[1]=(1-d)*c[3*b+1]+d*c[3*e+1],J[2]=(1-d)*c[3*b+2]+d*c[3*e+2],U.set_light_color(a.Pa,J));g=a.C;for(c=0;c<g.length;c++)ma.bO(a,g[c].Ra);break;case 80:d=A(c);b=d[0];e=d[1];d=d[2];f=c.hh;g=a.C;l=ma.Ba(g[0].Ra,ja.pb);h=c.Je;h=f[0]?(1-d)*h[b]+d*h[e]:l.Je;k=c.Oe;
f[1]?(J[0]=(1-d)*k[3*b]+d*k[3*e],J[1]=(1-d)*k[3*b+1]+d*k[3*e+1],J[2]=(1-d)*k[3*b+2]+d*k[3*e+2],k=J):k=l.Oe;var v=c.cf;f[2]?(aa[0]=(1-d)*v[3*b]+d*v[3*e],aa[1]=(1-d)*v[3*b+1]+d*v[3*e+1],aa[2]=(1-d)*v[3*b+2]+d*v[3*e+2],l=aa):l=l.cf;v=c.sz;f[3]&&(m=(1-d)*v[b]+d*v[e]);v=c.qz;f[4]&&(n=(1-d)*v[b]+d*v[e]);v=c.tz;f[5]&&(q=(1-d)*v[b]+d*v[e]);v=c.rz;f[6]&&(t=(1-d)*v[b]+d*v[e]);c=c.pz;f[7]&&(V[0]=(1-d)*c[3*b]+d*c[3*e],V[1]=(1-d)*c[3*b+1]+d*c[3*e+1],V[2]=(1-d)*c[3*b+2]+d*c[3*e+2],r=V);for(c=0;c<g.length;c++)b=
a.C[c].Ra,(f[0]||f[1]||f[2])&&ma.set_environment_colors(b,h,k,l),f[3]&&ma.tM(b,m),f[4]&&ma.rM(b,n),f[5]&&ma.uM(b,q),f[6]&&ma.sM(b,t),f[7]&&ma.set_fog_color_density(b,r);break;default:ka.q("Unknown animation type:"+k)}}}function A(a){var b=a.nt[0],c=a.nt[1]-b,b=a.He-b;0>b&&(b=0);b>=c&&(b=c);b/=a.Nx;c=Math.floor(b);a=a.Lx[c]?b-c:0;b=Math.ceil(c+a);qa[0]=c;qa[1]=b;qa[2]=a;return qa}function G(a,b){var c=a.k,d=c.og,e=c.Hm,f=e[0],e=e[1];if(-1!=e){if(-1!=f){var g=a.X[f];if(g.play||0==b){var h=A(g),k=h[0],
l=h[1];c.ie=h[2];var h=g.fb[k],m=g.fb[l],k=g.trans[k],l=g.trans[l]}else d=1}else d=1;e=a.X[e];if(e.play||0==b){var f=A(e),n=f[0],q=f[1];c.ie=f[2]}else if(-1!=f&&g.play)d=0;else return;f=e.fb[n];g=e.fb[q];n=e.trans[n];q=e.trans[q];if(1==d)c.Bd.set(f),c.Qd.set(g),c.Ed.set(n),c.Sd.set(q);else if(0==d)c.Bd.set(h),c.Qd.set(m),c.Ed.set(k),c.Sd.set(l);else{for(e=0;e<h.length;e+=4){for(var t=V,r=ca,v=0;4>v;v++)t[v]=h[e+v],r[v]=f[e+v];Q.slerp(t,r,d,t);for(v=0;4>v;v++)c.Bd[e+v]=t[v];for(v=0;4>v;v++)t[v]=m[e+
v],r[v]=g[e+v];Q.slerp(t,r,d,t);for(v=0;4>v;v++)c.Qd[e+v]=t[v]}ka.gy(k,n,d,c.Ed);ka.gy(l,q,d,c.Sd)}ha.u(a);P.nO(a)}}function x(a,b){var c=a.k,d=c.og,e=c.cn;if(0!=e){var d=c.bn-d,f=e*b;ka.sign(d)==ka.sign(e)&&Math.abs(f)<Math.abs(d)?c.og+=f:(c.og=c.bn,c.cn=0)}}function k(a){var b=[],c=[],d=new Float32Array(4),e=new Float32Array(4),f;for(f in a){var g=a[f],h=d,k=e,l=g.hq,m=l[l.length-1],n=m.Ww;m.zs||ea.identity(n);for(m=l.length-1;0<=m;m--){var q=l[m],t=q.Ww;if(q.zs)n=t;else{var r=q.ij,v=q.ys;ea.invert(r,
fa);ea.multiply(v,fa,fa);ea.multiply(r,fa,fa);ea.multiply(n,fa,t);n=t;q.zs=!0}}l=q.Ww;h[0]=l[0];h[1]=l[1];h[2]=l[2];h[3]=l[3];k[0]=l[4];k[1]=l[5];k[2]=l[6];k[3]=l[7];Q.normalize(k,k);g=g.fi;for(h=0;4>h;h++)k=4*g+h,b[k]=d[h],c[k]=e[h]}return{trans:b,fb:c}}function t(a,b,c){var d=[],e=[];new Float32Array(4);new Float32Array(4);for(var f in c)for(var g=c[f],h=g.fi,g=g.ju,k=0;4>k;k++){var l=4*g+k,m=4*h+k;d[l]=a[m];e[l]=b[m]}d=new Float32Array(d);e=new Float32Array(e);return{trans:d,fb:e}}function M(a){var b=
a.p,c;if(b.zt)c=10;else if(b.V)if("volume"in b.V||"pitch"in b.V)c=40;else if(E(a))c=60;else{var d;a:{if(a.p.V){d=a.fcurves;for(var e in d)if("color"==e&&!d[e][3]){d=!0;break a}if("energy"==e){d=!0;break a}}d=!1}if(d)c=70;else if(d=a.p.V,"light_settings.environment_energy"in d||"horizon_color"in d||"zenith_color"in d||"mist_settings.intensity"in d||"mist_settings.depth"in d||"mist_settings.start"in d||"mist_settings.height"in d||"b4w_fog_color"in d)c=80;else{a:{if(a.p.V)for(c in a=a.fcurves,a)if("location"==
c||"rotation_quaternion"==c||"scale"==c){c=!0;break a}c=!1}c=c?20:0}}else c=0;b.type=c}function E(a){if(a=a.p.V)for(var b in a)if(-1!=b.indexOf("nodes"))return!0;return!1}function u(a,b){b[0]=b[1]=b[2]=0;for(var c in a)"location"==c?b[0]=1:"rotation_quaternion"==c?b[1]=1:"scale"==c&&(b[2]=1)}function v(a,b){b[0]=b[1]=0;for(var c in a)"energy"==c?b[0]=1:"color"==c&&(b[1]=1)}function z(a,b){b[0]=b[1]=b[2]=0;b[3]=b[4]=b[5]=0;b[6]=b[7]=0;for(var c in a)"light_settings.environment_energy"==c?b[0]=1:"horizon_color"==
c?b[1]=1:"zenith_color"==c?b[2]=1:"mist_settings.intensity"==c?b[3]=1:"mist_settings.depth"==c?b[4]=1:"mist_settings.start"==c?b[5]=1:"mist_settings.height"==c?b[6]=1:"b4w_fog_color"==c&&(b[7]=1)}function S(a,b,c,d,e,f,g){var h=a+(b-a)/2,k=C(h,d,e,f,g)-c;return.02>Math.abs(k)?h:0<k?S(a,h,c,d,e,f,g):S(h,b,c,d,e,f,g)}function C(a,b,c,d,e){var f=1-a;return b*f*f*f+3*c*f*f*a+3*d*f*a*a+e*a*a*a}function W(a,b){var c={type:null,dh:null,nt:null,Nx:0,Lx:null,hh:new Int8Array(8),fb:null,trans:null,pw:[],play:!1,
behavior:20,He:0,start:0,length:0,Uw:0,Tv:0,Xn:!1,SC:null,speed:1,volume:null,pitch:null,color:null,Je:null,cf:null,Oe:null,sz:null,qz:null,tz:null,rz:null,pz:null,VA:[],Wf:[],UA:[],Vf:[],Gr:null};if(!a.X.length)for(var d=0;8>d;d++)a.X.push(null);a.X[b]=c;-1==Ea.indexOf(a)&&Ea.push(a)}function F(a,b){ha.u(a);la.sync_transform(a);B(a,0,b,!0)}function K(a,e,f,g){g=g||0;if(ga.is_mesh(a)){var h=X(a,f);if(h)return W(a,g),c(a,h,g),F(a,g),!0;if((h=N(a,f))&&"EMITTER"==h.Mr){W(a,g);e=h.name;f=g;for(var h=
a.C,k=0;k<h.length;k++)for(var l=h[k].P,m=0;m<l.length;m++){var n=l[m].Ia;n&&n.name==e&&b(a.X[f],n)}F(a,g);return!0}}if(h=ka.keysearch("name",f,ia)||ka.keysearch("name",f+"_B4W_BAKED",ia)){W(a,g);if(d(a,e,h,g))return F(a,g),!0;a.X[g]=null}O.error('Unsupported object: "'+a.name+'" or animation name: "'+f+'"');return!1}function X(a,b){for(var c=0;c<a.yc.length;c++){var d=a.yc[c];if(d.name===b)return d}return null}function N(a,b){for(var c=a.C,d=0;d<c.length;d++)for(var e=c[d].P,f=0;f<e.length;f++){var g=
e[f].Ia;if(g&&g.name===b)return g}return null}function L(a){a=a.modifiers;for(var b=0;b<a.length;b++){var c=a[b];if("ARMATURE"==c.type)return c.object}return null}var P=p("__armature"),da=p("__config"),U=p("__lights"),ga=p("__obj_util"),T=p("__particles"),la=p("__physics"),O=p("__print"),Q=p("__quat"),Z=p("__reformer"),ma=p("__scenes"),ra=p("__sfx"),ja=p("__subscene"),oa=p("__time"),ha=p("__transform"),ea=p("__tsr"),ka=p("__util"),I=p("__vec3"),Ia=da.zj,Aa=da.mi;a.MD=1E-6;a.OBJ_ANIM_TYPE_NONE=0;a.OBJ_ANIM_TYPE_ARMATURE=
10;a.OBJ_ANIM_TYPE_OBJECT=20;a.OBJ_ANIM_TYPE_VERTEX=30;a.OBJ_ANIM_TYPE_SOUND=40;a.OBJ_ANIM_TYPE_PARTICLES=50;a.OBJ_ANIM_TYPE_MATERIAL=60;a.VD=70;a.UD=80;a.SLOT_0=0;a.SLOT_1=1;a.SLOT_2=2;a.SLOT_3=3;a.SLOT_4=4;a.SLOT_5=5;a.SLOT_6=6;a.SLOT_7=7;a.SLOT_ALL=-1;a.AB_CYCLIC=10;a.AB_FINISH_RESET=20;a.AB_FINISH_STOP=30;var qa=Array(3),J=new Float32Array(3),aa=new Float32Array(3),V=new Float32Array(4),ca=new Float32Array(4),pa=new Float32Array(4),fa=ea.create();new Float32Array(16);var Ea=[],ia=[];a.Qz=function(){return ka.trunc((Aa.nv-
50)/4)};a.frame_to_sec=function(a){return a/oa.Qc()};a.update=function(a){for(var b=0;b<Ea.length;b++){for(var c=Ea[b],d=0;8>d;d++)y(c,a,d);c.k.bh&&(x(c,a),G(c,a))}for(b=0;b<Ea.length;b++)for(c=Ea[b],d=0;8>d&&c.X.length;d++)e(c,d)};a.rJ=function(){return ia};a.get_anim_names=function(a){var b=[];if(g(a))for(var c=0;c<a.yc.length;c++)b.push(a.yc[c].name);for(var d=[],c=0;c<ia.length;c++){var e=ia[c],f=e.p;20==f.type?d.push(e):60==e.p.type&&"MESH"==a.type?d.push(e):10==f.type&&"ARMATURE"==a.type?d.push(e):
40==f.type&&"SPEAKER"==a.type?d.push(e):80==f.type&&"WORLD"==a.type&&d.push(e)}for(c=0;c<d.length;c++)b.push(n(d[c].name));if(T.cm(a)&&T.$A(a))for(a=a.C,c=0;c<a.length;c++)for(d=a[c].P,e=0;e<d.length;e++)(f=d[e].Ia)&&b.push(f.name);return b};a.IR=n;a.get_anim_type=function(a,b){var c=a.X[b];return c?c.type:0};a.apply_def=function(a){for(var e=0,f=a.C,h=0;h<f.length;h++)for(var k=f[h].P,l=0;l<k.length;l++){var m=k[l].Ia;m&&"EMITTER"==m.Mr&&!k[l].of&&(W(a,e),b(a.X[e],m),F(a,e),a.X[e].behavior=m.cyclic?
10:a.yj,e++)}f=a.mh.slice();for(h=0;h<f.length;h++)l=f[h],k=l.bm,l=l.action,W(a,e),d(a,k,l,e)?(F(a,e),a.X[e].behavior=a.yj,e++):a.X[e]=null;g(a)&&(W(a,e),c(a,a.yc[0],e),F(a,e),a.X[e].behavior=a.yj)};a.qt=function(a){switch(a){case "CYCLIC":return 10;case "FINISH_RESET":return 20;case "FINISH_STOP":return 30;default:ka.q("Wrong animation behavior")}};a.vJ=function(a){var b=[];a=a.data.materials;for(var c=0;c<a.length;c++){var d=a[c],e=d.node_tree;e&&r(e,b,[d.name])}return b};a.eA=h;a.play=function(a,
b,c){q(a.X,c,function(a){a.play=!0;a.vu=b?b:null;a.Xn=!1});a.k.bh&&H(a)};a.stop=function(a,b){q(a.X,b,function(a){a.play=!1;a.vu=null;a.Xn=!1})};a.is_play=function(a,b){var c=a.X;if(-1==b)for(var d=0;8>d;d++){if(c[d]&&c[d].play)return!0}else if(c=c[b])return c.play;return!1};a.set_frame=m;a.set_first_frame=function(a,b){b=b||0;q(a.X,b,function(c){m(a,c.start,b)})};a.Mz=function(a,b){var c=a.X[b];return c&&c.He?c.He:0};a.is_cyclic=function(a,b){var c=a.X[b];return c&&10==c.behavior};a.set_behavior=
function(a,b,c){q(a.X,c,function(a){a.behavior=b})};a.get_behavior=function(a,b){var c=a.X[b];return c&&c.behavior};a.apply_smoothing=function(a,b,c,d){q(a.X,d,function(a){a.Uw=b||0;a.Tv=c||0})};a.remove_slot_animation=function(a,b){if(-1==b)for(var c=0;8>c;c++)a.X[c]=null;else a.X[b]=null;a.k.bh&&D(a,b)};a.eO=B;a.bB=function(a){if("ARMATURE"==a.type||a.Xp||"WORLD"==a.type)return!0;for(var b=0;b<a.mh.length;b++){var c=a.mh[b].action.p.type;if(20==c||10==c||40==c&&"SPEAKER"==a.type||70==c&&"LAMP"==
a.type||60==c&&"MESH"==a.type)return!0}return T.cm(a)&&T.$A(a)||"MESH"==a.type&&a.yc.length?!0:!1};a.ly=function(a,b){if("ARMATURE"==b.type||L(a)||"WORLD"==b.type)return!0;for(var c=0;c<b.mh.length;c++){var d=b.mh[c].action.p.type;if(20==d||10==d||40==d&&"SPEAKER"==b.type||60==d&&"MESH"==b.type)return!0}return T.dG(a)&&T.cG(a)||"MESH"==b.type&&a.data.b4w_vertex_anim.length?!0:!1};a.is_animated=function(a){return Boolean(a.X.length)};a.jG=k;a.MI=t;a.jF=function(a){function b(a,c){for(var d=0;d<c;d++){var e=
a.subarray(8*d+4,8*d+8);Q.normalize(e,e)}}function c(a,b){if(-1<a.indexOf("location"))var d=0,e=b;else-1<a.indexOf("rotation_quaternion")?(d=4,e=0==b?3:b-1):-1<a.indexOf("scale")?(d=3,e=0):(d=0,e=b);return d+e}function d(a,b,c,g,h){if(-1<c.search(e)){a=b;c=c.split('"')[1];var k=f}else 8==h?(c="tsr",k=f):k=1<h?new Float32Array(h):0;if(!a[c]){h=a;b=c;if("object"==typeof k&&k.length)for(var l=k.length,m=new Float32Array(g*l),n=0;n<g;n++)for(var q=0;q<l;q++)m[n*l+q]=k[q];else if("number"==typeof k)for(m=
new Float32Array(g),n=0;n<g;n++)m[n]=k;else ka.q("Wrong storage default value");h[b]=m}return a[c]}var e=new RegExp(/pose.bones\[\".+\"\]/g),f=ea.create(),g=a.p={type:0,Ev:0,jB:0,V:null,zt:null,ey:null,hh:new Int8Array(8)};g.jB=1/Ia.ak;var h=a.fcurves,k={},l={},m=0,n;for(n in h){var q=h[n],t;for(t in q){var r=q[t],w=r.De;Z.sG(r,a);r=r.num_channels;m||(m=w.length);for(var r=d(k,l,n,m,r),p=r.length/m,J=c(n,t|0),B=0;B<m;B++)r[B*p+J]=w[B]}}if(ka.jo(k)){for(var x in k)"tsr"==x&&b(k[x],m);g.V=k}if(ka.jo(l)){for(var L in l)b(l[L],
m);g.zt=l}g.Ev=m;g.ey=a.aF;"tsr"in k&&u(h,g.hh);("color"in k||"energy"in k)&&v(h,g.hh);("light_settings.environment_energy"in k||"horizon_color"in k||"zenith_color"in k||"mist_settings.intensity"in k||"mist_settings.depth"in k||"mist_settings.start"in k||"mist_settings.height"in k||"b4w_fog_color"in k)&&z(h,g.hh);M(a);ia.push(a)};a.uJ=function(a,b){return(b-a)*Ia.ak+1};a.JF=function(a,b,c,d,e,f){var g=new Float32Array(2),h=new Float32Array(2),k=new Float32Array(2),l=new Float32Array(2),m=b[1],n=b[2],
q=b[a.last_frame_offset+1];a=b[a.last_frame_offset+2];for(var t=0,r=0,v=null;e<=f;e++)if(e<m)for(var u=0;u<Ia.ak;u++)c[t++]=n;else if(e>q)for(u=0;u<Ia.ak;u++)c[t++]=a;else{var w=b[r],p=3;0===w&&(p+=2);0===v&&(p+=2);var J=2===w?0:1;if(b[r+1]==b[r+p+1])v=w,r+=p;else{u=0;e==b[r+1]&&(J&&(d[t]=1),c[t]=b[r+2],t++,u++);if(e==q)for(;u<Ia.ak;u++)c[t++]=a;else for(g[0]=b[r+1],g[1]=b[r+2],0!==w?(h[0]=0,h[1]=0):0===v?(h[0]=b[r+5],h[1]=b[r+6]):(h[0]=b[r+3],h[1]=b[r+4]),0!==w?(k[0]=0,k[1]=0):(k[0]=b[r+p+3],k[1]=
b[r+p+4]),l[0]=b[r+p+1],l[1]=b[r+p+2];u<Ia.ak;u++){var z=e+u/Ia.ak;switch(w){case 0:var B=g,x=h,L=k,D=l,y=[],A=[],V=void 0,I=void 0,F=void 0,V=void 0;y[0]=B[0]-x[0];y[1]=B[1]-x[1];A[0]=D[0]-L[0];A[1]=D[1]-L[1];F=D[0]-B[0];V=Math.abs(y[0]);I=Math.abs(A[0]);0!=V+I&&V+I>F&&(V=F/(V+I),x[0]=B[0]-V*y[0],x[1]=B[1]-V*y[1],L[0]=D[0]-V*A[0],L[1]=D[1]-V*A[1]);J&&(d[t]=1);c[t]=C(S(0,1,z,g[0],h[0],k[0],l[0]),g[1],h[1],k[1],l[1]);t++;break;case 1:J&&(d[t]=1);B=g[0];x=g[1];L=(l[1]-x)/(l[0]-B);c[t]=L*z+(x-L*B);t++;
break;case 2:J&&(d[t]=1);c[t]=b[r+2];t++;break;default:ka.q("Unknown keyframe interpolation mode: "+w)}}e+1==b[r+p+1]&&(v=w,r+=p)}}};a.apply=K;a.FF=function(a,b,c,e){e=e||0;var f=ka.keysearch("uuid",c,ia);if(f){W(a,e);if(d(a,b,f,e)){F(a,e);return}a.X[e]=null}O.error('Unsupported object: "'+a.name+'" or animation uuid: "'+c+'"')};a.TC=function(a,b){var c=ka.keysearch("name",b,ia)||ka.keysearch("name",b+"_B4W_BAKED",ia);if(c){if(0==c.p.type)return!1}else if(!(N(a,b)||ga.is_mesh(a)&&X(a,b)))return!1;
return!0};a.get_slot_num_by_anim=function(a,b){for(var c=a.X,d=0;d<c.length;d++){var e=c[d];if(e&&n(e.dh)==n(b))return d}return-1};a.sJ=function(a,b){var c=a.X[b];return c&&c.dh?n(c.dh):null};a.remove=function(a){a.X.length=0;a=Ea.indexOf(a);-1!=a&&Ea.splice(a,1)};a.ML=function(a){for(var b=ia.length-1;0<=b;b--)ia[b].bF==a&&ia.splice(b,1)};a.apply_to_first_empty_slot=function(a,b){if(!a.X.length)return K(a,b,0)?0:-1;for(var c=0;c<a.X.length;c++)if(!a.X[c])return K(a,b,c)?c:-1};a.set_skel_mix_factor=
function(a,b,c){a.k.cn=(b-a.k.og)/c;a.k.bn=b};a.set_speed=function(a,b,c){q(a.X,c,function(a){a.speed=b})};a.get_speed=function(a,b){return a.X[b].speed};a.get_anim_start_frame=function(a,b){return a.X[b].start};a.get_anim_length=function(a,b){return a.X[b].length};a.cleanup=function(){Ea.length=0;ia.length=0};a.OI=function(a){var b=(a[0]||a[1]||a[2]).De.length,c=V,d=J,e=Boolean(a[0]);e||(a[0]={De:new Float32Array(b),num_channels:8});var f=Boolean(a[1]);f||(a[1]={De:new Float32Array(b),num_channels:8});
var g=Boolean(a[2]);g||(a[2]={De:new Float32Array(b),num_channels:8});a[3]={De:new Float32Array(b),num_channels:8};for(var h=0;h<b;h++)d[0]=e?a[0].De[h]:0,d[1]=f?a[1].De[h]:0,d[2]=g?a[2].De[h]:0,ka.euler_to_quat(d,c),a[0].De[h]=c[3],a[1].De[h]=c[0],a[2].De[h]=c[1],a[3].De[h]=c[2]};a.Jz=L;a.bN=function(a,b){for(var c=7,d=0,e=0;e<ia.length;e++){var f=ia[e];if(f.name==b){d=f.p.type;break}}0==d&&(X(a,b)?d=30:(e=N(a,name))&&"EMITTER"==e.Mr&&(d=50));for(e=0;8>e;e++)if(f=a.X[e]){if(f.type==d)return e}else e<
c&&(c=e);return c}};b4w.module.__time=function(a,p){function e(){return-1!==c.zj.Iq?c.zj.Iq:q}var c=p("__config");p("__print");var b=0,n=0,h=[],r=0,g=0,m=[],q=-1;a.LB=function(a){b=a;n=performance.now();for(a=0;a<h.length;a++){var c=h[a];b>c.su&&(h.splice(a,1),a--,c.callback())}for(a=0;a<m.length;a++){var c=m[a],e=1-(c.su-b)/c.duration,e=Math.min(e,1);c.callback(c.from+e*(c.to-c.from));1==e&&(m.splice(a,1),a--)}};a.get_timeline=function(){return b};a.set_timeout=function(a,c){var e;r++;e=r;h.push({id:e,callback:a,su:b+
(performance.now()-n+c)/1E3});return e};a.clear_timeout=function(a){for(var b=0;b<h.length;b++)if(h[b].id==a){h.splice(b,1);break}};a.clear_animation=function(a){for(var b=m.length;b--;)if(m[b].id==a){m.splice(b,1);break}};a.animate=function(a,c,e,f){e/=1E3;var h;g++;h=g;m.push({id:h,callback:f,from:a,to:c,su:b+e,duration:e});f(a);return h};a.reset=function(){n=b=0;h.length=0;g=r=m.length=0};a.Qc=e;a.wM=function(a){q=a};a.get_frame=function(a){return a*e()}};b4w.module.__transform=function(a,p){function e(a,b){q.qf(a)?w.set_trans(b,q.pf(a)):w.set_trans(b,a.k.m)}function c(a,b){var c=a.k;if(q.qf(a)){w.set_quat(b,c.m);var d=q.Kq(a),d=w.invert(d,k);w.multiply(d,c.m,q.pf(a))}else w.set_quat(b,c.m)}function b(a,b){q.qf(a)?w.set_quat(b,q.pf(a)):w.set_quat(b,a.k.m)}function n(a,b){q.qf(a)?w.copy(b,q.pf(a)):w.copy(b,a.k.m)}function h(a,b){q.qf(a)?w.copy(q.pf(a),b):w.copy(a.k.m,b);return b}function r(a){var b=a.k,c=a.C,e=a.type;"CAMERA"==e&&m.Yw(a);q.$N(a,M);
"CAMERA"==e&&m.XN(a);var f=w.cc(b.m,A),h=w.xd(b.m,x);g.fh(b.U,b.m,b.K);g.At(b.jf,b.m,b.Dc);g.pl(b.Ca,b.m,b.Z);if(!b.Uj)for(var n=0;n<c.length;n++)for(var t=c[n].P,p=0;p<t.length;p++){var L=t[p];g.fh(L.U,b.m,L.K);g.pl(L.Ca,b.m,L.Z)}switch(e){case "MESH":w.EN(a.k.m,a.k.wp);a.QA&&w.invert(a.k.wp,a.k.Ss);if(t=a.Xp)w.invert(t.k.m,k),w.multiply(k,b.m,k),w.TJ(k,b.gn),w.xd(k,b.fn);b.bo=!0;break;case "CAMERA":for(n=0;n<c.length;n++)m.YN(a,c[n]);break;case "SPEAKER":D.kN(a,M,u);break;case "LAMP":B.cO(a)}for(n=
0;n<c.length;n++)if(p=c[n],p.er){t=p.Ra;L=t.p;switch(e){case "MESH":b.nd&&H.iw(t);L=p.jh;null!=b.fe&&L&&H.HC(L,f);break;case "EMPTY":d.aO(a);break;case "CAMERA":H.gM(t);if(L.od){L.od.enable_csm&&H.iw(t);var y=l.fa(a,t).R[0];H.mO(y,L.Oa)}H.get_active()==t&&H.gk(t)==a&&D.LK(t,f,h,M,u);break;case "LAMP":H.Jm(a,t)}L=p.Lg;y=a.To;if(y.length)for(p=0;p<L.length;p++){var G=L[p].o;H.JC(L[p],f,h);l.KC(y,G.Fb);m.RM(G,H.gk(t));E.Al(G.Jc,G.Ag)}}b=a.ee;for(n=0;n<b.length;n++)r(b[n]);a=a.St;for(n=0;n<a.length;n++)b=
a[n],t=b[0],q.UN(t,b[1])}var g=p("__boundings"),m=p("__camera"),q=p("__constraints"),B=p("__lights"),d=p("__objects"),l=p("__obj_util"),f=p("__quat"),H=p("__scenes"),D=p("__sfx"),w=p("__tsr"),E=p("__util"),y=p("__vec3"),A=new Float32Array(3),G=new Float32Array(3),x=new Float32Array(4);new Float32Array(9);var k=w.create(),t=w.create(),M=0,u=0;a.SPACE_WORLD=0;a.SPACE_LOCAL=1;a.update=function(a){M=a;u++};a.set_translation=function(a,b){var c=a.k;if(q.qf(a)){w.set_trans(b,c.m);var d=q.Kq(a),d=w.invert(d,
k);w.multiply(d,c.m,q.pf(a))}else w.set_trans(b,c.m)};a.set_translation_rel=e;a.get_translation=function(a,b){var c=w.cc(a.k.m,A);y.copy(c,b);return b};a.get_translation_rel=function(a,b){if(q.qf(a))y.copy(w.cc(q.pf(a)),b,A);else{var c=w.cc(a.k.m,A);y.copy(c,b)}return b};a.set_rotation=c;a.set_rotation_rel=b;a.get_rotation=function(a,b){var c=w.xd(a.k.m,x);f.copy(c,b);return b};a.get_rotation_rel=function(a,b){if(q.qf(a))f.copy(w.xd(q.pf(a)),b,x);else{var c=w.xd(a.k.m,x);f.copy(c,b)}return b};a.set_rotation_euler=
function(a,b){var d=E.euler_to_quat(b,x);c(a,d)};a.set_rotation_euler_rel=function(a,c){var d=E.euler_to_quat(c,x);b(a,d)};a.set_scale=function(a,b){var c=a.k;if(q.qf(a)){var c=q.pf(a),d=w.get_scale(q.Kq(a));w.set_scale(b/d,c)}else w.set_scale(b,c.m)};a.set_scale_rel=function(a,b){var c=a.k;q.qf(a)?w.set_scale(b,q.pf(a)):w.set_scale(b,c.m)};a.get_scale=function(a){return w.get_scale(a.k.m)};a.get_scale_rel=function(a){return q.qf(a)?w.get_scale(q.pf(a)):w.get_scale(a.k.m)};a.set_tsr=function(a,b){w.copy(b,
a.k.m);if(q.qf(a)){var c=q.Kq(a),c=w.invert(c,k);w.multiply(c,a.k.m,q.pf(a))}};a.set_tsr_rel=n;a.get_tsr=function(a,b){return w.copy(a.k.m,b)};a.get_tsr_rel=h;a.get_object_size=function(a){var b=a.k;a=b.di;var c=w.get_scale(b.m),b=c*(a.max_x-a.min_x),d=c*(a.max_y-a.min_y);a=c*(a.max_z-a.min_z);return.5*Math.sqrt(b*b+d*d+a*a)};a.get_object_center=function(a,b,c){c||(c=new Float32Array(3));b?(a=a.k,y.copy(a.Dc.J,c)):(a=a.k,b=a.di,c[0]=(b.max_x+b.min_x)/2,c[1]=(b.max_y+b.min_y)/2,c[2]=(b.max_z+b.min_z)/
2,w.transform_vec3(c,a.m,c));return c};a.move_local=function(a,b,c,d){var f=h(a,k),g=A;g[0]=b;g[1]=c;g[2]=d;w.transform_vec3(g,f,g);e(a,g)};a.ew=function(a,b){var c=h(a,k),d=w.set_quat(b,w.identity(t));w.multiply(c,d,d);n(a,d)};a.u=r;a.distance=function(a,b){var c=w.cc(a.k.m,A),d=w.cc(b.k.m,G);return y.dist(c,d)};a.dm=function(a,b){var c=w.cc(a.k.m,A);return y.dist(c,b)};a.get_object_bounding_box=function(a){return{max_x:a.k.K.max_x,min_x:a.k.K.min_x,max_y:a.k.K.max_y,min_y:a.k.K.min_y,max_z:a.k.K.max_z,
min_z:a.k.K.min_z}}};b4w.module.__tsr=function(a,p){function e(){var a=new Float32Array(8);a[3]=1;a[7]=1;return a}function c(){var a=new Float32Array(9);a[3]=1;a[7]=1;return a}function b(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];b[4]=a[4];b[5]=a[5];b[6]=a[6];b[7]=a[7];return b}function n(a,b,c,d){d[0]=a[0];d[1]=a[1];d[2]=a[2];d[3]=b;d[4]=c[0];d[5]=c[1];d[6]=c[2];d[7]=c[3];return d}function h(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],l=b[5],m=b[6];b=b[7];var n=a[0]*g,q=a[1]*g,r=a[2]*g;a=b*n+l*r-m*q;var g=b*q+m*
n-h*r,p=b*r+h*q-l*n,n=-h*n-l*q-m*r;c[0]=a*b+n*-h+g*-m-p*-l;c[1]=g*b+n*-l+p*-h-a*-m;c[2]=p*b+n*-m+a*-l-g*-h;c[0]+=d;c[1]+=e;c[2]+=f;return c}var r=p("__mat4"),g=p("__quat"),m=p("__util"),q=p("__vec3"),B=Math.sin(-Math.PI/4),d=-B,l=new Float32Array(3),f=new Float32Array(4),H=new Float32Array(16);a.create=e;a.clone=function(a){var c=e();b(a,c);return c};a.from_values=function(a,b,c,d,f,g,h,k){var l=e();l[0]=a;l[1]=b;l[2]=c;l[3]=d;l[4]=f;l[5]=g;l[6]=h;l[7]=k;return l};a.sg=c;a.UP=function(a){var d=c();
b(a,d);return d};a.sQ=function(a,b,d,e,f,g,h,k){var l=c();l[0]=a;l[1]=b;l[2]=d;l[3]=e;l[4]=f;l[5]=g;l[6]=h;l[7]=k;return l};a.copy=b;a.identity=function(a){a[0]=0;a[1]=0;a[2]=0;a[3]=1;a[4]=0;a[5]=0;a[6]=0;a[7]=1;return a};a.set_sep=n;a.set_trans=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.set_scale=function(a,b){b[3]=a;return b};a.set_transcale=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b};a.set_quat=function(a,b){b[4]=a[0];b[5]=a[1];b[6]=a[2];b[7]=a[3];return b};a.get_trans_view=
function(a){return a.subarray(0,3)};a.cc=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.get_scale=function(a){return a[3]};a.TJ=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3]};a.get_quat_view=function(a){return a.subarray(4,8)};a.xd=function(a,b){b[0]=a[4];b[1]=a[5];b[2]=a[6];b[3]=a[7];return b};a.invert=function(a,b){var c=1/a[3];if(!c)return null;var d=a[0],e=a[1],h=a[2];f[0]=a[4];f[1]=a[5];f[2]=a[6];f[3]=a[7];g.invert(f,f);var l=f[0],k=f[1],m=f[2],n=f[3],d=d*c,e=e*c,q=h*c,h=n*d+
k*q-m*e,r=n*e+m*d-l*q,p=n*q+l*e-k*d,d=-l*d-k*e-m*q;b[0]=-(h*n+d*-l+r*-m-p*-k);b[1]=-(r*n+d*-k+p*-l-h*-m);b[2]=-(p*n+d*-m+h*-k-r*-l);b[3]=c;b[4]=l;b[5]=k;b[6]=m;b[7]=n;return b};a.to_mat4=function(a,b){var c=a[3];r.fromRotationTranslation(a.subarray(4,8),a.subarray(0,3),b);for(var d=0;12>d;d++)b[d]*=c;return b};a.from_mat4=function(a,b){var c=m.IA(a,l),d=m.HA(a),e=m.matrix_to_quat(a,f);n(c,d,e,b);return b};a.multiply=function(a,b,c){h(b,a,c);c[3]=a[3]*b[3];var d=a[4],e=a[5],f=a[6];a=a[7];var g=b[4],
k=b[5],l=b[6];b=b[7];c[4]=d*b+a*g+e*l-f*k;c[5]=e*b+a*k+f*g-d*l;c[6]=f*b+a*l+d*k-e*g;c[7]=a*b-d*g-e*k-f*l;return c};a.JN=function(a,b,c){var d=b[3];b=r.fromRotationTranslation(b.subarray(4,8),b.subarray(0,3),H);for(var e=0;12>e;e++)b[e]*=d;r.multiply(b,a,c);return c};a.transform_vec3=h;a.transform_vec3_inv=function(a,b,c){var d=b[3],e=a[0]-b[0],f=a[1]-b[1],g=a[2]-b[2];a=b[4];var h=b[5],l=b[6];b=b[7];var m=a*a+h*h+l*l+b*b,m=m?1/m:0;a=-a*m;h=-h*m;l=-l*m;b*=m;var m=b*e+h*g-l*f,n=b*f+l*e-a*g,q=b*g+a*f-
h*e,e=-a*e-h*f-l*g;c[0]=m*b+e*-a+n*-l-q*-h;c[1]=n*b+e*-h+q*-a-m*-l;c[2]=q*b+e*-l+m*-h-n*-a;c[0]/=d;c[1]/=d;c[2]/=d;return c};a.transform_vectors=function(a,b,c,d){d||(d=0);var e=a.length,f=b[0],g=b[1],h=b[2],l=b[3],m=b[4],n=b[5],q=b[6];b=b[7];for(var r=0;r<e;r+=3){var p=a[r]*l,B=a[r+1]*l,H=a[r+2]*l,F=b*p+n*H-q*B,K=b*B+q*p-m*H,X=b*H+m*B-n*p,p=-m*p-n*B-q*H;c[d+r]=F*b+p*-m+K*-q-X*-n;c[d+r+1]=K*b+p*-n+X*-m-F*-q;c[d+r+2]=X*b+p*-q+F*-n-K*-m;c[d+r]+=f;c[d+r+1]+=g;c[d+r+2]+=h}return c};a.transform_dir_vectors=
function(a,b,c,d){d||(d=0);var e=a.length,f=b[3],g=b[4],h=b[5],l=b[6];b=b[7];for(var m=0;m<e;m+=3){var n=a[m]*f,q=a[m+1]*f,r=a[m+2]*f,p=b*n+h*r-l*q,B=b*q+l*n-g*r,H=b*r+g*q-h*n,n=-g*n-h*q-l*r;c[d+m]=p*b+n*-g+B*-l-H*-h;c[d+m+1]=B*b+n*-h+H*-g-p*-l;c[d+m+2]=H*b+n*-l+p*-h-B*-g}return c};a.transform_dir_vec3=function(a,b,c){var d=b[3],e=b[4],f=b[5],g=b[6];b=b[7];var h=a[0]*d,l=a[1]*d,m=a[2]*d;a=b*h+f*m-g*l;var d=b*l+g*h-e*m,n=b*m+e*l-f*h,h=-e*h-f*l-g*m;c[0]=a*b+h*-e+d*-g-n*-f;c[1]=d*b+h*-f+n*-e-a*-g;c[2]=
n*b+h*-g+a*-f-d*-e;return c};a.transform_tangents=function(a,b,c,d){d||(d=0);var e=a.length,f=b[3],g=b[4],h=b[5],l=b[6];b=b[7];for(var m=0;m<e;m+=4){var n=a[m]*f,q=a[m+1]*f,r=a[m+2]*f,p=b*n+h*r-l*q,B=b*q+l*n-g*r,H=b*r+g*q-h*n,n=-g*n-h*q-l*r;c[d+m]=p*b+n*-g+B*-l-H*-h;c[d+m+1]=B*b+n*-h+H*-g-p*-l;c[d+m+2]=H*b+n*-l+p*-h-B*-g;c[d+m+3]=a[m+3]}return c};a.translate=function(a,b,c){var d=a[3],e=a[4],f=a[5],g=a[6],h=a[7],l=b[0]*d,m=b[1]*d,n=b[2]*d;b=h*l+f*n-g*m;var d=h*m+g*l-e*n,q=h*n+e*m-f*l,l=-e*l-f*m-g*
n;c[0]=a[0]+b*h+l*-e+d*-g-q*-f;c[1]=a[1]+d*h+l*-f+q*-e-b*-g;c[2]=a[2]+q*h+l*-g+b*-f-d*-e;c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];return c};a.interpolate=function(a,b,c,d){q.lerp(a.subarray(0,3),b.subarray(0,3),c,d.subarray(0,3));var e=a[3];d[3]=e+c*(b[3]-e);g.slerp(a.subarray(4,8),b.subarray(4,8),c,d.subarray(4,8));return d};a.kQ=function(a,b,c,d){var e=a.subarray(0,3),f=b.subarray(0,3),h=d.subarray(0,3);h[0]=f[0]*(c+1)-e[0]*c;h[1]=f[1]*(c+1)-e[1]*c;h[2]=f[2]*(c+1)-e[2]*c;d[3]=b[3]*(c+1)-
a[3]*c;a=a.subarray(4,8);b=b.subarray(4,8);e=d.subarray(4,8);e[0]=b[0]*(c+1)-a[0]*c;e[1]=b[1]*(c+1)-a[1]*c;e[2]=b[2]*(c+1)-a[2]*c;e[3]=b[3]*(c+1)-a[3]*c;g.normalize(e,e);return d};a.gK=function(a,b,c,d,e){e[0]=a[0]+b*c[0];e[1]=a[1]+b*c[1];e[2]=a[2]+b*c[2];e[3]=a[3];c=d[0];var f=d[1];d=d[2];var g=a[4],h=a[5],l=a[6],m=a[7];e[4]=.5*(c*m+f*l-d*h);e[5]=.5*(f*m+d*g-c*l);e[6]=.5*(d*m+c*h-f*g);e[7]=.5*(-c*g-f*h-d*l);e[4]=a[4]+e[4]*b;e[5]=a[5]+e[5]*b;e[6]=a[6]+e[6]*b;e[7]=a[7]+e[7]*b;a=e[4];b=e[5];c=e[6];
f=e[7];a=a*a+b*b+c*c+f*f;0<a&&(a=1/Math.sqrt(a),e[4]*=a,e[5]*=a,e[6]*=a,e[7]*=a)};a.yC=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];var c=a[4],e=a[5],f=a[6],g=a[7];b[4]=c*d+g*B;b[5]=e*d+f*B;b[6]=f*d-e*B;b[7]=g*d-c*B};a.EN=function(a,b){b[0]=a[0];b[1]=-a[2];b[2]=a[1];b[3]=a[3];b[4]=a[4];b[5]=-a[6];b[6]=a[5];b[7]=a[7]}};b4w.module.__util=function(a,p){function e(a){return 0<a?1:0>a?-1:0}function c(a){var b=a[0],c=a[1],d=a[2],e=a[3],f=Math.sqrt(b*b+c*c+d*d),f=1/f;a[0]=b*f;a[1]=c*f;a[2]=d*f;a[3]=e*f}function b(a,c){var e=c;switch(typeof a){case "object":if(a)switch(a.constructor){case Object:for(var f in a)e=b(a[f],e);break;case Float32Array:case Uint32Array:case Int8Array:case Uint8Array:case Int16Array:case Uint16Array:case Int32Array:case Float64Array:for(f=0;f<a.length;f++)e=n(a[f],e);break;case Array:for(f=0;f<
a.length;f++)e=b(a[f],e);break;case WebGLUniformLocation:case WebGLProgram:case WebGLShader:case WebGLFramebuffer:case WebGLTexture:case WebGLBuffer:e=n(0,e);break;default:d("Wrong object constructor")}else e=n(0,e);return e;case "number":return n(a,e);case "boolean":return n(a|0,e);case "string":return h(a,e);case "function":case "undefined":return n(0,e)}}function n(a,b){var c=b;P[0]=a;c=(c<<5)-c+da[0];c&=c;c=(c<<5)-c+da[1];return c&c}function h(a,b){for(var c=b,d=0;d<a.length;d++)c=(c<<5)-c+a.charCodeAt(d),
c&=c;return c}function r(a){return(34*a+1)*a%289}function g(a){return a-Math.floor(a)}function m(a){return q((34*a+5)*a)}function q(a){return a-289*Math.floor(a/289)}function B(a){return a-7*Math.floor(a/7)}function d(a){a&&x.error.apply(x,arguments);throw"engine panic:\nThe engine tried to perform an invalid operation and halted.\nPlease copy the console contents above and submit it to the Blend4Web forum at\nhttps://www.blend4web.com/en/forums/forum/17/";}function l(a,b,c){a-=b;c-=b;return b+(a-
Math.floor(a/c)*c)}function f(a){return l(a,0,2*Math.PI)}function H(a,b){if(a&&b){var c=a instanceof Array;if(c!=b instanceof Array)return!1;var d=a.buffer instanceof ArrayBuffer&&"undefined"!==a.byteLength;if(d!=(b.buffer instanceof ArrayBuffer&&"undefined"!==b.byteLength))return!1;if(c){if(a.length!=b.length)return!1;for(c=0;c<a.length;c++)if(!D(a[c],b[c]))return!1}else if(d){if(a.length!=b.length)return!1;for(c=0;c<a.length;c++)if(a[c]!=b[c])return!1}else{switch(a.constructor){case WebGLUniformLocation:case WebGLProgram:case WebGLShader:case WebGLFramebuffer:case WebGLTexture:case WebGLBuffer:return a==
b}for(var e in a)if(!D(a[e],b[e]))return!1;for(e in b)if(!(e in a))return!1}return!0}return!(a||b)}function D(a,b){if(typeof a!=typeof b)return!1;switch(typeof a){case "number":case "string":case "boolean":return a==b;case "object":return H(a,b);default:return!0}}function w(a){if(""==a)return".";var b=0==a.indexOf("/")|0;b&&0==a.indexOf("//")&&0!=a.indexOf("///")&&(b=2);a=a.split("/");for(var c=[],d=0;d<a.length;d++){var e=a[d];""!=e&&"."!=e&&(".."!=e||!b&&!c.length||c.length&&".."==c[c.length-1]?
c.push(e):c.length&&c.pop())}a=c.join("/");for(d=0;d<b;d++)a="/"+a;return a||"."}var E=p("__boundings"),y=p("__mat3"),A=p("__mat4"),G=p("__math"),x=p("__print"),k=p("__tsr"),t=p("__quat"),M=p("__vec3"),u=p("__vec4"),v=0,z={},S=[oa,ha,ea,ka,I],C=new Float32Array(3),W=new Float32Array(3),F=new Float32Array(4),K=new Float32Array(4),X=new Float32Array(9),N=new Float32Array(16),L=new Float32Array(16),P=new Float64Array(1),da=new Uint32Array(P.buffer),U=new Float32Array([0,0,0]),ga=new Float32Array([0,
0,0,1]),T=new Float32Array([0,0,0,1,0,0,0,1]),la=new Float32Array([1,1,1]),O=new Float32Array([1,0,0]),Q=new Float32Array([0,1,0]),Z=new Float32Array([0,0,1]),ma=new Float32Array([-1,0,0]),ra=new Float32Array([0,-1,0]),ja=new Float32Array([0,0,-1]),oa=0,ha=1,ea=2,ka=4,I=5,Ia=Math.floor(44488.07041494893),Aa=[new Float32Array([0,0,-1,0,0,-1,0,0,-1,0,0,0,0,0,0,1]),new Float32Array([0,0,1,0,0,-1,0,0,1,0,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,0,-1,0,0,1,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,0,
1,0,0,-1,0,0,0,0,0,1]),new Float32Array([1,0,0,0,0,-1,0,0,0,0,-1,0,0,0,0,1]),new Float32Array([-1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1])];a.Gx=U;a.gt=ga;a.xP=T;a.lt=la;a.AXIS_X=O;a.AXIS_Y=Q;a.AXIS_Z=Z;a.AXIS_MX=ma;a.AXIS_MY=ra;a.AXIS_MZ=ja;a.XYX=oa;a.YZY=ha;a.ZXZ=ea;a.XZX=3;a.YXY=ka;a.ZYZ=I;a.XYZ=6;a.YZX=7;a.ZXY=8;a.XZY=9;a.YXZ=10;a.ZYX=11;a.vD=Aa;a.sf=function(a){return"undefined"!=typeof a};a.keyfind=function(a,b,c){for(var d=[],e=c.length,f=0;f<e;f++){var g=c[f];g[a]==b&&d.push(g)}return d};a.f32=function(a){return new Float32Array(a)};
a.UI=function(a,b){var c=a.length,d=new Float32Array(c+b.length);d.set(a);d.set(b,c);return d};a.LN=function(a,b){var c=a.length,d=new Uint32Array(c+b.length);d.set(a);d.set(b,c);return d};a.zG=function(){var a=new Uint16Array([255]);return 255==(new DataView(a.buffer)).getUint16(0,!0)};a.KF=function(a,b){var c=[],d={},e=b.length,f,g;for(f=0;f<e;f++)d[b[f]]=!0;e=a.length;for(f=0;f<e;f++)g=a[f],g in d&&c.push(g);return c};a.sign=e;a.eR=function(a,b,c){for(var d=c.length,e=0;e<d;e++)if(c[e][a]==b)return!0;
return!1};a.keysearch=function(a,b,c){for(var d=0;d<c.length;d++){var e=c[d];if(e[a]===b)return e}return null};a.cR=function(a,b,c,d,e){for(var f=0;f<e.length;f++){var g=e[f];if(g[a]==b&&g[c]==d)return g}return null};a.IJ=function(a,b){for(var c=0;c<a.length;c++)if(a[c].uuid==b)return c;return-1};a.EF=function(a,b){for(var c=0;c<a.length;c++)if(a[c]==b)return;a.push(b)};a.SP=function(a){for(var b=0;b<a.length-1;b++)for(var c=a[b],d=b+1;d<a.length;d++)if(c==a[d])return!1;return!0};a.GN=function(a,
b,c,d){d||(d=new Float32Array(16));A.identity(d);d[12]=a;d[13]=b;d[14]=c};var qa=1;a.JL=function(){qa=(69069*qa+5)%Math.pow(2,32);return Math.round(qa/65536)%32768/32767};a.rN=function(a){qa=a};a.yf=function(a){var b=a[0]%Ia*48271-3399*Math.floor(a[0]/Ia);a[0]=0<b?b:b+2147483647;return(a[0]-1)/2147483646};a.cr=function(a,b){b||(b=[]);b[0]=5E4+Math.floor(a);return b};a.euler_to_quat=function(a,b){b||(b=new Float32Array(4));var c=Math.cos(a[1]/2),d=Math.cos(a[2]/2),e=Math.cos(a[0]/2),f=Math.sin(a[1]/
2),g=Math.sin(a[2]/2),h=Math.sin(a[0]/2);b[0]=c*d*h+f*g*e;b[1]=f*d*e+c*g*h;b[2]=c*g*e-f*d*h;b[3]=c*d*e-f*g*h;return b};a.ordered_angles_to_quat=function(a,b,c){var d=a[0],e=a[1];a=a[2];var f=Math.cos(d/2),g=Math.cos(e/2),h=Math.cos(a/2),k=Math.sin(d/2),e=Math.sin(e/2),l=Math.sin(a/2);if(-1<S.indexOf(b))var m=Math.cos((d+a)/2),n=Math.sin((d+a)/2),q=Math.cos((d-a)/2),t=Math.sin((d-a)/2),r=Math.cos((a-d)/2),u=Math.sin((a-d)/2);switch(b){case oa:c[0]=g*n;c[1]=e*q;c[2]=e*t;c[3]=g*m;break;case ha:c[0]=
e*t;c[1]=g*n;c[2]=e*q;c[3]=g*m;break;case ea:c[0]=e*q;c[1]=e*t;c[2]=g*n;c[3]=g*m;break;case 3:c[0]=g*n;c[1]=e*u;c[2]=e*r;c[3]=g*m;break;case ka:c[0]=e*r;c[1]=g*n;c[2]=e*u;c[3]=g*m;break;case I:c[0]=e*u;c[1]=e*r;c[2]=g*n;c[3]=g*m;break;case 6:c[0]=k*g*h+f*e*l;c[1]=f*e*h-k*g*l;c[2]=f*g*l+k*e*h;c[3]=f*g*h-k*e*l;break;case 7:c[0]=f*g*l+k*e*h;c[1]=k*g*h+f*e*l;c[2]=f*e*h-k*g*l;c[3]=f*g*h-k*e*l;break;case 8:c[0]=f*e*h-k*g*l;c[1]=f*g*l+k*e*h;c[2]=k*g*h+f*e*l;c[3]=f*g*h-k*e*l;break;case 9:c[0]=k*g*h-f*e*l;
c[1]=f*g*l-k*e*h;c[2]=f*e*h+k*g*l;c[3]=f*g*h+k*e*l;break;case 10:c[0]=f*e*h+k*g*l;c[1]=k*g*h-f*e*l;c[2]=f*g*l-k*e*h;c[3]=f*g*h+k*e*l;break;case 11:c[0]=f*g*l-k*e*h,c[1]=f*e*h+k*g*l,c[2]=k*g*h-f*e*l,c[3]=f*g*h+k*e*l}return c};a.quat_to_ordered_angles=function(a,b,c){var d=a[0],e=a[1],f=a[2];a=a[3];switch(b){case oa:c[0]=Math.atan2(d*e+f*a,e*a-d*f);c[1]=Math.acos(1-2*(e*e+f*f));c[2]=Math.atan2(d*e-f*a,d*f+e*a);break;case ha:c[0]=Math.atan2(d*a+e*f,f*a-d*e);c[1]=Math.acos(1-2*(d*d+f*f));c[2]=Math.atan2(e*
f-d*a,d*e+f*a);break;case ea:c[0]=Math.atan2(d*f+e*a,d*a-e*f);c[1]=Math.acos(1-2*(d*d+e*e));c[2]=Math.atan2(d*f-e*a,d*a+e*f);break;case 3:c[0]=Math.atan2(d*f-e*a,d*e+f*a);c[1]=Math.acos(1-2*(e*e+f*f));c[2]=Math.atan2(d*f+e*a,f*a-d*e);break;case ka:c[0]=Math.atan2(d*e-f*a,d*a+e*f);c[1]=Math.acos(1-2*(d*d+f*f));c[2]=Math.atan2(d*e+f*a,d*a-e*f);break;case I:c[0]=Math.atan2(e*f-d*a,d*f+e*a);c[1]=Math.acos(1-2*(d*d+e*e));c[2]=Math.atan2(d*a+e*f,e*a-d*f);break;case 6:c[0]=Math.atan2(2*(d*a-e*f),1-2*(d*
d+e*e));c[1]=Math.asin(2*(d*f+e*a));c[2]=Math.atan2(2*(f*a-d*e),1-2*(e*e+f*f));break;case 7:c[0]=Math.atan2(2*(e*a-d*f),1-2*(e*e+f*f));c[1]=Math.asin(2*(d*e+f*a));c[2]=Math.atan2(2*(d*a-e*f),1-2*(d*d+f*f));break;case 8:c[0]=Math.atan2(2*(f*a-d*e),1-2*(d*d+f*f));c[1]=Math.asin(2*(d*a+e*f));c[2]=Math.atan2(2*(e*a-d*f),1-2*(d*d+e*e));break;case 9:c[0]=Math.atan2(2*(d*a+e*f),1-2*(d*d+f*f));c[1]=Math.asin(2*(f*a-d*e));c[2]=Math.atan2(2*(d*f+e*a),1-2*(e*e+f*f));break;case 10:c[0]=Math.atan2(2*(d*f+e*a),
1-2*(d*d+e*e));c[1]=Math.asin(2*(d*a-e*f));c[2]=Math.atan2(2*(d*e+f*a),1-2*(d*d+f*f));break;case 11:c[0]=Math.atan2(2*(d*e+f*a),1-2*(e*e+f*f)),c[1]=Math.asin(2*(e*a-d*f)),c[2]=Math.atan2(2*(d*a+e*f),1-2*(d*d+e*e))}return c};a.FI=function(a){var b=y.create(),c=Math.cos(a[0]),d=Math.cos(a[1]),e=Math.cos(a[2]),f=Math.sin(a[0]),g=Math.sin(a[1]);a=Math.sin(a[2]);var h=c*e,k=c*a,l=f*e,m=f*a;b[0]=d*e;b[1]=d*a;b[2]=-g;b[3]=g*l-k;b[4]=g*m+h;b[5]=d*f;b[6]=g*h+m;b[7]=g*k-l;b[8]=d*c;return b};a.quat_to_euler=
function(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],g=e*e,h=c*d+e*f;.499999<h?(b[0]=0,b[1]=2*Math.atan2(c,f),b[2]=Math.PI/2):-.499999>h?(b[0]=0,b[1]=-2*Math.atan2(c,f),b[2]=-Math.PI/2):(b[0]=Math.atan2(2*c*f-2*d*e,1-2*c*c-2*g),b[1]=Math.atan2(2*d*f-2*c*e,1-2*d*d-2*g),b[2]=Math.asin(2*c*d+2*e*f));return b};a.quat_to_dir=function(a,b,c){c||(c=new Float32Array(3));M.transformQuat(b,a,c);return c};a.dir_to_quat=function(a,b,c){c||(c=new Float32Array(4));a=M.normalize(a,C);var d=M.dot(b,a);a=M.cross(b,a,W);
d=Math.acos(d);c[0]=a[0]*Math.sin(d/2);c[1]=a[1]*Math.sin(d/2);c[2]=a[2]*Math.sin(d/2);c[3]=Math.cos(d/2);return c};a.HN=function(a,b,c,d){d||(d=new Float32Array(4));M.transformQuat(c,b,d);d[3]=-M.dot(a,d)};a.pI=function(a){var b=k.get_quat_view(a.k.m);switch(a.type){case "CAMERA":C[0]=0;C[1]=-1;C[2]=0;M.transformQuat(C,b,C);W[0]=0;W[1]=0;W[2]=-1;break;case "MESH":C[0]=0;C[1]=0;C[2]=1;M.transformQuat(C,b,C);W[0]=0;W[1]=0;W[2]=1;break;case "EMPTY":C[0]=0,C[1]=1,C[2]=0,M.transformQuat(C,b,C),W[0]=0,
W[1]=1,W[2]=0}C[1]=0;M.normalize(C,C);a=M.dot(C,W);return Math.acos(a)*(0<-C[0]*W[2]?-1:1)};a.gy=function(a,b,c,d){if(0!=c){d=d||[];for(var e=0;e<a.length;e++)d[e]=(1-c)*a[e]+c*b[e]}};a.OR=function(){v++;return v.toString(16)};a.mp=function(a){z[a]||(z[a]=0);var b=a+z[a];z[a]++;return b};a.Jf=function(){return{a_position:new Float32Array(0),a_tangent:new Float32Array(0),a_normal:new Float32Array(0)}};a.Nc=function(a){var b={a_influence:new Float32Array(0),a_color:new Float32Array(0),a_texcoord:new Float32Array(0)};
return{name:a,va:0,lb:null,O:[],ga:b,Ga:[],Rd:{K:E.Wc(),Z:E.kf(),U:E.Wc(),Ca:E.kf()},Dg:null}};a.ki=function(a){return JSON.parse(JSON.stringify(a))};a.I=function(b){if(!(b instanceof Object))return b;var c;c=b.constructor;switch(c){case Int8Array:case Uint8Array:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:c=new c(b);break;case Array:c=new c(b.length);for(var d=0;d<b.length;d++)c[d]=a.I(b[d]);break;default:for(d in c=new c,b)c[d]=a.I(b[d])}return c};
a.An=function(a){var b=a instanceof Array?[]:{},c;for(c in a)if(a[c]instanceof Object){var d=a[c].constructor;switch(d){case Int8Array:case Uint8Array:case Int16Array:case Uint16Array:case Int32Array:case Uint32Array:case Float32Array:case Float64Array:b[c]=new d(a[c]);break;case Array:b[c]=a[c].slice(0);break;default:b[c]=a[c]}}else b[c]=a[c];return b};a.matrix_to_quat=function(a,b){b||(b=new Float32Array(4));y.fromMat4(a,X);var c=X[0],d=X[3],e=X[6],f=X[1],g=X[4],h=X[7],k=X[2],l=X[5],m=X[8],c=Math.sqrt(c*
c+d*d+e*e)||1,f=Math.sqrt(f*f+g*g+h*h)||1,k=Math.sqrt(k*k+l*l+m*m)||1;X[0]/=c;X[3]/=c;X[6]/=c;X[1]/=f;X[4]/=f;X[7]/=f;X[2]/=k;X[5]/=k;X[8]/=k;t.fromMat3(X,b);t.normalize(b,b);return b};a.IA=function(a,b){b||(b=new Float32Array(3));b[0]=a[12];b[1]=a[13];b[2]=a[14];return b};a.HA=function(a){F[0]=.577350269189626;F[1]=.577350269189626;F[2]=.577350269189626;F[3]=0;u.transformMat4(F,a,F);return u.length(F)};a.Al=function(a,b){var d=b.left,e=b.right,f=b.top,g=b.bottom,h=b.near,k=b.far;d[0]=a[3]+a[0];d[1]=
a[7]+a[4];d[2]=a[11]+a[8];d[3]=a[15]+a[12];e[0]=a[3]-a[0];e[1]=a[7]-a[4];e[2]=a[11]-a[8];e[3]=a[15]-a[12];f[0]=a[3]-a[1];f[1]=a[7]-a[5];f[2]=a[11]-a[9];f[3]=a[15]-a[13];g[0]=a[3]+a[1];g[1]=a[7]+a[5];g[2]=a[11]+a[9];g[3]=a[15]+a[13];h[0]=a[3]+a[2];h[1]=a[7]+a[6];h[2]=a[11]+a[10];h[3]=a[15]+a[14];k[0]=a[3]-a[2];k[1]=a[7]-a[6];k[2]=a[11]-a[10];k[3]=a[15]-a[14];c(d);c(e);c(f);c(g);c(h);c(k)};a.mN=function(a,b,c){return c<-G.point_plane_dist(a,b.near)||c<-G.point_plane_dist(a,b.left)||c<-G.point_plane_dist(a,
b.right)||c<-G.point_plane_dist(a,b.top)||c<-G.point_plane_dist(a,b.bottom)||c<-G.point_plane_dist(a,b.far)?!0:!1};a.AI=function(a,b,c,d,e){var f=M.dot(c,b.far),g=M.dot(d,b.far),h=M.dot(e,b.far),f=Math.sqrt(f*f+g*g+h*h);if(f<-G.point_plane_dist(a,b.near)||f<-G.point_plane_dist(a,b.far))return!0;f=M.dot(c,b.left);g=M.dot(d,b.left);h=M.dot(e,b.left);if(Math.sqrt(f*f+g*g+h*h)<-G.point_plane_dist(a,b.left))return!0;f=M.dot(c,b.right);g=M.dot(d,b.right);h=M.dot(e,b.right);if(Math.sqrt(f*f+g*g+h*h)<-G.point_plane_dist(a,
b.right))return!0;f=M.dot(c,b.top);g=M.dot(d,b.top);h=M.dot(e,b.top);if(Math.sqrt(f*f+g*g+h*h)<-G.point_plane_dist(a,b.top))return!0;f=M.dot(c,b.bottom);g=M.dot(d,b.bottom);h=M.dot(e,b.bottom);return Math.sqrt(f*f+g*g+h*h)<-G.point_plane_dist(a,b.bottom)?!0:!1};a.im=function(a,b,c,d){d||(d=0);for(var e=a.length,f=0;f<e;f+=3){var g=a[f],h=a[f+1],k=a[f+2];c[d+f]=b[0]*g+b[4]*h+b[8]*k+b[12];c[d+f+1]=b[1]*g+b[5]*h+b[9]*k+b[13];c[d+f+2]=b[2]*g+b[6]*h+b[10]*k+b[14]}};a.KO=function(a,b,c){for(var d=0,d=0,
e=a.length,f=0;f<e;f+=3){var g=a[f],h=a[f+1],k=a[f+2];c[d+f]=b[0]*g+b[4]*h+b[8]*k;c[d+f+1]=b[1]*g+b[5]*h+b[9]*k;c[d+f+2]=b[2]*g+b[6]*h+b[10]*k}};a.CN=function(a,b,c){for(var d=0,d=0,e=a.length,f=0;f<e;f+=4){var g=a[f],h=a[f+1],k=a[f+2];c[d+f]=b[0]*g+b[4]*h+b[8]*k;c[d+f+1]=b[1]*g+b[5]*h+b[9]*k;c[d+f+2]=b[2]*g+b[6]*h+b[10]*k;c[d+f+3]=a[f+3]}};a.IO=function(a,b,c){c||(c=new Float32Array(3));F[0]=a[0];F[1]=a[1];F[2]=a[2];F[3]=0;u.transformMat4(F,b,F);c[0]=F[0];c[1]=F[1];c[2]=F[2]};a.mQ=function(a,b){var c=
a.length;c||d("flatten(): Wrong or empty array");var e=a[0].length;e||d("flatten(): Wrong or empty subarray");b||(b=new Float32Array(c*e));for(var f=0;f<c;f++)for(var g=0;g<e;g++)b[f*e+g]=a[f][g];return b};a.JO=function(a){for(var b=[],c=0;c<a.length;c+=3){var d=new Float32Array([a[c],a[c+1],a[c+2]]);b[c/3]=d}return b};a.aq=function(b,c,d,e){if(e<d)return d;var f=d+Math.floor((e-d)/2);return b[f]>c?a.aq(b,c,d,f-1):b[f]<c?a.aq(b,c,f+1,e):f};a.li=function(a,b){for(var c=0;c<a.length;c++)if(a[c]!=b[c])return!1;
return!0};a.VP=function(a,b,c){for(var d=0;d<a.length;d++)if(Math.abs(a[d]-b[d])>c)return!1;return!0};a.vR=function(a,b,c){c||(c=new Float32Array(16));for(var d=0;12>d;d++)c[d]=a[d]*b;c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15];return c};a.JN=function(a,b,c,d,e){e||(e=new Float32Array(16));b=A.fromRotationTranslation(c,d,N);A.multiply(b,a,e);return e};a.transform_vec3=function(a,b,c,d,e){e||(e=new Float32Array(3));c=A.fromRotationTranslation(c,d,N);1!==b&&(d=A.identity(L),b=M.set(b,b,b,C),A.scale(d,
b,d),A.multiply(c,d,c));M.transformMat4(a,c,e);return e};a.LR=function(a,b,c,d,e){e||(e=new Float32Array(4));b=A.fromRotationTranslation(c,d,N);u.transformMat4(a,b,e);return e};a.XQ=function(a,b,c,d,e){e||(e=new Float32Array(3));b=A.fromRotationTranslation(c,d,N);A.invert(b,b);M.transformMat4(a,b,e);return e};a.KR=function(a,b,c){c||(c=new Float32Array(16));A.fromRotationTranslation(b,a,c);a=a[3];for(b=0;12>b;b++)c[b]*=a;return c};a.lR=function(b,c,d){a.IA(b,c);c[3]=a.HA(b);a.matrix_to_quat(b,d)};
a.FP=function(a){for(var b=[],c=0;c<a.length;c++)b.push(a[c]);return JSON.stringify(b)};a.bM=function(a,b,c,d){d||(d=new Float32Array(3));M.subtract(b,a,C);M.transformQuat(C,c,C);M.subtract(b,C,d)};a.gJ=function(){C[0]=0;C[1]=0;C[2]=0;var a=new Float32Array(16),b=new Float32Array(16),c=new Float32Array(16),d=new Float32Array(16),e=new Float32Array(16),f=new Float32Array(16);A.lookAt(C,[-1,0,0],[0,-1,0],a);A.scale(a,[-1,1,1],a);A.scale(a,[-1,1,-1],b);A.lookAt(C,[0,-1,0],[0,0,-1],c);A.scale(c,[1,1,
-1],c);A.scale(c,[1,-1,-1],d);A.lookAt(C,[0,0,-1],[0,-1,0],e);A.scale(e,[-1,1,1],e);A.scale(e,[-1,1,-1],f);return[a,b,c,d,e,f]};a.kJ=function(){C[0]=0;C[1]=0;C[2]=0;var a=new Float32Array(16),b=new Float32Array(16),c=new Float32Array(16),d=new Float32Array(16),e=new Float32Array(16),f=new Float32Array(16);A.lookAt(C,[1,0,0],[0,-1,0],a);A.scale(a,[-1,1,-1],b);A.lookAt(C,[0,1,0],[0,0,1],c);A.scale(c,[1,-1,-1],d);A.lookAt(C,[0,0,1],[0,-1,0],e);A.scale(e,[-1,1,-1],f);return[a,b,c,d,e,f]};a.py=function(a,
c){return b(a,c)};a.hash_code=b;a.QQ=h;a.XK=function(a,b){b[15]=1;b[14]=0;b[13]=0;b[12]=0;b[11]=0;b[10]=a[8];b[9]=a[7];b[8]=a[6];b[7]=0;b[6]=a[5];b[5]=a[4];b[4]=a[3];b[3]=0;b[2]=a[2];b[1]=a[1];b[0]=a[0];return b};a.quat_to_angle_axis=function(a,b){b||(b=a);var c=a[0]*a[0]+a[1]*a[1]+a[2]*a[2];0<c?(b[3]=2*Math.acos(a[3]),c=1/Math.sqrt(c),b[0]=a[0]*c,b[1]=a[1]*c,b[2]=a[2]*c):(b[3]=0,b[0]=1,b[1]=0,b[2]=0);return b};a.trunc=function(a){return isNaN(a)||"undefined"==typeof a?NaN:a|0};a.deg_to_rad=function(a){return a*
Math.PI/180};a.rad_to_deg=function(a){return 180*a/Math.PI};a.sw=function(a){var b=.366025403784439*a[0]+.366025403784439*a[1],c=Math.floor(a[0]+b),d=Math.floor(a[1]+b),e=.211324865405187*c+.211324865405187*d,b=a[0]-c+e;a=a[1]-d+e;var f=b>a?1:0,h=1-f,e=b+.211324865405187-f,k=a+.211324865405187-h,l=b+-.577350269189626,m=a+-.577350269189626,c=c%289,d=d%289,n=r(r(d)+c),h=r(r(d+h)+c+f),q=r(r(d+1)+c+1),c=Math.max(.5-(b*b+a*a),0),d=Math.max(.5-(e*e+k*k),0),f=Math.max(.5-(l*l+m*m),0),t=2*g(.024390243902439*
n)-1,u=2*g(.024390243902439*h)-1,v=2*g(.024390243902439*q)-1,n=Math.abs(t)-.5,h=Math.abs(u)-.5,q=Math.abs(v)-.5,t=t-Math.floor(t+.5),u=u-Math.floor(u+.5),v=v-Math.floor(v+.5),c=c*c*c*c*(1.79284291400159-.85373472095314*(t*t+n*n)),d=d*d*d*d*(1.79284291400159-.85373472095314*(u*u+h*h)),f=f*f*f*f*(1.79284291400159-.85373472095314*(v*v+q*q));return 130*(c*(t*b+n*a)+d*(u*e+h*k)+f*(v*l+q*m))};a.uy=function(a){var b=1/7,c=b/2,d=q(Math.floor(a[0])),e=q(Math.floor(a[1])),f=g(a[0]);a=g(a[1]);var h=f-.5,k=f-
1.5,f=a-.5;a-=1.5;var l=m(d),n=m(d+1),t=l,d=n,l=m(l+e),n=m(n+e),t=m(t+e+1),d=m(d+e+1),e=h+.7*(B(l)*b+c),r=k+.7*(B(n)*b+c),h=h+.7*(B(t)*b+c),k=k+.7*(B(d)*b+c),l=f+.7*(B(Math.floor(l*b))*b+c),f=f+.7*(B(Math.floor(n*b))*b+c),t=a+.7*(B(Math.floor(t*b))*b+c),b=a+.7*(B(Math.floor(d*b))*b+c);return Math.min(e*e+l*l,r*r+f*f,h*h+t*t,k*k+b*b)};a.quat_project=function(a,b,c,d,e){e||(e=new Float32Array(4));a=M.transformQuat(b,a,C);b=c[0];var f=c[1];c=c[2];X[0]=f*f+c*c;X[1]=-f*b;X[2]=-c*b;X[3]=-b*f;X[4]=b*b+c*
c;X[5]=-c*f;X[6]=-b*c;X[7]=-f*c;X[8]=b*b+f*f;M.transformMat3(a,X,a);M.normalize(a,a);t.rotationTo(d,a,e);return e};a.cam_quat_to_mesh_quat=function(a,b){b||(b=new Float32Array(4));var c=F,d=K,c=t.setAxisAngle([0,1,0],Math.PI,t.create()),d=t.setAxisAngle([1,0,0],Math.PI/2,t.create());t.multiply(c,d,c);t.multiply(a,c,b);return b};a.cleanup=function(){v=0;z={}};a.clamp=function(a,b,c){return Math.min(Math.max(a,b),c)};a.smooth=function(a,b,c,d){c=Math.exp(-c/d);return(1-c)*a+c*b};a.smooth_v=function(a,
b,c,d,e){e||(e=new Float32Array(a.length));c=Math.exp(-c/d);for(d=0;d<e.length;d++)e[d]=(1-c)*a[d]+c*b[d];return e};a.ZB=function(a,b,c,d,e){e||(e=new Float32Array(a.length));t.slerp(a,b,Math.exp(-c/d),e)};a.Xu=function(a){return"object"===typeof a&&a.buffer&&a.buffer instanceof ArrayBuffer?!0:!1};a.is_vector=function(a,b){if(a instanceof Array||a.buffer&&a.buffer instanceof ArrayBuffer)if(b&&b==a.length||!b)return!0;return!1};a.correct_cam_quat_up=function(a,b){var c=y.fromQuat(a,X);W[0]=0;W[1]=
1;W[2]=0;C[0]=c[3];C[1]=c[4];C[2]=c[5];var d=M.cross(W,C,C);M.normalize(d,d);var e=c[7];!b&&0<e&&(d[0]*=-1,d[1]*=-1,d[2]*=-1);W[0]=c[0];W[1]=c[1];W[2]=c[2];M.normalize(W,W);t.rotationTo(W,d,K);t.multiply(K,a,a)};a.Iz=function(a,b,c,d){c=c*b-.5;var e=d*b-.5;d=c-Math.floor(c);var f=e-Math.floor(e);c=Math.floor(c);var e=Math.floor(e),g=b-1,h=a[e*b+c],k=a[e*b+Math.min(c+1,g)],l=a[Math.min(e+1,g)*b+c];a=a[Math.min(e+1,g)*b+Math.min(c+1,g)];return(h*(1-d)+k*d)*(1-f)+(l*(1-d)+a*d)*f};a.Jk=function(a){for(var b=
0,c=0;3>c;c++)0<(a&1<<c)&&b++;return b};a.AB=function(a){for(var b=[0,0,0],c=0;3>c;c++)0<(a&1<<c)&&(b[2-c]=1);return b};a.jm=function(a,b){var c=0;(1==b||2==b)&&0<(a&4)&&c++;2==b&&0<(a&2)&&c++;return c};a.yu=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)})};a.jo=function(a){var b=0,c;for(c in a)a.hasOwnProperty(c)&&b++;return b};a.random_from_array=function(a){if(!a.length)return null;var b=Math.floor(Math.random()*
a.length);return a[b]};a.xz_direction=function(a,b,c){c||(c=new Float32Array(3));c[0]=a[0]-b[0];c[1]=0;c[2]=a[2]-b[2];M.normalize(c,c)};a.IN=function(a,b,c){var d=a[0],e=a[1];a=a[2];var f=b[0],g=b[1],h=b[2];b=b[3];var k=g*a-h*e,l=h*d-f*a,m=f*e-g*d,n=g*m-h*l,h=h*k-f*m,f=f*l-g*k;c[0]=d+2*k*b+2*n;c[1]=e+2*l*b+2*h;c[2]=a+2*m*b+2*f};a.assert=function(a){a||d("Assertion failed")};a.q=d;a.angle_wrap_periodic=l;a.angle_wrap_0_2pi=f;a.Eu=function(a){return/(?:\.([^.]+))?$/.exec(a)[1]};a.lC=function(a,b){for(var c in a){var d=
!0,e=a[c],f=b[c];switch(typeof e){case "number":case "string":case "boolean":d=e==f;break;case "object":d=H(e,f)}if(!d)return!1}return!0};a.Sv=function(a,b){var c=a[0],d=a[2],e=a[3];b[0]=a[1];b[1]=d;b[2]=e;b[3]=c};a.Az=function(a){a+=1;132651<a&&x.error("Color ID pool depleted");var b=Math.floor(a/2601);a%=2601;var c=Math.floor(a/51);return new Float32Array([b/51,c/51,a%51/51])};a.line_plane_intersect=function(a,b,c,d){F.set(a);F[3]=b;C[0]=c[3];C[1]=c[4];C[2]=c[5];K.set(C);K[3]=0;a=u.dot(F,K);if(0==
a)return null;M.copy(c,C);K.set(C);K[3]=1;a=-u.dot(F,K)/a;d[0]=c[0]+a*c[3];d[1]=c[1]+a*c[4];d[2]=c[2]+a*c[5];return d};a.OJ=function(a,b,c,d){var e=b[0]-a[0],f=c[0]-a[0],g=b[1]-a[1],h=c[1]-a[1];b=b[2]-a[2];a=c[2]-a[2];d[0]=g*a-b*h;d[1]=f*b-e*a;d[2]=e*h-g*f;return d};a.XP=function(a,b){for(var c=0;c<a.length;c++)b[c]=a[c];return b};a.CB=function(a,b,c){var d=M.dot(a,b);-.9999999>d?(M.cross(O,a,C),1E-6>M.length(C)&&M.cross(Q,a,C),M.normalize(C,C),t.setAxisAngle(C,Math.PI,c)):(M.cross(a,b,C),c.set(C),
c[3]=1+d,t.normalize(c,c));return c};a.Ij=function(a,b,c){if(b==c)return c-a;a=f(a);b=f(b);c=f(c);b=2*Math.PI-b;c=f(c+b);a=f(a+b);return a>c?(c-=a,a=2*Math.PI-a,-c>a?a:c):0};a.smooth_step=function(a,b,c){isFinite(b)&&isFinite(c)&&(a=clamp(a,b,c));return a*a*(3-2*a)};a.lerp=function(a,b,c){return b+a*(c-b)};a.LF=function(a,b){for(var c=0;c<a.length;c++)for(var d=0;d<b.length;d++)if(b[d]==a[c])return!0;return!1};a.cQ=function(a){for(var b=Array(a),c=0;c<a;c++)b[c]=0;return b};a.WC=function(a,b){for(var c=
Math.max(a.length,b.length),d=0;d<c;d++){var f=e((d>=a.length?0:a[d])-(d>=b.length?0:b[d]));if(f)return f}return 0};a.nj=function(a){return a.join(".")};a.jC=function(a){return a.split(".").map(function(a){return a|0})};a.eC=function(a,b){b[0]=Math.pow(a[0],2.2);b[1]=Math.pow(a[1],2.2);b[2]=Math.pow(a[2],2.2)};a.dv=function(a,b){b[0]=Math.pow(a[0],1/2.2);b[1]=Math.pow(a[1],1/2.2);b[2]=Math.pow(a[2],1/2.2);return b};a.Co=function(a){var b=a.split("://",2);return 1<b.length?(b[1]=w(b[1]),b.join("://")):
w(a)};a.xn=function(a){return 0!=parseInt(a.toString(2).substr(1),2)};a.zI=function(a,b,c,d){d[0]=a[0];d[1]=b[0];d[2]=c[0];d[3]=a[1];d[4]=b[1];d[5]=c[1];d[6]=a[2];d[7]=b[2];d[8]=c[2];return d};a.pi=function(){var a=[{}];a.length=0;return a}};b4w.module.__sfx=function(a,p){function e(){var a=window.AudioContext||window.webkitAudioContext;if(a){try{var b=new a}catch(c){return E.error('Unable to initialize AudioContext: "'+c+'". The audio is disabled.'),null}if(b.createGain)return b;E.warn("deprecated WebAudio implementation");return null}E.warn("WebAudio is not supported");return null}function c(a,c,d){var e=a.L;if("NONE"!=e.behavior){var f=e.loop,k=e.pitch;if(e.src&&(f||0<=d)){e.ut=Math.floor(5E4*Math.random());var l=W.currentTime+c,l=
Math.max(0,l);e.se=l;e.state=20;var n=F.rc;"POSITIONAL"==e.behavior&&"none"==n.Rn&&(e.behavior="BACKGROUND_SOUND");b(a,F.rc);if("POSITIONAL"==e.behavior||"BACKGROUND_SOUND"==e.behavior){c=W.createBufferSource();c.buffer=e.src;c.playbackRate.value=k;if(f){e.Hb&&e.Hb.disconnect();e.hd&&e.hd.disconnect();c.loop=!0;c.loopStart=e.EA;if(c.loopEnd=e.ur)d=W.createBufferSource(),d.buffer=e.src,d.playbackRate.value=k,e.hd=d,d.connect(e.dd);c.start(l);e.duration=0}else f=c.buffer?c.buffer.duration:0,d>f?(f=
l+d+e.Ke,c.loop=!0,c.start(l),c.stop(f),e.duration=d):(c.loop=!1,c.start(l),e.duration=f);c.connect(e.dd);e.Hb=c;h(e);r(e);g(e)}else"BACKGROUND_MUSIC"==e.behavior&&(A.clear_timeout(e.vt),A.clear_timeout(e.wt),d=function(){var b=a.L,c=b.src;c&&(c.volume=1,c.loop=b.loop,b.Hb=b.Hb||W.createMediaElementSource(c),b.Hb.connect(b.dd),20==b.state&&(c.currentTime&&(c.currentTime=0),c.play()))},0==c?d():e.vt=A.set_timeout(d,1E3*c),e.duration=f?0:D(a));m(e,l)}}}function b(a,b){var c=a.L;if(!c.dd){var d=G.get_trans_view(a.k.m),
e=G.get_quat_view(a.k.m);if(M.Ar){var f=W.createBiquadFilter();f.type="peaking"}else f=null;var g=W.createGain();switch(c.behavior){case "POSITIONAL":var h=W.createPanner();"string"!=typeof h.panningModel?(h.panningModel=h.EQUALPOWER,h.distanceModel=h.INVERSE_DISTANCE):(h.panningModel="equalpower",h.distanceModel=b.Rn);h.setPosition(d[0],d[1],d[2]);k.copy(d,c.Zu);d=u;x.quat_to_dir(e,x.AXIS_MY,d);h.setOrientation(d[0],d[1],d[2]);h.refDistance=c.dist_ref;h.maxDistance=c.dist_max;h.rolloffFactor=c.attenuation;
h.coneInnerAngle=c.Ly;h.coneOuterAngle=c.My;h.coneOuterGain=c.Ny;var l=W.createGain();l.gain.value=H(c);f?(h.connect(f),f.connect(l)):h.connect(l);l.connect(g);c.dd=h;if(c.Zk){var m=W.createGain();g.connect(m);m.connect(b.dd)}else m=null,g.connect(b.dd);break;case "BACKGROUND_SOUND":h=null;l=W.createGain();l.gain.value=H(c);f?(c.dd=f,f.connect(l)):c.dd=l;l.connect(g);c.Zk?(m=W.createGain(),g.connect(m),m.connect(b.dd)):(m=null,g.connect(b.dd));break;case "BACKGROUND_MUSIC":m=h=null,l=W.createGain(),
l.gain.value=H(c),f?(c.dd=f,f.connect(l)):c.dd=l,l.connect(g),g.connect(b.dd)}c.Iv=h;c.Pf=f;c.Gl=l;c.ri=g;c.Uv=m}}function n(a){var b=a.L,d=b.duration,b=b.delay+b.cz*Math.random();c(a,b,d)}function h(a){var b=a.hd||a.Hb;x.sf(b.onended)&&(b.onended=function(){a.state=50})}function r(a){a.Zk&&a.Uv.gain.cancelScheduledValues(a.se);a.hm&&(a.Hb.playbackRate.cancelScheduledValues(a.se),a.hd&&a.hd.playbackRate.cancelScheduledValues(a.se));a.vp=a.se}function g(a){if(a.Zk||a.hm){var b=a.Uv,c=a.Hb,d=c.buffer?
c.buffer.duration:0;if(d){var e=a.se;X[0]=a.ut;for(var f=0;5>f;){var g=a.pitch+a.hm*x.yf(X);if(e>=a.vp){if(a.Zk){var h=1-x.clamp(a.Zk,0,1)*Math.random();b.gain.setValueAtTime(h,e)}a.hm&&(c.playbackRate.setValueAtTime(g,e),a.hd&&a.hd.playbackRate.setValueAtTime(g,e));f++}e+=d/g}a.vp=e-.001}}}function m(a,b){if(a.Zj||a.Ke){var c=a.ri;c.gain.cancelScheduledValues(b);a.Zj?(c.gain.setValueAtTime(0,b),c.gain.linearRampToValueAtTime(1,b+a.Zj)):c.gain.setValueAtTime(1,b);a.Ke&&!a.loop&&(c.gain.setValueAtTime(1,
b+a.duration),c.gain.linearRampToValueAtTime(0,b+a.duration+a.Ke))}}function q(a){"SPEAKER"!=a.type&&x.q("Wrong object type");var b=a.L;if(50==b.state)b.state=30;else if(20==b.state||40==b.state){var c=b.ri,d=W.currentTime;b.Ke&&(c.gain.setValueAtTime(c.gain.value,d),c.gain.linearRampToValueAtTime(0,d+b.Ke));"BACKGROUND_MUSIC"==b.behavior?b.src&&(A.clear_timeout(b.vt),A.clear_timeout(b.wt),b.wt=A.set_timeout(function(){var b=a.L.src;b&&(b.currentTime&&(b.currentTime=0),b.pause())},1E3*b.Ke)):(c=b.Hb,
b.duration<c.buffer.duration?b.Ke&&20==b.state?c.stop(d+b.Ke):20==b.state&&(c.stop(0),c.disconnect()):c.disconnect(),b.se=0,b.Kv=0,b.Bt=0);b.state=30}}function B(a){a=a.L;if(20==a.state){var b=W.currentTime;a.Kv=b;if("BACKGROUND_MUSIC"==a.behavior){var c=a.src;c&&c.pause()}else{if(b>a.se){X[0]=a.ut;for(var d=a.Hb.buffer.duration,e=a.se;e<b;)c=a.pitch+a.hm*x.yf(X),e+=d/c;c*=d/c-(e-b)}else c=0;a.Bt=c;a.Hb.stop(0);a.Hb.disconnect();r(a)}a.state=40}}function d(a){var b=a.L;if(40==b.state){var c=W.currentTime;
b.se+=c-b.Kv;if("BACKGROUND_MUSIC"==b.behavior)b.src.play();else{a=a.L;var d=W.createBufferSource();d.loop=a.Hb.loop;d.loopStart=a.Hb.loopStart;d.loopEnd=a.Hb.loopEnd;d.buffer=a.Hb.buffer;d.playbackRate.value=a.Hb.playbackRate.value;d.connect(a.dd);a.Hb=d;a.hd&&(d=W.createBufferSource(),d.loop=a.hd.loop,d.buffer=a.hd.buffer,d.playbackRate.value=a.hd.playbackRate.value,d.connect(a.dd),a.hd=d);b.vp=c;c=b.Hb;h(b);c.start(b.se,b.Bt);g(b)}m(b,b.se);b.state=20}}function l(a,b,c){var d=1,d=b.sI;if(0<d){var e=
b.lN;if(0!=k.dot(a.Is,a.Is)||0!=k.dot(b.wk,b.wk)){var f=k.subtract(a.Zu,b.Fg,u),g=k.length(f);b=k.dot(f,b.wk)/g;f=k.dot(f,a.Is)/g;f=-f;g=e/d;b=Math.min(-b,g);f=Math.min(f,g);d=(e-d*b)/(e-d*f);isFinite(d)||(d=0);d=Math.min(d,16);d=Math.max(d,.125);d=x.smooth(d,a.vA,c,.3);a.Hb.playbackRate.value=d;a.vA=d}}}function f(a){a=a.L;return!a||20!=a.state&&40!=a.state&&30!=a.state&&50!=a.state?!1:!0}function H(a){return a.muted?0:a.volume}function D(a){a=a.L;return(a=a.src)?a.duration:0}var w=p("__config"),
E=p("__print"),y=p("__quat"),A=p("__time"),G=p("__tsr"),x=p("__util"),k=p("__vec3"),t=w.v,M=w.L,u=new Float32Array(3),v=new Float32Array(3);new Float32Array(3);var z=y.create(),S=[],C=[],W=null,F=null,K=[],X=[1],N=null;a.px=10;a.Ts=20;a.ox=30;a.wH=function(){return{mj:-1,yg:"",behavior:"NONE",muted:!1,volume:1,pitch:1,attenuation:1,dist_ref:1,dist_max:1E4,Ly:360,My:360,Ny:1,autoplay:!1,cyclic:!1,loop:!1,EA:0,ur:0,delay:0,cz:0,Zk:0,hm:0,Zj:0,Ke:0,se:0,Kv:0,Bt:0,duration:0,vp:0,ut:1,src:null,state:10,
Zu:new Float32Array(3),Is:new Float32Array(3),Cq:!1,vA:1,vt:-1,wt:-1,Vj:0,dd:null,Hb:null,hd:null,Iv:null,Pf:null,Gl:null,ri:null,Uv:null,kj:0}};a.init=function(){var a=document.createElement("audio"),b=document.createElement("video");a.canPlayType&&(""!=a.canPlayType("audio/ogg")&&(S.push("ogg"),S.push("ogv"),S.push("oga")),""!=a.canPlayType("audio/mpeg")&&S.push("mp3"),""!=a.canPlayType("audio/mp4")&&(S.push("mp4"),S.push("m4v"),S.push("m4a")),""!=a.canPlayType("audio/webm")&&S.push("webm"));b.canPlayType&&
(""!=b.canPlayType("video/ogg")&&(C.push("ogv"),C.push("ogg"),C.push("oga")),""!=b.canPlayType("video/mp4")&&(C.push("m4v"),C.push("mp4")),""!=b.canPlayType("video/webm")&&C.push("webm"),""!=b.canPlayType("video/mpeg")&&C.push("mp3"))};a.SF=function(a){M.hx&&!W&&(W=e())&&E.log("%cINIT WEBAUDIO: "+W.sampleRate+"Hz","color: #00a");if(W){var b={Fg:new Float32Array(3),wk:new Float32Array(3),kj:0},c=W.createGain(),d=W.createGain();b.Gl=c;b.ri=d;c.connect(d);d.connect(W.destination);if(a.b4w_enable_dynamic_compressor){var d=
W.createDynamicsCompressor(),f=a.b4w_dynamic_compressor_settings;d.threshold.value=f.threshold;d.knee.value=f.knee;d.ratio.value=f.ratio;d.attack.value=f.attack;d.release.value=f.release;d.connect(c);b.Hn=d;b.dd=d}else b.Hn=null,b.dd=c;switch(a.audio_distance_model){case "INVERSE":case "INVERSE_CLAMPED":b.Rn="inverse";break;case "LINEAR":case "LINEAR_CLAMPED":b.Rn="linear";break;case "EXPONENT":case "EXPONENT_CLAMPED":b.Rn="exponential";break;case "NONE":b.Rn="none";break;default:x.q("Wrong audio distance model")}b.sI=
a.audio_doppler_factor;b.lN=a.audio_doppler_speed;b.muted=!1;b.volume=a.audio_volume;c.gain.value=H(b);b.Vj=0}else b=null;a.rc=b};a.jM=function(a){F=a};a.detect_audio_container=function(a){a||(a="ogg");return-1<S.indexOf(a)?a:-1<S.indexOf("m4a")?"m4a":-1<S.indexOf("oga")?"oga":""};a.detect_video_container=function(a){a||(a="webm");return-1<C.indexOf(a)?a:-1<C.indexOf("m4v")?"m4v":-1<C.indexOf("webm")?"webm":""};a.lj=function(a,b){var c=a.data,d=b.L;d.mj=a.data.sound.uuid;d.yg=a.data.sound.filepath;
switch(c.b4w_behavior){case "POSITIONAL":case "BACKGROUND_SOUND":d.behavior=W?c.b4w_behavior:"NONE";break;case "BACKGROUND_MUSIC":var e;W?(window.MediaElementAudioSourceNode?e=!0:(E.warn("MediaElementAudioSourceNode not found"),e=!1),e=e&&!t.Dy?"BACKGROUND_MUSIC":"BACKGROUND_SOUND"):e="NONE";d.behavior=e;break;default:x.q("Wrong speaker behavior")}c.sound||(d.behavior="NONE");d.Cq=c.b4w_enable_doppler;d.muted=c.muted;d.volume=c.volume;d.pitch=c.pitch;d.attenuation=c.attenuation;d.dist_ref=c.distance_reference;
d.dist_max=c.distance_max||1E4;d.Ly=c.cone_angle_inner;d.My=c.cone_angle_outer;d.Ny=c.cone_volume_outer;d.autoplay=c.b4w_auto_play;d.cyclic=c.b4w_cyclic_play;d.loop=c.b4w_loop;d.EA=c.b4w_loop_start;d.ur=c.b4w_loop_end;d.delay=c.b4w_delay;d.cz=c.b4w_delay_random;d.Zk=c.b4w_volume_random;d.hm=c.b4w_pitch_random;d.Zj=c.b4w_fade_in;d.Ke=c.b4w_fade_out;K.push(b)};a.aC=function(b){"SPEAKER"!=b.type&&x.q("Wrong object type");switch(b.L.behavior){case "POSITIONAL":return a.Ts;case "BACKGROUND_SOUND":return a.Ts;
case "BACKGROUND_MUSIC":return a.ox;case "NONE":return a.px;default:x.q("Wrong speaker behavior")}};a.oO=function(a,b){var c=a.L;switch(c.behavior){case "POSITIONAL":case "BACKGROUND_SOUND":case "BACKGROUND_MUSIC":c.src=b;break;case "NONE":break;default:x.q("Wrong speaker behavior")}};a.lB=function(){var a=W.createBufferSource();a.buffer=W.createBuffer(1,22050,22050);a.connect(W.destination);a.start(0)};a.lI=function(a,b,c){W?W.decodeAudioData(a,b,c):c()};a.iN=function(a){q(a);a.L=null;K.splice(K.indexOf(a),
1)};a.cleanup=function(){for(var a=0;a<K.length;a++){var b=K[a].L;"BACKGROUND_MUSIC"==b.behavior?(b=b.src)&&b.pause():(b.Hb&&b.Hb.disconnect(),b.hd&&b.hd.disconnect())}F&&F.rc&&(a=F.rc,a.Fg[0]=0,a.Fg[1]=0,a.Fg[2]=0,a.wk[0]=0,a.wk[1]=0,a.wk[2]=0);F=null;K.splice(0);N=null};a.update=function(a){if(W&&0!=K.length){for(var b=0;b<K.length;b++){var c=K[b],d=c.L,e=d.Hb,f=W.currentTime;!d.loop&&20==d.state&&d.duration&&d.se+d.duration<f&&("BACKGROUND_MUSIC"==d.behavior||e&&!x.sf(e.onended))&&(d.state=50);
d.cyclic&&50==d.state&&n(c);20==d.state&&3>d.vp-f&&g(d)}N&&N.Kh.length&&(-1==N.ic||a>N.Ox+N.hz[N.ic])&&(b=N,-1<b.ic&&q(b.Kh[b.ic]),-1==b.ic&&b.random?c=Math.round(Math.random()*(b.Kh.length-1)):b.random?(c=1+Math.round(Math.random()*(b.Kh.length-2)),c=(b.ic+c)%b.Kh.length):c=(b.ic+1)%b.Kh.length,n(b.Kh[c]),b.ic=c,b.Ox=a)}};a.play=c;a.play_def=n;a.stop=q;a.is_playing=function(a){return 20==a.L.state};a.hN=B;a.jN=d;a.loop_stop=function(a,b){var c=a.L,d=c.hd;if(f(a)&&("POSITIONAL"==c.behavior||"BACKGROUND_SOUND"==
c.behavior)&&d){var e=W.currentTime+b;c.Hb.stop(e);d.start(e,c.ur)}};a.playrate=function(a,b){var c=a.L;c.pitch=b;!f(a)||"POSITIONAL"!=c.behavior&&"BACKGROUND_SOUND"!=c.behavior||(c.Hb.playbackRate.value=b,c.hd&&(c.hd.playbackRate.value=b),r(c),g(c))};a.get_playrate=function(a){return a.L.pitch};a.cyclic=function(a,b){a.L.cyclic=Boolean(b)};a.hK=function(a){return a.L.autoplay};a.is_cyclic=function(a){return a.L.cyclic};a.LK=function(a,b,c,d,e){if(a=a.rc){var g=u;g[0]=0;g[1]=-1;g[2]=0;k.transformQuat(g,
c,g);v[0]=0;v[1]=0;v[2]=-1;k.transformQuat(v,c,v);c=W.listener;c.setPosition(b[0],b[1],b[2]);c.setOrientation(g[0],g[1],g[2],v[0],v[1],v[2]);if(d&&a.kj!=e){if(a.listener_stride)a.listener_stride=!1,k.copy(b,a.Fg);else for(c=a.wk,c[0]=(b[0]-a.Fg[0])/d,c[1]=(b[1]-a.Fg[1])/d,c[2]=(b[2]-a.Fg[2])/d,k.copy(b,a.Fg),b=0;b<K.length;b++)c=K[b],g=c.L,f(c)&&"POSITIONAL"==g.behavior&&g.Cq&&l(g,a,d);a.kj=e}else k.copy(b,a.Fg)}};a.listener_stride=function(){var a=F.rc;a&&(a.listener_stride=!0)};a.kN=function(a,
b,c){var d=a.L;if(f(a)&&"POSITIONAL"==d.behavior){var e=G.cc(a.k.m,u);a=G.xd(a.k.m,z);var g=d.Iv;g.setPosition(e[0],e[1],e[2]);x.quat_to_dir(a,x.AXIS_MY,v);g.setOrientation(v[0],v[1],v[2]);d.Cq&&(a=d.Zu,b&&d.kj!=c?(d.We?(k.copy(e,a),d.We=!1):(g=d.Is,g[0]=(e[0]-a[0])/b,g[1]=(e[1]-a[1])/b,g[2]=(e[2]-a[2])/b,k.copy(e,a),l(d,F.rc,b)),d.kj=c):k.copy(e,a))}};a.speaker_stride=function(a){var b=a.L;f(a)&&"POSITIONAL"==b.behavior&&b.Cq&&(b.We=!0)};a.Ju=function(a){return a.L.behavior};a.check_active_speakers=
function(){for(var a=0;a<K.length;a++)if(f(K[a]))return!0;return!1};a.GM=function(a){var b=F.rc;b&&(b.volume=a,W&&(b.Gl.gain.value=H(b)))};a.LJ=function(){var a=F.rc;return a?a.volume:0};a.set_volume=function(a,b){var c=a.L;c.volume=b;f(a)&&(c.Gl.gain.value=H(c))};a.get_volume=function(a){return a.L.volume};a.mute=function(a,b){a.L.muted=Boolean(b);f(a)&&(a.L.Gl.gain.value=H(a.L))};a.is_muted=function(a){return a.L.muted};a.kL=function(a){var b=F.rc;b&&(b.muted=Boolean(a),W&&(b.Gl.gain.value=H(b)))};
a.pK=function(){var a=F.rc;return a?a.muted:!1};a.get_speaker_objects=function(){return K};a.pause=function(){for(var a=0;a<K.length;a++)B(K[a])};a.resume=function(){for(var a=0;a<K.length;a++)d(K[a])};a.set_compressor_params=function(a,b){if(a.rc&&a.rc.Hn){var c=a.rc.Hn;c.threshold.value=b.threshold;c.knee.value=b.knee;c.ratio.value=b.ratio;c.attack.value=b.attack;c.release.value=b.release}};a.get_compressor_params=function(a){if(!a.rc||!a.rc.Hn)return null;a=a.rc.Hn;return{threshold:a.threshold.value,
knee:a.knee.value,ratio:a.ratio.value,attack:a.attack.value,release:a.release.value}};a.duck=function(a,b,c){if(f(a)){a=a.L;var d=a.ri,e=W.currentTime;d.gain.setValueAtTime(d.gain.value,e);d.gain.linearRampToValueAtTime(b,e+c);a.Vj=c}};a.unduck=function(a){if(f(a)){a=a.L;var b=a.ri,c=W.currentTime;b.gain.setValueAtTime(b.gain.value,c);b.gain.linearRampToValueAtTime(1,c+a.Vj);a.Vj=0}};a.vI=function(a,b){if(W){var c=F.rc,d=c.ri,e=W.currentTime;d.gain.setValueAtTime(d.gain.value,e);d.gain.linearRampToValueAtTime(a,
e+b);c.Vj=b}};a.MN=function(){if(W){var a=F.rc,b=a.ri,c=W.currentTime;b.gain.setValueAtTime(b.gain.value,c);b.gain.linearRampToValueAtTime(1,c+a.Vj);a.Vj=0}};a.apply_playlist=function(a,b,c){N={ic:-1,Ox:0,random:c,Kh:[],hz:[]};for(c=0;c<a.length;c++){var d=a[c],e=D(d);0==e?E.warn("Ignoring speaker with zero duration: "+d.name):(q(d),d.L.cyclic=!1,N.Kh.push(d),N.hz.push(e+b))}};a.get_duration=D;a.clear_playlist=function(){if(N)for(var a=N.Kh,b=0;b<a.length;b++)q(a[b]);N=null};a.get_positional_params=
function(a){return(a=a.L)&&"POSITIONAL"==a.behavior?{dist_ref:a.dist_ref,dist_max:a.dist_max,attenuation:a.attenuation}:null};a.set_positional_params=function(a,b){var c=a.L;if(c&&"POSITIONAL"==c.behavior){c.dist_ref=b.dist_ref;c.dist_max=b.dist_max;c.attenuation=b.attenuation;var d=c.Iv;d&&(d.refDistance=c.dist_ref,d.maxDistance=c.dist_max,d.rolloffFactor=c.attenuation)}};a.set_filter_params=function(a,b){var c=a.L;c&&c.Pf&&(c.Pf.frequency.value=b.freq,c.Pf.Q.value=b.Q,c.Pf.gain.value=b.gain)};a.get_filter_params=
function(a){return(a=a.L)&&a.Pf?{freq:a.Pf.frequency.value,Q:a.Pf.Q.value,gain:a.Pf.gain.value}:null};a.get_filter_freq_response=function(a,b,c,d){a=a.L;if(!a||!a.Pf)return null;a.Pf.getFrequencyResponse(b,c,d)};a.reset=function(){S.length=0;C.length=0;W=null}};b4w.module.__input=function(a,p){function e(a){var b=F.detect_mobile();return(20!=a||navigator.getVRDevices||navigator.getVRDisplays||b)&&(10!=a||b&&window.DeviceOrientationEvent)?!0:!1}function c(a,b){if(!e(a))return null;var c={type:a,$f:!1,wf:[],Xf:[],vh:[],wh:[],xh:[],yh:[],vo:[],sA:[],th:[],Rh:[],Qh:[],Ph:[],element:b,Fh:!0,Gb:[],Br:new Float32Array(2),iL:0,distortion_coefs:new Float32Array(2),chromatic_aberration_coefs:new Float32Array(4),Qm:null,Yg:null,af:null,orientation:L.create(),position:da.create(),
qh:new Float32Array(4),rh:new Float32Array(4),nk:0,ci:0,Zi:0,Rm:0,wi:0,ei:0,dk:[],ti:[0,0,0,0,0,0,0,0,0,0,0,0],zz:[0,0,0,0,0,0,0,0,0,0,0,0],Jq:[]};c.qh[0]=c.qh[1]=c.qh[2]=c.qh[3]=45;c.rh[0]=c.rh[1]=c.rh[2]=c.rh[3]=45;30==a||40==a||50==a?(c.$f=Boolean(b),50==a?document.addEventListener("touchstart",function(){}):40==a&&(c.Fh=!1)):10==a?c.$f=!0:20!=a||navigator.getVRDisplays||(navigator.getVRDevices&&!ga.is_mobile_device?h(c,T.webvr):(n(c),c.$f=!0));return c}function b(b,d){10==b||20==b?d=window:d||
(d=K.get_container());for(var e=0;e<ea.length;e++)if(ea[e].type==b&&ea[e].element==d)return ea[e];e=c(b,d);60!=b&&70!=b&&80!=b&&90!=b||e.Jq.push(a.GMPD_BUTTON_0,a.GMPD_BUTTON_1,a.GMPD_BUTTON_2,a.GMPD_BUTTON_3,a.GMPD_BUTTON_4,a.GMPD_BUTTON_5,a.GMPD_BUTTON_6,a.GMPD_BUTTON_7,a.GMPD_BUTTON_8,a.GMPD_BUTTON_9,a.GMPD_BUTTON_10,a.GMPD_BUTTON_11,a.GMPD_BUTTON_12,a.GMPD_BUTTON_13,a.GMPD_BUTTON_14,a.GMPD_BUTTON_15,a.GMPD_BUTTON_16,a.GMPD_BUTTON_17,a.GMPD_BUTTON_18,a.GMPD_BUTTON_19,a.GMPD_BUTTON_20,a.GMPD_BUTTON_21,
a.GMPD_BUTTON_22,a.GMPD_BUTTON_23,a.GMPD_BUTTON_24,a.GMPD_BUTTON_25,a.GMPD_AXIS_0,a.GMPD_AXIS_1,a.GMPD_AXIS_2,a.GMPD_AXIS_3,a.GMPD_AXIS_4,a.GMPD_AXIS_5,a.GMPD_AXIS_6,a.GMPD_AXIS_7,a.GMPD_AXIS_8,a.GMPD_AXIS_9,a.GMPD_AXIS_10,a.GMPD_AXIS_11);e&&ea.push(e);return e}function n(a){var b=T.nonwebvr;a.Rm=b.Rm;a.wi=b.wi;a.ei=b.ei;h(a,b);a.nk=b.nk;a.ci=b.ci;a.Zi=b.Zi;g(a)}function h(a,b){a.distortion_coefs[0]=b.distortion_coefs[0];a.distortion_coefs[1]=b.distortion_coefs[1];a.chromatic_aberration_coefs[0]=
b.chromatic_aberration_coefs[0];a.chromatic_aberration_coefs[1]=b.chromatic_aberration_coefs[1];a.chromatic_aberration_coefs[2]=b.chromatic_aberration_coefs[2];a.chromatic_aberration_coefs[3]=b.chromatic_aberration_coefs[3]}function r(a,b){var c=b*b;return b*(1+a[0]*c+a[1]*c*c)}function g(a){var b=a.ci-a.ei,c=a.wi-b,d=a.distortion_coefs,b=P.rad_to_deg(Math.atan(r(d,b/a.Zi))),e=P.rad_to_deg(Math.atan(r(d,c/a.Zi))),f=P.rad_to_deg(Math.atan(r(d,c/a.Zi))),c=P.rad_to_deg(Math.atan(r(d,c/a.Zi)));e&&(a.qh[0]=
a.rh[0]=Math.min(e,60));f&&(a.qh[1]=a.rh[3]=Math.min(f,60));b&&(a.qh[2]=a.rh[2]=Math.min(b,60));c&&(a.qh[3]=a.rh[1]=Math.min(c,60))}function m(a,b){var c=b.filter(function(a){return a instanceof HMDVRDevice}),d=null;c.length&&(d=c[0]);c=null;d&&(c=b.filter(function(a){return-1!==a.deviceName.toLowerCase().indexOf("oculus")&&a.hardwareUnitId==d.hardwareUnitId&&a instanceof PositionSensorVRDevice}));a.Qm=d;a.Yg=c}function q(a,b,c){switch(a.type){case 20:var d=a.af||a.Qm;d?(b=d.getEyeParameters(b),b=
b.fieldOfView||b.currentFieldOfView,a=a.distortion_coefs,d=r(a,Math.tan(P.deg_to_rad(b.downDegrees))),P.rad_to_deg(Math.atan(d)),d=r(a,Math.tan(P.deg_to_rad(b.upDegrees))),P.rad_to_deg(Math.atan(d)),d=r(a,Math.tan(P.deg_to_rad(b.leftDegrees))),P.rad_to_deg(Math.atan(d)),a=r(a,Math.tan(P.deg_to_rad(b.rightDegrees))),P.rad_to_deg(Math.atan(a)),c[0]=b.upDegrees,c[1]=b.rightDegrees,c[2]=b.downDegrees,c[3]=b.leftDegrees):(b="left"==b?a.qh:a.rh,U.copy(b,c));break;default:N.error("fov is undefined for device: ",
a.type)}return c}function B(a,b){switch(b){case 0:return navigator.getVRDisplays?3:navigator.getVRDevices?ga.is_mobile_device?1:0:2;case 23:var c=a.af||a.Qm;if(c){var d=c.getEyeParameters("left"),c=c.getEyeParameters("right");return a.af?c.offset[0]-d.offset[0]:c.eyeTranslation.x-d.eyeTranslation.x}return a.nk}}function d(a,b){if(a.af){var c=a.af,d=c.capabilities,c=c.getPose();d.hasOrientation&&c.orientation&&(a.orientation[0]=c.orientation[0],a.orientation[1]=c.orientation[1],a.orientation[2]=c.orientation[2],
a.orientation[3]=c.orientation[3]);d.hasPosition&&c.position&&(a.position[0]=c.position[0],a.position[1]=c.position[1],a.position[2]=c.position[2])}else 1<b-Z&&(Z=b,navigator.getVRDisplays?a.af||navigator.getVRDisplays().then(function(b){0<b.length&&(a.af=b[0],a.$f=!0)},function(){N.uc("WebVR displays are not found.");a.$f=!1}):navigator.getVRDevices?a.Qm||ma||navigator.getVRDevices().then(function(b){m(a,b);b.length&&(a.$f=!0);ma=!0},function(){N.uc("WebVR devices are not found.");a.$f=!1;ma=!0}):
ga.is_mobile_device||N.uc("HMD isn't supported."))}function l(a,b){if(a){for(var c=0;c<a.buttons.length;c++)b.dk[c]=a.buttons[c].pressed;if(a.axes&&12>=a.axes.length)for(c=0;c<a.axes.length;c++)b.ti[c]=a.axes[c]}}function f(a){for(var b=0;b<a.dk;b++)a.dk[b]=!1;for(b=0;b<a.ti.length;b++)a.zz[b]=a.ti[b],a.ti[b]=0}function H(a,b){var c=a.indexOf(b);0<=c&&(a[c]=null)}function D(a){return null===a}function w(a,b,c,d){switch(b){case 120:c&&H(a.wf,c);if(d||a.Xf.every(D)&&a.wf.every(D))a.wf.length=0,a.Xf.length=
0,b=a.Gb.indexOf(131),0<=b&&(a.Gb.splice(b,1),a.element.removeEventListener("deviceorientation",y,!1));break;case 130:c&&H(a.Xf,c);if(d||a.Xf.every(D)&&a.wf.every(D))a.wf.length=0,a.Xf.length=0,b=a.Gb.indexOf(131),0<=b&&(a.Gb.splice(b,1),a.element.removeEventListener("deviceorientation",y,!1));break;case 40:c&&H(a.vh,c);if(d||a.vh.every(D))a.vh.length=0,b=a.Gb.indexOf(b),0<=b&&(a.Gb.splice(b,1),a.element.removeEventListener("mousedown",x,!1));break;case 30:c&&H(a.wh,c);if(d||a.wh.every(D))a.wh.length=
0,b=a.Gb.indexOf(b),0<=b&&(a.Gb.splice(b,1),a.element.removeEventListener("mousemove",G,!1));break;case 50:c&&H(a.xh,c);if(d||a.xh.every(D)){a.xh.length=0;b=a.Gb.indexOf(b);0<=b&&(a.Gb.splice(b,1),a.element.removeEventListener("mouseout",k,!1),a.element.removeEventListener("mouseup",t,!1));break}break;case 60:c&&H(a.yh,c);if(d||a.yh.every(D))a.yh.length=0,b=a.Gb.indexOf(b),0<=b&&(a.Gb.splice(b,1),a.element.removeEventListener("wheel",M,!1));break;case 80:c&&H(a.vo,c);if(d||a.vo.every(D))a.vo.length=
0,b=a.Gb.indexOf(b),0<=b&&(a.Gb.splice(b,1),a.element.removeEventListener("keydown",u,!1));break;case 70:c&&H(a.th,c);if(d||a.th.every(D))a.th.length=0,b=a.Gb.indexOf(b),0<=b&&(a.Gb.splice(b,1),a.element.removeEventListener("keyup",v,!1));break;case 90:c&&H(a.Rh,c);if(d||a.Rh.every(D))a.Rh.length=0,b=a.Gb.indexOf(b),0<=b&&(a.Gb.splice(b,1),a.element.removeEventListener("touchstart",z,!1));break;case 100:c&&H(a.Qh,c);if(d||a.Qh.every(D))a.Qh.length=0,b=a.Gb.indexOf(b),0<=b&&(a.Gb.splice(b,1),a.element.removeEventListener("touchmove",
S,!1));break;case 110:if(c&&H(a.Ph,c),d||a.Ph.every(D))a.Ph.length=0,b=a.Gb.indexOf(b),0<=b&&(a.Gb.splice(b,1),a.element.removeEventListener("touchend",C,!1))}}function E(a,b){P.ordered_angles_to_quat(a,P.ZXY,b);var c="orientation"in window?P.deg_to_rad(window.orientation):"orientation"in window.screen?P.deg_to_rad(window.screen.orientation.angle):0,c=L.setAxisAngle(P.AXIS_Z,-c,O);L.multiply(b,c,b);c=L.setAxisAngle(P.AXIS_X,-Math.PI/2,O);L.multiply(c,b,b);c=L.setAxisAngle(P.AXIS_X,Math.PI/2,O);L.multiply(b,
c,b);return b}function y(a){var c=Q;null===a.alpha||null===a.beta||null===a.gamma?c[0]=c[1]=c[2]=0:(c[0]=P.deg_to_rad(a.alpha),c[1]=P.deg_to_rad(a.beta),c[2]=P.deg_to_rad(a.gamma));a=b(10,a.currentTarget);for(var d=0;d<a.Xf.length;d++){var e=a.Xf[d];e&&(da.copy(c,ja),e(ja))}if(a.wf.length)for(c=E(c,la),d=0;d<a.wf.length;d++)if(e=a.wf[d])L.copy(c,oa),e(oa);for(d=0;d<a.wf.length;d++)a.wf[d]||a.wf.splice(d,1);for(d=0;d<a.Xf.length;d++)a.Xf[d]||a.Xf.splice(d,1)}function A(a,b){switch(a.type){case 30:a.Br[0]=
b.clientX,a.Br[1]=b.clientY,a.iL=b.which}}function G(a){if(!ha||!(a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||5==a.mozInputSource)){var c=b(30,a.currentTarget);A(c,a);for(var d=0;d<c.wh.length;d++){var e=c.wh[d];e&&(ra[0]=a.clientX,ra[1]=a.clientY,e(ra))}c.Fh&&a.preventDefault();for(d=0;d<c.wh.length;d++)c.wh[d]||c.wh.splice(d,1)}}function x(a){if(!ha||!(a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||5==a.mozInputSource)){var c=b(30,a.currentTarget);A(c,a);for(var d=
0;d<c.vh.length;d++){var e=c.vh[d];e&&e(a.which)}c.Fh&&a.preventDefault();for(d=0;d<c.vh.length;d++)c.vh[d]||c.vh.splice(d,1)}}function k(a){K.iA(a.relatedTarget)||t(a)}function t(a){if(!ha||!(a.sourceCapabilities&&a.sourceCapabilities.firesTouchEvents||5==a.mozInputSource)){var c=b(30,a.currentTarget);A(c,a);for(var d=0;d<c.xh.length;d++){var e=c.xh[d];e&&e(a.which)}c.Fh&&a.preventDefault();for(d=0;d<c.xh.length;d++)c.xh[d]||c.xh.splice(d,1)}}function M(a){for(var c=b(30,a.currentTarget),d=0;d<c.yh.length;d++){var e=
c.yh[d];e&&e(-a.deltaY)}c.Fh&&a.preventDefault();for(d=0;d<c.yh.length;d++)c.yh[d]||c.yh.splice(d,1)}function u(a){for(var c=b(40,a.currentTarget),d=a.ctrlKey||a.altKey||a.metaKey?c.sA:c.vo,e=0;e<d.length;e++){var f=d[e];f?f(a.keyCode):d.splice(e--,1)}c.Fh&&a.preventDefault()}function v(a){for(var c=b(40,a.currentTarget),d=0;d<c.th.length;d++){var e=c.th[d];e&&e(a.keyCode)}c.Fh&&a.preventDefault();for(d=0;d<c.th.length;d++)c.th[d]||c.th.splice(d,1)}function z(a){for(var c=b(50,a.currentTarget),d=
0;d<c.Rh.length;d++){var e=c.Rh[d];e&&e(a.targetTouches)}for(d=0;d<c.Rh.length;d++)c.Rh[d]||c.Rh.splice(d,1)}function S(a){for(var c=b(50,a.currentTarget),d=0;d<c.Qh.length;d++){var e=c.Qh[d];e&&e(a.targetTouches)}c.Fh&&a.preventDefault();for(d=0;d<c.Qh.length;d++)c.Qh[d]||c.Qh.splice(d,1)}function C(a){for(var c=b(50,a.currentTarget),d=0;d<c.Ph.length;d++){var e=c.Ph[d];e&&e(a.targetTouches)}for(d=0;d<c.Ph.length;d++)c.Ph[d]||c.Ph.splice(d,1)}function W(a){switch(a){case 0:a=60;break;case 1:a=70;
break;case 2:a=80;break;case 3:a=90;break;default:a=60}return a}var F=p("__compat"),K=p("__container"),X=p("__config"),N=p("__print"),L=p("__quat"),P=p("__util"),da=p("__vec3"),U=p("__vec4"),ga=X.v,T=X.bK;a.DEVICE_GYRO=10;a.DEVICE_HMD=20;a.DEVICE_MOUSE=30;a.DEVICE_KEYBOARD=40;a.DEVICE_TOUCH=50;a.Ap=60;a.Zs=70;a.$s=80;a.at=90;a.HMD_WEBVR_DESKTOP=0;a.HMD_WEBVR_MOBILE=1;a.HMD_NON_WEBVR=2;a.HMD_WEBVR1=3;a.HMD_WEBVR_TYPE=0;a.HMD_ORIENTATION_QUAT=10;a.HMD_POSITION=20;a.oD=21;a.pD=22;a.HMD_EYE_DISTANCE=
23;a.HMD_DISTORTION=24;a.HMD_BASELINE_DIST=25;a.HMD_SCREEN_LENSE_DIST=26;a.HMD_SCREEN_WIDTH=27;a.HMD_SCREEN_HEIGHT=28;a.HMD_BEVEL_SIZE=29;a.MOUSE_LOCATION=30;a.MOUSE_DOWN_WHICH=40;a.MOUSE_UP_WHICH=50;a.MOUSE_WHEEL=60;a.KEYBOARD_UP=70;a.KEYBOARD_DOWN=80;a.ux=81;a.TOUCH_START=90;a.TOUCH_MOVE=100;a.TOUCH_END=110;a.GYRO_ORIENTATION_QUAT=120;a.GYRO_ORIENTATION_ANGLES=130;a.GMPD_BUTTON_0=0;a.GMPD_BUTTON_1=1;a.GMPD_BUTTON_2=2;a.GMPD_BUTTON_3=3;a.GMPD_BUTTON_4=4;a.GMPD_BUTTON_5=5;a.GMPD_BUTTON_6=6;a.GMPD_BUTTON_7=
7;a.GMPD_BUTTON_8=8;a.GMPD_BUTTON_9=9;a.GMPD_BUTTON_10=10;a.GMPD_BUTTON_11=11;a.GMPD_BUTTON_12=12;a.GMPD_BUTTON_13=13;a.GMPD_BUTTON_14=14;a.GMPD_BUTTON_15=15;a.GMPD_BUTTON_16=16;a.GMPD_BUTTON_17=17;a.GMPD_BUTTON_18=18;a.GMPD_BUTTON_19=19;a.GMPD_BUTTON_20=20;a.GMPD_BUTTON_21=21;a.GMPD_BUTTON_22=22;a.GMPD_BUTTON_23=23;a.GMPD_BUTTON_24=24;a.GMPD_BUTTON_25=25;a.GMPD_AXIS_0=26;a.GMPD_AXIS_1=27;a.GMPD_AXIS_2=28;a.GMPD_AXIS_3=29;a.GMPD_AXIS_4=30;a.GMPD_AXIS_5=31;a.GMPD_AXIS_6=32;a.GMPD_AXIS_7=33;a.GMPD_AXIS_8=
34;a.GMPD_AXIS_9=35;a.GMPD_AXIS_10=36;a.GMPD_AXIS_11=37;var la=L.create(),O=L.create(),Q=da.create(),Z=-Infinity,ma=!1,ra=new Float32Array(2);da.create();var ja=da.create(),oa=L.create(),ha="ontouchstart"in document.documentElement,ea=[];a.can_use_device=e;a.get_device_by_type_element=b;a.switch_prevent_default=function(a,b){a.Fh=b};a.reset_device=function(a){switch(a.type){case 20:if(a.$f)if(a.af)a.af.resetPose();else if(a.Yg)for(var b=0;b<a.Yg.length;b++)a.Yg[b].resetSensor();break;default:N.error("reset_device() is undefined for device: ",
a.type)}};a.get_vector_param=function(a,b,c){switch(b){case 10:a:switch(a.type){case 20:da.copy(P.gt,c);if(a.af)c[0]=a.orientation[0],c[1]=a.orientation[1],c[2]=a.orientation[2],c[3]=a.orientation[3];else if(a.Yg)for(b=0;b<a.Yg.length;b++){var d=a.Yg[b],d=d.getState&&d.getState()||d.getImmediateState&&d.getImmediateState();d.orientation&&(c[0]=d.orientation.x,c[1]=d.orientation.y,c[2]=d.orientation.z,c[3]=d.orientation.w)}L.normalize(c,c);a=L.setAxisAngle(P.AXIS_X,Math.PI/2,la);L.multiply(c,a,c);
break a;default:N.error("orientation_quat is undefined for device: ",a.type)}return c;case 20:a:switch(a.type){case 20:da.copy(P.lt,c);if(a.af)c[0]=a.position[0],c[1]=a.position[1],c[2]=a.position[2];else if(a.Yg)for(b=0;b<a.Yg.length;b++)d=a.Yg[b],d=d.getState&&d.getState()||d.getImmediateState&&d.getImmediateState(),d.position&&(c[0]=d.position.x,c[1]=d.position.y,c[2]=d.position.z);break a;default:N.error("position is undefined for device: ",a.type)}return c;case 21:return q(a,"left",c);case 22:return q(a,
"right",c);case 30:return c[0]=a.Br[0],c[1]=a.Br[1],c}};a.get_value_param=B;a.set_config=function(a,b,c){switch(a.type){case 20:if(3===B(a,0))break;switch(b){case 24:a.distortion_coefs[0]=c[0];a.distortion_coefs[1]=c[1];break;case 23:a.nk=c;g(a);break;case 25:a.ci=c;g(a);break;case 26:a.Zi=c;g(a);break;case 27:a.Rm=c;g(a);break;case 28:a.wi=c;g(a);break;case 29:a.ei=c,g(a)}break;case 60:case 70:case 80:case 90:a.Jq[b]=c}};a.HJ=function(a,b){return b<a.dk.length?a.dk[a.Jq[b]]:!1};a.GJ=function(a,b){return b-
26<a.ti.length?a.ti[a.Jq[b]-26]:0};a.update=function(a){for(var b=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],c=0;c<ea.length;c++){var e=ea[c];switch(e.type){case 60:f(e);l(b[0],e);break;case 70:f(e);l(b[1],e);break;case 80:f(e);l(b[2],e);break;case 90:f(e);l(b[3],e);break;case 20:d(e,a)}}};a.attach_param_cb=function(a,b,c){switch(b){case 120:a.wf.push(c);b=131;break;case 130:a.Xf.push(c);b=131;break;case 40:a.vh.push(c);break;case 30:a.wh.push(c);
break;case 50:a.xh.push(c);break;case 60:a.yh.push(c);break;case 80:a.vo.push(c);break;case 81:a.sA.push(c);b=80;break;case 70:a.th.push(c);break;case 90:a.Rh.push(c);break;case 100:a.Qh.push(c);break;case 110:a.Ph.push(c)}if(-1==a.Gb.indexOf(b)&&(a.Gb.push(b),a.$f))switch(b){case 40:/iPad|iPhone|iPod/.test(navigator.platform)||a.element.addEventListener("mousedown",x,!1);break;case 30:a.element.addEventListener("mousemove",G,!1);break;case 50:/iPad|iPhone|iPod/.test(navigator.platform)||(a.element!=
window&&a.element.addEventListener("mouseout",t,!1),a.element.addEventListener("mouseup",t,!1));break;case 60:a.element.addEventListener("wheel",M,!1);break;case 80:a.element.addEventListener("keydown",u,!1);break;case 70:a.element.addEventListener("keyup",v,!1);break;case 90:a.element.addEventListener("touchstart",z,!1);break;case 100:a.element.addEventListener("touchmove",S,!1);break;case 110:a.element.addEventListener("touchend",C,!1);break;case 131:a.element.addEventListener("deviceorientation",
y,!1)}};a.detach_param_cb=function(a,b,c){w(a,b,c,!1)};a.XJ=E;a.cleanup=function(){for(var a=0;a<ea.length;a++)for(var b=ea[a],c=0;c<b.Gb.length;c++)w(b,b.Gb[c],null,!0);ea.length=0};a.get_pressed_gmpd_btn=function(a){a=b(W(a));for(var c=0;c<a.dk.length;c++)if(a.dk[c])return c;return-1};a.get_moved_gmpd_axis=function(a){a=b(W(a));for(var c=0;c<a.ti.length;c++)if(a.zz[c]-a.ti[c])return c+26;return-1};a.Oz=function(){for(var a=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?
navigator.webkitGetGamepads:[],b=0;b<a.length;b++)if(a[b])return b;return 0};a.Yz=function(){var a=b(20);return a&&a.af}};b4w.module.__vec3=function(a){var p="undefined"!==typeof Float32Array?Float32Array:Array,e=Math.random;a.create=function(){var a=new p(3);a[0]=0;a[1]=0;a[2]=0;return a};a.clone=function(a){var b=new p(3);b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.fromValues=function(a,b,e){var h=new p(3);h[0]=a;h[1]=b;h[2]=e;return h};a.copy=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];return b};a.set=function(a,b,e,h){h[0]=a;h[1]=b;h[2]=e;return h};a.add=function(a,b,e){e[0]=a[0]+b[0];e[1]=a[1]+b[1];e[2]=a[2]+b[2];
return e};a.subtract=function(a,b,e){e[0]=a[0]-b[0];e[1]=a[1]-b[1];e[2]=a[2]-b[2];return e};a.sub=a.subtract;a.multiply=function(a,b,e){e[0]=a[0]*b[0];e[1]=a[1]*b[1];e[2]=a[2]*b[2];return e};a.mul=a.multiply;a.divide=function(a,b,e){e[0]=a[0]/b[0];e[1]=a[1]/b[1];e[2]=a[2]/b[2];return e};a.div=a.divide;a.min=function(a,b,e){e[0]=Math.min(a[0],b[0]);e[1]=Math.min(a[1],b[1]);e[2]=Math.min(a[2],b[2]);return e};a.max=function(a,b,e){e[0]=Math.max(a[0],b[0]);e[1]=Math.max(a[1],b[1]);e[2]=Math.max(a[2],
b[2]);return e};a.scale=function(a,b,e){e[0]=a[0]*b;e[1]=a[1]*b;e[2]=a[2]*b;return e};a.scaleAndAdd=function(a,b,e,h){h[0]=a[0]+b[0]*e;h[1]=a[1]+b[1]*e;h[2]=a[2]+b[2]*e;return h};a.distance=function(a,b){var e=b[0]-a[0],h=b[1]-a[1],r=b[2]-a[2];return Math.sqrt(e*e+h*h+r*r)};a.dist=a.distance;a.squaredDistance=function(a,b){var e=b[0]-a[0],h=b[1]-a[1],r=b[2]-a[2];return e*e+h*h+r*r};a.sqrDist=a.squaredDistance;a.length=function(a){var b=a[0],e=a[1];a=a[2];return Math.sqrt(b*b+e*e+a*a)};a.len=a.length;
a.squaredLength=function(a){var b=a[0],e=a[1];a=a[2];return b*b+e*e+a*a};a.sqrLen=a.squaredLength;a.negate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];return b};a.inverse=function(a,b){b[0]=1/a[0];b[1]=1/a[1];b[2]=1/a[2];return b};a.normalize=function(a,b){var e=a[0],h=a[1],r=a[2],e=e*e+h*h+r*r;0<e&&(e=1/Math.sqrt(e),b[0]=a[0]*e,b[1]=a[1]*e,b[2]=a[2]*e);return b};a.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]};a.cross=function(a,b,e){var h=a[0],r=a[1];a=a[2];var g=b[0],m=b[1];b=b[2];
e[0]=r*b-a*m;e[1]=a*g-h*b;e[2]=h*m-r*g;return e};a.lerp=function(a,b,e,h){var r=a[0],g=a[1];a=a[2];h[0]=r+e*(b[0]-r);h[1]=g+e*(b[1]-g);h[2]=a+e*(b[2]-a);return h};a.RQ=function(a,b,e,h,r,g){var m=r*r,q=m*(2*r-3)+1,p=m*(r-2)+r,d=m*(r-1);r=m*(3-2*r);g[0]=a[0]*q+b[0]*p+e[0]*d+h[0]*r;g[1]=a[1]*q+b[1]*p+e[1]*d+h[1]*r;g[2]=a[2]*q+b[2]*p+e[2]*d+h[2]*r;return g};a.dy=function(a,b,e,h,r,g){var m=1-r,q=m*m,p=r*r,d=q*m,q=3*r*q,m=3*p*m;r*=p;g[0]=a[0]*d+b[0]*q+e[0]*m+h[0]*r;g[1]=a[1]*d+b[1]*q+e[1]*m+h[1]*r;g[2]=
a[2]*d+b[2]*q+e[2]*m+h[2]*r;return g};a.random=function(a,b){a=a||1;var n=2*e()*Math.PI,h=2*e()-1,r=Math.sqrt(1-h*h)*a;b[0]=Math.cos(n)*r;b[1]=Math.sin(n)*r;b[2]=h*a;return b};a.transformMat4=function(a,b,e){var h=a[0],r=a[1];a=a[2];var g=b[3]*h+b[7]*r+b[11]*a+b[15],g=g||1;e[0]=(b[0]*h+b[4]*r+b[8]*a+b[12])/g;e[1]=(b[1]*h+b[5]*r+b[9]*a+b[13])/g;e[2]=(b[2]*h+b[6]*r+b[10]*a+b[14])/g;return e};a.transformMat3=function(a,b,e){var h=a[0],r=a[1];a=a[2];e[0]=h*b[0]+r*b[3]+a*b[6];e[1]=h*b[1]+r*b[4]+a*b[7];
e[2]=h*b[2]+r*b[5]+a*b[8];return e};a.transformQuat=function(a,b,e){var h=a[0],r=a[1],g=a[2];a=b[0];var m=b[1],q=b[2];b=b[3];var p=b*h+m*g-q*r,d=b*r+q*h-a*g,l=b*g+a*r-m*h,h=-a*h-m*r-q*g;e[0]=p*b+h*-a+d*-q-l*-m;e[1]=d*b+h*-m+l*-a-p*-q;e[2]=l*b+h*-q+p*-m-d*-a;return e};a.rotateX=function(a,b,e,h){var r=[],g=[];r[0]=a[0]-b[0];r[1]=a[1]-b[1];r[2]=a[2]-b[2];g[0]=r[0];g[1]=r[1]*Math.cos(e)-r[2]*Math.sin(e);g[2]=r[1]*Math.sin(e)+r[2]*Math.cos(e);h[0]=g[0]+b[0];h[1]=g[1]+b[1];h[2]=g[2]+b[2];return h};a.rotateY=
function(a,b,e,h){var r=[],g=[];r[0]=a[0]-b[0];r[1]=a[1]-b[1];r[2]=a[2]-b[2];g[0]=r[2]*Math.sin(e)+r[0]*Math.cos(e);g[1]=r[1];g[2]=r[2]*Math.cos(e)-r[0]*Math.sin(e);h[0]=g[0]+b[0];h[1]=g[1]+b[1];h[2]=g[2]+b[2];return h};a.rotateZ=function(a,b,e,h){var r=[],g=[];r[0]=a[0]-b[0];r[1]=a[1]-b[1];r[2]=a[2]-b[2];g[0]=r[0]*Math.cos(e)-r[1]*Math.sin(e);g[1]=r[0]*Math.sin(e)+r[1]*Math.cos(e);g[2]=r[2];h[0]=g[0]+b[0];h[1]=g[1]+b[1];h[2]=g[2]+b[2];return h};a.forEach=function(){var c=a.create();return function(a,
e,h,r,g,m){e||(e=3);h||(h=0);for(r=r?Math.min(r*e+h,a.length):a.length;h<r;h+=e)c[0]=a[h],c[1]=a[h+1],c[2]=a[h+2],g(c,m,c),a[h]=c[0],a[h+1]=c[1],a[h+2]=c[2];return a}}();a.DP=function(c,b){var e=a.fromValues(c[0],c[1],c[2]),h=a.fromValues(b[0],b[1],b[2]);a.normalize(e,e);a.normalize(h,h);e=a.dot(e,h);return 1<e?0:Math.acos(e)};a.str=function(a){return"vec3("+a[0]+", "+a[1]+", "+a[2]+")"}};b4w.module.vec3=b4w.module.__vec3;
b4w.module.__vec4=function(a){var p="undefined"!==typeof Float32Array?Float32Array:Array,e=Math.random;a.create=function(){var a=new p(4);a[0]=0;a[1]=0;a[2]=0;a[3]=0;return a};a.clone=function(a){var b=new p(4);b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b};a.fromValues=function(a,b,e,h){var r=new p(4);r[0]=a;r[1]=b;r[2]=e;r[3]=h;return r};a.copy=function(a,b){b[0]=a[0];b[1]=a[1];b[2]=a[2];b[3]=a[3];return b};a.set=function(a,b,e,h,r){r[0]=a;r[1]=b;r[2]=e;r[3]=h;return r};a.add=function(a,b,e){e[0]=
a[0]+b[0];e[1]=a[1]+b[1];e[2]=a[2]+b[2];e[3]=a[3]+b[3];return e};a.subtract=function(a,b,e){e[0]=a[0]-b[0];e[1]=a[1]-b[1];e[2]=a[2]-b[2];e[3]=a[3]-b[3];return e};a.sub=a.subtract;a.multiply=function(a,b,e){e[0]=a[0]*b[0];e[1]=a[1]*b[1];e[2]=a[2]*b[2];e[3]=a[3]*b[3];return e};a.mul=a.multiply;a.divide=function(a,b,e){e[0]=a[0]/b[0];e[1]=a[1]/b[1];e[2]=a[2]/b[2];e[3]=a[3]/b[3];return e};a.div=a.divide;a.min=function(a,b,e){e[0]=Math.min(a[0],b[0]);e[1]=Math.min(a[1],b[1]);e[2]=Math.min(a[2],b[2]);e[3]=
Math.min(a[3],b[3]);return e};a.max=function(a,b,e){e[0]=Math.max(a[0],b[0]);e[1]=Math.max(a[1],b[1]);e[2]=Math.max(a[2],b[2]);e[3]=Math.max(a[3],b[3]);return e};a.scale=function(a,b,e){e[0]=a[0]*b;e[1]=a[1]*b;e[2]=a[2]*b;e[3]=a[3]*b;return e};a.scaleAndAdd=function(a,b,e,h){h[0]=a[0]+b[0]*e;h[1]=a[1]+b[1]*e;h[2]=a[2]+b[2]*e;h[3]=a[3]+b[3]*e;return h};a.distance=function(a,b){var e=b[0]-a[0],h=b[1]-a[1],r=b[2]-a[2],g=b[3]-a[3];return Math.sqrt(e*e+h*h+r*r+g*g)};a.dist=a.distance;a.squaredDistance=
function(a,b){var e=b[0]-a[0],h=b[1]-a[1],r=b[2]-a[2],g=b[3]-a[3];return e*e+h*h+r*r+g*g};a.sqrDist=a.squaredDistance;a.length=function(a){var b=a[0],e=a[1],h=a[2];a=a[3];return Math.sqrt(b*b+e*e+h*h+a*a)};a.len=a.length;a.squaredLength=function(a){var b=a[0],e=a[1],h=a[2];a=a[3];return b*b+e*e+h*h+a*a};a.sqrLen=a.squaredLength;a.negate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=-a[3];return b};a.inverse=function(a,b){b[0]=1/a[0];b[1]=1/a[1];b[2]=1/a[2];b[3]=1/a[3];return b};a.normalize=
function(a,b){var e=a[0],h=a[1],r=a[2],g=a[3],m=e*e+h*h+r*r+g*g;0<m&&(m=1/Math.sqrt(m),b[0]=e*m,b[1]=h*m,b[2]=r*m,b[3]=g*m);return b};a.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]};a.lerp=function(a,b,e,h){var r=a[0],g=a[1],m=a[2];a=a[3];h[0]=r+e*(b[0]-r);h[1]=g+e*(b[1]-g);h[2]=m+e*(b[2]-m);h[3]=a+e*(b[3]-a);return h};a.random=function(c,b){c=c||1;b[0]=e();b[1]=e();b[2]=e();b[3]=e();a.normalize(b,b);a.scale(b,c,b);return b};a.transformMat4=function(a,b,e){var h=a[0],r=a[1],g=
a[2];a=a[3];e[0]=b[0]*h+b[4]*r+b[8]*g+b[12]*a;e[1]=b[1]*h+b[5]*r+b[9]*g+b[13]*a;e[2]=b[2]*h+b[6]*r+b[10]*g+b[14]*a;e[3]=b[3]*h+b[7]*r+b[11]*g+b[15]*a;return e};a.transformQuat=function(a,b,e){var h=a[0],r=a[1],g=a[2],m=b[0],q=b[1],p=b[2];b=b[3];var d=b*h+q*g-p*r,l=b*r+p*h-m*g,f=b*g+m*r-q*h,h=-m*h-q*r-p*g;e[0]=d*b+h*-m+l*-p-f*-q;e[1]=l*b+h*-q+f*-m-d*-p;e[2]=f*b+h*-p+d*-q-l*-m;e[3]=a[3];return e};a.forEach=function(){var c=a.create();return function(a,e,h,r,g,m){e||(e=4);h||(h=0);for(r=r?Math.min(r*
e+h,a.length):a.length;h<r;h+=e)c[0]=a[h],c[1]=a[h+1],c[2]=a[h+2],c[3]=a[h+3],g(c,m,c),a[h]=c[0],a[h+1]=c[1],a[h+2]=c[2],a[h+3]=c[3];return a}}();a.str=function(a){return"vec4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"}};b4w.module.vec4=b4w.module.__vec4;
b4w.module.__quat=function(a,p){var e=p("__vec3"),c=p("__vec4"),b=p("__mat3"),n="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new n(4);a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};a.rotationTo=function(){var b=e.create(),c=e.fromValues(1,0,0),g=e.fromValues(0,1,0);return function(m,n,p){var d=e.dot(m,n);if(-.9999999>d)return e.cross(c,m,b),1E-6>e.length(b)&&e.cross(g,m,b),e.normalize(b,b),a.setAxisAngle(b,Math.PI,p),p;if(.9999999<d)return p[0]=0,p[1]=0,p[2]=0,p[3]=1,p;e.cross(m,
n,b);p[0]=b[0];p[1]=b[1];p[2]=b[2];p[3]=1+d;return a.normalize(p,p)}}();a.setAxes=function(){var c=b.create();return function(b,e,m,n){c[0]=e[0];c[3]=e[1];c[6]=e[2];c[1]=m[0];c[4]=m[1];c[7]=m[2];c[2]=-b[0];c[5]=-b[1];c[8]=-b[2];return a.normalize(a.fromMat3(c,n),n)}}();a.clone=c.clone;a.fromValues=c.fromValues;a.copy=c.copy;a.set=c.set;a.identity=function(a){a[0]=0;a[1]=0;a[2]=0;a[3]=1;return a};a.setAxisAngle=function(a,b,c){b*=.5;var e=Math.sin(b);c[0]=e*a[0];c[1]=e*a[1];c[2]=e*a[2];c[3]=Math.cos(b);
return c};a.add=c.add;a.multiply=function(a,b,c){var e=a[0],n=a[1],p=a[2];a=a[3];var d=b[0],l=b[1],f=b[2];b=b[3];c[0]=e*b+a*d+n*f-p*l;c[1]=n*b+a*l+p*d-e*f;c[2]=p*b+a*f+e*l-n*d;c[3]=a*b-e*d-n*l-p*f;return c};a.mul=a.multiply;a.scale=c.scale;a.rotateX=function(a,b,c){b*=.5;var e=a[0],n=a[1],p=a[2];a=a[3];var d=Math.sin(b);b=Math.cos(b);c[0]=e*b+a*d;c[1]=n*b+p*d;c[2]=p*b-n*d;c[3]=a*b-e*d;return c};a.rotateY=function(a,b,c){b*=.5;var e=a[0],n=a[1],p=a[2];a=a[3];var d=Math.sin(b);b=Math.cos(b);c[0]=e*
b-p*d;c[1]=n*b+a*d;c[2]=p*b+e*d;c[3]=a*b-n*d;return c};a.rotateZ=function(a,b,c){b*=.5;var e=a[0],n=a[1],p=a[2];a=a[3];var d=Math.sin(b);b=Math.cos(b);c[0]=e*b+n*d;c[1]=n*b-e*d;c[2]=p*b+a*d;c[3]=a*b-p*d;return c};a.calculateW=function(a,b){var c=a[0],e=a[1],n=a[2];b[0]=c;b[1]=e;b[2]=n;b[3]=Math.sqrt(Math.abs(1-c*c-e*e-n*n));return b};a.dot=c.dot;a.lerp=c.lerp;a.slerp=function(a,b,c,e){var n=a[0],p=a[1],d=a[2];a=a[3];var l=b[0],f=b[1],H=b[2];b=b[3];var D,w,E;w=n*l+p*f+d*H+a*b;0>w&&(w=-w,l=-l,f=-f,
H=-H,b=-b);1E-6<1-w?(D=Math.acos(w),E=Math.sin(D),w=Math.sin((1-c)*D)/E,c=Math.sin(c*D)/E):w=1-c;e[0]=w*n+c*l;e[1]=w*p+c*f;e[2]=w*d+c*H;e[3]=w*a+c*b;return e};a.FR=function(){var b=a.create(),c=a.create();return function(e,m,n,p,d,l){a.slerp(e,p,d,b);a.slerp(m,n,d,c);a.slerp(b,c,2*d*(1-d),l);return l}}();a.invert=function(a,b){var c=a[0],e=a[1],n=a[2],p=a[3],d=c*c+e*e+n*n+p*p,d=d?1/d:0;b[0]=-c*d;b[1]=-e*d;b[2]=-n*d;b[3]=p*d;return b};a.conjugate=function(a,b){b[0]=-a[0];b[1]=-a[1];b[2]=-a[2];b[3]=
a[3];return b};a.length=c.length;a.len=a.length;a.squaredLength=c.squaredLength;a.sqrLen=a.squaredLength;a.normalize=c.normalize;a.fromMat3=function(a,b){var c=a[0]+a[4]+a[8];if(0<c)c=Math.sqrt(c+1),b[3]=.5*c,c=.5/c,b[0]=(a[5]-a[7])*c,b[1]=(a[6]-a[2])*c,b[2]=(a[1]-a[3])*c;else{var e=0;a[4]>a[0]&&(e=1);a[8]>a[3*e+e]&&(e=2);var n=(e+1)%3,p=(e+2)%3,c=Math.sqrt(a[3*e+e]-a[3*n+n]-a[3*p+p]+1);b[e]=.5*c;c=.5/c;b[3]=(a[3*n+p]-a[3*p+n])*c;b[n]=(a[3*n+e]+a[3*e+n])*c;b[p]=(a[3*p+e]+a[3*e+p])*c}return b};a.str=
function(a){return"quat("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"}};b4w.module.quat=b4w.module.__quat;
b4w.module.__mat3=function(a){var p="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new p(9);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};a.fromMat4=function(a,c){c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[4];c[4]=a[5];c[5]=a[6];c[6]=a[8];c[7]=a[9];c[8]=a[10];return c};a.clone=function(a){var c=new p(9);c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];c[8]=a[8];return c};a.copy=function(a,c){c[0]=a[0];c[1]=a[1];c[2]=
a[2];c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];c[8]=a[8];return c};a.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=1;a[5]=0;a[6]=0;a[7]=0;a[8]=1;return a};a.transpose=function(a,c){if(c===a){var b=a[1],n=a[2],h=a[5];c[1]=a[3];c[2]=a[6];c[3]=b;c[5]=a[7];c[6]=n;c[7]=h}else c[0]=a[0],c[1]=a[3],c[2]=a[6],c[3]=a[1],c[4]=a[4],c[5]=a[7],c[6]=a[2],c[7]=a[5],c[8]=a[8];return c};a.invert=function(a,c){var b=a[0],n=a[1],h=a[2],r=a[3],g=a[4],m=a[5],q=a[6],p=a[7],d=a[8],l=d*g-m*p,f=-d*r+m*q,H=
p*r-g*q,D=b*l+n*f+h*H;if(!D)return null;D=1/D;c[0]=l*D;c[1]=(-d*n+h*p)*D;c[2]=(m*n-h*g)*D;c[3]=f*D;c[4]=(d*b-h*q)*D;c[5]=(-m*b+h*r)*D;c[6]=H*D;c[7]=(-p*b+n*q)*D;c[8]=(g*b-n*r)*D;return c};a.adjoint=function(a,c){var b=a[0],n=a[1],h=a[2],r=a[3],g=a[4],m=a[5],q=a[6],p=a[7],d=a[8];c[0]=g*d-m*p;c[1]=h*p-n*d;c[2]=n*m-h*g;c[3]=m*q-r*d;c[4]=b*d-h*q;c[5]=h*r-b*m;c[6]=r*p-g*q;c[7]=n*q-b*p;c[8]=b*g-n*r;return c};a.determinant=function(a){var c=a[3],b=a[4],n=a[5],h=a[6],r=a[7],g=a[8];return a[0]*(g*b-n*r)+a[1]*
(-g*c+n*h)+a[2]*(r*c-b*h)};a.multiply=function(a,c,b){var n=a[0],h=a[1],r=a[2],g=a[3],m=a[4],q=a[5],p=a[6],d=a[7];a=a[8];var l=c[0],f=c[1],H=c[2],D=c[3],w=c[4],E=c[5],y=c[6],A=c[7];c=c[8];b[0]=l*n+f*g+H*p;b[1]=l*h+f*m+H*d;b[2]=l*r+f*q+H*a;b[3]=D*n+w*g+E*p;b[4]=D*h+w*m+E*d;b[5]=D*r+w*q+E*a;b[6]=y*n+A*g+c*p;b[7]=y*h+A*m+c*d;b[8]=y*r+A*q+c*a;return b};a.mul=a.multiply;a.translate=function(a,c,b){var n=a[0],h=a[1],r=a[2],g=a[3],m=a[4],q=a[5],p=a[6],d=a[7];a=a[8];var l=c[0];c=c[1];b[0]=n;b[1]=h;b[2]=r;
b[3]=g;b[4]=m;b[5]=q;b[6]=l*n+c*g+p;b[7]=l*h+c*m+d;b[8]=l*r+c*q+a;return b};a.rotate=function(a,c,b){var n=a[0],h=a[1],r=a[2],g=a[3],m=a[4],q=a[5],p=a[6],d=a[7];a=a[8];var l=Math.sin(c);c=Math.cos(c);b[0]=c*n+l*g;b[1]=c*h+l*m;b[2]=c*r+l*q;b[3]=c*g-l*n;b[4]=c*m-l*h;b[5]=c*q-l*r;b[6]=p;b[7]=d;b[8]=a;return b};a.scale=function(a,c,b){var n=c[0];c=c[1];b[0]=n*a[0];b[1]=n*a[1];b[2]=n*a[2];b[3]=c*a[3];b[4]=c*a[4];b[5]=c*a[5];b[6]=a[6];b[7]=a[7];b[8]=a[8];return b};a.bJ=function(a,c){c[0]=1;c[1]=0;c[2]=
0;c[3]=0;c[4]=1;c[5]=0;c[6]=a[0];c[7]=a[1];c[8]=1;return c};a.$I=function(a,c){var b=Math.sin(a),n=Math.cos(a);c[0]=n;c[1]=b;c[2]=0;c[3]=-b;c[4]=n;c[5]=0;c[6]=0;c[7]=0;c[8]=1;return c};a.aJ=function(a,c){c[0]=a[0];c[1]=0;c[2]=0;c[3]=0;c[4]=a[1];c[5]=0;c[6]=0;c[7]=0;c[8]=1;return c};a.fromMat2d=function(a,c){c[0]=a[0];c[1]=a[1];c[2]=0;c[3]=a[2];c[4]=a[3];c[5]=0;c[6]=a[4];c[7]=a[5];c[8]=1;return c};a.fromQuat=function(a,c){var b=a[0],n=a[1],h=a[2],r=a[3],g=b+b,m=n+n,q=h+h,b=b*g,p=n*g,n=n*m,d=h*g,l=
h*m,h=h*q,g=r*g,m=r*m,r=r*q;c[0]=1-n-h;c[3]=p-r;c[6]=d+m;c[1]=p+r;c[4]=1-b-h;c[7]=l-g;c[2]=d-m;c[5]=l+g;c[8]=1-b-n;return c};a.normalFromMat4=function(a,c){var b=a[0],n=a[1],h=a[2],r=a[3],g=a[4],m=a[5],q=a[6],p=a[7],d=a[8],l=a[9],f=a[10],H=a[11],D=a[12],w=a[13],E=a[14],y=a[15],A=b*m-n*g,G=b*q-h*g,x=b*p-r*g,k=n*q-h*m,t=n*p-r*m,M=h*p-r*q,u=d*w-l*D,v=d*E-f*D,d=d*y-H*D,z=l*E-f*w,l=l*y-H*w,f=f*y-H*E,H=A*f-G*l+x*z+k*d-t*v+M*u;if(!H)return null;H=1/H;c[0]=(m*f-q*l+p*z)*H;c[1]=(q*d-g*f-p*v)*H;c[2]=(g*l-m*
d+p*u)*H;c[3]=(h*l-n*f-r*z)*H;c[4]=(b*f-h*d+r*v)*H;c[5]=(n*d-b*l-r*u)*H;c[6]=(w*M-E*t+y*k)*H;c[7]=(E*x-D*M-y*G)*H;c[8]=(D*t-w*x+y*A)*H;return c};a.str=function(a){return"mat3("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+")"};a.ZI=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2))}};b4w.module.mat3=b4w.module.__mat3;
b4w.module.__mat4=function(a){var p="undefined"!==typeof Float32Array?Float32Array:Array;a.create=function(){var a=new p(16);a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.clone=function(a){var c=new p(16);c[0]=a[0];c[1]=a[1];c[2]=a[2];c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];c[8]=a[8];c[9]=a[9];c[10]=a[10];c[11]=a[11];c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15];return c};a.copy=function(a,c){c[0]=a[0];
c[1]=a[1];c[2]=a[2];c[3]=a[3];c[4]=a[4];c[5]=a[5];c[6]=a[6];c[7]=a[7];c[8]=a[8];c[9]=a[9];c[10]=a[10];c[11]=a[11];c[12]=a[12];c[13]=a[13];c[14]=a[14];c[15]=a[15];return c};a.identity=function(a){a[0]=1;a[1]=0;a[2]=0;a[3]=0;a[4]=0;a[5]=1;a[6]=0;a[7]=0;a[8]=0;a[9]=0;a[10]=1;a[11]=0;a[12]=0;a[13]=0;a[14]=0;a[15]=1;return a};a.transpose=function(a,c){if(c===a){var b=a[1],n=a[2],h=a[3],r=a[6],g=a[7],m=a[11];c[1]=a[4];c[2]=a[8];c[3]=a[12];c[4]=b;c[6]=a[9];c[7]=a[13];c[8]=n;c[9]=r;c[11]=a[14];c[12]=h;c[13]=
g;c[14]=m}else c[0]=a[0],c[1]=a[4],c[2]=a[8],c[3]=a[12],c[4]=a[1],c[5]=a[5],c[6]=a[9],c[7]=a[13],c[8]=a[2],c[9]=a[6],c[10]=a[10],c[11]=a[14],c[12]=a[3],c[13]=a[7],c[14]=a[11],c[15]=a[15];return c};a.invert=function(a,c){var b=a[0],n=a[1],h=a[2],r=a[3],g=a[4],m=a[5],q=a[6],p=a[7],d=a[8],l=a[9],f=a[10],H=a[11],D=a[12],w=a[13],E=a[14],y=a[15],A=b*m-n*g,G=b*q-h*g,x=b*p-r*g,k=n*q-h*m,t=n*p-r*m,M=h*p-r*q,u=d*w-l*D,v=d*E-f*D,z=d*y-H*D,S=l*E-f*w,C=l*y-H*w,W=f*y-H*E,F=A*W-G*C+x*S+k*z-t*v+M*u;if(!F)return null;
F=1/F;c[0]=(m*W-q*C+p*S)*F;c[1]=(h*C-n*W-r*S)*F;c[2]=(w*M-E*t+y*k)*F;c[3]=(f*t-l*M-H*k)*F;c[4]=(q*z-g*W-p*v)*F;c[5]=(b*W-h*z+r*v)*F;c[6]=(E*x-D*M-y*G)*F;c[7]=(d*M-f*x+H*G)*F;c[8]=(g*C-m*z+p*u)*F;c[9]=(n*z-b*C-r*u)*F;c[10]=(D*t-w*x+y*A)*F;c[11]=(l*x-d*t-H*A)*F;c[12]=(m*v-g*S-q*u)*F;c[13]=(b*S-n*v+h*u)*F;c[14]=(w*G-D*k-E*A)*F;c[15]=(d*k-l*G+f*A)*F;return c};a.adjoint=function(a,c){var b=a[0],n=a[1],h=a[2],r=a[3],g=a[4],m=a[5],q=a[6],p=a[7],d=a[8],l=a[9],f=a[10],H=a[11],D=a[12],w=a[13],E=a[14],y=a[15];
c[0]=m*(f*y-H*E)-l*(q*y-p*E)+w*(q*H-p*f);c[1]=-(n*(f*y-H*E)-l*(h*y-r*E)+w*(h*H-r*f));c[2]=n*(q*y-p*E)-m*(h*y-r*E)+w*(h*p-r*q);c[3]=-(n*(q*H-p*f)-m*(h*H-r*f)+l*(h*p-r*q));c[4]=-(g*(f*y-H*E)-d*(q*y-p*E)+D*(q*H-p*f));c[5]=b*(f*y-H*E)-d*(h*y-r*E)+D*(h*H-r*f);c[6]=-(b*(q*y-p*E)-g*(h*y-r*E)+D*(h*p-r*q));c[7]=b*(q*H-p*f)-g*(h*H-r*f)+d*(h*p-r*q);c[8]=g*(l*y-H*w)-d*(m*y-p*w)+D*(m*H-p*l);c[9]=-(b*(l*y-H*w)-d*(n*y-r*w)+D*(n*H-r*l));c[10]=b*(m*y-p*w)-g*(n*y-r*w)+D*(n*p-r*m);c[11]=-(b*(m*H-p*l)-g*(n*H-r*l)+d*
(n*p-r*m));c[12]=-(g*(l*E-f*w)-d*(m*E-q*w)+D*(m*f-q*l));c[13]=b*(l*E-f*w)-d*(n*E-h*w)+D*(n*f-h*l);c[14]=-(b*(m*E-q*w)-g*(n*E-h*w)+D*(n*q-h*m));c[15]=b*(m*f-q*l)-g*(n*f-h*l)+d*(n*q-h*m);return c};a.determinant=function(a){var c=a[0],b=a[1],n=a[2],h=a[3],r=a[4],g=a[5],m=a[6],q=a[7],p=a[8],d=a[9],l=a[10],f=a[11],H=a[12],D=a[13],w=a[14];a=a[15];return(c*g-b*r)*(l*a-f*w)-(c*m-n*r)*(d*a-f*D)+(c*q-h*r)*(d*w-l*D)+(b*m-n*g)*(p*a-f*H)-(b*q-h*g)*(p*w-l*H)+(n*q-h*m)*(p*D-d*H)};a.multiply=function(a,c,b){var n=
a[0],h=a[1],r=a[2],g=a[3],m=a[4],q=a[5],p=a[6],d=a[7],l=a[8],f=a[9],H=a[10],D=a[11],w=a[12],E=a[13],y=a[14];a=a[15];var A=c[0],G=c[1],x=c[2],k=c[3];b[0]=A*n+G*m+x*l+k*w;b[1]=A*h+G*q+x*f+k*E;b[2]=A*r+G*p+x*H+k*y;b[3]=A*g+G*d+x*D+k*a;A=c[4];G=c[5];x=c[6];k=c[7];b[4]=A*n+G*m+x*l+k*w;b[5]=A*h+G*q+x*f+k*E;b[6]=A*r+G*p+x*H+k*y;b[7]=A*g+G*d+x*D+k*a;A=c[8];G=c[9];x=c[10];k=c[11];b[8]=A*n+G*m+x*l+k*w;b[9]=A*h+G*q+x*f+k*E;b[10]=A*r+G*p+x*H+k*y;b[11]=A*g+G*d+x*D+k*a;A=c[12];G=c[13];x=c[14];k=c[15];b[12]=A*n+
G*m+x*l+k*w;b[13]=A*h+G*q+x*f+k*E;b[14]=A*r+G*p+x*H+k*y;b[15]=A*g+G*d+x*D+k*a;return b};a.mul=a.multiply;a.translate=function(a,c,b){var n=c[0],h=c[1];c=c[2];var r,g,m,q,p,d,l,f,H,D,w,E;a===b?(b[12]=a[0]*n+a[4]*h+a[8]*c+a[12],b[13]=a[1]*n+a[5]*h+a[9]*c+a[13],b[14]=a[2]*n+a[6]*h+a[10]*c+a[14],b[15]=a[3]*n+a[7]*h+a[11]*c+a[15]):(r=a[0],g=a[1],m=a[2],q=a[3],p=a[4],d=a[5],l=a[6],f=a[7],H=a[8],D=a[9],w=a[10],E=a[11],b[0]=r,b[1]=g,b[2]=m,b[3]=q,b[4]=p,b[5]=d,b[6]=l,b[7]=f,b[8]=H,b[9]=D,b[10]=w,b[11]=E,
b[12]=r*n+p*h+H*c+a[12],b[13]=g*n+d*h+D*c+a[13],b[14]=m*n+l*h+w*c+a[14],b[15]=q*n+f*h+E*c+a[15]);return b};a.scale=function(a,c,b){var n=c[0],h=c[1];c=c[2];b[0]=a[0]*n;b[1]=a[1]*n;b[2]=a[2]*n;b[3]=a[3]*n;b[4]=a[4]*h;b[5]=a[5]*h;b[6]=a[6]*h;b[7]=a[7]*h;b[8]=a[8]*c;b[9]=a[9]*c;b[10]=a[10]*c;b[11]=a[11]*c;b[12]=a[12];b[13]=a[13];b[14]=a[14];b[15]=a[15];return b};a.rotate=function(a,c,b,n){var h=b[0],r=b[1];b=b[2];var g=Math.sqrt(h*h+r*r+b*b),m,q,p,d,l,f,H,D,w,E,y,A,G,x,k,t,M,u,v,z;if(1E-7>Math.abs(g))return null;
g=1/g;h*=g;r*=g;b*=g;m=Math.sin(c);q=Math.cos(c);p=1-q;c=a[0];g=a[1];d=a[2];l=a[3];f=a[4];H=a[5];D=a[6];w=a[7];E=a[8];y=a[9];A=a[10];G=a[11];x=h*h*p+q;k=r*h*p+b*m;t=b*h*p-r*m;M=h*r*p-b*m;u=r*r*p+q;v=b*r*p+h*m;z=h*b*p+r*m;h=r*b*p-h*m;r=b*b*p+q;n[0]=c*x+f*k+E*t;n[1]=g*x+H*k+y*t;n[2]=d*x+D*k+A*t;n[3]=l*x+w*k+G*t;n[4]=c*M+f*u+E*v;n[5]=g*M+H*u+y*v;n[6]=d*M+D*u+A*v;n[7]=l*M+w*u+G*v;n[8]=c*z+f*h+E*r;n[9]=g*z+H*h+y*r;n[10]=d*z+D*h+A*r;n[11]=l*z+w*h+G*r;a!==n&&(n[12]=a[12],n[13]=a[13],n[14]=a[14],n[15]=a[15]);
return n};a.rotateX=function(a,c,b){var n=Math.sin(c);c=Math.cos(c);var h=a[4],r=a[5],g=a[6],m=a[7],q=a[8],p=a[9],d=a[10],l=a[11];a!==b&&(b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);b[4]=h*c+q*n;b[5]=r*c+p*n;b[6]=g*c+d*n;b[7]=m*c+l*n;b[8]=q*c-h*n;b[9]=p*c-r*n;b[10]=d*c-g*n;b[11]=l*c-m*n;return b};a.rotateY=function(a,c,b){var n=Math.sin(c);c=Math.cos(c);var h=a[0],r=a[1],g=a[2],m=a[3],q=a[8],p=a[9],d=a[10],l=a[11];a!==b&&(b[4]=a[4],b[5]=a[5],b[6]=a[6],
b[7]=a[7],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);b[0]=h*c-q*n;b[1]=r*c-p*n;b[2]=g*c-d*n;b[3]=m*c-l*n;b[8]=h*n+q*c;b[9]=r*n+p*c;b[10]=g*n+d*c;b[11]=m*n+l*c;return b};a.rotateZ=function(a,c,b){var n=Math.sin(c);c=Math.cos(c);var h=a[0],r=a[1],g=a[2],m=a[3],q=a[4],p=a[5],d=a[6],l=a[7];a!==b&&(b[8]=a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15]);b[0]=h*c+q*n;b[1]=r*c+p*n;b[2]=g*c+d*n;b[3]=m*c+l*n;b[4]=q*c-h*n;b[5]=p*c-r*n;b[6]=d*c-g*n;b[7]=l*c-m*n;return b};
a.bJ=function(a,c){c[0]=1;c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=1;c[6]=0;c[7]=0;c[8]=0;c[9]=0;c[10]=1;c[11]=0;c[12]=a[0];c[13]=a[1];c[14]=a[2];c[15]=1;return c};a.aJ=function(a,c){c[0]=a[0];c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=a[1];c[6]=0;c[7]=0;c[8]=0;c[9]=0;c[10]=a[2];c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};a.$I=function(a,c,b){var n=c[0],h=c[1];c=c[2];var r=Math.sqrt(n*n+h*h+c*c),g;if(1E-7>Math.abs(r))return null;r=1/r;n*=r;h*=r;c*=r;r=Math.sin(a);a=Math.cos(a);g=1-a;b[0]=n*n*g+a;b[1]=h*n*g+c*
r;b[2]=c*n*g-h*r;b[3]=0;b[4]=n*h*g-c*r;b[5]=h*h*g+a;b[6]=c*h*g+n*r;b[7]=0;b[8]=n*c*g+h*r;b[9]=h*c*g-n*r;b[10]=c*c*g+a;b[11]=0;b[12]=0;b[13]=0;b[14]=0;b[15]=1;return b};a.pQ=function(a,c){var b=Math.sin(a),n=Math.cos(a);c[0]=1;c[1]=0;c[2]=0;c[3]=0;c[4]=0;c[5]=n;c[6]=b;c[7]=0;c[8]=0;c[9]=-b;c[10]=n;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};a.qQ=function(a,c){var b=Math.sin(a),n=Math.cos(a);c[0]=n;c[1]=0;c[2]=-b;c[3]=0;c[4]=0;c[5]=1;c[6]=0;c[7]=0;c[8]=b;c[9]=0;c[10]=n;c[11]=0;c[12]=0;c[13]=0;
c[14]=0;c[15]=1;return c};a.rQ=function(a,c){var b=Math.sin(a),n=Math.cos(a);c[0]=n;c[1]=b;c[2]=0;c[3]=0;c[4]=-b;c[5]=n;c[6]=0;c[7]=0;c[8]=0;c[9]=0;c[10]=1;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};a.fromRotationTranslation=function(a,c,b){var n=a[0],h=a[1],r=a[2],g=a[3],m=n+n,q=h+h,p=r+r;a=n*m;var d=n*q,n=n*p,l=h*q,h=h*p,r=r*p,m=g*m,q=g*q,g=g*p;b[0]=1-(l+r);b[1]=d+g;b[2]=n-q;b[3]=0;b[4]=d-g;b[5]=1-(a+r);b[6]=h+m;b[7]=0;b[8]=n+q;b[9]=h-m;b[10]=1-(a+l);b[11]=0;b[12]=c[0];b[13]=c[1];b[14]=c[2];
b[15]=1;return b};a.nQ=function(a,c,b,n){var h=a[0],r=a[1],g=a[2],m=a[3],q=h+h,p=r+r,d=g+g;a=h*q;var l=h*p,h=h*d,f=r*p,r=r*d,g=g*d,q=m*q,p=m*p,m=m*d,d=b[0],H=b[1];b=b[2];n[0]=(1-(f+g))*d;n[1]=(l+m)*d;n[2]=(h-p)*d;n[3]=0;n[4]=(l-m)*H;n[5]=(1-(a+g))*H;n[6]=(r+q)*H;n[7]=0;n[8]=(h+p)*b;n[9]=(r-q)*b;n[10]=(1-(a+f))*b;n[11]=0;n[12]=c[0];n[13]=c[1];n[14]=c[2];n[15]=1;return n};a.oQ=function(a,c,b,n,h){var r=a[0],g=a[1],m=a[2],q=a[3],p=r+r,d=g+g,l=m+m;a=r*p;var f=r*d,r=r*l,H=g*d,g=g*l,m=m*l,p=q*p,d=q*d,q=
q*l,l=b[0],D=b[1];b=b[2];var w=n[0],E=n[1];n=n[2];h[0]=(1-(H+m))*l;h[1]=(f+q)*l;h[2]=(r-d)*l;h[3]=0;h[4]=(f-q)*D;h[5]=(1-(a+m))*D;h[6]=(g+p)*D;h[7]=0;h[8]=(r+d)*b;h[9]=(g-p)*b;h[10]=(1-(a+H))*b;h[11]=0;h[12]=c[0]+w-(h[0]*w+h[4]*E+h[8]*n);h[13]=c[1]+E-(h[1]*w+h[5]*E+h[9]*n);h[14]=c[2]+n-(h[2]*w+h[6]*E+h[10]*n);h[15]=1;return h};a.fromQuat=function(a,c){var b=a[0],n=a[1],h=a[2],r=a[3],g=b+b,m=n+n,q=h+h,b=b*g,p=n*g,n=n*m,d=h*g,l=h*m,h=h*q,g=r*g,m=r*m,r=r*q;c[0]=1-n-h;c[1]=p+r;c[2]=d-m;c[3]=0;c[4]=p-
r;c[5]=1-b-h;c[6]=l+g;c[7]=0;c[8]=d+m;c[9]=l-g;c[10]=1-b-n;c[11]=0;c[12]=0;c[13]=0;c[14]=0;c[15]=1;return c};a.frustum=function(a,c,b,n,h,r,g){var m=1/(c-a),q=1/(n-b),p=1/(h-r);g[0]=2*h*m;g[1]=0;g[2]=0;g[3]=0;g[4]=0;g[5]=2*h*q;g[6]=0;g[7]=0;g[8]=(c+a)*m;g[9]=(n+b)*q;g[10]=(r+h)*p;g[11]=-1;g[12]=0;g[13]=0;g[14]=r*h*2*p;g[15]=0;return g};a.perspective=function(a,c,b,n,h){a=1/Math.tan(a/2);var r=1/(b-n);h[0]=a/c;h[1]=0;h[2]=0;h[3]=0;h[4]=0;h[5]=a;h[6]=0;h[7]=0;h[8]=0;h[9]=0;h[10]=(n+b)*r;h[11]=-1;h[12]=
0;h[13]=0;h[14]=2*n*b*r;h[15]=0;return h};a.sR=function(a,c,b,n){var h=Math.tan(a.upDegrees*Math.PI/180),r=Math.tan(a.downDegrees*Math.PI/180),g=Math.tan(a.leftDegrees*Math.PI/180);a=Math.tan(a.rightDegrees*Math.PI/180);var m=2/(g+a),q=2/(h+r);n[0]=m;n[1]=0;n[2]=0;n[3]=0;n[4]=0;n[5]=q;n[6]=0;n[7]=0;n[8]=-((g-a)*m*.5);n[9]=(h-r)*q*.5;n[10]=b/(c-b);n[11]=-1;n[12]=0;n[13]=0;n[14]=b*c/(c-b);n[15]=0;return n};a.ortho=function(a,c,b,n,h,r,g){var m=1/(a-c),q=1/(b-n),p=1/(h-r);g[0]=-2*m;g[1]=0;g[2]=0;g[3]=
0;g[4]=0;g[5]=-2*q;g[6]=0;g[7]=0;g[8]=0;g[9]=0;g[10]=2*p;g[11]=0;g[12]=(a+c)*m;g[13]=(n+b)*q;g[14]=(r+h)*p;g[15]=1;return g};a.lookAt=function(e,c,b,n){var h,r,g,m,q,p,d,l,f=e[0],H=e[1];e=e[2];g=b[0];m=b[1];r=b[2];d=c[0];b=c[1];h=c[2];if(1E-7>Math.abs(f-d)&&1E-7>Math.abs(H-b)&&1E-7>Math.abs(e-h))return a.identity(n);c=f-d;b=H-b;d=e-h;l=1/Math.sqrt(c*c+b*b+d*d);c*=l;b*=l;d*=l;h=m*d-r*b;r=r*c-g*d;g=g*b-m*c;(l=Math.sqrt(h*h+r*r+g*g))?(l=1/l,h*=l,r*=l,g*=l):g=r=h=0;m=b*g-d*r;q=d*h-c*g;p=c*r-b*h;(l=Math.sqrt(m*
m+q*q+p*p))?(l=1/l,m*=l,q*=l,p*=l):p=q=m=0;n[0]=h;n[1]=m;n[2]=c;n[3]=0;n[4]=r;n[5]=q;n[6]=b;n[7]=0;n[8]=g;n[9]=p;n[10]=d;n[11]=0;n[12]=-(h*f+r*H+g*e);n[13]=-(m*f+q*H+p*e);n[14]=-(c*f+b*H+d*e);n[15]=1;return n};a.str=function(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"};a.ZI=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2)+Math.pow(a[2],2)+Math.pow(a[3],
2)+Math.pow(a[4],2)+Math.pow(a[5],2)+Math.pow(a[6],2)+Math.pow(a[7],2)+Math.pow(a[8],2)+Math.pow(a[9],2)+Math.pow(a[10],2)+Math.pow(a[11],2)+Math.pow(a[12],2)+Math.pow(a[13],2)+Math.pow(a[14],2)+Math.pow(a[15],2))}};b4w.module.mat4=b4w.module.__mat4;b4w.module.__md5=function(a){function p(a,g){var h=a[0],q=a[1],p=a[2],d=a[3],h=c(h,q,p,d,g[0],7,-680876936),d=c(d,h,q,p,g[1],12,-389564586),p=c(p,d,h,q,g[2],17,606105819),q=c(q,p,d,h,g[3],22,-1044525330),h=c(h,q,p,d,g[4],7,-176418897),d=c(d,h,q,p,g[5],12,1200080426),p=c(p,d,h,q,g[6],17,-1473231341),q=c(q,p,d,h,g[7],22,-45705983),h=c(h,q,p,d,g[8],7,1770035416),d=c(d,h,q,p,g[9],12,-1958414417),p=c(p,d,h,q,g[10],17,-42063),q=c(q,p,d,h,g[11],22,-1990404162),h=c(h,q,p,d,g[12],7,1804603682),d=c(d,h,q,p,
g[13],12,-40341101),p=c(p,d,h,q,g[14],17,-1502002290),q=c(q,p,d,h,g[15],22,1236535329),h=b(h,q,p,d,g[1],5,-165796510),d=b(d,h,q,p,g[6],9,-1069501632),p=b(p,d,h,q,g[11],14,643717713),q=b(q,p,d,h,g[0],20,-373897302),h=b(h,q,p,d,g[5],5,-701558691),d=b(d,h,q,p,g[10],9,38016083),p=b(p,d,h,q,g[15],14,-660478335),q=b(q,p,d,h,g[4],20,-405537848),h=b(h,q,p,d,g[9],5,568446438),d=b(d,h,q,p,g[14],9,-1019803690),p=b(p,d,h,q,g[3],14,-187363961),q=b(q,p,d,h,g[8],20,1163531501),h=b(h,q,p,d,g[13],5,-1444681467),d=
b(d,h,q,p,g[2],9,-51403784),p=b(p,d,h,q,g[7],14,1735328473),q=b(q,p,d,h,g[12],20,-1926607734),h=e(q^p^d,h,q,g[5],4,-378558),d=e(h^q^p,d,h,g[8],11,-2022574463),p=e(d^h^q,p,d,g[11],16,1839030562),q=e(p^d^h,q,p,g[14],23,-35309556),h=e(q^p^d,h,q,g[1],4,-1530992060),d=e(h^q^p,d,h,g[4],11,1272893353),p=e(d^h^q,p,d,g[7],16,-155497632),q=e(p^d^h,q,p,g[10],23,-1094730640),h=e(q^p^d,h,q,g[13],4,681279174),d=e(h^q^p,d,h,g[0],11,-358537222),p=e(d^h^q,p,d,g[3],16,-722521979),q=e(p^d^h,q,p,g[6],23,76029189),h=
e(q^p^d,h,q,g[9],4,-640364487),d=e(h^q^p,d,h,g[12],11,-421815835),p=e(d^h^q,p,d,g[15],16,530742520),q=e(p^d^h,q,p,g[2],23,-995338651),h=n(h,q,p,d,g[0],6,-198630844),d=n(d,h,q,p,g[7],10,1126891415),p=n(p,d,h,q,g[14],15,-1416354905),q=n(q,p,d,h,g[5],21,-57434055),h=n(h,q,p,d,g[12],6,1700485571),d=n(d,h,q,p,g[3],10,-1894986606),p=n(p,d,h,q,g[10],15,-1051523),q=n(q,p,d,h,g[1],21,-2054922799),h=n(h,q,p,d,g[8],6,1873313359),d=n(d,h,q,p,g[15],10,-30611744),p=n(p,d,h,q,g[6],15,-1560198380),q=n(q,p,d,h,g[13],
21,1309151649),h=n(h,q,p,d,g[4],6,-145523070),d=n(d,h,q,p,g[11],10,-1120210379),p=n(p,d,h,q,g[2],15,718787259),q=n(q,p,d,h,g[9],21,-343485551);a[0]=h+a[0]&4294967295;a[1]=q+a[1]&4294967295;a[2]=p+a[2]&4294967295;a[3]=d+a[3]&4294967295}function e(a,b,c,e,h,d){b=(b+a&4294967295)+(e+d&4294967295)&4294967295;return(b<<h|b>>>32-h)+c&4294967295}function c(a,b,c,h,n,d,l){return e(b&c|~b&h,a,b,n,d,l)}function b(a,b,c,h,n,d,l){return e(b&h|c&~h,a,b,n,d,l)}function n(a,b,c,h,n,d,l){return e(c^(b|~h),a,b,n,
d,l)}var h="0123456789abcdef".split("");a.dA=function(a){var b=a,c=b.length;a=[1732584193,-271733879,-1732584194,271733878];var e;for(e=64;e<=b.length;e+=64){for(var n=b.substring(e-64,e),d=[],l=void 0,l=0;64>l;l+=4)d[l>>2]=n.charCodeAt(l)+(n.charCodeAt(l+1)<<8)+(n.charCodeAt(l+2)<<16)+(n.charCodeAt(l+3)<<24);p(a,d)}b=b.substring(e-64);n=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(e=0;e<b.length;e++)n[e>>2]|=b.charCodeAt(e)<<(e%4<<3);n[e>>2]|=128<<(e%4<<3);if(55<e)for(p(a,n),e=0;16>e;e++)n[e]=0;n[14]=8*
c;p(a,n);for(b=0;b<a.length;b++){c=a[b];e="";for(n=0;4>n;n++)e+=h[c>>8*n+4&15]+h[c>>8*n&15];a[b]=e}return a.join("")}};b4w.module.shader_texts=function(a){a["anchors.glslf"]={a:"grp",c:[{a:"version",b:["GLSL_VERSION"]},{a:"include",n:"precision_statement.glslf"},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 ) ; }".split(" ")}]};a["anchors.glslv"]={a:"grp",c:[{a:"version",b:["GLSL_VERSION"]},{a:"include",n:"math.glslv"},{a:"txt",b:"uniform vec3 u_position [ ANCHOR_NUM ] ; uniform mat4 u_view_proj_matrix ; GLSL_IN float a_index ; void main ( ) { gl_Position = u_view_proj_matrix * vec4 ( u_position [ int ( a_index ) ] , 1.0 ) ; gl_PointSize = 4.0 ; }".split(" ")}]};
a["color_id.glslf"]={a:"grp",c:[{a:"version",b:["GLSL_VERSION"]},{a:"include",n:"precision_statement.glslf"},{a:"include",n:"std_enums.glsl"},{a:"cond",c:[{a:"if",e:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"include",n:"pack.glslf"},{a:"include",n:"procedural.glslf"},{a:"include",n:"color_util.glslf"},{a:"include",n:"math.glslv"},{a:"cond",c:[{a:"if",e:["CAUSTICS"],h:{a:"grp",c:[{a:"include",n:"caustics.glslf"}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["NODES","ALPHA",{a:"logical_and_expr",
i:2}],h:{a:"grp",c:[{a:"txt",b:"uniform float u_time ; uniform float u_environment_energy ;".split(" ")},{a:"cond",c:[{a:"if",e:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},{a:"txt",b:["uniform","vec3","u_camera_eye_frag",";"]},{a:"cond",c:[{a:"if",e:["REFLECTION_TYPE",
"REFL_PLANE",{a:"equal_expr",i:2},"USE_NODE_GEOMETRY_VW",{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{a:"cond",c:[{a:"if",e:["USE_ZUP_VIEW_MATRIX"],h:{a:"grp",c:[{a:"txt",b:["uniform","mat3","u_view_zup_tsr",";"]}]}}]},{a:"cond",c:[{a:"if",e:["USE_ZUP_VIEW_MATRIX_INVERSE"],h:{a:"grp",c:[{a:"txt",b:["uniform","mat3","u_view_zup_tsr_inverse",";"]}]}}]},{a:"cond",c:[{a:"if",e:["USE_ZUP_MODEL_MATRIX"],h:{a:"grp",c:[{a:"txt",b:["uniform","mat3","u_model_zup_tsr",
";"]}]}}]},{a:"cond",c:[{a:"if",e:["USE_ZUP_MODEL_MATRIX_INVERSE"],h:{a:"grp",c:[{a:"txt",b:["uniform","mat3","u_model_zup_tsr_inverse",";"]}]}}]},{a:"cond",c:[{a:"if",e:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",e:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]}]}},{a:"else",
h:{a:"grp",c:[{a:"txt",b:["uniform","vec4","u_diffuse_color",";"]},{a:"cond",c:[{a:"if",e:["TEXTURE_COLOR"],h:{a:"grp",c:[{a:"txt",b:"uniform sampler2D u_sampler ; uniform float u_alpha_factor ;".split(" ")}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["USE_OUTLINE",{a:"logic_negative_expr",i:1}],h:{a:"grp",c:[{a:"txt",b:["uniform","vec3","u_color_id",";"]}]}}]},{a:"cond",c:[{a:"if",e:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{a:"logical_or_expr",i:3}],h:{a:"grp",c:[{a:"txt",b:["uniform",
"sampler2D","u_nodes_texture",";"]}]}}]},{a:"cond",c:[{a:"if",e:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","sampler2D","u_plane_reflection",";"]}]}},{a:"elif",e:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{a:"elif",e:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",
c:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"cond",c:[{a:"if",e:["USE_NODE_B4W_REFRACTION"],h:{a:"grp",c:[{a:"txt",b:["uniform","sampler2D","u_refractmap",";"]},{a:"cond",c:[{a:"if",e:["USE_REFRACTION","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]}]}}]},{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ;".split(" ")},{a:"cond",c:[{a:"if",e:["REFLECTION_TYPE",
"REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}},{a:"elif",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{a:"cond",c:[{a:"if",e:["USE_NODE_LAMP"],h:{a:"grp",c:[{a:"txt",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ; uniform vec4 u_lamp_light_factors [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},
{a:"cond",c:[{a:"if",e:["USE_NODE_VALUE"],h:{a:"grp",c:[{a:"txt",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["USE_NODE_RGB"],h:{a:"grp",c:[{a:"txt",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"uniform vec4 u_pcf_blur_radii ; uniform vec4 u_csm_center_dists ; uniform sampler2D u_shadow_map0 ; uniform sampler2D u_shadow_map1 ; uniform sampler2D u_shadow_map2 ; uniform sampler2D u_shadow_map3 ; uniform sampler2D u_shadow_mask ;".split(" ")}]}}]}]}}]},
{a:"cond",c:[{a:"if",e:["USE_OUTLINE"],h:{a:"grp",c:[{a:"txt",b:["uniform","float","u_outline_intensity",";"]}]}}]},{a:"cond",c:[{a:"if",e:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"GLSL_IN vec3 bG ; GLSL_IN vec4 bH ;".split(" ")},{a:"cond",c:[{a:"if",e:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",i:5}],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec3","bI",";"]}]}}]},{a:"cond",c:[{a:"if",e:["CALC_TBN_SPACE"],
h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec4","bJ",";"]}]}}]},{a:"cond",c:[{a:"if",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec3","bK",";"]}]}}]},{a:"cond",c:[{a:"if",e:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","float","bL",";"]}]}}]},{a:"cond",c:[{a:"if",e:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",
b:"GLSL_IN vec4 bM ; GLSL_IN vec4 bN ; GLSL_IN vec4 bO ; GLSL_IN vec4 bP ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["TEXTURE_COLOR"],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec2","bQ",";"]}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["USE_TBN_SHADING"],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec3","bR",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"cond",c:[{a:"if",e:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"include",n:"shadow.glslf"},{a:"include",
n:"mirror.glslf"},{a:"include",n:"environment.glslf"},{a:"cond",c:[{a:"if",e:["USE_NODE_B4W_REFRACTION"],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["USE_REFRACTION"],h:{a:"grp",c:[{a:"include",n:"refraction.glslf"}]}}]}]}}]},{a:"include",n:"nodes.glslf"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",c:[{a:"if",e:["ALPHA"],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["NODES"],h:{a:"grp",c:[{a:"txt",b:"vec3 cW = u_camera_eye_frag - bG ; vec3 dY = normalize ( cW ) ; vec3 ed ; vec3 ee ; vec3 ef ; vec4 eg ; float eh ; mat4 dZ = mat4 ( 0.0 ) ; mat4 d_ = mat4 ( 0.0 ) ; mat4 ea = mat4 ( 0.0 ) ; mat4 eb = mat4 ( 0.0 ) ; mat4 ec = mat4 ( 0.0 ) ;".split(" ")},
{a:"cond",c:[{a:"if",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_NODE_GEOMETRY_VW",{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"dZ = _ ( u_view_tsr_frag ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["USE_ZUP_VIEW_MATRIX"],h:{a:"grp",c:[{a:"txt",b:"d_ = _ ( u_view_zup_tsr ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["USE_ZUP_VIEW_MATRIX_INVERSE"],h:{a:"grp",c:[{a:"txt",b:"ea = _ ( u_view_zup_tsr_inverse ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["USE_ZUP_MODEL_MATRIX"],
h:{a:"grp",c:[{a:"txt",b:"eb = _ ( u_model_zup_tsr ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["USE_ZUP_MODEL_MATRIX_INVERSE"],h:{a:"grp",c:[{a:"txt",b:"ec = _ ( u_model_zup_tsr_inverse ) ;".split(" ")}]}}]},{a:"txt",b:"rs ( dY , dZ , d_ , ea , eb , ec , ed , ee , ef , eg , eh ) ; float bf = eh ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["TEXTURE_COLOR"],h:{a:"grp",c:[{a:"txt",b:"float bf = ( GLSL_TEXTURE ( u_sampler , bQ ) ) . a ;".split(" ")},{a:"cond",c:[{a:"if",e:["TEXTURE_BLEND_TYPE",
"TEXTURE_BLEND_TYPE_MIX",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"float rt = u_alpha_factor * bf ; rt += ( 1.0 - step ( 0.0 , rt ) ) ; bf = mix ( rt , 1.0 , u_diffuse_color . a ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"float bf = u_diffuse_color . a ;".split(" ")}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["ALPHA_CLIP"],h:{a:"grp",c:[{a:"txt",b:"if ( bf < 0.5 ) discard ; bf = 1.0 ;".split(" ")}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["USE_OUTLINE"],h:{a:"grp",c:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , 1.0 , 1.0 , u_outline_intensity ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",c:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( u_color_id , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]};a["color_id.glslv"]={a:"grp",c:[{a:"version",b:["GLSL_VERSION"]},{a:"include",n:"std_enums.glsl"},{a:"include",n:"precision_statement.glslf"},{a:"include",n:"math.glslv"},{a:"include",n:"to_world.glslv"},{a:"include",n:"scale_texcoord.glslv"},{a:"cond",c:[{a:"if",e:["STATIC_BATCH"],h:{a:"grp",c:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",c:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{a:"cond",c:[{a:"if",e:["BILLBOARD","DYNAMIC_GRASS",{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{a:"cond",c:[{a:"if",e:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["SMAA_JITTER"],h:{a:"grp",c:[{a:"txt",b:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},
{a:"cond",c:[{a:"if",e:["USE_NODE_B4W_REFRACTION"],h:{a:"grp",c:[{a:"txt",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["SKINNED"],h:{a:"grp",c:[{a:"txt",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{a:"cond",c:[{a:"if",e:["FRAMES_BLENDING"],h:{a:"grp",c:[{a:"txt",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},
{a:"cond",c:[{a:"if",e:["WIND_BEND"],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["BILLBOARD_JITTERED"],h:{a:"grp",c:[{a:"txt",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{a:"txt",b:"uniform vec3 u_wind ; uniform float u_time ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["VERTEX_ANIM"],h:{a:"grp",c:[{a:"txt",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{a:"cond",c:[{a:"if",e:["TEXTURE_COLOR"],h:{a:"grp",c:[{a:"txt",b:["uniform","vec3","u_texture_scale",";"]}]}}]},
{a:"txt",b:["GLSL_IN","vec3","a_position",";"]},{a:"cond",c:[{a:"if",e:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},"CALC_TBN",{a:"logical_or_expr",i:7}],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec3","a_normal",";"]}]}}]},{a:"cond",c:[{a:"if",e:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["CALC_TBN_SPACE"],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN",
"vec4","a_tangent",";"]}]}}]},{a:"cond",c:[{a:"if",e:["USE_TBN_SHADING"],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec3","a_shade_tangs",";"]}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["SKINNED"],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec4","a_influence",";"]}]}}]},{a:"cond",c:[{a:"if",e:["WIND_BEND"],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["MAIN_BEND_COL"],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","float","a_bending_col_main",";"]},{a:"cond",c:[{a:"if",e:["DETAIL_BEND"],h:{a:"grp",c:[{a:"txt",b:"GLSL_IN vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},
{a:"txt",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{a:"cond",c:[{a:"if",e:["BEND_CENTER_ONLY"],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["WIND_BEND","BILLBOARD",{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{a:"cond",c:[{a:"if",e:["VERTEX_ANIM"],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec3","a_position_next",";"]},{a:"cond",c:[{a:"if",
e:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",i:5}],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec3","a_normal_next",";"]},{a:"cond",c:[{a:"if",e:["CALC_TBN_SPACE"],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec4","a_tangent_next",";"]}]}}]}]}}]}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["TEXTURE_COLOR"],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec2","a_texcoord",
";"]}]}}]},{a:"cond",c:[{a:"if",e:["USE_TBN_SHADING"],h:{a:"grp",c:[{a:"txt",b:["GLSL_OUT","vec3","bR",";"]}]}}]},{a:"cond",c:[{a:"if",e:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"GLSL_OUT vec3 bG ; GLSL_OUT vec4 bH ;".split(" ")},{a:"cond",c:[{a:"if",e:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},{a:"logical_or_expr",i:6}],h:{a:"grp",c:[{a:"txt",
b:["GLSL_OUT","vec3","bI",";"]}]}}]},{a:"cond",c:[{a:"if",e:["CALC_TBN_SPACE"],h:{a:"grp",c:[{a:"txt",b:["GLSL_OUT","vec4","bJ",";"]}]}}]},{a:"cond",c:[{a:"if",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["GLSL_OUT","vec3","bK",";"]}]}}]},{a:"cond",c:[{a:"if",e:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["GLSL_OUT","float","bL",";"]}]}}]}]}},{a:"else",h:{a:"grp",
c:[{a:"cond",c:[{a:"if",e:["TEXTURE_COLOR"],h:{a:"grp",c:[{a:"txt",b:["GLSL_OUT","vec2","bQ",";"]}]}}]}]}}]},{a:"include",n:"skin.glslv"},{a:"include",n:"wind_bending.glslv"},{a:"cond",c:[{a:"if",e:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"include",n:"nodes.glslv"}]}}]},{a:"txt",b:"void main ( ) { mat4 de = _ ( u_view_tsr ) ; vec3 f = a_position ;".split(" ")},{a:"cond",c:[{a:"if",e:["NODES","ALPHA","CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_NORMAL_MAP","USE_NODE_GEOMETRY_NO",
"CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},{a:"logical_or_expr",i:6},{a:"logical_and_expr",i:3}],h:{a:"grp",c:[{a:"txt",b:["vec3","l","=","a_normal",";"]},{a:"cond",c:[{a:"if",e:["CALC_TBN_SPACE"],h:{a:"grp",c:[{a:"txt",b:"vec3 i = vec3 ( a_tangent ) ; vec3 k = a_tangent [ 3 ] * cross ( l , i ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"vec3 i = vec3 ( 0.0 ) ; vec3 k = vec3 ( 0.0 ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"vec3 l = vec3 ( 0.0 ) ; vec3 i = vec3 ( 0.0 ) ; vec3 k = vec3 ( 0.0 ) ;".split(" ")}]}}]},
{a:"txt",b:"mat4 tD = _ ( u_model_tsr ) ;".split(" ")},{a:"cond",c:[{a:"if",e:["USE_TBN_SHADING"],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["CALC_TBN"],h:{a:"grp",c:[{a:"txt",b:"vec3 tE = normalize ( ( tD * vec4 ( a_normal , 0.0 ) ) . xyz ) ; vec3 tF = cross ( vec3 ( 0.0 , 0.0 , 1.0 ) , tE ) ; vec3 tG = cross ( tE , tF ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:["vec3","tG","=","a_shade_tangs",";"]}]}}]}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"vec3 tG = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",
c:[{a:"if",e:["VERTEX_ANIM"],h:{a:"grp",c:[{a:"txt",b:"f = mix ( f , a_position_next , u_va_frame_factor ) ;".split(" ")},{a:"cond",c:[{a:"if",e:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",i:5}],h:{a:"grp",c:[{a:"txt",b:"l = mix ( l , a_normal_next , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["CALC_TBN_SPACE"],
h:{a:"grp",c:[{a:"txt",b:"vec3 tH = vec3 ( a_tangent ) ; vec3 tI = a_tangent_next [ 3 ] * cross ( a_normal_next , tH ) ; i = mix ( i , tH , u_va_frame_factor ) ; k = mix ( k , tI , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["SKINNED"],h:{a:"grp",c:[{a:"txt",b:"sQ ( f , i , k , l ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["WIND_BEND","BILLBOARD",{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["vec3","h","=","au_center_pos",";"]}]}},{a:"else",h:{a:"grp",c:[{a:"txt",
b:"vec3 h = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["BILLBOARD"],h:{a:"grp",c:[{a:"txt",b:"vec3 rJ = ( tD * vec4 ( h , 1.0 ) ) . xyz ;".split(" ")},{a:"cond",c:[{a:"if",e:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"mat4 rR = rS ( u_camera_eye , rJ , de , tD ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"mat4 rR = rQ ( u_camera_eye , rJ , de ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",
e:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"rR = rR * rI ( u_wind , u_time , u_jitter_amp , u_jitter_freq , rJ ) ;".split(" ")}]}}]},{a:"txt",b:"e tJ = rZ ( f - h , h , vec3 ( 0.0 ) , tG , vec3 ( 0.0 ) , vec3 ( 0.0 ) , rR ) ; tJ . h = rJ ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"e tJ = rZ ( f , h , vec3 ( 0.0 ) , tG , vec3 ( 0.0 ) , vec3 ( 0.0 ) , tD ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["WIND_BEND"],h:{a:"grp",c:[{a:"cond",c:[{a:"if",
e:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"ty ( tJ . f , tJ . h , l ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["vec3","tK","=","a_normal",";"]}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"vec3 tK = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"ty ( tJ . f , tJ . h , tK ) ;".split(" ")}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["NODES","ALPHA",{a:"logical_and_expr",i:2},{a:"logic_negative_expr",
i:1}],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["TEXTURE_COLOR"],h:{a:"grp",c:[{a:"txt",b:"bQ = sa ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"bG = tJ . f ;".split(" ")},{a:"cond",c:[{a:"if",e:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},{a:"logical_or_expr",i:6}],h:{a:"grp",
c:[{a:"txt",b:"bI = tJ . l ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["CALC_TBN_SPACE"],h:{a:"grp",c:[{a:"txt",b:"float aU = ( dot ( cross ( tJ . l , tJ . i ) , tJ . k ) < 0.0 ) ? - 1.0 : 1.0 ; bJ = vec4 ( tJ . i , aU ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["USE_TBN_SHADING"],h:{a:"grp",c:[{a:"txt",b:"bR = tJ . j ;".split(" ")}]}}]},{a:"txt",b:"bH = de * vec4 ( tJ . f , 1.0 ) ; vec4 T = u_proj_matrix * bH ;".split(" ")},{a:"cond",c:[{a:"if",e:["SMAA_JITTER"],h:{a:"grp",c:[{a:"txt",b:"T . xy += u_subpixel_jitter * T . w ;".split(" ")}]}}]},
{a:"cond",c:[{a:"if",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"float U = T . x ; float V = T . y ; float W = T . w ; bK . x = ( U + W ) / 2.0 ; bK . y = ( V + W ) / 2.0 ; bK . z = W ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"bL = - bH . z / u_view_max_depth ;".split(" ")}]}}]},{a:"txt",b:["rs","(",")",";"]}]}}]},{a:"txt",
b:"gl_Position = u_proj_matrix * de * vec4 ( tJ . f , 1.0 ) ; }".split(" ")}]};a["debug_view.glslf"]={a:"grp",c:[{a:"version",b:["GLSL_VERSION"]},{a:"define",d:"DV_NONE",b:["0"]},{a:"define",d:"DV_OPAQUE_WIREFRAME",b:["1"]},{a:"define",d:"DV_TRANSPARENT_WIREFRAME",b:["2"]},{a:"define",d:"DV_FRONT_BACK_VIEW",b:["3"]},{a:"define",d:"DV_BOUNDINGS",b:["4"]},{a:"define",d:"DV_CLUSTERS_VIEW",b:["5"]},{a:"define",d:"DV_BATCHES_VIEW",b:["6"]},{a:"define",d:"DV_RENDER_TIME",b:["7"]},{a:"include",n:"precision_statement.glslf"},
{a:"include",n:"color_util.glslf"},{a:"cond",c:[{a:"if",e:["DEBUG_SPHERE",{a:"logic_negative_expr",i:1}],h:{a:"grp",c:[{a:"txt",b:"uniform int u_debug_view_mode ; uniform float u_cluster_id ; uniform float u_batch_debug_id_color ; uniform float u_batch_debug_main_render_time ; uniform float u_debug_colors_seed ; uniform float u_debug_render_time_threshold ; uniform vec3 u_wireframe_edge_color ;".split(" ")}]}}]},{a:"txt",b:"GLSL_IN vec3 tL ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; const float tM = 1.0 ;".split(" ")},
{a:"cond",c:[{a:"if",e:["DEBUG_SPHERE"],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["DEBUG_SPHERE_DYNAMIC"],h:{a:"grp",c:[{a:"txt",b:"const vec3 tN = vec3 ( 1.0 , 0.05 , 0.05 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"const vec3 tN = vec3 ( 0.05 , 0.05 , 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"const vec3 tO = vec3 ( 0.4 , 0.4 , 1.0 ) ; const vec3 tP = vec3 ( 1.0 , 0.4 , 0.4 ) ; const vec3 tQ = vec3 ( 1.0 , 1.0 , 1.0 ) ; const vec3 tR = vec3 ( 0.0 , 133.0 / 255.0 , 66.0 / 255.0 ) ; const vec3 tS = vec3 ( 160.0 / 255.0 , 38.0 / 255.0 , 33.0 / 255.0 ) ;".split(" ")}]}}]},
{a:"cond",c:[{a:"if",e:["DEBUG_SPHERE",{a:"logic_negative_expr",i:1}],h:{a:"grp",c:[{a:"txt",b:"float tV ( ) { float cz = 1.0 ;".split(" ")},{a:"cond",c:[{a:"if",e:["WIREFRAME_QUALITY",0,{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"vec3 m_ = sign ( tL - vec3 ( 0.02 * tM ) ) ; if ( m_ . x < 0.0 || m_ . y < 0.0 || m_ . z < 0.0 ) cz = 0.0 ;".split(" ")}]}},{a:"elif",e:["WIREFRAME_QUALITY",1,{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["GLSL1"],h:{a:"grp",c:[{a:"extension",b:["GL_OES_standard_derivatives",
":","enable"]}]}}]},{a:"txt",b:"vec3 tT = fwidth ( tL ) ; vec3 tU = smoothstep ( vec3 ( 0.0 ) , tT * tM , tL ) ; cz = min ( min ( tU . x , tU . y ) , tU . z ) ; cz = clamp ( cz , 0.0 , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["return","cz",";","}"]}]}}]},{a:"txt",b:"void main ( ) { vec3 m = vec3 ( 0.0 ) ; float bf = 0.0 ;".split(" ")},{a:"cond",c:[{a:"if",e:["DEBUG_SPHERE"],h:{a:"grp",c:[{a:"txt",b:"vec3 m_ = sign ( tL - vec3 ( 0.02 * tM ) ) ; if ( m_ . x < 0.0 || m_ . y < 0.0 || m_ . z < 0.0 ) { m = tN ; bf = 1.0 ; } else discard ;".split(" ")}]}},
{a:"else",h:{a:"grp",c:[{a:"txt",b:"if ( u_debug_view_mode == DV_OPAQUE_WIREFRAME ) { float cz = tV ( ) ; m = vec3 ( mix ( u_wireframe_edge_color , tQ , cz ) ) ; bf = 1.0 ; } else if ( u_debug_view_mode == DV_TRANSPARENT_WIREFRAME ) { float cz = tV ( ) ; m = u_wireframe_edge_color ; bf = mix ( 1.0 , 0.0 , cz ) ; } else if ( u_debug_view_mode == DV_FRONT_BACK_VIEW ) { float cz = tV ( ) ; if ( gl_FrontFacing ) m = mix ( u_wireframe_edge_color , tO , cz ) ; else m = mix ( u_wireframe_edge_color , tP , cz ) ; bf = 1.0 ; } else if ( u_debug_view_mode == DV_CLUSTERS_VIEW ) { float tW = u_cluster_id + u_debug_colors_seed + 2.0 ; m = vec3 ( fract ( tW * 19.73 ) , fract ( tW * 6.34 ) , fract ( tW * 1.56 ) ) ; bf = 1.0 ; } else if ( u_debug_view_mode == DV_BATCHES_VIEW ) { float tW = u_batch_debug_id_color + u_debug_colors_seed ; m = vec3 ( fract ( tW * 19.73 ) , fract ( tW * 6.34 ) , fract ( tW * 1.56 ) ) ; bf = 1.0 ; } else if ( u_debug_view_mode == DV_RENDER_TIME ) { float tX ; if ( u_debug_render_time_threshold > 0.0 ) tX = clamp ( u_batch_debug_main_render_time , 0.0 , u_debug_render_time_threshold ) / u_debug_render_time_threshold ; else tX = 1.0 ; float tY = clamp ( 2.0 * tX , 0.0 , 1.0 ) ; float tZ = clamp ( 2.0 * tX - 1.0 , 0.0 , 1.0 ) ; float t_ = tX ; m = mix ( tR , tS , vec3 ( tY , tZ , t_ ) ) ; bf = 1.0 ; }".split(" ")}]}}]},
{a:"txt",b:["be","(","m",")",";"]},{a:"cond",c:[{a:"if",e:["ALPHA"],h:{a:"grp",c:[{a:"txt",b:"bh ( m , bf ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( m , bf ) ; }".split(" ")}]};a["debug_view.glslv"]={a:"grp",c:[{a:"version",b:["GLSL_VERSION"]},{a:"include",n:"math.glslv"},{a:"include",n:"to_world.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec3 a_normal ; GLSL_IN float a_polyindex ;".split(" ")},{a:"cond",c:[{a:"if",e:["USE_INSTANCED_PARTCLS"],h:{a:"grp",c:[{a:"txt",
b:"GLSL_IN vec4 a_part_ts ; GLSL_IN vec4 a_part_r ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["DEBUG_SPHERE",{a:"logic_negative_expr",i:1}],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["WIND_BEND"],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["MAIN_BEND_COL"],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","float","a_bending_col_main",";"]},{a:"cond",c:[{a:"if",e:["DETAIL_BEND"],h:{a:"grp",c:[{a:"txt",b:"GLSL_IN vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},
{a:"txt",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{a:"cond",c:[{a:"if",e:["BEND_CENTER_ONLY"],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{a:"cond",c:[{a:"if",e:["VERTEX_ANIM"],
h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec3","a_position_next",";"]}]}}]},{a:"cond",c:[{a:"if",e:["SKINNED"],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec4","a_influence",";"]}]}}]}]}}]},{a:"txt",b:["GLSL_OUT","vec3","tL",";"]},{a:"cond",c:[{a:"if",e:["STATIC_BATCH"],h:{a:"grp",c:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},
{a:"cond",c:[{a:"if",e:["DEBUG_SPHERE",{a:"logic_negative_expr",i:1}],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["WIND_BEND"],h:{a:"grp",c:[{a:"txt",b:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")},{a:"cond",c:[{a:"if",e:["BILLBOARD","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",
b:["uniform","vec3","u_camera_eye",";"]}]}}]},{a:"cond",c:[{a:"if",e:["VERTEX_ANIM"],h:{a:"grp",c:[{a:"txt",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{a:"cond",c:[{a:"if",e:["SKINNED"],h:{a:"grp",c:[{a:"txt",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},{a:"cond",c:[{a:"if",e:["FRAMES_BLENDING"],h:{a:"grp",c:[{a:"txt",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},
{a:"cond",c:[{a:"if",e:["DYNAMIC_GRASS"],h:{a:"grp",c:[{a:"txt",b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["DEBUG_SPHERE",{a:"logic_negative_expr",i:1}],h:{a:"grp",c:[{a:"include",n:"skin.glslv"},{a:"include",n:"wind_bending.glslv"},{a:"include",n:"dynamic_grass.glslv"}]}}]},{a:"txt",
b:"void main ( ) { if ( a_polyindex == 0.0 ) tL = vec3 ( 1.0 , 0.0 , 0.0 ) ; else if ( a_polyindex == 1.0 ) tL = vec3 ( 0.0 , 1.0 , 0.0 ) ; else if ( a_polyindex == 2.0 ) tL = vec3 ( 0.0 , 0.0 , 1.0 ) ;".split(" ")},{a:"cond",c:[{a:"if",e:["DEBUG_VIEW_SPECIAL_SKYDOME"],h:{a:"grp",c:[{a:"txt",b:"gl_Position = vec4 ( a_position . xy , 0.9999999 , 1.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["USE_INSTANCED_PARTCLS"],h:{a:"grp",c:[{a:"txt",b:"mat3 uz = mat3 ( a_part_ts [ 0 ] , a_part_ts [ 1 ] , a_part_ts [ 2 ] , a_part_ts [ 3 ] , a_part_r [ 0 ] , a_part_r [ 1 ] , a_part_r [ 2 ] , a_part_r [ 3 ] , 1.0 ) ;".split(" ")},
{a:"cond",c:[{a:"if",e:["STATIC_BATCH"],h:{a:"grp",c:[{a:"txt",b:"mat4 tD = _ ( uz ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"mat4 tD = _ ( ad ( u_model_tsr , uz ) ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"mat4 tD = _ ( u_model_tsr ) ;".split(" ")}]}}]},{a:"txt",b:"mat4 de = _ ( u_view_tsr ) ; vec3 f = a_position ; vec3 l = a_normal ;".split(" ")},{a:"cond",c:[{a:"if",e:["DEBUG_SPHERE"],h:{a:"grp",c:[{a:"txt",b:"e tJ = rZ ( f , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , tD ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["VERTEX_ANIM"],h:{a:"grp",c:[{a:"txt",b:"f = mix ( f , a_position_next , u_va_frame_factor ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["SKINNED"],h:{a:"grp",c:[{a:"txt",b:"vec3 i = vec3 ( 0.0 ) ; vec3 k = vec3 ( 0.0 ) ; sQ ( f , i , k , l ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",
b:["vec3","h","=","au_center_pos",";"]}]}},{a:"elif",e:["DYNAMIC_GRASS","USE_INSTANCED_PARTCLS",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"vec3 h = a_part_ts . xyz ; f = ( tD * vec4 ( f , 1.0 ) ) . xyz ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"vec3 h = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["DYNAMIC_GRASS"],h:{a:"grp",c:[{a:"txt",b:"e tJ = uy ( f , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , h , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , de ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["BILLBOARD"],h:{a:"grp",c:[{a:"txt",b:"vec3 rJ = ( tD * vec4 ( h , 1.0 ) ) . xyz ;".split(" ")},{a:"cond",c:[{a:"if",e:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2},"USE_INSTANCED_PARTCLS",{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"mat4 rR = rS ( u_camera_eye , rJ , de , tD ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"mat4 rR = rQ ( u_camera_eye , rJ , de ) ;".split(" ")}]}}]},
{a:"cond",c:[{a:"if",e:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"vec3 rE = ( tD * vec4 ( h , 1.0 ) ) . xyz ; rR = rR * rI ( u_wind , u_time , u_jitter_amp , u_jitter_freq , rE ) ;".split(" ")}]}}]},{a:"txt",b:"e tJ = rZ ( f - h , h , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , rR ) ; tJ . h = rJ ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"e tJ = rZ ( f , h , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , tD ) ;".split(" ")}]}}]}]}}]},
{a:"cond",c:[{a:"if",e:["WIND_BEND"],h:{a:"grp",c:[{a:"txt",b:"ty ( tJ . f , tJ . h , l ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:"gl_Position = u_proj_matrix * de * vec4 ( tJ . f , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]};a["error.glslf"]={a:"grp",c:[{a:"version",b:["GLSL_VERSION"]},{a:"include",n:"precision_statement.glslf"},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , 0.0 , 1.0 , 1.0 ) ; }".split(" ")}]};a["error.glslv"]={a:"grp",c:[{a:"version",
b:["GLSL_VERSION"]},{a:"include",n:"precision_statement.glslf"},{a:"include",n:"std_enums.glsl"},{a:"include",n:"math.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; void main ( ) { gl_Position = u_proj_matrix * _ ( u_view_tsr ) * vec4 ( a_position , 1.0 ) ; }".split(" ")}]};a["grass_map.glslf"]={a:"grp",c:[{a:"version",b:["GLSL_VERSION"]},{a:"include",n:"precision_statement.glslf"},{a:"cond",c:[{a:"if",e:["DYNAMIC_GRASS_SIZE"],h:{a:"grp",c:[{a:"cond",
c:[{a:"if",e:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec4","uA",";"]}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","float","uA",";"]}]}}]}]}},{a:"else",h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec3","uA",";"]}]}}]}]}}]},{a:"txt",b:"GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) {".split(" ")},{a:"cond",c:[{a:"if",e:["DYNAMIC_GRASS_SIZE"],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",c:[{a:"txt",
b:["GLSL_OUT_FRAG_COLOR","=","uA",";"]}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( uA , vec3 ( 1.0 ) ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",c:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , uA ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:["}"]}]};a["grass_map.glslv"]={a:"grp",c:[{a:"version",b:["GLSL_VERSION"]},{a:"include",
n:"math.glslv"},{a:"include",n:"to_world.glslv"},{a:"txt",b:["GLSL_IN","vec3","a_position",";"]},{a:"cond",c:[{a:"if",e:["DYNAMIC_GRASS_SIZE"],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","float","a_grass_size",";"]}]}}]},{a:"cond",c:[{a:"if",e:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec3","a_grass_color",";"]}]}}]},{a:"cond",c:[{a:"if",e:["DYNAMIC_GRASS_SIZE"],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",c:[{a:"txt",b:["GLSL_OUT","vec4","uA",";"]}]}},{a:"else",
h:{a:"grp",c:[{a:"txt",b:["GLSL_OUT","float","uA",";"]}]}}]}]}},{a:"else",h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",c:[{a:"txt",b:["GLSL_OUT","vec3","uA",";"]}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["STATIC_BATCH"],h:{a:"grp",c:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},
{a:"cond",c:[{a:"if",e:["BILLBOARD"],h:{a:"grp",c:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{a:"cond",c:[{a:"if",e:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"uniform vec3 u_wind ; uniform float u_time ; uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{a:"txt",b:"void main ( ) { mat4 de = _ ( u_view_tsr ) ; mat4 tD = _ ( u_model_tsr ) ;".split(" ")},{a:"cond",c:[{a:"if",e:["BILLBOARD"],h:{a:"grp",c:[{a:"txt",b:"vec3 rJ = ( tD * vec4 ( vec3 ( 0.0 ) , 1.0 ) ) . xyz ; mat4 rR = rQ ( u_camera_eye , rJ , de ) ;".split(" ")},
{a:"cond",c:[{a:"if",e:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"rR = rR * rI ( u_wind , u_time , u_jitter_amp , u_jitter_freq , vec3 ( 0.0 ) ) ;".split(" ")}]}}]},{a:"txt",b:"e tJ = rZ ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , rR ) ; tJ . h = rJ ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"e tJ = rZ ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , tD ) ;".split(" ")}]}}]},
{a:"txt",b:"vec4 T = u_proj_matrix * de * vec4 ( tJ . f , 1.0 ) ;".split(" ")},{a:"cond",c:[{a:"if",e:["DYNAMIC_GRASS_SIZE"],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",c:[{a:"txt",b:"uA = vec4 ( a_grass_size , a_grass_color ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:["uA","=","a_grass_size",";"]}]}}]}]}},{a:"else",h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["DYNAMIC_GRASS_COLOR"],h:{a:"grp",c:[{a:"txt",b:["uA","=","a_grass_color",";"]}]}}]}]}}]},{a:"txt",b:["gl_Position",
"=","T",";","}"]}]};a["halo.glslf"]={a:"grp",c:[{a:"version",b:["GLSL_VERSION"]},{a:"include",n:"precision_statement.glslf"},{a:"txt",b:"uniform vec4 u_diffuse_color ; uniform vec3 u_halo_rings_color ; uniform vec3 u_halo_lines_color ; uniform float u_halo_hardness ; uniform float u_halo_size ;".split(" ")},{a:"cond",c:[{a:"if",e:["SKY_STARS"],h:{a:"grp",c:[{a:"txt",b:["uniform","vec3","u_sun_intensity",";"]},{a:"cond",c:[{a:"if",e:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",
i:2}],h:{a:"grp",c:[{a:"txt",b:"uniform float u_halo_stars_blend ; uniform float u_halo_stars_height ; uniform float u_cam_water_depth ;".split(" ")}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["SKY_STARS","WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:3}],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec4","uB",";"]}]}}]},{a:"txt",b:"GLSL_IN vec2 bQ ; GLSL_IN float uC ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"include",n:"color_util.glslf"},{a:"include",n:"halo_color.glslf"},
{a:"txt",b:"void main ( ) { vec4 uY = uX ( ) ; vec3 m = uY . rgb ; float m_ = uY . a ; be ( m ) ; bh ( m , m_ ) ; GLSL_OUT_FRAG_COLOR = vec4 ( m , m_ ) ; }".split(" ")}]};a["halo.glslv"]={a:"grp",c:[{a:"version",b:["GLSL_VERSION"]},{a:"include",n:"math.glslv"},{a:"include",n:"to_world.glslv"},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform PRECISION float u_halo_size ;".split(" ")},{a:"cond",c:[{a:"if",e:["STATIC_BATCH"],h:{a:"grp",c:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",c:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec2 a_halo_bb_vertex ; GLSL_IN float a_random_vals ; GLSL_OUT vec2 bQ ; GLSL_OUT float uC ;".split(" ")},{a:"cond",c:[{a:"if",e:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["GLSL_OUT","vec4","uB",";"]}]}}]},{a:"txt",b:"void main ( ) { mat4 de = _ ( u_view_tsr ) ; mat4 rR = _ ( u_model_tsr ) ; vec3 f = ( rR * vec4 ( a_position , 1.0 ) ) . xyz ; bQ = a_halo_bb_vertex * 2.0 ; uC = a_random_vals ;".split(" ")},
{a:"cond",c:[{a:"if",e:["SKY_STARS"],h:{a:"grp",c:[{a:"txt",b:"mat4 uZ = rw ( f , de ) ; mat4 u_ = de ; u_ [ 3 ] [ 0 ] = 0.0 ; u_ [ 3 ] [ 1 ] = 0.0 ; u_ [ 3 ] [ 2 ] = 0.0 ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"mat4 uZ = rw ( f , de ) ;".split(" ")}]}}]},{a:"txt",b:"vec4 va = vec4 ( a_halo_bb_vertex * 2.0 * u_halo_size , 0.0 , 1.0 ) ; vec4 bs = uZ * va ;".split(" ")},{a:"cond",c:[{a:"if",e:["SKY_STARS"],h:{a:"grp",c:[{a:"txt",b:"vec4 T = u_proj_matrix * u_ * bs ; T . z = 0.99999 * T . w ;".split(" ")},
{a:"cond",c:[{a:"if",e:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uB","=","bs",";"]}]}}]}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"vec4 T = u_proj_matrix * de * bs ;".split(" ")}]}}]},{a:"txt",b:["gl_Position","=","T",";","}"]}]};a["line.glslf"]={a:"grp",c:[{a:"version",b:["GLSL_VERSION"]},{a:"include",n:"precision_statement.glslf"},{a:"include",n:"color_util.glslf"},{a:"txt",b:"uniform vec4 u_diffuse_color ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec3 m = u_diffuse_color . xyz ; float bf = u_diffuse_color . a ; be ( m ) ;".split(" ")},
{a:"cond",c:[{a:"if",e:["ALPHA"],h:{a:"grp",c:[{a:"txt",b:"bh ( m , bf ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( m , bf ) ; }".split(" ")}]};a["line.glslv"]={a:"grp",c:[{a:"version",b:["GLSL_VERSION"]},{a:"define",d:"M_PI",b:["3.14159265359"]},{a:"include",n:"math.glslv"},{a:"include",n:"to_world.glslv"},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec3 a_direction ; uniform mat3 u_model_tsr ; uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform float u_height ; uniform float u_line_width ; void main ( ) { mat4 de = _ ( u_view_tsr ) ; mat4 tD = _ ( u_model_tsr ) ; e tJ = rZ ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , normalize ( a_direction ) , tD ) ; vec4 vb = u_proj_matrix * de * vec4 ( tJ . f , 1.0 ) ; vb . xyz /= vb . w ; vec2 vc = ( u_proj_matrix * de * vec4 ( tJ . l , 0.0 ) ) . xy ; float O = M_PI / 2.0 ; mat2 vd = mat2 ( cos ( O ) , sin ( O ) , - sin ( O ) , cos ( O ) ) ; vc = vd * normalize ( vc ) ; vec2 ve = ( u_line_width / u_height ) * vec2 ( u_proj_matrix [ 0 ] [ 0 ] / u_proj_matrix [ 1 ] [ 1 ] , 1.0 ) ; gl_Position = vec4 ( vb . xy + vc . xy * ve / 2.0 , vb . z , 1.0 ) ; gl_Position *= vb . w ; }".split(" ")}]};
a["main.glslf"]={a:"grp",c:[{a:"version",b:["GLSL_VERSION"]},{a:"include",n:"std_enums.glsl"},{a:"include",n:"precision_statement.glslf"},{a:"include",n:"pack.glslf"},{a:"include",n:"color_util.glslf"},{a:"include",n:"math.glslv"},{a:"cond",c:[{a:"if",e:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",c:[{a:"include",n:"procedural.glslf"},{a:"cond",c:[{a:"if",e:["CAUSTICS"],h:{a:"grp",c:[{a:"include",n:"caustics.glslf"}]}}]}]}}]},{a:"txt",b:["uniform","float","u_time",";"]},{a:"cond",c:[{a:"if",
e:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",e:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"txt",b:["uniform","float","u_environment_energy",";"]},{a:"cond",c:[{a:"if",e:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["NUM_LIGHTS",
0,{a:"g_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["CAUSTICS"],h:{a:"grp",c:[{a:"txt",b:"uniform vec4 u_sun_quaternion ; uniform vec3 u_sun_intensity ; uniform vec3 u_sun_direction ;".split(" ")}]}}]}]}}]},{a:"txt",b:["uniform","vec3","u_camera_eye_frag",";"]},{a:"cond",
c:[{a:"if",e:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_NODE_GEOMETRY_VW",{a:"logical_or_expr",i:3}],h:{a:"grp",c:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{a:"cond",c:[{a:"if",e:["USE_ZUP_VIEW_MATRIX"],h:{a:"grp",c:[{a:"txt",b:["uniform","mat3","u_view_zup_tsr",";"]}]}}]},{a:"cond",c:[{a:"if",e:["USE_ZUP_VIEW_MATRIX_INVERSE"],h:{a:"grp",c:[{a:"txt",b:["uniform","mat3","u_view_zup_tsr_inverse",";"]}]}}]},{a:"cond",c:[{a:"if",e:["USE_ZUP_MODEL_MATRIX"],
h:{a:"grp",c:[{a:"txt",b:["uniform","mat3","u_model_zup_tsr",";"]}]}}]},{a:"cond",c:[{a:"if",e:["USE_ZUP_MODEL_MATRIX_INVERSE"],h:{a:"grp",c:[{a:"txt",b:["uniform","mat3","u_model_zup_tsr_inverse",";"]}]}}]},{a:"cond",c:[{a:"if",e:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",c:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",c:[{a:"if",e:["WATER_EFFECTS"],h:{a:"grp",c:[{a:"txt",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},
{a:"cond",c:[{a:"if",e:["PROCEDURAL_FOG"],h:{a:"grp",c:[{a:"txt",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{a:"cond",c:[{a:"if",e:["USE_FOG"],h:{a:"grp",c:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","sampler2D","u_plane_reflection",";"]}]}},{a:"elif",e:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","samplerCube","u_cube_reflection",
";"]}]}},{a:"elif",e:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"cond",c:[{a:"if",e:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","sampler2D","u_shadow_mask",";"]}]}},{a:"elif",e:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"uniform vec4 u_pcf_blur_radii ; uniform vec4 u_csm_center_dists ; uniform PRECISION sampler2D u_shadow_map0 ;".split(" ")},
{a:"cond",c:[{a:"if",e:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_shadow_map1",";"]}]}}]},{a:"cond",c:[{a:"if",e:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_shadow_map2",";"]}]}}]},{a:"cond",c:[{a:"if",e:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",
b:["uniform","PRECISION","sampler2D","u_shadow_map3",";"]}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","sampler2D","u_refractmap",";"]}]}}]},{a:"cond",c:[{a:"if",e:["USE_NODE_B4W_REFRACTION","USE_REFRACTION","REFRACTIVE","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",i:4}],h:{a:"grp",c:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ;".split(" ")},
{a:"cond",c:[{a:"if",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",c:[]}},{a:"elif",e:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}}]},{a:"cond",c:[{a:"if",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{a:"cond",c:[{a:"if",e:["USE_NODE_LAMP"],
h:{a:"grp",c:[{a:"txt",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ; uniform vec4 u_lamp_light_factors [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["USE_NODE_VALUE"],h:{a:"grp",c:[{a:"txt",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["USE_NODE_RGB"],h:{a:"grp",c:[{a:"txt",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]},
{a:"cond",c:[{a:"if",e:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{a:"logical_or_expr",i:3}],h:{a:"grp",c:[{a:"txt",b:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{a:"txt",b:["GLSL_IN","vec3","bG",";"]},{a:"cond",c:[{a:"if",e:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},"USE_NODE_TEX_COORD_NO",{a:"logical_or_expr",i:7}],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN",
"vec3","bI",";"]}]}}]},{a:"cond",c:[{a:"if",e:["NODES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","PARALLAX",{a:"logical_and_expr",i:2},"SHADELESS",{a:"logic_negative_expr",i:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",i:3},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:6}],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec4","bH",";"]}]}}]},{a:"cond",c:[{a:"if",e:["TEXTURE_NORM_CO","CALC_TBN_SPACE",
{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec4","bJ",";"]}]}}]},{a:"cond",c:[{a:"if",e:["USE_TBN_SHADING"],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec3","bR",";"]}]}}]},{a:"cond",c:[{a:"if",e:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec4","bM",";"]},{a:"cond",c:[{a:"if",e:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec4","bN",";"]}]}}]},{a:"cond",c:[{a:"if",
e:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec4","bO",";"]}]}}]},{a:"cond",c:[{a:"if",e:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec4","bP",";"]}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2},"REFRACTIVE","USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",
i:4}],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec3","bK",";"]}]}}]},{a:"cond",c:[{a:"if",e:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","float","bL",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"include",n:"mirror.glslf"},{a:"include",n:"environment.glslf"},{a:"cond",c:[{a:"if",e:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",c:[{a:"include",n:"shadow.glslf"}]}}]},{a:"cond",c:[{a:"if",e:["USE_NODE_B4W_REFRACTION",
"USE_REFRACTION",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"include",n:"refraction.glslf"}]}}]},{a:"include",n:"nodes.glslf"},{a:"cond",c:[{a:"if",e:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",c:[{a:"include",n:"fog.glslf"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",c:[{a:"if",e:["NODES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","PARALLAX",{a:"logical_and_expr",i:2},"SHADELESS",{a:"logic_negative_expr",i:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",
i:3},{a:"logical_or_expr",i:4}],h:{a:"grp",c:[{a:"txt",b:"float bt = length ( bH ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["WATER_EFFECTS"],h:{a:"grp",c:[{a:"txt",b:"float vz = bG . y - WATER_LEVEL ;".split(" ")}]}}]},{a:"txt",b:"vec3 cW = normalize ( u_camera_eye_frag - bG ) ; vec3 ed ; vec3 ee ; vec3 ef ; vec4 eg ; float eh ; mat4 dZ = mat4 ( 0.0 ) ; mat4 d_ = mat4 ( 0.0 ) ; mat4 ea = mat4 ( 0.0 ) ; mat4 eb = mat4 ( 0.0 ) ; mat4 ec = mat4 ( 0.0 ) ;".split(" ")},{a:"cond",c:[{a:"if",e:["REFLECTION_TYPE",
"REFL_PLANE",{a:"equal_expr",i:2},"USE_NODE_GEOMETRY_VW",{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"dZ = _ ( u_view_tsr_frag ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["USE_ZUP_VIEW_MATRIX"],h:{a:"grp",c:[{a:"txt",b:"d_ = _ ( u_view_zup_tsr ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["USE_ZUP_VIEW_MATRIX_INVERSE"],h:{a:"grp",c:[{a:"txt",b:"ea = _ ( u_view_zup_tsr_inverse ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["USE_ZUP_MODEL_MATRIX"],h:{a:"grp",c:[{a:"txt",b:"eb = _ ( u_model_zup_tsr ) ;".split(" ")}]}}]},
{a:"cond",c:[{a:"if",e:["USE_ZUP_MODEL_MATRIX_INVERSE"],h:{a:"grp",c:[{a:"txt",b:"ec = _ ( u_model_zup_tsr_inverse ) ;".split(" ")}]}}]},{a:"txt",b:"rs ( cW , dZ , d_ , ea , eb , ec , ed , ee , ef , eg , eh ) ; vec3 m = ed ; float bf = eh ; vec3 l = ef ; vec4 bn = eg ;".split(" ")},{a:"cond",c:[{a:"if",e:["SHADELESS",{a:"logic_negative_expr",i:1},"WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["WETTABLE"],h:{a:"grp",c:[{a:"txt",b:"m = max ( m - sqrt ( 0.01 * - min ( vz , 0.0 ) ) , 0.5 * m ) ;".split(" ")}]}}]},
{a:"cond",c:[{a:"if",e:["CAUSTICS"],h:{a:"grp",c:[{a:"txt",b:"bF ( m , vz , u_time , bn , l , u_sun_direction , u_sun_intensity , u_sun_quaternion , bG , bt ) ;".split(" ")}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["ALPHA"],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["ALPHA_CLIP"],h:{a:"grp",c:[{a:"txt",b:"if ( bf < 0.5 ) discard ; bf = 1.0 ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:["bf","=","1.0",";"]}]}}]},{a:"cond",c:[{a:"if",e:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",c:[{a:"cond",
c:[{a:"if",e:["WATER_EFFECTS"],h:{a:"grp",c:[{a:"txt",b:"vA ( m , bt , cW , vz ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"vA ( m , bt , cW , 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["SSAO_ONLY","SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"vec2 co = GLSL_TEXTURE_PROJ ( u_shadow_mask , bK ) . rg ; float vB = co . g ; m = vec3 ( vB ) ;".split(" ")}]}}]},{a:"txt",b:["be","(","m",")",";"]},{a:"cond",c:[{a:"if",
e:["ALPHA","ALPHA_CLIP",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"bh ( m , bf ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( m , bf ) ; }".split(" ")}]};a["main.glslv"]={a:"grp",c:[{a:"version",b:["GLSL_VERSION"]},{a:"include",n:"std_enums.glsl"},{a:"include",n:"math.glslv"},{a:"include",n:"to_world.glslv"},{a:"include",n:"scale_texcoord.glslv"},{a:"txt",b:["GLSL_IN","vec3","a_position",";"]},{a:"cond",c:[{a:"if",e:["NODES",{a:"logic_negative_expr",
i:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},"USE_NODE_TEX_COORD_NO","CALC_TBN",{a:"logical_or_expr",i:9}],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec3","a_normal",";"]}]}}]},{a:"cond",c:[{a:"if",e:["USE_INSTANCED_PARTCLS"],h:{a:"grp",c:[{a:"txt",b:"GLSL_IN vec4 a_part_ts ; GLSL_IN vec4 a_part_r ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["TEXTURE_NORM_CO","CALC_TBN_SPACE",
{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec4","a_tangent",";"]}]}}]},{a:"cond",c:[{a:"if",e:["USE_TBN_SHADING"],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec3","a_shade_tangs",";"]}]}}]},{a:"cond",c:[{a:"if",e:["SKINNED"],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec4","a_influence",";"]}]}}]},{a:"cond",c:[{a:"if",e:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",
b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{a:"cond",c:[{a:"if",e:["WIND_BEND"],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["MAIN_BEND_COL"],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","float","a_bending_col_main",";"]},{a:"cond",c:[{a:"if",e:["DETAIL_BEND"],h:{a:"grp",c:[{a:"txt",b:"GLSL_IN vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},{a:"txt",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},
{a:"cond",c:[{a:"if",e:["BEND_CENTER_ONLY"],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["VERTEX_ANIM"],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec3","a_position_next",";"]},{a:"cond",c:[{a:"if",e:["NODES",{a:"logic_negative_expr",i:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO",{a:"logical_or_expr",i:7}],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec3","a_normal_next",";"]},
{a:"cond",c:[{a:"if",e:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec4","a_tangent_next",";"]}]}}]}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["NODES",{a:"logic_negative_expr",i:1}],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["TEXCOORD"],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{a:"cond",c:[{a:"if",e:["VERTEX_COLOR"],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec3","a_color",";"]}]}}]}]}}]},{a:"txt",b:["GLSL_OUT","vec3","bG",";"]},{a:"cond",
c:[{a:"if",e:["NODES",{a:"logic_negative_expr",i:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},"USE_NODE_TEX_COORD_NO",{a:"logical_or_expr",i:8}],h:{a:"grp",c:[{a:"txt",b:["GLSL_OUT","vec3","bI",";"]}]}}]},{a:"cond",c:[{a:"if",e:["NODES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","PARALLAX",{a:"logical_and_expr",i:2},"WATER_EFFECTS","CAUSTICS",{a:"logical_and_expr",
i:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:6}],h:{a:"grp",c:[{a:"txt",b:["GLSL_OUT","vec4","bH",";"]}]}}]},{a:"cond",c:[{a:"if",e:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["GLSL_OUT","vec4","bJ",";"]}]}}]},{a:"cond",c:[{a:"if",e:["NODES",{a:"logic_negative_expr",i:1}],h:{a:"grp",c:[{a:"txt",b:["GLSL_OUT","vec3","vC",";"]},{a:"cond",c:[{a:"if",e:["TEXCOORD"],
h:{a:"grp",c:[{a:"txt",b:["GLSL_OUT","vec2","bQ",";"]}]}}]},{a:"cond",c:[{a:"if",e:["VERTEX_COLOR","DYNAMIC_GRASS",{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["GLSL_OUT","vec3","vD",";"]}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["GLSL_OUT","vec4","bM",";"]},{a:"cond",c:[{a:"if",e:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["GLSL_OUT","vec4","bN",";"]}]}}]},
{a:"cond",c:[{a:"if",e:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["GLSL_OUT","vec4","bO",";"]}]}}]},{a:"cond",c:[{a:"if",e:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["GLSL_OUT","vec4","bP",";"]}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2},"REFRACTIVE","USE_NODE_B4W_REFRACTION",
{a:"logical_or_expr",i:4}],h:{a:"grp",c:[{a:"txt",b:["GLSL_OUT","vec3","bK",";"]}]}}]},{a:"cond",c:[{a:"if",e:["REFRACTIVE","NODES",{a:"logic_negative_expr",i:1},"USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["GLSL_OUT","float","bL",";"]}]}}]},{a:"cond",c:[{a:"if",e:["USE_TBN_SHADING"],h:{a:"grp",c:[{a:"txt",b:["GLSL_OUT","vec3","bR",";"]}]}}]},{a:"cond",c:[{a:"if",e:["STATIC_BATCH"],h:{a:"grp",c:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",c:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",c:[{a:"if",e:["REFLECTION_PASS"],h:{a:"grp",c:[{a:"txt",b:"uniform mat4 u_view_matrix ; uniform mat3 u_view_tsr ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:["uniform","mat3","u_view_tsr",";"]}]}}]},{a:"txt",b:["uniform","mat4","u_proj_matrix",";"]},{a:"cond",c:[{a:"if",e:["NODES",{a:"logic_negative_expr",i:1},"BILLBOARD","DYNAMIC_GRASS",{a:"logical_or_expr",i:3}],h:{a:"grp",c:[{a:"txt",b:["uniform","vec3",
"u_camera_eye",";"]}]}}]},{a:"cond",c:[{a:"if",e:["SMAA_JITTER"],h:{a:"grp",c:[{a:"txt",b:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{a:"cond",c:[{a:"if",e:["DYNAMIC_GRASS"],h:{a:"grp",c:[{a:"txt",b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["SKINNED"],h:{a:"grp",c:[{a:"txt",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},
{a:"cond",c:[{a:"if",e:["FRAMES_BLENDING"],h:{a:"grp",c:[{a:"txt",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["WIND_BEND"],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["BILLBOARD_JITTERED"],h:{a:"grp",c:[{a:"txt",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{a:"txt",b:"uniform vec3 u_wind ; uniform PRECISION float u_time ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",
e:["VERTEX_ANIM"],h:{a:"grp",c:[{a:"txt",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{a:"cond",c:[{a:"if",e:["NODES",{a:"logic_negative_expr",i:1}],h:{a:"grp",c:[{a:"txt",b:["uniform","vec3","u_texture_scale",";"]}]}}]},{a:"cond",c:[{a:"if",e:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","float","u_normal_offset",";"]},{a:"cond",c:[{a:"if",e:["MAC_OS_SHADOW_HACK"],h:{a:"grp",c:[{a:"txt",b:"uniform mat3 u_v_light_tsr [ NUM_CAST_LAMPS ] ;".split(" ")}]}},
{a:"else",h:{a:"grp",c:[{a:"txt",b:"uniform vec4 u_v_light_ts [ NUM_CAST_LAMPS ] ; uniform vec4 u_v_light_r [ NUM_CAST_LAMPS ] ;".split(" ")}]}}]},{a:"txt",b:["uniform","mat4","u_p_light_matrix0",";"]},{a:"cond",c:[{a:"if",e:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","mat4","u_p_light_matrix1",";"]}]}}]},{a:"cond",c:[{a:"if",e:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",
b:["uniform","mat4","u_p_light_matrix2",";"]}]}}]},{a:"cond",c:[{a:"if",e:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","mat4","u_p_light_matrix3",";"]}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["REFRACTIVE","USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{a:"include",n:"dynamic_grass.glslv"},{a:"include",n:"shadow.glslv"},{a:"include",n:"skin.glslv"},
{a:"include",n:"wind_bending.glslv"},{a:"cond",c:[{a:"if",e:["NODES"],h:{a:"grp",c:[{a:"include",n:"nodes.glslv"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",c:[{a:"if",e:["REFLECTION_PASS"],h:{a:"grp",c:[{a:"txt",b:["mat4","de","=","u_view_matrix",";"]},{a:"cond",c:[{a:"if",e:["NODES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","PARALLAX",{a:"logical_and_expr",i:2},"WATER_EFFECTS","CAUSTICS",{a:"logical_and_expr",i:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",
i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:6}],h:{a:"grp",c:[{a:"txt",b:"mat4 vN = _ ( u_view_tsr ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"mat4 de = _ ( u_view_tsr ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["USE_INSTANCED_PARTCLS"],h:{a:"grp",c:[{a:"txt",b:"mat3 uz = mat3 ( a_part_ts [ 0 ] , a_part_ts [ 1 ] , a_part_ts [ 2 ] , a_part_ts [ 3 ] , a_part_r [ 0 ] , a_part_r [ 1 ] , a_part_r [ 2 ] , a_part_r [ 3 ] , 1.0 ) ;".split(" ")},
{a:"cond",c:[{a:"if",e:["STATIC_BATCH"],h:{a:"grp",c:[{a:"txt",b:"mat4 tD = _ ( uz ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"mat4 tD = _ ( ad ( u_model_tsr , uz ) ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"mat4 tD = _ ( u_model_tsr ) ;".split(" ")}]}}]},{a:"txt",b:["vec3","f","=","a_position",";"]},{a:"cond",c:[{a:"if",e:["CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",
i:3},"NODES",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:7}],h:{a:"grp",c:[{a:"txt",b:["vec3","l","=","a_normal",";"]}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"vec3 l = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["CALC_TBN_SPACE","NODES",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_UV_ORCO",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"vec3 i = vec3 ( a_tangent ) ; vec3 k = a_tangent [ 3 ] * cross ( l , i ) ;".split(" ")}]}},
{a:"elif",e:["NODES",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"vec3 vO = ( tD * vec4 ( f , 1.0 ) ) . xyz ; vec3 tE = normalize ( ( tD * vec4 ( a_normal , 0.0 ) ) . xyz ) ; vec3 cW = vO - u_camera_eye ; vec3 k = cross ( cW , tE ) ; vec3 i = cross ( tE , k ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"vec3 i = vec3 ( 0.0 ) ; vec3 k = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",
e:["USE_TBN_SHADING"],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["CALC_TBN"],h:{a:"grp",c:[{a:"txt",b:"vec3 tE = normalize ( ( tD * vec4 ( a_normal , 0.0 ) ) . xyz ) ; vec3 tF = cross ( vec3 ( 0.0 , 0.0 , 1.0 ) , tE ) ; vec3 tG = cross ( tE , tF ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:["vec3","tG","=","a_shade_tangs",";"]}]}}]}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"vec3 tG = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["VERTEX_ANIM"],h:{a:"grp",c:[{a:"txt",b:"f = mix ( f , a_position_next , u_va_frame_factor ) ;".split(" ")},
{a:"cond",c:[{a:"if",e:["NODES",{a:"logic_negative_expr",i:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_NORMAL_MAP","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",i:6}],h:{a:"grp",c:[{a:"txt",b:"l = mix ( l , a_normal_next , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["TEXTURE_NORM_CO"],h:{a:"grp",c:[{a:"txt",b:"vec3 tH = vec3 ( a_tangent ) ; vec3 tI = a_tangent_next [ 3 ] * cross ( a_normal_next , tH ) ; i = mix ( i , tH , u_va_frame_factor ) ; k = mix ( k , tI , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]},
{a:"cond",c:[{a:"if",e:["SKINNED"],h:{a:"grp",c:[{a:"txt",b:"sQ ( f , i , k , l ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["vec3","h","=","au_center_pos",";"]}]}},{a:"elif",e:["DYNAMIC_GRASS","USE_INSTANCED_PARTCLS",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"vec3 h = a_part_ts . xyz ; f = ( tD * vec4 ( f , 1.0 ) ) . xyz ;".split(" ")}]}},
{a:"else",h:{a:"grp",c:[{a:"txt",b:"vec3 h = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["DYNAMIC_GRASS"],h:{a:"grp",c:[{a:"txt",b:"e tJ = uy ( f , i , tG , k , l , h , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , de ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["BILLBOARD"],h:{a:"grp",c:[{a:"txt",b:"vec3 rJ = ( tD * vec4 ( h , 1.0 ) ) . xyz ;".split(" ")},{a:"cond",c:[{a:"if",e:["BILLBOARD_PRES_GLOB_ORIENTATION",
"STATIC_BATCH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2},"USE_INSTANCED_PARTCLS",{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"mat4 rR = rS ( u_camera_eye , rJ , de , tD ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"mat4 rR = rQ ( u_camera_eye , rJ , de ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"vec3 rE = ( tD * vec4 ( h , 1.0 ) ) . xyz ; rR = rR * rI ( u_wind , u_time , u_jitter_amp , u_jitter_freq , rE ) ;".split(" ")}]}}]},
{a:"txt",b:"e tJ = rZ ( f - h , h , i , tG , k , l , rR ) ; tJ . h = rJ ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"e tJ = rZ ( f , h , i , tG , k , l , tD ) ;".split(" ")}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"float aU = ( dot ( cross ( tJ . l , tJ . i ) , tJ . k ) < 0.0 ) ? - 1.0 : 1.0 ; bJ = vec4 ( tJ . i , aU ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["USE_TBN_SHADING"],h:{a:"grp",c:[{a:"txt",b:"bR = tJ . j ;".split(" ")}]}}]},
{a:"cond",c:[{a:"if",e:["WIND_BEND"],h:{a:"grp",c:[{a:"txt",b:"ty ( tJ . f , tJ . h , l ) ;".split(" ")}]}}]},{a:"txt",b:"bG = tJ . f ;".split(" ")},{a:"cond",c:[{a:"if",e:["NODES",{a:"logic_negative_expr",i:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},{a:"logical_or_expr",i:7}],h:{a:"grp",c:[{a:"txt",b:"bI = tJ . l ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["NODES",{a:"logic_negative_expr",
i:1}],h:{a:"grp",c:[{a:"txt",b:"vC = u_camera_eye - tJ . f ;".split(" ")},{a:"cond",c:[{a:"if",e:["TEXCOORD"],h:{a:"grp",c:[{a:"txt",b:"bQ = sa ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["DYNAMIC_GRASS"],h:{a:"grp",c:[{a:"txt",b:"vD = tJ . m ;".split(" ")}]}},{a:"elif",e:["VERTEX_COLOR"],h:{a:"grp",c:[{a:"txt",b:["vD","=","a_color",";"]}]}}]}]}}]},{a:"txt",b:"vec4 vP = de * vec4 ( tJ . f , 1.0 ) ;".split(" ")},{a:"cond",c:[{a:"if",e:["NODES","DISABLE_FOG",{a:"logic_negative_expr",
i:1},"TEXTURE_NORM_CO","PARALLAX",{a:"logical_and_expr",i:2},"WATER_EFFECTS","CAUSTICS",{a:"logical_and_expr",i:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:6}],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["REFLECTION_PASS"],h:{a:"grp",c:[{a:"txt",b:"vec4 vQ = vN * vec4 ( tJ . f , 1.0 ) ; bH = vQ ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:["bH","=","vP",";"]}]}}]}]}}]},{a:"txt",b:"vec4 T = u_proj_matrix * vP ;".split(" ")},
{a:"cond",c:[{a:"if",e:["SMAA_JITTER"],h:{a:"grp",c:[{a:"txt",b:"T . xy += u_subpixel_jitter * T . w ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2},"REFRACTIVE","USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",i:4}],h:{a:"grp",c:[{a:"txt",b:"bK = Y ( T ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"vM ( tJ . f , tJ . l ) ;".split(" ")}]}}]},
{a:"cond",c:[{a:"if",e:["REFRACTIVE","NODES",{a:"logic_negative_expr",i:1},"USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"bL = - vP . z / u_view_max_depth ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["NODES"],h:{a:"grp",c:[{a:"txt",b:["rs","(",")",";"]}]}}]},{a:"txt",b:["gl_Position","=","T",";","}"]}]};a["main_stack.glslf"]={a:"grp",c:[{a:"version",b:["GLSL_VERSION"]},{a:"include",n:"std_enums.glsl"},{a:"include",n:"precision_statement.glslf"},
{a:"include",n:"pack.glslf"},{a:"include",n:"color_util.glslf"},{a:"include",n:"math.glslv"},{a:"cond",c:[{a:"if",e:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",c:[{a:"include",n:"procedural.glslf"},{a:"cond",c:[{a:"if",e:["CAUSTICS"],h:{a:"grp",c:[{a:"include",n:"caustics.glslf"}]}}]}]}}]},{a:"txt",b:["uniform","float","u_time",";"]},{a:"cond",c:[{a:"if",e:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",
";"]}]}},{a:"elif",e:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"txt",b:["uniform","float","u_environment_energy",";"]},{a:"cond",c:[{a:"if",e:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},
{a:"cond",c:[{a:"if",e:["CAUSTICS"],h:{a:"grp",c:[{a:"txt",b:"uniform vec4 u_sun_quaternion ; uniform vec3 u_sun_intensity ; uniform vec3 u_sun_direction ;".split(" ")}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:3}],h:{a:"grp",c:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{a:"cond",c:[{a:"if",e:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",c:[{a:"txt",b:["uniform","vec4","u_fog_color_density",
";"]},{a:"cond",c:[{a:"if",e:["WATER_EFFECTS"],h:{a:"grp",c:[{a:"txt",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["PROCEDURAL_FOG"],h:{a:"grp",c:[{a:"txt",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{a:"cond",c:[{a:"if",e:["USE_FOG"],h:{a:"grp",c:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["TEXTURE_COLOR0_CO"],h:{a:"grp",c:[{a:"txt",b:["uniform","sampler2D","u_colormap0",";"]}]}}]},
{a:"cond",c:[{a:"if",e:["TEXTURE_SPEC","ALPHA_AS_SPEC",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","sampler2D","u_specmap0",";"]}]}}]},{a:"cond",c:[{a:"if",e:["TEXTURE_NORM_CO"],h:{a:"grp",c:[{a:"txt",b:["uniform","sampler2D","u_normalmap0",";"]}]}}]},{a:"cond",c:[{a:"if",e:["TEXTURE_STENCIL_ALPHA_MASK"],h:{a:"grp",c:[{a:"txt",b:"uniform sampler2D u_colormap1 ; uniform sampler2D u_stencil0 ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["REFLECTION_TYPE",
"REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","sampler2D","u_plane_reflection",";"]}]}},{a:"elif",e:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{a:"elif",e:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"cond",c:[{a:"if",e:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",
b:["uniform","sampler2D","u_shadow_mask",";"]}]}},{a:"elif",e:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"uniform vec4 u_pcf_blur_radii ; uniform vec4 u_csm_center_dists ; uniform PRECISION sampler2D u_shadow_map0 ;".split(" ")},{a:"cond",c:[{a:"if",e:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_shadow_map1",";"]}]}}]},{a:"cond",c:[{a:"if",e:["CSM_SECTION2","NUM_CAST_LAMPS",
2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_shadow_map2",";"]}]}}]},{a:"cond",c:[{a:"if",e:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_shadow_map3",";"]}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["REFRACTIVE"],h:{a:"grp",c:[{a:"txt",b:["uniform","sampler2D","u_refractmap",";"]}]}}]},{a:"cond",c:[{a:"if",e:["REFRACTIVE","USE_REFRACTION_CORRECTION",
{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ; uniform float u_specular_alpha ;".split(" ")},{a:"cond",c:[{a:"if",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","float","u_reflect_factor",";"]}]}},{a:"elif",e:["REFLECTION_TYPE",
"REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}}]},{a:"cond",c:[{a:"if",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{a:"txt",b:"uniform vec4 u_diffuse_color ; uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ;".split(" ")},{a:"cond",c:[{a:"if",e:["TEXTURE_NORM_CO"],h:{a:"grp",c:[{a:"txt",b:["uniform","float","u_normal_factor",";"]}]}}]},{a:"cond",
c:[{a:"if",e:["TEXTURE_COLOR0_CO"],h:{a:"grp",c:[{a:"txt",b:"uniform float u_diffuse_color_factor ; uniform float u_alpha_factor ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["TEXTURE_SPEC"],h:{a:"grp",c:[{a:"txt",b:["uniform","float","u_specular_color_factor",";"]}]}}]},{a:"txt",b:"uniform vec3 u_specular_color ; uniform vec3 u_specular_params ;".split(" ")},{a:"cond",c:[{a:"if",e:["TEXTURE_NORM_CO","PARALLAX",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","float","u_parallax_scale",
";"]}]}}]},{a:"cond",c:[{a:"if",e:["REFRACTIVE"],h:{a:"grp",c:[{a:"txt",b:["uniform","float","u_refr_bump",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 bG ; GLSL_IN vec3 bI ;".split(" ")},{a:"cond",c:[{a:"if",e:["NODES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","PARALLAX",{a:"logical_and_expr",i:2},"SHADELESS",{a:"logic_negative_expr",i:1},"CAUSTICS",{a:"logical_and_expr",i:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",
i:2},{a:"logical_or_expr",i:6}],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec4","bH",";"]}]}}]},{a:"cond",c:[{a:"if",e:["TEXTURE_NORM_CO","CALC_TBN_SPACE",{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec4","bJ",";"]}]}}]},{a:"txt",b:["GLSL_IN","vec3","vC",";"]},{a:"cond",c:[{a:"if",e:["USE_TBN_SHADING"],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec3","bR",";"]}]}}]},{a:"cond",c:[{a:"if",e:["TEXCOORD"],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec2","bQ",";"]}]}}]},{a:"cond",c:[{a:"if",e:["VERTEX_COLOR",
"DYNAMIC_GRASS",{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec3","vD",";"]}]}}]},{a:"cond",c:[{a:"if",e:["SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec4","bM",";"]},{a:"cond",c:[{a:"if",e:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec4","bN",";"]}]}}]},{a:"cond",c:[{a:"if",e:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],
h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec4","bO",";"]}]}}]},{a:"cond",c:[{a:"if",e:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec4","bP",";"]}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:3}],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec3","bK",";"]}]}}]},{a:"cond",c:[{a:"if",e:["REFRACTIVE"],h:{a:"grp",
c:[{a:"txt",b:["GLSL_IN","float","bL",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"cond",c:[{a:"if",e:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",c:[{a:"include",n:"shadow.glslf"}]}}]},{a:"include",n:"mirror.glslf"},{a:"cond",c:[{a:"if",e:["REFRACTIVE"],h:{a:"grp",c:[{a:"include",n:"refraction.glslf"}]}}]},{a:"include",n:"environment.glslf"},{a:"cond",c:[{a:"if",e:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",c:[{a:"include",n:"lighting_nodes.glslf"}]}}]},
{a:"cond",c:[{a:"if",e:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",c:[{a:"include",n:"fog.glslf"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",c:[{a:"if",e:["NODES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","PARALLAX",{a:"logical_and_expr",i:2},"SHADELESS",{a:"logic_negative_expr",i:1},"CAUSTICS","WATER_EFFECTS",{a:"logical_and_expr",i:3},{a:"logical_or_expr",i:4}],h:{a:"grp",c:[{a:"txt",b:"float bt = length ( bH ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",
e:["WATER_EFFECTS"],h:{a:"grp",c:[{a:"txt",b:"float vz = bG . y - WATER_LEVEL ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["TEXCOORD"],h:{a:"grp",c:[{a:"txt",b:["vec2","bv","=","bQ",";"]}]}}]},{a:"txt",b:"vec3 ei = normalize ( bI ) ;".split(" ")},{a:"cond",c:[{a:"if",e:["DOUBLE_SIDED_LIGHTING"],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["INVERT_FRONTFACING"],h:{a:"grp",c:[{a:"txt",b:["if","(","!","gl_FrontFacing",")"]}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:["if","(","gl_FrontFacing",")"]}]}}]},{a:"txt",
b:"ei = ei ; else ei = - ei ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["TEXTURE_NORM_CO"],h:{a:"grp",c:[{a:"txt",b:"vec3 k = cross ( ei , bJ . xyz ) * bJ . w ; mat3 el = mat3 ( bJ . xyz , k , ei ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:3}],h:{a:"grp",c:[{a:"txt",b:"mat4 de = _ ( u_view_tsr_frag ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["NORMAL_TEXCOORD"],h:{a:"grp",c:[{a:"txt",b:"vec2 wn = normalize ( de * vec4 ( bI , 0.0 ) ) . st ; wn = wn * vec2 ( 0.495 ) + vec2 ( 0.5 ) ;".split(" ")}]}}]},
{a:"cond",c:[{a:"if",e:["TEXTURE_NORM_CO","PARALLAX",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"if ( bt < PARALLAX_LOD_DIST ) { float qJ = clamp ( 0.5 * ( PARALLAX_LOD_DIST - bt ) , 0.0 , 1.0 ) ; float wo = u_parallax_scale * qJ ; vec3 qK = normalize ( vC * el ) ; float qL = 1.0 / PARALLAX_STEPS ; vec2 qM = qK . xy * wo / ( PARALLAX_STEPS * qK . z ) ; float qN = 1.0 ; float aV ;".split(" ")},{a:"cond",c:[{a:"if",e:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2}],h:{a:"grp",
c:[{a:"txt",b:["vec2","wp","=","wn",";"]}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:["vec2","wp","=","bv",";"]}]}}]},{a:"txt",b:"aV = GLSL_TEXTURE ( u_normalmap0 , wp ) . a ; for ( float aQ = 1.0 ; aQ <= PARALLAX_STEPS ; aQ ++ ) { if ( aV < qN ) { qN -= qL ; wp -= qM ; aV = GLSL_TEXTURE ( u_normalmap0 , wp ) . a ; } } vec2 qO = wp + qM ; float qP = GLSL_TEXTURE ( u_normalmap0 , qO ) . a - ( qN + qL ) ; float qQ = aV - qN ; float qR = qQ / ( qQ - qP ) ; wp = qR * qO + ( 1.0 - qR ) * wp ;".split(" ")},
{a:"cond",c:[{a:"if",e:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["TEXCOORD"],h:{a:"grp",c:[{a:"txt",b:"bv += wp - wn ;".split(" ")}]}}]},{a:"txt",b:["wn","=","wp",";"]}]}},{a:"else",h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["NORMAL_TEXCOORD"],h:{a:"grp",c:[{a:"txt",b:"wn += wp - bv ;".split(" ")}]}}]},{a:"txt",b:["bv","=","wp",";"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"cond",c:[{a:"if",e:["TEXTURE_NORM_CO"],h:{a:"grp",c:[{a:"txt",b:["vec4","wq",
";"]},{a:"cond",c:[{a:"if",e:["TEXTURE_NORM_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"wq = GLSL_TEXTURE ( u_normalmap0 , wn ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"wq = GLSL_TEXTURE ( u_normalmap0 , bv ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 wr = wq . rgb - 0.5 ; wr = mix ( vec3 ( 0.0 , 0.0 , 1.0 ) , wr , u_normal_factor ) ; vec3 l = el * wr ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:["vec3","l","=","ei",";"]}]}}]},{a:"txt",b:"l = normalize ( l ) ;".split(" ")},
{a:"cond",c:[{a:"if",e:["NORMAL_TEXCOORD"],h:{a:"grp",c:[{a:"txt",b:"wn = normalize ( de * vec4 ( l , 0.0 ) ) . st ; wn = wn * vec2 ( 0.495 ) + vec2 ( 0.5 ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 cW = normalize ( vC ) ;".split(" ")},{a:"cond",c:[{a:"if",e:["VERTEX_COLOR","DYNAMIC_GRASS",{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"vec3 ws = vD ; bd ( ws ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["VERTEX_COLOR","DYNAMIC_GRASS",{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"vec4 wt = vec4 ( ws , 1.0 ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",c:[{a:"txt",b:["vec4","wt","=","u_diffuse_color",";"]}]}}]},{a:"txt",b:["float","wu","=","1.0",";"]},{a:"cond",c:[{a:"if",e:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"vec4 wv = GLSL_TEXTURE ( u_colormap0 , wn ) ;".split(" ")}]}},{a:"elif",e:["TEXTURE_COLOR0_CO","TEXTURE_COORDS_UV_ORCO",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"vec4 wv = GLSL_TEXTURE ( u_colormap0 , bv ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["TEXTURE_COLOR0_CO"],
h:{a:"grp",c:[{a:"txt",b:"bd ( wv . rgb ) ;".split(" ")},{a:"cond",c:[{a:"if",e:["TEXTURE_STENCIL_ALPHA_MASK"],h:{a:"grp",c:[{a:"txt",b:["vec4","wA",";"]},{a:"cond",c:[{a:"if",e:["TEXTURE_COLOR1_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"wA = GLSL_TEXTURE ( u_colormap1 , wn ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"wA = GLSL_TEXTURE ( u_colormap1 , bv ) ;".split(" ")}]}}]},{a:"txt",b:"bd ( wA . rgb ) ;".split(" ")},{a:"cond",c:[{a:"if",e:["TEXTURE_STENCIL_ALPHA_MASK_CO",
"TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"vec4 wB = GLSL_TEXTURE ( u_stencil0 , wn ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"vec4 wB = GLSL_TEXTURE ( u_stencil0 , bv ) ;".split(" ")}]}}]},{a:"txt",b:"wv = mix ( wv , wA , wB . r ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"wt . rgb = mix ( wt . rgb , wv . rgb , u_diffuse_color_factor ) ; float rt = u_alpha_factor * wv . a ; rt += ( 1.0 - step ( 0.0 , rt ) ) ; wt . a = mix ( rt , 1.0 , u_diffuse_color . a ) ; wu = wv . a ;".split(" ")}]}},
{a:"elif",e:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"wt . rgb *= mix ( vec3 ( 1.0 ) , wv . rgb , u_diffuse_color_factor ) ; wt . a = wv . a ; wu = wv . a ;".split(" ")}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["SHADELESS"],h:{a:"grp",c:[{a:"txt",b:"vec3 m = wt . rgb ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"vec3 cU = u_diffuse_intensity * wt . rgb ; vec3 wC = u_environment_energy * dm ( l ) ; vec3 nx = u_ambient * wC ; vec4 bn = cV ( cU ) ; vec3 wD = u_emit * wt . rgb ; vec3 wE = u_specular_color ;".split(" ")},
{a:"cond",c:[{a:"if",e:["TEXTURE_SPEC"],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["ALPHA_AS_SPEC"],h:{a:"grp",c:[{a:"txt",b:"vec3 wF = vec3 ( wu ) ;".split(" ")}]}},{a:"elif",e:["TEXTURE_SPEC_CO","TEXTURE_COORDS_NORMAL",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"vec3 wF = GLSL_TEXTURE ( u_specmap0 , wn ) . rgb ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"vec3 wF = GLSL_TEXTURE ( u_specmap0 , bv ) . rgb ;".split(" ")}]}}]},{a:"txt",b:"bd ( wF . rgb ) ; wE = mix ( wE , wF , u_specular_color_factor ) ;".split(" ")}]}}]},
{a:"txt",b:"float wG = u_specular_params [ 0 ] ; vec2 wH = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; vec3 wI = wG * wE ; vec3 m ; vec3 wJ ; wm ( wD , nx , cU , wI , bG , l , cW , wH , u_diffuse_params , bn , 0.0 , vec4 ( 0.0 ) , m , wJ ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"dk ( m , cW , l , u_reflect_factor , de ) ;".split(" ")}]}},{a:"elif",e:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],
h:{a:"grp",c:[{a:"txt",b:"dk ( m , cW , l , u_reflect_factor , mat4 ( 0.0 ) ) ;".split(" ")}]}},{a:"elif",e:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"dk ( m , cW , l , u_mirror_factor , mat4 ( 0.0 ) ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",c:[{a:"txt",b:["m","+=","wJ",";"]}]}}]},{a:"txt",b:"float bf = wt . a ;".split(" ")},{a:"cond",c:[{a:"if",e:["SHADELESS",{a:"logic_negative_expr",i:1},"WATER_EFFECTS",
{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["WETTABLE"],h:{a:"grp",c:[{a:"txt",b:"m = max ( m - sqrt ( 0.01 * - min ( vz , 0.0 ) ) , 0.5 * m ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["CAUSTICS"],h:{a:"grp",c:[{a:"txt",b:"bF ( m , vz , u_time , bn , l , u_sun_direction , u_sun_intensity , u_sun_quaternion , bG , bt ) ;".split(" ")}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["ALPHA"],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["ALPHA_CLIP"],h:{a:"grp",c:[{a:"txt",b:"if ( bf < 0.5 ) discard ; bf = 1.0 ;".split(" ")}]}},
{a:"else",h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",c:[{a:"txt",b:"float t = max ( max ( wJ . r , wJ . g ) , wJ . b ) * u_specular_alpha ; bf = wt . a * ( 1.0 - t ) + t ;".split(" ")}]}}]}]}}]}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:["bf","=","1.0",";"]}]}}]},{a:"cond",c:[{a:"if",e:["REFRACTIVE"],h:{a:"grp",c:[{a:"txt",b:"vec2 wK = - ( de * vec4 ( l , 0.0 ) ) . xy ; m = mix ( dx ( bK , wK * u_refr_bump ) , m , bf ) ; bf = 1.0 ;".split(" ")}]}}]},{a:"cond",
c:[{a:"if",e:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["WATER_EFFECTS"],h:{a:"grp",c:[{a:"txt",b:"vA ( m , bt , cW , vz ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"vA ( m , bt , cW , 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:["be","(","m",")",";"]},{a:"cond",c:[{a:"if",e:["ALPHA","ALPHA_CLIP",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"bh ( m , bf ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( m , bf ) ; }".split(" ")}]};
a["particle_system.glslf"]={a:"grp",c:[{a:"version",b:["GLSL_VERSION"]},{a:"include",n:"std_enums.glsl"},{a:"include",n:"precision_statement.glslf"},{a:"include",n:"color_util.glslf"},{a:"cond",c:[{a:"if",e:["SOFT_PARTICLES","NODES",{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"include",n:"pack.glslf"}]}}]},{a:"txt",b:["uniform","float","u_environment_energy",";"]},{a:"cond",c:[{a:"if",e:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},
{a:"cond",c:[{a:"if",e:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",c:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",c:[{a:"if",e:["WATER_EFFECTS"],h:{a:"grp",c:[{a:"txt",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["PROCEDURAL_FOG"],h:{a:"grp",c:[{a:"txt",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{a:"cond",c:[{a:"if",e:["USE_FOG"],h:{a:"grp",c:[{a:"txt",b:["uniform","vec4","u_fog_params",
";"]}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",e:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform float u_time ; uniform vec3 u_camera_eye_frag ;".split(" ")},{a:"cond",
c:[{a:"if",e:["USE_NODE_LAMP"],h:{a:"grp",c:[{a:"txt",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ; uniform vec4 u_lamp_light_factors [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["USE_NODE_VALUE"],h:{a:"grp",c:[{a:"txt",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["USE_NODE_RGB"],h:{a:"grp",c:[{a:"txt",
b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["NORMAL_TEXCOORD","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_NODE_GEOMETRY_VW",{a:"logical_or_expr",i:3}],h:{a:"grp",c:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{a:"cond",c:[{a:"if",e:["USE_ZUP_VIEW_MATRIX"],h:{a:"grp",c:[{a:"txt",b:["uniform","mat3","u_view_zup_tsr",";"]}]}}]},{a:"cond",c:[{a:"if",e:["USE_ZUP_VIEW_MATRIX_INVERSE"],h:{a:"grp",c:[{a:"txt",b:["uniform","mat3","u_view_zup_tsr_inverse",
";"]}]}}]},{a:"cond",c:[{a:"if",e:["USE_ZUP_MODEL_MATRIX"],h:{a:"grp",c:[{a:"txt",b:["uniform","mat3","u_model_zup_tsr",";"]}]}}]},{a:"cond",c:[{a:"if",e:["USE_ZUP_MODEL_MATRIX_INVERSE"],h:{a:"grp",c:[{a:"txt",b:["uniform","mat3","u_model_zup_tsr_inverse",";"]}]}}]},{a:"cond",c:[{a:"if",e:["SOFT_PARTICLES"],h:{a:"grp",c:[{a:"txt",b:"uniform PRECISION sampler2D u_scene_depth ; uniform float u_view_max_depth ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",
{a:"logical_or_expr",i:3}],h:{a:"grp",c:[{a:"txt",b:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{a:"cond",c:[{a:"if",e:["TEXTURE_NORM_CO","CALC_TBN_SPACE","USE_TBN_SHADING",{a:"logical_or_expr",i:3}],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec4","bJ",";"]}]}}]},{a:"cond",c:[{a:"if",e:["SOFT_PARTICLES"],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec3","bK",";"]}]}}]},{a:"cond",c:[{a:"if",e:["TEXTURE_COLOR","USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR",
"USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:7}],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec2","bQ",";"]}]}}]},{a:"txt",b:["GLSL_IN","vec3","bG",";"]},{a:"cond",c:[{a:"if",e:["SOFT_PARTICLES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"NODES",{a:"logical_or_expr",i:3}],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec4","bH",";"]}]}}]},{a:"txt",b:"GLSL_IN vec3 bI ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"cond",c:[{a:"if",e:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",c:[{a:"include",
n:"fog.glslf"}]}}]},{a:"include",n:"environment.glslf"},{a:"include",n:"math.glslv"},{a:"include",n:"particles_nodes.glslf"},{a:"txt",b:"void main ( ) { vec3 cW = normalize ( u_camera_eye_frag - bG ) ; vec3 ed ; vec3 ee ; vec3 ef ; vec4 eg ; float eh ; mat4 dZ = mat4 ( 0.0 ) ; mat4 d_ = mat4 ( 0.0 ) ; mat4 ea = mat4 ( 0.0 ) ; mat4 eb = mat4 ( 0.0 ) ; mat4 ec = mat4 ( 0.0 ) ;".split(" ")},{a:"cond",c:[{a:"if",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_NODE_GEOMETRY_VW",{a:"logical_or_expr",
i:2}],h:{a:"grp",c:[{a:"txt",b:"dZ = _ ( u_view_tsr_frag ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["USE_ZUP_VIEW_MATRIX"],h:{a:"grp",c:[{a:"txt",b:"d_ = _ ( u_view_zup_tsr ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["USE_ZUP_VIEW_MATRIX_INVERSE"],h:{a:"grp",c:[{a:"txt",b:"ea = _ ( u_view_zup_tsr_inverse ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["USE_ZUP_MODEL_MATRIX"],h:{a:"grp",c:[{a:"txt",b:"eb = _ ( u_model_zup_tsr ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["USE_ZUP_MODEL_MATRIX_INVERSE"],
h:{a:"grp",c:[{a:"txt",b:"ec = _ ( u_model_zup_tsr_inverse ) ;".split(" ")}]}}]},{a:"txt",b:"rs ( cW , dZ , d_ , ea , eb , ec , ed , ee , ef , eg , eh ) ; vec3 m = ed ; float bf = eh ;".split(" ")},{a:"cond",c:[{a:"if",e:["ALPHA"],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["ALPHA_CLIP"],h:{a:"grp",c:[{a:"txt",b:"if ( bf < 0.5 ) discard ; bf = 1.0 ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:["bf","=","1.0",";"]}]}}]},{a:"cond",c:[{a:"if",e:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",
c:[{a:"txt",b:"vA ( m , length ( bH ) , cW , 1.0 ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["SOFT_PARTICLES"],h:{a:"grp",c:[{a:"txt",b:"float wP = - bH . z / u_view_max_depth ; vec4 dv = GLSL_TEXTURE_PROJ ( u_scene_depth , bK ) ; float dn = ap ( dv ) ; float wQ = dn - wP ; float wR = u_view_max_depth / SOFT_STRENGTH * wQ ; bf = bf * min ( wR , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["be","(","m",")",";"]},{a:"cond",c:[{a:"if",e:["ALPHA","ALPHA_CLIP",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",
i:2}],h:{a:"grp",c:[{a:"txt",b:"bh ( m , bf ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( m , bf ) ; }".split(" ")}]};a["particle_system.glslv"]={a:"grp",c:[{a:"version",b:["GLSL_VERSION"]},{a:"define",d:"BILLBOARD_ALIGN_VIEW",b:["1"]},{a:"define",d:"BILLBOARD_ALIGN_XY",b:["2"]},{a:"define",d:"BILLBOARD_ALIGN_YZ",b:["3"]},{a:"define",d:"BILLBOARD_ALIGN_ZX",b:["4"]},{a:"define",d:"M_PI",b:["3.14159265359"]},{a:"txt",b:"GLSL_IN vec3 a_position ; GLSL_IN vec3 a_normal ; GLSL_IN vec3 a_p_data ; GLSL_IN vec4 a_p_vels ;".split(" ")},
{a:"cond",c:[{a:"if",e:["TEXTURE_NORM_CO","CALC_TBN_SPACE","USE_TBN_SHADING",{a:"logical_or_expr",i:3}],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec4","a_tangent",";"]}]}}]},{a:"txt",b:["GLSL_IN","vec2","a_p_bb_vertex",";"]},{a:"cond",c:[{a:"if",e:["NODES",{a:"logic_negative_expr",i:1}],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["HALO_PARTICLES",{a:"logic_negative_expr",i:1}],h:{a:"grp",c:[{a:"txt",b:["GLSL_OUT","float","wS",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec3","vD",";"]}]}}]},{a:"cond",c:[{a:"if",e:["TEXTURE_NORM_CO",
"CALC_TBN_SPACE","USE_TBN_SHADING",{a:"logical_or_expr",i:3}],h:{a:"grp",c:[{a:"txt",b:["GLSL_OUT","vec4","bJ",";"]}]}}]},{a:"cond",c:[{a:"if",e:["TEXTURE_COLOR","HALO_PARTICLES","USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:8}],h:{a:"grp",c:[{a:"txt",b:["GLSL_OUT","vec2","bQ",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec3","bG",";"]},{a:"cond",c:[{a:"if",e:["PARTICLES_SHADELESS",{a:"logic_negative_expr",
i:1},"DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["GLSL_OUT","vec3","vC",";"]}]}}]},{a:"cond",c:[{a:"if",e:["SOFT_PARTICLES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"NODES",{a:"logical_or_expr",i:3}],h:{a:"grp",c:[{a:"txt",b:["GLSL_OUT","vec4","bH",";"]}]}}]},{a:"cond",c:[{a:"if",e:["SOFT_PARTICLES"],h:{a:"grp",c:[{a:"txt",b:["GLSL_OUT","vec3","bK",";"]}]}}]},{a:"cond",c:[{a:"if",e:["NODES"],h:{a:"grp",c:[{a:"txt",b:["GLSL_OUT","vec3","bI",";"]}]}}]},
{a:"cond",c:[{a:"if",e:["HALO_PARTICLES"],h:{a:"grp",c:[{a:"txt",b:["GLSL_OUT","float","uC",";"]}]}}]},{a:"cond",c:[{a:"if",e:["COLOR_RAMP_LENGTH",0,{a:"g_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"uniform vec4 u_p_color_ramp [ COLOR_RAMP_LENGTH ] ;".split(" ")}]}}]},{a:"txt",b:"uniform float u_p_time ; uniform float u_p_length ; uniform int u_p_cyclic ; uniform float u_p_fade_in ; uniform float u_p_fade_out ; uniform float u_p_nfactor ; uniform float u_p_gravity ; uniform float u_p_mass ; uniform float u_p_wind_fac ; uniform float u_p_max_lifetime ; uniform float u_p_tilt ; uniform float u_p_tilt_rand ;".split(" ")},
{a:"cond",c:[{a:"if",e:["REFLECTION_PASS"],h:{a:"grp",c:[{a:"txt",b:["uniform","mat4","u_view_matrix",";"]}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:["uniform","mat3","u_view_tsr",";"]}]}}]},{a:"txt",b:"uniform mat4 u_proj_matrix ; uniform vec3 u_wind ; uniform float u_p_size ; uniform vec3 u_camera_eye ;".split(" ")},{a:"cond",c:[{a:"if",e:["WORLD_SPACE",{a:"logic_negative_expr",i:1},"NODES","HALO_PARTICLES",{a:"logical_or_expr",i:3}],h:{a:"grp",c:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},
{a:"cond",c:[{a:"if",e:["USE_COLOR_RAMP"],h:{a:"grp",c:[{a:"txt",b:["uniform","sampler2D","u_color_ramp_tex",";"]}]}}]},{a:"include",n:"math.glslv"},{a:"include",n:"to_world.glslv"},{a:"include",n:"particles.glslv"},{a:"cond",c:[{a:"if",e:["NODES"],h:{a:"grp",c:[{a:"include",n:"std_enums.glsl"},{a:"include",n:"particles_nodes.glslv"}]}}]},{a:"txt",b:"float xD ( vec2 xB , vec2 xC ) { return ( atan ( xC . y , xC . x ) - atan ( xB . y , xB . x ) ) ; } void main ( ) {".split(" ")},{a:"cond",c:[{a:"if",
e:["REFLECTION_PASS"],h:{a:"grp",c:[{a:"txt",b:["mat4","de","=","u_view_matrix",";"]}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"mat4 de = _ ( u_view_tsr ) ;".split(" ")}]}}]},{a:"txt",b:"wT pp ; pp = xp ( ) ; float xE ; mat4 uZ ; if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_VIEW ) { xE = pp . O ; uZ = rw ( pp . f , de ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_XY ) { xE = pp . O ; uZ = N ( ) ; uZ [ 3 ] = vec4 ( pp . f , 1.0 ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_YZ ) { xE = pp . O ; uZ = Q ( radians ( 90.0 ) ) ; uZ [ 3 ] = vec4 ( pp . f , 1.0 ) ; } else if ( BILLBOARD_ALIGN == BILLBOARD_ALIGN_ZX ) { xE = xD ( vec2 ( EPSILON , 1.0 ) , vec2 ( a_normal . x , a_normal . z ) ) + pp . O ; uZ = P ( radians ( - 90.0 ) ) ; uZ [ 3 ] = vec4 ( pp . f , 1.0 ) ; } vec4 va = vec4 ( a_p_bb_vertex * 2.0 * pp . wU * u_p_size , 0.0 , 1.0 ) ; float xF = a_p_data [ 2 ] ; float xG = u_p_tilt * u_p_tilt_rand * ( 2.0 * xF - 1.0 ) ; float xH = ( xG + u_p_tilt ) * M_PI ; vec4 bs = uZ * R ( xH + xE ) * va ; vec4 vP = de * bs ; vec4 T = u_proj_matrix * vP ;".split(" ")},
{a:"cond",c:[{a:"if",e:["HALO_PARTICLES"],h:{a:"grp",c:[{a:"txt",b:["uC","=","xF",";"]}]}}]},{a:"cond",c:[{a:"if",e:["NODES"],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["CALC_TBN_SPACE","NODES",{a:"logic_negative_expr",i:1},"TEXTURE_NORM_CO","TEXTURE_COORDS_UV_ORCO",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2},"USE_TBN_SHADING",{a:"logical_or_expr",i:3}],h:{a:"grp",c:[{a:"txt",b:"vec3 i = vec3 ( a_tangent ) ; vec3 k = a_tangent [ 3 ] * cross ( a_normal , i ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",
b:"vec3 i = vec3 ( 0.0 ) ; vec3 k = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:"e tJ = rZ ( vec3 ( 0.0 ) , vec3 ( 0.0 ) , i , vec3 ( 0.0 ) , k , vec3 ( 0.0 ) , uZ * R ( xE ) ) ;".split(" ")},{a:"cond",c:[{a:"if",e:["TEXTURE_NORM_CO","CALC_TBN_SPACE","USE_TBN_SHADING",{a:"logical_or_expr",i:3}],h:{a:"grp",c:[{a:"txt",b:"float aU = ( dot ( cross ( a_normal , tJ . i ) , tJ . k ) < 0.0 ) ? - 1.0 : 1.0 ; bJ = vec4 ( tJ . i , aU ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["NODES",{a:"logic_negative_expr",
i:1},"USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},{a:"logical_or_expr",i:6}],h:{a:"grp",c:[{a:"txt",b:["bI","=","a_normal",";"]}]}}]},{a:"txt",b:"rs ( pp . f , pp . wV , pp . wW , pp . wX , pp . wU , a_p_bb_vertex , a_p_data [ 0 ] ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["TEXTURE_COLOR"],h:{a:"grp",c:[{a:"txt",b:"bQ = a_p_bb_vertex + 0.5 ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",
e:["HALO_PARTICLES"],h:{a:"grp",c:[{a:"txt",b:"bQ = a_p_bb_vertex * 2.0 ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"wS = pp . bf ;".split(" ")}]}}]},{a:"txt",b:"vD = pp . m ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["SOFT_PARTICLES"],h:{a:"grp",c:[{a:"txt",b:"float U = T . x ; float V = T . y ; float W = T . w ; bK . x = ( U + W ) / 2.0 ; bK . y = ( V + W ) / 2.0 ; bK . z = W ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["SOFT_PARTICLES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"NODES",
{a:"logical_or_expr",i:3}],h:{a:"grp",c:[{a:"txt",b:["bH","=","vP",";"]}]}}]},{a:"txt",b:"gl_Position = T ; bG = bs . xyz ;".split(" ")},{a:"cond",c:[{a:"if",e:["PARTICLES_SHADELESS",{a:"logic_negative_expr",i:1},"DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"vC = u_camera_eye - bs . xyz ;".split(" ")}]}}]},{a:"txt",b:["}"]}]};a["particle_system_stack.glslf"]={a:"grp",c:[{a:"version",b:["GLSL_VERSION"]},{a:"include",n:"std_enums.glsl"},{a:"include",
n:"precision_statement.glslf"},{a:"include",n:"color_util.glslf"},{a:"cond",c:[{a:"if",e:["SOFT_PARTICLES","NODES",{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"include",n:"pack.glslf"}]}}]},{a:"cond",c:[{a:"if",e:["HALO_PARTICLES",{a:"logic_negative_expr",i:1}],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["TEXTURE_COLOR"],h:{a:"grp",c:[{a:"txt",b:["uniform","sampler2D","u_sampler",";"]}]}}]},{a:"txt",b:["uniform","float","u_environment_energy",";"]},{a:"cond",c:[{a:"if",e:["NUM_LIGHTS",0,{a:"g_expr",i:2}],
h:{a:"grp",c:[{a:"txt",b:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["TEXTURE_COLOR"],h:{a:"grp",c:[{a:"txt",b:["uniform","float","u_diffuse_color_factor",";"]}]}}]},{a:"cond",c:[{a:"if",e:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","samplerCube",
"u_sky_texture",";"]}]}},{a:"elif",e:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"txt",b:"uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ; uniform float u_emit ; uniform float u_ambient ; uniform vec3 u_specular_color ; uniform vec3 u_specular_params ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"uniform float u_halo_size ; uniform vec3 u_halo_rings_color ; uniform float u_halo_hardness ; uniform vec3 u_halo_lines_color ;".split(" ")},
{a:"cond",c:[{a:"if",e:["SKY_STARS"],h:{a:"grp",c:[{a:"txt",b:"uniform vec3 u_sun_intensity ; uniform float u_halo_stars_blend ; uniform float u_halo_stars_height ;".split(" ")}]}}]},{a:"txt",b:"uniform float u_p_alpha_start ; uniform float u_p_alpha_end ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",c:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",c:[{a:"if",e:["WATER_EFFECTS"],h:{a:"grp",c:[{a:"txt",b:"uniform vec4 u_underwater_fog_color_density ; uniform float u_cam_water_depth ;".split(" ")}]}}]},
{a:"cond",c:[{a:"if",e:["PROCEDURAL_FOG"],h:{a:"grp",c:[{a:"txt",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{a:"cond",c:[{a:"if",e:["USE_FOG"],h:{a:"grp",c:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"txt",b:["uniform","vec4","u_diffuse_color",";"]},{a:"cond",c:[{a:"if",e:["SOFT_PARTICLES"],h:{a:"grp",c:[{a:"txt",b:"uniform PRECISION sampler2D u_scene_depth ; uniform float u_view_max_depth ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["SOFT_PARTICLES"],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN",
"vec3","bK",";"]}]}}]},{a:"cond",c:[{a:"if",e:["TEXTURE_COLOR","HALO_PARTICLES","USE_NODE_TEX_COORD_UV","USE_NODE_UV_MERGED","USE_NODE_UVMAP","USE_NODE_GEOMETRY_UV","USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:8}],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec2","bQ",";"]}]}}]},{a:"txt",b:["GLSL_IN","vec3","bG",";"]},{a:"cond",c:[{a:"if",e:["NODES",{a:"logic_negative_expr",i:1}],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["HALO_PARTICLES",{a:"logic_negative_expr",i:1}],h:{a:"grp",c:[{a:"txt",
b:["GLSL_IN","float","wS",";"]}]}}]},{a:"txt",b:["GLSL_IN","vec3","vD",";"]}]}}]},{a:"cond",c:[{a:"if",e:["PARTICLES_SHADELESS",{a:"logic_negative_expr",i:1},"DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec3","vC",";"]}]}}]},{a:"cond",c:[{a:"if",e:["SOFT_PARTICLES","DISABLE_FOG",{a:"logic_negative_expr",i:1},"NODES",{a:"logical_or_expr",i:3}],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec4","bH",";"]}]}}]},{a:"cond",c:[{a:"if",e:["HALO_PARTICLES"],
h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","float","uC",";"]},{a:"cond",c:[{a:"if",e:["SKY_STARS"],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec4","uB",";"]}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["USE_TBN_SHADING"],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec3","bR",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"include",n:"lighting_nodes.glslf"},{a:"cond",c:[{a:"if",e:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",c:[{a:"include",n:"fog.glslf"}]}}]},{a:"cond",c:[{a:"if",e:["HALO_PARTICLES",
{a:"logic_negative_expr",i:1}],h:{a:"grp",c:[{a:"include",n:"environment.glslf"}]}}]},{a:"cond",c:[{a:"if",e:["HALO_PARTICLES"],h:{a:"grp",c:[{a:"include",n:"halo_color.glslf"}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",c:[{a:"if",e:["PARTICLES_SHADELESS",{a:"logic_negative_expr",i:1},"DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"vec3 cW = normalize ( vC ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["HALO_PARTICLES"],h:{a:"grp",c:[{a:"txt",
b:"vec4 uY = uX ( ) ; vec3 m = uY . rgb * vD ; float xI = 0.9 * length ( bQ ) ; float xJ = smoothstep ( u_p_alpha_start , u_p_alpha_end , xI ) ; float bf = uY . a * ( 1.0 - xJ ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:["vec4","wt","=","u_diffuse_color",";"]},{a:"cond",c:[{a:"if",e:["TEXTURE_COLOR"],h:{a:"grp",c:[{a:"txt",b:"vec4 wv = GLSL_TEXTURE ( u_sampler , bQ ) ; bd ( wv . rgb ) ;".split(" ")},{a:"cond",c:[{a:"if",e:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{a:"equal_expr",i:2}],
h:{a:"grp",c:[{a:"txt",b:"wt . rgb = mix ( wt . rgb , wv . rgb , u_diffuse_color_factor ) ;".split(" ")}]}},{a:"elif",e:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MULTIPLY",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"wt . rgb *= mix ( vec3 ( 1.0 ) , wv . rgb , u_diffuse_color_factor ) ;".split(" ")}]}}]},{a:"txt",b:"wt . a = wv . a ;".split(" ")}]}}]},{a:"txt",b:"wt . rgb *= vD ;".split(" ")},{a:"cond",c:[{a:"if",e:["PARTICLES_SHADELESS",{a:"logic_negative_expr",i:1}],h:{a:"grp",c:[{a:"txt",b:"vec3 cU = u_diffuse_intensity * wt . rgb ; vec3 wD = u_emit * wt . rgb ; vec3 l = vec3 ( 0.0 , 1.0 , 0.0 ) ;".split(" ")},
{a:"cond",c:[{a:"if",e:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logic_negative_expr",i:1},"SKY_COLOR",{a:"logical_and_expr",i:3}],h:{a:"grp",c:[{a:"txt",b:"vec3 wC = u_environment_energy * dm ( vec3 ( 0.0 ) ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"vec3 wC = u_environment_energy * dm ( l ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 nx = u_ambient * wC ; float wG = u_specular_params [ 0 ] ; vec2 wH = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; vec3 wI = wG * u_specular_color ; vec3 m ; vec3 wJ ; wm ( wD , nx , cU , wI , bG , l , cW , wH , u_diffuse_params , vec4 ( 1.0 ) , 0.0 , vec4 ( 0.0 ) , m , wJ ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",c:[{a:"txt",b:"vec3 m = wt . rgb ;".split(" ")}]}}]},{a:"txt",b:"float bf = wt . a * wS ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["ALPHA"],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["ALPHA_CLIP"],h:{a:"grp",c:[{a:"txt",b:"if ( bf < 0.5 ) discard ; bf = 1.0 ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:["bf","=","1.0",";"]}]}}]},{a:"cond",c:[{a:"if",e:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",c:[{a:"txt",b:"vA ( m , length ( bH ) , cW , 1.0 ) ;".split(" ")}]}}]},
{a:"cond",c:[{a:"if",e:["SOFT_PARTICLES"],h:{a:"grp",c:[{a:"txt",b:"float wP = - bH . z / u_view_max_depth ; vec4 dv = GLSL_TEXTURE_PROJ ( u_scene_depth , bK ) ; float dn = ap ( dv ) ; float wQ = dn - wP ; float wR = u_view_max_depth / SOFT_STRENGTH * wQ ; bf = bf * min ( wR , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["be","(","m",")",";"]},{a:"cond",c:[{a:"if",e:["ALPHA","ALPHA_CLIP",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"bh ( m , bf ) ;".split(" ")}]}}]},
{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( m , bf ) ; }".split(" ")}]};a["procedural_skydome.glslf"]={a:"grp",c:[{a:"version",b:["GLSL_VERSION"]},{a:"include",n:"precision_statement.glslf"},{a:"include",n:"color_util.glslf"},{a:"txt",b:"uniform vec3 u_sky_color ; uniform vec3 u_sun_direction ; uniform float u_rayleigh_brightness ; uniform float u_mie_brightness ; uniform float u_spot_brightness ; uniform float u_scatter_strength ; uniform float u_rayleigh_strength ; uniform float u_mie_strength ; uniform float u_rayleigh_collection_power ; uniform float u_mie_collection_power ; uniform float u_mie_distribution ; GLSL_IN vec3 xK ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; const float xL = 0.99 ; const float xM = 1.8 ; const int xN = 8 ; float xR ( vec3 f , vec3 H ) { float a = dot ( H , H ) ; float b = 2.0 * dot ( H , f ) ; float ov = dot ( f , f ) - 1.0 ; float xO = b * b - 4.0 * a * ov ; float xP = sqrt ( xO ) ; float q = ( - b - xP ) / 2.0 ; float xQ = ov / q ; return xQ ; } float sV ( float bf , float g ) { float a = 3.0 * ( 1.0 - g * g ) ; float b = 2.0 * ( 2.0 + g * g ) ; float ov = 1.0 + bf * bf ; float aH = pow ( 1.0 + g * g - 2.0 * g * bf , 1.5 ) ; aH = max ( aH , 0.00001 ) ; return ( a / b ) * ( ov / aH ) ; } float xW ( vec3 f , vec3 H , float xS ) { float xT = dot ( H , - f ) ; if ( xT < 0.0 ) { return 1.0 ; } vec3 xU = f + xT * H ; if ( length ( xU ) < xS ) { return 0.0 ; } else if ( length ( xU ) >= xS ) { vec3 xC = normalize ( xU ) * xS - f ; float xV = acos ( dot ( normalize ( xC ) , H ) ) ; return smoothstep ( 0.0 , 1.0 , pow ( xV * 2.0 , 3.0 ) ) ; } else return 1.0 ; } vec3 xX ( float m_ , vec3 m , float cz ) { return m - m * pow ( u_sky_color , vec3 ( cz / m_ ) ) ; } void main ( ) { vec3 xY = normalize ( xK ) ; vec3 xZ = u_sun_direction ; float bf = dot ( xY , xZ ) ; float x_ = sV ( bf , - 0.01 ) * u_rayleigh_brightness * xZ . y ; float ya = sV ( bf - 0.5 , u_mie_distribution ) * u_mie_brightness * ( 1.0 - xZ . y ) ; float yb = smoothstep ( 0.0 , 100.0 , sV ( bf , 0.9995 ) ) * u_spot_brightness ; vec3 yc = vec3 ( 0.0 , xL , 0.0 ) ; float yd = xR ( yc , xY ) ; float ye = yd / float ( xN ) ; float yf = xW ( yc , xY , xL - 0.3 ) ; vec3 yg = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 yh = vec3 ( 0.0 , 0.0 , 0.0 ) ; for ( int aQ = 0 ; aQ < xN ; aQ ++ ) { float yi = ye * float ( aQ ) ; vec3 f = yc + xY * yi ; float yj = xW ( f , xZ , xL - 0.2 ) ; float yk = xR ( f , xZ ) ; vec3 yl = xX ( yk , vec3 ( xM ) , u_scatter_strength ) * yj ; yg += xX ( sqrt ( yi ) , u_sky_color * yl , u_rayleigh_strength ) ; yh += xX ( yi , yl , u_mie_strength ) ; } yg = yg * yf * pow ( yd , u_rayleigh_collection_power ) / float ( xN ) ; yh = ( yh * yf * pow ( yd , u_mie_collection_power ) ) / float ( xN ) ; vec3 m = vec3 ( yb * yh + ya * yh + x_ * yg ) ; be ( m ) ; GLSL_OUT_FRAG_COLOR = vec4 ( m , 1.0 ) ; }".split(" ")}]};
a["procedural_skydome.glslv"]={a:"grp",c:[{a:"version",b:["GLSL_VERSION"]},{a:"txt",b:"uniform mat4 u_cube_view_matrix ; GLSL_IN vec3 a_position ; GLSL_OUT vec3 xK ; void main ( ) { vec4 f = vec4 ( a_position . xy , 0.999999 , 1.0 ) ; vec4 xY = u_cube_view_matrix * f ; xK = xY . xyz ; gl_Position = f ; }".split(" ")}]};a["shadow.glslf"]={a:"grp",c:[{a:"version",b:["GLSL_VERSION"]},{a:"include",n:"std_enums.glsl"},{a:"include",n:"precision_statement.glslf"},{a:"cond",c:[{a:"if",e:["SHADELESS",{a:"logic_negative_expr",
i:1},"NODES","ALPHA",{a:"logical_and_expr",i:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},{a:"logical_or_expr",i:3}],h:{a:"grp",c:[{a:"include",n:"procedural.glslf"}]}}]},{a:"cond",c:[{a:"if",e:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"include",n:"pack.glslf"},{a:"include",n:"color_util.glslf"},{a:"include",n:"math.glslv"},{a:"cond",c:[{a:"if",e:["CAUSTICS"],h:{a:"grp",c:[{a:"include",n:"caustics.glslf"}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["NODES","ALPHA",{a:"logical_and_expr",
i:2}],h:{a:"grp",c:[{a:"txt",b:"uniform float u_time ; uniform float u_environment_energy ;".split(" ")},{a:"cond",c:[{a:"if",e:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},{a:"txt",b:["uniform","vec3","u_camera_eye_frag",";"]},{a:"cond",c:[{a:"if",e:["REFLECTION_TYPE",
"REFL_PLANE",{a:"equal_expr",i:2},"USE_NODE_GEOMETRY_VW",{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","mat3","u_view_tsr_frag",";"]}]}}]},{a:"cond",c:[{a:"if",e:["USE_ZUP_VIEW_MATRIX"],h:{a:"grp",c:[{a:"txt",b:["uniform","mat3","u_view_zup_tsr",";"]}]}}]},{a:"cond",c:[{a:"if",e:["USE_ZUP_VIEW_MATRIX_INVERSE"],h:{a:"grp",c:[{a:"txt",b:["uniform","mat3","u_view_zup_tsr_inverse",";"]}]}}]},{a:"cond",c:[{a:"if",e:["USE_ZUP_MODEL_MATRIX"],h:{a:"grp",c:[{a:"txt",b:["uniform","mat3","u_model_zup_tsr",
";"]}]}}]},{a:"cond",c:[{a:"if",e:["USE_ZUP_MODEL_MATRIX_INVERSE"],h:{a:"grp",c:[{a:"txt",b:["uniform","mat3","u_model_zup_tsr_inverse",";"]}]}}]},{a:"cond",c:[{a:"if",e:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",e:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"cond",
c:[{a:"if",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","sampler2D","u_plane_reflection",";"]}]}},{a:"elif",e:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","samplerCube","u_cube_reflection",";"]}]}},{a:"elif",e:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"txt",b:"uniform float u_emit ; uniform float u_ambient ; uniform vec4 u_fresnel_params ;".split(" ")},
{a:"cond",c:[{a:"if",e:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}},{a:"elif",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","vec4","u_refl_plane",";"]}]}}]},{a:"cond",c:[{a:"if",e:["USE_NODE_LAMP"],h:{a:"grp",c:[{a:"txt",b:"uniform vec3 u_lamp_light_positions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_directions [ NUM_LAMP_LIGHTS ] ; uniform vec3 u_lamp_light_color_intensities [ NUM_LAMP_LIGHTS ] ; uniform vec4 u_lamp_light_factors [ NUM_LAMP_LIGHTS ] ;".split(" ")}]}}]},
{a:"cond",c:[{a:"if",e:["USE_NODE_VALUE"],h:{a:"grp",c:[{a:"txt",b:"uniform float u_node_values [ NUM_VALUES ] ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["USE_NODE_RGB"],h:{a:"grp",c:[{a:"txt",b:"uniform vec3 u_node_rgbs [ NUM_RGBS ] ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["TEXTURE_COLOR"],h:{a:"grp",c:[{a:"txt",b:"uniform sampler2D u_colormap0 ; uniform float u_alpha_factor ;".split(" ")}]}}]},{a:"txt",b:["uniform","vec4","u_diffuse_color",";"]}]}}]},{a:"cond",c:[{a:"if",
e:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"uniform vec4 u_pcf_blur_radii ; uniform vec4 u_csm_center_dists ; uniform PRECISION sampler2D u_shadow_map0 ;".split(" ")},{a:"cond",c:[{a:"if",e:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_shadow_map1",";"]}]}}]},{a:"cond",c:[{a:"if",e:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],
h:{a:"grp",c:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_shadow_map2",";"]}]}}]},{a:"cond",c:[{a:"if",e:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_shadow_map3",";"]}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","sampler2D","u_shadow_mask",";"]}]}}]},{a:"cond",c:[{a:"if",e:["USE_NODE_B4W_REFRACTION"],h:{a:"grp",
c:[{a:"txt",b:["uniform","sampler2D","u_refractmap",";"]},{a:"cond",c:[{a:"if",e:["USE_REFRACTION","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["USE_NODE_CURVE_VEC","USE_NODE_CURVE_RGB","USE_NODE_VALTORGB",{a:"logical_or_expr",i:3}],h:{a:"grp",c:[{a:"txt",b:["uniform","sampler2D","u_nodes_texture",";"]}]}}]},{a:"cond",c:[{a:"if",e:["NODES","ALPHA",{a:"logical_and_expr",i:2}],
h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec3","bG",";"]},{a:"cond",c:[{a:"if",e:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",i:5}],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec3","bI",";"]}]}}]},{a:"cond",c:[{a:"if",e:["CALC_TBN_SPACE"],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec4","bJ",";"]}]}}]}]}},{a:"else",h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["TEXTURE_COLOR"],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec2","bQ",";"]}]}}]}]}}]},{a:"cond",
c:[{a:"if",e:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"NODES","ALPHA",{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec4","bH",";"]}]}}]},{a:"cond",c:[{a:"if",e:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec4","bM",";"]},{a:"cond",c:[{a:"if",e:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec4","bN",";"]}]}}]},
{a:"cond",c:[{a:"if",e:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec4","bO",";"]}]}}]},{a:"cond",c:[{a:"if",e:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec4","bP",";"]}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec3","bK",
";"]}]}}]},{a:"cond",c:[{a:"if",e:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["USE_NODE_B4W_REFRACTION","USE_REFRACTION",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","float","bL",";"]}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["USE_TBN_SHADING"],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec3","bR",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"cond",c:[{a:"if",e:["SHADELESS",{a:"logic_negative_expr",i:1},"NODES","ALPHA",{a:"logical_and_expr",
i:2},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},{a:"logical_or_expr",i:3}],h:{a:"grp",c:[{a:"include",n:"shadow.glslf"}]}}]},{a:"cond",c:[{a:"if",e:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"include",n:"mirror.glslf"},{a:"include",n:"environment.glslf"},{a:"cond",c:[{a:"if",e:["USE_NODE_B4W_REFRACTION"],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["USE_REFRACTION"],h:{a:"grp",c:[{a:"include",n:"refraction.glslf"}]}}]}]}}]},{a:"include",n:"nodes.glslf"}]}}]},{a:"txt",
b:["void","main","(",")","{"]},{a:"cond",c:[{a:"if",e:["ALPHA"],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["NODES"],h:{a:"grp",c:[{a:"txt",b:"vec3 cW = u_camera_eye_frag - bG ; vec3 dY = normalize ( cW ) ; vec3 ed ; vec3 ee ; vec3 ef ; vec4 eg ; float eh ; mat4 dZ = mat4 ( 0.0 ) ; mat4 d_ = mat4 ( 0.0 ) ; mat4 ea = mat4 ( 0.0 ) ; mat4 eb = mat4 ( 0.0 ) ; mat4 ec = mat4 ( 0.0 ) ;".split(" ")},{a:"cond",c:[{a:"if",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_NODE_GEOMETRY_VW",{a:"logical_or_expr",
i:2}],h:{a:"grp",c:[{a:"txt",b:"dZ = _ ( u_view_tsr_frag ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["USE_ZUP_VIEW_MATRIX"],h:{a:"grp",c:[{a:"txt",b:"d_ = _ ( u_view_zup_tsr ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["USE_ZUP_VIEW_MATRIX_INVERSE"],h:{a:"grp",c:[{a:"txt",b:"ea = _ ( u_view_zup_tsr_inverse ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["USE_ZUP_MODEL_MATRIX"],h:{a:"grp",c:[{a:"txt",b:"eb = _ ( u_model_zup_tsr ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["USE_ZUP_MODEL_MATRIX_INVERSE"],
h:{a:"grp",c:[{a:"txt",b:"ec = _ ( u_model_zup_tsr_inverse ) ;".split(" ")}]}}]},{a:"txt",b:"rs ( dY , dZ , d_ , ea , eb , ec , ed , ee , ef , eg , eh ) ; float bf = eh ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["TEXTURE_COLOR"],h:{a:"grp",c:[{a:"txt",b:"float bf = ( GLSL_TEXTURE ( u_colormap0 , bQ ) ) . a ;".split(" ")},{a:"cond",c:[{a:"if",e:["TEXTURE_BLEND_TYPE","TEXTURE_BLEND_TYPE_MIX",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"float rt = u_alpha_factor * bf ; rt += ( 1.0 - step ( 0.0 , rt ) ) ; bf = mix ( rt , 1.0 , u_diffuse_color . a ) ;".split(" ")}]}}]}]}},
{a:"else",h:{a:"grp",c:[{a:"txt",b:"float bf = u_diffuse_color . a ;".split(" ")}]}}]}]}}]},{a:"txt",b:"if ( bf < 0.5 ) discard ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["SHADOW_USAGE","NO_SHADOWS",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 ) ;".split(" ")}]}},{a:"elif",e:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = cT ( bH . z ) ;".split(" ")}]}}]},
{a:"cond",c:[{a:"if",e:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["CALC_TBN_SPACE"],h:{a:"grp",c:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR . a *= clamp ( bJ . r , 0.999999999 , 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:["}"]}]};a["shadow.glslv"]={a:"grp",c:[{a:"version",b:["GLSL_VERSION"]},{a:"include",n:"std_enums.glsl"},{a:"include",n:"precision_statement.glslf"},{a:"include",n:"math.glslv"},{a:"include",n:"to_world.glslv"},{a:"include",n:"scale_texcoord.glslv"},{a:"txt",
b:["GLSL_IN","vec3","a_position",";"]},{a:"cond",c:[{a:"if",e:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},"SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"CALC_TBN",{a:"logical_or_expr",i:8}],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec3","a_normal",";"]}]}}]},{a:"cond",c:[{a:"if",e:["USE_INSTANCED_PARTCLS"],h:{a:"grp",c:[{a:"txt",b:"GLSL_IN vec4 a_part_ts ; GLSL_IN vec4 a_part_r ;".split(" ")}]}}]},
{a:"cond",c:[{a:"if",e:["NODES","ALPHA","CALC_TBN_SPACE",{a:"logical_and_expr",i:3}],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec4","a_tangent",";"]}]}}]},{a:"cond",c:[{a:"if",e:["USE_TBN_SHADING"],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec3","a_shade_tangs",";"]}]}}]},{a:"cond",c:[{a:"if",e:["SKINNED"],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec4","a_influence",";"]}]}}]},{a:"cond",c:[{a:"if",e:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",
i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["AU_QUALIFIER","vec3","au_center_pos",";"]}]}}]},{a:"cond",c:[{a:"if",e:["WIND_BEND"],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["MAIN_BEND_COL"],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","float","a_bending_col_main",";"]},{a:"cond",c:[{a:"if",e:["DETAIL_BEND"],h:{a:"grp",c:[{a:"txt",b:"GLSL_IN vec3 a_bending_col_detail ; AU_QUALIFIER float au_detail_bending_amp ; AU_QUALIFIER float au_branch_bending_amp ; AU_QUALIFIER float au_detail_bending_freq ;".split(" ")}]}}]}]}}]},
{a:"txt",b:"AU_QUALIFIER float au_wind_bending_amp ; AU_QUALIFIER float au_wind_bending_freq ;".split(" ")},{a:"cond",c:[{a:"if",e:["BEND_CENTER_ONLY"],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec3","a_emitter_center",";"]}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["VERTEX_ANIM"],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec3","a_position_next",";"]},{a:"cond",c:[{a:"if",e:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP",
"CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",i:5}],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec3","a_normal_next",";"]},{a:"cond",c:[{a:"if",e:["CALC_TBN_SPACE"],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec4","a_tangent_next",";"]}]}}]}]}}]}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["NODES","ALPHA",{a:"logical_and_expr",i:2},{a:"logic_negative_expr",i:1},"TEXTURE_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec2","a_texcoord",";"]}]}}]},{a:"cond",c:[{a:"if",e:["NODES","ALPHA",{a:"logical_and_expr",
i:2}],h:{a:"grp",c:[{a:"txt",b:["GLSL_OUT","vec3","bG",";"]},{a:"cond",c:[{a:"if",e:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},{a:"logical_or_expr",i:6}],h:{a:"grp",c:[{a:"txt",b:["GLSL_OUT","vec3","bI",";"]}]}}]},{a:"cond",c:[{a:"if",e:["CALC_TBN_SPACE"],h:{a:"grp",c:[{a:"txt",b:["GLSL_OUT","vec4","bJ",";"]}]}}]}]}},{a:"else",h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["TEXTURE_COLOR"],
h:{a:"grp",c:[{a:"txt",b:["GLSL_OUT","vec2","bQ",";"]}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"NODES","ALPHA",{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["GLSL_OUT","vec4","bH",";"]}]}}]},{a:"cond",c:[{a:"if",e:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["GLSL_OUT","vec4","bM",";"]},{a:"cond",c:[{a:"if",e:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",
i:2}],h:{a:"grp",c:[{a:"txt",b:["GLSL_OUT","vec4","bN",";"]}]}}]},{a:"cond",c:[{a:"if",e:["CSM_SECTION2","NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["GLSL_OUT","vec4","bO",";"]}]}}]},{a:"cond",c:[{a:"if",e:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["GLSL_OUT","vec4","bP",";"]}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",
i:2}],h:{a:"grp",c:[{a:"txt",b:["GLSL_OUT","vec3","bK",";"]}]}}]},{a:"cond",c:[{a:"if",e:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["GLSL_OUT","float","bL",";"]}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["USE_TBN_SHADING"],h:{a:"grp",c:[{a:"txt",b:["GLSL_OUT","vec3","bR",";"]}]}}]},{a:"cond",c:[{a:"if",e:["STATIC_BATCH"],h:{a:"grp",c:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",c:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"cond",c:[{a:"if",e:["SMAA_JITTER"],h:{a:"grp",c:[{a:"txt",b:["uniform","vec2","u_subpixel_jitter",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ;".split(" ")},{a:"cond",c:[{a:"if",e:["DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","vec3","u_camera_eye",";"]}]}}]},{a:"cond",c:[{a:"if",e:["BILLBOARD","SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",
i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","mat3","u_shadow_cast_billboard_view_tsr",";"]}]}}]},{a:"cond",c:[{a:"if",e:["DYNAMIC_GRASS"],h:{a:"grp",c:[{a:"txt",b:"uniform PRECISION sampler2D u_grass_map_depth ; uniform sampler2D u_grass_map_color ; uniform vec4 u_camera_quat ; uniform vec3 u_grass_map_dim ; uniform float u_grass_size ; uniform float u_scale_threshold ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["SKINNED"],h:{a:"grp",c:[{a:"txt",b:"uniform vec4 u_quatsb [ MAX_BONES ] ; uniform vec4 u_transb [ MAX_BONES ] ; uniform vec4 u_arm_rel_trans ; uniform vec4 u_arm_rel_quat ;".split(" ")},
{a:"cond",c:[{a:"if",e:["FRAMES_BLENDING"],h:{a:"grp",c:[{a:"txt",b:"uniform vec4 u_quatsa [ MAX_BONES ] ; uniform vec4 u_transa [ MAX_BONES ] ; uniform float u_frame_factor ;".split(" ")}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["WIND_BEND"],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["BILLBOARD_JITTERED"],h:{a:"grp",c:[{a:"txt",b:"uniform float u_jitter_amp ; uniform float u_jitter_freq ;".split(" ")}]}}]},{a:"txt",b:"uniform vec3 u_wind ; uniform float u_time ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["VERTEX_ANIM"],
h:{a:"grp",c:[{a:"txt",b:["uniform","float","u_va_frame_factor",";"]}]}}]},{a:"cond",c:[{a:"if",e:["NODES","ALPHA",{a:"logical_and_expr",i:2},{a:"logic_negative_expr",i:1},"TEXTURE_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","vec3","u_texture_scale",";"]}]}}]},{a:"cond",c:[{a:"if",e:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","float","u_normal_offset",";"]},{a:"cond",c:[{a:"if",e:["MAC_OS_SHADOW_HACK"],h:{a:"grp",c:[{a:"txt",
b:"uniform mat3 u_v_light_tsr [ NUM_CAST_LAMPS ] ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"uniform vec4 u_v_light_ts [ NUM_CAST_LAMPS ] ; uniform vec4 u_v_light_r [ NUM_CAST_LAMPS ] ;".split(" ")}]}}]},{a:"txt",b:["uniform","mat4","u_p_light_matrix0",";"]},{a:"cond",c:[{a:"if",e:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","mat4","u_p_light_matrix1",";"]}]}}]},{a:"cond",c:[{a:"if",e:["CSM_SECTION2","NUM_CAST_LAMPS",
2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","mat4","u_p_light_matrix2",";"]}]}}]},{a:"cond",c:[{a:"if",e:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","mat4","u_p_light_matrix3",";"]}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["USE_NODE_B4W_REFRACTION"],h:{a:"grp",c:[{a:"txt",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{a:"include",n:"dynamic_grass.glslv"},{a:"include",n:"shadow.glslv"},
{a:"include",n:"skin.glslv"},{a:"include",n:"wind_bending.glslv"},{a:"cond",c:[{a:"if",e:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"include",n:"nodes.glslv"}]}}]},{a:"txt",b:"void main ( ) { mat4 de = _ ( u_view_tsr ) ; vec3 f = a_position ;".split(" ")},{a:"cond",c:[{a:"if",e:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"CALC_TBN_SPACE","USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",
{a:"logical_and_expr",i:3},{a:"logical_or_expr",i:7}],h:{a:"grp",c:[{a:"txt",b:["vec3","l","=","a_normal",";"]}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"vec3 l = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["NODES","ALPHA","CALC_TBN_SPACE",{a:"logical_and_expr",i:3}],h:{a:"grp",c:[{a:"txt",b:"vec3 i = vec3 ( a_tangent ) ; vec3 k = a_tangent [ 3 ] * cross ( l , i ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"vec3 i = vec3 ( 0.0 ) ; vec3 k = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",
c:[{a:"if",e:["VERTEX_ANIM"],h:{a:"grp",c:[{a:"txt",b:"f = mix ( f , a_position_next , u_va_frame_factor ) ;".split(" ")},{a:"cond",c:[{a:"if",e:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE",{a:"logical_or_expr",i:5}],h:{a:"grp",c:[{a:"txt",b:"l = mix ( l , a_normal_next , VERTEX_ANIM_MIX_NORMALS_FACTOR ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["CALC_TBN_SPACE"],
h:{a:"grp",c:[{a:"txt",b:"vec3 tH = vec3 ( a_tangent ) ; vec3 tI = a_tangent_next [ 3 ] * cross ( a_normal_next , tH ) ; i = mix ( i , tH , u_va_frame_factor ) ; k = mix ( k , tI , u_va_frame_factor ) ;".split(" ")}]}}]}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["SKINNED"],h:{a:"grp",c:[{a:"txt",b:"sQ ( f , i , k , l ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["USE_INSTANCED_PARTCLS"],h:{a:"grp",c:[{a:"txt",b:"mat3 uz = mat3 ( a_part_ts [ 0 ] , a_part_ts [ 1 ] , a_part_ts [ 2 ] , a_part_ts [ 3 ] , a_part_r [ 0 ] , a_part_r [ 1 ] , a_part_r [ 2 ] , a_part_r [ 3 ] , 1.0 ) ;".split(" ")},
{a:"cond",c:[{a:"if",e:["STATIC_BATCH"],h:{a:"grp",c:[{a:"txt",b:"mat4 tD = _ ( uz ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"mat4 tD = _ ( ad ( u_model_tsr , uz ) ) ;".split(" ")}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["WIND_BEND","DYNAMIC_GRASS","BILLBOARD",{a:"logical_or_expr",i:3},"USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["vec3","h","=","au_center_pos",";"]}]}},{a:"elif",e:["DYNAMIC_GRASS","USE_INSTANCED_PARTCLS",{a:"logical_and_expr",
i:2}],h:{a:"grp",c:[{a:"txt",b:"vec3 h = a_part_ts . xyz ; f = ( tD * vec4 ( f , 1.0 ) ) . xyz ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"vec3 h = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["USE_INSTANCED_PARTCLS",{a:"logic_negative_expr",i:1},"DYNAMIC_GRASS",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"mat4 tD = _ ( u_model_tsr ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["USE_TBN_SHADING"],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["CALC_TBN"],
h:{a:"grp",c:[{a:"txt",b:"vec3 tE = normalize ( ( tD * vec4 ( a_normal , 0.0 ) ) . xyz ) ; vec3 tF = cross ( vec3 ( 0.0 , 0.0 , 1.0 ) , tE ) ; vec3 tG = cross ( tE , tF ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:["vec3","tG","=","a_shade_tangs",";"]}]}}]}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"vec3 tG = vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["DYNAMIC_GRASS"],h:{a:"grp",c:[{a:"txt",b:"e tJ = uy ( f , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , l , h , u_grass_map_depth , u_grass_map_color , u_grass_map_dim , u_grass_size , u_camera_eye , u_camera_quat , de ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["BILLBOARD"],h:{a:"grp",c:[{a:"txt",b:"vec3 rJ = ( tD * vec4 ( h , 1.0 ) ) . xyz ;".split(" ")},{a:"cond",c:[{a:"if",e:["HAIR_BILLBOARD",{a:"logic_negative_expr",i:1},"SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"mat4 ym = _ ( u_shadow_cast_billboard_view_tsr ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:["mat4","ym","=","de",";"]}]}}]},{a:"cond",c:[{a:"if",e:["BILLBOARD_PRES_GLOB_ORIENTATION",
"STATIC_BATCH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2},"USE_INSTANCED_PARTCLS",{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"mat4 rR = rS ( u_camera_eye , rJ , ym , tD ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"mat4 rR = rQ ( u_camera_eye , rJ , ym ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["WIND_BEND","BILLBOARD_JITTERED",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"rR = rR * rI ( u_wind , u_time , u_jitter_amp , u_jitter_freq , rJ ) ;".split(" ")}]}}]},
{a:"txt",b:"e tJ = rZ ( f - h , h , vec3 ( 0.0 ) , tG , vec3 ( 0.0 ) , l , rR ) ; tJ . h = rJ ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"e tJ = rZ ( f , h , vec3 ( 0.0 ) , tG , vec3 ( 0.0 ) , l , tD ) ;".split(" ")}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["WIND_BEND"],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["vec3","tK","=","a_normal",";"]}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"vec3 tK = vec3 ( 0.0 ) ;".split(" ")}]}}]},
{a:"txt",b:"ty ( tJ . f , tJ . h , tK ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["NODES","ALPHA",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"bG = tJ . f ;".split(" ")},{a:"cond",c:[{a:"if",e:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","USE_NODE_NORMAL_MAP","CAUSTICS","CALC_TBN_SPACE","WIND_BEND","MAIN_BEND_COL","DETAIL_BEND",{a:"logical_and_expr",i:3},{a:"logical_or_expr",i:6}],h:{a:"grp",c:[{a:"txt",b:"bI = tJ . l ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["CALC_TBN_SPACE"],h:{a:"grp",
c:[{a:"txt",b:"float aU = ( dot ( cross ( tJ . l , tJ . i ) , tJ . k ) < 0.0 ) ? - 1.0 : 1.0 ; bJ = vec4 ( tJ . i , aU ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["USE_TBN_SHADING"],h:{a:"grp",c:[{a:"txt",b:"bR = tJ . j ;".split(" ")}]}}]}]}}]},{a:"txt",b:"vec4 vP = de * vec4 ( tJ . f , 1.0 ) ; vec4 T = u_proj_matrix * vP ;".split(" ")},{a:"cond",c:[{a:"if",e:["SMAA_JITTER"],h:{a:"grp",c:[{a:"txt",b:"T . xy += u_subpixel_jitter * T . w ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["NODES","ALPHA",
{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"bK = Y ( T ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["USE_NODE_B4W_REFRACTION","REFRACTIVE",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"bL = - vP . z / u_view_max_depth ;".split(" ")}]}}]},{a:"txt",b:["rs","(",")",";"]}]}},{a:"else",h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["TEXTURE_COLOR"],h:{a:"grp",
c:[{a:"txt",b:"bQ = sa ( a_texcoord , u_texture_scale ) ;".split(" ")}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"vM ( tJ . f , tJ . l ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"NODES","ALPHA",{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["bH","=","vP",";"]}]}}]},{a:"cond",c:[{a:"if",e:["SHADOW_USAGE","SHADOW_CASTING",{a:"equal_expr",
i:2}],h:{a:"grp",c:[{a:"txt",b:"vec2 vH = ( u_proj_matrix * de [ 3 ] ) . xy ; float vI = SHADOW_TEX_RES / 2.0 ; vH = floor ( vH * vI + 0.5 ) / vI - vH ; T . xy += vH ;".split(" ")}]}}]},{a:"txt",b:["gl_Position","=","T",";","}"]}]};a["special_lens_flares.glslf"]={a:"grp",c:[{a:"version",b:["GLSL_VERSION"]},{a:"include",n:"precision_statement.glslf"},{a:"include",n:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_sampler ; GLSL_IN vec2 bQ ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 m = GLSL_TEXTURE ( u_sampler , bQ ) ; be ( m . rgb ) ; bh ( m . rgb , m . a ) ; GLSL_OUT_FRAG_COLOR = m ; }".split(" ")}]};
a["special_lens_flares.glslv"]={a:"grp",c:[{a:"version",b:["GLSL_VERSION"]},{a:"define",d:"LIGHT_INDEX",b:["0"]},{a:"include",n:"math.glslv"},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; GLSL_IN float a_lf_dist ; GLSL_IN vec2 a_lf_bb_vertex ; GLSL_IN vec2 a_texcoord ; GLSL_OUT vec2 bQ ; void main ( ) { mat4 de = _ ( u_view_tsr ) ; bQ = a_texcoord ; vec3 H = normalize ( u_light_directions [ LIGHT_INDEX ] ) ; vec4 T = u_proj_matrix * de * vec4 ( H , 0.0 ) ; T . x /= T . w ; T . y /= T . w ; T += 99999.0 * step ( T . z , 0.0 ) ; T += 100.0 * ( step ( 1.0 , abs ( T . x ) ) + step ( 1.0 , abs ( T . y ) ) ) ; T . x = - a_lf_dist * T . x ; T . y = - a_lf_dist * T . y ; float yn = u_proj_matrix [ 1 ] [ 1 ] / u_proj_matrix [ 0 ] [ 0 ] ; vec2 yo = vec2 ( a_lf_bb_vertex . x / yn , a_lf_bb_vertex . y ) ; if ( a_lf_dist > - 0.999 ) { const float yp = 1.9 ; yo *= ( 1.0 + yp * length ( T . xy ) ) ; } gl_Position = vec4 ( T . xy + yo , 0.999999 , 1.0 ) ; }".split(" ")}]};
a["special_skydome.glslf"]={a:"grp",c:[{a:"version",b:["GLSL_VERSION"]},{a:"define",d:"INV_PI",b:["0.318309886"]},{a:"include",n:"precision_statement.glslf"},{a:"include",n:"color_util.glslf"},{a:"cond",c:[{a:"if",e:["WO_SKYTEX","PROCEDURAL_SKYDOME",{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","samplerCube","u_sky",";"]}]}}]},{a:"cond",c:[{a:"if",e:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",i:1},"WO_SKYTEX",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"include",n:"std_enums.glsl"},
{a:"include",n:"blending.glslf"},{a:"txt",b:"uniform vec4 u_sky_tex_fac ; uniform vec3 u_sky_tex_color ; uniform float u_sky_tex_dvar ; vec3 yZ ( vec3 ys , vec3 yt , float cz , float yV ) { float yu = cz * yV ;".split(" ")},{a:"cond",c:[{a:"if",e:["BLENDTYPE","MIX",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"return yv ( yt , ys , yu ) ;".split(" ")}]}},{a:"elif",e:["BLENDTYPE","ADD",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"return yA ( ys , yt , yu ) ;".split(" ")}]}},{a:"elif",e:["BLENDTYPE",
"SUBTRACT",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"return yB ( ys , yt , yu ) ;".split(" ")}]}},{a:"elif",e:["BLENDTYPE","MULTIPLY",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"return yC ( ys , yt , yu ) ;".split(" ")}]}},{a:"elif",e:["BLENDTYPE","SCREEN",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"return yD ( ys , yt , yu ) ;".split(" ")}]}},{a:"elif",e:["BLENDTYPE","OVERLAY",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"return yE ( ys , yt , yu ) ;".split(" ")}]}},{a:"elif",e:["BLENDTYPE",
"DIFFERENCE",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"return yF ( ys , yt , yu ) ;".split(" ")}]}},{a:"elif",e:["BLENDTYPE","DIVIDE",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"return yG ( ys , yt , yu ) ;".split(" ")}]}},{a:"elif",e:["BLENDTYPE","DARKEN",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"return yH ( ys , yt , yu ) ;".split(" ")}]}},{a:"elif",e:["BLENDTYPE","LIGHTEN",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"return yI ( ys , yt , yu ) ;".split(" ")}]}},{a:"elif",e:["BLENDTYPE",
"HUE",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"return yM ( yt , ys , yu ) ;".split(" ")}]}},{a:"elif",e:["BLENDTYPE","SATURATION",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"return yN ( yt , ys , yu ) ;".split(" ")}]}},{a:"elif",e:["BLENDTYPE","VALUE",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"return yO ( yt , ys , yu ) ;".split(" ")}]}},{a:"elif",e:["BLENDTYPE","COLOR",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"return yP ( yt , ys , yu ) ;".split(" ")}]}},{a:"elif",e:["BLENDTYPE",
"SOFT_LIGHT",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"return yR ( yt , ys , yu ) ;".split(" ")}]}},{a:"elif",e:["BLENDTYPE","LINEAR_LIGHT",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"return yS ( yt , ys , yu ) ;".split(" ")}]}}]},{a:"txt",b:"return vec3 ( 1.0 , 0.0 , 1.0 ) ; } float y_ ( float yT , float yU , float cz , float yV ) { vec3 ys = vec3 ( yT ) , yt = vec3 ( yU ) ; float yu = cz * yV ;".split(" ")},{a:"cond",c:[{a:"if",e:["BLENDTYPE","MIX",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",
b:"return yv ( yt , ys , yu ) . x ;".split(" ")}]}},{a:"elif",e:["BLENDTYPE","ADD",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"return yA ( ys , yt , yu ) . x ;".split(" ")}]}},{a:"elif",e:["BLENDTYPE","SUBTRACT",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"return yB ( ys , yt , yu ) . x ;".split(" ")}]}},{a:"elif",e:["BLENDTYPE","MULTIPLY",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"return yW ( yT , yU , yu , yV ) ;".split(" ")}]}},{a:"elif",e:["BLENDTYPE","SCREEN",{a:"equal_expr",i:2}],
h:{a:"grp",c:[{a:"txt",b:"return yX ( yT , yU , yu , yV ) ;".split(" ")}]}},{a:"elif",e:["BLENDTYPE","OVERLAY",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"return yY ( yT , yU , yu , yV ) ;".split(" ")}]}},{a:"elif",e:["BLENDTYPE","DIFFERENCE",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"return yF ( ys , yt , yu ) . x ;".split(" ")}]}},{a:"elif",e:["BLENDTYPE","DIVIDE",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"return yG ( ys , yt , yu ) . x ;".split(" ")}]}},{a:"elif",e:["BLENDTYPE","DARKEN",
{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"return yH ( ys , yt , yu ) . x ;".split(" ")}]}},{a:"elif",e:["BLENDTYPE","LIGHTEN",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"return yI ( ys , yt , yu ) . x ;".split(" ")}]}},{a:"elif",e:["BLENDTYPE","SOFT_LIGHT",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"return yR ( yt , ys , yu ) . x ;".split(" ")}]}},{a:"elif",e:["BLENDTYPE","LINEAR_LIGHT",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"return yS ( yt , ys , yu ) . x ;".split(" ")}]}}]},
{a:"txt",b:["return","0.0",";","}"]}]}}]},{a:"cond",c:[{a:"if",e:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",i:1}],h:{a:"grp",c:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},"REFLECTION_PASS",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:3}],h:{a:"grp",c:[{a:"txt",b:"uniform vec3 u_camera_eye_frag ; uniform vec4 u_underwater_fog_color_density ;".split(" ")}]}}]},
{a:"txt",b:"GLSL_IN vec3 xK ; GLSL_IN vec2 bQ ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec3 za ; vec3 xY = normalize ( xK ) ;".split(" ")},{a:"cond",c:[{a:"if",e:["PROCEDURAL_SKYDOME"],h:{a:"grp",c:[{a:"txt",b:"za = GLSL_TEXTURE_CUBE ( u_sky , xY ) . rgb ;".split(" ")}]}},{a:"elif",e:["WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",i:2},{a:"logic_negative_expr",i:1}],h:{a:"grp",c:[{a:"txt",b:"za = u_horizon_color ; be ( za ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:["vec3",
"zb",";"]},{a:"cond",c:[{a:"if",e:["WO_SKYPAPER"],h:{a:"grp",c:[{a:"txt",b:"zb = vec3 ( bQ , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"zb = vec3 ( xK . xy , 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:["float","zc","=","0.0",";"]},{a:"cond",c:[{a:"if",e:["WO_SKYBLEND"],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["WO_SKYPAPER"],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["WO_SKYREAL"],h:{a:"grp",c:[{a:"txt",b:"zc = abs ( bQ . y ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"zc = ( bQ . y + 1.0 ) * 0.5 ;".split(" ")}]}}]}]}},
{a:"else",h:{a:"grp",c:[{a:"txt",b:"float bf = acos ( xY . y ) ;".split(" ")},{a:"cond",c:[{a:"if",e:["WO_SKYREAL"],h:{a:"grp",c:[{a:"txt",b:"zc = abs ( bf * INV_PI - 0.5 ) * 2.0 ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"zc = 1.0 - bf * INV_PI ;".split(" ")}]}}]}]}}]}]}}]},{a:"txt",b:"vec3 zd = u_horizon_color ; vec3 ze = u_zenith_color ;".split(" ")},{a:"cond",c:[{a:"if",e:["WO_SKYTEX"],h:{a:"grp",c:[{a:"txt",b:"float zf = 1.0 ; vec4 zg = GLSL_TEXTURE_CUBE ( u_sky , xY ) ; bd ( zg . rgb ) ; zf = zg . a ;".split(" ")},
{a:"cond",c:[{a:"if",e:["MTEX_RGBTOINT"],h:{a:"grp",c:[{a:"txt",b:"zf = bk ( zg ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["MTEX_NEGATIVE"],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["MTEX_RGBTOINT",{a:"logic_negative_expr",i:1}],h:{a:"grp",c:[{a:"txt",b:"zg = vec4 ( vec3 ( 1.0 ) - zg . rgb , zg . a ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"zf = 1.0 - zf ;".split(" ")}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["WOMAP_HORIZ","WOMAP_ZENUP","WOMAP_ZENDOWN",{a:"logical_or_expr",i:3}],h:{a:"grp",c:[{a:"cond",
c:[{a:"if",e:["MTEX_RGBTOINT"],h:{a:"grp",c:[{a:"txt",b:"zg = vec4 ( u_sky_tex_color , 1.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"zf = zg . a ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["WOMAP_HORIZ"],h:{a:"grp",c:[{a:"txt",b:"zd = yZ ( zg . rgb , zd , zf , u_sky_tex_fac [ 1 ] ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["WOMAP_ZENUP","WOMAP_ZENDOWN",{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["float","zh","=","0.0",";"]},{a:"cond",c:[{a:"if",e:["WO_SKYREAL"],h:{a:"grp",
c:[{a:"txt",b:"if ( dot ( zb , vec3 ( 0.0 , 1.0 , 0.0 ) ) >= 0.0 ) {".split(" ")},{a:"cond",c:[{a:"if",e:["WOMAP_ZENUP"],h:{a:"grp",c:[{a:"txt",b:"zh = u_sky_tex_fac [ 2 ] ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:[";"]}]}}]},{a:"txt",b:["}"]},{a:"cond",c:[{a:"if",e:["WOMAP_ZENDOWN"],h:{a:"grp",c:[{a:"txt",b:"else zh = u_sky_tex_fac [ 3 ] ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["WOMAP_ZENUP"],h:{a:"grp",c:[{a:"txt",b:"zh = u_sky_tex_fac [ 2 ] ;".split(" ")}]}},
{a:"elif",e:["WOMAP_ZENDOWN"],h:{a:"grp",c:[{a:"txt",b:"zh = u_sky_tex_fac [ 3 ] ;".split(" ")}]}}]}]}}]},{a:"txt",b:"if ( zh != 0.0 ) ze = yZ ( zg . rgb , ze , zf , zh ) ;".split(" ")}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["WOMAP_BLEND"],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["MTEX_RGBTOINT",{a:"logic_negative_expr",i:1}],h:{a:"grp",c:[{a:"txt",b:"zf = dot ( zg . rgb , vec3 ( 0.2126 , 0.7152 , 0.0722 ) ) ;".split(" ")}]}}]},{a:"txt",b:"zc = y_ ( u_sky_tex_dvar , zc , zf , u_sky_tex_fac [ 0 ] ) ;".split(" ")}]}}]},
{a:"cond",c:[{a:"if",e:["WO_SKYBLEND"],h:{a:"grp",c:[{a:"txt",b:"za = mix ( zd , ze , zc ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:["za","=","zd",";"]}]}}]},{a:"txt",b:["be","(","za",")",";"]}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"be ( zd ) ; be ( ze ) ;".split(" ")},{a:"cond",c:[{a:"if",e:["WO_SKYBLEND"],h:{a:"grp",c:[{a:"txt",b:"za = mix ( zd , ze , zc ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:["za","=","zd",";"]}]}}]}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["WATER_EFFECTS",
"DISABLE_FOG",{a:"logic_negative_expr",i:1},"REFLECTION_PASS",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:3}],h:{a:"grp",c:[{a:"txt",b:"bd ( za ) ; float vp = WATER_LEVEL - u_camera_eye_frag . y ; vec3 vv = vec3 ( 0.0 ) ; vec3 vx = mix ( u_underwater_fog_color_density . rgb , vv , min ( - xY . y , 1.0 ) ) ; vx *= min ( 1.0 - min ( 0.03 * vp , 0.8 ) , 1.0 ) ; float cz = clamp ( sign ( 0.01 * vp - xY . y ) , 0.0 , 1.0 ) ; za = mix ( za , vx , cz ) ; be ( za ) ;".split(" ")}]}}]},{a:"txt",
b:"GLSL_OUT_FRAG_COLOR = vec4 ( za , 1.0 ) ; }".split(" ")}]};a["special_skydome.glslv"]={a:"grp",c:[{a:"version",b:["GLSL_VERSION"]},{a:"txt",b:"uniform mat4 u_sky_vp_inverse ; GLSL_IN vec3 a_position ; GLSL_OUT vec3 xK ;".split(" ")},{a:"cond",c:[{a:"if",e:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",i:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["GLSL_OUT","vec2","bQ",";"]}]}}]},{a:"txt",b:"void main ( ) { vec4 f = vec4 ( a_position . xy , 0.9999999 , 1.0 ) ; vec4 xY = u_sky_vp_inverse * f ; xK = xY . xyz ;".split(" ")},
{a:"cond",c:[{a:"if",e:["PROCEDURAL_SKYDOME",{a:"logic_negative_expr",i:1},"WO_SKYTEX","WO_SKYBLEND",{a:"logical_or_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"bQ = a_position . xy ;".split(" ")}]}}]},{a:"txt",b:["gl_Position","=","f",";","}"]}]};a["special_water.glslf"]={a:"grp",c:[{a:"version",b:["GLSL_VERSION"]},{a:"include",n:"std_enums.glsl"},{a:"include",n:"precision_statement.glslf"},{a:"include",n:"procedural.glslf"},{a:"include",n:"pack.glslf"},{a:"include",n:"color_util.glslf"},
{a:"include",n:"math.glslv"},{a:"define",d:"REFL_BUMP",b:["0.001"]},{a:"define",d:"REFR_BUMP",b:["0.0005"]},{a:"txt",b:["uniform","float","u_time",";"]},{a:"cond",c:[{a:"if",e:["USE_ENVIRONMENT_LIGHT","SKY_TEXTURE",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","samplerCube","u_sky_texture",";"]}]}},{a:"elif",e:["USE_ENVIRONMENT_LIGHT","SKY_COLOR",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"uniform vec3 u_horizon_color ; uniform vec3 u_zenith_color ;".split(" ")}]}}]},{a:"txt",
b:["uniform","float","u_environment_energy",";"]},{a:"cond",c:[{a:"if",e:["NUM_LIGHTS",0,{a:"g_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"uniform vec3 u_light_positions [ NUM_LIGHTS ] ; uniform vec3 u_light_directions [ NUM_LIGHTS ] ; uniform vec3 u_light_color_intensities [ NUM_LIGHTS ] ; uniform vec4 u_light_factors [ NUM_LFACTORS ] ;".split(" ")}]}}]},{a:"txt",b:"uniform vec3 u_sun_intensity ; uniform vec3 u_sun_direction ;".split(" ")},{a:"cond",c:[{a:"if",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",
i:2},"SHORE_SMOOTHING","WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:3}],h:{a:"grp",c:[{a:"txt",b:["uniform","float","u_cam_water_depth",";"]}]}}]},{a:"cond",c:[{a:"if",e:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",c:[{a:"txt",b:["uniform","vec4","u_fog_color_density",";"]},{a:"cond",c:[{a:"if",e:["WATER_EFFECTS"],h:{a:"grp",c:[{a:"txt",b:["uniform","vec4","u_underwater_fog_color_density",";"]}]}}]},{a:"cond",c:[{a:"if",
e:["PROCEDURAL_FOG"],h:{a:"grp",c:[{a:"txt",b:["uniform","mat4","u_cube_fog",";"]}]}}]},{a:"cond",c:[{a:"if",e:["USE_FOG"],h:{a:"grp",c:[{a:"txt",b:["uniform","vec4","u_fog_params",";"]}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","sampler2D","u_normalmap0",";"]}]}}]},{a:"cond",c:[{a:"if",e:["REFRACTIVE"],h:{a:"grp",c:[{a:"txt",b:["uniform","sampler2D","u_refractmap",";"]}]}}]},{a:"cond",c:[{a:"if",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",
i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","sampler2D","u_plane_reflection",";"]}]}},{a:"elif",e:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","samplerCube","u_mirrormap",";"]}]}}]},{a:"cond",c:[{a:"if",e:["SHORE_SMOOTHING"],h:{a:"grp",c:[{a:"txt",b:["uniform","PRECISION","sampler2D","u_scene_depth",";"]}]}}]},{a:"cond",c:[{a:"if",e:["FOAM"],h:{a:"grp",c:[{a:"txt",b:["uniform","sampler2D","u_foam",";"]}]}}]},{a:"txt",b:"uniform vec4 u_diffuse_color ; uniform vec2 u_diffuse_params ; uniform float u_diffuse_intensity ; uniform float u_ambient ; uniform vec4 u_fresnel_params ; uniform vec3 u_specular_color ; uniform vec3 u_specular_params ; uniform vec3 u_shallow_water_col ; uniform vec3 u_shore_water_col ;".split(" ")},
{a:"cond",c:[{a:"if",e:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"uniform float u_water_norm_uv_velocity ; uniform vec2 u_normalmap0_scale ;".split(" ")},{a:"cond",c:[{a:"if",e:["NUM_NORMALMAPS",1,{a:"g_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","vec2","u_normalmap1_scale",";"]},{a:"cond",c:[{a:"if",e:["NUM_NORMALMAPS",2,{a:"g_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","vec2","u_normalmap2_scale",";"]},{a:"cond",c:[{a:"if",e:["NUM_NORMALMAPS",3,{a:"g_expr",i:2}],h:{a:"grp",
c:[{a:"txt",b:["uniform","vec2","u_normalmap3_scale",";"]}]}}]}]}}]}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","float","u_mirror_factor",";"]}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:["uniform","float","u_reflect_factor",";"]}]}}]},{a:"cond",c:[{a:"if",e:["SHORE_SMOOTHING","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","float","u_view_max_depth",";"]}]}}]},
{a:"cond",c:[{a:"if",e:["SHORE_PARAMS"],h:{a:"grp",c:[{a:"txt",b:"uniform float u_water_shallow_col_fac ; uniform float u_water_shore_col_fac ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["FOAM"],h:{a:"grp",c:[{a:"txt",b:"uniform float u_foam_factor ; uniform vec2 u_foam_uv_freq ; uniform vec2 u_foam_mag ; uniform vec2 u_foam_scale ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["REFRACTIVE"],h:{a:"grp",c:[{a:"txt",b:["uniform","float","u_refr_bump",";"]}]}}]},{a:"cond",c:[{a:"if",e:["DEBUG_WIREFRAME"],
h:{a:"grp",c:[{a:"txt",b:"const float tM = 1.0 ; uniform vec3 u_wireframe_edge_color ;".split(" ")}]}}]},{a:"txt",b:"GLSL_IN vec3 vC ; GLSL_IN vec3 bG ;".split(" ")},{a:"cond",c:[{a:"if",e:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2},"GENERATED_MESH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec2","bQ",";"]}]}}]},{a:"cond",c:[{a:"if",e:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"GLSL_IN vec3 bJ ; GLSL_IN vec3 zi ;".split(" ")}]}}]},
{a:"cond",c:[{a:"if",e:["DYNAMIC","NUM_NORMALMAPS",0,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec3","bI",";"]}]}}]},{a:"cond",c:[{a:"if",e:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2},"GENERATED_MESH","DYNAMIC",{a:"logical_and_expr",i:3}],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec3","zj",";"]}]}}]},{a:"cond",c:[{a:"if",e:["SHORE_PARAMS"],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec3","zk",";"]}]}}]},{a:"cond",c:[{a:"if",e:["SHORE_SMOOTHING",
"REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:3}],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec3","bK",";"]}]}}]},{a:"cond",c:[{a:"if",e:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:4}],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","float","bL",";"]}]}}]},{a:"cond",c:[{a:"if",e:["DEBUG_WIREFRAME"],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec3","tL",";"]}]}}]},{a:"cond",
c:[{a:"if",e:["USE_TBN_SHADING"],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec3","bR",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"include",n:"environment.glslf"},{a:"cond",c:[{a:"if",e:["REFRACTIVE","SHORE_SMOOTHING","USE_REFRACTION_CORRECTION",{a:"logical_and_expr",i:3}],h:{a:"grp",c:[{a:"include",n:"refraction.glslf"}]}}]},{a:"cond",c:[{a:"if",e:["DISABLE_FOG",{a:"logic_negative_expr",i:1}],h:{a:"grp",c:[{a:"include",n:"fog.glslf"}]}}]},{a:"txt",b:"vec3 zo ( in vec2 dq , in vec3 l , in vec3 cW , in vec3 zl , out float zm ) { zm = 0.0 ; vec3 cX = reflect ( - cW , l ) ;".split(" ")},
{a:"cond",c:[{a:"if",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"vec2 zn = dq . xy + l . xz * REFL_BUMP / bL ; zm = u_reflect_factor ; vec3 df ; if ( u_cam_water_depth < 0.0 ) {".split(" ")},{a:"cond",c:[{a:"if",e:["DISABLE_FOG",{a:"logic_negative_expr",i:1},"WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"df = u_underwater_fog_color_density . rgb ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"df = u_diffuse_color . rgb ;".split(" ")}]}}]},
{a:"txt",b:"} else { df = GLSL_TEXTURE ( u_plane_reflection , zn ) . rgb ; bd ( df ) ; }".split(" ")}]}},{a:"elif",e:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"zm = u_mirror_factor ; vec3 df = zl * GLSL_TEXTURE_CUBE ( u_mirrormap , cX ) . rgb ; bd ( df ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"zm = u_reflect_factor ; vec3 df = zl * vec3 ( 0.3 , 0.5 , 1.0 ) ; bd ( df ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 c_ = normalize ( cX + cW ) ; float da = 1.0 - dot ( cW , c_ ) ; float cZ = u_fresnel_params [ 3 ] ; float cY = u_fresnel_params [ 2 ] ; float r = cZ + ( 1.0 - cZ ) * pow ( da , cY ) ; zm = min ( zm * r , 1.0 ) ; return df ; }".split(" ")},
{a:"include",n:"lighting_nodes.glslf"},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",c:[{a:"if",e:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"mat3 el = mat3 ( bJ , zi , bI ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["DYNAMIC"],h:{a:"grp",c:[{a:"txt",b:"vec3 l = normalize ( bI ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"vec3 l = vec3 ( 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["DYNAMIC","FOAM",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"cond",
c:[{a:"if",e:["WATER_EFFECTS"],h:{a:"grp",c:[{a:"txt",b:"float vz = bG . y - WATER_LEVEL ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"float vz = bG . y ;".split(" ")}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["GENERATED_MESH"],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["DYNAMIC"],h:{a:"grp",c:[{a:"txt",b:"vec2 bv = vec2 ( zj . x , - zj . z ) + 0.5 ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",
b:"vec2 bv = vec2 ( bG . x , - bG . z ) + 0.5 ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:["vec2","bv","=","bQ",";"]}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"vec3 zp = vec3 ( 0.0 ) ; vec3 zq = GLSL_TEXTURE ( u_normalmap0 , bv * u_normalmap0_scale + vec2 ( 0.3 , 0.5 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; zp += zq ;".split(" ")},{a:"cond",c:[{a:"if",e:["FOAM"],h:{a:"grp",c:[{a:"txt",b:"vec3 zr = vec3 ( 0.0 ) ;".split(" ")},
{a:"cond",c:[{a:"if",e:["NORM_FOAM0"],h:{a:"grp",c:[{a:"txt",b:["zr","+=","zq",";"]}]}}]}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["NUM_NORMALMAPS",1,{a:"g_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"zq = GLSL_TEXTURE ( u_normalmap0 , bv * u_normalmap1_scale + vec2 ( - 0.3 , 0.7 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; zp += zq ;".split(" ")},{a:"cond",c:[{a:"if",e:["FOAM"],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["NORM_FOAM1"],h:{a:"grp",c:[{a:"txt",b:["zr","+=","zq",";"]}]}}]}]}}]}]}}]},{a:"cond",
c:[{a:"if",e:["NUM_NORMALMAPS",2,{a:"g_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"zq = GLSL_TEXTURE ( u_normalmap0 , bv * u_normalmap2_scale + vec2 ( 0.0 , 1.1 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; zp += zq ;".split(" ")},{a:"cond",c:[{a:"if",e:["FOAM"],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["NORM_FOAM2"],h:{a:"grp",c:[{a:"txt",b:["zr","+=","zq",";"]}]}}]}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["NUM_NORMALMAPS",3,{a:"g_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"zq = GLSL_TEXTURE ( u_normalmap0 , bv * u_normalmap3_scale + vec2 ( - 0.66 , - 0.3 ) * u_water_norm_uv_velocity * u_time ) . xyz - 0.5 ; zp += zq ;".split(" ")},
{a:"cond",c:[{a:"if",e:["FOAM"],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["NORM_FOAM3"],h:{a:"grp",c:[{a:"txt",b:["zr","+=","zq",";"]}]}}]}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["FOAM"],h:{a:"grp",c:[{a:"txt",b:"vec3 zs = el * zr ; if ( ! n ( zs , vec3 ( 0.0 ) ) ) zs = normalize ( zs ) ; vec3 zt = mix ( l , zs , 0.2 ) ; zt = normalize ( zt ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["DYNAMIC"],h:{a:"grp",c:[{a:"txt",b:"l = mix ( l , normalize ( el * zp ) , 0.3 ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",c:[{a:"txt",b:"l = mix ( l , normalize ( el * zp ) , 0.5 ) ;".split(" ")}]}}]},{a:"txt",b:"l = normalize ( l ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 cW = normalize ( vC ) ;".split(" ")},{a:"cond",c:[{a:"if",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"vec2 dq = bK . xy / bK . z ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["REFRACTIVE"],h:{a:"grp",c:[{a:"txt",b:"vec2 dp = dq + l . xz * u_refr_bump / bL ;".split(" ")}]}}]},
{a:"cond",c:[{a:"if",e:["SHORE_SMOOTHING"],h:{a:"grp",c:[{a:"txt",b:"float bf = u_diffuse_color . a ; vec4 dv = GLSL_TEXTURE_PROJ ( u_scene_depth , bK ) ; float dn = ap ( dv ) ; float wQ = max ( dn - bL , 0.0 ) ;".split(" ")},{a:"cond",c:[{a:"if",e:["REFRACTIVE"],h:{a:"grp",c:[{a:"txt",b:"float ds = dt ( dn , dp , dq ) ; float zu = max ( ds - bL , 0.0 ) ; float zv = u_view_max_depth / ABSORB * zu ; float zA = min ( bf * zv , 1.0 ) ; bf = min ( 15.0 * bf * u_view_max_depth * wQ , 1.0 ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",c:[{a:"txt",b:"float wR = u_view_max_depth / ABSORB * wQ ; if ( u_cam_water_depth > 0.0 ) bf = min ( bf * wR , 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"float bf = u_diffuse_color . a ;".split(" ")},{a:"cond",c:[{a:"if",e:["REFRACTIVE"],h:{a:"grp",c:[{a:"txt",b:["float","zA","=","bf",";"]}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["REFRACTIVE"],h:{a:"grp",c:[{a:"txt",b:"if ( u_cam_water_depth < 0.0 ) zA = 0.0 ; vec3 dw = GLSL_TEXTURE ( u_refractmap , dp ) . rgb ; bd ( dw ) ;".split(" ")}]}}]},
{a:"cond",c:[{a:"if",e:["SHORE_PARAMS"],h:{a:"grp",c:[{a:"txt",b:"float zB = pow ( min ( zk . b / u_water_shallow_col_fac , 1.0 ) , 0.3 ) ; vec3 wt = mix ( u_shallow_water_col , u_diffuse_color . rgb , zB ) ; zB = pow ( min ( zk . b / u_water_shore_col_fac , 1.0 ) , 0.3 ) ; wt = mix ( u_shore_water_col , wt , zB ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"vec3 wt = u_diffuse_color . rgb ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["FOAM"],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["SHORE_SMOOTHING"],
h:{a:"grp",c:[{a:"txt",b:"float zC = max ( 1.0 - u_view_max_depth * wQ , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"float zC = 1.0 - bf ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["DYNAMIC"],h:{a:"grp",c:[{a:"txt",b:"float zD = max ( vz / WAVES_HEIGHT + 0.1 , 0.0 ) ;".split(" ")},{a:"cond",c:[{a:"if",e:["SHORE_PARAMS"],h:{a:"grp",c:[{a:"txt",b:"vec3 zE = normalize ( vec3 ( zk . r , 0.0 , zk . g ) ) ; vec3 zF = normalize ( mix ( vec3 ( 0.0 , 1.0 , 0.0 ) , zE , 0.8 ) ) ; float zG = 1.25 * max ( dot ( zt , zF ) - 0.2 , 0.0 ) ; zG += max ( dot ( zt , vec3 ( 0.0 , - 1.0 , 0.0 ) ) , 0.0 ) ; zC += zG * ( 1.0 - zk . b ) ; zD *= ( 1.0 - 0.95 * pow ( zk . b , 0.1 ) ) ;".split(" ")}]}}]},
{a:"txt",b:"zC += zD ; zC = min ( u_foam_factor * zC , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:"vec4 zH = GLSL_TEXTURE ( u_foam , u_foam_mag * sin ( u_foam_uv_freq * u_time ) + bv * u_foam_scale ) ;".split(" ")}]}}]},{a:"txt",b:"float wG = u_specular_params [ 0 ] ; vec2 wH = vec2 ( u_specular_params [ 1 ] , u_specular_params [ 2 ] ) ; vec3 wI = wG * u_specular_color ; vec3 wC = u_environment_energy * dm ( l ) ; vec3 nx = u_ambient * wC ; vec3 zl = nx + u_sun_intensity ; float zm ;".split(" ")},{a:"cond",
c:[{a:"if",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"vec3 df = zo ( dq , l , cW , zl , zm ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"vec3 df = zo ( vec2 ( 0.0 ) , l , cW , zl , zm ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 cU = u_diffuse_intensity * wt ; vec3 m ; vec3 wJ ; wm ( vec3 ( 0.0 ) , vec3 ( 0.0 ) , cU , wI , bG , l , cW , wH , u_diffuse_params , vec4 ( 1.0 ) , 0.0 , vec4 ( 0.0 ) , m , wJ ) ;".split(" ")},{a:"cond",c:[{a:"if",e:["DYNAMIC"],
h:{a:"grp",c:[{a:"txt",b:"float zI = max ( dot ( u_sun_direction , - bI ) + SSS_WIDTH , 0.0 ) * max ( dot ( - cW , u_sun_direction ) - 0.5 , 0.0 ) * max ( 0.0 , length ( u_sun_intensity ) - 0.1 ) ; zI = clamp ( SSS_STRENGTH * zI , 0.0 , 1.0 ) ; m = mix ( m , u_shallow_water_col , zI ) ; m = mix ( m , u_shore_water_col , zI ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["REFRACTIVE"],h:{a:"grp",c:[{a:"txt",b:"m = mix ( dw , m , zA ) ;".split(" ")}]}}]},{a:"txt",b:"m = mix ( m , df , zm ) ;".split(" ")},
{a:"cond",c:[{a:"if",e:["FOAM"],h:{a:"grp",c:[{a:"txt",b:"float zJ = mix ( zH . g , zH . r , max ( 4.0 * ( zC - 0.75 ) , 0.0 ) ) ; zJ = mix ( zH . b , zJ , max ( 2.0 * zC - 1.0 , 0.0 ) ) ; zJ = mix ( 0.0 , zJ , zC ) ; m = mix ( m , zl , zJ ) ;".split(" ")}]}}]},{a:"txt",b:["m","+=","wJ",";"]},{a:"cond",c:[{a:"if",e:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"float zK = bL * u_view_max_depth ; float vr = 1.0 ; if ( u_cam_water_depth > 1.0 ) vr = 2.0 ; vA ( m , zK , cW , vr ) ;".split(" ")}]}}]},
{a:"txt",b:["be","(","m",")",";"]},{a:"cond",c:[{a:"if",e:["REFRACTIVE",{a:"logic_negative_expr",i:1}],h:{a:"grp",c:[{a:"txt",b:"bf = max ( bf , wJ . r ) ;".split(" ")},{a:"cond",c:[{a:"if",e:["FOAM"],h:{a:"grp",c:[{a:"txt",b:["bf","+=","zJ",";"]}]}}]}]}},{a:"elif",e:["SHORE_SMOOTHING",{a:"logic_negative_expr",i:1}],h:{a:"grp",c:[{a:"txt",b:["bf","=","1.0",";"]}]}}]},{a:"cond",c:[{a:"if",e:["ALPHA"],h:{a:"grp",c:[{a:"txt",b:"bh ( m , bf ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["DEBUG_WIREFRAME",
1,{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["GLSL1"],h:{a:"grp",c:[{a:"extension",b:["GL_OES_standard_derivatives",":","enable"]}]}}]},{a:"txt",b:"vec3 tT = fwidth ( tL ) ; vec3 tU = smoothstep ( vec3 ( 0.0 ) , tT * tM , tL ) ; float zL = min ( min ( tU . x , tU . y ) , tU . z ) ; zL = clamp ( zL , 0.0 , 1.0 ) ; m = mix ( u_wireframe_edge_color , m , zL ) ; bf = mix ( 1.0 , bf , zL ) ;".split(" ")}]}},{a:"elif",e:["DEBUG_WIREFRAME",2,{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",
b:"vec3 m_ = sign ( tL - vec3 ( 0.02 * tM ) ) ; float zL = 1.0 ; if ( m_ . x < 0.0 || m_ . y < 0.0 || m_ . z < 0.0 ) zL = 0.0 ; m = mix ( u_wireframe_edge_color , m , zL ) ; bf = mix ( 1.0 , bf , zL ) ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( m , bf ) ; }".split(" ")}]};a["special_water.glslv"]={a:"grp",c:[{a:"version",b:["GLSL_VERSION"]},{a:"include",n:"std_enums.glsl"},{a:"include",n:"math.glslv"},{a:"include",n:"to_world.glslv"},{a:"include",n:"scale_texcoord.glslv"},{a:"include",
n:"procedural.glslf"},{a:"txt",b:["GLSL_IN","vec3","a_position",";"]},{a:"cond",c:[{a:"if",e:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"DYNAMIC",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"GLSL_IN vec3 a_normal ; GLSL_IN vec3 a_tangent ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["GENERATED_MESH",{a:"logic_negative_expr",i:1},"NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2},{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec2",
"a_texcoord",";"]}]}}]},{a:"cond",c:[{a:"if",e:["DEBUG_WIREFRAME"],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","float","a_polyindex",";"]}]}}]},{a:"txt",b:"GLSL_OUT vec3 vC ; GLSL_OUT vec3 bG ;".split(" ")},{a:"cond",c:[{a:"if",e:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2},"GENERATED_MESH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["GLSL_OUT","vec2","bQ",";"]}]}}]},{a:"cond",c:[{a:"if",e:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",c:[{a:"txt",
b:"GLSL_OUT vec3 bJ ; GLSL_OUT vec3 zi ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["DYNAMIC","NUM_NORMALMAPS",0,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["GLSL_OUT","vec3","bI",";"]}]}}]},{a:"cond",c:[{a:"if",e:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2},"GENERATED_MESH","DYNAMIC",{a:"logical_and_expr",i:3}],h:{a:"grp",c:[{a:"txt",b:["GLSL_OUT","vec3","zj",";"]}]}}]},{a:"cond",c:[{a:"if",e:["SHORE_PARAMS"],h:{a:"grp",c:[{a:"txt",b:["GLSL_OUT",
"vec3","zk",";"]}]}}]},{a:"cond",c:[{a:"if",e:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE",{a:"logical_or_expr",i:3}],h:{a:"grp",c:[{a:"txt",b:["GLSL_OUT","vec3","bK",";"]}]}}]},{a:"cond",c:[{a:"if",e:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:4}],h:{a:"grp",c:[{a:"txt",b:["GLSL_OUT","float","bL",";"]}]}}]},{a:"cond",c:[{a:"if",e:["DEBUG_WIREFRAME"],h:{a:"grp",
c:[{a:"txt",b:["GLSL_OUT","vec3","tL",";"]}]}}]},{a:"cond",c:[{a:"if",e:["USE_TBN_SHADING"],h:{a:"grp",c:[{a:"txt",b:["GLSL_OUT","vec3","bR",";"]}]}}]},{a:"cond",c:[{a:"if",e:["STATIC_BATCH"],h:{a:"grp",c:[{a:"txt",b:"const mat3 u_model_tsr = mat3 ( 0.0 , 0.0 , 0.0 , 1.0 , 0.0 , 0.0 , 0.0 , 1.0 , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:["uniform","mat3","u_model_tsr",";"]}]}}]},{a:"txt",b:"uniform mat3 u_view_tsr ; uniform mat4 u_proj_matrix ; uniform vec3 u_camera_eye ;".split(" ")},
{a:"cond",c:[{a:"if",e:["DYNAMIC"],h:{a:"grp",c:[{a:"txt",b:"uniform PRECISION float u_time ; uniform vec3 u_wind ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:4}],h:{a:"grp",c:[{a:"txt",b:["uniform","PRECISION","float","u_view_max_depth",";"]}]}}]},{a:"cond",c:[{a:"if",e:["SHORE_PARAMS"],h:{a:"grp",c:[{a:"txt",b:["uniform","sampler2D","u_shore_dist_map",
";"]}]}}]},{a:"cond",c:[{a:"if",e:["SHORE_PARAMS"],h:{a:"grp",c:[{a:"txt",b:"vec3 zQ ( in vec2 rT ) { vec2 zM = 0.5 + vec2 ( ( rT . x - SHORE_MAP_CENTER_X ) / SHORE_MAP_SIZE_X , - ( rT . y + SHORE_MAP_CENTER_Y ) / SHORE_MAP_SIZE_Y ) ; vec4 zN = GLSL_TEXTURE ( u_shore_dist_map , zM ) ; const vec2 aj = vec2 ( 1.0 / 255.0 , 1.0 ) ; float zO = dot ( zN . ba , aj ) ; vec2 zP = normalize ( zN . rg * 2.0 - 1.0 ) ; return vec3 ( zP , zO ) ; }".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["DYNAMIC"],h:{a:"grp",
c:[{a:"define",d:"M_PI",b:["3.14159265359"]},{a:"define",d:"SMALL_WAVES_FAC",b:["0.3"]},{a:"txt",b:"void cm ( inout vec3 rT , in float bm , in vec3 zN ) { float zR = aX ( DST_NOISE_SCALE_0 * ( rT . xz + DST_NOISE_FREQ_0 * bm ) ) * aX ( DST_NOISE_SCALE_1 * ( rT . zx - DST_NOISE_FREQ_1 * bm ) ) ;".split(" ")},{a:"cond",c:[{a:"if",e:["SHORE_PARAMS"],h:{a:"grp",c:[{a:"txt",b:"float zS = WAVES_LENGTH / MAX_SHORE_DIST / M_PI ; float zO = zN . b ; float zT = sqrt ( zO ) ; float zU = max ( zO , DIR_MIN_SHR_FAC ) * sin ( zT / zS + DIR_FREQ * bm ) ; float zV = max ( aX ( DIR_NOISE_SCALE * ( rT . xz + DIR_NOISE_FREQ * bm ) ) , DIR_MIN_NOISE_FAC ) ; zU *= zV ; float zW = WAVES_HEIGHT * mix ( zU , zR , max ( zT , DST_MIN_FAC ) ) ; vec2 zP = zN . rg ; float zX = WAVES_HOR_FAC * zU * max ( MAX_SHORE_DIST / 35.0 * ( 0.05 - zO ) , 0.0 ) ; vec2 zY = zX * zP ;".split(" ")}]}},
{a:"else",h:{a:"grp",c:[{a:"txt",b:"float zW = WAVES_HEIGHT * zR ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["GENERATED_MESH"],h:{a:"grp",c:[{a:"txt",b:"vec2 zZ = 2.0 * ( rT . xz - 0.1 * bm ) ; vec2 z_ = 1.3 * ( rT . zx + 0.03 * bm ) ; float Aa = aI ( 0.5 * ( zZ + z_ ) ) . x - 0.5 ;".split(" ")},{a:"cond",c:[{a:"if",e:["SHORE_PARAMS"],h:{a:"grp",c:[{a:"txt",b:"rT . xz += zY ; Aa *= zO ;".split(" ")}]}}]},{a:"txt",b:"zW += SMALL_WAVES_FAC * Aa ;".split(" ")}]}}]},{a:"txt",b:"rT . y += zW ; }".split(" ")}]}}]},
{a:"txt",b:"void main ( ) { mat4 de = _ ( u_view_tsr ) ; mat4 tD = _ ( u_model_tsr ) ;".split(" ")},{a:"cond",c:[{a:"if",e:["DEBUG_WIREFRAME"],h:{a:"grp",c:[{a:"txt",b:"if ( a_polyindex == 0.0 ) tL = vec3 ( 1.0 , 0.0 , 0.0 ) ; else if ( a_polyindex == 1.0 ) tL = vec3 ( 0.0 , 1.0 , 0.0 ) ; else if ( a_polyindex == 2.0 ) tL = vec3 ( 0.0 , 0.0 , 1.0 ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["GENERATED_MESH"],h:{a:"grp",c:[{a:"txt",b:"vec3 f = a_position ; float Ab = abs ( f . y ) ; vec2 Ac = u_camera_eye . xz - mod ( u_camera_eye . xz , Ab ) ;".split(" ")},
{a:"cond",c:[{a:"if",e:["WATER_EFFECTS"],h:{a:"grp",c:[{a:"txt",b:"f . y = WATER_LEVEL ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"f . y = 0.0 ;".split(" ")}]}}]},{a:"txt",b:"f . xz += Ac ; vec3 vO = f ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["bQ","=","a_texcoord",";"]}]}}]},{a:"txt",b:"e tJ = rZ ( a_position , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , tD ) ; vec3 vO = tJ . f ;".split(" ")}]}}]},
{a:"cond",c:[{a:"if",e:["SHORE_PARAMS"],h:{a:"grp",c:[{a:"txt",b:"zk = zQ ( vO . xz ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["DYNAMIC"],h:{a:"grp",c:[{a:"txt",b:"float Ad = length ( u_wind ) ; float Ae = u_time ; Ae *= Ad ;".split(" ")},{a:"cond",c:[{a:"if",e:["GENERATED_MESH"],h:{a:"grp",c:[{a:"txt",b:"float Af = Ab ; vec3 Ag = vO + vec3 ( Af , 0.0 , 0.0 ) ; vec3 Ah = vO + vec3 ( 0.0 , 0.0 , Af ) ;".split(" ")},{a:"cond",c:[{a:"if",e:["NUM_NORMALMAPS",0,{a:"g_expr",i:2},"FOAM",{a:"logical_or_expr",
i:2}],h:{a:"grp",c:[{a:"txt",b:["zj","=","vO",";"]}]}}]}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"vec3 Ag = vO + vec3 ( 0.05 , 0.0 , 0.0 ) ; vec3 Ah = vO + vec3 ( 0.0 , 0.0 , 0.05 ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["SHORE_PARAMS"],h:{a:"grp",c:[{a:"txt",b:"vec3 Ai = zQ ( Ag . xz ) ; vec3 Aj = zQ ( Ah . xz ) ; cm ( Ag , Ae , Ai ) ; cm ( Ah , Ae , Aj ) ; cm ( vO , Ae , zk ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"cm ( Ag , Ae , vec3 ( 0.0 ) ) ; cm ( Ah , Ae , vec3 ( 0.0 ) ) ; cm ( vO , Ae , vec3 ( 0.0 ) ) ;".split(" ")}]}}]},
{a:"cond",c:[{a:"if",e:["GENERATED_MESH","WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"if ( a_position . y < 0.0 ) {".split(" ")},{a:"cond",c:[{a:"if",e:["WATER_EFFECTS"],h:{a:"grp",c:[{a:"txt",b:"vO . y = WATER_LEVEL - 1.0 ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"vO . y = - 1.0 ;".split(" ")}]}}]},{a:"txt",b:"Ag . y = vO . y ; Ah . y = vO . y ; }".split(" ")}]}}]},{a:"txt",b:"vec3 Ak = normalize ( Ag - vO ) ; vec3 i = normalize ( Ah - vO ) ; bI = normalize ( cross ( i , Ak ) ) ; float Al = dot ( bI , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; float cz = clamp ( 0.8 - Al , 0.0 , 1.0 ) ; bI = mix ( bI , vec3 ( 0.0 , 1.0 , 0.0 ) , cz ) ;".split(" ")}]}}]},
{a:"cond",c:[{a:"if",e:["NUM_NORMALMAPS",0,{a:"g_expr",i:2}],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["DYNAMIC",{a:"logic_negative_expr",i:1}],h:{a:"grp",c:[{a:"txt",b:"vec3 i = a_tangent ; bI = a_normal ;".split(" ")}]}}]},{a:"txt",b:"bJ = i ; zi = cross ( bI , bJ ) ;".split(" ")}]}}]},{a:"txt",b:"bG = vO ; vC = u_camera_eye - vO ; vec4 vP = de * vec4 ( vO , 1.0 ) ; vec4 T = u_proj_matrix * vP ;".split(" ")},{a:"cond",c:[{a:"if",e:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},
"REFRACTIVE",{a:"logical_or_expr",i:3}],h:{a:"grp",c:[{a:"txt",b:"float U = T . x ; float V = T . y ; float W = T . w ; bK . x = ( U + W ) / 2.0 ; bK . y = ( V + W ) / 2.0 ; bK . z = W ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["SHORE_SMOOTHING","REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFRACTIVE","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_or_expr",i:4}],h:{a:"grp",c:[{a:"txt",b:"bL = - vP . z / u_view_max_depth ;".split(" ")}]}}]},{a:"txt",b:["gl_Position","=","T",";","}"]}]};
a["postprocessing/antialiasing.glslf"]={a:"grp",c:[{a:"version",b:["GLSL_VERSION"]},{a:"include",n:"precision_statement.glslf"},{a:"include",n:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_color ; uniform vec2 u_texel_size ; GLSL_IN vec2 bQ ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"define",d:"AA_METHOD_FXAA_LIGHT",b:["1"]},{a:"define",d:"AA_METHOD_FXAA_QUALITY",b:["2"]},{a:"define",d:"AA_QUALITY_LOW",b:["0"]},{a:"define",d:"AA_QUALITY_MEDIUM",b:["1"]},{a:"define",d:"AA_QUALITY_HIGH",
b:["2"]},{a:"cond",c:[{a:"if",e:["AA_METHOD","AA_METHOD_FXAA_LIGHT",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"define",d:"FXAA_REDUCE_MIN",b:["(","1.0","/","128.0",")"]},{a:"define",d:"FXAA_REDUCE_MUL",b:["(","1.0","/","8.0",")"]},{a:"define",d:"FXAA_SPAN_MAX",b:["8.0"]},{a:"txt",b:"vec4 Am ( float x , float y ) { vec2 aY = bQ + vec2 ( x , y ) * u_texel_size ; return GLSL_TEXTURE ( u_color , aY ) ; } vec4 AE ( ) { vec4 An = Am ( - 1.0 , - 1.0 ) ; vec4 Ao = Am ( 1.0 , - 1.0 ) ; vec4 Ap = Am ( - 1.0 , 1.0 ) ; vec4 Aq = Am ( 1.0 , 1.0 ) ; vec4 Ar = Am ( 0.0 , 0.0 ) ; float As = bk ( Ar ) ; float At = bk ( An ) ; float Au = bk ( Ao ) ; float Av = bk ( Ap ) ; float Aw = bk ( Aq ) ; float Ax = min ( As , min ( min ( At , Au ) , min ( Av , Aw ) ) ) ; float Ay = max ( As , max ( max ( At , Au ) , max ( Av , Aw ) ) ) ; vec2 H ; H . x = - ( ( At + Au ) - ( Av + Aw ) ) ; H . y = ( ( At + Av ) - ( Au + Aw ) ) ; float Az = max ( ( At + Au + Av + Aw ) * ( 0.25 * FXAA_REDUCE_MUL ) , FXAA_REDUCE_MIN ) ; float AA = 1.0 / ( min ( abs ( H . x ) , abs ( H . y ) ) + Az ) ; H = min ( vec2 ( FXAA_SPAN_MAX , FXAA_SPAN_MAX ) , max ( vec2 ( - FXAA_SPAN_MAX , - FXAA_SPAN_MAX ) , H * AA ) ) * u_texel_size ; vec4 AB = 0.5 * ( GLSL_TEXTURE ( u_color , bQ + H * ( 1.0 / 3.0 - 0.5 ) ) + GLSL_TEXTURE ( u_color , bQ + H * ( 2.0 / 3.0 - 0.5 ) ) ) ; vec4 AC = AB * 0.5 + 0.25 * ( GLSL_TEXTURE ( u_color , bQ + H * - 0.5 ) + GLSL_TEXTURE ( u_color , bQ + H * 0.5 ) ) ; float AD = bk ( AC ) ; if ( ( AD < Ax ) || ( AD > Ay ) ) return AB ; else return AC ; }".split(" ")}]}},
{a:"elif",e:["AA_METHOD","AA_METHOD_FXAA_QUALITY",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"define",d:"FXAA_GREEN_AS_LUMA",b:["1"]},{a:"define",d:"FXAA_BLEND4WEB",b:["1"]},{a:"include",n:"fxaa.glslf"},{a:"cond",c:[{a:"if",e:["AA_QUALITY","AA_QUALITY_HIGH",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"define",d:"FXAA_QUALITY_PRESET",b:["39"]},{a:"define",d:"FXAA_QUALITY_SUBPIX",b:["1.00"]},{a:"define",d:"FXAA_QUALITY_EDGE_THRESHOLD",b:["0.063"]},{a:"define",d:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",b:["0.0312"]}]}},
{a:"elif",e:["AA_QUALITY","AA_QUALITY_MEDIUM",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"define",d:"FXAA_QUALITY_PRESET",b:["20"]},{a:"define",d:"FXAA_QUALITY_SUBPIX",b:["0.65"]},{a:"define",d:"FXAA_QUALITY_EDGE_THRESHOLD",b:["0.166"]},{a:"define",d:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",b:["0.0625"]}]}},{a:"elif",e:["AA_QUALITY","AA_QUALITY_LOW",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"define",d:"FXAA_QUALITY_PRESET",b:["12"]},{a:"define",d:"FXAA_QUALITY_SUBPIX",b:["0.50"]},{a:"define",d:"FXAA_QUALITY_EDGE_THRESHOLD",
b:["0.166"]},{a:"define",d:"FXAA_QUALITY_EDGE_THRESHOLD_MIN",b:["0.0833"]}]}}]}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",c:[{a:"if",e:["AA_METHOD","AA_METHOD_FXAA_LIGHT",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = AE ( ) ;".split(" ")}]}},{a:"elif",e:["AA_METHOD","AA_METHOD_FXAA_QUALITY",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"vec2 Cm = u_texel_size ; GLSL_OUT_FRAG_COLOR = Cl ( bQ , u_color , Cm , FXAA_QUALITY_SUBPIX , FXAA_QUALITY_EDGE_THRESHOLD , FXAA_QUALITY_EDGE_THRESHOLD_MIN ) ;".split(" ")}]}}]},
{a:"txt",b:["}"]}]};a["postprocessing/bloom_blur.glslf"]={a:"grp",c:[{a:"version",b:["GLSL_VERSION"]},{a:"include",n:"precision_statement.glslf"},{a:"txt",b:"uniform vec2 u_texel_size ; uniform sampler2D u_color ; GLSL_IN vec2 bQ ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec2 cm = vec2 ( 0.0 , 0.0 ) ; vec2 wQ = u_texel_size ; vec4 Cn = GLSL_TEXTURE ( u_color , bQ ) ; GLSL_OUT_FRAG_COLOR = Cn * 0.0875447373698 ; cm += wQ ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , bQ + cm ) * 0.0858112354248 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , bQ - cm ) * 0.0858112354248 ; cm += wQ ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , bQ + cm ) * 0.0808139781061 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , bQ - cm ) * 0.0808139781061 ; cm += wQ ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , bQ + cm ) * 0.0731235112908 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , bQ - cm ) * 0.0731235112908 ; cm += wQ ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , bQ + cm ) * 0.0635705267419 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , bQ - cm ) * 0.0635705267419 ; cm += wQ ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , bQ + cm ) * 0.0530985673112 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , bQ - cm ) * 0.0530985673112 ; cm += wQ ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , bQ + cm ) * 0.0426125984122 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , bQ - cm ) * 0.0426125984122 ; cm += wQ ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , bQ + cm ) * 0.0328565115809 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , bQ - cm ) * 0.0328565115809 ; cm += wQ ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , bQ + cm ) * 0.0243407024472 ; GLSL_OUT_FRAG_COLOR += GLSL_TEXTURE ( u_color , bQ - cm ) * 0.0243407024472 ; GLSL_OUT_FRAG_COLOR = max ( 0.7 * Cn , GLSL_OUT_FRAG_COLOR ) ; }".split(" ")}]};
a["postprocessing/bloom_combine.glslf"]={a:"grp",c:[{a:"version",b:["GLSL_VERSION"]},{a:"include",n:"precision_statement.glslf"},{a:"txt",b:"uniform sampler2D u_main ; uniform sampler2D u_bloom ; GLSL_IN vec2 bQ ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 Co = GLSL_TEXTURE ( u_main , bQ ) ; vec4 Cp = GLSL_TEXTURE ( u_bloom , bQ ) ; GLSL_OUT_FRAG_COLOR = Co + Cp ; }".split(" ")}]};a["postprocessing/coc.glslf"]={a:"grp",c:[{a:"version",b:["GLSL_VERSION"]},{a:"txt",b:["precision","PRECISION",
"sampler2D",";"]},{a:"include",n:"precision_statement.glslf"},{a:"include",n:"std_enums.glsl"},{a:"include",n:"depth_fetch.glslf"},{a:"txt",b:"uniform sampler2D u_color ; uniform sampler2D u_depth ;".split(" ")},{a:"cond",c:[{a:"if",e:["COC_TYPE","COC_COMBINE",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","sampler2D","u_coc_fg",";"]}]}}]},{a:"txt",b:"uniform float u_view_max_depth ; uniform float u_dof_dist ; uniform float u_dof_front_start ; uniform float u_dof_front_end ; uniform float u_dof_rear_start ; uniform float u_dof_rear_end ; uniform vec2 u_camera_range ; GLSL_IN vec2 bQ ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 m = GLSL_TEXTURE ( u_color , bQ ) ; if ( u_dof_dist > 0.0 ) { float ao = Cu ( u_depth , bQ , u_camera_range ) ; ao *= u_view_max_depth ; float Cv = 0.0 ;".split(" ")},
{a:"cond",c:[{a:"if",e:["COC_TYPE","COC_COMBINE",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"vec4 Cw = GLSL_TEXTURE ( u_coc_fg , bQ ) ; float Cx = Cw . a ;".split(" ")}]}}]},{a:"txt",b:"if ( ao < u_dof_dist ) Cv = ( u_dof_dist - ao - u_dof_front_start ) / ( u_dof_front_end - u_dof_front_start ) ;".split(" ")},{a:"cond",c:[{a:"if",e:["COC_TYPE","COC_FOREGROUND",{a:"non_equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"else Cv = ( ao - u_dof_dist - u_dof_rear_start ) / ( u_dof_rear_end - u_dof_rear_start ) ;".split(" ")}]}}]},
{a:"txt",b:"Cv = clamp ( Cv , 0.0 , 1.0 ) ;".split(" ")},{a:"cond",c:[{a:"if",e:["COC_TYPE","COC_COMBINE",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"Cv = max ( Cv , Cx ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["COC_TYPE","COC_FOREGROUND",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( Cv ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( m . xyz * Cv , Cv ) ;".split(" ")}]}}]},{a:"txt",b:"} else GLSL_OUT_FRAG_COLOR = vec4 ( m . xyz , 0.0 ) ; }".split(" ")}]};
a["postprocessing/compositing.glslf"]={a:"grp",c:[{a:"version",b:["GLSL_VERSION"]},{a:"include",n:"precision_statement.glslf"},{a:"include",n:"color_util.glslf"},{a:"define",d:"PI_4",b:["0.785398163"]},{a:"txt",b:"uniform sampler2D u_color ; uniform float u_brightness ; uniform float u_contrast ; uniform float u_exposure ; uniform float u_saturation ; GLSL_IN vec2 bQ ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 Cy = GLSL_TEXTURE ( u_color , bQ ) ; vec3 m = Cy . rgb ; if ( u_brightness < 0.0 ) m = m * ( 1.0 + u_brightness ) ; else m = m + ( ( 1.0 - m ) * u_brightness ) ; m = ( m - 0.5 ) * ( tan ( ( u_contrast + 1.0 ) * PI_4 ) ) + 0.5 ; m *= u_exposure ; float xM = bk ( vec4 ( m , 0.0 ) ) ; m = mix ( vec3 ( xM ) , m , u_saturation ) ; GLSL_OUT_FRAG_COLOR = vec4 ( m , Cy . a ) ; }".split(" ")}]};
a["postprocessing/depth_pack.glslf"]={a:"grp",c:[{a:"version",b:["GLSL_VERSION"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",n:"precision_statement.glslf"},{a:"include",n:"pack.glslf"},{a:"include",n:"depth_fetch.glslf"},{a:"txt",b:"uniform sampler2D u_depth ; uniform vec2 u_camera_range ; GLSL_IN vec2 bQ ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { GLSL_OUT_FRAG_COLOR = am ( clamp ( Cu ( u_depth , bQ , u_camera_range ) , 0.0 , 0.999999 ) ) ; }".split(" ")}]};a["postprocessing/dof.glslf"]=
{a:"grp",c:[{a:"version",b:["GLSL_VERSION"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",n:"precision_statement.glslf"},{a:"include",n:"std_enums.glsl"},{a:"cond",c:[{a:"if",e:["DOF_TYPE","DOF_BOKEH",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"uniform highp sampler2D u_sharp ; uniform highp sampler2D u_blurred1 ; uniform highp sampler2D u_blurred2 ; uniform float u_dof_dist ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"include",n:"depth_fetch.glslf"},{a:"txt",b:"uniform sampler2D u_sharp ; uniform sampler2D u_blurred ; uniform sampler2D u_depth ; uniform float u_view_max_depth ; uniform float u_dof_dist ; uniform float u_dof_front_end ; uniform float u_dof_rear_end ; uniform vec2 u_camera_range ;".split(" ")}]}}]},
{a:"txt",b:"GLSL_IN vec2 bQ ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 Cz = GLSL_TEXTURE ( u_sharp , bQ ) ; if ( u_dof_dist > 0.0 ) {".split(" ")},{a:"cond",c:[{a:"if",e:["DOF_TYPE","DOF_BOKEH",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"float Cv ; vec4 CA = GLSL_TEXTURE ( u_blurred1 , bQ ) ; vec4 CB = GLSL_TEXTURE ( u_blurred2 , bQ ) ; vec4 CC = min ( CA . rgba , CB . rgba ) ; Cv = CC . a ; if ( Cv > 0.0 ) { CC = vec4 ( CC . rgb / Cv , Cz . a ) ; GLSL_OUT_FRAG_COLOR = mix ( Cz , CC , min ( Cv * 5.0 , 1.0 ) ) ; } else GLSL_OUT_FRAG_COLOR = Cz ;".split(" ")}]}},
{a:"elif",e:["DOF_TYPE","DOF_SIMPLE",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"float ao = Cu ( u_depth , bQ , u_camera_range ) ; ao *= u_view_max_depth ; float CD ; if ( ao < u_dof_dist ) CD = ( u_dof_dist - ao ) / u_dof_front_end ; else CD = ( ao - u_dof_dist ) / u_dof_rear_end ; CD = clamp ( CD , 0.0 , 1.0 ) ; vec4 CE = GLSL_TEXTURE ( u_blurred , bQ ) ; GLSL_OUT_FRAG_COLOR = mix ( Cz , CE , CD ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:["GLSL_OUT_FRAG_COLOR","=","Cz",";"]}]}}]},
{a:"txt",b:"} else GLSL_OUT_FRAG_COLOR = Cz ; }".split(" ")}]};a["postprocessing/glow.glslf"]={a:"grp",c:[{a:"version",b:["GLSL_VERSION"]},{a:"include",n:"precision_statement.glslf"},{a:"txt",b:"uniform sampler2D u_src_color ; uniform sampler2D u_glow_mask_small ; uniform sampler2D u_glow_mask_large ; uniform float u_glow_mask_small_coeff ; uniform float u_glow_mask_large_coeff ; GLSL_IN vec2 bQ ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 CF = GLSL_TEXTURE ( u_src_color , bQ ) ; vec4 CG = GLSL_TEXTURE ( u_glow_mask_small , bQ ) ; vec4 CH = GLSL_TEXTURE ( u_glow_mask_large , bQ ) ; GLSL_OUT_FRAG_COLOR = CF ; if ( CH . a != 0.0 ) { float CI = u_glow_mask_large_coeff * CH . a ; CI = clamp ( CI , 0.0 , 1.0 ) ; GLSL_OUT_FRAG_COLOR . rgb = mix ( GLSL_OUT_FRAG_COLOR . rgb , CH . rgb / CH . a , CI ) ; GLSL_OUT_FRAG_COLOR . a = mix ( GLSL_OUT_FRAG_COLOR . a , 1.0 , CI ) ; } if ( CG . a != 0.0 ) { float CJ = u_glow_mask_small_coeff * CG . a ; CJ = clamp ( CJ , 0.0 , 1.0 ) ; GLSL_OUT_FRAG_COLOR . rgb = mix ( GLSL_OUT_FRAG_COLOR . rgb , CG . rgb / CG . a , CJ ) ; GLSL_OUT_FRAG_COLOR . a = mix ( GLSL_OUT_FRAG_COLOR . a , 1.0 , CJ ) ; } }".split(" ")}]};
a["postprocessing/god_rays.glslf"]={a:"grp",c:[{a:"version",b:["GLSL_VERSION"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",n:"precision_statement.glslf"},{a:"include",n:"depth_fetch.glslf"},{a:"include",n:"procedural.glslf"},{a:"include",n:"pack.glslf"},{a:"txt",b:"uniform float u_time ; uniform float u_radial_blur_step ; uniform sampler2D u_input ;".split(" ")},{a:"cond",c:[{a:"if",e:["DEPTH_RGBA"],h:{a:"grp",c:[{a:"txt",b:["uniform","vec2","u_camera_range",";"]}]}}]},{a:"cond",
c:[{a:"if",e:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"GLSL_IN float CK ; GLSL_IN vec2 CL ;".split(" ")}]}}]},{a:"txt",b:"GLSL_IN vec2 bQ ; GLSL_IN vec4 CM ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec2 wQ = ( CM . xy - bQ ) ; float m_ = length ( wQ ) ; vec2 CN = u_radial_blur_step * wQ / m_ ; float CO = m_ / u_radial_blur_step ; CN *= min ( CO , STEPS_PER_PASS ) / STEPS_PER_PASS ; CO = max ( CO , STEPS_PER_PASS ) ; vec2 dI = bQ ; float CP = 0.0 ; const int CQ = int ( STEPS_PER_PASS ) ; int CR = int ( CO + 0.5 ) ; for ( int aQ = 0 ; aQ < CQ ; aQ += 1 ) { if ( aQ <= CR ) {".split(" ")},
{a:"cond",c:[{a:"if",e:["DEPTH_RGBA"],h:{a:"grp",c:[{a:"txt",b:"float ao = Cu ( u_input , dI , u_camera_range ) ; CP += max ( ( 1.0 - pow ( m_ , 0.3 ) ) * step ( 0.9 , ao ) , 0.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"vec4 CS = GLSL_TEXTURE ( u_input , dI ) ; CP += ap ( CS ) ;".split(" ")}]}}]},{a:"txt",b:"} dI += CN ; }".split(" ")},{a:"cond",c:[{a:"if",e:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"vec2 bv = bQ + CL ; float CT = aI ( vec2 ( 2.5 * ( bv . x ) , 2.5 * ( bv . y ) + 1.0 * u_time ) ) . x + 0.75 * aI ( vec2 ( 5.0 * ( bv . x ) - 0.66 * u_time , 5.0 * ( bv . y ) + 0.66 * u_time ) ) . x + 0.5 * aX ( vec2 ( 7.5 * ( bv . x ) + 0.33 * u_time , 7.5 * ( bv . y ) - 0.33 * u_time ) ) ; CT *= clamp ( 1.2 - sqrt ( 0.2 * m_ ) , 0.0 , 1.0 ) * CK ; CP = max ( CT , CP ) ;".split(" ")}]}}]},
{a:"txt",b:"GLSL_OUT_FRAG_COLOR = am ( CP / STEPS_PER_PASS ) ; }".split(" ")}]};a["postprocessing/god_rays.glslv"]={a:"grp",c:[{a:"version",b:["GLSL_VERSION"]},{a:"include",n:"math.glslv"},{a:"txt",b:"uniform mat4 u_view_proj_matrix ; uniform vec3 u_sun_direction ;".split(" ")},{a:"cond",c:[{a:"if",e:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"uniform vec4 u_camera_quat ; uniform float u_cam_water_depth ;".split(" ")}]}}]},{a:"txt",b:["GLSL_IN","vec2","a_bb_vertex",
";"]},{a:"cond",c:[{a:"if",e:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"GLSL_OUT float CK ; GLSL_OUT vec2 CL ;".split(" ")}]}}]},{a:"txt",b:"GLSL_OUT vec2 bQ ; GLSL_OUT vec4 CM ; void main ( ) { bQ = a_bb_vertex + 0.5 ; vec3 H = normalize ( u_sun_direction ) ; CM = u_view_proj_matrix * vec4 ( H , 0.0 ) ;".split(" ")},{a:"cond",c:[{a:"if",e:["DEPTH_RGBA","WATER_EFFECTS",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"if ( u_cam_water_depth < 0.0 ) { CK = 1.0 ; vec3 CU = vec3 ( 0.0 , 1.0 , 0.0 ) ; vec3 CV = u ( u_camera_quat , CU ) ; CV = normalize ( CV ) ; float CW = dot ( CV , vec3 ( 0.0 , 1.0 , 0.0 ) ) ; float CX = atan ( CV . x , CV . z ) ; CL = vec2 ( - CX , acos ( CW ) ) ; } else { CK = 0.0 ; }".split(" ")}]}}]},
{a:"txt",b:"CM . xy = 0.5 * ( CM . xy / CM . w + 1.0 ) ; CM += 99999.0 * step ( CM . z , 0.0 ) ; gl_Position = vec4 ( 2.0 * a_bb_vertex . xy , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/god_rays_combine.glslf"]={a:"grp",c:[{a:"version",b:["GLSL_VERSION"]},{a:"include",n:"precision_statement.glslf"},{a:"include",n:"color_util.glslf"},{a:"include",n:"pack.glslf"},{a:"txt",b:"uniform sampler2D u_main ; uniform sampler2D u_god_rays ; uniform float u_god_rays_intensity ; uniform vec3 u_sun_intensity ; GLSL_IN vec2 bQ ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 CY = GLSL_TEXTURE ( u_main , bQ ) ; vec3 CZ = clamp ( u_sun_intensity , 0.4 , 0.8 ) ; bd ( CY . rgb ) ; float C_ = ap ( GLSL_TEXTURE ( u_god_rays , bQ ) ) ; vec3 Da = CY . rgb + u_god_rays_intensity * vec3 ( C_ ) * CZ ; be ( Da ) ;".split(" ")},
{a:"cond",c:[{a:"if",e:["SAFARI_CANVAS_ALPHA_HACK"],h:{a:"grp",c:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( Da , max ( 0.01 , CY . a ) ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( Da , CY . a ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]};a["postprocessing/luminance.glslf"]={a:"grp",c:[{a:"version",b:["GLSL_VERSION"]},{a:"include",n:"precision_statement.glslf"},{a:"txt",b:"uniform sampler2D u_input ; GLSL_IN vec2 bQ ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 Co = GLSL_TEXTURE ( u_input , bQ ) ; float Db = dot ( Co . rgb , vec3 ( 0.2126 , 0.7152 , 0.0722 ) ) ; GLSL_OUT_FRAG_COLOR = vec4 ( vec3 ( Db ) , 1.0 ) ; }".split(" ")}]};
a["postprocessing/luminance_av.glslf"]={a:"grp",c:[{a:"version",b:["GLSL_VERSION"]},{a:"include",n:"precision_statement.glslf"},{a:"txt",b:"uniform sampler2D u_input ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { float Db ; float Dc = 0.0 ; float w = 0.025 ; float aV = 0.025 ; for ( int aQ = 0 ; aQ < 20 ; aQ += 1 ) { aV = 0.025 ; for ( int Dd = 0 ; Dd < 20 ; Dd += 1 ) { Db = max ( GLSL_TEXTURE ( u_input , vec2 ( w , aV ) ) . r , 0.01 ) ; Dc += log ( Db ) ; aV += 0.05 ; } w += 0.05 ; } float De = exp ( Dc / 400.0 ) ; GLSL_OUT_FRAG_COLOR = vec4 ( vec3 ( De ) , 1.0 ) ; }".split(" ")}]};
a["postprocessing/luminance_trunced.glslf"]={a:"grp",c:[{a:"version",b:["GLSL_VERSION"]},{a:"include",n:"precision_statement.glslf"},{a:"txt",b:"uniform sampler2D u_main ; uniform sampler2D u_luminance ; uniform sampler2D u_average_lum ; uniform float u_bloom_edge_lum ; GLSL_IN vec2 bQ ; GLSL_IN float Df ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { float De = GLSL_TEXTURE ( u_average_lum , vec2 ( 0.5 ) ) . r ; float Dg = GLSL_TEXTURE ( u_luminance , bQ ) . r ; vec4 m = GLSL_TEXTURE ( u_main , bQ ) ; float Dh = Dg / De ; float Di = u_bloom_edge_lum ; GLSL_OUT_FRAG_COLOR = m * max ( Dh - Di , 0.0 ) * Df ; }".split(" ")}]};
a["postprocessing/luminance_trunced.glslv"]={a:"grp",c:[{a:"version",b:["GLSL_VERSION"]},{a:"txt",b:"uniform vec4 u_camera_quat ; uniform vec3 u_sun_direction ; uniform float u_bloom_key ; const vec3 CU = vec3 ( 0.0 , 1.0 , 0.0 ) ; GLSL_IN vec2 a_position ; GLSL_OUT vec2 bQ ; GLSL_OUT float Df ; void Dn ( in vec4 v , in vec3 C , out vec3 D ) { float Dj = v . w * C . x + v . y * C . z - v . z * C . y ; float Dk = v . w * C . y + v . z * C . x - v . x * C . z ; float Dl = v . w * C . z + v . x * C . y - v . y * C . x ; float Dm = - v . x * C . x - v . y * C . y - v . z * C . z ; D . x = Dj * v . w - Dm * v . x - Dk * v . z + Dl * v . y ; D . y = Dk * v . w - Dm * v . y - Dl * v . x + Dj * v . z ; D . z = Dl * v . w - Dm * v . z - Dj * v . y + Dk * v . x ; } void main ( ) { bQ = 2.0 * a_position ; vec3 CV ; Dn ( u_camera_quat , CU , CV ) ; Df = dot ( - CV , u_sun_direction ) * u_bloom_key ; Df *= max ( sign ( u_sun_direction . y ) , 0.0 ) ; gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};
a["postprocessing/motion_blur.glslf"]={a:"grp",c:[{a:"version",b:["GLSL_VERSION"]},{a:"include",n:"precision_statement.glslf"},{a:"txt",b:"uniform sampler2D u_mb_tex_curr ; uniform sampler2D u_mb_tex_accum ; uniform float u_motion_blur_exp ; uniform float u_motion_blur_decay_threshold ; float Do = 0.0042 ; GLSL_IN vec2 bQ ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 Dp = GLSL_TEXTURE ( u_mb_tex_curr , bQ ) ; vec4 Dq = GLSL_TEXTURE ( u_mb_tex_accum , bQ ) ; if ( length ( Dp - Dq ) > u_motion_blur_decay_threshold ) { vec4 Dr = ( 1.0 - u_motion_blur_exp ) * Dp + u_motion_blur_exp * Dq ; vec4 Ds = Dr - Dq ; vec4 Dt = Dp - Dq ; vec4 wQ = min ( max ( abs ( Ds ) , vec4 ( Do ) ) , abs ( Dt ) ) * sign ( Ds ) ; GLSL_OUT_FRAG_COLOR = Dq + wQ ; } else { GLSL_OUT_FRAG_COLOR = Dp ; } }".split(" ")}]};
a["postprocessing/outline.glslf"]={a:"grp",c:[{a:"version",b:["GLSL_VERSION"]},{a:"include",n:"precision_statement.glslf"},{a:"include",n:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_outline_src ; uniform sampler2D u_outline_mask ; uniform sampler2D u_outline_mask_blurred ; uniform vec3 u_outline_color ; uniform float u_draw_outline ; GLSL_IN vec2 bQ ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 Du = GLSL_TEXTURE ( u_outline_src , bQ ) ; GLSL_OUT_FRAG_COLOR = Du ; if ( u_draw_outline != 0.0 ) { vec4 Dv = GLSL_TEXTURE ( u_outline_mask , bQ ) ; vec4 Dw = GLSL_TEXTURE ( u_outline_mask_blurred , bQ ) ; float rO = Dw . a - Dv . a ; if ( rO != 0.0 ) { float Dx = smoothstep ( 0.0 , 1.0 , Dw . a ) ; if ( Dv . a == 0.0 ) { vec3 Dy = u_outline_color ; be ( Dy ) ; vec4 Dz = vec4 ( clamp ( Dy , 0.0 , 1.0 ) , 1.0 ) ; GLSL_OUT_FRAG_COLOR = mix ( Du , Dz , Dx ) ; } } } }".split(" ")}]};
a["postprocessing/performance.glslf"]={a:"grp",c:[{a:"version",b:["GLSL_VERSION"]},{a:"include",n:"precision_statement.glslf"},{a:"txt",b:"uniform sampler2D u_color ; GLSL_IN vec2 bQ ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { vec4 m = vec4 ( 0.0 ) ; for ( int aQ = 0 ; aQ < 100 ; aQ ++ ) m += 0.001 * GLSL_TEXTURE ( u_color , bQ + vec2 ( 0.001 * vec2 ( aQ ) ) ) ; GLSL_OUT_FRAG_COLOR = m ; }".split(" ")}]};a["postprocessing/postprocessing.glslf"]={a:"grp",c:[{a:"version",b:["GLSL_VERSION"]},
{a:"include",n:"precision_statement.glslf"},{a:"define",d:"POST_EFFECT_NONE",b:["1"]},{a:"define",d:"POST_EFFECT_GRAYSCALE",b:["2"]},{a:"define",d:"POST_EFFECT_X_BLUR",b:["3"]},{a:"define",d:"POST_EFFECT_Y_BLUR",b:["4"]},{a:"define",d:"POST_EFFECT_X_GLOW_BLUR",b:["5"]},{a:"define",d:"POST_EFFECT_Y_GLOW_BLUR",b:["6"]},{a:"define",d:"POST_EFFECT_X_DOF_BLUR",b:["7"]},{a:"define",d:"POST_EFFECT_Y_DOF_BLUR",b:["8"]},{a:"define",d:"POST_EFFECT_X_ALPHA_BLUR",b:["9"]},{a:"define",d:"POST_EFFECT_Y_ALPHA_BLUR",
b:["10"]},{a:"define",d:"POST_EFFECT_X_EXTEND",b:["11"]},{a:"define",d:"POST_EFFECT_Y_EXTEND",b:["12"]},{a:"define",d:"FLIP_CUBEMAP_COORDS",b:["13"]},{a:"txt",b:"uniform vec2 u_texel_size ; uniform sampler2D u_color ;".split(" ")},{a:"cond",c:[{a:"if",e:["POST_EFFECT","FLIP_CUBEMAP_COORDS",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"uniform int u_tex_number ; uniform vec2 u_delta ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["POST_EFFECT","POST_EFFECT_X_DOF_BLUR",{a:"equal_expr",i:2},"POST_EFFECT",
"POST_EFFECT_Y_DOF_BLUR",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","float","u_dof_bokeh_intensity",";"]}]}}]},{a:"txt",b:"GLSL_IN vec2 bQ ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) {".split(" ")},{a:"cond",c:[{a:"if",e:["POST_EFFECT","POST_EFFECT_NONE",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , bQ ) ;".split(" ")}]}},{a:"elif",e:["POST_EFFECT","POST_EFFECT_GRAYSCALE",{a:"equal_expr",i:2}],h:{a:"grp",
c:[{a:"txt",b:"vec4 ov = GLSL_TEXTURE ( u_color , bQ ) ; GLSL_OUT_FRAG_COLOR . rgb = vec3 ( ( ov . r + ov . g + ov . b ) / 3.0 ) ; GLSL_OUT_FRAG_COLOR . a = 1.0 ;".split(" ")}]}},{a:"elif",e:["POST_EFFECT","POST_EFFECT_X_BLUR",{a:"equal_expr",i:2},"POST_EFFECT","POST_EFFECT_Y_BLUR",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"vec2 cm = vec2 ( 0.0 , 0.0 ) ; vec2 wQ = u_texel_size ; vec4 m ; m = GLSL_TEXTURE ( u_color , bQ ) ; GLSL_OUT_FRAG_COLOR = m * 0.2270270270 ; cm += wQ ; m = GLSL_TEXTURE ( u_color , bQ + cm ) ; GLSL_OUT_FRAG_COLOR += m * 0.1945945946 ; m = GLSL_TEXTURE ( u_color , bQ - cm ) ; GLSL_OUT_FRAG_COLOR += m * 0.1945945946 ; cm += wQ ; m = GLSL_TEXTURE ( u_color , bQ + cm ) ; GLSL_OUT_FRAG_COLOR += m * 0.1216216216 ; m = GLSL_TEXTURE ( u_color , bQ - cm ) ; GLSL_OUT_FRAG_COLOR += m * 0.1216216216 ; cm += wQ ; m = GLSL_TEXTURE ( u_color , bQ + cm ) ; GLSL_OUT_FRAG_COLOR += m * 0.0540540541 ; m = GLSL_TEXTURE ( u_color , bQ - cm ) ; GLSL_OUT_FRAG_COLOR += m * 0.0540540541 ; cm += wQ ; m = GLSL_TEXTURE ( u_color , bQ + cm ) ; GLSL_OUT_FRAG_COLOR += m * 0.0162162162 ; m = GLSL_TEXTURE ( u_color , bQ - cm ) ; GLSL_OUT_FRAG_COLOR += m * 0.0162162162 ;".split(" ")}]}},
{a:"elif",e:["POST_EFFECT","POST_EFFECT_X_GLOW_BLUR",{a:"equal_expr",i:2},"POST_EFFECT","POST_EFFECT_Y_GLOW_BLUR",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"vec2 cm = vec2 ( 0.0 , 0.0 ) ; vec2 wQ = u_texel_size ; vec4 m ; m = GLSL_TEXTURE ( u_color , bQ ) ; GLSL_OUT_FRAG_COLOR = m * ( 1.0 - step ( 0.0 , - m . a ) ) * 0.152507 ; cm += wQ ; m = GLSL_TEXTURE ( u_color , bQ + cm ) ; GLSL_OUT_FRAG_COLOR += m * ( 1.0 - step ( 0.0 , - m . a ) ) * 0.141763 ; m = GLSL_TEXTURE ( u_color , bQ - cm ) ; GLSL_OUT_FRAG_COLOR += m * ( 1.0 - step ( 0.0 , - m . a ) ) * 0.141763 ; cm += wQ ; m = GLSL_TEXTURE ( u_color , bQ + cm ) ; GLSL_OUT_FRAG_COLOR += m * ( 1.0 - step ( 0.0 , - m . a ) ) * 0.113861 ; m = GLSL_TEXTURE ( u_color , bQ - cm ) ; GLSL_OUT_FRAG_COLOR += m * ( 1.0 - step ( 0.0 , - m . a ) ) * 0.113861 ; cm += wQ ; m = GLSL_TEXTURE ( u_color , bQ + cm ) ; GLSL_OUT_FRAG_COLOR += m * ( 1.0 - step ( 0.0 , - m . a ) ) * 0.079019 ; m = GLSL_TEXTURE ( u_color , bQ - cm ) ; GLSL_OUT_FRAG_COLOR += m * ( 1.0 - step ( 0.0 , - m . a ) ) * 0.079019 ; cm += wQ ; m = GLSL_TEXTURE ( u_color , bQ + cm ) ; GLSL_OUT_FRAG_COLOR += m * ( 1.0 - step ( 0.0 , - m . a ) ) * 0.047383 ; m = GLSL_TEXTURE ( u_color , bQ - cm ) ; GLSL_OUT_FRAG_COLOR += m * ( 1.0 - step ( 0.0 , - m . a ) ) * 0.047383 ; cm += wQ ; m = GLSL_TEXTURE ( u_color , bQ + cm ) ; GLSL_OUT_FRAG_COLOR += m * ( 1.0 - step ( 0.0 , - m . a ) ) * 0.024549 ; m = GLSL_TEXTURE ( u_color , bQ - cm ) ; GLSL_OUT_FRAG_COLOR += m * ( 1.0 - step ( 0.0 , - m . a ) ) * 0.024549 ; cm += wQ ; m = GLSL_TEXTURE ( u_color , bQ + cm ) ; GLSL_OUT_FRAG_COLOR += m * ( 1.0 - step ( 0.0 , - m . a ) ) * 0.01099 ; m = GLSL_TEXTURE ( u_color , bQ - cm ) ; GLSL_OUT_FRAG_COLOR += m * ( 1.0 - step ( 0.0 , - m . a ) ) * 0.01099 ; cm += wQ ; m = GLSL_TEXTURE ( u_color , bQ + cm ) ; GLSL_OUT_FRAG_COLOR += m * ( 1.0 - step ( 0.0 , - m . a ) ) * 0.00425 ; m = GLSL_TEXTURE ( u_color , bQ - cm ) ; GLSL_OUT_FRAG_COLOR += m * ( 1.0 - step ( 0.0 , - m . a ) ) * 0.00425 ; cm += wQ ; m = GLSL_TEXTURE ( u_color , bQ + cm ) ; GLSL_OUT_FRAG_COLOR += m * ( 1.0 - step ( 0.0 , - m . a ) ) * 0.00142 ; m = GLSL_TEXTURE ( u_color , bQ - cm ) ; GLSL_OUT_FRAG_COLOR += m * ( 1.0 - step ( 0.0 , - m . a ) ) * 0.00142 ; GLSL_OUT_FRAG_COLOR = clamp ( GLSL_OUT_FRAG_COLOR , 0.0 , 1.0 ) ;".split(" ")}]}},
{a:"elif",e:["POST_EFFECT","POST_EFFECT_X_DOF_BLUR",{a:"equal_expr",i:2},"POST_EFFECT","POST_EFFECT_Y_DOF_BLUR",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"vec2 cm = vec2 ( 0.0 , 0.0 ) ; vec2 wQ = u_texel_size ; vec4 m ; vec4 DA ; vec4 DB ; float Cv ; float DC = u_dof_bokeh_intensity ; m = GLSL_TEXTURE ( u_color , bQ ) ; DA = m ; DB = m ; Cv = m . a ; wQ = Cv * wQ ; for ( int aQ = 0 ; aQ < 12 ; aQ += 2 ) { cm += wQ ; m = GLSL_TEXTURE ( u_color , bQ + cm ) ; DA += m ; DB = max ( DB , m ) ; m = GLSL_TEXTURE ( u_color , bQ - cm ) ; DA += m ; DB = max ( DB , m ) ; } DA /= 13.0 ; GLSL_OUT_FRAG_COLOR = mix ( DA , DB , DC ) ;".split(" ")}]}},
{a:"elif",e:["POST_EFFECT","POST_EFFECT_X_ALPHA_BLUR",{a:"equal_expr",i:2},"POST_EFFECT","POST_EFFECT_Y_ALPHA_BLUR",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"vec2 cm = vec2 ( 0.0 , 0.0 ) ; vec2 wQ = u_texel_size ; vec4 m ; vec4 DA ; vec4 DB ; m = GLSL_TEXTURE ( u_color , bQ ) ; DB = max ( DB , m ) ; DA = m ; DA . a = m . a * 0.2270270270 ; cm += wQ ; m = GLSL_TEXTURE ( u_color , bQ + cm ) ; DB . a = max ( DB . a , m . a ) ; DA . a += m . a * 0.1945945946 ; m = GLSL_TEXTURE ( u_color , bQ - cm ) ; DB . a = max ( DB . a , m . a ) ; DA . a += m . a * 0.1945945946 ; cm += wQ ; m = GLSL_TEXTURE ( u_color , bQ + cm ) ; DB . a = max ( DB . a , m . a ) ; DA . a += m . a * 0.1216216216 ; m = GLSL_TEXTURE ( u_color , bQ - cm ) ; DB . a = max ( DB . a , m . a ) ; DA . a += m . a * 0.1216216216 ; cm += wQ ; m = GLSL_TEXTURE ( u_color , bQ + cm ) ; DB . a = max ( DB . a , m . a ) ; DA . a += m . a * 0.0540540541 ; m = GLSL_TEXTURE ( u_color , bQ - cm ) ; DB . a = max ( DB . a , m . a ) ; DA . a += m . a * 0.0540540541 ; cm += wQ ; m = GLSL_TEXTURE ( u_color , bQ + cm ) ; DB . a = max ( DB . a , m . a ) ; DA . a += m . a * 0.0162162162 ; m = GLSL_TEXTURE ( u_color , bQ - cm ) ; DB . a = max ( DB . a , m . a ) ; DA . a += m . a * 0.0162162162 ; GLSL_OUT_FRAG_COLOR = mix ( DA , DB , 0.5 ) ;".split(" ")}]}},
{a:"elif",e:["POST_EFFECT","POST_EFFECT_X_EXTEND",{a:"equal_expr",i:2},"POST_EFFECT","POST_EFFECT_Y_EXTEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"vec2 wQ = u_texel_size ; vec4 m = GLSL_TEXTURE ( u_color , bQ ) ; GLSL_OUT_FRAG_COLOR = m ; if ( m . a == 0.0 ) { m = GLSL_TEXTURE ( u_color , bQ + wQ ) ; if ( m . a > 0.0 ) GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , 1.0 , 1.0 , m . a ) ; else { m = GLSL_TEXTURE ( u_color , bQ - wQ ) ; if ( m . a > 0.0 ) GLSL_OUT_FRAG_COLOR = vec4 ( 1.0 , 1.0 , 1.0 , m . a ) ; } }".split(" ")}]}},
{a:"elif",e:["POST_EFFECT","FLIP_CUBEMAP_COORDS",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"float DD = u_delta [ 0 ] ; float DE = u_delta [ 1 ] ; float DF = 1.0 / 3.0 ; float DG = 0.5 ; vec2 bA = vec2 ( DF , DG ) ; if ( u_tex_number == 0 ) { vec2 bv = bQ * bA + vec2 ( 2.0 * DF , 0.0 ) ; bv [ 0 ] = min ( bv [ 0 ] , 1.0 - DD ) ; bv [ 1 ] = min ( bv [ 1 ] , 0.5 - DE ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( 5.0 * DF - bv [ 0 ] , bv [ 1 ] ) ) ; } else if ( u_tex_number == 1 ) { vec2 bv = bQ * bA ; bv [ 0 ] = max ( bv [ 0 ] , DD ) ; bv [ 1 ] = min ( bv [ 1 ] , 0.5 - DE ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( DF - bv [ 0 ] , bv [ 1 ] ) ) ; } else if ( u_tex_number == 2 ) { vec2 bv = bQ * bA + vec2 ( DF , DG ) ; bv [ 0 ] = max ( bv [ 0 ] , DF + DD ) ; bv [ 0 ] = min ( bv [ 0 ] , 2.0 * DF - DD ) ; bv [ 1 ] = min ( bv [ 1 ] , 1.0 - DE ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( bv [ 0 ] , 3.0 * DG - bv [ 1 ] ) ) ; } else if ( u_tex_number == 3 ) { vec2 bv = bQ * bA + vec2 ( 0.0 , DG ) ; bv [ 0 ] = min ( bv [ 0 ] , DF - DD ) ; bv [ 1 ] = min ( bv [ 1 ] , 1.0 - DE ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( bv [ 0 ] , 3.0 * DG - bv [ 1 ] ) ) ; } else if ( u_tex_number == 4 ) { vec2 bv = bQ * bA + vec2 ( DF , 0.0 ) ; bv [ 0 ] = max ( bv [ 0 ] , DF + DD ) ; bv [ 0 ] = min ( bv [ 0 ] , 2.0 * DF - DD ) ; bv [ 1 ] = min ( bv [ 1 ] , 0.5 - DE ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( 1.0 - bv [ 0 ] , bv [ 1 ] ) ) ; } else { vec2 bv = bQ * bA + vec2 ( 2.0 * DF , DG ) ; bv [ 0 ] = min ( bv [ 0 ] , 1.0 - DD ) ; bv [ 1 ] = max ( bv [ 1 ] , 0.5 + DE ) ; GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_color , vec2 ( 5.0 * DF - bv [ 0 ] , bv [ 1 ] ) ) ; }".split(" ")}]}}]},
{a:"txt",b:["}"]}]};a["postprocessing/postprocessing.glslv"]={a:"grp",c:[{a:"version",b:["GLSL_VERSION"]},{a:"txt",b:"GLSL_IN vec2 a_position ; GLSL_OUT vec2 bQ ; void main ( ) { bQ = 2.0 * a_position ; gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/smaa.glslf"]={a:"grp",c:[{a:"version",b:["GLSL_VERSION"]},{a:"include",n:"precision_statement.glslf"},{a:"include",n:"color_util.glslf"},{a:"include",n:"pack.glslf"},{a:"define",d:"SMAA_RESOLVE",
b:["1"]},{a:"define",d:"SMAA_EDGE_DETECTION",b:["2"]},{a:"define",d:"SMAA_BLENDING_WEIGHT_CALCULATION",b:["3"]},{a:"define",d:"SMAA_NEIGHBORHOOD_BLENDING",b:["4"]},{a:"define",d:"AA_METHOD_SMAA_LOW",b:["1"]},{a:"define",d:"AA_METHOD_SMAA_MEDIUM",b:["2"]},{a:"define",d:"AA_METHOD_SMAA_HIGH",b:["3"]},{a:"define",d:"AA_METHOD_SMAA_ULTRA",b:["4"]},{a:"txt",b:["uniform","sampler2D","u_color",";"]},{a:"cond",c:[{a:"if",e:["SMAA_PASS","SMAA_RESOLVE",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform",
"sampler2D","u_color_prev",";"]}]}}]},{a:"cond",c:[{a:"if",e:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","sampler2D","u_blend",";"]}]}}]},{a:"cond",c:[{a:"if",e:["SMAA_REPROJECTION"],h:{a:"grp",c:[{a:"txt",b:["uniform","sampler2D","u_velocity_tex",";"]}]}}]},{a:"cond",c:[{a:"if",e:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2},"SMAA_PREDICATION",{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uniform","sampler2D","u_predication_tex",
";"]}]}}]},{a:"cond",c:[{a:"if",e:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"uniform sampler2D u_search_tex ; uniform sampler2D u_area_tex ; uniform vec4 u_subsample_indices ;".split(" ")}]}}]},{a:"txt",b:"uniform vec2 u_texel_size ; GLSL_IN vec2 bQ ;".split(" ")},{a:"cond",c:[{a:"if",e:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec4","DH",";"]}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"GLSL_IN vec4 DI ; GLSL_IN vec4 DJ ; GLSL_IN vec4 DK ;".split(" ")}]}}]},
{a:"cond",c:[{a:"if",e:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec2","DL",";"]}]}}]},{a:"txt",b:["GLSL_OUT","vec4","GLSL_OUT_FRAG_COLOR",";"]},{a:"cond",c:[{a:"if",e:["AA_METHOD","AA_METHOD_SMAA_LOW",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"define",d:"SMAA_THRESHOLD",b:["0.15"]},{a:"define",d:"SMAA_DISABLE_DIAG_DETECTION",b:["1"]},{a:"define",d:"SMAA_DISABLE_CORNER_DETECTION",b:["1"]}]}},{a:"elif",e:["AA_METHOD","AA_METHOD_SMAA_MEDIUM",
{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"define",d:"SMAA_THRESHOLD",b:["0.1"]},{a:"define",d:"SMAA_DISABLE_DIAG_DETECTION",b:["1"]},{a:"define",d:"SMAA_DISABLE_CORNER_DETECTION",b:["1"]}]}},{a:"elif",e:["AA_METHOD","AA_METHOD_SMAA_HIGH",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"define",d:"SMAA_THRESHOLD",b:["0.1"]},{a:"define",d:"SMAA_DISABLE_DIAG_DETECTION",b:["0"]},{a:"define",d:"SMAA_MAX_SEARCH_STEPS_DIAG",b:["8"]},{a:"define",d:"SMAA_CORNER_ROUNDING",b:["25"]}]}},{a:"elif",e:["AA_METHOD","AA_METHOD_SMAA_ULTRA",
{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"define",d:"SMAA_THRESHOLD",b:["0.05"]},{a:"define",d:"SMAA_DISABLE_DIAG_DETECTION",b:["0"]},{a:"define",d:"SMAA_MAX_SEARCH_STEPS_DIAG",b:["16"]},{a:"define",d:"SMAA_CORNER_ROUNDING",b:["25"]}]}}]},{a:"cond",c:[{a:"ifndef",d:"SMAA_THRESHOLD",h:{a:"grp",c:[{a:"define",d:"SMAA_THRESHOLD",b:["0.1"]}]}}]},{a:"cond",c:[{a:"ifndef",d:"SMAA_DEPTH_THRESHOLD",h:{a:"grp",c:[{a:"define",d:"SMAA_DEPTH_THRESHOLD",b:["(","0.1","*","SMAA_THRESHOLD",")"]}]}}]},{a:"cond",c:[{a:"ifndef",
d:"SMAA_MAX_SEARCH_STEPS_DIAG",h:{a:"grp",c:[{a:"define",d:"SMAA_MAX_SEARCH_STEPS_DIAG",b:["8"]}]}}]},{a:"cond",c:[{a:"ifndef",d:"SMAA_CORNER_ROUNDING",h:{a:"grp",c:[{a:"define",d:"SMAA_CORNER_ROUNDING",b:["25"]}]}}]},{a:"cond",c:[{a:"ifndef",d:"SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR",h:{a:"grp",c:[{a:"define",d:"SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR",b:["2.0"]}]}}]},{a:"cond",c:[{a:"ifndef",d:"SMAA_PREDICATION",h:{a:"grp",c:[{a:"define",d:"SMAA_PREDICATION",b:["0"]}]}}]},{a:"cond",c:[{a:"ifndef",
d:"SMAA_PREDICATION_THRESHOLD",h:{a:"grp",c:[{a:"define",d:"SMAA_PREDICATION_THRESHOLD",b:["0.01"]}]}}]},{a:"cond",c:[{a:"ifndef",d:"SMAA_PREDICATION_SCALE",h:{a:"grp",c:[{a:"define",d:"SMAA_PREDICATION_SCALE",b:["2.0"]}]}}]},{a:"cond",c:[{a:"ifndef",d:"SMAA_PREDICATION_STRENGTH",h:{a:"grp",c:[{a:"define",d:"SMAA_PREDICATION_STRENGTH",b:["0.4"]}]}}]},{a:"cond",c:[{a:"ifndef",d:"SMAA_REPROJECTION",h:{a:"grp",c:[{a:"define",d:"SMAA_REPROJECTION",b:["0"]}]}}]},{a:"cond",c:[{a:"ifndef",d:"SMAA_REPROJECTION_WEIGHT_SCALE",
h:{a:"grp",c:[{a:"define",d:"SMAA_REPROJECTION_WEIGHT_SCALE",b:["30.0"]}]}}]},{a:"cond",c:[{a:"ifndef",d:"SMAA_MAX_SEARCH_STEPS",h:{a:"grp",c:[{a:"define",d:"SMAA_MAX_SEARCH_STEPS",b:["16"]}]}}]},{a:"define",d:"SMAA_AREATEX_MAX_DISTANCE",b:["16"]},{a:"define",d:"SMAA_AREATEX_MAX_DISTANCE_DIAG",b:["20"]},{a:"define",d:"SMAA_AREATEX_PIXEL_SIZE",b:"( 1.0 / vec2 ( 160.0 , 560.0 ) )".split(" ")},{a:"define",d:"SMAA_AREATEX_SUBTEX_SIZE",b:["(","1.0","/","7.0",")"]},{a:"define",d:"SMAA_SEARCHTEX_SIZE",b:"vec2 ( 66.0 , 33.0 )".split(" ")},
{a:"define",d:"SMAA_SEARCHTEX_PACKED_SIZE",b:"vec2 ( 64.0 , 16.0 )".split(" ")},{a:"define",d:"SMAA_CORNER_ROUNDING_NORM",b:"( float ( SMAA_CORNER_ROUNDING ) / 100.0 )".split(" ")},{a:"cond",c:[{a:"if",e:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"vec3 DO ( vec2 bv , sampler2D AJ ) { float p = GLSL_TEXTURE ( AJ , bv ) . r ; float DM = GLSL_TEXTURE ( AJ , DI . xy ) . r ; float DN = GLSL_TEXTURE ( AJ , DI . zw ) . r ; return vec3 ( p , DM , DN ) ; }".split(" ")}]}}]},
{a:"cond",c:[{a:"if",e:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"vec2 DS ( vec2 bv , sampler2D DP ) { vec3 DQ = DO ( bv , DP ) ; vec2 wQ = abs ( DQ . xx - DQ . yz ) ; vec2 DR = step ( SMAA_PREDICATION_THRESHOLD , wQ ) ; return SMAA_PREDICATION_SCALE * SMAA_THRESHOLD * ( 1.0 - SMAA_PREDICATION_STRENGTH * DR ) ; }".split(" ")}]}}]},{a:"txt",b:"void DV ( bvec2 DT , inout vec2 DU , vec2 ai ) { if ( DT . x ) DU . x = ai . x ; if ( DT . y ) DU . y = ai . y ; } void DV ( bvec4 DT , inout vec4 DU , vec4 ai ) { DV ( DT . xy , DU . xy , ai . xy ) ; DV ( DT . zw , DU . zw , ai . zw ) ; } vec2 DW ( vec2 x ) { return sign ( x ) * floor ( abs ( x ) + .5 ) ; } vec4 DW ( vec4 x ) { return sign ( x ) * floor ( abs ( x ) + .5 ) ; }".split(" ")},
{a:"cond",c:[{a:"if",e:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"vec2 Ei ( vec2 bv , sampler2D DX".split(" ")},{a:"cond",c:[{a:"if",e:["SMAA_PREDICATION"],h:{a:"grp",c:[{a:"txt",b:[",","sampler2D","DP"]}]}}]},{a:"txt",b:[")","{"]},{a:"cond",c:[{a:"if",e:["SMAA_PREDICATION"],h:{a:"grp",c:[{a:"txt",b:"vec2 DY = DS ( bv , DP ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"vec2 DY = vec2 ( SMAA_THRESHOLD , SMAA_THRESHOLD ) ;".split(" ")}]}}]},{a:"txt",
b:"vec3 DZ = vec3 ( 0.2126 , 0.7152 , 0.0722 ) ; float D_ = dot ( GLSL_TEXTURE ( DX , bv ) . rgb , DZ ) ; float Ea = dot ( GLSL_TEXTURE ( DX , DI . xy ) . rgb , DZ ) ; float Eb = dot ( GLSL_TEXTURE ( DX , DI . zw ) . rgb , DZ ) ; vec4 wQ ; wQ . xy = abs ( D_ - vec2 ( Ea , Eb ) ) ; vec2 DR = step ( DY , wQ . xy ) ; if ( dot ( DR , vec2 ( 1.0 , 1.0 ) ) == 0.0 ) discard ; float Ec = dot ( GLSL_TEXTURE ( DX , DJ . xy ) . rgb , DZ ) ; float Ed = dot ( GLSL_TEXTURE ( DX , DJ . zw ) . rgb , DZ ) ; wQ . zw = abs ( D_ - vec2 ( Ec , Ed ) ) ; vec2 Ee = max ( wQ . xy , wQ . zw ) ; float Ef = dot ( GLSL_TEXTURE ( DX , DK . xy ) . rgb , DZ ) ; float Eg = dot ( GLSL_TEXTURE ( DX , DK . zw ) . rgb , DZ ) ; wQ . zw = abs ( vec2 ( Ea , Eb ) - vec2 ( Ef , Eg ) ) ; Ee = max ( Ee . xy , wQ . zw ) ; float Eh = max ( Ee . x , Ee . y ) ; DR . xy *= step ( Eh , SMAA_LOCAL_CONTRAST_ADAPTATION_FACTOR * wQ . xy ) ; return DR ; }".split(" ")}]}}]},
{a:"cond",c:[{a:"if",e:["SMAA_DISABLE_DIAG_DETECTION",{a:"logic_negative_expr",i:1}],h:{a:"grp",c:[{a:"txt",b:"vec2 Ej ( vec2 dE ) { dE . r = dE . r * abs ( 5.0 * dE . r - 5.0 * 0.75 ) ; return DW ( dE ) ; } vec4 Ej ( vec4 dE ) { dE . rb = dE . rb * abs ( 5.0 * dE . rb - 5.0 * 0.75 ) ; return DW ( dE ) ; } vec2 El ( sampler2D Ek , vec2 bv , vec2 H , out vec2 dE ) { vec4 aY = vec4 ( bv , - 1.0 , 1.0 ) ; vec3 t = vec3 ( u_texel_size , 1.0 ) ; for ( int aQ = 0 ; aQ < SMAA_MAX_SEARCH_STEPS_DIAG ; aQ ++ ) { if ( aY . z < float ( SMAA_MAX_SEARCH_STEPS_DIAG - 1 ) && aY . w > 0.9 ) { aY . xyz += t * vec3 ( H , 1.0 ) ; dE = GLSL_TEXTURE ( Ek , aY . xy , 0.0 ) . rg ; aY . w = dot ( dE , vec2 ( 0.5 , 0.5 ) ) ; } } return aY . zw ; } vec2 Em ( sampler2D Ek , vec2 bv , vec2 H , out vec2 dE ) { vec4 aY = vec4 ( bv , - 1.0 , 1.0 ) ; aY . x += 0.25 * u_texel_size . x ; vec3 t = vec3 ( u_texel_size , 1.0 ) ; for ( int aQ = 0 ; aQ < SMAA_MAX_SEARCH_STEPS_DIAG ; aQ ++ ) { if ( aY . z < float ( SMAA_MAX_SEARCH_STEPS_DIAG - 1 ) && aY . w > 0.9 ) { aY . xyz = t * vec3 ( H , 1.0 ) + aY . xyz ; dE = GLSL_TEXTURE ( Ek , aY . xy , 0.0 ) . rg ; dE = Ej ( dE ) ; aY . w = dot ( dE , vec2 ( 0.5 , 0.5 ) ) ; } } return aY . zw ; } vec2 Eo ( sampler2D En , vec2 m_ , vec2 dE , float cm ) { vec2 bv = vec2 ( SMAA_AREATEX_MAX_DISTANCE_DIAG , SMAA_AREATEX_MAX_DISTANCE_DIAG ) * dE + m_ ; bv = SMAA_AREATEX_PIXEL_SIZE * bv + 0.5 * SMAA_AREATEX_PIXEL_SIZE ; bv . x += 0.5 ; bv . y += SMAA_AREATEX_SUBTEX_SIZE * cm ; return GLSL_TEXTURE ( En , bv , 0.0 ) . rg ; } vec2 Es ( sampler2D Ek , sampler2D En , vec2 bv , vec2 dE , vec4 Ep ) { vec2 DZ = vec2 ( 0.0 , 0.0 ) ; vec4 aH ; vec2 Eq ; if ( dE . r > 0.0 ) { aH . xz = El ( Ek , bv , vec2 ( - 1.0 , 1.0 ) , Eq ) ; aH . x += float ( Eq . y > 0.9 ) ; } else aH . xz = vec2 ( 0.0 , 0.0 ) ; aH . yw = El ( Ek , bv , vec2 ( 1.0 , - 1.0 ) , Eq ) ; if ( aH . x + aH . y > 2.0 ) { vec4 cd = vec4 ( - aH . x + 0.25 , aH . x , aH . y , - aH . y - 0.25 ) * u_texel_size . xyxy + bv . xyxy ; vec4 ov ; ov . xy = GLSL_TEXTURE ( Ek , cd . xy + u_texel_size * vec2 ( - 1 , 0 ) , 0.0 ) . rg ; ov . zw = GLSL_TEXTURE ( Ek , cd . zw + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . rg ; ov . yxwz = Ej ( ov . xyzw ) ; vec2 Er = vec2 ( 2.0 , 2.0 ) * ov . xz + ov . yw ; DV ( bvec2 ( step ( 0.9 , aH . zw ) ) , Er , vec2 ( 0.0 , 0.0 ) ) ; DZ += Eo ( En , aH . xy , Er , Ep . z ) ; } aH . xz = Em ( Ek , bv , vec2 ( - 1 , - 1 ) , Eq ) ; if ( GLSL_TEXTURE ( Ek , bv + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . r > 0.0 ) { aH . yw = Em ( Ek , bv , vec2 ( 1 , 1 ) , Eq ) ; aH . y += float ( Eq . y > 0.9 ) ; } else aH . yw = vec2 ( 0.0 , 0.0 ) ; if ( aH . x + aH . y > 2.0 ) { vec4 cd = vec4 ( - aH . x , - aH . x , aH . y , aH . y ) * u_texel_size . xyxy + bv . xyxy ; vec4 ov ; ov . x = GLSL_TEXTURE ( Ek , cd . xy + u_texel_size * vec2 ( - 1 , 0 ) , 0.0 ) . g ; ov . y = GLSL_TEXTURE ( Ek , cd . xy + u_texel_size * vec2 ( 0 , - 1 ) , 0.0 ) . r ; ov . zw = GLSL_TEXTURE ( Ek , cd . zw + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . gr ; vec2 Er = vec2 ( 2.0 , 2.0 ) * ov . xz + ov . yw ; DV ( bvec2 ( step ( 0.9 , aH . zw ) ) , Er , vec2 ( 0 , 0 ) ) ; DZ += Eo ( En , aH . xy , Er , Ep . w ) . gr ; } return DZ ; }".split(" ")}]}}]},
{a:"txt",b:"float Ev ( sampler2D Et , vec2 dE , float cm ) { vec2 bA = SMAA_SEARCHTEX_SIZE * vec2 ( 0.5 , - 1.0 ) ; vec2 Eu = SMAA_SEARCHTEX_SIZE * vec2 ( cm , 1.0 ) ; bA += vec2 ( - 1.0 , 1.0 ) ; Eu += vec2 ( 0.5 , - 0.5 ) ; bA *= 1.0 / SMAA_SEARCHTEX_PACKED_SIZE ; Eu *= 1.0 / SMAA_SEARCHTEX_PACKED_SIZE ; return GLSL_TEXTURE ( Et , bA * dE + Eu , 0.0 ) . r ; } float Ew ( sampler2D Ek , sampler2D Et , vec2 bv , float Eq ) { vec2 dE = vec2 ( 0.0 , 1.0 ) ; for ( int aQ = 0 ; aQ < SMAA_MAX_SEARCH_STEPS ; aQ ++ ) { if ( bv . x > Eq && dE . g > 0.8281 && dE . r == 0.0 ) { dE = GLSL_TEXTURE ( Ek , bv , 0.0 ) . rg ; bv = - vec2 ( 2.0 , 0.0 ) * u_texel_size + bv ; } } float cm = - ( 255.0 / 127.0 ) * Ev ( Et , dE , 0.0 ) + 3.25 ; return u_texel_size . x * cm + bv . x ; } float Ex ( sampler2D Ek , sampler2D Et , vec2 bv , float Eq ) { vec2 dE = vec2 ( 0.0 , 1.0 ) ; for ( int aQ = 0 ; aQ < SMAA_MAX_SEARCH_STEPS ; aQ ++ ) { if ( bv . x < Eq && dE . g > 0.8281 && dE . r == 0.0 ) { dE = GLSL_TEXTURE ( Ek , bv , 0.0 ) . rg ; bv = vec2 ( 2.0 , 0.0 ) * u_texel_size + bv ; } } float cm = - ( 255.0 / 127.0 ) * Ev ( Et , dE , 0.5 ) + 3.25 ; return - u_texel_size . x * cm + bv . x ; } float Ey ( sampler2D Ek , sampler2D Et , vec2 bv , float Eq ) { vec2 dE = vec2 ( 1.0 , 0.0 ) ; for ( int aQ = 0 ; aQ < SMAA_MAX_SEARCH_STEPS ; aQ ++ ) { if ( bv . y > Eq && dE . r > 0.8281 && dE . g == 0.0 ) { dE = GLSL_TEXTURE ( Ek , bv , 0.0 ) . rg ; bv = - vec2 ( 0.0 , 2.0 ) * u_texel_size + bv ; } } float cm = - ( 255.0 / 127.0 ) * Ev ( Et , dE . gr , 0.0 ) + 3.25 ; return u_texel_size . y * cm + bv . y ; } float Ez ( sampler2D Ek , sampler2D Et , vec2 bv , float Eq ) { vec2 dE = vec2 ( 1.0 , 0.0 ) ; for ( int aQ = 0 ; aQ < SMAA_MAX_SEARCH_STEPS ; aQ ++ ) { if ( bv . y < Eq && dE . r > 0.8281 && dE . g == 0.0 ) { dE = GLSL_TEXTURE ( Ek , bv , 0.0 ) . rg ; bv = vec2 ( 0.0 , 2.0 ) * u_texel_size + bv ; } } float cm = - ( 255.0 / 127.0 ) * Ev ( Et , dE . gr , 0.5 ) + 3.25 ; return - u_texel_size . y * cm + bv . y ; } vec2 EC ( sampler2D En , vec2 m_ , float EA , float EB , float cm ) { vec2 bv = vec2 ( SMAA_AREATEX_MAX_DISTANCE , SMAA_AREATEX_MAX_DISTANCE ) * DW ( 4.0 * vec2 ( EA , EB ) ) + m_ ; bv = SMAA_AREATEX_PIXEL_SIZE * bv + 0.5 * SMAA_AREATEX_PIXEL_SIZE ; bv . y = SMAA_AREATEX_SUBTEX_SIZE * cm + bv . y ; return GLSL_TEXTURE ( En , bv , 0.0 ) . rg ; } void EF ( sampler2D Ek , inout vec2 DZ , vec4 bv , vec2 aH ) {".split(" ")},
{a:"cond",c:[{a:"if",e:["SMAA_DISABLE_CORNER_DETECTION",{a:"logic_negative_expr",i:1}],h:{a:"grp",c:[{a:"txt",b:"vec2 ED = step ( aH . xy , aH . yx ) ; vec2 EE = ( 1.0 - SMAA_CORNER_ROUNDING_NORM ) * ED ; EE /= ED . x + ED . y ; vec2 cz = vec2 ( 1.0 , 1.0 ) ; cz . x -= EE . x * GLSL_TEXTURE ( Ek , bv . xy + u_texel_size * vec2 ( 0 , 1 ) , 0.0 ) . r ; cz . x -= EE . y * GLSL_TEXTURE ( Ek , bv . zw + u_texel_size * vec2 ( 1 , 1 ) , 0.0 ) . r ; cz . y -= EE . x * GLSL_TEXTURE ( Ek , bv . xy + u_texel_size * vec2 ( 0 , - 2 ) , 0.0 ) . r ; cz . y -= EE . y * GLSL_TEXTURE ( Ek , bv . zw + u_texel_size * vec2 ( 1 , - 2 ) , 0.0 ) . r ; DZ *= clamp ( cz , 0.0 , 1.0 ) ;".split(" ")}]}}]},
{a:"txt",b:"} void EG ( sampler2D Ek , inout vec2 DZ , vec4 bv , vec2 aH ) {".split(" ")},{a:"cond",c:[{a:"if",e:["SMAA_DISABLE_CORNER_DETECTION",{a:"logic_negative_expr",i:1}],h:{a:"grp",c:[{a:"txt",b:"vec2 ED = step ( aH . xy , aH . yx ) ; vec2 EE = ( 1.0 - SMAA_CORNER_ROUNDING_NORM ) * ED ; EE /= ED . x + ED . y ; vec2 cz = vec2 ( 1.0 , 1.0 ) ; cz . x -= EE . x * GLSL_TEXTURE ( Ek , bv . xy + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . g ; cz . x -= EE . y * GLSL_TEXTURE ( Ek , bv . zw + u_texel_size * vec2 ( 1 , 1 ) , 0.0 ) . g ; cz . y -= EE . x * GLSL_TEXTURE ( Ek , bv . xy + u_texel_size * vec2 ( - 2 , 0 ) , 0.0 ) . g ; cz . y -= EE . y * GLSL_TEXTURE ( Ek , bv . zw + u_texel_size * vec2 ( - 2 , 1 ) , 0.0 ) . g ; DZ *= clamp ( cz , 0.0 , 1.0 ) ;".split(" ")}]}}]},
{a:"txt",b:["}"]},{a:"cond",c:[{a:"if",e:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"vec4 EJ ( vec2 bv , vec2 EH , sampler2D Ek , sampler2D En , sampler2D Et , vec4 Ep ) { vec4 DZ = vec4 ( 0.0 , 0.0 , 0.0 , 0.0 ) ; vec2 dE = GLSL_TEXTURE ( Ek , bv ) . rg ; if ( dE . g > 0.0 ) {".split(" ")},{a:"cond",c:[{a:"if",e:["SMAA_DISABLE_DIAG_DETECTION",{a:"logic_negative_expr",i:1}],h:{a:"grp",c:[{a:"txt",b:"DZ . rg = Es ( Ek , En , bv , dE , Ep ) ; if ( DZ . r == - DZ . g ) {".split(" ")}]}}]},
{a:"txt",b:"vec2 aH ; vec3 cd ; cd . x = Ew ( Ek , Et , DI . xy , DK . x ) ; cd . y = DJ . y ; aH . x = cd . x ; float EA = GLSL_TEXTURE ( Ek , cd . xy , 0.0 ) . r ; cd . z = Ex ( Ek , Et , DI . zw , DK . y ) ; aH . y = cd . z ; aH = abs ( DW ( aH / u_texel_size . xx - EH . xx ) ) ; vec2 EI = sqrt ( aH ) ; float EB = GLSL_TEXTURE ( Ek , cd . zy + u_texel_size * vec2 ( 1 , 0 ) , 0.0 ) . r ; DZ . rg = EC ( En , EI , EA , EB , Ep . y ) ; cd . y = bv . y ; EF ( Ek , DZ . rg , cd . xyzy , aH ) ;".split(" ")},
{a:"cond",c:[{a:"if",e:["SMAA_DISABLE_DIAG_DETECTION",{a:"logic_negative_expr",i:1}],h:{a:"grp",c:[{a:"txt",b:"} else dE . r = 0.0 ;".split(" ")}]}}]},{a:"txt",b:"} if ( dE . r > 0.0 ) { vec2 aH ; vec3 cd ; cd . y = Ey ( Ek , Et , DJ . xy , DK . z ) ; cd . x = DI . x ; aH . x = cd . y ; float EA = GLSL_TEXTURE ( Ek , cd . xy , 0.0 ) . g ; cd . z = Ez ( Ek , Et , DJ . zw , DK . w ) ; aH . y = cd . z ; aH = abs ( DW ( aH / u_texel_size . yy - EH . yy ) ) ; vec2 EI = sqrt ( aH ) ; float EB = GLSL_TEXTURE ( Ek , cd . xz + u_texel_size * vec2 ( 0 , 1 ) , 0.0 ) . g ; DZ . ba = EC ( En , EI , EA , EB , Ep . x ) ; cd . x = bv . x ; EG ( Ek , DZ . ba , cd . xyxz , aH ) ; } return DZ ; }".split(" ")}]}}]},
{a:"cond",c:[{a:"if",e:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"vec4 ER ( vec2 bv , sampler2D DX , sampler2D EK".split(" ")},{a:"cond",c:[{a:"if",e:["SMAA_REPROJECTION"],h:{a:"grp",c:[{a:"txt",b:[",","sampler2D","EL"]}]}}]},{a:"txt",b:") { vec4 a ; a . x = GLSL_TEXTURE ( EK , DH . xy ) . a ; a . y = GLSL_TEXTURE ( EK , DH . zw ) . g ; a . wz = GLSL_TEXTURE ( EK , bv ) . xz ; if ( dot ( a , vec4 ( 1.0 , 1.0 , 1.0 , 1.0 ) ) < 1e-5 ) { vec4 m = GLSL_TEXTURE ( DX , bv , 0.0 ) ;".split(" ")},
{a:"cond",c:[{a:"if",e:["SMAA_REPROJECTION"],h:{a:"grp",c:[{a:"txt",b:"vec4 EM = GLSL_TEXTURE ( EL , bQ ) ; vec2 wV = 2.0 * as ( EM ) - 1.0 ; m . a = sqrt ( 2.0 * length ( wV ) ) ;".split(" ")}]}}]},{a:"txt",b:"return m ; } else { bool aV = max ( a . x , a . z ) > max ( a . y , a . w ) ; vec4 EN = vec4 ( 0.0 , a . y , 0.0 , a . w ) ; vec2 EO = a . yw ; DV ( bvec4 ( aV , aV , aV , aV ) , EN , vec4 ( a . x , 0.0 , a . z , 0.0 ) ) ; DV ( bvec2 ( aV , aV ) , EO , a . xz ) ; EO /= dot ( EO , vec2 ( 1.0 , 1.0 ) ) ; vec4 EP = EN * vec4 ( u_texel_size , - u_texel_size ) + bv . xyxy ; vec4 m = EO . x * GLSL_TEXTURE ( DX , EP . xy , 0.0 ) ; m += EO . y * GLSL_TEXTURE ( DX , EP . zw , 0.0 ) ;".split(" ")},
{a:"cond",c:[{a:"if",e:["SMAA_REPROJECTION"],h:{a:"grp",c:[{a:"txt",b:"vec4 EM = GLSL_TEXTURE ( EL , EP . xy ) ; vec2 EQ = 2.0 * as ( EM ) - 1.0 ; vec2 wV = EO . x * EQ ; EM = GLSL_TEXTURE ( EL , EP . zw ) ; EQ = 2.0 * as ( EM ) - 1.0 ; wV += EO . y * EQ ; m . a = sqrt ( 2.0 * length ( wV ) ) ;".split(" ")}]}}]},{a:"txt",b:["return","m",";","}","}"]}]}}]},{a:"cond",c:[{a:"if",e:["SMAA_PASS","SMAA_RESOLVE",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"vec4 EW ( vec2 bv , sampler2D ES , sampler2D ET".split(" ")},
{a:"cond",c:[{a:"if",e:["SMAA_REPROJECTION"],h:{a:"grp",c:[{a:"txt",b:[",","sampler2D","EL"]}]}}]},{a:"txt",b:[")","{"]},{a:"cond",c:[{a:"if",e:["SMAA_REPROJECTION"],h:{a:"grp",c:[{a:"txt",b:"vec4 EM = GLSL_TEXTURE ( EL , bQ ) ; vec2 wV ; wV = 2.0 * as ( EM ) - 1.0 ; vec4 EU = GLSL_TEXTURE ( ES , bv ) ; vec4 EV = GLSL_TEXTURE ( ET , bv - wV ) ; float wQ = abs ( EU . a * EU . a - EV . a * EV . a ) / 2.0 ; float qR = 0.5 * clamp ( 1.0 - sqrt ( wQ ) * SMAA_REPROJECTION_WEIGHT_SCALE , 0.0 , 1.0 ) ; vec4 m = mix ( EU , EV , qR ) ; m . a = 1.0 ; return m ;".split(" ")}]}},
{a:"else",h:{a:"grp",c:[{a:"txt",b:"vec4 EU = GLSL_TEXTURE ( ES , bv ) ; vec4 EV = GLSL_TEXTURE ( ET , bv ) ; return mix ( EU , EV , 0.5 ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["void","main","(",")","{"]},{a:"cond",c:[{a:"if",e:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"vec4 m = vec4 ( Ei ( bQ , u_color".split(" ")},{a:"cond",c:[{a:"if",e:["SMAA_PREDICATION"],h:{a:"grp",c:[{a:"txt",b:[",","u_predication_tex"]}]}}]},{a:"txt",b:") , 0.0 , 0.0 ) ;".split(" ")}]}},
{a:"elif",e:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"vec4 m = EJ ( bQ , DL , u_color , u_area_tex , u_search_tex , u_subsample_indices ) ;".split(" ")}]}},{a:"elif",e:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"vec4 m = ER ( bQ , u_color , u_blend".split(" ")},{a:"cond",c:[{a:"if",e:["SMAA_REPROJECTION"],h:{a:"grp",c:[{a:"txt",b:[",","u_velocity_tex"]}]}}]},{a:"txt",b:[")",";"]}]}},{a:"elif",e:["SMAA_PASS",
"SMAA_RESOLVE",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"vec4 m = vec4 ( EW ( bQ , u_color , u_color_prev".split(" ")},{a:"cond",c:[{a:"if",e:["SMAA_REPROJECTION"],h:{a:"grp",c:[{a:"txt",b:[",","u_velocity_tex"]}]}}]},{a:"txt",b:[")",")",";"]}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"vec4 m = GLSL_TEXTURE ( u_color , bQ ) ;".split(" ")}]}}]},{a:"txt",b:["GLSL_OUT_FRAG_COLOR","=","m",";","}"]}]};a["postprocessing/smaa.glslv"]={a:"grp",c:[{a:"version",b:["GLSL_VERSION"]},{a:"define",d:"SMAA_EDGE_DETECTION",
b:["1"]},{a:"define",d:"SMAA_BLENDING_WEIGHT_CALCULATION",b:["2"]},{a:"define",d:"SMAA_NEIGHBORHOOD_BLENDING",b:["3"]},{a:"define",d:"AA_METHOD_SMAA_LOW",b:["1"]},{a:"define",d:"AA_METHOD_SMAA_MEDIUM",b:["2"]},{a:"define",d:"AA_METHOD_SMAA_HIGH",b:["3"]},{a:"define",d:"AA_METHOD_SMAA_ULTRA",b:["4"]},{a:"txt",b:"uniform vec2 u_texel_size ; GLSL_IN vec2 a_position ; GLSL_OUT vec2 bQ ;".split(" ")},{a:"cond",c:[{a:"if",e:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",
b:["GLSL_OUT","vec4","DH",";"]}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"GLSL_OUT vec4 DI ; GLSL_OUT vec4 DJ ; GLSL_OUT vec4 DK ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["GLSL_OUT","vec2","DL",";"]}]}}]},{a:"cond",c:[{a:"if",e:["AA_METHOD","AA_METHOD_SMAA_LOW",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"define",d:"SMAA_MAX_SEARCH_STEPS",b:["4"]}]}},{a:"elif",e:["AA_METHOD","AA_METHOD_SMAA_MEDIUM",{a:"equal_expr",
i:2}],h:{a:"grp",c:[{a:"define",d:"SMAA_MAX_SEARCH_STEPS",b:["8"]}]}},{a:"elif",e:["AA_METHOD","AA_METHOD_SMAA_HIGH",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"define",d:"SMAA_MAX_SEARCH_STEPS",b:["16"]}]}},{a:"elif",e:["AA_METHOD","AA_METHOD_SMAA_ULTRA",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"define",d:"SMAA_MAX_SEARCH_STEPS",b:["32"]}]}}]},{a:"cond",c:[{a:"ifndef",d:"SMAA_MAX_SEARCH_STEPS",h:{a:"grp",c:[{a:"define",d:"SMAA_MAX_SEARCH_STEPS",b:["16"]}]}}]},{a:"cond",c:[{a:"if",e:["SMAA_PASS","SMAA_EDGE_DETECTION",
{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"void EX ( vec2 bv ) { DI = u_texel_size . xyxy * vec4 ( - 1.0 , 0.0 , 0.0 , - 1.0 ) + bv . xyxy ; DJ = u_texel_size . xyxy * vec4 ( 1.0 , 0.0 , 0.0 , 1.0 ) + bv . xyxy ; DK = u_texel_size . xyxy * vec4 ( - 2.0 , 0.0 , 0.0 , - 2.0 ) + bv . xyxy ; }".split(" ")}]}},{a:"elif",e:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"void EY ( vec2 bv , out vec2 EH ) { EH = bv / u_texel_size ; DI = u_texel_size . xyxy * vec4 ( - 0.25 , - 0.125 , 1.25 , - 0.125 ) + bv . xyxy ; DJ = u_texel_size . xyxy * vec4 ( - 0.125 , - 0.25 , - 0.125 , 1.25 ) + bv . xyxy ; DK = u_texel_size . xxyy * vec4 ( - 2.0 , 2.0 , - 2.0 , 2.0 ) * float ( SMAA_MAX_SEARCH_STEPS ) + vec4 ( DI . xz , DJ . yw ) ; }".split(" ")}]}},
{a:"elif",e:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"void EZ ( vec2 bv ) { DH = u_texel_size . xyxy * vec4 ( 1.0 , 0.0 , 0.0 , 1.0 ) + bv . xyxy ; }".split(" ")}]}}]},{a:"txt",b:"void main ( ) { bQ = 2.0 * a_position ;".split(" ")},{a:"cond",c:[{a:"if",e:["SMAA_PASS","SMAA_EDGE_DETECTION",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["EX","(","bQ",")",";"]}]}},{a:"elif",e:["SMAA_PASS","SMAA_BLENDING_WEIGHT_CALCULATION",{a:"equal_expr",i:2}],h:{a:"grp",
c:[{a:"txt",b:"EY ( bQ , DL ) ;".split(" ")}]}},{a:"elif",e:["SMAA_PASS","SMAA_NEIGHBORHOOD_BLENDING",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["EZ","(","bQ",")",";"]}]}}]},{a:"txt",b:"gl_Position = vec4 ( 4.0 * ( a_position . xy - 0.25 ) , 0.0 , 1.0 ) ; }".split(" ")}]};a["postprocessing/ssao.glslf"]={a:"grp",c:[{a:"version",b:["GLSL_VERSION"]},{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",n:"precision_statement.glslf"},{a:"include",n:"depth_fetch.glslf"},{a:"include",
n:"procedural.glslf"},{a:"define",d:"SSAO_QUALITY_8",b:["1"]},{a:"define",d:"SSAO_QUALITY_16",b:["2"]},{a:"define",d:"SSAO_QUALITY_24",b:["3"]},{a:"define",d:"SSAO_QUALITY_32",b:["4"]},{a:"txt",b:"uniform sampler2D u_color ; uniform sampler2D u_depth ; uniform sampler2D u_ssao_special_tex ; uniform vec2 u_camera_range ; uniform vec2 u_texel_size ; uniform float u_ssao_radius_increase ; uniform float u_ssao_influence ; uniform float u_ssao_dist_factor ; GLSL_IN vec2 bQ ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; float E_ ( in vec2 aY ) { return Cu ( u_depth , aY , u_camera_range ) ; } void main ( ) { vec3 Cy = GLSL_TEXTURE ( u_color , bQ ) . rgb ;".split(" ")},
{a:"cond",c:[{a:"if",e:["SSAO_WHITE"],h:{a:"grp",c:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( Cy , 1.0 ) ; return ;".split(" ")}]}}]},{a:"txt",b:"vec3 Fa = normalize ( 2.0 * GLSL_TEXTURE ( u_ssao_special_tex , bQ * 0.25 / u_texel_size ) . rgb - 1.0 ) ; float ao = E_ ( bQ ) ; float Fb = ao * ( u_camera_range . y - u_camera_range . x ) ;".split(" ")},{a:"cond",c:[{a:"if",e:["SSAO_QUALITY","SSAO_QUALITY_8",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"const float Fc = 8.0 ; const int Fd = 1 ;".split(" ")}]}},
{a:"elif",e:["SSAO_QUALITY","SSAO_QUALITY_16",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"const float Fc = 16.0 ; const int Fd = 2 ;".split(" ")}]}},{a:"elif",e:["SSAO_QUALITY","SSAO_QUALITY_24",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"const float Fc = 24.0 ; const int Fd = 3 ;".split(" ")}]}},{a:"elif",e:["SSAO_QUALITY","SSAO_QUALITY_32",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"const float Fc = 32.0 ; const int Fd = 4 ;".split(" ")}]}}]},{a:"txt",b:"float Fe = u_ssao_radius_increase * 0.001 ; const float Ff = 1.0 + 2.4 / Fc ; float al = 0.0 ; for ( int aQ = 0 ; aQ < Fd ; aQ ++ ) for ( int x = - 1 ; x <= 1 ; x += 2 ) for ( int y = - 1 ; y <= 1 ; y += 2 ) for ( int z = - 1 ; z <= 1 ; z += 2 ) { vec3 Fg = reflect ( normalize ( vec3 ( x , y , z ) ) , Fa ) * ( Fe *= Ff ) ; vec3 sI = vec3 ( bQ , Fb ) ; sI += vec3 ( Fg . xy , Fg . z * Fb * 2.0 ) ;".split(" ")},
{a:"cond",c:[{a:"if",e:["SSAO_HEMISPHERE"],h:{a:"grp",c:[{a:"txt",b:"sI . z -= 1.4 * ( sI . z - Fb ) * step ( Fb , sI . z ) ;".split(" ")}]}}]},{a:"txt",b:"float Fh = E_ ( sI . xy ) * ( u_camera_range . y - u_camera_range . x ) ; float Fi = clamp ( ( Fb - Fh ) / Fh , 0.0 , 1.0 ) ;".split(" ")},{a:"cond",c:[{a:"if",e:["SSAO_HEMISPHERE"],h:{a:"grp",c:[{a:"txt",b:"al += mix ( 1.0 , Fi , step ( Fh , sI . z ) ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"al += mix ( step ( sI . z , Fh ) , 0.5 , Fi ) ;".split(" ")}]}}]},
{a:"txt",b:"} al = al / Fc ;".split(" ")},{a:"cond",c:[{a:"if",e:["SSAO_HEMISPHERE"],h:{a:"grp",c:[{a:"txt",b:"al = clamp ( al * al + 0.6 * al , 0.0 , 1.0 ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"al = clamp ( al * al + al , 0.0 , 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:"float Fj = u_ssao_influence * ( 1.0 - u_ssao_dist_factor * ao ) ; al = mix ( 1.0 , al , Fj ) ; GLSL_OUT_FRAG_COLOR = vec4 ( Cy , al ) ; }".split(" ")}]};a["postprocessing/ssao_blur.glslf"]={a:"grp",c:[{a:"version",b:["GLSL_VERSION"]},
{a:"txt",b:["precision","PRECISION","sampler2D",";"]},{a:"include",n:"precision_statement.glslf"},{a:"cond",c:[{a:"if",e:["SSAO_BLUR_DEPTH"],h:{a:"grp",c:[{a:"include",n:"depth_fetch.glslf"}]}}]},{a:"txt",b:"uniform sampler2D u_ssao_mask ; uniform vec2 u_texel_size ; GLSL_IN vec2 bQ ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ;".split(" ")},{a:"cond",c:[{a:"if",e:["SSAO_BLUR_DEPTH"],h:{a:"grp",c:[{a:"txt",b:"uniform sampler2D u_depth ; uniform vec2 u_camera_range ; uniform float u_ssao_blur_discard_value ; float E_ ( in vec2 aY ) { return Cu ( u_depth , aY , u_camera_range ) ; }".split(" ")}]}}]},
{a:"txt",b:"void main ( ) { float Fk = 0.0 ;".split(" ")},{a:"cond",c:[{a:"if",e:["SSAO_BLUR_DEPTH"],h:{a:"grp",c:[{a:"txt",b:"float Fl = E_ ( bQ ) ; float qR = 0.0 ; float Fm = u_ssao_blur_discard_value * 100.0 ;".split(" ")}]}}]},{a:"txt",b:"vec2 Fn = vec2 ( - 2.0 ) ; for ( int aQ = 0 ; aQ < 4 ; ++ aQ ) { for ( int Dd = 0 ; Dd < 4 ; ++ Dd ) { vec2 cm = ( Fn + vec2 ( float ( aQ ) , float ( Dd ) ) ) * u_texel_size ; float Fo = GLSL_TEXTURE ( u_ssao_mask , bQ + cm ) . a ;".split(" ")},{a:"cond",c:[{a:"if",
e:["SSAO_BLUR_DEPTH"],h:{a:"grp",c:[{a:"txt",b:"float Fp = E_ ( bQ + cm ) ; float Fq = 1.0 - clamp ( abs ( Fp - Fl ) * Fm , 0.0 , 1.0 ) ; Fk += Fo * Fq ; qR += Fq ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:["Fk","+=","Fo",";"]}]}}]},{a:"txt",b:["}","}"]},{a:"cond",c:[{a:"if",e:["SSAO_BLUR_DEPTH"],h:{a:"grp",c:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( GLSL_TEXTURE ( u_ssao_mask , bQ ) . rgb , Fk / qR ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"GLSL_OUT_FRAG_COLOR = vec4 ( GLSL_TEXTURE ( u_ssao_mask , bQ ) . rgb , Fk / 16.0 ) ;".split(" ")}]}}]},
{a:"txt",b:["}"]}]};a["postprocessing/stereo.glslf"]={a:"grp",c:[{a:"version",b:["GLSL_VERSION"]},{a:"include",n:"precision_statement.glslf"},{a:"include",n:"color_util.glslf"},{a:"txt",b:"uniform sampler2D u_sampler_left ; uniform sampler2D u_sampler_right ;".split(" ")},{a:"cond",c:[{a:"if",e:["ANAGLYPH",{a:"logic_negative_expr",i:1}],h:{a:"grp",c:[{a:"txt",b:"uniform int u_enable_hmd_stereo ; uniform vec4 u_distortion_params ; uniform vec4 u_chromatic_aberration_coefs ; void FA ( vec2 bv , vec2 h , float wU , sampler2D Fr ) { vec2 Fs = ( bv - h ) * 2.0 ; Fs /= wU ; float Ft = Fs . x * Fs . x + Fs . y * Fs . y ; vec2 Fu = Fs * ( 1.0 + u_distortion_params [ 0 ] * Ft + u_distortion_params [ 1 ] * Ft * Ft ) ; vec2 Fv = Fu * 0.5 / ( 1.0 + u_distortion_params [ 0 ] + u_distortion_params [ 1 ] ) ; if ( length ( u_chromatic_aberration_coefs ) > 0.0 ) { vec2 Fw = Fv * ( 1.0 + u_chromatic_aberration_coefs [ 0 ] + Ft * u_chromatic_aberration_coefs [ 1 ] ) + h ; vec2 Fx = Fv + h ; vec2 Fy = Fv * ( 1.0 + u_chromatic_aberration_coefs [ 2 ] + Ft * u_chromatic_aberration_coefs [ 3 ] ) + h ; if ( clamp ( Fy , 0.0 , 1.0 ) != Fy ) { GLSL_OUT_FRAG_COLOR = vec4 ( 0.0 ) ; } else { vec4 Fz = GLSL_TEXTURE ( Fr , Fx ) ; GLSL_OUT_FRAG_COLOR [ 0 ] = GLSL_TEXTURE ( Fr , Fw ) . x ; GLSL_OUT_FRAG_COLOR [ 1 ] = Fz . y ; GLSL_OUT_FRAG_COLOR [ 2 ] = GLSL_TEXTURE ( Fr , Fy ) . z ; GLSL_OUT_FRAG_COLOR [ 3 ] = Fz . w ; } } else { Fv = Fv * wU + h ; if ( clamp ( Fv , 0.0 , 1.0 ) != Fv ) { GLSL_OUT_FRAG_COLOR = vec4 ( 0.0 ) ; } else { GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( Fr , Fv ) ; } } }".split(" ")}]}}]},
{a:"txt",b:"GLSL_IN vec2 bQ ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) {".split(" ")},{a:"cond",c:[{a:"if",e:["ANAGLYPH"],h:{a:"grp",c:[{a:"txt",b:"vec4 FB = GLSL_TEXTURE ( u_sampler_left , bQ ) ; vec4 FC = GLSL_TEXTURE ( u_sampler_right , bQ ) ; vec3 FD = vec3 ( FB [ 0 ] , FB [ 1 ] , FB [ 2 ] ) ; bd ( FD ) ; vec3 FE = vec3 ( FC [ 0 ] , FC [ 1 ] , FC [ 2 ] ) ; bd ( FE ) ; mat3 wZ = mat3 ( 0.437 , - 0.062 , - 0.048 , 0.449 , - 0.062 , - 0.050 , 0.164 , - 0.024 , - 0.017 ) ; mat3 w_ = mat3 ( - 0.011 , 0.377 , - 0.026 , - 0.032 , 0.761 , - 0.093 , - 0.007 , 0.009 , 1.234 ) ; vec3 m = clamp ( wZ * FD , 0.0 , 1.0 ) + clamp ( w_ * FE , 0.0 , 1.0 ) ; be ( m ) ; GLSL_OUT_FRAG_COLOR = vec4 ( m , FB [ 3 ] + FC [ 3 ] ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",c:[{a:"txt",b:"if ( u_enable_hmd_stereo != 0 ) { if ( bQ [ 0 ] < 0.5 ) { vec2 bv = vec2 ( 2.0 * bQ [ 0 ] , bQ [ 1 ] ) ; vec2 h = vec2 ( 0.5 - ( u_distortion_params [ 3 ] - 0.5 ) / 2.0 , u_distortion_params [ 2 ] ) ; float wU = 2.0 * u_distortion_params [ 3 ] ; FA ( bv , h , wU , u_sampler_left ) ; } else { vec2 bv = vec2 ( 2.0 * ( bQ [ 0 ] - 0.5 ) , bQ [ 1 ] ) ; vec2 h = vec2 ( 0.5 + ( u_distortion_params [ 3 ] - 0.5 ) / 2.0 , u_distortion_params [ 2 ] ) ; float wU = 2.0 * u_distortion_params [ 3 ] ; FA ( bv , h , wU , u_sampler_right ) ; } } else { GLSL_OUT_FRAG_COLOR = GLSL_TEXTURE ( u_sampler_left , bQ ) ; }".split(" ")}]}}]},
{a:"txt",b:["}"]}]};a["postprocessing/velocity.glslf"]={a:"grp",c:[{a:"version",b:["GLSL_VERSION"]},{a:"include",n:"precision_statement.glslf"},{a:"include",n:"pack.glslf"},{a:"txt",b:"uniform sampler2D u_depth ; uniform mat4 u_view_proj_inverse ; uniform mat4 u_view_proj_prev ; GLSL_IN vec2 bQ ; GLSL_OUT vec4 GLSL_OUT_FRAG_COLOR ; void main ( ) { float ao = GLSL_TEXTURE ( u_depth , bQ ) . x ; vec4 FF = vec4 ( bQ * 2.0 - 1.0 , 2.0 * ao - 1.0 , 1.0 ) ; vec4 cU = u_view_proj_inverse * FF ; vec4 FG = cU / cU . w ; vec4 FH = u_view_proj_prev * FG ; FH /= FH . w ; vec2 wV = ( FF . xy - FH . xy ) / 4.0 + 0.5 ; wV = clamp ( wV , 0.0 , 1.0 ) ; GLSL_OUT_FRAG_COLOR = am ( wV ) ; }".split(" ")}]};
a["include/precision_statement.glslf"]={a:"grp",c:[{a:"txt",b:["precision","PRECISION","float",";"]}]};a["include/math.glslv"]={a:"grp",c:[{a:"txt",b:"float c = 0.0 ; float d = 1.0 ; struct e { vec3 f ; vec3 h ; vec3 i ; vec3 j ; vec3 k ; vec3 l ; vec3 m ; } ; bool n ( vec3 a , vec3 b ) { return any ( lessThan ( abs ( a - b ) , vec3 ( EPSILON ) ) ) ; } vec3 u ( in vec4 q , in vec3 o ) { return o + 2.0 * cross ( q . xyz , cross ( q . xyz , o ) + q . w * o ) ; } vec4 A ( in vec4 v ) { return vec4 ( - v . xyz , v . w ) ; } vec3 E ( vec4 B , vec4 v , vec3 C ) { vec3 D = C * B . w ; D = u ( v , D ) ; D += B . xyz ; return D ; } vec3 G ( mat3 F , vec3 C ) { vec3 D = C * F [ 1 ] [ 0 ] ; vec4 v = vec4 ( F [ 1 ] [ 1 ] , F [ 1 ] [ 2 ] , F [ 2 ] [ 0 ] , F [ 2 ] [ 1 ] ) ; D = u ( v , D ) ; D += F [ 0 ] ; return D ; } vec3 I ( vec4 B , vec4 v , vec3 H ) { vec3 D = H * B . w ; D = u ( v , D ) ; return D ; } vec3 J ( mat3 F , vec3 H ) { vec3 D = H * F [ 1 ] [ 0 ] ; vec4 v = vec4 ( F [ 1 ] [ 1 ] , F [ 1 ] [ 2 ] , F [ 2 ] [ 0 ] , F [ 2 ] [ 1 ] ) ; D = u ( v , D ) ; return D ; } vec3 L ( vec4 B , vec4 v , vec3 C ) { vec3 D = C - B . xyz ; D = u ( A ( v ) , D ) ; D /= B . w ; return D ; } vec3 M ( vec4 B , vec4 v , vec3 H ) { return u ( A ( v ) , H ) / B . w ; } mat4 N ( ) { return mat4 ( d , c , c , c , c , d , c , c , c , c , d , c , c , c , c , d ) ; } mat4 P ( float O ) { return mat4 ( d , c , c , c , c , cos ( O ) , sin ( O ) , c , c , - sin ( O ) , cos ( O ) , c , c , c , c , d ) ; } mat4 Q ( float O ) { return mat4 ( cos ( O ) , c , - sin ( O ) , c , c , d , c , c , sin ( O ) , c , cos ( O ) , c , c , c , c , d ) ; } mat4 R ( float O ) { return mat4 ( cos ( O ) , sin ( O ) , c , c , - sin ( O ) , cos ( O ) , c , c , c , c , d , c , c , c , c , d ) ; } e S ( in e o ) { return e ( o . f , o . h , normalize ( o . i ) , normalize ( o . j ) , normalize ( o . k ) , normalize ( o . l ) , o . m ) ; }".split(" ")},
{a:"cond",c:[{a:"if",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2},"REFRACTIVE","USE_NODE_B4W_REFRACTION",{a:"logical_or_expr",i:4}],h:{a:"grp",c:[{a:"txt",b:"vec3 Y ( vec4 T ) { float U = T . x ; float V = T . y ; float W = T . w ; vec3 X ; X . x = ( U + W ) / 2.0 ; X . y = ( V + W ) / 2.0 ; X . z = W ; return X ; }".split(" ")}]}}]},{a:"txt",b:"mat4 _ ( mat3 t ) { mat4 Z ; Z [ 0 ] [ 0 ] = ( d - ( t [ 1 ] [ 2 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) + t [ 2 ] [ 0 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) ) ) * t [ 1 ] [ 0 ] ; Z [ 0 ] [ 1 ] = ( t [ 1 ] [ 1 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) + t [ 2 ] [ 1 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) ) * t [ 1 ] [ 0 ] ; Z [ 0 ] [ 2 ] = ( t [ 1 ] [ 1 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) - t [ 2 ] [ 1 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) ) * t [ 1 ] [ 0 ] ; Z [ 0 ] [ 3 ] = c ; Z [ 1 ] [ 0 ] = ( t [ 1 ] [ 1 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) - t [ 2 ] [ 1 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) ) * t [ 1 ] [ 0 ] ; Z [ 1 ] [ 1 ] = ( d - ( t [ 1 ] [ 1 ] * ( t [ 1 ] [ 1 ] + t [ 1 ] [ 1 ] ) + t [ 2 ] [ 0 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) ) ) * t [ 1 ] [ 0 ] ; Z [ 1 ] [ 2 ] = ( t [ 1 ] [ 2 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) + t [ 2 ] [ 1 ] * ( t [ 1 ] [ 1 ] + t [ 1 ] [ 1 ] ) ) * t [ 1 ] [ 0 ] ; Z [ 1 ] [ 3 ] = c ; Z [ 2 ] [ 0 ] = ( t [ 1 ] [ 1 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) + t [ 2 ] [ 1 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) ) * t [ 1 ] [ 0 ] ; Z [ 2 ] [ 1 ] = ( t [ 1 ] [ 2 ] * ( t [ 2 ] [ 0 ] + t [ 2 ] [ 0 ] ) - t [ 2 ] [ 1 ] * ( t [ 1 ] [ 1 ] + t [ 1 ] [ 1 ] ) ) * t [ 1 ] [ 0 ] ; Z [ 2 ] [ 2 ] = ( d - ( t [ 1 ] [ 1 ] * ( t [ 1 ] [ 1 ] + t [ 1 ] [ 1 ] ) + t [ 1 ] [ 2 ] * ( t [ 1 ] [ 2 ] + t [ 1 ] [ 2 ] ) ) ) * t [ 1 ] [ 0 ] ; Z [ 2 ] [ 3 ] = c ; Z [ 3 ] [ 0 ] = t [ 0 ] [ 0 ] ; Z [ 3 ] [ 1 ] = t [ 0 ] [ 1 ] ; Z [ 3 ] [ 2 ] = t [ 0 ] [ 2 ] ; Z [ 3 ] [ 3 ] = 1.0 ; return Z ; }".split(" ")},
{a:"cond",c:[{a:"if",e:["USE_INSTANCED_PARTCLS"],h:{a:"grp",c:[{a:"txt",b:"mat3 ad ( mat3 F , mat3 ac ) { mat3 D ; vec3 C = ac [ 0 ] ; vec4 B = vec4 ( F [ 0 ] , F [ 1 ] [ 0 ] ) ; vec4 v = vec4 ( F [ 1 ] [ 1 ] , F [ 1 ] [ 2 ] , F [ 2 ] [ 0 ] , F [ 2 ] [ 1 ] ) ; D [ 0 ] = E ( B , v , C ) ; D [ 1 ] [ 0 ] = F [ 1 ] [ 0 ] * ac [ 1 ] [ 0 ] ; D [ 1 ] [ 1 ] = F [ 1 ] [ 1 ] * ac [ 2 ] [ 1 ] + F [ 2 ] [ 1 ] * ac [ 1 ] [ 1 ] + F [ 1 ] [ 2 ] * ac [ 2 ] [ 0 ] - F [ 2 ] [ 0 ] * ac [ 1 ] [ 2 ] ; D [ 1 ] [ 2 ] = F [ 1 ] [ 2 ] * ac [ 2 ] [ 1 ] + F [ 2 ] [ 1 ] * ac [ 1 ] [ 2 ] + F [ 2 ] [ 0 ] * ac [ 1 ] [ 1 ] - F [ 1 ] [ 1 ] * ac [ 2 ] [ 0 ] ; D [ 2 ] [ 0 ] = F [ 2 ] [ 0 ] * ac [ 2 ] [ 1 ] + F [ 2 ] [ 1 ] * ac [ 2 ] [ 0 ] + F [ 1 ] [ 1 ] * ac [ 1 ] [ 2 ] - F [ 1 ] [ 2 ] * ac [ 1 ] [ 1 ] ; D [ 2 ] [ 1 ] = F [ 2 ] [ 1 ] * ac [ 2 ] [ 1 ] - F [ 1 ] [ 1 ] * ac [ 1 ] [ 1 ] - F [ 1 ] [ 2 ] * ac [ 1 ] [ 2 ] - F [ 2 ] [ 0 ] * ac [ 2 ] [ 0 ] ; return D ; }".split(" ")}]}}]}]};
a["include/std_enums.glsl"]={a:"grp",c:[{a:"define",d:"TEXTURE_COORDS_UV_ORCO",b:["1"]},{a:"define",d:"TEXTURE_COORDS_NORMAL",b:["2"]},{a:"define",d:"TEXTURE_BLEND_TYPE_MIX",b:["1"]},{a:"define",d:"TEXTURE_BLEND_TYPE_MULTIPLY",b:["2"]},{a:"define",d:"SHADOW_SRC_NONE",b:["1"]},{a:"define",d:"SHADOW_SRC_DEPTH",b:["2"]},{a:"define",d:"SHADOW_SRC_MASK",b:["3"]},{a:"define",d:"SHADOW_DST_NONE",b:["1"]},{a:"define",d:"SHADOW_DST_DEPTH",b:["2"]},{a:"define",d:"SHADOW_DST_MASK",b:["3"]},{a:"define",d:"NO_SHADOWS",
b:["1"]},{a:"define",d:"SHADOW_CASTING",b:["2"]},{a:"define",d:"SHADOW_MASK_GENERATION",b:["3"]},{a:"define",d:"SHADOW_MAPPING_OPAQUE",b:["4"]},{a:"define",d:"SHADOW_MAPPING_BLEND",b:["5"]},{a:"define",d:"SPECULAR_PHONG",b:["1"]},{a:"define",d:"SPECULAR_COOKTORR",b:["2"]},{a:"define",d:"SPECULAR_WARDISO",b:["3"]},{a:"define",d:"SPECULAR_BLINN",b:["4"]},{a:"define",d:"SPECULAR_TOON",b:["5"]},{a:"define",d:"DIFFUSE_LAMBERT",b:["1"]},{a:"define",d:"DIFFUSE_OREN_NAYAR",b:["2"]},{a:"define",d:"DIFFUSE_FRESNEL",
b:["3"]},{a:"define",d:"DIFFUSE_MINNAERT",b:["4"]},{a:"define",d:"DIFFUSE_TOON",b:["5"]},{a:"define",d:"MAPPING_TYPE_TEXTURE",b:["0.0"]},{a:"define",d:"MAPPING_TYPE_POINT",b:["1.0"]},{a:"define",d:"MAPPING_TYPE_VECTOR",b:["2.0"]},{a:"define",d:"MAPPING_TYPE_NORMAL",b:["3.0"]},{a:"define",d:"MIX",b:["0"]},{a:"define",d:"ADD",b:["1"]},{a:"define",d:"SUBTRACT",b:["2"]},{a:"define",d:"MULTIPLY",b:["3"]},{a:"define",d:"SCREEN",b:["4"]},{a:"define",d:"OVERLAY",b:["5"]},{a:"define",d:"DIFFERENCE",b:["6"]},
{a:"define",d:"DIVIDE",b:["7"]},{a:"define",d:"DARKEN",b:["8"]},{a:"define",d:"LIGHTEN",b:["9"]},{a:"define",d:"HUE",b:["10"]},{a:"define",d:"SATURATION",b:["11"]},{a:"define",d:"VALUE",b:["12"]},{a:"define",d:"COLOR",b:["13"]},{a:"define",d:"SOFT_LIGHT",b:["14"]},{a:"define",d:"LINEAR_LIGHT",b:["15"]},{a:"define",d:"REFL_NONE",b:["0"]},{a:"define",d:"REFL_MIRRORMAP",b:["1"]},{a:"define",d:"REFL_PLANE",b:["2"]},{a:"define",d:"REFL_CUBE",b:["3"]},{a:"define",d:"INVERSE_QUADRATIC",b:["0"]},{a:"define",
d:"LINEAR",b:["1"]},{a:"define",d:"QUADRATIC",b:["2"]},{a:"define",d:"HEMI",b:["1"]},{a:"define",d:"SPOT",b:["2"]},{a:"define",d:"POINT",b:["3"]},{a:"define",d:"SUN",b:["4"]},{a:"define",d:"DOF_SIMPLE",b:["0"]},{a:"define",d:"DOF_BOKEH",b:["1"]},{a:"define",d:"COC_ALL",b:["0"]},{a:"define",d:"COC_FOREGROUND",b:["1"]},{a:"define",d:"COC_COMBINE",b:["2"]},{a:"define",d:"VT_WORLD_TO_WORLD",b:["0"]},{a:"define",d:"VT_WORLD_TO_OBJECT",b:["1"]},{a:"define",d:"VT_WORLD_TO_CAMERA",b:["2"]},{a:"define",d:"VT_OBJECT_TO_WORLD",
b:["3"]},{a:"define",d:"VT_OBJECT_TO_OBJECT",b:["4"]},{a:"define",d:"VT_OBJECT_TO_CAMERA",b:["5"]},{a:"define",d:"VT_CAMERA_TO_WORLD",b:["6"]},{a:"define",d:"VT_CAMERA_TO_OBJECT",b:["7"]},{a:"define",d:"VT_CAMERA_TO_CAMERA",b:["8"]},{a:"define",d:"VT_POINT",b:["0"]},{a:"define",d:"VT_VECTOR",b:["1"]},{a:"define",d:"VT_NORMAL",b:["2"]},{a:"define",d:"NM_TANGENT",b:["0"]},{a:"define",d:"NM_OBJECT",b:["1"]},{a:"define",d:"NM_WORLD",b:["2"]},{a:"define",d:"NM_BLENDER_OBJECT",b:["3"]},{a:"define",d:"NM_BLENDER_WORLD",
b:["4"]}]};a["include/pack.glslf"]={a:"grp",c:[{a:"txt",b:"float ae = 255.0 ; float af = 0.0 ; float ah = 1.0 ; vec4 am ( const in float ai ) { vec4 aj = vec4 ( ae * ae * ae , ae * ae , ae , ah ) ; vec4 ak = vec4 ( af , ah / ae , ah / ae , ah / ae ) ; vec4 al = fract ( ai * aj ) ; al -= al . xxyz * ak ; return al ; } float ap ( const in vec4 an ) { float ao ; vec4 aj = vec4 ( ah / ( ae * ae * ae ) , ah / ( ae * ae ) , ah / ae , ah ) ; ao = dot ( an , aj ) ; return ao ; } vec4 am ( const in vec2 C ) { vec2 aj = vec2 ( ae , ah ) ; vec2 ak = vec2 ( af , ah / ae ) ; vec4 al = fract ( C . xxyy * aj . xyxy ) ; al -= al . xxzz * ak . xyxy ; if ( C . r == ah ) al . rg = vec2 ( af , ah ) ; if ( C . g == ah ) al . ba = vec2 ( af , ah ) ; return al ; } vec2 as ( const in vec4 aq ) { vec2 C ; vec2 aj = vec2 ( ah / ae , ah ) ; C . r = dot ( aq . rg , aj ) ; C . g = dot ( aq . ba , aj ) ; return C ; }".split(" ")}]};
a["include/procedural.glslf"]={a:"grp",c:[{a:"txt",b:"float at = 0.0 ; float au = 1.0 ; vec4 av ( vec4 x ) { return x - floor ( x * ( au / 289.0 ) ) * 289.0 ; } vec3 av ( vec3 x ) { return x - floor ( x * ( au / 289.0 ) ) * 289.0 ; } vec2 av ( vec2 x ) { return x - floor ( x * ( au / 289.0 ) ) * 289.0 ; } vec4 aw ( vec4 x ) { return x - floor ( x * ( au / 7.0 ) ) * 7.0 ; } vec4 ax ( vec4 x ) { return av ( ( 34.0 * x + 5.0 ) * x ) ; }".split(" ")},{a:"define",d:"K",b:["0.142857142857"]},{a:"define",
d:"K2",b:["0.0714285714285"]},{a:"define",d:"JITTER",b:["0.7"]},{a:"txt",b:"vec2 aI ( vec2 ay ) { vec2 az = av ( floor ( ay ) ) ; vec2 aA = fract ( ay ) ; vec4 aB = aA . x + vec4 ( - 0.5 , - 1.5 , - 0.5 , - 1.5 ) ; vec4 aC = aA . y + vec4 ( - 0.5 , - 0.5 , - 1.5 , - 1.5 ) ; vec4 p = ax ( az . x + vec4 ( at , au , at , au ) ) ; p = ax ( p + az . y + vec4 ( at , at , au , au ) ) ; vec4 aD = aw ( p ) * K + K2 ; vec4 aE = aw ( floor ( p * K ) ) * K + K2 ; vec4 aF = aB + JITTER * aD ; vec4 aG = aC + JITTER * aE ; vec4 aH = aF * aF + aG * aG ;".split(" ")},
{a:"cond",c:[{a:"if",e:[1],h:{a:"grp",c:[{a:"txt",b:"aH . xy = min ( aH . xy , aH . zw ) ; aH . x = min ( aH . x , aH . y ) ; return aH . xx ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"aH . xy = ( aH . x < aH . y ) ? aH . xy : aH . yx ; aH . xz = ( aH . x < aH . z ) ? aH . xz : aH . zx ; aH . xw = ( aH . x < aH . w ) ? aH . xw : aH . wx ; aH . y = min ( aH . y , aH . z ) ; aH . y = min ( aH . y , aH . w ) ; return sqrt ( aH . xy ) ;".split(" ")}]}}]},{a:"txt",b:"} vec3 aN ( vec2 ay , float aJ ) { vec2 az = av ( floor ( ay ) ) ; vec2 aA = fract ( ay ) ; vec4 aB = aA . x + vec4 ( - 0.5 , - 1.5 , - 0.5 , - 1.5 ) ; vec4 aC = aA . y + vec4 ( - 0.5 , - 0.5 , - 1.5 , - 1.5 ) ; vec4 p = ax ( az . x + vec4 ( at , au , at , au ) ) ; p = ax ( p + az . y + vec4 ( at , at , au , au ) ) ; vec4 aD = aw ( p ) * K + K2 ; vec4 aE = aw ( floor ( p * K ) ) * K + K2 ; vec4 aF = aB + JITTER * aD ; vec4 aG = aC + JITTER * aE ; vec4 aK = aF * aF + aG * aG ; aF += aJ ; aG += aJ ; vec4 aL = aF * aF + aG * aG ; aF += aJ ; aG += aJ ; vec4 aM = aF * aF + aG * aG ; aK . xy = min ( aK . xy , aK . zw ) ; aK . x = min ( aK . x , aK . y ) ; aL . xy = min ( aL . xy , aL . zw ) ; aL . x = min ( aL . x , aL . y ) ; aM . xy = min ( aM . xy , aM . zw ) ; aM . x = min ( aM . x , aM . y ) ; return vec3 ( aK . x , aL . x , aM . x ) ; } vec3 aO ( vec3 x ) { return av ( ( ( x * 34.0 ) + au ) * x ) ; } float aX ( vec2 o ) { const vec4 aP = vec4 ( 0.211324865405187 , 0.366025403784439 , - 0.577350269189626 , 0.024390243902439 ) ; vec2 aQ = floor ( o + dot ( o , aP . yy ) ) ; vec2 aR = o - aQ + dot ( aQ , aP . xx ) ; vec2 aS ; aS = ( aR . x > aR . y ) ? vec2 ( au , at ) : vec2 ( at , au ) ; vec4 aT = aR . xyxy + aP . xxzz ; aT . xy -= aS ; aQ = av ( aQ ) ; vec3 p = aO ( aO ( aQ . y + vec3 ( at , aS . y , au ) ) + aQ . x + vec3 ( at , aS . x , au ) ) ; vec3 aU = max ( 0.5 - vec3 ( dot ( aR , aR ) , dot ( aT . xy , aT . xy ) , dot ( aT . zw , aT . zw ) ) , at ) ; aU = aU * aU ; aU = aU * aU ; vec3 x = 2.0 * fract ( p * aP . www ) - au ; vec3 aV = abs ( x ) - 0.5 ; vec3 aD = floor ( x + 0.5 ) ; vec3 aW = x - aD ; aU *= 1.79284291400159 - 0.85373472095314 * ( aW * aW + aV * aV ) ; vec3 g ; g . x = aW . x * aR . x + aV . x * aR . y ; g . yz = aW . yz * aT . xz + aV . yz * aT . yw ; return 130.0 * dot ( aU , g ) ; } vec2 bc ( vec2 aY ) { float aK = dot ( aY , vec2 ( 12.9898 , 78.233 ) ) ; float aL = dot ( aY , vec2 ( 12.9898 , 78.233 ) * 2.0 ) ; float aZ = fract ( sin ( aK ) * 43758.5453 ) * 2.0 - au ; float a_ = fract ( sin ( aL ) * 43758.5453 ) * 2.0 - au ; return vec2 ( aZ , a_ ) ; }".split(" ")}]};
a["include/color_util.glslf"]={a:"grp",c:[{a:"define",d:"GAMMA",b:["1"]},{a:"define",d:"PREMULTIPLY_ALPHA",b:["1"]},{a:"txt",b:"void bd ( inout vec3 m ) {".split(" ")},{a:"cond",c:[{a:"if",e:["GAMMA"],h:{a:"grp",c:[{a:"txt",b:"m = max ( vec3 ( 0.0 ) , m ) ; m = pow ( m , vec3 ( 2.2 ) ) ;".split(" ")}]}}]},{a:"txt",b:"} void bd ( inout float m ) {".split(" ")},{a:"cond",c:[{a:"if",e:["GAMMA"],h:{a:"grp",c:[{a:"txt",b:"m = pow ( max ( 0.0 , m ) , 2.2 ) ;".split(" ")}]}}]},{a:"txt",b:"} void be ( inout vec3 m ) {".split(" ")},
{a:"cond",c:[{a:"if",e:["GAMMA"],h:{a:"grp",c:[{a:"txt",b:"m = max ( vec3 ( 0.0 ) , m ) ; m = pow ( m , vec3 ( 1.0 / 2.2 ) ) ;".split(" ")}]}}]},{a:"txt",b:"} void bh ( inout vec3 m , in float bf ) {".split(" ")},{a:"cond",c:[{a:"if",e:["PREMULTIPLY_ALPHA"],h:{a:"grp",c:[{a:"txt",b:"m = m * bf ;".split(" ")}]}}]},{a:"txt",b:"} float bk ( vec4 m ) { vec3 bi = vec3 ( 0.299 , 0.587 , 0.114 ) ; float bj = dot ( m . rgb , bi ) ; return bj ; }".split(" ")}]};a["include/caustics.glslf"]={a:"grp",c:[{a:"define",
d:"CAUSTICS_VIEW_DISTANCE",b:["100.0"]},{a:"txt",b:"void bF ( inout vec3 m , float bl , float bm , vec4 bn , vec3 l , vec3 bo , vec3 bp , vec4 bq , vec3 bs , float bt ) { if ( bt > CAUSTICS_VIEW_DISTANCE ) return ; vec3 o = bs + l ; o . xz = 10.0 * sin ( 0.1 * o . xz ) ; vec3 bu = u ( A ( bq ) , o ) ; vec2 bv = bu . xz ; vec3 bw = bo ; float bx = max ( dot ( l , bw ) , 0.0 ) ; float by = 0.025 ; vec2 bz = CAUST_SPEED * bm ; bv . s += 0.25 * sin ( dot ( bs + bm , vec3 ( 1.0 ) ) ) ; bv . t += 0.35 * ( - sin ( dot ( bs - bm , vec3 ( - 0.7 ) ) ) ) ; bv . st += 0.15 * cos ( 4.0 * bl - bz . x ) + 1.5 * sin ( bl - 0.3 * bz . y ) ; float bA = CAUST_SCALE * ( 1.0 + max ( 0.1 * bl , 0.0 ) ) ; vec3 bB = aN ( ( bv / bA ) , by ) ; bB *= CAUST_BRIGHT ; bB *= bB ; float bC = min ( 0.25 * bl , - bl ) + 1.0 ; bC = max ( bC , 0.0 ) ; float bD = bn [ SUN_NUM ] * bx ; float bE = max ( sign ( bl ) , 0.0 ) ; bD = bD + max ( 0.5 * sign ( - l . y ) * bE , 0.0 ) ; bD = min ( bD , 1.0 ) ; m += bp * bB * bC * bD ; }".split(" ")}]};
a["include/shadow.glslf"]={a:"grp",c:[{a:"define",d:"M_PI",b:["3.14159265359"]},{a:"cond",c:[{a:"if",e:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"const float bS = 0.1 ; const float bT = 0.1 ; const float bU = - 0.01 ; const float bV = 0.05 ; vec4 bW = vec4 ( 0.14383161 , 0.34495938 , - 0.38277543 , - 0.26496911 ) ; vec4 bX = vec4 ( 0.53742981 , 0.19984126 , 0.79197514 , - 0.094184101 ) ; vec4 bY = vec4 ( - 0.94201624 , - 0.91588581 , - 0.2418884 , 0.44323325 ) ; vec4 bZ = vec4 ( - 0.81544232 , 0.94558609 , - 0.81409955 , 0.97484398 ) ; vec4 b_ = vec4 ( - 0.1410079 , 0.2938776 , 0.27676845 , - 0.41893023 ) ; vec4 ca = vec4 ( - 0.4737342 , 0.78641367 , 0.19090188 , - 0.9293887 ) ; vec4 cb = vec4 ( - 0.39906216 , 0.45771432 , 0.99706507 , - 0.97511554 ) ; vec4 cc = vec4 ( - 0.87912464 , - 0.76890725 , 0.9143759 , 0.7564837 ) ; bool cf ( vec2 cd , float ce ) { return all ( lessThanEqual ( cd , vec2 ( 1.0 + ce ) ) ) && all ( greaterThanEqual ( cd , vec2 ( 0.0 - ce ) ) ) ; } float cn ( float cg , float ch , mat2 ci , vec3 cj , float ck , PRECISION sampler2D cl ) { vec2 cd , cm ; cm . x = cg ; cm . y = ch ; cm = ci * cm ; cd = cj . xy + cm * ck / SHADOW_TEX_RES ;".split(" ")},
{a:"cond",c:[{a:"if",e:["CSM_SECTION1",{a:"logic_negative_expr",i:1}],h:{a:"grp",c:[{a:"txt",b:"if ( ! cf ( cd , bU ) ) return 1.0 ;".split(" ")}]}}]},{a:"txt",b:"return step ( cj . z , GLSL_TEXTURE ( cl , cd ) . r ) ; } float cs ( vec3 cj , PRECISION sampler2D cl , float ck ) { float co = 0.0 ; cj . z = clamp ( cj . z , 0.0 , 1.0 ) ; float cp = bc ( cj . xy ) . x * M_PI ; float cq = cos ( cp ) ; float cr = sin ( cp ) ; mat2 ci = mat2 ( cq , cr , - cr , cq ) ; for ( int aQ = 0 ; aQ < 4 ; aQ ++ ) { co += cn ( bW [ aQ ] , b_ [ aQ ] , ci , cj , ck , cl ) ; co += cn ( bX [ aQ ] , ca [ aQ ] , ci , cj , ck , cl ) ; co += cn ( bY [ aQ ] , cb [ aQ ] , ci , cj , ck , cl ) ; co += cn ( bZ [ aQ ] , cc [ aQ ] , ci , cj , ck , cl ) ; } return clamp ( co / 16.0 , 0.0 , 1.0 ) ; } float cC ( vec3 ct , PRECISION sampler2D cu , vec3 cv , PRECISION sampler2D cw , float cx , float cy , float cz ) { float cA , cB ; ct . z = clamp ( ct . z , 0.0 , 1.0 ) ; cv . z = clamp ( cv . z , 0.0 , 1.0 ) ; cA = 0.0 ; cB = 0.0 ; float cp = bc ( ct . xy ) . x * M_PI ; float cq = cos ( cp ) ; float cr = sin ( cp ) ; mat2 ci = mat2 ( cq , cr , - cr , cq ) ; for ( int aQ = 0 ; aQ < 4 ; aQ ++ ) { cA += cn ( bW [ aQ ] , b_ [ aQ ] , ci , ct , cx , cu ) ; cA += cn ( bX [ aQ ] , ca [ aQ ] , ci , ct , cx , cu ) ; cA += cn ( bY [ aQ ] , cb [ aQ ] , ci , ct , cx , cu ) ; cA += cn ( bZ [ aQ ] , cc [ aQ ] , ci , ct , cx , cu ) ; } for ( int aQ = 0 ; aQ < 4 ; aQ ++ ) { cB += cn ( bW [ aQ ] , b_ [ aQ ] , ci , cv , cy , cw ) ; cB += cn ( bX [ aQ ] , ca [ aQ ] , ci , cv , cy , cw ) ; cB += cn ( bY [ aQ ] , cb [ aQ ] , ci , cv , cy , cw ) ; cB += cn ( bZ [ aQ ] , cc [ aQ ] , ci , cv , cy , cw ) ; } cA = mix ( cA , cB , cz ) ; cA /= 16.0 ; return clamp ( cA , 0.0 , 1.0 ) ; } float cD ( vec2 cd ) { float a = min ( cd . x , cd . y ) ; float b = min ( 1.0 - cd . x , 1.0 - cd . y ) ; return min ( a , b ) ; } float cG ( float cE , float cF ) { if ( cF >= 0.0 && cF <= bT ) cE = ( cE - 1.0 ) / bT * cF + 1.0 ; return cE ; } float cL ( vec3 cH , vec3 cI , PRECISION sampler2D cu , PRECISION sampler2D cw , float cx , float cy , float cJ , float ao ) { float cE ;".split(" ")},
{a:"cond",c:[{a:"if",e:["CSM_BLEND_BETWEEN_CASCADES"],h:{a:"grp",c:[{a:"txt",b:"float cF = cD ( cH . xy ) ; if ( - ao > cJ && cF >= 0.0 && cF <= bS && cf ( cI . xy , 0.0 ) ) { float cK = 1.0 - cF / bS ; cE = cC ( cH , cu , cI , cw , cx , cy , cK ) ; } else".split(" ")}]}}]},{a:"txt",b:"cE = cs ( cH , cu , cx ) ; return cE ; } float cN ( vec3 cM , PRECISION sampler2D cl , float ck , float cJ , float ao ) { float cE = cs ( cM , cl , ck ) ;".split(" ")},{a:"cond",c:[{a:"if",e:["CSM_FADE_LAST_CASCADE"],
h:{a:"grp",c:[{a:"txt",b:"if ( - ao > cJ ) { float cF = cD ( cM . xy ) ; cE = cG ( cE , cF ) ; }".split(" ")}]}}]},{a:"txt",b:"return cE ; } vec4 cT ( float ao ) { float cE = 1.0 ; vec3 ct = bM . xyz / bM . w ; if ( bM . w < 0.0 ) ct . z = 0.0 ;".split(" ")},{a:"cond",c:[{a:"if",e:["CSM_SECTION1","NUM_CAST_LAMPS",1,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"vec3 cv = bN . xyz / bN . w ; if ( bN . w < 0.0 ) cv . z = 0.0 ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["CSM_SECTION2",
"NUM_CAST_LAMPS",2,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"vec3 cO = bO . xyz / bO . w ; if ( bO . w < 0.0 ) cO . z = 0.0 ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["CSM_SECTION3","NUM_CAST_LAMPS",3,{a:"g_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"vec3 cP = bP . xyz / bP . w ; if ( bP . w < 0.0 ) cP . z = 0.0 ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["CSM_SECTION1"],h:{a:"grp",c:[{a:"txt",b:"if ( cf ( ct . xy , 0.0 ) ) { cE = cL ( ct , cv , u_shadow_map0 , u_shadow_map1 , u_pcf_blur_radii [ 0 ] , u_pcf_blur_radii [ 1 ] , u_csm_center_dists [ 0 ] , ao ) ; }".split(" ")}]}},
{a:"else",h:{a:"grp",c:[{a:"txt",b:"if ( cf ( ct . xy , bV ) ) { cE = cN ( ct , u_shadow_map0 , u_pcf_blur_radii [ 0 ] , u_csm_center_dists [ 0 ] , ao ) ; }".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["CSM_SECTION1"],h:{a:"grp",c:[{a:"txt",b:"else { if ( cf ( cv . xy , 0.0 ) ) {".split(" ")},{a:"cond",c:[{a:"if",e:["CSM_SECTION2"],h:{a:"grp",c:[{a:"txt",b:"cE = cL ( cv , cO , u_shadow_map1 , u_shadow_map2 , u_pcf_blur_radii [ 1 ] , u_pcf_blur_radii [ 2 ] , u_csm_center_dists [ 1 ] , ao ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",c:[{a:"txt",b:"cE = cN ( cv , u_shadow_map1 , u_pcf_blur_radii [ 1 ] , u_csm_center_dists [ 1 ] , ao ) ;".split(" ")}]}}]},{a:"txt",b:["}"]},{a:"cond",c:[{a:"if",e:["CSM_SECTION2"],h:{a:"grp",c:[{a:"txt",b:"else { if ( cf ( cO . xy , 0.0 ) ) {".split(" ")},{a:"cond",c:[{a:"if",e:["CSM_SECTION3"],h:{a:"grp",c:[{a:"txt",b:"cE = cL ( cO , cP , u_shadow_map2 , u_shadow_map3 , u_pcf_blur_radii [ 2 ] , u_pcf_blur_radii [ 3 ] , u_csm_center_dists [ 2 ] , ao ) ;".split(" ")}]}},{a:"else",
h:{a:"grp",c:[{a:"txt",b:"cE = cN ( cO , u_shadow_map2 , u_pcf_blur_radii [ 2 ] , u_csm_center_dists [ 2 ] , ao ) ;".split(" ")}]}}]},{a:"txt",b:["}"]},{a:"cond",c:[{a:"if",e:["CSM_SECTION3"],h:{a:"grp",c:[{a:"txt",b:"else { if ( cf ( cP . xy , 0.0 ) ) cE = cN ( cP , u_shadow_map3 , u_pcf_blur_radii [ 3 ] , u_csm_center_dists [ 3 ] , ao ) ; }".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"cond",c:[{a:"if",e:["NUM_CAST_LAMPS",1,{a:"g_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"float cQ = cs ( cv , u_shadow_map1 , u_pcf_blur_radii [ 0 ] ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",c:[{a:"txt",b:["float","cQ","=","0.0",";"]}]}}]},{a:"cond",c:[{a:"if",e:["NUM_CAST_LAMPS",2,{a:"g_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"float cR = cs ( cO , u_shadow_map2 , u_pcf_blur_radii [ 0 ] ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:["float","cR","=","0.0",";"]}]}}]},{a:"cond",c:[{a:"if",e:["NUM_CAST_LAMPS",3,{a:"g_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"float cS = cs ( cP , u_shadow_map3 , u_pcf_blur_radii [ 0 ] ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",
b:["float","cS","=","1.0",";"]}]}}]},{a:"txt",b:"return vec4 ( cE , cQ , cR , cS ) ; }".split(" ")}]}}]},{a:"txt",b:"vec4 cV ( inout vec3 cU ) {".split(" ")},{a:"cond",c:[{a:"if",e:["SHADOW_USAGE","SHADOW_MAPPING_OPAQUE",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"vec4 co = GLSL_TEXTURE ( u_shadow_mask , bK . xy / bK . z ) ;".split(" ")},{a:"cond",c:[{a:"if",e:["NUM_CAST_LAMPS",3,{a:"l_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"cU *= co . a ;".split(" ")}]}}]},{a:"txt",b:["return","co",";"]}]}},{a:"elif",
e:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"vec4 co = cT ( bH . z ) ; return co ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"return vec4 ( 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]};a["include/mirror.glslf"]={a:"grp",c:[{a:"cond",c:[{a:"if",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2},"REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2},"REFLECTION_TYPE",
"REFL_MIRRORMAP",{a:"equal_expr",i:2},{a:"logical_or_expr",i:3}],h:{a:"grp",c:[{a:"define",d:"REFL_BUMP",b:["0.1"]},{a:"txt",b:"float db ( in vec3 cW , vec3 cX , float cY , float cZ ) { vec3 c_ = normalize ( cX + cW ) ; float da = 1.0 - dot ( cW , c_ ) ; float r = cZ + ( 1.0 - cZ ) * pow ( da , cY ) ; return r ; } void dk ( inout vec3 dc , vec3 cW , vec3 l , float dd , mat4 de ) { vec3 cX = reflect ( - cW , l ) ; float cY = u_fresnel_params [ 2 ] ; float cZ = u_fresnel_params [ 3 ] ; float r = 1.0 ; if ( cY != 0.0 ) r = db ( cW , cX , cY , cZ ) ;".split(" ")},
{a:"cond",c:[{a:"if",e:["REFLECTION_TYPE","REFL_CUBE",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"vec3 df = GLSL_TEXTURE_CUBE ( u_cube_reflection , cX ) . xyz ;".split(" ")}]}},{a:"elif",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["REFLECTION_PASS",{a:"logic_negative_expr",i:1}],h:{a:"grp",c:[{a:"txt",b:"vec3 dg = u_refl_plane . xyz * dot ( l , u_refl_plane . xyz ) ; vec3 dh = l - dg ; vec2 di = ( de * vec4 ( dh , 0.0 ) ) . xy ; vec2 dj = bK . xy / bK . z ; dj += di * REFL_BUMP ; vec3 df = GLSL_TEXTURE ( u_plane_reflection , dj ) . rgb ;".split(" ")}]}},
{a:"else",h:{a:"grp",c:[{a:"txt",b:"vec3 df = vec3 ( 1.0 ) ; dd = 0.0 ;".split(" ")}]}}]}]}},{a:"elif",e:["REFLECTION_TYPE","REFL_MIRRORMAP",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"vec3 df = GLSL_TEXTURE_CUBE ( u_mirrormap , cX ) . xyz ;".split(" ")}]}}]},{a:"txt",b:"bd ( df . rgb ) ; dc = mix ( dc , df , dd * r ) ; }".split(" ")}]}}]}]};a["include/environment.glslf"]={a:"grp",c:[{a:"txt",b:"vec3 dm ( vec3 l ) {".split(" ")},{a:"cond",c:[{a:"if",e:["USE_ENVIRONMENT_LIGHT"],h:{a:"grp",c:[{a:"cond",
c:[{a:"if",e:["SKY_TEXTURE"],h:{a:"grp",c:[{a:"txt",b:"return GLSL_TEXTURE_CUBE ( u_sky_texture , l ) . rgb ;".split(" ")}]}},{a:"elif",e:["SKY_COLOR"],h:{a:"grp",c:[{a:"txt",b:"float dl = 0.5 * l . y + 0.5 ; return mix ( u_horizon_color , u_zenith_color , dl ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"return vec3 ( 1.0 ) ;".split(" ")}]}}]}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"return vec3 ( 0.0 ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]};a["include/refraction.glslf"]={a:"grp",c:[{a:"cond",
c:[{a:"if",e:["REFRACTIVE"],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["USE_REFRACTION_CORRECTION"],h:{a:"grp",c:[{a:"txt",b:"float dt ( in float dn , inout vec2 dp , in vec2 dq ) { vec4 dr = GLSL_TEXTURE ( u_scene_depth , dp ) ; float ds = ap ( dr ) ; if ( ds < bL ) { dp = dq ; return dn ; } else { return ds ; } return dn ; }".split(" ")}]}}]},{a:"txt",b:"vec3 dx ( in vec3 X , in vec2 du ) { vec2 dq = X . xy / X . z ; vec2 dp = dq + du ;".split(" ")},{a:"cond",c:[{a:"if",e:["USE_REFRACTION_CORRECTION"],
h:{a:"grp",c:[{a:"txt",b:"vec4 dv = GLSL_TEXTURE_PROJ ( u_scene_depth , X ) ; float dn = ap ( dv ) ; dt ( dn , dp , dq ) ;".split(" ")}]}}]},{a:"txt",b:"vec3 dw = GLSL_TEXTURE ( u_refractmap , dp ) . rgb ; bd ( dw ) ; return dw ; }".split(" ")}]}}]}]};a["include/nodes.glslf"]={a:"grp",c:[{a:"define",d:"M_PI",b:["3.14159265359"]},{a:"cond",c:[{a:"if",e:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["GLSL_IN","vec3","dy",";"]}]}}]},{a:"txt",b:"float ZERO_VALUE_NODES = 0.0 ; float UNITY_VALUE_NODES = 1.0 ; float dz = 0.5 ;".split(" ")},
{a:"cond",c:[{a:"if",e:["USE_NODE_B4W_REFRACTION"],h:{a:"grp",c:[{a:"txt",b:"vec3 dC ( in vec3 dA , in float dB ) { vec3 dw = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")},{a:"cond",c:[{a:"if",e:["USE_REFRACTION"],h:{a:"grp",c:[{a:"txt",b:"dw = dx ( bK , dA . xy * dB ) ;".split(" ")}]}},{a:"elif",e:["HAS_REFRACT_TEXTURE"],h:{a:"grp",c:[{a:"txt",b:"dw = GLSL_TEXTURE ( u_refractmap , bK . xy / bK . z ) . rgb ; bd ( dw ) ;".split(" ")}]}}]},{a:"txt",b:["return","dw",";","}"]}]}}]},{a:"cond",c:[{a:"if",e:["USE_NODE_HUE_SAT",
"USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_SEPHSV",{a:"logical_or_expr",i:6}],h:{a:"grp",c:[{a:"txt",b:"vec3 dF ( vec3 rgb ) { vec4 dD = vec4 ( ZERO_VALUE_NODES , - UNITY_VALUE_NODES / 3.0 , 2.0 / 3.0 , - UNITY_VALUE_NODES ) ; vec4 p = mix ( vec4 ( rgb . bg , dD . wz ) , vec4 ( rgb . gb , dD . xy ) , step ( rgb . b , rgb . g ) ) ; vec4 q = mix ( vec4 ( p . xyw , rgb . r ) , vec4 ( rgb . r , p . yzx ) , step ( p . x , rgb . r ) ) ; float aH = q . x - min ( q . w , q . y ) ; float dE = 1.0e-10 ; return vec3 ( abs ( q . z + ( q . w - q . y ) / ( 6.0 * aH + dE ) ) , aH / ( q . x + dE ) , q . x ) ; }".split(" ")}]}}]},
{a:"cond",c:[{a:"if",e:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_COMBHSV",{a:"logical_or_expr",i:6}],h:{a:"grp",c:[{a:"txt",b:"vec3 dH ( vec3 dG ) { vec4 dD = vec4 ( UNITY_VALUE_NODES , 2.0 / 3.0 , UNITY_VALUE_NODES / 3.0 , 3.0 ) ; vec3 p = abs ( fract ( vec3 ( dG . r , dG . r , dG . r ) + dD . xyz ) * 6.0 - dD . www ) ; return dG . b * mix ( dD . xxx , clamp ( p - dD . xxx , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) , dG . g ) ; }".split(" ")}]}}]},
{a:"cond",c:[{a:"if",e:["USE_NODE_GEOMETRY_UV","USE_NODE_B4W_PARALLAX","USE_NODE_UV_MERGED",{a:"logical_or_expr",i:3}],h:{a:"grp",c:[{a:"txt",b:"vec3 dJ ( vec2 dI ) { return vec3 ( dI * 2.0 - vec2 ( UNITY_VALUE_NODES , UNITY_VALUE_NODES ) , ZERO_VALUE_NODES ) ; }".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["USE_NODE_TEXTURE_COLOR","USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{a:"logical_or_expr",i:3}],h:{a:"grp",c:[{a:"txt",b:"vec2 dK ( vec3 C ) { return vec2 ( C . xy * dz + vec2 ( dz , dz ) ) ; }".split(" ")}]}}]},
{a:"node",d:"CAMERA",l:[{a:"node_out",d:"er",g:["vec3"],f:!0},{a:"node_out",d:"es",g:["float"],f:!0},{a:"node_out",d:"et",g:["float"],f:!0}],j:[{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_er"],j:[{a:"txt",b:"er = normalize ( eo . xyz ) ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_es"],j:[{a:"txt",b:"es = abs ( eo . z ) ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_et"],j:[{a:"txt",b:"et = length ( eo . xyz ) ;".split(" ")}]}]}]},{a:"node",d:"COMBRGB",l:[{a:"node_in",
d:"eu",g:["float"],f:!1},{a:"node_in",d:"ev",g:["float"],f:!1},{a:"node_in",d:"ew",g:["float"],f:!1},{a:"node_out",d:"ex",g:["vec3"],f:!1}],j:[{a:"txt",b:"ex = vec3 ( eu , ev , ew ) ;".split(" ")}]},{a:"node",d:"COMBHSV",l:[{a:"node_in",d:"ey",g:["float"],f:!1},{a:"node_in",d:"ez",g:["float"],f:!1},{a:"node_in",d:"eA",g:["float"],f:!1},{a:"node_out",d:"eB",g:["vec3"],f:!1}],j:[{a:"txt",b:"eB = dH ( vec3 ( ey , ez , eA ) ) ;".split(" ")}]},{a:"node",d:"EMPTY_UV",l:[{a:"node_out",d:"eC",g:["vec3"],
f:!1}],j:[{a:"txt",b:"eC = vec3 ( - UNITY_VALUE_NODES , - UNITY_VALUE_NODES , ZERO_VALUE_NODES ) ;".split(" ")}]},{a:"node",d:"EMPTY_VC",l:[{a:"node_out",d:"eD",g:["vec3"],f:!1}],j:[{a:"txt",b:"eD = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},{a:"node",d:"GEOMETRY_UV",l:[{a:"node_out",d:"eE",g:["vec3"],f:!1},{a:"node_param",d:"dL",g:["GLSL_IN","vec2"],f:!1}],j:[{a:"txt",b:"eE = dJ ( dL ) ;".split(" ")}]},{a:"node",d:"GEOMETRY_OR",l:[{a:"node_out",d:"eF",g:["vec3"],f:!1}],j:[{a:"txt",b:"eF = 2.0 * dy - vec3 ( UNITY_VALUE_NODES ) ;".split(" ")}]},
{a:"node",d:"GEOMETRY_VC",l:[{a:"node_out",d:"eG",g:["vec3"],f:!1},{a:"node_param",d:"dM",g:["GLSL_IN","vec3"],f:!1}],j:[{a:"txt",b:"eG = dM ; bd ( eG ) ;".split(" ")}]},{a:"node",d:"GEOMETRY_VC1",l:[{a:"node_out",d:"eH",g:["float"],f:!1},{a:"node_param",d:"dN",g:["GLSL_IN","float"],f:!1}],j:[{a:"txt",b:"eH = dN ; bd ( eH ) ;".split(" ")}]},{a:"node",d:"GEOMETRY_VC2",l:[{a:"node_out",d:"eI",g:["float"],f:!1},{a:"node_out",d:"eJ",g:["float"],f:!1},{a:"node_param",d:"dO",g:["GLSL_IN","vec2"],f:!1}],
j:[{a:"txt",b:"eI = dO [ 0 ] ; eJ = dO [ 1 ] ; bd ( eI ) ; bd ( eJ ) ;".split(" ")}]},{a:"node",d:"GEOMETRY_VC3",l:[{a:"node_out",d:"eK",g:["float"],f:!1},{a:"node_out",d:"eL",g:["float"],f:!1},{a:"node_out",d:"eM",g:["float"],f:!1},{a:"node_param",d:"dP",g:["GLSL_IN","vec3"],f:!1}],j:[{a:"txt",b:"eK = dP [ 0 ] ; eL = dP [ 1 ] ; eM = dP [ 2 ] ; bd ( eK ) ; bd ( eL ) ; bd ( eM ) ;".split(" ")}]},{a:"node",d:"GEOMETRY_NO",l:[{a:"node_out",d:"eN",g:["vec3"],f:!1}],j:[{a:"txt",b:"eN = ek . xzy ; eN . y *= - 1.0 ;".split(" ")}]},
{a:"node",d:"GEOMETRY_FB",l:[{a:"node_out",d:"eO",g:["float"],f:!1}],j:[{a:"node_cond",c:[{a:"node_if",e:["INVERT_FRONTFACING"],j:[{a:"txt",b:"eO = ( gl_FrontFacing ) ? ZERO_VALUE_NODES : UNITY_VALUE_NODES ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"eO = ( gl_FrontFacing ) ? UNITY_VALUE_NODES : ZERO_VALUE_NODES ;".split(" ")}]}]}]},{a:"node",d:"GEOMETRY_VW",l:[{a:"node_out",d:"eP",g:["vec3"],f:!1}],j:[{a:"txt",b:"eP = - ( dZ * vec4 ( dY , 0.0 ) ) . xyz ;".split(" ")}]},{a:"node",d:"GEOMETRY_LO",
l:[{a:"node_out",d:"eQ",g:["vec3"],f:!1}],j:[{a:"txt",b:"eQ [ 0 ] = eo [ 0 ] ; eQ [ 1 ] = eo [ 1 ] ; eQ [ 2 ] = eo [ 2 ] ;".split(" ")}]},{a:"node",d:"GEOMETRY_GL",l:[{a:"node_out",d:"eR",g:["vec3"],f:!1}],j:[{a:"txt",b:"eR = vec3 ( en . r , - en . b , en . g ) ;".split(" ")}]},{a:"node",d:"NEW_GEOMETRY",l:[{a:"node_out",d:"eS",g:["vec3"],f:!1},{a:"node_out",d:"eT",g:["vec3"],f:!1},{a:"node_out",d:"eU",g:["vec3"],f:!1},{a:"node_out",d:"eV",g:["vec3"],f:!1},{a:"node_out",d:"eW",g:["vec3"],f:!1},{a:"node_out",
d:"eX",g:["vec3"],f:!1},{a:"node_out",d:"eY",g:["float"],f:!1},{a:"node_out",d:"eZ",g:["float"],f:!1}],j:[{a:"txt",b:"eS = vec3 ( ZERO_VALUE_NODES ) ; eT = vec3 ( ZERO_VALUE_NODES ) ; eU = vec3 ( ZERO_VALUE_NODES ) ; eV = vec3 ( ZERO_VALUE_NODES ) ; eW = vec3 ( ZERO_VALUE_NODES ) ; eX = vec3 ( ZERO_VALUE_NODES ) ; eY = ZERO_VALUE_NODES ; eZ = ZERO_VALUE_NODES ;".split(" ")}]},{a:"node",d:"HUE_SAT",l:[{a:"node_in",d:"e_",g:["float"],f:!1},{a:"node_in",d:"fa",g:["float"],f:!1},{a:"node_in",d:"fb",g:["float"],
f:!1},{a:"node_in",d:"fc",g:["float"],f:!1},{a:"node_in",d:"fd",g:["vec3"],f:!1},{a:"node_out",d:"fe",g:["vec3"],f:!1}],j:[{a:"txt",b:"vec3 dG = dF ( fd ) ; dG [ 0 ] += ( e_ - dz ) ; if ( dG [ 0 ] > UNITY_VALUE_NODES ) dG [ 0 ] -= UNITY_VALUE_NODES ; else if ( dG [ 0 ] < ZERO_VALUE_NODES ) dG [ 0 ] += UNITY_VALUE_NODES ; dG *= vec3 ( UNITY_VALUE_NODES , fa , fb ) ; dG = mix ( vec3 ( UNITY_VALUE_NODES ) , mix ( vec3 ( ZERO_VALUE_NODES ) , dG , step ( vec3 ( ZERO_VALUE_NODES ) , dG ) ) , step ( dG , vec3 ( UNITY_VALUE_NODES ) ) ) ; fe = mix ( fd , dH ( dG ) , fc ) ;".split(" ")}]},
{a:"node",d:"INVERT",l:[{a:"node_in",d:"ff",g:["float"],f:!1},{a:"node_in",d:"fg",g:["vec3"],f:!1},{a:"node_out",d:"fh",g:["vec3"],f:!1}],j:[{a:"txt",b:"fh = mix ( fg , vec3 ( UNITY_VALUE_NODES ) - fg , ff ) ;".split(" ")}]},{a:"node",d:"LAMP",l:[{a:"node_out",d:"fi",g:["vec3"],f:!0},{a:"node_out",d:"fj",g:["vec3"],f:!1},{a:"node_out",d:"fk",g:["float"],f:!1},{a:"node_out",d:"fl",g:["float"],f:!0}],j:[{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_fi"],j:[{a:"txt",b:"fi = u_lamp_light_color_intensities [ LAMP_INDEX ] ;".split(" ")}]}]},
{a:"txt",b:"vec4 fm = u_lamp_light_factors [ LAMP_INDEX ] ; vec3 fn = u_lamp_light_directions [ LAMP_INDEX ] ; vec3 fo = u_lamp_light_positions [ LAMP_INDEX ] ; float fp = fm . z ; if ( fp != - UNITY_VALUE_NODES ) {".split(" ")},{a:"txt",b:"fj = - bG + fo ; fk = length ( fj ) ; fj = normalize ( fj ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_fl"],j:[{a:"txt",b:"fl = fp / ( fp + fk * fk ) ; float fq = fm . x ; float fr = fm . y ; if ( fq > - UNITY_VALUE_NODES ) { float fs = dot ( fj , fn ) ; fs *= smoothstep ( ZERO_VALUE_NODES , UNITY_VALUE_NODES , ( fs - fq ) / fr ) ; fl *= fs ; }".split(" ")}]}]},
{a:"txt",b:["}","else","{"]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_fj"],j:[{a:"txt",b:["fj","=","fn",";"]}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_fk"],j:[{a:"txt",b:"fk = length ( fo - bG ) ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_fl"],j:[{a:"txt",b:["fl","=","UNITY_VALUE_NODES",";"]}]}]},{a:"txt",b:["}"]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_fj"],j:[{a:"txt",b:"fj . yz = vec2 ( - fj . z , fj . y ) ;".split(" ")}]}]}]},{a:"node",d:"NORMAL",l:[{a:"node_in",d:"ft",
g:["vec3"],f:!1},{a:"node_out",d:"fu",g:["vec3"],f:!0},{a:"node_out",d:"fv",g:["float"],f:!0},{a:"node_param",d:"dQ",g:["vec3"],f:!1}],j:[{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_fu"],j:[{a:"txt",b:["fu","=","dQ",";"]}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_fv"],j:[{a:"txt",b:"fv = - dot ( ft , dQ ) ;".split(" ")}]}]}]},{a:"node",d:"B4W_VECTOR_VIEW",l:[{a:"node_in",d:"fw",g:["vec3"],f:!1},{a:"node_out",d:"fx",g:["vec3"],f:!1}],j:[{a:"txt",b:"fx = - ( d_ * vec4 ( fw , ZERO_VALUE_NODES ) ) . xyz ;".split(" ")}]},
{a:"node",d:"BSDF_ANISOTROPIC",l:[{a:"node_in",d:"fy",g:["vec3"],f:!1},{a:"node_in",d:"fz",g:["float"],f:!1},{a:"node_in",d:"fA",g:["float"],f:!1},{a:"node_in",d:"fB",g:["float"],f:!1},{a:"node_in",d:"fC",g:["vec3"],f:!1},{a:"node_in",d:"fD",g:["vec3"],f:!1},{a:"node_out",d:"fE",g:["vec3"],f:!1}],j:[{a:"txt",b:["fE","=","fy",";"]},{a:"txt",b:"fz ; fA ; fB ; fC ; fD ;".split(" ")}]},{a:"node",d:"BSDF_DIFFUSE",l:[{a:"node_in",d:"fF",g:["vec3"],f:!1},{a:"node_in",d:"fG",g:["float"],f:!1},{a:"node_in",
d:"fH",g:["vec3"],f:!1},{a:"node_out",d:"fI",g:["vec3"],f:!1}],j:[{a:"txt",b:["fI","=","fF",";"]},{a:"txt",b:["fG",";","fH",";"]}]},{a:"node",d:"BSDF_GLASS",l:[{a:"node_in",d:"fJ",g:["vec3"],f:!1},{a:"node_in",d:"fK",g:["float"],f:!1},{a:"node_in",d:"fL",g:["float"],f:!1},{a:"node_in",d:"fM",g:["vec3"],f:!1},{a:"node_out",d:"fN",g:["vec3"],f:!1}],j:[{a:"txt",b:["fN","=","fJ",";"]},{a:"txt",b:"fK ; fL ; fM ;".split(" ")}]},{a:"node",d:"BSDF_GLOSSY",l:[{a:"node_in",d:"fO",g:["vec3"],f:!1},{a:"node_in",
d:"fP",g:["float"],f:!1},{a:"node_in",d:"fQ",g:["vec3"],f:!1},{a:"node_out",d:"fR",g:["vec3"],f:!1}],j:[{a:"txt",b:["fR","=","fO",";"]},{a:"txt",b:["fP",";","fQ",";"]}]},{a:"node",d:"BSDF_HAIR",l:[{a:"node_in",d:"fS",g:["vec3"],f:!1},{a:"node_in",d:"fT",g:["float"],f:!1},{a:"node_in",d:"fU",g:["float"],f:!1},{a:"node_in",d:"fV",g:["float"],f:!1},{a:"node_out",d:"fW",g:["vec3"],f:!1}],j:[{a:"txt",b:["fW","=","fS",";"]},{a:"txt",b:"fT ; fU ; fV ;".split(" ")}]},{a:"node",d:"BSDF_TRANSPARENT",l:[{a:"node_in",
d:"fX",g:["vec3"],f:!1},{a:"node_out",d:"fY",g:["vec3"],f:!1}],j:[{a:"txt",b:["fY","=","fX",";"]}]},{a:"node",d:"BSDF_TRANSLUCENT",l:[{a:"node_in",d:"fZ",g:["vec3"],f:!1},{a:"node_in",d:"f_",g:["vec3"],f:!1},{a:"node_out",d:"gc",g:["vec3"],f:!1}],j:[{a:"txt",b:["gc","=","fZ",";"]},{a:"txt",b:["f_",";"]}]},{a:"node",d:"BSDF_REFRACTION",l:[{a:"node_in",d:"gd",g:["vec3"],f:!1},{a:"node_in",d:"ge",g:["float"],f:!1},{a:"node_in",d:"gf",g:["float"],f:!1},{a:"node_in",d:"gh",g:["vec3"],f:!1},{a:"node_out",
d:"gi",g:["vec3"],f:!1}],j:[{a:"txt",b:"gi [ 0 ] = gi [ 1 ] = gi [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{a:"txt",b:"gd ; ge ; gf ; gh ;".split(" ")}]},{a:"node",d:"BSDF_TOON",l:[{a:"node_in",d:"gj",g:["vec3"],f:!1},{a:"node_in",d:"gk",g:["float"],f:!1},{a:"node_in",d:"gl",g:["float"],f:!1},{a:"node_in",d:"gm",g:["vec3"],f:!1},{a:"node_out",d:"gn",g:["vec3"],f:!1}],j:[{a:"txt",b:["gn","=","gj",";"]},{a:"txt",b:"gk ; gl ; gm ;".split(" ")}]},{a:"node",d:"BSDF_VELVET",l:[{a:"node_in",d:"go",g:["vec3"],
f:!1},{a:"node_in",d:"gp",g:["float"],f:!1},{a:"node_in",d:"gq",g:["vec3"],f:!1},{a:"node_out",d:"gs",g:["vec3"],f:!1}],j:[{a:"txt",b:["gs","=","go",";"]},{a:"txt",b:["gp",";","gq",";"]}]},{a:"node",d:"SUBSURFACE_SCATTERING",l:[{a:"node_in",d:"gt",g:["vec3"],f:!1},{a:"node_in",d:"gu",g:["float"],f:!1},{a:"node_in",d:"gv",g:["vec3"],f:!1},{a:"node_in",d:"gw",g:["float"],f:!1},{a:"node_in",d:"gx",g:["float"],f:!1},{a:"node_in",d:"gy",g:["vec3"],f:!1},{a:"node_out",d:"gz",g:["vec3"],f:!1}],j:[{a:"txt",
b:"gz [ 0 ] = gz [ 1 ] = gz [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{a:"txt",b:"gt ; gv ; gw ; gx ; gy ; gu ;".split(" ")}]},{a:"node",d:"EMISSION",l:[{a:"node_in",d:"gA",g:["vec3"],f:!1},{a:"node_in",d:"gB",g:["float"],f:!1},{a:"node_out",d:"gC",g:["vec3"],f:!1}],j:[{a:"txt",b:["gC","=","gA",";"]},{a:"txt",b:["gB",";"]}]},{a:"node",d:"AMBIENT_OCCLUSION",l:[{a:"node_in",d:"gD",g:["vec3"],f:!1},{a:"node_out",d:"gE",g:["vec3"],f:!1}],j:[{a:"txt",b:"gE [ 0 ] = gE [ 1 ] = gE [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},
{a:"txt",b:["gD",";"]}]},{a:"node",d:"HOLDOUT",l:[{a:"node_out",d:"gF",g:["vec3"],f:!1}],j:[{a:"txt",b:"gF [ 0 ] = gF [ 1 ] = gF [ 2 ] = ZERO_VALUE_NODES ;".split(" ")}]},{a:"node",d:"VOLUME_ABSORPTION",l:[{a:"node_in",d:"gG",g:["vec3"],f:!1},{a:"node_in",d:"gH",g:["float"],f:!1},{a:"node_out",d:"gI",g:["vec3"],f:!1}],j:[{a:"txt",b:"gI [ 0 ] = gI [ 1 ] = gI [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{a:"txt",b:["gG",";","gH",";"]}]},{a:"node",d:"VOLUME_SCATTER",l:[{a:"node_in",d:"gJ",g:["vec3"],f:!1},
{a:"node_in",d:"gK",g:["float"],f:!1},{a:"node_in",d:"gL",g:["float"],f:!1},{a:"node_out",d:"gM",g:["vec3"],f:!1}],j:[{a:"txt",b:"gM [ 0 ] = gM [ 1 ] = gM [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{a:"txt",b:"gJ ; gK ; gL ;".split(" ")}]},{a:"node",d:"BUMP",l:[{a:"node_in",d:"gN",g:["float"],f:!1},{a:"node_in",d:"gO",g:["float"],f:!1},{a:"node_in",d:"gP",g:["float"],f:!1},{a:"node_in",d:"gQ",g:["vec3"],f:!1},{a:"node_out",d:"gR",g:["vec3"],f:!1}],j:[{a:"txt",b:["gR","=","gQ",";"]},{a:"txt",b:"gN ; gO ; gP ;".split(" ")}]},
{a:"node",d:"NORMAL_MAP",l:[{a:"node_in",d:"gS",g:["float"],f:!1},{a:"node_in",d:"gT",g:["vec3"],f:!1},{a:"node_out",d:"gU",g:["vec3"],f:!1}],j:[{a:"txt",b:["vec3","gV","=","ej",";"]},{a:"txt",b:"gV . yz = vec2 ( - gV . z , gV . y ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["SPACE","NM_TANGENT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"gU = em * ( gT . xyz - dz ) ;".split(" ")},{a:"txt",b:"gU . yz = vec2 ( - gU . z , gU . y ) ;".split(" ")}]},{a:"node_elif",e:["SPACE","NM_OBJECT",{a:"equal_expr",
i:2},"SPACE","NM_BLENDER_OBJECT",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"gU = gT . xyz - dz ; gU . yz *= - 1.0 ; gU = ( eb * vec4 ( gU , ZERO_VALUE_NODES ) ) . xyz ;".split(" ")}]},{a:"node_elif",e:["SPACE","NM_WORLD",{a:"equal_expr",i:2},"SPACE","NM_BLENDER_WORLD",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"gU = gT . xyz - dz ; gU . yz *= - 1.0 ;".split(" ")}]}]},{a:"txt",b:"gU = normalize ( mix ( gV , gU , gS ) ) ;".split(" ")}]},{a:"node",d:"VECT_TRANSFORM",
l:[{a:"node_in",d:"gW",g:["vec3"],f:!1},{a:"node_out",d:"gX",g:["vec3"],f:!1}],j:[{a:"node_cond",c:[{a:"node_if",e:["CONVERT_TYPE","VT_WORLD_TO_WORLD",{a:"equal_expr",i:2},"CONVERT_TYPE","VT_OBJECT_TO_OBJECT",{a:"equal_expr",i:2},"CONVERT_TYPE","VT_CAMERA_TO_CAMERA",{a:"equal_expr",i:2},{a:"logical_or_expr",i:3}],j:[{a:"txt",b:["gX","=","gW",";"]}]},{a:"node_else",j:[{a:"node_cond",c:[{a:"node_if",e:["VECTOR_TYPE","VT_POINT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vec4 gY = vec4 ( gW , UNITY_VALUE_NODES ) ;".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"vec4 gY = vec4 ( gW , ZERO_VALUE_NODES ) ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{a:"equal_expr",i:2}],j:[{a:"txt",b:"gX = ( d_ * gY ) . xyz ;".split(" ")}]},{a:"node_elif",e:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"gX = ( ec * gY ) . xyz ;".split(" ")}]},{a:"node_elif",e:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"gX = ( eb * gY ) . xyz ;".split(" ")}]},{a:"node_elif",
e:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{a:"equal_expr",i:2}],j:[{a:"txt",b:"gX = ( d_ * eb * gY ) . xyz ;".split(" ")}]},{a:"node_elif",e:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"gX = ( ea * gY ) . xyz ;".split(" ")}]},{a:"node_elif",e:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"gX = ( ec * ea * gY ) . xyz ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["VECTOR_TYPE","VT_NORMAL",{a:"equal_expr",i:2}],j:[{a:"txt",b:"gX = normalize ( gX ) ;".split(" ")}]}]}]}]}]},
{a:"node",d:"BLACKBODY",l:[{a:"node_in",d:"gZ",g:["float"],f:!1},{a:"node_out",d:"g_",g:["vec3"],f:!1}],j:[{a:"txt",b:"g_ [ 0 ] = g_ [ 1 ] = g_ [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{a:"txt",b:["gZ",";"]}]},{a:"node",d:"WAVELENGTH",l:[{a:"node_in",d:"ha",g:["float"],f:!1},{a:"node_out",d:"hb",g:["vec3"],f:!1}],j:[{a:"txt",b:"hb [ 0 ] = hb [ 1 ] = hb [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{a:"txt",b:["ha",";"]}]},{a:"node",d:"SEPXYZ",l:[{a:"node_in",d:"hc",g:["vec3"],f:!1},{a:"node_out",d:"hd",
g:["float"],f:!1},{a:"node_out",d:"he",g:["float"],f:!1},{a:"node_out",d:"hf",g:["float"],f:!1}],j:[{a:"txt",b:"hd = hc [ 0 ] ; he = hc [ 1 ] ; hf = hc [ 2 ] ;".split(" ")}]},{a:"node",d:"COMBXYZ",l:[{a:"node_in",d:"hg",g:["float"],f:!1},{a:"node_in",d:"hh",g:["float"],f:!1},{a:"node_in",d:"hi",g:["float"],f:!1},{a:"node_out",d:"hj",g:["vec3"],f:!1}],j:[{a:"txt",b:"hj [ 0 ] = hg ; hj [ 1 ] = hh ; hj [ 2 ] = hi ;".split(" ")}]},{a:"node",d:"BRIGHTCONTRAST",l:[{a:"node_in",d:"hk",g:["vec3"],f:!1},{a:"node_in",
d:"hl",g:["float"],f:!1},{a:"node_in",d:"hm",g:["float"],f:!1},{a:"node_out",d:"hn",g:["vec3"],f:!1}],j:[{a:"txt",b:"float b = hl - hm * dz ; hn = max ( ( UNITY_VALUE_NODES + hm ) * hk + b , vec3 ( ZERO_VALUE_NODES ) ) ;".split(" ")}]},{a:"node",d:"LIGHT_FALLOFF",l:[{a:"node_in",d:"ho",g:["float"],f:!1},{a:"node_in",d:"hp",g:["float"],f:!1},{a:"node_out",d:"hq",g:["float"],f:!1},{a:"node_out",d:"hr",g:["float"],f:!1},{a:"node_out",d:"hs",g:["float"],f:!1}],j:[{a:"txt",b:"hq = hr = hs = ZERO_VALUE_NODES ;".split(" ")},
{a:"txt",b:["ho",";","hp",";"]}]},{a:"node",d:"TEX_IMAGE",l:[{a:"node_in",d:"ht",g:["vec3"],f:!1},{a:"node_out",d:"hu",g:["vec3"],f:!1},{a:"node_out",d:"hv",g:["float"],f:!1}],j:[{a:"txt",b:"hu [ 0 ] = hu [ 1 ] = hu [ 2 ] = ZERO_VALUE_NODES ; hv = UNITY_VALUE_NODES ;".split(" ")},{a:"txt",b:["ht",";"]}]},{a:"node",d:"TEX_ENVIRONMENT",l:[{a:"node_in",d:"hw",g:["vec3"],f:!1},{a:"node_out",d:"hx",g:["vec3"],f:!1}],j:[{a:"txt",b:"hx [ 0 ] = hx [ 1 ] = hx [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{a:"txt",
b:["hw",";"]}]},{a:"node",d:"TEX_SKY",l:[{a:"node_in",d:"hy",g:["vec3"],f:!1},{a:"node_out",d:"hz",g:["vec3"],f:!1}],j:[{a:"txt",b:"hz [ 0 ] = hz [ 1 ] = hz [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{a:"txt",b:["hy",";"]}]},{a:"node",d:"TEX_NOISE",l:[{a:"node_in",d:"hA",g:["vec3"],f:!1},{a:"node_in",d:"hB",g:["float"],f:!1},{a:"node_in",d:"hC",g:["float"],f:!1},{a:"node_in",d:"hD",g:["float"],f:!1},{a:"node_out",d:"hE",g:["vec3"],f:!1},{a:"node_out",d:"hF",g:["float"],f:!1}],j:[{a:"txt",b:"hE [ 0 ] = hE [ 1 ] = hE [ 2 ] = ZERO_VALUE_NODES ; hF = UNITY_VALUE_NODES ;".split(" ")},
{a:"txt",b:"hA ; hB ; hC ; hD ;".split(" ")}]},{a:"node",d:"TEX_WAVE",l:[{a:"node_in",d:"hG",g:["vec3"],f:!1},{a:"node_in",d:"hH",g:["float"],f:!1},{a:"node_in",d:"hI",g:["float"],f:!1},{a:"node_in",d:"hJ",g:["float"],f:!1},{a:"node_in",d:"hK",g:["float"],f:!1},{a:"node_out",d:"hL",g:["vec3"],f:!1},{a:"node_out",d:"hM",g:["float"],f:!1}],j:[{a:"txt",b:"hL [ 0 ] = hL [ 1 ] = hL [ 2 ] = ZERO_VALUE_NODES ; hM = UNITY_VALUE_NODES ;".split(" ")},{a:"txt",b:"hG ; hH ; hI ; hJ ; hK ;".split(" ")}]},{a:"node",
d:"TEX_VORONOI",l:[{a:"node_in",d:"hN",g:["vec3"],f:!1},{a:"node_in",d:"hO",g:["float"],f:!1},{a:"node_out",d:"hP",g:["vec3"],f:!1},{a:"node_out",d:"hQ",g:["float"],f:!1}],j:[{a:"txt",b:"hP [ 0 ] = hP [ 1 ] = hP [ 2 ] = ZERO_VALUE_NODES ; hQ = UNITY_VALUE_NODES ;".split(" ")},{a:"txt",b:["hN",";","hO",";"]}]},{a:"node",d:"TEX_MUSGRAVE",l:[{a:"node_in",d:"hR",g:["vec3"],f:!1},{a:"node_in",d:"hS",g:["float"],f:!1},{a:"node_in",d:"hT",g:["float"],f:!1},{a:"node_in",d:"hU",g:["float"],f:!1},{a:"node_in",
d:"hV",g:["float"],f:!1},{a:"node_in",d:"hW",g:["float"],f:!1},{a:"node_in",d:"hX",g:["float"],f:!1},{a:"node_out",d:"hY",g:["vec3"],f:!1},{a:"node_out",d:"hZ",g:["float"],f:!1}],j:[{a:"txt",b:"hY [ 0 ] = hY [ 1 ] = hY [ 2 ] = ZERO_VALUE_NODES ; hZ = UNITY_VALUE_NODES ;".split(" ")},{a:"txt",b:"hR ; hS ; hT ; hU ; hV ; hW ; hX ;".split(" ")}]},{a:"node",d:"TEX_GRADIENT",l:[{a:"node_in",d:"h_",g:["vec3"],f:!1},{a:"node_out",d:"ia",g:["vec3"],f:!1},{a:"node_out",d:"ib",g:["float"],f:!1}],j:[{a:"txt",
b:"ia [ 0 ] = ia [ 1 ] = ia [ 2 ] = ZERO_VALUE_NODES ; ib = UNITY_VALUE_NODES ;".split(" ")},{a:"txt",b:["h_",";"]}]},{a:"node",d:"TEX_MAGIC",l:[{a:"node_in",d:"ic",g:["vec3"],f:!1},{a:"node_in",d:"id",g:["float"],f:!1},{a:"node_in",d:"ie",g:["float"],f:!1},{a:"node_out",d:"ig",g:["vec3"],f:!1},{a:"node_out",d:"ih",g:["float"],f:!1}],j:[{a:"txt",b:"ig [ 0 ] = ig [ 1 ] = ig [ 2 ] = ZERO_VALUE_NODES ; ih = UNITY_VALUE_NODES ;".split(" ")},{a:"txt",b:"ic ; id ; ie ;".split(" ")}]},{a:"node",d:"TEX_CHECKER",
l:[{a:"node_in",d:"ii",g:["vec3"],f:!1},{a:"node_in",d:"ij",g:["vec3"],f:!1},{a:"node_in",d:"ik",g:["vec3"],f:!1},{a:"node_in",d:"il",g:["float"],f:!1},{a:"node_out",d:"im",g:["vec3"],f:!1},{a:"node_out",d:"io",g:["float"],f:!1}],j:[{a:"txt",b:"im [ 0 ] = im [ 1 ] = im [ 2 ] = ZERO_VALUE_NODES ; io = UNITY_VALUE_NODES ;".split(" ")},{a:"txt",b:"ii ; ij ; ik ; il ;".split(" ")}]},{a:"node",d:"TEX_BRICK",l:[{a:"node_in",d:"ip",g:["vec3"],f:!1},{a:"node_in",d:"iq",g:["vec3"],f:!1},{a:"node_in",d:"ir",
g:["vec3"],f:!1},{a:"node_in",d:"is",g:["vec3"],f:!1},{a:"node_in",d:"it",g:["float"],f:!1},{a:"node_in",d:"iu",g:["float"],f:!1},{a:"node_in",d:"iv",g:["float"],f:!1},{a:"node_in",d:"iw",g:["float"],f:!1},{a:"node_in",d:"ix",g:["float"],f:!1},{a:"node_out",d:"iy",g:["vec3"],f:!1},{a:"node_out",d:"iz",g:["float"],f:!1}],j:[{a:"txt",b:"iy [ 0 ] = iy [ 1 ] = iy [ 2 ] = ZERO_VALUE_NODES ; iz = UNITY_VALUE_NODES ;".split(" ")},{a:"txt",b:"ip ; iq ; ir ; is ; it ; iu ; iv ; iw ; ix ;".split(" ")}]},{a:"node",
d:"ADD_SHADER",l:[{a:"node_in",d:"iA",g:["vec3"],f:!1},{a:"node_in",d:"iB",g:["vec3"],f:!1},{a:"node_out",d:"iC",g:["vec3"],f:!1}],j:[{a:"txt",b:"iC = clamp ( iA + iB , vec3 ( ZERO_VALUE_NODES ) , vec3 ( UNITY_VALUE_NODES ) ) ;".split(" ")}]},{a:"node",d:"MIX_SHADER",l:[{a:"node_in",d:"iD",g:["float"],f:!1},{a:"node_in",d:"iE",g:["vec3"],f:!1},{a:"node_in",d:"iF",g:["vec3"],f:!1},{a:"node_out",d:"iG",g:["vec3"],f:!1}],j:[{a:"txt",b:"float iH = clamp ( iD , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; iG = iH * iE + ( UNITY_VALUE_NODES - iH ) * iF ;".split(" ")}]},
{a:"node",d:"UV_MERGED",l:[{a:"node_out",d:"iI",g:["vec3"],f:!1},{a:"node_out",d:"iJ",g:["vec3"],f:!1},{a:"node_param",d:"dR",g:["GLSL_IN","vec2"],f:!1}],j:[{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_iI"],j:[{a:"txt",b:"iI = dJ ( dR ) ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_iJ"],j:[{a:"txt",b:"iJ = vec3 ( dR , ZERO_VALUE_NODES ) ;".split(" ")}]}]}]},{a:"node",d:"TEX_COORD_UV",l:[{a:"node_out",d:"iK",g:["vec3"],f:!1},{a:"node_param",d:"dS",g:["GLSL_IN","vec2"],f:!1}],j:[{a:"txt",
b:"iK = vec3 ( dS , ZERO_VALUE_NODES ) ;".split(" ")}]},{a:"node",d:"TEX_COORD_NO",l:[{a:"node_out",d:"iL",g:["vec3"],f:!1}],j:[{a:"txt",b:["iL","=","ej",";"]}]},{a:"node",d:"TEX_COORD_GE",l:[{a:"node_out",d:"iM",g:["vec3"],f:!1}],j:[{a:"txt",b:["iM","=","dy",";"]}]},{a:"node",d:"TEX_COORD_OB",l:[{a:"node_out",d:"iN",g:["vec3"],f:!1}],j:[{a:"txt",b:"iN [ 0 ] = iN [ 1 ] = iN [ 2 ] = UNITY_VALUE_NODES ;".split(" ")}]},{a:"node",d:"TEX_COORD_CA",l:[{a:"node_out",d:"iO",g:["vec3"],f:!1}],j:[{a:"txt",
b:"iO [ 0 ] = eo [ 0 ] ; iO [ 1 ] = eo [ 1 ] ; iO [ 2 ] = UNITY_VALUE_NODES ;".split(" ")}]},{a:"node",d:"TEX_COORD_WI",l:[{a:"node_out",d:"iP",g:["vec3"],f:!1}],j:[{a:"txt",b:"iP [ 0 ] = iP [ 1 ] = iP [ 2 ] = UNITY_VALUE_NODES ;".split(" ")}]},{a:"node",d:"TEX_COORD_RE",l:[{a:"node_out",d:"iQ",g:["vec3"],f:!1}],j:[{a:"txt",b:"iQ [ 0 ] = iQ [ 1 ] = iQ [ 2 ] = UNITY_VALUE_NODES ;".split(" ")}]},{a:"node",d:"UVMAP",l:[{a:"node_out",d:"iR",g:["vec3"],f:!1},{a:"node_param",d:"dT",g:["GLSL_IN","vec2"],
f:!1}],j:[{a:"txt",b:"iR = vec3 ( dT , ZERO_VALUE_NODES ) ;".split(" ")}]},{a:"node",d:"PARTICLE_INFO",l:[{a:"node_out",d:"iS",g:["float"],f:!1},{a:"node_out",d:"iT",g:["float"],f:!1},{a:"node_out",d:"iU",g:["float"],f:!1},{a:"node_out",d:"iV",g:["vec3"],f:!1},{a:"node_out",d:"iW",g:["float"],f:!1},{a:"node_out",d:"iX",g:["vec3"],f:!1},{a:"node_out",d:"iY",g:["vec3"],f:!1}],j:[{a:"txt",b:"iS = ZERO_VALUE_NODES ; iT = ZERO_VALUE_NODES ; iU = ZERO_VALUE_NODES ; iV = vec3 ( ZERO_VALUE_NODES ) ; iW = ZERO_VALUE_NODES ; iX = iV ; iY = iV ;".split(" ")}]},
{a:"node",d:"HAIR_INFO",l:[{a:"node_out",d:"iZ",g:["float"],f:!1},{a:"node_out",d:"i_",g:["float"],f:!1},{a:"node_out",d:"ja",g:["float"],f:!1},{a:"node_out",d:"jb",g:["vec3"],f:!1}],j:[{a:"txt",b:"iZ = ZERO_VALUE_NODES ; i_ = ZERO_VALUE_NODES ; ja = ZERO_VALUE_NODES ; jb = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},{a:"node",d:"OBJECT_INFO",l:[{a:"node_out",d:"jc",g:["vec3"],f:!1},{a:"node_out",d:"jd",g:["float"],f:!1},{a:"node_out",d:"je",g:["float"],f:!1},{a:"node_out",d:"jf",g:["float"],f:!1}],
j:[{a:"txt",b:"jd = ZERO_VALUE_NODES ; je = ZERO_VALUE_NODES ; jf = ZERO_VALUE_NODES ; jc = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},{a:"node",d:"WIREFRAME",l:[{a:"node_in",d:"jg",g:["float"],f:!1},{a:"node_out",d:"jh",g:["float"],f:!1}],j:[{a:"txt",b:["jh","=","jg",";"]}]},{a:"node",d:"TANGENT",l:[{a:"node_out",d:"ji",g:["vec3"],f:!1}],j:[{a:"txt",b:"ji = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},{a:"node",d:"LAYER_WEIGHT",l:[{a:"node_in",d:"jj",g:["float"],f:!1},{a:"node_in",d:"jk",g:["vec3"],
f:!1},{a:"node_out",d:"jl",g:["float"],f:!1},{a:"node_out",d:"jm",g:["float"],f:!1}],j:[{a:"txt",b:"jl = jm = ZERO_VALUE_NODES ;".split(" ")},{a:"txt",b:["jk",";","jj",";"]}]},{a:"node",d:"LIGHT_PATH",l:[{a:"node_out",d:"jn",g:["float"],f:!1},{a:"node_out",d:"jo",g:["float"],f:!1},{a:"node_out",d:"jp",g:["float"],f:!1},{a:"node_out",d:"jq",g:["float"],f:!1},{a:"node_out",d:"jr",g:["float"],f:!1},{a:"node_out",d:"js",g:["float"],f:!1},{a:"node_out",d:"jt",g:["float"],f:!1},{a:"node_out",d:"ju",g:["float"],
f:!1},{a:"node_out",d:"jv",g:["float"],f:!1},{a:"node_out",d:"jw",g:["float"],f:!1}],j:[{a:"txt",b:"jn = jo = jp = ZERO_VALUE_NODES ; jq = jr = js = ZERO_VALUE_NODES ; jt = jt = jv = jw = ZERO_VALUE_NODES ; ju = ZERO_VALUE_NODES ;".split(" ")}]},{a:"node",d:"ATTRIBUTE",l:[{a:"node_out",d:"jx",g:["vec3"],f:!1},{a:"node_out",d:"jy",g:["vec3"],f:!1},{a:"node_out",d:"jz",g:["float"],f:!1}],j:[{a:"txt",b:"jx = jy = vec3 ( ZERO_VALUE_NODES ) ; jz = ZERO_VALUE_NODES ;".split(" ")}]},{a:"node",d:"SCRIPT",
l:[],j:[]},{a:"node",d:"CURVE_VEC",l:[{a:"node_in",d:"jA",g:["float"],f:!1},{a:"node_in",d:"jB",g:["vec3"],f:!1},{a:"node_out",d:"jC",g:["vec3"],f:!1}],j:[{a:"txt",b:["jC","=","jB",";"]},{a:"node_cond",c:[{a:"node_if",e:["READ_R"],j:[{a:"txt",b:"jC . r = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( 0.5 * jB . r + 0.5 , NODE_TEX_ROW ) ) . r - 0.5 ) * 2.0 ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["READ_G"],j:[{a:"txt",b:"jC . g = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( 0.5 * jB . g + 0.5 , NODE_TEX_ROW ) ) . g - 0.5 ) * 2.0 ;".split(" ")}]}]},
{a:"node_cond",c:[{a:"node_if",e:["READ_B"],j:[{a:"txt",b:"jC . b = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( 0.5 * jB . b + 0.5 , NODE_TEX_ROW ) ) . b - 0.5 ) * 2.0 ;".split(" ")}]}]},{a:"txt",b:"jC = mix ( jB , jC , jA ) ;".split(" ")}]},{a:"node",d:"CURVE_RGB",l:[{a:"node_in",d:"jD",g:["float"],f:!1},{a:"node_in",d:"jE",g:["vec3"],f:!1},{a:"node_out",d:"jF",g:["vec3"],f:!1}],j:[{a:"node_cond",c:[{a:"node_if",e:["READ_A"],j:[{a:"txt",b:"float r = GLSL_TEXTURE ( u_nodes_texture , vec2 ( jE . r , NODE_TEX_ROW ) ) . a ; float g = GLSL_TEXTURE ( u_nodes_texture , vec2 ( jE . g , NODE_TEX_ROW ) ) . a ; float b = GLSL_TEXTURE ( u_nodes_texture , vec2 ( jE . b , NODE_TEX_ROW ) ) . a ;".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"float r = jE . r ; float g = jE . g ; float b = jE . b ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["READ_R"],j:[{a:"txt",b:"jF . r = GLSL_TEXTURE ( u_nodes_texture , vec2 ( r , NODE_TEX_ROW ) ) . r ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"jF . r = r ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["READ_G"],j:[{a:"txt",b:"jF . g = GLSL_TEXTURE ( u_nodes_texture , vec2 ( g , NODE_TEX_ROW ) ) . g ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"jF . g = g ;".split(" ")}]}]},
{a:"node_cond",c:[{a:"node_if",e:["READ_B"],j:[{a:"txt",b:"jF . b = GLSL_TEXTURE ( u_nodes_texture , vec2 ( b , NODE_TEX_ROW ) ) . b ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"jF . b = b ;".split(" ")}]}]},{a:"txt",b:"jF = mix ( jE , jF , jD ) ;".split(" ")}]},{a:"node",d:"VALTORGB",l:[{a:"node_in",d:"jG",g:["float"],f:!1},{a:"node_out",d:"jH",g:["vec3"],f:!1},{a:"node_out",d:"jI",g:["float"],f:!1}],j:[{a:"txt",b:"vec4 jJ = GLSL_TEXTURE ( u_nodes_texture , vec2 ( jG , NODE_TEX_ROW ) ) ; jH = jJ . rgb ; jI = jJ . a ;".split(" ")}]},
{a:"node",d:"MAPPING",l:[{a:"node_in",d:"jK",g:["vec3"],f:!1},{a:"node_out",d:"jL",g:["vec3"],f:!1}],j:[{a:"txt",b:["jL","=","jK",";"]},{a:"node_cond",c:[{a:"node_ifdef",d:"MAPPING_TRS_MATRIX",j:[{a:"txt",b:"jL = ( MAPPING_TRS_MATRIX * vec4 ( jL , UNITY_VALUE_NODES ) ) . xyz ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_ifdef",d:"MAPPING_SCALE",j:[{a:"txt",b:"jL = jL * MAPPING_SCALE ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_ifdef",d:"MAPPING_TRANSLATION",j:[{a:"txt",b:"jL = jL + MAPPING_TRANSLATION ;".split(" ")}]}]},
{a:"node_cond",c:[{a:"node_ifdef",d:"MAPPING_MIN_CLIP",j:[{a:"txt",b:"jL = max ( jL , MAPPING_MIN_CLIP ) ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_ifdef",d:"MAPPING_MAX_CLIP",j:[{a:"txt",b:"jL = min ( jL , MAPPING_MAX_CLIP ) ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["MAPPING_IS_NORMAL"],j:[{a:"txt",b:"jL = normalize ( jL ) ;".split(" ")}]}]}]},{a:"node",d:"MATH_ADD",l:[{a:"node_in",d:"jM",g:["float"],f:!1},{a:"node_in",d:"jN",g:["float"],f:!1},{a:"node_out",d:"jO",g:["float"],f:!1}],
j:[{a:"txt",b:"jO = jM + jN ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"jO = clamp ( jO , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{a:"node",d:"MATH_SUBTRACT",l:[{a:"node_in",d:"jP",g:["float"],f:!1},{a:"node_in",d:"jQ",g:["float"],f:!1},{a:"node_out",d:"jR",g:["float"],f:!1}],j:[{a:"txt",b:"jR = jP - jQ ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"jR = clamp ( jR , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{a:"node",d:"MATH_MULTIPLY",l:[{a:"node_in",d:"jS",g:["float"],f:!1},{a:"node_in",d:"jT",g:["float"],f:!1},{a:"node_out",d:"jU",g:["float"],f:!1}],j:[{a:"txt",b:"jU = jS * jT ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"jU = clamp ( jU , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{a:"node",d:"MATH_DIVIDE",l:[{a:"node_in",d:"jV",g:["float"],f:!1},{a:"node_in",d:"jW",g:["float"],f:!1},{a:"node_out",d:"jX",g:["float"],f:!1}],j:[{a:"txt",b:"jX = ( jW != ZERO_VALUE_NODES ) ? jV / jW : ZERO_VALUE_NODES ;".split(" ")},
{a:"node_cond",c:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"jX = clamp ( jX , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{a:"node",d:"MATH_SINE",l:[{a:"node_in",d:"jY",g:["float"],f:!1},{a:"node_in",d:"jZ",g:["float"],f:!1},{a:"node_out",d:"j_",g:["float"],f:!1}],j:[{a:"txt",b:"j_ = sin ( jY ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"j_ = clamp ( j_ , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{a:"txt",b:["jZ",";"]}]},
{a:"node",d:"MATH_COSINE",l:[{a:"node_in",d:"ka",g:["float"],f:!1},{a:"node_in",d:"kb",g:["float"],f:!1},{a:"node_out",d:"kc",g:["float"],f:!1}],j:[{a:"txt",b:"kc = cos ( ka ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"kc = clamp ( kc , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{a:"txt",b:["kb",";"]}]},{a:"node",d:"MATH_TANGENT",l:[{a:"node_in",d:"kd",g:["float"],f:!1},{a:"node_in",d:"ke",g:["float"],f:!1},{a:"node_out",d:"kf",g:["float"],f:!1}],
j:[{a:"txt",b:"kf = tan ( kd ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"kf = clamp ( kf , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{a:"txt",b:["ke",";"]}]},{a:"node",d:"MATH_ARCSINE",l:[{a:"node_in",d:"kg",g:["float"],f:!1},{a:"node_in",d:"kh",g:["float"],f:!1},{a:"node_out",d:"ki",g:["float"],f:!1}],j:[{a:"txt",b:"ki = ( kg <= UNITY_VALUE_NODES && kg >= - UNITY_VALUE_NODES ) ? asin ( kg ) : ZERO_VALUE_NODES ;".split(" ")},{a:"node_cond",c:[{a:"node_if",
e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"ki = clamp ( ki , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{a:"txt",b:["kh",";"]}]},{a:"node",d:"MATH_ARCCOSINE",l:[{a:"node_in",d:"kj",g:["float"],f:!1},{a:"node_in",d:"kk",g:["float"],f:!1},{a:"node_out",d:"kl",g:["float"],f:!1}],j:[{a:"txt",b:"kl = ( kj <= UNITY_VALUE_NODES && kj >= - UNITY_VALUE_NODES ) ? acos ( kj ) : ZERO_VALUE_NODES ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"kl = clamp ( kl , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},
{a:"txt",b:["kk",";"]}]},{a:"node",d:"MATH_ARCTANGENT",l:[{a:"node_in",d:"km",g:["float"],f:!1},{a:"node_in",d:"kn",g:["float"],f:!1},{a:"node_out",d:"ko",g:["float"],f:!1}],j:[{a:"txt",b:"ko = atan ( km ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"ko = clamp ( ko , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{a:"txt",b:["kn",";"]}]},{a:"node",d:"MATH_POWER",l:[{a:"node_in",d:"kp",g:["float"],f:!1},{a:"node_in",d:"kq",g:["float"],f:!1},{a:"node_out",
d:"kr",g:["float"],f:!1}],j:[{a:"txt",b:"if ( kp < ZERO_VALUE_NODES && kq != floor ( kq ) ) kr = ZERO_VALUE_NODES ; else if ( kq == ZERO_VALUE_NODES )".split(" ")},{a:"txt",b:"kr = UNITY_VALUE_NODES ; else if ( kp < ZERO_VALUE_NODES ) kr = mix ( UNITY_VALUE_NODES , - UNITY_VALUE_NODES , sign ( mod ( - kq , 2.0 ) ) ) * pow ( - kp , kq ) ; else if ( kp == ZERO_VALUE_NODES ) kr = ZERO_VALUE_NODES ; else kr = pow ( kp , kq ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",
b:"kr = clamp ( kr , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{a:"node",d:"MATH_LOGARITHM",l:[{a:"node_in",d:"ks",g:["float"],f:!1},{a:"node_in",d:"kt",g:["float"],f:!1},{a:"node_out",d:"ku",g:["float"],f:!1}],j:[{a:"txt",b:"ku = ( ks > ZERO_VALUE_NODES && kt > ZERO_VALUE_NODES ) ? log2 ( ks ) / log2 ( kt ) : ZERO_VALUE_NODES ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"ku = clamp ( ku , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{a:"node",d:"MATH_MINIMUM",l:[{a:"node_in",d:"kv",g:["float"],f:!1},{a:"node_in",d:"kw",g:["float"],f:!1},{a:"node_out",d:"kx",g:["float"],f:!1}],j:[{a:"txt",b:"kx = min ( kv , kw ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"kx = clamp ( kx , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{a:"node",d:"MATH_MAXIMUM",l:[{a:"node_in",d:"ky",g:["float"],f:!1},{a:"node_in",d:"kz",g:["float"],f:!1},{a:"node_out",d:"kA",g:["float"],f:!1}],j:[{a:"txt",b:"kA = max ( ky , kz ) ;".split(" ")},
{a:"node_cond",c:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"kA = clamp ( kA , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{a:"node",d:"MATH_ROUND",l:[{a:"node_in",d:"kB",g:["float"],f:!1},{a:"node_in",d:"kC",g:["float"],f:!1},{a:"node_out",d:"kD",g:["float"],f:!1}],j:[{a:"txt",b:"kD = floor ( kB + dz ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"kD = clamp ( kD , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{a:"txt",b:["kC",
";"]}]},{a:"node",d:"MATH_LESS_THAN",l:[{a:"node_in",d:"kE",g:["float"],f:!1},{a:"node_in",d:"kF",g:["float"],f:!1},{a:"node_out",d:"kG",g:["float"],f:!1}],j:[{a:"txt",b:"kG = ( kE < kF ) ? UNITY_VALUE_NODES : ZERO_VALUE_NODES ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"kG = clamp ( kG , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{a:"node",d:"MATH_GREATER_THAN",l:[{a:"node_in",d:"kH",g:["float"],f:!1},{a:"node_in",d:"kI",g:["float"],f:!1},{a:"node_out",
d:"kJ",g:["float"],f:!1}],j:[{a:"txt",b:"kJ = ( kH > kI ) ? UNITY_VALUE_NODES : ZERO_VALUE_NODES ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"kJ = clamp ( kJ , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{a:"node",d:"MATH_MODULO",l:[{a:"node_in",d:"kK",g:["float"],f:!1},{a:"node_in",d:"kL",g:["float"],f:!1},{a:"node_out",d:"kM",g:["float"],f:!1}],j:[{a:"txt",b:"kM = abs ( kL ) > 0.000001 ? mod ( kK , kL ) : ZERO_VALUE_NODES ;".split(" ")},{a:"node_cond",
c:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"kM = clamp ( kM , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{a:"node",d:"MATH_ABSOLUTE",l:[{a:"node_in",d:"kN",g:["float"],f:!1},{a:"node_in",d:"kO",g:["float"],f:!1},{a:"node_out",d:"kP",g:["float"],f:!1}],j:[{a:"txt",b:"kP = abs ( kN ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"kP = clamp ( kP , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{a:"txt",b:["kO",";"]}]},{a:"node",
d:"MIX_RGB_MIX",l:[{a:"node_in",d:"kQ",g:["float"],f:!1},{a:"node_in",d:"kR",g:["vec3"],f:!1},{a:"node_in",d:"kS",g:["vec3"],f:!1},{a:"node_out",d:"kT",g:["vec3"],f:!1}],j:[{a:"txt",b:"float iH = clamp ( kQ , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; kT = mix ( kR , kS , iH ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"kT = clamp ( kT , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{a:"node",d:"MIX_RGB_ADD",l:[{a:"node_in",d:"kU",g:["float"],f:!1},
{a:"node_in",d:"kV",g:["vec3"],f:!1},{a:"node_in",d:"kW",g:["vec3"],f:!1},{a:"node_out",d:"kX",g:["vec3"],f:!1}],j:[{a:"txt",b:"float iH = clamp ( kU , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; kX = mix ( kV , kV + kW , iH ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"kX = clamp ( kX , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{a:"node",d:"MIX_RGB_MULTIPLY",l:[{a:"node_in",d:"kY",g:["float"],f:!1},{a:"node_in",d:"kZ",g:["vec3"],f:!1},{a:"node_in",
d:"k_",g:["vec3"],f:!1},{a:"node_out",d:"la",g:["vec3"],f:!1}],j:[{a:"txt",b:"float iH = clamp ( kY , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; la = mix ( kZ , kZ * k_ , iH ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"la = clamp ( la , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{a:"node",d:"MIX_RGB_SUBTRACT",l:[{a:"node_in",d:"lb",g:["float"],f:!1},{a:"node_in",d:"lc",g:["vec3"],f:!1},{a:"node_in",d:"ld",g:["vec3"],f:!1},{a:"node_out",d:"le",
g:["vec3"],f:!1}],j:[{a:"txt",b:"float iH = clamp ( lb , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; le = mix ( lc , lc - ld , iH ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"le = clamp ( le , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{a:"node",d:"MIX_RGB_SCREEN",l:[{a:"node_in",d:"lf",g:["float"],f:!1},{a:"node_in",d:"lg",g:["vec3"],f:!1},{a:"node_in",d:"lh",g:["vec3"],f:!1},{a:"node_out",d:"li",g:["vec3"],f:!1}],j:[{a:"txt",b:"float iH = clamp ( lf , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; float lj = UNITY_VALUE_NODES - iH ; li = vec3 ( UNITY_VALUE_NODES ) - ( vec3 ( lj ) + iH * ( vec3 ( UNITY_VALUE_NODES ) - lh ) ) * ( vec3 ( UNITY_VALUE_NODES ) - lg ) ;".split(" ")},
{a:"node_cond",c:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"li = clamp ( li , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{a:"node",d:"MIX_RGB_DIVIDE",l:[{a:"node_in",d:"lk",g:["float"],f:!1},{a:"node_in",d:"ll",g:["vec3"],f:!1},{a:"node_in",d:"lm",g:["vec3"],f:!1},{a:"node_out",d:"ln",g:["vec3"],f:!1}],j:[{a:"txt",b:"float iH = clamp ( lk , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; float lj = UNITY_VALUE_NODES - iH ; lm += step ( lm , vec3 ( ZERO_VALUE_NODES ) ) ; ln = lj * ll + iH * ll / lm ;".split(" ")},
{a:"node_cond",c:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"ln = clamp ( ln , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{a:"node",d:"MIX_RGB_DIFFERENCE",l:[{a:"node_in",d:"lo",g:["float"],f:!1},{a:"node_in",d:"lp",g:["vec3"],f:!1},{a:"node_in",d:"lq",g:["vec3"],f:!1},{a:"node_out",d:"lr",g:["vec3"],f:!1}],j:[{a:"txt",b:"float iH = clamp ( lo , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; lr = mix ( lp , abs ( lp - lq ) , iH ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],
j:[{a:"txt",b:"lr = clamp ( lr , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{a:"node",d:"MIX_RGB_DARKEN",l:[{a:"node_in",d:"ls",g:["float"],f:!1},{a:"node_in",d:"lt",g:["vec3"],f:!1},{a:"node_in",d:"lu",g:["vec3"],f:!1},{a:"node_out",d:"lv",g:["vec3"],f:!1}],j:[{a:"txt",b:"float iH = clamp ( ls , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; lv = min ( lt . rgb , lu . rgb * iH ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"lv = clamp ( lv , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{a:"node",d:"MIX_RGB_LIGHTEN",l:[{a:"node_in",d:"lw",g:["float"],f:!1},{a:"node_in",d:"lx",g:["vec3"],f:!1},{a:"node_in",d:"ly",g:["vec3"],f:!1},{a:"node_out",d:"lz",g:["vec3"],f:!1}],j:[{a:"txt",b:"float iH = clamp ( lw , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; lz = max ( lx . rgb , ly . rgb * iH ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"lz = clamp ( lz , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{a:"node",d:"MIX_RGB_OVERLAY",l:[{a:"node_in",
d:"lA",g:["float"],f:!1},{a:"node_in",d:"lB",g:["vec3"],f:!1},{a:"node_in",d:"lC",g:["vec3"],f:!1},{a:"node_out",d:"lD",g:["vec3"],f:!1}],j:[{a:"txt",b:"float iH = clamp ( lA , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; vec3 lE = vec3 ( UNITY_VALUE_NODES - iH ) ; lD = mix ( lB * ( lE + 2.0 * iH * lC ) , vec3 ( UNITY_VALUE_NODES ) - ( lE + 2.0 * iH * ( vec3 ( UNITY_VALUE_NODES ) - lC ) ) * ( vec3 ( UNITY_VALUE_NODES ) - lB ) , step ( dz , lB ) ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],
j:[{a:"txt",b:"lD = clamp ( lD , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{a:"node",d:"MIX_RGB_DODGE",l:[{a:"node_in",d:"lF",g:["float"],f:!1},{a:"node_in",d:"lG",g:["vec3"],f:!1},{a:"node_in",d:"lH",g:["vec3"],f:!1},{a:"node_out",d:"lI",g:["vec3"],f:!1}],j:[{a:"txt",b:"float iH = clamp ( lF , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; vec3 lJ = vec3 ( UNITY_VALUE_NODES ) - iH * lH ; vec3 lK = clamp ( lG / lJ , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; lI = mix ( mix ( lK , vec3 ( UNITY_VALUE_NODES ) , step ( lJ , vec3 ( ZERO_VALUE_NODES ) ) ) , lG , step ( lG , vec3 ( ZERO_VALUE_NODES ) ) ) ;".split(" ")},
{a:"node_cond",c:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"lI = clamp ( lI , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{a:"node",d:"MIX_RGB_BURN",l:[{a:"node_in",d:"lL",g:["float"],f:!1},{a:"node_in",d:"lM",g:["vec3"],f:!1},{a:"node_in",d:"lN",g:["vec3"],f:!1},{a:"node_out",d:"lO",g:["vec3"],f:!1}],j:[{a:"txt",b:"float iH = clamp ( lL , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; vec3 lP = vec3 ( UNITY_VALUE_NODES - iH ) ; vec3 lJ = lP + iH * lN ; vec3 lK = clamp ( vec3 ( UNITY_VALUE_NODES ) - ( vec3 ( UNITY_VALUE_NODES ) - lM ) / lJ , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; lO = mix ( lK , vec3 ( ZERO_VALUE_NODES ) , step ( lJ , vec3 ( ZERO_VALUE_NODES ) ) ) ;".split(" ")},
{a:"node_cond",c:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"lO = clamp ( lO , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{a:"node",d:"MIX_RGB_HUE",l:[{a:"node_in",d:"lQ",g:["float"],f:!1},{a:"node_in",d:"lR",g:["vec3"],f:!1},{a:"node_in",d:"lS",g:["vec3"],f:!1},{a:"node_out",d:"lT",g:["vec3"],f:!1}],j:[{a:"txt",b:"float iH = clamp ( lQ , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; vec3 dG , lU , lJ ; lT = lR ; lU = dF ( lS ) ; if ( lU . y != ZERO_VALUE_NODES ) { dG = dF ( lT ) ; dG . x = lU . x ; lJ = dH ( dG ) ; lT = mix ( lT , lJ , iH ) ; }".split(" ")},
{a:"node_cond",c:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"lT = clamp ( lT , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{a:"node",d:"MIX_RGB_SATURATION",l:[{a:"node_in",d:"lV",g:["float"],f:!1},{a:"node_in",d:"lW",g:["vec3"],f:!1},{a:"node_in",d:"lX",g:["vec3"],f:!1},{a:"node_out",d:"lY",g:["vec3"],f:!1}],j:[{a:"txt",b:"float iH = clamp ( lV , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; float lj = UNITY_VALUE_NODES - iH ; lY = lW ; vec3 dG , lU ; dG = dF ( lY ) ; if ( dG . y != ZERO_VALUE_NODES ) { lU = dF ( lX ) ; dG . y = lj * dG . y + iH * lU . y ; lY = dH ( dG ) ; }".split(" ")},
{a:"node_cond",c:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"lY = clamp ( lY , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{a:"node",d:"MIX_RGB_VALUE",l:[{a:"node_in",d:"lZ",g:["float"],f:!1},{a:"node_in",d:"l_",g:["vec3"],f:!1},{a:"node_in",d:"ma",g:["vec3"],f:!1},{a:"node_out",d:"mb",g:["vec3"],f:!1}],j:[{a:"txt",b:"float iH = clamp ( lZ , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; float lj = UNITY_VALUE_NODES - iH ; vec3 dG , lU ; dG = dF ( l_ ) ; lU = dF ( ma ) ; dG . z = lj * dG . z + iH * lU . z ; mb = dH ( dG ) ;".split(" ")},
{a:"node_cond",c:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"mb = clamp ( mb , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{a:"node",d:"MIX_RGB_COLOR",l:[{a:"node_in",d:"mc",g:["float"],f:!1},{a:"node_in",d:"md",g:["vec3"],f:!1},{a:"node_in",d:"me",g:["vec3"],f:!1},{a:"node_out",d:"mf",g:["vec3"],f:!1}],j:[{a:"txt",b:"float iH = clamp ( mc , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; vec3 dG , lU , lJ ; mf = md ; lU = dF ( me ) ; if ( lU . y != ZERO_VALUE_NODES ) { dG = dF ( mf ) ; dG . x = lU . x ; dG . y = lU . y ; lJ = dH ( dG ) ; mf = mix ( mf , lJ , iH ) ; }".split(" ")},
{a:"node_cond",c:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"mf = clamp ( mf , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{a:"node",d:"MIX_RGB_SOFT_LIGHT",l:[{a:"node_in",d:"mg",g:["float"],f:!1},{a:"node_in",d:"mh",g:["vec3"],f:!1},{a:"node_in",d:"mi",g:["vec3"],f:!1},{a:"node_out",d:"mj",g:["vec3"],f:!1}],j:[{a:"txt",b:"float iH = clamp ( mg , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; float lj = UNITY_VALUE_NODES - iH ; vec3 mk = mi + mh - mi * mh ; mj = mh * ( vec3 ( lj ) + vec3 ( iH ) * ( ( vec3 ( UNITY_VALUE_NODES ) - mh ) * mi + mk ) ) ;".split(" ")},
{a:"node_cond",c:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"mj = clamp ( mj , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{a:"node",d:"MIX_RGB_LINEAR_LIGHT",l:[{a:"node_in",d:"ml",g:["float"],f:!1},{a:"node_in",d:"mm",g:["vec3"],f:!1},{a:"node_in",d:"mn",g:["vec3"],f:!1},{a:"node_out",d:"mo",g:["vec3"],f:!1}],j:[{a:"txt",b:"float iH = clamp ( ml , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; mo = mm + iH * ( 2.0 * mn - vec3 ( UNITY_VALUE_NODES ) ) ;".split(" ")},{a:"node_cond",
c:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"mo = clamp ( mo , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{a:"node",d:"OUTPUT",l:[{a:"node_in",d:"mp",g:["vec3"],f:!1},{a:"node_in",d:"mq",g:["float"],f:!1}],j:[{a:"txt",b:"ed = mp ; eh = mq ;".split(" ")}]},{a:"node",d:"MATERIAL_BEGIN",l:[{a:"node_in",d:"mr",g:["vec3"],f:!1},{a:"node_in",d:"ms",g:["vec3"],f:!1},{a:"node_in",d:"mt",g:["float"],f:!1},{a:"node_in",d:"mu",g:["vec3"],f:!0},{a:"node_in",d:"mv",g:["float"],f:!0},
{a:"node_out",d:"mw",g:["vec3"],f:!1},{a:"node_out",d:"mx",g:["vec3"],f:!1},{a:"node_out",d:"my",g:["vec3"],f:!1},{a:"node_out",d:"mz",g:["vec3"],f:!1},{a:"node_out",d:"mA",g:["vec3"],f:!1},{a:"node_out",d:"mB",g:["vec2"],f:!1},{a:"node_out",d:"mC",g:["vec2"],f:!1},{a:"node_out",d:"mD",g:["vec4"],f:!1},{a:"node_param",d:"dU",g:["const","vec2"],f:!1},{a:"node_param",d:"dV",g:["const","vec3"],f:!1}],j:[{a:"txt",b:"my = clamp ( mr , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},{a:"txt",b:"mz = dV [ 0 ] * clamp ( ms , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},
{a:"node_cond",c:[{a:"node_if",e:["USE_MATERIAL_NORMAL"],j:[{a:"txt",b:"mA = normalize ( mu ) ;".split(" ")},{a:"txt",b:"mA . yz = vec2 ( mA . z , - mA . y ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:["mA","=","ej",";"]}]}]},{a:"node_cond",c:[{a:"node_if",e:["SHADELESS_MAT",{a:"logic_negative_expr",i:1}],j:[{a:"node_cond",c:[{a:"node_if",e:["MATERIAL_EXT"],j:[{a:"txt",b:"mw = mv * my ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"mw = ep * my ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",
e:["USE_MATERIAL_DIFFUSE"],j:[{a:"txt",b:["my","*=","mt",";"]}]}]},{a:"txt",b:"mx = eq * u_environment_energy * dm ( mA ) ; mD = cV ( my ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["NUM_LIGHTS",0,{a:"g_expr",i:2}],j:[{a:"txt",b:"mB = vec2 ( dU [ 0 ] , dU [ 1 ] ) ;".split(" ")},{a:"txt",b:"mC = vec2 ( dV [ 1 ] , dV [ 2 ] ) ;".split(" ")}]}]},{a:"txt",b:["eg","=","mD",";"]}]},{a:"node_else",j:[{a:"txt",b:"mw = vec3 ( ZERO_VALUE_NODES ) ; mx = vec3 ( UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{a:"node",
d:"MATERIAL_END",l:[{a:"node_in",d:"mE",g:["vec4"],f:!1},{a:"node_in",d:"mF",g:["vec3"],f:!1},{a:"node_in",d:"mG",g:["vec3"],f:!1},{a:"node_in",d:"mH",g:["float"],f:!0},{a:"node_in",d:"mI",g:["float"],f:!0},{a:"node_in",d:"mJ",g:["float"],f:!0},{a:"node_out",d:"mK",g:["vec3"],f:!0},{a:"node_out",d:"mL",g:["float"],f:!0},{a:"node_out",d:"mM",g:["vec3"],f:!0},{a:"node_out",d:"mN",g:["vec3"],f:!0},{a:"node_out",d:"mO",g:["vec3"],f:!0},{a:"node_param",d:"dW",g:["float"],f:!1},{a:"node_param",d:"dX",g:["float"],
f:!1}],j:[{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_mK"],j:[{a:"node_cond",c:[{a:"node_if",e:["USE_MATERIAL_DIFFUSE"],j:[{a:"txt",b:"mK = mE . rgb ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"mK = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["MATERIAL_EXT","REFLECTION_TYPE","REFL_NONE",{a:"non_equal_expr",i:2},{a:"logical_and_expr",i:2}],j:[{a:"node_cond",c:[{a:"node_if",e:["REFLECTION_TYPE","REFL_PLANE",{a:"equal_expr",i:2}],j:[{a:"txt",b:"dk ( mK , dY , mG , mH , dZ ) ;".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"dk ( mK , dY , mG , mH , mat4 ( ZERO_VALUE_NODES ) ) ;".split(" ")}]}]}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:["mK","+=","mF",";"]}]}]}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_mM"],j:[{a:"txt",b:["mM","=","mG",";"]},{a:"txt",b:"mM . yz = vec2 ( - mM . z , mM . y ) ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["MATERIAL_EXT"],j:[{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_mN"],j:[{a:"txt",b:"mN = mE . rgb ;".split(" ")}]}]},
{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_mO"],j:[{a:"txt",b:["mO","=","mF",";"]}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_mL"],j:[{a:"txt",b:"mL = clamp ( mJ , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:"float t = max ( max ( mF . r , mF . g ) , mF . b ) * mI ; mL = clamp ( mJ * ( UNITY_VALUE_NODES - t ) + t , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]}]}]},{a:"node_else",j:[{a:"node_cond",
c:[{a:"node_if",e:["USE_OUT_mL"],j:[{a:"txt",b:"mL = clamp ( dW , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:"float t = max ( max ( mF . r , mF . g ) , mF . b ) * dX ; mL = dW * ( UNITY_VALUE_NODES - t ) + t ;".split(" ")}]}]}]}]}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:["ee","=","mF",";"]}]},{a:"node_else",j:[{a:"txt",b:"ee = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]}]},{a:"txt",
b:["ef","=","mG",";"]}]},{a:"node",d:"LIGHTING_AMBIENT",l:[{a:"node_in",d:"mP",g:["vec3"],f:!1},{a:"node_in",d:"mQ",g:["vec3"],f:!1},{a:"node_in",d:"mR",g:["vec3"],f:!1},{a:"node_out",d:"mS",g:["vec4"],f:!1},{a:"node_out",d:"mT",g:["vec3"],f:!1}],j:[{a:"txt",b:"mS = vec4 ( mP + mR * mQ , ZERO_VALUE_NODES ) ; mT = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},{a:"node",d:"LIGHTING_LAMP",l:[{a:"node_in",d:"mU",g:["vec4"],f:!1},{a:"node_out",d:"mV",g:["vec3"],f:!1},{a:"node_out",d:"mW",g:["vec2"],f:!1},
{a:"node_out",d:"mX",g:["vec3"],f:!1},{a:"node_out",d:"mY",g:["float"],f:!1}],j:[{a:"txt",b:"mW = u_light_factors [ LAMP_LIGHT_FACT_IND ] . LAMP_FAC_CHANNELS ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["LAMP_TYPE","HEMI",{a:"equal_expr",i:2}],j:[{a:"txt",b:["mY","=","dz",";"]}]},{a:"node_else",j:[{a:"txt",b:["mY","=","ZERO_VALUE_NODES",";"]}]}]},{a:"txt",b:"mX = u_light_color_intensities [ LAMP_IND ] ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["LAMP_SHADOW_MAP_IND",1,{a:"negative_expr",
i:1},{a:"non_equal_expr",i:2}],j:[{a:"txt",b:"mX *= mU [ LAMP_SHADOW_MAP_IND ] ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2},"LAMP_TYPE","POINT",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"vec3 mZ = u_light_positions [ LAMP_IND ] ; mV = mZ - en ;".split(" ")},{a:"txt",b:"float m_ = length ( mV ) ; mX *= LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + m_ * m_ ) ; mV = normalize ( mV ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["LAMP_TYPE",
"SPOT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vec3 na = u_light_directions [ LAMP_IND ] ; float fs = dot ( mV , na ) ; fs *= smoothstep ( ZERO_VALUE_NODES , UNITY_VALUE_NODES , ( fs - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; mX *= fs ;".split(" ")}]}]}]},{a:"node_else",j:[{a:"txt",b:"mV = u_light_directions [ LAMP_IND ] ;".split(" ")}]}]}]},{a:"node",d:"DIFFUSE_FRESNEL",l:[{a:"node_in",d:"nb",g:["vec3"],f:!1},{a:"node_in",d:"nc",g:["vec2"],f:!1},{a:"node_in",d:"nd",g:["vec3"],f:!1},{a:"node_in",d:"ne",
g:["float"],f:!1},{a:"node_in",d:"nf",g:["vec2"],f:!1},{a:"node_out",d:"ng",g:["float"],f:!1}],j:[{a:"txt",b:["vec3","nh","=","nd",";"]},{a:"node_cond",c:[{a:"node_if",e:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 ni = cross ( nb , bR . xyz ) ; nh = cross ( ni , bR . xyz ) ; nh = - normalize ( nh ) ;".split(" ")}]}]},{a:"txt",b:"ng = ZERO_VALUE_NODES ; if ( nc . r != ZERO_VALUE_NODES ) { float nj = ( UNITY_VALUE_NODES - ne ) * dot ( nh , nb ) + ne ; if ( nf [ 0 ] == ZERO_VALUE_NODES ) { ng = UNITY_VALUE_NODES ; } else { float t = UNITY_VALUE_NODES + abs ( nj ) ; t = nf [ 1 ] + ( UNITY_VALUE_NODES - nf [ 1 ] ) * pow ( t , nf [ 0 ] ) ; ng = clamp ( t , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; } ng = max ( ng , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{a:"node",d:"DIFFUSE_LAMBERT",l:[{a:"node_in",d:"nk",g:["vec3"],f:!1},{a:"node_in",d:"nl",g:["vec2"],f:!1},{a:"node_in",d:"nm",g:["vec3"],f:!1},{a:"node_in",d:"nn",g:["float"],f:!1},{a:"node_out",d:"no",g:["float"],f:!1}],j:[{a:"txt",b:["vec3","nh","=","nm",";"]},{a:"node_cond",c:[{a:"node_if",e:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 ni = cross ( nk , bR . xyz ) ; nh = cross ( ni , bR . xyz ) ; nh = - normalize ( nh ) ;".split(" ")}]}]},{a:"txt",b:"no = ZERO_VALUE_NODES ; if ( nl . r != ZERO_VALUE_NODES ) { float nj = ( UNITY_VALUE_NODES - nn ) * dot ( nh , nk ) + nn ; no = max ( nj , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{a:"node",d:"DIFFUSE_OREN_NAYAR",l:[{a:"node_in",d:"np",g:["vec3"],f:!1},{a:"node_in",d:"nq",g:["vec2"],f:!1},{a:"node_in",d:"nr",g:["vec3"],f:!1},{a:"node_in",d:"ns",g:["float"],f:!1},{a:"node_in",d:"nt",g:["vec2"],f:!1},{a:"node_out",d:"nu",g:["float"],f:!1}],j:[{a:"txt",b:["vec3","nh","=","nr",";"]},{a:"node_cond",c:[{a:"node_if",e:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 ni = cross ( np , bR . xyz ) ; nh = cross ( ni , bR . xyz ) ; nh = - normalize ( nh ) ;".split(" ")}]}]},{a:"txt",b:"nu = ZERO_VALUE_NODES ; if ( nq . r != ZERO_VALUE_NODES ) { float nj = ( UNITY_VALUE_NODES - ns ) * dot ( nh , np ) + ns ; if ( nt [ 0 ] > ZERO_VALUE_NODES ) { float nv = max ( dot ( nh , dY ) , ZERO_VALUE_NODES ) ; float nw = nt [ 0 ] * nt [ 0 ] ; float nx = UNITY_VALUE_NODES - dz * ( nw / ( nw + 0.33 ) ) ; vec3 ny = np - nj * nh ; vec3 nz = dY - nv * nh ;".split(" ")},
{a:"txt",b:"if ( length ( ny ) == ZERO_VALUE_NODES || length ( nz ) == ZERO_VALUE_NODES || abs ( nj ) > UNITY_VALUE_NODES || abs ( nv ) > UNITY_VALUE_NODES )".split(" ")},{a:"txt",b:"nu = nj * nx ; else { float nA = acos ( nj ) ; float nB = acos ( nv ) ; vec3 nC = normalize ( ny ) ; vec3 nD = normalize ( nz ) ; float a , b ; a = max ( nA , nB ) ; b = min ( nA , nB ) ; b *= 0.95 ; float t = max ( dot ( nC , nD ) , ZERO_VALUE_NODES ) ; float nE = 0.45 * ( nw / ( nw + 0.09 ) ) ; nu = nj * ( nx + ( nE * t * sin ( a ) * tan ( b ) ) ) ; } } else nu = nj ; nu = max ( nu , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{a:"node",d:"DIFFUSE_MINNAERT",l:[{a:"node_in",d:"nF",g:["vec3"],f:!1},{a:"node_in",d:"nG",g:["vec2"],f:!1},{a:"node_in",d:"nH",g:["vec3"],f:!1},{a:"node_in",d:"nI",g:["float"],f:!1},{a:"node_in",d:"nJ",g:["vec2"],f:!1},{a:"node_out",d:"nK",g:["float"],f:!1}],j:[{a:"txt",b:["vec3","nh","=","nH",";"]},{a:"node_cond",c:[{a:"node_if",e:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 ni = cross ( nF , bR . xyz ) ; nh = cross ( ni , bR . xyz ) ; nh = - normalize ( nh ) ;".split(" ")}]}]},{a:"txt",b:"nK = ZERO_VALUE_NODES ; if ( nG . r != ZERO_VALUE_NODES ) { float nj = ( UNITY_VALUE_NODES - nI ) * dot ( nh , nF ) + nI ; float nv = max ( dot ( nh , dY ) , ZERO_VALUE_NODES ) ; if ( nJ [ 0 ] <= UNITY_VALUE_NODES ) nK = nj * pow ( max ( nv * nj , 0.1 ) , nJ [ 0 ] - UNITY_VALUE_NODES ) ; else nK = nj * pow ( 1.0001 - nv , nJ [ 0 ] - UNITY_VALUE_NODES ) ; nK = max ( nK , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{a:"node",d:"DIFFUSE_TOON",l:[{a:"node_in",d:"nL",g:["vec3"],f:!1},{a:"node_in",d:"nM",g:["vec2"],f:!1},{a:"node_in",d:"nN",g:["vec3"],f:!1},{a:"node_in",d:"nO",g:["float"],f:!1},{a:"node_in",d:"nP",g:["vec2"],f:!1},{a:"node_out",d:"nQ",g:["float"],f:!1}],j:[{a:"txt",b:["vec3","nh","=","nN",";"]},{a:"node_cond",c:[{a:"node_if",e:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 ni = cross ( nL , bR . xyz ) ; nh = cross ( ni , bR . xyz ) ; nh = - normalize ( nh ) ;".split(" ")}]}]},{a:"txt",b:"nQ = ZERO_VALUE_NODES ; if ( nM . r != ZERO_VALUE_NODES ) { float nj = ( UNITY_VALUE_NODES - nO ) * dot ( nh , nL ) + nO ; float nR = acos ( nj ) ; if ( nR < nP [ 0 ] ) nQ = UNITY_VALUE_NODES ; else if ( nR > ( nP [ 0 ] + nP [ 1 ] ) || nP [ 1 ] == ZERO_VALUE_NODES ) nQ = ZERO_VALUE_NODES ; else nQ = UNITY_VALUE_NODES - ( ( nR - nP [ 0 ] ) / nP [ 1 ] ) ; nQ = max ( nQ , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{a:"node",d:"SPECULAR_PHONG",l:[{a:"node_in",d:"nS",g:["vec3"],f:!1},{a:"node_in",d:"nT",g:["vec2"],f:!1},{a:"node_in",d:"nU",g:["vec3"],f:!1},{a:"node_in",d:"nV",g:["float"],f:!1},{a:"node_in",d:"nW",g:["vec2"],f:!1},{a:"node_out",d:"nX",g:["float"],f:!1}],j:[{a:"txt",b:"nX = ZERO_VALUE_NODES ; if ( nT . g == UNITY_VALUE_NODES ) { vec3 nY = normalize ( nS + dY ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"if ( nV == ZERO_VALUE_NODES ) { nX = dot ( bR . xyz , nY ) ; nX = sqrt ( UNITY_VALUE_NODES - nX * nX ) ; }".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"nX = ( UNITY_VALUE_NODES - nV ) * max ( dot ( nU , nY ) , ZERO_VALUE_NODES ) + nV ;".split(" ")}]}]},{a:"txt",b:"nX = pow ( nX , nW [ 0 ] ) ; }".split(" ")}]},{a:"node",d:"SPECULAR_WARDISO",l:[{a:"node_in",d:"nZ",g:["vec3"],f:!1},{a:"node_in",d:"n_",g:["vec2"],f:!1},{a:"node_in",d:"oa",g:["vec3"],f:!1},{a:"node_in",d:"ob",g:["float"],f:!1},{a:"node_in",d:"oc",g:["vec2"],f:!1},{a:"node_out",d:"od",g:["float"],f:!1}],j:[{a:"txt",b:"od = ZERO_VALUE_NODES ; if ( n_ . g == UNITY_VALUE_NODES ) { vec3 nY = normalize ( nZ + dY ) ;".split(" ")},
{a:"node_cond",c:[{a:"node_if",e:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float oe = ZERO_VALUE_NODES ; float nv = ZERO_VALUE_NODES ; float of = ZERO_VALUE_NODES ; if ( ob == ZERO_VALUE_NODES ) { oe = dot ( bR . xyz , nY ) ; nv = dot ( bR . xyz , dY ) ; of = dot ( bR . xyz , nZ ) ; oe = sqrt ( UNITY_VALUE_NODES - oe * oe ) ; nv = sqrt ( UNITY_VALUE_NODES - nv * nv ) ; of = sqrt ( UNITY_VALUE_NODES - of * of ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float oe = max ( dot ( oa , nY ) , 0.001 ) ;".split(" ")},
{a:"txt",b:"float nv = max ( dot ( oa , dY ) , 0.01 ) ; float of = max ( dot ( oa , nZ ) , 0.01 ) ;".split(" ")}]}]},{a:"txt",b:"float O = tan ( acos ( oe ) ) ; float bf = max ( oc [ 0 ] , 0.001 ) ; od = of * ( UNITY_VALUE_NODES / ( 4.0 * M_PI * bf * bf ) ) * ( exp ( - ( O * O ) / ( bf * bf ) ) / ( sqrt ( nv * of ) ) ) ; }".split(" ")}]},{a:"node",d:"SPECULAR_TOON",l:[{a:"node_in",d:"og",g:["vec3"],f:!1},{a:"node_in",d:"oh",g:["vec2"],f:!1},{a:"node_in",d:"oi",g:["vec3"],f:!1},{a:"node_in",d:"oj",
g:["float"],f:!1},{a:"node_in",d:"ok",g:["vec2"],f:!1},{a:"node_out",d:"ol",g:["float"],f:!1}],j:[{a:"txt",b:"ol = ZERO_VALUE_NODES ; if ( oh . g == UNITY_VALUE_NODES ) { vec3 aV = normalize ( og + dY ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float om = dot ( aV , bR . xyz ) ; float O = ok [ 0 ] + ok [ 1 ] ; if ( oj == ZERO_VALUE_NODES ) O = acos ( sqrt ( UNITY_VALUE_NODES - om * om ) ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float O = acos ( dot ( aV , oi ) ) ;".split(" ")}]}]},
{a:"txt",b:"if ( O < ok [ 0 ] ) ol = UNITY_VALUE_NODES ; else if ( O >= ok [ 0 ] + ok [ 1 ] || ok [ 1 ] == ZERO_VALUE_NODES ) ol = ZERO_VALUE_NODES ; else ol = UNITY_VALUE_NODES - ( O - ok [ 0 ] ) / ok [ 1 ] ; }".split(" ")}]},{a:"node",d:"SPECULAR_BLINN",l:[{a:"node_in",d:"on",g:["vec3"],f:!1},{a:"node_in",d:"oo",g:["vec2"],f:!1},{a:"node_in",d:"op",g:["vec3"],f:!1},{a:"node_in",d:"oq",g:["float"],f:!1},{a:"node_in",d:"or",g:["vec2"],f:!1},{a:"node_out",d:"os",g:["float"],f:!1}],j:[{a:"txt",b:"os = ZERO_VALUE_NODES ; if ( oo . g == UNITY_VALUE_NODES ) { if ( or [ 0 ] < 1.0 || or [ 1 ] == ZERO_VALUE_NODES ) os = ZERO_VALUE_NODES ; else { if ( or [ 1 ] < 100.0 ) or [ 1 ] = sqrt ( 1.0 / or [ 1 ] ) ; else or [ 1 ] = 10.0 / or [ 1 ] ; vec3 nY = normalize ( dY + on ) ;".split(" ")},
{a:"node_cond",c:[{a:"node_if",e:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float oe = 0.0 ; if ( oq == ZERO_VALUE_NODES ) { float ot = dot ( bR . xyz , nY ) ; oe = sqrt ( UNITY_VALUE_NODES - ot * ot ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float oe = ( UNITY_VALUE_NODES - oq ) * max ( dot ( op , nY ) , ZERO_VALUE_NODES ) + oq ;".split(" ")}]}]},{a:"txt",b:"if ( oe < ZERO_VALUE_NODES ) os = ZERO_VALUE_NODES ; else { float nv = max ( dot ( op , dY ) , 0.01 ) ; float of = dot ( op , on ) ; if ( of <= 0.01 ) os = ZERO_VALUE_NODES ; else { float ou = max ( dot ( dY , nY ) , 0.01 ) ; float a = UNITY_VALUE_NODES ; float b = ( 2.0 * oe * nv ) / ou ; float ov = ( 2.0 * oe * of ) / ou ; float g = min ( min ( a , b ) , ov ) ; float p = sqrt ( pow ( or [ 0 ] , 2.0 ) + pow ( ou , 2.0 ) - UNITY_VALUE_NODES ) ; float ow = pow ( p - ou , 2.0 ) / pow ( p + ou , 2.0 ) * ( UNITY_VALUE_NODES + pow ( ou * ( p + ou ) - UNITY_VALUE_NODES , 2.0 ) / pow ( ou * ( p - ou ) + UNITY_VALUE_NODES , 2.0 ) ) ; float nR = acos ( oe ) ; os = max ( ow * g * exp ( - pow ( nR , 2.0 ) / ( 2.0 * pow ( or [ 1 ] , 2.0 ) ) ) , ZERO_VALUE_NODES ) ; } } } }".split(" ")}]},
{a:"node",d:"LIGHTING_APPLY",l:[{a:"node_in",d:"ox",g:["vec4"],f:!1},{a:"node_in",d:"oy",g:["vec3"],f:!1},{a:"node_in",d:"oz",g:["float"],f:!1},{a:"node_in",d:"oA",g:["float"],f:!1},{a:"node_in",d:"oB",g:["vec3"],f:!1},{a:"node_in",d:"oC",g:["vec3"],f:!1},{a:"node_in",d:"oD",g:["vec4"],f:!1},{a:"node_in",d:"oE",g:["vec3"],f:!1},{a:"node_in",d:"oF",g:["vec3"],f:!1},{a:"node_in",d:"oG",g:["vec3"],f:!1},{a:"node_in",d:"oH",g:["float"],f:!1},{a:"node_out",d:"oI",g:["vec4"],f:!1},{a:"node_out",d:"oJ",
g:["vec3"],f:!1}],j:[{a:"node_cond",c:[{a:"node_if",e:["USE_NODE_B4W_TRANSLUCENCY"],j:[{a:"txt",b:"if ( dot ( oB , oC ) * dot ( dY , oC ) < ZERO_VALUE_NODES ) { float oK = oD . x ; float oL = oD . y ; float oM = oD . z ; float oN = oD . w ;".split(" ")},{a:"txt",b:"float oO = clamp ( abs ( dot ( oB , oC ) ) , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; float oP = clamp ( dot ( dY , - oB ) , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; float oQ = pow ( oP , oL ) ;".split(" ")},{a:"txt",b:"oI = ox + oH * vec4 ( oG * oO * pow ( oE , vec3 ( oK ) ) , UNITY_VALUE_NODES ) ;".split(" ")},
{a:"txt",b:"oI += oM * mix ( vec4 ( oE , UNITY_VALUE_NODES ) , vec4 ( UNITY_VALUE_NODES ) , oN ) * oH * vec4 ( oG * oO * vec3 ( oQ ) , UNITY_VALUE_NODES ) ; oJ = oy ; } else {".split(" ")},{a:"txt",b:"oJ = oy + oG * oF * oA ; oI = ox + vec4 ( oG * oE * oz , oA ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"oJ = oy + oG * oF * oA ; oI = ox + vec4 ( oG * oE * oz , oA ) ;".split(" ")}]}]}]},{a:"node",d:"RGB",l:[{a:"node_out",d:"oR",g:["vec3"],f:!1}],j:[{a:"txt",b:"oR = u_node_rgbs [ RGB_IND ] ;".split(" ")}]},
{a:"node",d:"RGBTOBW",l:[{a:"node_in",d:"oS",g:["vec3"],f:!1},{a:"node_out",d:"oT",g:["float"],f:!1}],j:[{a:"txt",b:"oT = dot ( oS , vec3 ( 0.35 , 0.45 , 0.2 ) ) ;".split(" ")}]},{a:"node",d:"SEPRGB",l:[{a:"node_in",d:"oU",g:["vec3"],f:!1},{a:"node_out",d:"oV",g:["float"],f:!0},{a:"node_out",d:"oW",g:["float"],f:!0},{a:"node_out",d:"oX",g:["float"],f:!0}],j:[{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_oV"],j:[{a:"txt",b:"oV = oU . r ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_oW"],
j:[{a:"txt",b:"oW = oU . g ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_oX"],j:[{a:"txt",b:"oX = oU . b ;".split(" ")}]}]}]},{a:"node",d:"SEPHSV",l:[{a:"node_in",d:"oY",g:["vec3"],f:!1},{a:"node_out",d:"oZ",g:["float"],f:!0},{a:"node_out",d:"o_",g:["float"],f:!0},{a:"node_out",d:"pa",g:["float"],f:!0}],j:[{a:"txt",b:"vec3 pb = dF ( oY ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_oZ"],j:[{a:"txt",b:"oZ = pb . r ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_o_"],
j:[{a:"txt",b:"o_ = pb . g ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_pa"],j:[{a:"txt",b:"pa = pb . b ;".split(" ")}]}]}]},{a:"node",d:"SQUEEZE",l:[{a:"node_in",d:"pc",g:["float"],f:!1},{a:"node_in",d:"pd",g:["float"],f:!1},{a:"node_in",d:"pe",g:["float"],f:!1},{a:"node_out",d:"pf",g:["float"],f:!1}],j:[{a:"txt",b:"pf = UNITY_VALUE_NODES / ( UNITY_VALUE_NODES + pow ( 2.71828183 , - ( pc - pe ) * pd ) ) ;".split(" ")}]},{a:"node",d:"GAMMA",l:[{a:"node_in",d:"pg",g:["vec3"],f:!1},
{a:"node_in",d:"ph",g:["float"],f:!1},{a:"node_out",d:"pi",g:["vec3"],f:!1}],j:[{a:"txt",b:"pi = pg ; if ( pi . x > ZERO_VALUE_NODES ) pi . x = pow ( pg . x , ph ) ; if ( pi . y > ZERO_VALUE_NODES ) pi . y = pow ( pg . y , ph ) ; if ( pi . z > ZERO_VALUE_NODES ) pi . z = pow ( pg . z , ph ) ;".split(" ")}]},{a:"node",d:"B4W_SRGB_TO_LINEAR",l:[{a:"node_in",d:"pj",g:["vec3"],f:!1},{a:"node_out",d:"pk",g:["vec3"],f:!1}],j:[{a:"txt",b:"pk = max ( vec3 ( ZERO_VALUE_NODES ) , pj ) ; pk = pow ( pk , vec3 ( 2.2 ) ) ;".split(" ")}]},
{a:"node",d:"B4W_LINEAR_TO_SRGB",l:[{a:"node_in",d:"pl",g:["vec3"],f:!1},{a:"node_out",d:"pm",g:["vec3"],f:!1}],j:[{a:"txt",b:"pm = max ( vec3 ( ZERO_VALUE_NODES ) , pl ) ; pm = pow ( pm , vec3 ( UNITY_VALUE_NODES / 2.2 ) ) ;".split(" ")}]},{a:"node",d:"TEXTURE_EMPTY",l:[{a:"node_out",d:"pn",g:["vec3"],f:!1},{a:"node_out",d:"po",g:["vec3"],f:!1},{a:"node_out",d:"pr",g:["float"],f:!1}],j:[{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_pn"],j:[{a:"txt",b:"pn [ 2 ] = pn [ 1 ] = pn [ 0 ] = ZERO_VALUE_NODES ;".split(" ")}]}]},
{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_po"],j:[{a:"txt",b:"po [ 2 ] = po [ 1 ] = po [ 0 ] = ZERO_VALUE_NODES ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_pr"],j:[{a:"txt",b:["pr","=","ZERO_VALUE_NODES",";"]}]}]}]},{a:"node",d:"TEXTURE_ENVIRONMENT",l:[{a:"node_in",d:"pu",g:["vec3"],f:!1},{a:"node_out",d:"pv",g:["vec3"],f:!0},{a:"node_out",d:"pw",g:["float"],f:!0},{a:"node_param",d:"node_TEXTURE_ENVIRONMENT_var_texture",g:["uniform","samplerCube"],f:!1}],j:[{a:"txt",b:"vec3 px = vec3 ( pu . x , pu . z , - pu . y ) ; vec4 jJ = GLSL_TEXTURE_CUBE ( node_TEXTURE_ENVIRONMENT_var_texture , px ) ;".split(" ")},
{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_pv"],j:[{a:"txt",b:"pv = jJ . xyz ; bd ( pv ) ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_pw"],j:[{a:"txt",b:"pw = jJ . w ;".split(" ")}]}]}]},{a:"node",d:"TEXTURE_COLOR",l:[{a:"node_in",d:"py",g:["vec3"],f:!0},{a:"node_in",d:"pz",g:["vec3"],f:!0},{a:"node_in",d:"pA",g:["vec3"],f:!0},{a:"node_in",d:"pB",g:["vec3"],f:!0},{a:"node_out",d:"pC",g:["vec3"],f:!0},{a:"node_out",d:"pD",g:["float"],f:!0},{a:"node_out",d:"pE",g:["vec3"],f:!0},{a:"node_out",
d:"pF",g:["float"],f:!0},{a:"node_out",d:"pG",g:["vec3"],f:!0},{a:"node_out",d:"pH",g:["float"],f:!0},{a:"node_out",d:"pI",g:["vec3"],f:!0},{a:"node_out",d:"pJ",g:["float"],f:!0},{a:"node_param",d:"node_TEXTURE_COLOR_var_texture",g:["uniform","sampler2D"],f:!1}],j:[{a:"txt",b:"vec4 jJ = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , dK ( py ) ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_pC"],j:[{a:"txt",b:"pC = jJ . xyz ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["NON_COLOR",
{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bd","(","pC",")",";"]}]}]}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_pD"],j:[{a:"txt",b:"pD = jJ . w ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_uv2"],j:[{a:"txt",b:"jJ = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , dK ( pz ) ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_pE"],j:[{a:"txt",b:"pE = jJ . xyz ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bd",
"(","pE",")",";"]}]}]}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_pF"],j:[{a:"txt",b:"pF = jJ . w ;".split(" ")}]}]}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_uv3"],j:[{a:"txt",b:"jJ = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , dK ( pA ) ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_pG"],j:[{a:"txt",b:"pG = jJ . xyz ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bd","(","pG",")",";"]}]}]}]}]},{a:"node_cond",c:[{a:"node_if",
e:["USE_OUT_pH"],j:[{a:"txt",b:"pH = jJ . w ;".split(" ")}]}]}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_uv4"],j:[{a:"txt",b:"jJ = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , dK ( pB ) ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_pI"],j:[{a:"txt",b:"pI = jJ . xyz ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bd","(","pI",")",";"]}]}]}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_pJ"],j:[{a:"txt",b:"pJ = jJ . w ;".split(" ")}]}]}]}]}]},
{a:"node",d:"TEXTURE_NORMAL",l:[{a:"node_in",d:"pK",g:["vec3"],f:!0},{a:"node_in",d:"pL",g:["vec3"],f:!0},{a:"node_in",d:"pM",g:["vec3"],f:!0},{a:"node_in",d:"pN",g:["vec3"],f:!0},{a:"node_out",d:"pO",g:["vec3"],f:!0},{a:"node_out",d:"pP",g:["float"],f:!0},{a:"node_out",d:"pQ",g:["vec3"],f:!0},{a:"node_out",d:"pR",g:["float"],f:!0},{a:"node_out",d:"pS",g:["vec3"],f:!0},{a:"node_out",d:"pT",g:["float"],f:!0},{a:"node_out",d:"pU",g:["vec3"],f:!0},{a:"node_out",d:"pV",g:["float"],f:!0},{a:"node_param",
d:"node_TEXTURE_NORMAL_var_texture",g:["uniform","sampler2D"],f:!1}],j:[{a:"txt",b:"vec4 jJ = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , dK ( pK ) ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_pO"],j:[{a:"txt",b:"pO = normalize ( em * ( jJ . xyz - dz ) ) ;".split(" ")},{a:"txt",b:"pO . yz = vec2 ( - pO . z , pO . y ) ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_pP"],j:[{a:"txt",b:"pP = jJ . w ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_uv2"],j:[{a:"txt",
b:"jJ = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , dK ( pL ) ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_pQ"],j:[{a:"txt",b:"pQ = normalize ( em * ( jJ . xyz - dz ) ) ;".split(" ")},{a:"txt",b:"pQ . yz = vec2 ( - pQ . z , pQ . y ) ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_pR"],j:[{a:"txt",b:"pR = jJ . w ;".split(" ")}]}]}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_uv3"],j:[{a:"txt",b:"jJ = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , dK ( pM ) ) ;".split(" ")},
{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_pS"],j:[{a:"txt",b:"pS = normalize ( em * ( jJ . xyz - dz ) ) ;".split(" ")},{a:"txt",b:"pS . yz = vec2 ( - pS . z , pS . y ) ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_pT"],j:[{a:"txt",b:"pT = jJ . w ;".split(" ")}]}]}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_uv4"],j:[{a:"txt",b:"jJ = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , dK ( pN ) ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_pU"],j:[{a:"txt",b:"pU = normalize ( em * ( jJ . xyz - dz ) ) ;".split(" ")},
{a:"txt",b:"pU . yz = vec2 ( - pU . z , pU . y ) ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_pV"],j:[{a:"txt",b:"pV = jJ . w ;".split(" ")}]}]}]}]}]},{a:"node",d:"VALUE",l:[{a:"node_out",d:"pW",g:["float"],f:!1}],j:[{a:"txt",b:"pW = u_node_values [ VALUE_IND ] ;".split(" ")}]},{a:"node",d:"VECT_MATH_ADD",l:[{a:"node_in",d:"pX",g:["vec3"],f:!1},{a:"node_in",d:"pY",g:["vec3"],f:!1},{a:"node_out",d:"pZ",g:["vec3"],f:!1},{a:"node_out",d:"p_",g:["float"],f:!0}],j:[{a:"txt",b:"pZ = pX + pY ;".split(" ")},
{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_p_"],j:[{a:"txt",b:"p_ = ( abs ( pZ [ 0 ] ) + abs ( pZ [ 1 ] ) + abs ( pZ [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},{a:"node",d:"VECT_MATH_SUBTRACT",l:[{a:"node_in",d:"qa",g:["vec3"],f:!1},{a:"node_in",d:"qb",g:["vec3"],f:!1},{a:"node_out",d:"qc",g:["vec3"],f:!1},{a:"node_out",d:"qd",g:["float"],f:!0}],j:[{a:"txt",b:"qc = qa - qb ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_qd"],j:[{a:"txt",b:"qd = ( abs ( qc [ 0 ] ) + abs ( qc [ 1 ] ) + abs ( qc [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},
{a:"node",d:"VECT_MATH_AVERAGE",l:[{a:"node_in",d:"qe",g:["vec3"],f:!1},{a:"node_in",d:"qf",g:["vec3"],f:!1},{a:"node_out",d:"qg",g:["vec3"],f:!1},{a:"node_out",d:"qh",g:["float"],f:!0}],j:[{a:"txt",b:"qg = qe + qf ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_qh"],j:[{a:"txt",b:"qh = length ( qg ) ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_qg"],j:[{a:"txt",b:"qg = normalize ( qg ) ;".split(" ")}]}]}]},{a:"node",d:"VECT_MATH_DOT_PRODUCT",l:[{a:"node_in",d:"qi",g:["vec3"],
f:!1},{a:"node_in",d:"qj",g:["vec3"],f:!1},{a:"node_out",d:"qk",g:["vec3"],f:!1},{a:"node_out",d:"ql",g:["float"],f:!0}],j:[{a:"txt",b:"qk = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_ql"],j:[{a:"txt",b:"ql = dot ( qi , qj ) ;".split(" ")}]}]}]},{a:"node",d:"VECT_MATH_CROSS_PRODUCT",l:[{a:"node_in",d:"qm",g:["vec3"],f:!1},{a:"node_in",d:"qn",g:["vec3"],f:!1},{a:"node_out",d:"qo",g:["vec3"],f:!1},{a:"node_out",d:"qr",g:["float"],f:!0}],j:[{a:"txt",b:"qo = cross ( qm , qn ) ;".split(" ")},
{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_qr"],j:[{a:"txt",b:"qr = length ( qo ) ;".split(" ")}]}]}]},{a:"node",d:"VECT_MATH_NORMALIZE",l:[{a:"node_in",d:"qu",g:["vec3"],f:!1},{a:"node_in",d:"qv",g:["vec3"],f:!1},{a:"node_out",d:"qw",g:["vec3"],f:!1},{a:"node_out",d:"qx",g:["float"],f:!0}],j:[{a:"txt",b:"qw = normalize ( qu ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_qx"],j:[{a:"txt",b:"qx = length ( qu ) ;".split(" ")}]}]},{a:"txt",b:["qv",";"]}]},{a:"node",d:"B4W_REFLECT",l:[{a:"node_in",
d:"qy",g:["vec3"],f:!1},{a:"node_in",d:"qz",g:["vec3"],f:!1},{a:"node_out",d:"qA",g:["vec3"],f:!1}],j:[{a:"txt",b:"qA = reflect ( ( ea * vec4 ( qy , 0.0 ) ) . xyz , qz ) ;".split(" ")}]},{a:"node",d:"B4W_REFLECT_WORLD",l:[{a:"node_in",d:"qB",g:["vec3"],f:!1},{a:"node_out",d:"qC",g:["vec3"],f:!1}],j:[{a:"txt",b:"vec3 qD = vec3 ( - dY . x , dY . z , - dY . y ) ; qC = reflect ( qD , qB ) ;".split(" ")}]},{a:"node",d:"B4W_PARALLAX",l:[{a:"node_in",d:"qE",g:["vec3"],f:!1},{a:"node_in",d:"qF",g:["float"],
f:!1},{a:"node_in",d:"qG",g:["const","float"],f:!1},{a:"node_in",d:"qH",g:["const","float"],f:!1},{a:"node_out",d:"qI",g:["vec3"],f:!1},{a:"node_param",d:"node_B4W_PARALLAX_var_texture",g:["uniform","sampler2D"],f:!1}],j:[{a:"txt",b:"float bt = length ( eo ) ; if ( bt < qH ) { vec2 bv = dK ( qE ) ; float qJ = clamp ( dz * ( qH - bt ) , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; float bA = qF * qJ ;".split(" ")},{a:"txt",b:"vec3 qK = normalize ( dY * em ) ;".split(" ")},{a:"txt",b:"float qL = UNITY_VALUE_NODES / qG ;".split(" ")},
{a:"txt",b:"vec2 qM = qK . xy * bA / ( qG * qK . z ) ; float qN = UNITY_VALUE_NODES ; float aV = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bv ) . a ;".split(" ")},{a:"txt",b:"for ( float aQ = 1.0 ; aQ <= qG ; aQ ++ ) { if ( aV < qN ) { qN -= qL ; bv -= qM ; aV = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bv ) . a ; } }".split(" ")},{a:"txt",b:"vec2 qO = bv + qM ; float qP = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , qO ) . a - ( qN + qL ) ; float qQ = aV - qN ; float qR = qQ / ( qQ - qP ) ;".split(" ")},
{a:"txt",b:"bv = qR * qO + ( UNITY_VALUE_NODES - qR ) * bv ; qI = dJ ( bv ) ; } else qI = qE ;".split(" ")}]},{a:"node",d:"B4W_CLAMP",l:[{a:"node_in",d:"qS",g:["vec3"],f:!1},{a:"node_out",d:"qT",g:["vec3"],f:!1}],j:[{a:"txt",b:"qT = clamp ( qS , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]},{a:"node",d:"B4W_REFRACTION",l:[{a:"node_in",d:"qU",g:["vec3"],f:!1},{a:"node_in",d:"qV",g:["float"],f:!1},{a:"node_out",d:"qW",g:["vec3"],f:!1}],j:[{a:"txt",b:"qW = dC ( qU , qV ) ;".split(" ")}]},{a:"node",
d:"B4W_TRANSLUCENCY",l:[{a:"node_in",d:"qX",g:["float"],f:!1},{a:"node_in",d:"qY",g:["float"],f:!1},{a:"node_in",d:"qZ",g:["float"],f:!1},{a:"node_in",d:"q_",g:["float"],f:!1},{a:"node_in",d:"rc",g:["float"],f:!1},{a:"node_out",d:"rd",g:["float"],f:!0},{a:"node_out",d:"re",g:["vec4"],f:!0}],j:[{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_rd"],j:[{a:"txt",b:["rd","=","qX",";"]}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_re"],j:[{a:"txt",b:"re = vec4 ( qY , qZ , q_ , rc ) ;".split(" ")}]}]}]},{a:"node",
d:"B4W_TIME",l:[{a:"node_out",d:"rf",g:["float"],f:!1}],j:[{a:"txt",b:["rf","=","u_time",";"]}]},{a:"node",d:"B4W_SMOOTHSTEP",l:[{a:"node_in",d:"rh",g:["float"],f:!1},{a:"node_in",d:"ri",g:["float"],f:!1},{a:"node_in",d:"rj",g:["float"],f:!1},{a:"node_out",d:"rk",g:["float"],f:!1}],j:[{a:"txt",b:"rk = smoothstep ( ri , rj , rh ) ;".split(" ")}]},{a:"node",d:"B4W_GLOW_OUTPUT",l:[{a:"node_in",d:"rl",g:["vec3"],f:!1},{a:"node_in",d:"rm",g:["float"],f:!1}],j:[{a:"txt",b:"ed = rl ; eh = rm ;".split(" ")}]},
{a:"node",d:"B4W_VECTOSCAL",l:[{a:"node_in",d:"rn",g:["vec3"],f:!1},{a:"node_out",d:"ro",g:["float"],f:!1}],j:[{a:"txt",b:"ro = ( rn . r + rn . g + rn . b ) / 3.0 ;".split(" ")}]},{a:"node",d:"B4W_SCALTOVEC",l:[{a:"node_in",d:"rp",g:["float"],f:!1},{a:"node_out",d:"rq",g:["vec3"],f:!1}],j:[{a:"txt",b:"rq [ 0 ] = rp ; rq [ 1 ] = rp ; rq [ 2 ] = rp ;".split(" ")}]},{a:"nodes_global"},{a:"txt",b:"void rs ( in vec3 dY , in mat4 dZ , in mat4 d_ , in mat4 ea , in mat4 eb , in mat4 ec , out vec3 ed , out vec3 ee , out vec3 ef , out vec4 eg , out float eh ) { ed = vec3 ( ZERO_VALUE_NODES ) ; ee = vec3 ( ZERO_VALUE_NODES ) ; ef = vec3 ( ZERO_VALUE_NODES ) ; eg = vec4 ( ZERO_VALUE_NODES ) ; eh = ZERO_VALUE_NODES ;".split(" ")},
{a:"cond",c:[{a:"if",e:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO","USE_NODE_NORMAL_MAP",{a:"logical_or_expr",i:6}],h:{a:"grp",c:[{a:"txt",b:"vec3 l = normalize ( bI ) ; vec3 ei = l ;".split(" ")},{a:"cond",c:[{a:"if",e:["DOUBLE_SIDED_LIGHTING","USE_NODE_GEOMETRY_NO",{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["INVERT_FRONTFACING"],h:{a:"grp",c:[{a:"txt",b:["if","(","!","gl_FrontFacing",")"]}]}},{a:"else",h:{a:"grp",c:[{a:"txt",
b:["if","(","gl_FrontFacing",")"]}]}}]},{a:"txt",b:"ei = ei ; else ei = - ei ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["DOUBLE_SIDED_LIGHTING"],h:{a:"grp",c:[{a:"txt",b:["vec3","ej","=","ei",";"]}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:["vec3","ej","=","l",";"]}]}}]},{a:"cond",c:[{a:"if",e:["USE_NODE_GEOMETRY_NO"],h:{a:"grp",c:[{a:"txt",b:["vec3","ek","=","ei",";"]}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["CALC_TBN_SPACE"],h:{a:"grp",c:[{a:"txt",b:"vec3 k = cross ( ei , bJ . xyz ) * bJ . w ; mat3 el = mat3 ( bJ . xyz , k , ei ) ; mat3 em = el ;".split(" ")}]}}]},
{a:"txt",b:"vec3 en = bG ; vec4 eo = bH ; float ep = u_emit ; float eq = u_ambient ;".split(" ")},{a:"nodes_main"},{a:"txt",b:["}"]}]};a["include/to_world.glslv"]={a:"grp",c:[{a:"define",d:"M_PI",b:["3.14159265359"]},{a:"define",d:"MAX_BILLBOARD_ANGLE",b:["(","M_PI","/","4.0",")"]},{a:"txt",b:"const vec3 ru = vec3 ( 0.0 , 1.0 , 0.0 ) ;".split(" ")},{a:"cond",c:[{a:"if",e:["BILLBOARD_SPHERICAL","BILLBOARD",{a:"logic_negative_expr",i:1},"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW",{a:"equal_expr",i:2},
{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"mat4 rw ( vec3 rv , mat4 de ) { vec3 x = vec3 ( de [ 0 ] [ 0 ] , de [ 1 ] [ 0 ] , de [ 2 ] [ 0 ] ) ; vec3 y = vec3 ( de [ 0 ] [ 1 ] , de [ 1 ] [ 1 ] , de [ 2 ] [ 1 ] ) ; vec3 z = vec3 ( de [ 0 ] [ 2 ] , de [ 1 ] [ 2 ] , de [ 2 ] [ 2 ] ) ; y = cross ( z , x ) ; return mat4 ( vec4 ( x , 0.0 ) , vec4 ( y , 0.0 ) , vec4 ( z , 0.0 ) , vec4 ( rv , 1.0 ) ) ; }".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"mat4 rz ( vec3 rx , vec3 rv ) { vec3 ry = rx - rv ; ry . y = 0.0 ; ry = normalize ( ry ) ; vec3 x = normalize ( cross ( ru , ry ) ) ; vec3 y = normalize ( cross ( ry , x ) ) ; return mat4 ( vec4 ( x , 0.0 ) , vec4 ( y , 0.0 ) , vec4 ( ry , 0.0 ) , vec4 ( rv , 1.0 ) ) ; }".split(" ")}]}}]},
{a:"cond",c:[{a:"if",e:["BILLBOARD_JITTERED"],h:{a:"grp",c:[{a:"txt",b:"mat4 rI ( in vec3 rA , float rB , float rC , float rD , vec3 rE ) { float rF = fract ( length ( rE ) / 0.17 ) ; float rG = rD + rF / 10.0 ; float rH = rF ; if ( rD != 0.0 ) rH /= rD ; rA *= 1.0 + 0.5 * sin ( rB ) ; float O = length ( rA ) * rC * sin ( 2.0 * 3.14 * rB * rG + rH ) ; return R ( O ) ; }".split(" ")}]}}]},{a:"txt",b:"mat4 rQ ( in vec3 rx , in vec3 rJ , in mat4 de ) {".split(" ")},{a:"cond",c:[{a:"if",e:["BILLBOARD_SPHERICAL",
"BILLBOARD",{a:"logic_negative_expr",i:1},"BILLBOARD_ALIGN","BILLBOARD_ALIGN_VIEW",{a:"equal_expr",i:2},{a:"logical_and_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"mat4 rK = rw ( rJ , de ) ;".split(" ")}]}},{a:"elif",e:["BILLBOARD_RANDOM"],h:{a:"grp",c:[{a:"txt",b:"float rF = fract ( ( rJ . x * 1.43 + rJ . y * 0.123 + rJ . z * 6.1 ) ) ; float rL = 2.0 * M_PI * rF ; vec3 rM = normalize ( vec3 ( de [ 0 ] [ 2 ] , 0.0 , de [ 2 ] [ 2 ] ) ) ; float rN = acos ( rM [ 2 ] ) ; if ( rM [ 0 ] < 0.0 ) rN = 2.0 * M_PI - rN ; float rO = rN - rL ; if ( rO < 0.0 ) rO = 2.0 * M_PI + rO ; float rP = rL ; if ( rO <= MAX_BILLBOARD_ANGLE ) rP += rO ; else if ( rO <= M_PI - MAX_BILLBOARD_ANGLE ) rP += MAX_BILLBOARD_ANGLE * ( 2.0 * rO - M_PI ) / ( 2.0 * MAX_BILLBOARD_ANGLE - M_PI ) ; else if ( rO <= M_PI + MAX_BILLBOARD_ANGLE ) rP += rO - M_PI ; else if ( rO <= 2.0 * M_PI - MAX_BILLBOARD_ANGLE ) rP += MAX_BILLBOARD_ANGLE * ( 2.0 * rO - M_PI ) / ( 2.0 * MAX_BILLBOARD_ANGLE - M_PI ) + M_PI ; else rP += rO - 2.0 * M_PI ; mat4 rK = Q ( rP ) ; rK [ 3 ] = vec4 ( rJ , 1.0 ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",c:[{a:"txt",b:"mat4 rK = rz ( rx , rJ ) ;".split(" ")}]}}]},{a:"txt",b:["return","rK",";","}"]},{a:"cond",c:[{a:"if",e:["BILLBOARD_PRES_GLOB_ORIENTATION","STATIC_BATCH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2},"USE_INSTANCED_PARTCLS",{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"mat4 rS ( in vec3 rx , in vec3 rJ , in mat4 de , mat4 rR ) { mat4 rK = rQ ( rx , rJ , de ) ; rR [ 3 ] = vec4 ( 0.0 , 0.0 , 0.0 , 1.0 ) ; rK = rK * rR ; return rK ; }".split(" ")}]}}]},
{a:"txt",b:"e rZ ( in vec3 rT , in vec3 rU , in vec3 rV , in vec3 rW , in vec3 rX , in vec3 rY , in mat4 rR ) { rT = ( rR * vec4 ( rT , 1.0 ) ) . xyz ; rU = ( rR * vec4 ( rU , 1.0 ) ) . xyz ; rV = ( rR * vec4 ( rV , 0.0 ) ) . xyz ; rW = ( rR * vec4 ( rW , 0.0 ) ) . xyz ; rX = ( rR * vec4 ( rX , 0.0 ) ) . xyz ; rY = ( rR * vec4 ( rY , 0.0 ) ) . xyz ; return S ( e ( rT , rU , rV , rW , rX , rY , vec3 ( 0.0 ) ) ) ; }".split(" ")}]};a["include/scale_texcoord.glslv"]={a:"grp",c:[{a:"txt",b:"vec2 sa ( vec2 bv , vec3 r_ ) { return ( bv + 0.5 ) * r_ . xy - 0.5 ; }".split(" ")}]};
a["include/skin.glslv"]={a:"grp",c:[{a:"define",d:"SKIN_SLERP",b:["0"]},{a:"cond",c:[{a:"if",e:["SKINNED"],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["SKIN_SLERP"],h:{a:"grp",c:[{a:"txt",b:"vec4 si ( in vec4 v , in vec4 sb , in float sc ) { float sd = v [ 0 ] * sb [ 0 ] + v [ 1 ] * sb [ 1 ] + v [ 2 ] * sb [ 2 ] + v [ 3 ] * sb [ 3 ] ; if ( sd < 0.0 ) { sb *= - 1.0 ; sd = - sd ; } if ( abs ( sd ) >= 1.0 ) return v ; float se = acos ( sd ) ; float sf = sqrt ( 1.0 - sd * sd ) ; if ( abs ( sf ) < 0.001 ) return vec4 ( v * 0.5 + sb * 0.5 ) ; float sg = sin ( ( 1.0 - sc ) * se ) / sf ; float sh = sin ( sc * se ) / sf ; return v * sg + sb * sh ; }".split(" ")}]}}]},
{a:"cond",c:[{a:"if",e:["FRAMES_BLENDING"],h:{a:"grp",c:[{a:"txt",b:"vec3 sA ( in vec3 f , in vec4 sj , in vec4 sk , in vec4 sl , in vec4 sm , in float sn ) { vec3 so = E ( u_arm_rel_trans , u_arm_rel_quat , f ) ;".split(" ")},{a:"cond",c:[{a:"if",e:["SKIN_SLERP"],h:{a:"grp",c:[{a:"txt",b:"vec4 v = si ( sj , sk , sn ) ; vec4 sr = mix ( sl , sm , sn ) ; vec3 su = u ( v , so ) ; vec3 sv = su * sr . w + sr . xyz ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"vec3 sw = u ( sj , so ) ; vec3 sx = u ( sk , so ) ; vec3 sy = sw * sl . w + sl . xyz ; vec3 sz = sx * sm . w + sm . xyz ; vec3 sv = mix ( sy , sz , sn ) ;".split(" ")}]}}]},
{a:"txt",b:"return L ( u_arm_rel_trans , u_arm_rel_quat , sv ) ; } vec3 sG ( in vec3 sB , in vec4 sj , in vec4 sk , in float sn ) { vec3 sC = I ( u_arm_rel_trans , u_arm_rel_quat , sB ) ;".split(" ")},{a:"cond",c:[{a:"if",e:["SKIN_SLERP"],h:{a:"grp",c:[{a:"txt",b:"vec4 v = si ( sj , sk , sn ) ; vec3 sD = u ( v , sC ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"vec3 sE = u ( sj , sC ) ; vec3 sF = u ( sk , sC ) ; vec3 sD = mix ( sE , sF , sn ) ;".split(" ")}]}}]},{a:"txt",b:"return M ( u_arm_rel_trans , u_arm_rel_quat , sD ) ; }".split(" ")}]}},
{a:"else",h:{a:"grp",c:[{a:"txt",b:"vec3 sA ( in vec3 f , in vec4 sj , in vec4 sl ) { vec3 so = E ( u_arm_rel_trans , u_arm_rel_quat , f ) ; vec3 su = u ( sj , so ) ; vec3 sv = su * sl . w + sl . xyz ; return L ( u_arm_rel_trans , u_arm_rel_quat , sv ) ; } vec3 sG ( in vec3 sB , in vec4 sj ) { vec3 sC = I ( u_arm_rel_trans , u_arm_rel_quat , sB ) ; vec3 sD = u ( sj , sC ) ; return M ( u_arm_rel_trans , u_arm_rel_quat , sD ) ; }".split(" ")}]}}]},{a:"txt",b:"void sQ ( inout vec3 f , inout vec3 i , inout vec3 k , inout vec3 l ) {".split(" ")},
{a:"cond",c:[{a:"if",e:["FRAMES_BLENDING"],h:{a:"grp",c:[{a:"txt",b:["float","sH","=","u_frame_factor",";"]}]}}]},{a:"txt",b:"if ( a_influence . y > 0.0 ) { vec3 sI = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 sJ = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 sK = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec3 sL = vec3 ( 0.0 , 0.0 , 0.0 ) ; vec4 sM = a_influence ; for ( int aQ = 0 ; aQ < 4 ; aQ ++ ) { int sN = int ( sM [ aQ ] ) ; float sO = fract ( sM [ aQ ] ) ;".split(" ")},{a:"cond",c:[{a:"if",e:["FRAMES_BLENDING"],h:{a:"grp",c:[{a:"txt",
b:"sI += sO * sA ( f , u_quatsb [ sN ] , u_quatsa [ sN ] , u_transb [ sN ] , u_transa [ sN ] , sH ) ; sJ += sO * sG ( i , u_quatsb [ sN ] , u_quatsa [ sN ] , sH ) ; sK += sO * sG ( k , u_quatsb [ sN ] , u_quatsa [ sN ] , sH ) ; sL += sO * sG ( l , u_quatsb [ sN ] , u_quatsa [ sN ] , sH ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"sI += sO * sA ( f , u_quatsb [ sN ] , u_transb [ sN ] ) ; sL += sO * sG ( l , u_quatsb [ sN ] ) ;".split(" ")},{a:"cond",c:[{a:"if",e:["DISABLE_TANGENT_SKINNING",
{a:"logic_negative_expr",i:1}],h:{a:"grp",c:[{a:"txt",b:"sJ += sO * sG ( i , u_quatsb [ sN ] ) ; sK += sO * sG ( k , u_quatsb [ sN ] ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:"} f = sI ; l = sL ;".split(" ")},{a:"cond",c:[{a:"if",e:["DISABLE_TANGENT_SKINNING",{a:"logic_negative_expr",i:1}],h:{a:"grp",c:[{a:"txt",b:"i = sJ ; k = sK ;".split(" ")}]}}]},{a:"txt",b:"} if ( ! ( a_influence . y > 0.0 ) ) { int sP = int ( a_influence [ 0 ] - 1.0 ) ; if ( sP > - 1 ) {".split(" ")},{a:"cond",c:[{a:"if",e:["FRAMES_BLENDING"],
h:{a:"grp",c:[{a:"txt",b:"f = sA ( f , u_quatsb [ sP ] , u_quatsa [ sP ] , u_transb [ sP ] , u_transa [ sP ] , sH ) ; i = sG ( i , u_quatsb [ sP ] , u_quatsa [ sP ] , sH ) ; k = sG ( k , u_quatsb [ sP ] , u_quatsa [ sP ] , sH ) ; l = sG ( l , u_quatsb [ sP ] , u_quatsa [ sP ] , sH ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"f = sA ( f , u_quatsb [ sP ] , u_transb [ sP ] ) ; l = sG ( l , u_quatsb [ sP ] ) ;".split(" ")},{a:"cond",c:[{a:"if",e:["DISABLE_TANGENT_SKINNING",{a:"logic_negative_expr",
i:1}],h:{a:"grp",c:[{a:"txt",b:"i = sG ( i , u_quatsb [ sP ] ) ; k = sG ( k , u_quatsb [ sP ] ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:["}","}","}"]}]}}]}]};a["include/wind_bending.glslv"]={a:"grp",c:[{a:"cond",c:[{a:"if",e:["WIND_BEND"],h:{a:"grp",c:[{a:"txt",b:"void tb ( inout vec3 bs , in vec3 sR , in float sS , in float sT , in float bm , in vec3 rA , in float sU ) { float sV = length ( sR ) ; float sW = sT * ( 1.0 + 0.1 * fract ( sV ) ) ; float sX = sS * sU * ( 1.0 + sin ( 2.0 * 3.14 * bm * sW + sV ) ) ; float sY = ( bs . y - sR . y ) * abs ( sX ) ; sY += 1.0 ; sY *= sY ; sY = sY * sY - sY ; vec3 sZ = bs ; sZ . xz += rA . xz * sY * sign ( sX ) ; vec3 s_ = sZ - sR ; if ( all ( equal ( s_ , vec3 ( 0.0 ) ) ) ) bs = sR ; else { float ta = length ( bs - sR ) ; bs = sR + normalize ( s_ ) * ta ; } }".split(" ")},
{a:"cond",c:[{a:"if",e:["DETAIL_BEND"],h:{a:"grp",c:[{a:"txt",b:"vec4 tc ( vec4 x ) { return x * x * ( 3.0 - 2.0 * x ) ; } vec4 td ( vec4 x ) { return abs ( fract ( x + 0.5 ) * 2.0 - 1.0 ) ; } vec4 te ( vec4 x ) { return tc ( td ( x ) ) ; } void tu ( inout vec3 bs , in float bm , in vec3 l , in vec3 rA , in vec3 sR , in float tf , in float tg , in float th , in vec3 ti ) { float tj ; float tk ; float tl ; vec2 tm ; vec4 tn ; vec2 to ; vec3 tr ; tj = dot ( sR , vec3 ( 1.0 ) ) ; tk = tj + ti . g ; tl = dot ( bs , vec3 ( ti . g ) ) ; tm = ( bm + vec2 ( tl , tk ) ) ; tn = ( ( fract ( ( tm . xxyy * vec4 ( 1.975 , 0.793 , 0.375 , 0.193 ) ) ) * 2.0 ) - 1.0 ) * length ( rA ) * tf ; tn = te ( tn ) ; to = tn . xz + tn . yw ; to . y = 0.5 - to . y ; tr = to . xyx * ti . rbr * vec3 ( tg * l . x , th , tg * l . z ) ; bs += tr ; }".split(" ")}]}}]},
{a:"txt",b:"void ty ( inout vec3 f , inout vec3 h , in vec3 l ) { vec3 tv = u_wind * 1.0 + 0.7 * sin ( u_time ) ;".split(" ")},{a:"cond",c:[{a:"if",e:["BEND_CENTER_ONLY"],h:{a:"grp",c:[{a:"txt",b:"vec3 tw = h ; vec3 tx = a_emitter_center ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"vec3 tw = f ; vec3 tx = h ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["MAIN_BEND_COL"],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["DETAIL_BEND"],h:{a:"grp",c:[{a:"txt",b:"tu ( tw , u_time , l , tv , tx , au_detail_bending_freq , au_detail_bending_amp , au_branch_bending_amp , a_bending_col_detail ) ;".split(" ")}]}}]},
{a:"txt",b:"tb ( tw , tx , au_wind_bending_amp , au_wind_bending_freq , u_time , tv , a_bending_col_main ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"tb ( tw , tx , au_wind_bending_amp , au_wind_bending_freq , u_time , tv , 1.0 ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["BEND_CENTER_ONLY"],h:{a:"grp",c:[{a:"txt",b:"f += tw - h ; h = tw ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"f = tw ; h = tx ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]};a["include/nodes.glslv"]={a:"grp",
c:[{a:"cond",c:[{a:"if",e:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:2},"PARTICLE_BATCH",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"GLSL_IN vec3 a_orco_tex_coord ; GLSL_OUT vec3 dy ;".split(" ")}]}}]},{a:"node",d:"TEX_COORD_UV",l:[{a:"node_param",d:"node_TEX_COORD_UV_var_a_uv",g:["GLSL_IN","vec2"],f:!1},{a:"node_param",d:"dS",g:["GLSL_OUT","vec2"],f:!1}],j:[{a:"txt",b:["dS","=","node_TEX_COORD_UV_var_a_uv",";"]}]},{a:"node",d:"UV_MERGED",
l:[{a:"node_param",d:"node_UV_MERGED_var_a_uv",g:["GLSL_IN","vec2"],f:!1},{a:"node_param",d:"dR",g:["GLSL_OUT","vec2"],f:!1}],j:[{a:"txt",b:["dR","=","node_UV_MERGED_var_a_uv",";"]}]},{a:"node",d:"UVMAP",l:[{a:"node_param",d:"node_UVMAP_var_a_uv",g:["GLSL_IN","vec2"],f:!1},{a:"node_param",d:"dT",g:["GLSL_OUT","vec2"],f:!1}],j:[{a:"txt",b:["dT","=","node_UVMAP_var_a_uv",";"]}]},{a:"node",d:"GEOMETRY_UV",l:[{a:"node_param",d:"node_GEOMETRY_UV_var_a_uv",g:["GLSL_IN","vec2"],f:!1},{a:"node_param",d:"dL",
g:["GLSL_OUT","vec2"],f:!1}],j:[{a:"txt",b:["dL","=","node_GEOMETRY_UV_var_a_uv",";"]}]},{a:"node",d:"GEOMETRY_VC",l:[{a:"node_param",d:"node_GEOMETRY_VC_var_a_vertex_color",g:["GLSL_IN","vec3"],f:!1},{a:"node_param",d:"tz",g:["GLSL_OUT","vec3"],f:!1}],j:[{a:"txt",b:["tz","=","node_GEOMETRY_VC_var_a_vertex_color",";"]}]},{a:"node",d:"GEOMETRY_VC1",l:[{a:"node_param",d:"node_GEOMETRY_VC1_var_a_vertex_color",g:["GLSL_IN","float"],f:!1},{a:"node_param",d:"tA",g:["GLSL_OUT","float"],f:!1}],j:[{a:"txt",
b:["tA","=","node_GEOMETRY_VC1_var_a_vertex_color",";"]}]},{a:"node",d:"GEOMETRY_VC2",l:[{a:"node_param",d:"node_GEOMETRY_VC2_var_a_vertex_color",g:["GLSL_IN","vec2"],f:!1},{a:"node_param",d:"tB",g:["GLSL_OUT","vec2"],f:!1}],j:[{a:"txt",b:["tB","=","node_GEOMETRY_VC2_var_a_vertex_color",";"]}]},{a:"node",d:"GEOMETRY_VC3",l:[{a:"node_param",d:"node_GEOMETRY_VC3_var_a_vertex_color",g:["GLSL_IN","vec3"],f:!1},{a:"node_param",d:"tC",g:["GLSL_OUT","vec3"],f:!1}],j:[{a:"txt",b:["tC","=","node_GEOMETRY_VC3_var_a_vertex_color",
";"]}]},{a:"nodes_global"},{a:"txt",b:["void","rs","(",")","{"]},{a:"cond",c:[{a:"if",e:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["dy","=","a_orco_tex_coord",";"]}]}}]},{a:"nodes_main"},{a:"txt",b:["}"]}]};a["include/dynamic_grass.glslv"]={a:"grp",c:[{a:"cond",c:[{a:"if",e:["DYNAMIC_GRASS"],h:{a:"grp",c:[{a:"txt",b:"vec2 ud ( vec3 f , float ua , vec2 ub ) { vec2 uc = vec2 ( ( f . x - ub . x ) / ua , - ( f . z - ub . y ) / ua ) ; return fract ( uc ) ; } vec2 ue ( vec2 dI , float ua , vec2 ub ) { return vec2 ( dI . x * ua , - dI . y * ua ) + ub ; } e uf ( ) { return e ( vec3 ( - 10000.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) , vec3 ( 0.0 ) ) ; } e uy ( vec3 f , vec3 i , vec3 ug , vec3 k , vec3 l , vec3 h , PRECISION sampler2D uh , sampler2D ui , vec3 uj , float uk , vec3 rx , vec4 ul , mat4 de ) { vec3 rM = u ( ul , vec3 ( 0.0 , - 1.0 , 0.0 ) ) ; float um = - rM . x ; float un = - rM . z ; vec2 ub = vec2 ( rx . x + uk * ( - 1.0 - um ) / 2.0 , rx . z + uk * ( 1.0 - un ) / 2.0 ) ; vec2 uo = ud ( h , uk , ub ) ; float up = uk / 2.0 ; vec2 uq = abs ( ue ( uo - vec2 ( 0.5 ) , uk , vec2 ( 0.0 ) ) ) ; float ur = up * ( 1.0 + sqrt ( 2.0 ) ) / 2.0 ; if ( length ( uq ) > ur ) return uf ( ) ; float us = uk / uj . z ; vec2 ut = ( uo - vec2 ( 0.5 ) ) * us + vec2 ( 0.5 ) ; vec3 uu = rM * ( uk / uj . z - 1.0 ) / 2.0 ; ut . x += uu . x ; ut . y -= uu . z ; vec4 uv = GLSL_TEXTURE ( ui , ut ) ; float bA = uv . r ; if ( bA < u_scale_threshold ) return uf ( ) ; float uw = uj . y - uj . x ; float qN = uj . y - GLSL_TEXTURE ( uh , ut ) . r * uw ; vec2 ux = f . xz - h . xz ; h . xz = ue ( uo , uk , ub ) ; h . y = qN ; f . xz = h . xz + ux ; f . y *= bA ; f . y += qN ; vec3 m = uv . gba ;".split(" ")},
{a:"cond",c:[{a:"if",e:["BILLBOARD"],h:{a:"grp",c:[{a:"txt",b:"f -= h ; mat4 rK = rQ ( rx , h , de ) ; e tJ = rZ ( f , h , i , ug , k , l , rK ) ; tJ . h = h ; tJ . m = m ; return S ( tJ ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"return S ( e ( f , h , i , ug , k , l , m ) ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]}}]}]};a["include/halo_color.glslf"]={a:"grp",c:[{a:"cond",c:[{a:"if",e:["NUM_RINGS","NUM_LINES",{a:"g_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"const int uD = NUM_RINGS ;".split(" ")}]}},
{a:"else",h:{a:"grp",c:[{a:"txt",b:"const int uD = NUM_LINES ;".split(" ")}]}}]},{a:"txt",b:"float uE ( float x ) { return x - floor ( x * ( 1.0 / 0.01 ) ) * 0.01 ; }".split(" ")},{a:"cond",c:[{a:"if",e:["NUM_RINGS"],h:{a:"grp",c:[{a:"txt",b:"void uM ( inout float uF , in float uG [ uD ] , in float uH ) { for ( int a = 0 ; a < NUM_RINGS ; a ++ ) { float uI = 40.0 * uG [ a ] ; float uJ = 300.0 * ( uE ( uI ) - 0.005 ) ; float uK = uI ; float uL = abs ( uK * ( u_halo_size * uJ - uH ) ) ; uF += 1.0 - min ( uL , 1.0 ) ; } }".split(" ")}]}}]},
{a:"cond",c:[{a:"if",e:["NUM_LINES"],h:{a:"grp",c:[{a:"txt",b:"void uR ( inout float uN , in float uG [ uD ] , in float m_ ) { for ( int a = 0 ; a < NUM_LINES ; a ++ ) { float uO = uG [ a ] ; float uP = uO ; float uQ = 1000.0 * ( uE ( uO ) - 0.005 ) ; float uL = 20.0 * abs ( uP * bQ . x + uQ * bQ . y ) ; uN += 1.0 - min ( uL , 1.0 ) ; } uN *= m_ ; }".split(" ")}]}}]},{a:"txt",b:"void uV ( inout float m_ , in vec2 bv ) { float uS , O ; O = atan ( bv . y , bv . x ) ; O *= ( 1.0 + 0.25 * float ( NUM_STARS ) ) ; float uT = cos ( O ) ; float uU = sin ( O ) ; O = ( uT * bv . x + uU * bv . y ) * ( uT * bv . y - uU * bv . x ) ; uS = abs ( O ) ; if ( uS < 1.0 ) { uS = ( 0.01 * u_halo_size ) / ( uS ) ; m_ *= sqrt ( min ( uS , 1.0 ) ) ; } } vec4 uX ( ) { float m_ = ( bQ . x * bQ . x + bQ . y * bQ . y ) ; float uH = sqrt ( m_ ) ; m_ = max ( 1.0 - m_ , 0.0 ) ; m_ = pow ( m_ , u_halo_hardness ) ; float bf = u_diffuse_color . a ;".split(" ")},
{a:"cond",c:[{a:"if",e:["NUM_RINGS","NUM_LINES",{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"float uG [ uD ] ; for ( int aQ = 0 ; aQ < uD ; aQ ++ ) { uG [ aQ ] = fract ( uC / float ( aQ + 1 ) ) - 1.0 ; }".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["NUM_RINGS"],h:{a:"grp",c:[{a:"txt",b:"float uF = 0.0 ; uM ( uF , uG , uH ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["NUM_LINES"],h:{a:"grp",c:[{a:"txt",b:"float uN = 0.0 ; uR ( uN , uG , m_ ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["NUM_STARS"],
h:{a:"grp",c:[{a:"txt",b:"uV ( m_ , bQ ) ;".split(" ")}]}}]},{a:"txt",b:"m_ *= bf ; vec3 m = u_diffuse_color . rgb ;".split(" ")},{a:"cond",c:[{a:"if",e:["NUM_RINGS"],h:{a:"grp",c:[{a:"txt",b:"uF *= m_ ; m += u_halo_rings_color * uF ; m_ += uF ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["NUM_LINES"],h:{a:"grp",c:[{a:"txt",b:"uN *= bf ; m += u_halo_lines_color * uN ; m_ += uN ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["SKY_STARS"],h:{a:"grp",c:[{a:"txt",b:"m_ *= max ( 1.0 - 2.0 * u_sun_intensity . x , 0.0 ) ;".split(" ")},
{a:"cond",c:[{a:"if",e:["WATER_EFFECTS","DISABLE_FOG",{a:"logic_negative_expr",i:1},{a:"logical_and_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"float bC = u_halo_stars_blend * ( uB . y - u_halo_stars_height ) ; m_ *= clamp ( bC , 0.0 , 1.0 ) ; m_ *= min ( u_cam_water_depth + 2.0 * WAVES_HEIGHT , 1.0 ) ;".split(" ")}]}}]}]}}]},{a:"txt",b:"vec4 uW = vec4 ( m , m_ ) ; return uW ; }".split(" ")}]};a["include/fog.glslf"]={a:"grp",c:[{a:"cond",c:[{a:"if",e:["USE_FOG"],h:{a:"grp",c:[{a:"txt",b:"void vi ( inout vec3 m , in float vf , in float qN , in vec4 vg ) { float uL = clamp ( ( vf - u_fog_params . z ) / u_fog_params . y , 0.0 , 1.0 ) ;".split(" ")},
{a:"cond",c:[{a:"if",e:["FOG_TYPE","QUADRATIC",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:["uL","*=","uL",";"]}]}},{a:"elif",e:["FOG_TYPE","LINEAR",{a:"equal_expr",i:2}],h:{a:"grp",c:[]}},{a:"elif",e:["FOG_TYPE","INVERSE_QUADRATIC",{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"uL = sqrt ( uL ) ;".split(" ")}]}}]},{a:"txt",b:"if ( u_fog_params . w > 0.0 ) { if ( qN > u_fog_params . w ) uL = 0.0 ; else { float vh = ( u_fog_params . w - max ( qN , 0.0 ) ) / u_fog_params . w ; uL *= vh * vh ; } } vg . a = 1.0 - ( 1.0 - uL ) * ( 1.0 - u_fog_params . x ) ; m = mix ( m , vg . rgb , vg . a ) ; }".split(" ")}]}}]},
{a:"cond",c:[{a:"if",e:["PROCEDURAL_FOG"],h:{a:"grp",c:[{a:"txt",b:"vec3 vn ( in mat4 vj , in vec3 cW ) { vec3 vk = mix ( vj [ 0 ] . rgb , vj [ 1 ] . rgb , max ( sign ( cW . x ) , 0.0 ) ) ; vec3 vl = mix ( vj [ 2 ] . rgb , vj [ 3 ] . rgb , max ( sign ( cW . z ) , 0.0 ) ) ; vec3 vm = vec3 ( vj [ 0 ] . a , vj [ 1 ] . a , vj [ 2 ] . a ) ; vec3 m = mix ( vk , vl , abs ( cW . z ) ) ; m = mix ( m , vm , abs ( cW . y ) ) ; bd ( m ) ; return m ; }".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["WATER_EFFECTS"],
h:{a:"grp",c:[{a:"txt",b:"void vo ( inout float ow ) { ow -= 0.5 ; ow = 4.0 * ( ow * ow * ow ) + 0.5 ; }".split(" ")},{a:"cond",c:[{a:"if",e:["WATER_EFFECTS"],h:{a:"grp",c:[{a:"txt",b:"void vy ( inout vec3 m , in float vf , in vec3 cW , in float vp , in vec4 vq , in float vr ) { float vs = max ( cW . y , 0.0 ) ; float vt = max ( vf - max ( vp / vs , 0.0 ) , 0.0 ) ; float vu = vq . w * vt ; vec3 vv = vec3 ( 0.0 , 0.02 , 0.05 ) ; vec3 vw = vq . rgb ; vu = min ( vu , 1.0 ) ; vo ( vu ) ; vu *= clamp ( 2.0 - vr , 0.0 , 1.0 ) ; vec3 vx = mix ( vw , vv , min ( vs , 1.0 ) ) ; vp = clamp ( - vp * 0.03 , 0.0 , 0.8 ) ; vx *= 1.0 - vp ; m = mix ( m , vx , vu ) ; }".split(" ")}]}}]}]}}]},
{a:"txt",b:"void vA ( inout vec3 m , float vf , vec3 cW , float vz ) {".split(" ")},{a:"cond",c:[{a:"if",e:["USE_FOG"],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["PROCEDURAL_FOG"],h:{a:"grp",c:[{a:"txt",b:"vec3 vj = vn ( u_cube_fog , cW ) ; vec4 vx = vec4 ( vj , u_fog_color_density . a ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:["vec4","vx","=","u_fog_color_density",";"]}]}}]},{a:"txt",b:"vi ( m , vf , bG . y , vx ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["WATER_EFFECTS"],h:{a:"grp",c:[{a:"txt",
b:"vy ( m , vf , cW , u_cam_water_depth , u_underwater_fog_color_density , vz ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[]}}]},{a:"txt",b:["}"]}]};a["include/shadow.glslv"]={a:"grp",c:[{a:"cond",c:[{a:"if",e:["SHADOW_USAGE","SHADOW_MASK_GENERATION",{a:"equal_expr",i:2},"SHADOW_USAGE","SHADOW_MAPPING_BLEND",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"vec4 vJ ( mat4 vE , vec4 vF , mat4 vG ) { vec2 vH = ( vE * vG [ 3 ] ) . xy ; float vI = SHADOW_TEX_RES / 2.0 ; vH = floor ( vH * vI + 0.5 ) / vI - vH ; vec4 cj = vE * vF ; cj . xy += vH ; cj . xyz = 0.5 * ( cj . xyz + cj . w ) ; return cj ; } void vM ( vec3 rT , vec3 vK ) {".split(" ")},
{a:"cond",c:[{a:"if",e:["MAC_OS_SHADOW_HACK"],h:{a:"grp",c:[{a:"txt",b:"mat4 vG = _ ( u_v_light_tsr [ 0 ] ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"mat4 vG = _ ( mat3 ( u_v_light_ts [ 0 ] , u_v_light_r [ 0 ] , 0.0 ) ) ;".split(" ")}]}}]},{a:"txt",b:"vec4 vL = vG * vec4 ( rT + u_normal_offset * vK , 1.0 ) ; bM = vJ ( u_p_light_matrix0 , vL , vG ) ;".split(" ")},{a:"cond",c:[{a:"if",e:["NUM_CAST_LAMPS",1,{a:"g_expr",i:2}],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["MAC_OS_SHADOW_HACK"],h:{a:"grp",
c:[{a:"txt",b:"vG = _ ( u_v_light_tsr [ 1 ] ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"vG = _ ( mat3 ( u_v_light_ts [ 1 ] , u_v_light_r [ 1 ] , 0.0 ) ) ;".split(" ")}]}}]},{a:"txt",b:"vL = vG * vec4 ( rT + u_normal_offset * vK , 1.0 ) ; bN = vJ ( u_p_light_matrix1 , vL , vG ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["NUM_CAST_LAMPS",2,{a:"g_expr",i:2}],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["MAC_OS_SHADOW_HACK"],h:{a:"grp",c:[{a:"txt",b:"vG = _ ( u_v_light_tsr [ 2 ] ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",c:[{a:"txt",b:"vG = _ ( mat3 ( u_v_light_ts [ 2 ] , u_v_light_r [ 2 ] , 0.0 ) ) ;".split(" ")}]}}]},{a:"txt",b:"vL = vG * vec4 ( rT + u_normal_offset * vK , 1.0 ) ; bO = vJ ( u_p_light_matrix2 , vL , vG ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["NUM_CAST_LAMPS",3,{a:"g_expr",i:2}],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["MAC_OS_SHADOW_HACK"],h:{a:"grp",c:[{a:"txt",b:"vG = _ ( u_v_light_tsr [ 3 ] ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"vG = _ ( mat3 ( u_v_light_ts [ 3 ] , u_v_light_r [ 3 ] , 0.0 ) ) ;".split(" ")}]}}]},
{a:"txt",b:"vL = vG * vec4 ( rT + u_normal_offset * vK , 1.0 ) ; bP = vJ ( u_p_light_matrix3 , vL , vG ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["CSM_SECTION1"],h:{a:"grp",c:[{a:"txt",b:"bN = vJ ( u_p_light_matrix1 , vL , vG ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["CSM_SECTION2"],h:{a:"grp",c:[{a:"txt",b:"bO = vJ ( u_p_light_matrix2 , vL , vG ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["CSM_SECTION3"],h:{a:"grp",c:[{a:"txt",b:"bP = vJ ( u_p_light_matrix3 , vL , vG ) ;".split(" ")}]}}]},
{a:"txt",b:["}"]}]}}]}]};a["include/lighting_nodes.glslf"]={a:"grp",c:[{a:"define",d:"M_PI",b:["3.14159265359"]},{a:"txt",b:"float ZERO_VALUE_NODES = 0.0 ; float UNITY_VALUE_NODES = 1.0 ; float dz = 0.5 ;".split(" ")},{a:"node",d:"LIGHTING_BEGIN",l:[{a:"node_out",d:"wa",g:["vec3"],f:!1},{a:"node_out",d:"wb",g:["vec3"],f:!1},{a:"node_out",d:"wc",g:["vec3"],f:!1},{a:"node_out",d:"wd",g:["vec3"],f:!0},{a:"node_out",d:"we",g:["vec3"],f:!0},{a:"node_out",d:"wf",g:["vec2"],f:!0},{a:"node_out",d:"wg",g:["vec2"],
f:!0},{a:"node_out",d:"wh",g:["vec4"],f:!0},{a:"node_out",d:"wi",g:["float"],f:!0},{a:"node_out",d:"wj",g:["vec4"],f:!0}],j:[{a:"txt",b:"wa = vR ; wb = vS ; wc = vT ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_wd"],j:[{a:"txt",b:["wd","=","vU",";"]}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_we"],j:[{a:"txt",b:["we","=","ej",";"]}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_wg"],j:[{a:"txt",b:["wg","=","vV",";"]}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_wf"],j:[{a:"txt",
b:["wf","=","vW",";"]}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_wh"],j:[{a:"txt",b:["wh","=","vX",";"]}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_wi"],j:[{a:"txt",b:["wi","=","vY",";"]}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_wj"],j:[{a:"txt",b:["wj","=","vZ",";"]}]}]}]},{a:"node",d:"LIGHTING_AMBIENT",l:[{a:"node_in",d:"mP",g:["vec3"],f:!1},{a:"node_in",d:"mQ",g:["vec3"],f:!1},{a:"node_in",d:"mR",g:["vec3"],f:!1},{a:"node_out",d:"mS",g:["vec4"],f:!1},{a:"node_out",d:"mT",g:["vec3"],
f:!1}],j:[{a:"txt",b:"mS = vec4 ( mP + mR * mQ , ZERO_VALUE_NODES ) ; mT = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},{a:"node",d:"LIGHTING_LAMP",l:[{a:"node_in",d:"mU",g:["vec4"],f:!1},{a:"node_out",d:"mV",g:["vec3"],f:!1},{a:"node_out",d:"mW",g:["vec2"],f:!1},{a:"node_out",d:"mX",g:["vec3"],f:!1},{a:"node_out",d:"mY",g:["float"],f:!1}],j:[{a:"txt",b:"mW = u_light_factors [ LAMP_LIGHT_FACT_IND ] . LAMP_FAC_CHANNELS ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["LAMP_TYPE","HEMI",{a:"equal_expr",
i:2}],j:[{a:"txt",b:["mY","=","dz",";"]}]},{a:"node_else",j:[{a:"txt",b:["mY","=","ZERO_VALUE_NODES",";"]}]}]},{a:"txt",b:"mX = u_light_color_intensities [ LAMP_IND ] ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["LAMP_SHADOW_MAP_IND",1,{a:"negative_expr",i:1},{a:"non_equal_expr",i:2}],j:[{a:"txt",b:"mX *= mU [ LAMP_SHADOW_MAP_IND ] ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2},"LAMP_TYPE","POINT",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",
b:"vec3 mZ = u_light_positions [ LAMP_IND ] ; mV = mZ - en ;".split(" ")},{a:"txt",b:"float m_ = length ( mV ) ; mX *= LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + m_ * m_ ) ; mV = normalize ( mV ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vec3 na = u_light_directions [ LAMP_IND ] ; float fs = dot ( mV , na ) ; fs *= smoothstep ( ZERO_VALUE_NODES , UNITY_VALUE_NODES , ( fs - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; mX *= fs ;".split(" ")}]}]}]},
{a:"node_else",j:[{a:"txt",b:"mV = u_light_directions [ LAMP_IND ] ;".split(" ")}]}]}]},{a:"node",d:"DIFFUSE_FRESNEL",l:[{a:"node_in",d:"nb",g:["vec3"],f:!1},{a:"node_in",d:"nc",g:["vec2"],f:!1},{a:"node_in",d:"nd",g:["vec3"],f:!1},{a:"node_in",d:"ne",g:["float"],f:!1},{a:"node_in",d:"nf",g:["vec2"],f:!1},{a:"node_out",d:"ng",g:["float"],f:!1}],j:[{a:"node_cond",c:[{a:"node_if",e:["USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 ni = cross ( nb , bR . xyz ) ; nd = cross ( ni , bR . xyz ) ; nd = - normalize ( nd ) ;".split(" ")}]}]},
{a:"txt",b:"ng = ZERO_VALUE_NODES ; if ( nc . r != ZERO_VALUE_NODES ) { float nj = ( UNITY_VALUE_NODES - ne ) * dot ( nd , nb ) + ne ; if ( nf [ 0 ] == ZERO_VALUE_NODES ) { ng = UNITY_VALUE_NODES ; } else { float t = UNITY_VALUE_NODES + abs ( nj ) ; t = nf [ 1 ] + ( UNITY_VALUE_NODES - nf [ 1 ] ) * pow ( t , nf [ 0 ] ) ; ng = clamp ( t , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; } ng = max ( ng , ZERO_VALUE_NODES ) ; }".split(" ")}]},{a:"node",d:"DIFFUSE_LAMBERT",l:[{a:"node_in",d:"nk",g:["vec3"],
f:!1},{a:"node_in",d:"nl",g:["vec2"],f:!1},{a:"node_in",d:"nm",g:["vec3"],f:!1},{a:"node_in",d:"nn",g:["float"],f:!1},{a:"node_out",d:"no",g:["float"],f:!1}],j:[{a:"node_cond",c:[{a:"node_if",e:["USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 ni = cross ( nk , bR . xyz ) ; nm = cross ( ni , bR . xyz ) ; nm = - normalize ( nm ) ;".split(" ")}]}]},{a:"txt",b:"no = ZERO_VALUE_NODES ; if ( nl . r != ZERO_VALUE_NODES ) { float nj = ( UNITY_VALUE_NODES - nn ) * dot ( nm , nk ) + nn ; no = max ( nj , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{a:"node",d:"DIFFUSE_OREN_NAYAR",l:[{a:"node_in",d:"np",g:["vec3"],f:!1},{a:"node_in",d:"nq",g:["vec2"],f:!1},{a:"node_in",d:"nr",g:["vec3"],f:!1},{a:"node_in",d:"ns",g:["float"],f:!1},{a:"node_in",d:"nt",g:["vec2"],f:!1},{a:"node_out",d:"nu",g:["float"],f:!1}],j:[{a:"node_cond",c:[{a:"node_if",e:["USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 ni = cross ( np , bR . xyz ) ; nr = cross ( ni , bR . xyz ) ; nr = - normalize ( nr ) ;".split(" ")}]}]},{a:"txt",b:"nu = ZERO_VALUE_NODES ; if ( nq . r != ZERO_VALUE_NODES ) { float nj = ( UNITY_VALUE_NODES - ns ) * dot ( nr , np ) + ns ; if ( nt [ 0 ] > ZERO_VALUE_NODES ) { float nv = max ( dot ( nr , dY ) , ZERO_VALUE_NODES ) ; float nw = nt [ 0 ] * nt [ 0 ] ; float nx = UNITY_VALUE_NODES - dz * ( nw / ( nw + 0.33 ) ) ; vec3 ny = np - nj * nr ; vec3 nz = dY - nv * nr ;".split(" ")},
{a:"txt",b:"if ( length ( ny ) == ZERO_VALUE_NODES || length ( nz ) == ZERO_VALUE_NODES || abs ( nj ) > UNITY_VALUE_NODES || abs ( nv ) > UNITY_VALUE_NODES )".split(" ")},{a:"txt",b:"nu = nj * nx ; else { float nA = acos ( nj ) ; float nB = acos ( nv ) ; vec3 nC = normalize ( ny ) ; vec3 nD = normalize ( nz ) ; float a , b ; a = max ( nA , nB ) ; b = min ( nA , nB ) ; b *= 0.95 ; float t = max ( dot ( nC , nD ) , ZERO_VALUE_NODES ) ; float nE = 0.45 * ( nw / ( nw + 0.09 ) ) ; nu = nj * ( nx + ( nE * t * sin ( a ) * tan ( b ) ) ) ; } } else nu = nj ; nu = max ( nu , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{a:"node",d:"DIFFUSE_MINNAERT",l:[{a:"node_in",d:"nF",g:["vec3"],f:!1},{a:"node_in",d:"nG",g:["vec2"],f:!1},{a:"node_in",d:"nH",g:["vec3"],f:!1},{a:"node_in",d:"nI",g:["float"],f:!1},{a:"node_in",d:"nJ",g:["vec2"],f:!1},{a:"node_out",d:"nK",g:["float"],f:!1}],j:[{a:"node_cond",c:[{a:"node_if",e:["USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 ni = cross ( nF , bR . xyz ) ; nH = cross ( ni , bR . xyz ) ; nH = - normalize ( nH ) ;".split(" ")}]}]},{a:"txt",b:"nK = ZERO_VALUE_NODES ; if ( nG . r != ZERO_VALUE_NODES ) { float nj = ( UNITY_VALUE_NODES - nI ) * dot ( nH , nF ) + nI ; float nv = max ( dot ( nH , dY ) , ZERO_VALUE_NODES ) ; if ( nJ [ 0 ] <= UNITY_VALUE_NODES ) nK = nj * pow ( max ( nv * nj , 0.1 ) , nJ [ 0 ] - UNITY_VALUE_NODES ) ; else nK = nj * pow ( 1.0001 - nv , nJ [ 0 ] - UNITY_VALUE_NODES ) ; nK = max ( nK , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{a:"node",d:"DIFFUSE_TOON",l:[{a:"node_in",d:"nL",g:["vec3"],f:!1},{a:"node_in",d:"nM",g:["vec2"],f:!1},{a:"node_in",d:"nN",g:["vec3"],f:!1},{a:"node_in",d:"nO",g:["float"],f:!1},{a:"node_in",d:"nP",g:["vec2"],f:!1},{a:"node_out",d:"nQ",g:["float"],f:!1}],j:[{a:"node_cond",c:[{a:"node_if",e:["USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 ni = cross ( nL , bR . xyz ) ; nN = cross ( ni , bR . xyz ) ; nN = - normalize ( nN ) ;".split(" ")}]}]},{a:"txt",b:"nQ = ZERO_VALUE_NODES ; if ( nM . r != ZERO_VALUE_NODES ) { float nj = ( UNITY_VALUE_NODES - nO ) * dot ( nN , nL ) + nO ; float nR = acos ( nj ) ; if ( nR < nP [ 0 ] ) nQ = UNITY_VALUE_NODES ; else if ( nR > ( nP [ 0 ] + nP [ 1 ] ) || nP [ 1 ] == ZERO_VALUE_NODES ) nQ = ZERO_VALUE_NODES ; else nQ = UNITY_VALUE_NODES - ( ( nR - nP [ 0 ] ) / nP [ 1 ] ) ; nQ = max ( nQ , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{a:"node",d:"SPECULAR_PHONG",l:[{a:"node_in",d:"nS",g:["vec3"],f:!1},{a:"node_in",d:"nT",g:["vec2"],f:!1},{a:"node_in",d:"nU",g:["vec3"],f:!1},{a:"node_in",d:"nV",g:["float"],f:!1},{a:"node_in",d:"nW",g:["vec2"],f:!1},{a:"node_out",d:"nX",g:["float"],f:!1}],j:[{a:"txt",b:"nX = ZERO_VALUE_NODES ; if ( nT . g != ZERO_VALUE_NODES ) { vec3 nY = normalize ( nS + dY ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["USE_TBN_SHADING"],j:[{a:"txt",b:"if ( nV == ZERO_VALUE_NODES ) { nX = dot ( bR . xyz , nY ) ; nX = sqrt ( UNITY_VALUE_NODES - nX * nX ) ; }".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"nX = ( UNITY_VALUE_NODES - nV ) * max ( dot ( nU , nY ) , ZERO_VALUE_NODES ) + nV ;".split(" ")}]}]},{a:"txt",b:"nX = pow ( nX , nW [ 0 ] ) ; }".split(" ")}]},{a:"node",d:"SPECULAR_WARDISO",l:[{a:"node_in",d:"nZ",g:["vec3"],f:!1},{a:"node_in",d:"n_",g:["vec2"],f:!1},{a:"node_in",d:"oa",g:["vec3"],f:!1},{a:"node_in",d:"ob",g:["float"],f:!1},{a:"node_in",d:"oc",g:["vec2"],f:!1},{a:"node_out",d:"od",g:["float"],f:!1}],j:[{a:"txt",b:"od = ZERO_VALUE_NODES ; if ( n_ . g != ZERO_VALUE_NODES ) { vec3 nY = normalize ( nZ + dY ) ;".split(" ")},
{a:"node_cond",c:[{a:"node_if",e:["USE_TBN_SHADING"],j:[{a:"txt",b:"float oe = ZERO_VALUE_NODES ; float nv = ZERO_VALUE_NODES ; float of = ZERO_VALUE_NODES ; if ( ob == ZERO_VALUE_NODES ) { oe = dot ( bR . xyz , nY ) ; nv = dot ( bR . xyz , dY ) ; of = dot ( bR . xyz , nZ ) ; oe = sqrt ( UNITY_VALUE_NODES - oe * oe ) ; nv = sqrt ( UNITY_VALUE_NODES - nv * nv ) ; of = sqrt ( UNITY_VALUE_NODES - of * of ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float oe = max ( dot ( oa , nY ) , 0.001 ) ;".split(" ")},
{a:"txt",b:"float nv = max ( dot ( oa , dY ) , 0.01 ) ; float of = max ( dot ( oa , nZ ) , 0.01 ) ;".split(" ")}]}]},{a:"txt",b:"float O = tan ( acos ( oe ) ) ; float bf = max ( oc [ 0 ] , 0.001 ) ; od = of * ( UNITY_VALUE_NODES / ( 4.0 * M_PI * bf * bf ) ) * ( exp ( - ( O * O ) / ( bf * bf ) ) / ( sqrt ( nv * of ) ) ) ; }".split(" ")}]},{a:"node",d:"SPECULAR_TOON",l:[{a:"node_in",d:"og",g:["vec3"],f:!1},{a:"node_in",d:"oh",g:["vec2"],f:!1},{a:"node_in",d:"oi",g:["vec3"],f:!1},{a:"node_in",d:"oj",
g:["float"],f:!1},{a:"node_in",d:"ok",g:["vec2"],f:!1},{a:"node_out",d:"ol",g:["float"],f:!1}],j:[{a:"txt",b:"ol = ZERO_VALUE_NODES ; if ( oh . g != ZERO_VALUE_NODES ) { vec3 aV = normalize ( og + dY ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["USE_TBN_SHADING"],j:[{a:"txt",b:"float om = dot ( aV , bR . xyz ) ; float O = ok [ 0 ] + ok [ 1 ] ; if ( oj == ZERO_VALUE_NODES ) O = acos ( sqrt ( UNITY_VALUE_NODES - om * om ) ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float O = acos ( dot ( aV , oi ) ) ;".split(" ")}]}]},
{a:"txt",b:"if ( O < ok [ 0 ] ) ol = UNITY_VALUE_NODES ; else if ( O >= ok [ 0 ] + ok [ 1 ] || ok [ 1 ] == ZERO_VALUE_NODES ) ol = ZERO_VALUE_NODES ; else ol = UNITY_VALUE_NODES - ( O - ok [ 0 ] ) / ok [ 1 ] ; }".split(" ")}]},{a:"node",d:"SPECULAR_BLINN",l:[{a:"node_in",d:"on",g:["vec3"],f:!1},{a:"node_in",d:"oo",g:["vec2"],f:!1},{a:"node_in",d:"op",g:["vec3"],f:!1},{a:"node_in",d:"oq",g:["float"],f:!1},{a:"node_in",d:"or",g:["vec2"],f:!1},{a:"node_out",d:"os",g:["float"],f:!1}],j:[{a:"txt",b:"os = ZERO_VALUE_NODES ; if ( oo . g != ZERO_VALUE_NODES ) { if ( or [ 0 ] < 1.0 || or [ 1 ] == ZERO_VALUE_NODES ) os = ZERO_VALUE_NODES ; else { if ( or [ 1 ] < 100.0 ) or [ 1 ] = sqrt ( 1.0 / or [ 1 ] ) ; else or [ 1 ] = 10.0 / or [ 1 ] ; vec3 nY = normalize ( dY + on ) ;".split(" ")},
{a:"node_cond",c:[{a:"node_if",e:["USE_TBN_SHADING"],j:[{a:"txt",b:"float oe = 0.0 ; if ( oq == ZERO_VALUE_NODES ) { float ot = dot ( bR . xyz , nY ) ; oe = sqrt ( UNITY_VALUE_NODES - ot * ot ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float oe = ( UNITY_VALUE_NODES - oq ) * max ( dot ( op , nY ) , ZERO_VALUE_NODES ) + oq ;".split(" ")}]}]},{a:"txt",b:"if ( oe < ZERO_VALUE_NODES ) os = ZERO_VALUE_NODES ; else { float nv = max ( dot ( op , dY ) , 0.01 ) ; float of = dot ( op , on ) ; if ( of <= 0.01 ) os = ZERO_VALUE_NODES ; else { float ou = max ( dot ( dY , nY ) , 0.01 ) ; float a = UNITY_VALUE_NODES ; float b = ( 2.0 * oe * nv ) / ou ; float ov = ( 2.0 * oe * of ) / ou ; float g = min ( min ( a , b ) , ov ) ; float p = sqrt ( pow ( or [ 0 ] , 2.0 ) + pow ( ou , 2.0 ) - UNITY_VALUE_NODES ) ; float ow = pow ( p - ou , 2.0 ) / pow ( p + ou , 2.0 ) * ( UNITY_VALUE_NODES + pow ( ou * ( p + ou ) - UNITY_VALUE_NODES , 2.0 ) / pow ( ou * ( p - ou ) + UNITY_VALUE_NODES , 2.0 ) ) ; float nR = acos ( oe ) ; os = max ( ow * g * exp ( - pow ( nR , 2.0 ) / ( 2.0 * pow ( or [ 1 ] , 2.0 ) ) ) , ZERO_VALUE_NODES ) ; } } } }".split(" ")}]},
{a:"node",d:"LIGHTING_APPLY",l:[{a:"node_in",d:"ox",g:["vec4"],f:!1},{a:"node_in",d:"oy",g:["vec3"],f:!1},{a:"node_in",d:"oz",g:["float"],f:!1},{a:"node_in",d:"oA",g:["float"],f:!1},{a:"node_in",d:"oB",g:["vec3"],f:!1},{a:"node_in",d:"oC",g:["vec3"],f:!1},{a:"node_in",d:"oD",g:["vec4"],f:!1},{a:"node_in",d:"oE",g:["vec3"],f:!1},{a:"node_in",d:"oF",g:["vec3"],f:!1},{a:"node_in",d:"oG",g:["vec3"],f:!1},{a:"node_in",d:"oH",g:["float"],f:!1},{a:"node_out",d:"oI",g:["vec4"],f:!1},{a:"node_out",d:"oJ",
g:["vec3"],f:!1}],j:[{a:"txt",b:"oJ = oy + oG * oF * oA ; oI = ox + vec4 ( oG * oE * oz , oA ) ;".split(" ")}]},{a:"node",d:"LIGHTING_END",l:[{a:"node_in",d:"wk",g:["vec4"],f:!1},{a:"node_in",d:"wl",g:["vec3"],f:!1}],j:[{a:"txt",b:"ed = wk . rgb ; v_ = wl ;".split(" ")}]},{a:"nodes_global"},{a:"txt",b:"void wm ( vec3 vR , vec3 vS , vec3 vT , vec3 vU , vec3 en , vec3 ej , vec3 dY , vec2 vV , vec2 vW , vec4 vX , float vY , vec4 vZ , out vec3 ed , out vec3 v_ ) {".split(" ")},{a:"nodes_main"},{a:"txt",
b:["}"]}]};a["include/particles_nodes.glslf"]={a:"grp",c:[{a:"define",d:"M_PI",b:["3.14159265359"]},{a:"txt",b:"float ZERO_VALUE_NODES = 0.0 ; float UNITY_VALUE_NODES = 1.0 ; float dz = 0.5 ;".split(" ")},{a:"cond",c:[{a:"if",e:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_SEPHSV",{a:"logical_or_expr",i:6}],h:{a:"grp",c:[{a:"txt",b:"vec3 dF ( vec3 rgb ) { vec4 dD = vec4 ( ZERO_VALUE_NODES , - UNITY_VALUE_NODES / 3.0 , 2.0 / 3.0 , - UNITY_VALUE_NODES ) ; vec4 p = mix ( vec4 ( rgb . bg , dD . wz ) , vec4 ( rgb . gb , dD . xy ) , step ( rgb . b , rgb . g ) ) ; vec4 q = mix ( vec4 ( p . xyw , rgb . r ) , vec4 ( rgb . r , p . yzx ) , step ( p . x , rgb . r ) ) ; float aH = q . x - min ( q . w , q . y ) ; float dE = 1.0e-10 ; return vec3 ( abs ( q . z + ( q . w - q . y ) / ( 6.0 * aH + dE ) ) , aH / ( q . x + dE ) , q . x ) ; }".split(" ")}]}}]},
{a:"cond",c:[{a:"if",e:["USE_NODE_HUE_SAT","USE_NODE_MIX_RGB_HUE","USE_NODE_MIX_RGB_SATURATION","USE_NODE_MIX_RGB_VALUE","USE_NODE_MIX_RGB_COLOR","USE_NODE_COMBHSV",{a:"logical_or_expr",i:6}],h:{a:"grp",c:[{a:"txt",b:"vec3 dH ( vec3 dG ) { vec4 dD = vec4 ( UNITY_VALUE_NODES , 2.0 / 3.0 , UNITY_VALUE_NODES / 3.0 , 3.0 ) ; vec3 p = abs ( fract ( vec3 ( dG . r , dG . r , dG . r ) + dD . xyz ) * 6.0 - dD . www ) ; return dG . b * mix ( dD . xxx , clamp ( p - dD . xxx , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) , dG . g ) ; }".split(" ")}]}}]},
{a:"cond",c:[{a:"if",e:["USE_NODE_GEOMETRY_UV","USE_NODE_B4W_PARALLAX","USE_NODE_UV_MERGED",{a:"logical_or_expr",i:3}],h:{a:"grp",c:[{a:"txt",b:"vec3 dJ ( vec2 dI ) { return vec3 ( dI * 2.0 - vec2 ( UNITY_VALUE_NODES , UNITY_VALUE_NODES ) , ZERO_VALUE_NODES ) ; }".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["USE_NODE_TEXTURE_COLOR","USE_NODE_TEXTURE_NORMAL","USE_NODE_B4W_PARALLAX",{a:"logical_or_expr",i:3}],h:{a:"grp",c:[{a:"txt",b:"vec2 dK ( vec3 C ) { return vec2 ( C . xy * dz + vec2 ( dz , dz ) ) ; }".split(" ")}]}}]},
{a:"node",d:"CAMERA",l:[{a:"node_out",d:"er",g:["vec3"],f:!0},{a:"node_out",d:"es",g:["float"],f:!0},{a:"node_out",d:"et",g:["float"],f:!0}],j:[{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_er"],j:[{a:"txt",b:"er = normalize ( eo . xyz ) ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_es"],j:[{a:"txt",b:"es = abs ( eo . z ) ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_et"],j:[{a:"txt",b:"et = length ( eo . xyz ) ;".split(" ")}]}]}]},{a:"node",d:"COMBRGB",l:[{a:"node_in",
d:"eu",g:["float"],f:!1},{a:"node_in",d:"ev",g:["float"],f:!1},{a:"node_in",d:"ew",g:["float"],f:!1},{a:"node_out",d:"ex",g:["vec3"],f:!1}],j:[{a:"txt",b:"ex = vec3 ( eu , ev , ew ) ;".split(" ")}]},{a:"node",d:"COMBHSV",l:[{a:"node_in",d:"ey",g:["float"],f:!1},{a:"node_in",d:"ez",g:["float"],f:!1},{a:"node_in",d:"eA",g:["float"],f:!1},{a:"node_out",d:"eB",g:["vec3"],f:!1}],j:[{a:"txt",b:"eB = dH ( vec3 ( ey , ez , eA ) ) ;".split(" ")}]},{a:"node",d:"EMPTY_UV",l:[{a:"node_out",d:"eC",g:["vec3"],
f:!1}],j:[{a:"txt",b:"eC = vec3 ( - UNITY_VALUE_NODES , - UNITY_VALUE_NODES , ZERO_VALUE_NODES ) ;".split(" ")}]},{a:"node",d:"EMPTY_VC",l:[{a:"node_out",d:"eD",g:["vec3"],f:!1}],j:[{a:"txt",b:"eD = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},{a:"node",d:"GEOMETRY_UV",l:[{a:"node_out",d:"eE",g:["vec3"],f:!1}],j:[{a:"txt",b:"eE = dJ ( bQ ) ;".split(" ")}]},{a:"node",d:"GEOMETRY_OR",l:[{a:"node_out",d:"eF",g:["vec3"],f:!1}],j:[{a:"txt",b:"eF = 2.0 * vec3 ( bQ , ZERO_VALUE_NODES ) - vec3 ( UNITY_VALUE_NODES ) ;".split(" ")}]},
{a:"node",d:"GEOMETRY_VC",l:[{a:"node_out",d:"eG",g:["vec3"],f:!1}],j:[{a:"txt",b:"eG = vec3 ( UNITY_VALUE_NODES ) ;".split(" ")}]},{a:"node",d:"GEOMETRY_VC1",l:[{a:"node_out",d:"eH",g:["float"],f:!1}],j:[{a:"txt",b:["eH","=","UNITY_VALUE_NODES",";"]}]},{a:"node",d:"GEOMETRY_VC2",l:[{a:"node_out",d:"eI",g:["float"],f:!1},{a:"node_out",d:"eJ",g:["float"],f:!1}],j:[{a:"txt",b:"eI = UNITY_VALUE_NODES ; eJ = UNITY_VALUE_NODES ;".split(" ")}]},{a:"node",d:"GEOMETRY_VC3",l:[{a:"node_out",d:"eK",g:["float"],
f:!1},{a:"node_out",d:"eL",g:["float"],f:!1},{a:"node_out",d:"eM",g:["float"],f:!1}],j:[{a:"txt",b:"eK = UNITY_VALUE_NODES ; eL = UNITY_VALUE_NODES ; eM = UNITY_VALUE_NODES ;".split(" ")}]},{a:"node",d:"GEOMETRY_NO",l:[{a:"node_out",d:"eN",g:["vec3"],f:!1}],j:[{a:"txt",b:"eN = ek . xzy ; eN . y *= - 1.0 ;".split(" ")}]},{a:"node",d:"GEOMETRY_FB",l:[{a:"node_out",d:"eO",g:["float"],f:!1}],j:[{a:"node_cond",c:[{a:"node_if",e:["INVERT_FRONTFACING"],j:[{a:"txt",b:"eO = ( gl_FrontFacing ) ? ZERO_VALUE_NODES : UNITY_VALUE_NODES ;".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"eO = ( gl_FrontFacing ) ? UNITY_VALUE_NODES : ZERO_VALUE_NODES ;".split(" ")}]}]}]},{a:"node",d:"GEOMETRY_VW",l:[{a:"node_out",d:"eP",g:["vec3"],f:!1}],j:[{a:"txt",b:"eP = - ( dZ * vec4 ( dY , 0.0 ) ) . xyz ;".split(" ")}]},{a:"node",d:"GEOMETRY_LO",l:[{a:"node_out",d:"eQ",g:["vec3"],f:!1}],j:[{a:"txt",b:"eQ [ 0 ] = eo [ 0 ] ; eQ [ 1 ] = eo [ 1 ] ; eQ [ 2 ] = eo [ 2 ] ;".split(" ")}]},{a:"node",d:"GEOMETRY_GL",l:[{a:"node_out",d:"eR",g:["vec3"],f:!1}],j:[{a:"txt",b:"eR = vec3 ( en . r , - en . b , en . g ) ;".split(" ")}]},
{a:"node",d:"NEW_GEOMETRY",l:[{a:"node_out",d:"eS",g:["vec3"],f:!1},{a:"node_out",d:"eT",g:["vec3"],f:!1},{a:"node_out",d:"eU",g:["vec3"],f:!1},{a:"node_out",d:"eV",g:["vec3"],f:!1},{a:"node_out",d:"eW",g:["vec3"],f:!1},{a:"node_out",d:"eX",g:["vec3"],f:!1},{a:"node_out",d:"eY",g:["float"],f:!1},{a:"node_out",d:"eZ",g:["float"],f:!1}],j:[{a:"txt",b:"eS = vec3 ( ZERO_VALUE_NODES ) ; eT = vec3 ( ZERO_VALUE_NODES ) ; eU = vec3 ( ZERO_VALUE_NODES ) ; eV = vec3 ( ZERO_VALUE_NODES ) ; eW = vec3 ( ZERO_VALUE_NODES ) ; eX = vec3 ( ZERO_VALUE_NODES ) ; eY = ZERO_VALUE_NODES ; eZ = ZERO_VALUE_NODES ;".split(" ")}]},
{a:"node",d:"HUE_SAT",l:[{a:"node_in",d:"e_",g:["float"],f:!1},{a:"node_in",d:"fa",g:["float"],f:!1},{a:"node_in",d:"fb",g:["float"],f:!1},{a:"node_in",d:"fc",g:["float"],f:!1},{a:"node_in",d:"fd",g:["vec3"],f:!1},{a:"node_out",d:"fe",g:["vec3"],f:!1}],j:[{a:"txt",b:"vec3 dG = dF ( fd ) ; dG [ 0 ] += ( e_ - dz ) ; if ( dG [ 0 ] > UNITY_VALUE_NODES ) dG [ 0 ] -= UNITY_VALUE_NODES ; else if ( dG [ 0 ] < ZERO_VALUE_NODES ) dG [ 0 ] += UNITY_VALUE_NODES ; dG *= vec3 ( UNITY_VALUE_NODES , fa , fb ) ; dG = mix ( vec3 ( UNITY_VALUE_NODES ) , mix ( vec3 ( ZERO_VALUE_NODES ) , dG , step ( vec3 ( ZERO_VALUE_NODES ) , dG ) ) , step ( dG , vec3 ( UNITY_VALUE_NODES ) ) ) ; fe = mix ( fd , dH ( dG ) , fc ) ;".split(" ")}]},
{a:"node",d:"INVERT",l:[{a:"node_in",d:"ff",g:["float"],f:!1},{a:"node_in",d:"fg",g:["vec3"],f:!1},{a:"node_out",d:"fh",g:["vec3"],f:!1}],j:[{a:"txt",b:"fh = mix ( fg , vec3 ( UNITY_VALUE_NODES ) - fg , ff ) ;".split(" ")}]},{a:"node",d:"LAMP",l:[{a:"node_out",d:"fi",g:["vec3"],f:!0},{a:"node_out",d:"fj",g:["vec3"],f:!1},{a:"node_out",d:"fk",g:["float"],f:!1},{a:"node_out",d:"fl",g:["float"],f:!0}],j:[{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_fi"],j:[{a:"txt",b:"fi = u_lamp_light_color_intensities [ LAMP_INDEX ] ;".split(" ")}]}]},
{a:"txt",b:"vec4 fm = u_lamp_light_factors [ LAMP_INDEX ] ; vec3 fn = u_lamp_light_directions [ LAMP_INDEX ] ; vec3 fo = u_lamp_light_positions [ LAMP_INDEX ] ; float fp = fm . z ; if ( fp != - UNITY_VALUE_NODES ) {".split(" ")},{a:"txt",b:"fj = bG - fo ; fk = length ( fj ) ; fj = normalize ( fj ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_fl"],j:[{a:"txt",b:"fl = fp / ( fp + fk * fk ) ; float fq = fm . x ; float fr = fm . y ; if ( fq > - UNITY_VALUE_NODES ) { float fs = dot ( - fj , fn ) ; fs *= smoothstep ( ZERO_VALUE_NODES , UNITY_VALUE_NODES , ( fs - fq ) / fr ) ; fl *= fs ; }".split(" ")}]}]},
{a:"txt",b:["}","else","{"]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_fj"],j:[{a:"txt",b:["fj","=","fn",";"]}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_fk"],j:[{a:"txt",b:"fk = length ( fo - bG ) ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_fl"],j:[{a:"txt",b:["fl","=","UNITY_VALUE_NODES",";"]}]}]},{a:"txt",b:["}"]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_fj"],j:[{a:"txt",b:"fj . yz = vec2 ( - fj . z , fj . y ) ;".split(" ")}]}]}]},{a:"node",d:"NORMAL",l:[{a:"node_in",d:"ft",
g:["vec3"],f:!1},{a:"node_out",d:"fu",g:["vec3"],f:!0},{a:"node_out",d:"fv",g:["float"],f:!0},{a:"node_param",d:"dQ",g:["vec3"],f:!1}],j:[{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_fu"],j:[{a:"txt",b:["fu","=","dQ",";"]}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_fv"],j:[{a:"txt",b:"fv = - dot ( ft , dQ ) ;".split(" ")}]}]}]},{a:"node",d:"B4W_VECTOR_VIEW",l:[{a:"node_in",d:"fw",g:["vec3"],f:!1},{a:"node_out",d:"fx",g:["vec3"],f:!1}],j:[{a:"txt",b:"fx = - ( d_ * vec4 ( fw , ZERO_VALUE_NODES ) ) . xyz ;".split(" ")}]},
{a:"node",d:"BSDF_ANISOTROPIC",l:[{a:"node_in",d:"fy",g:["vec3"],f:!1},{a:"node_in",d:"fz",g:["float"],f:!1},{a:"node_in",d:"fA",g:["float"],f:!1},{a:"node_in",d:"fB",g:["float"],f:!1},{a:"node_in",d:"fC",g:["vec3"],f:!1},{a:"node_in",d:"fD",g:["vec3"],f:!1},{a:"node_out",d:"fE",g:["vec3"],f:!1}],j:[{a:"txt",b:["fE","=","fy",";"]},{a:"txt",b:"fz ; fA ; fB ; fC ; fD ;".split(" ")}]},{a:"node",d:"BSDF_DIFFUSE",l:[{a:"node_in",d:"fF",g:["vec3"],f:!1},{a:"node_in",d:"fG",g:["float"],f:!1},{a:"node_in",
d:"fH",g:["vec3"],f:!1},{a:"node_out",d:"fI",g:["vec3"],f:!1}],j:[{a:"txt",b:["fI","=","fF",";"]},{a:"txt",b:["fG",";","fH",";"]}]},{a:"node",d:"BSDF_GLASS",l:[{a:"node_in",d:"fJ",g:["vec3"],f:!1},{a:"node_in",d:"fK",g:["float"],f:!1},{a:"node_in",d:"fL",g:["float"],f:!1},{a:"node_in",d:"fM",g:["vec3"],f:!1},{a:"node_out",d:"fN",g:["vec3"],f:!1}],j:[{a:"txt",b:["fN","=","fJ",";"]},{a:"txt",b:"fK ; fL ; fM ;".split(" ")}]},{a:"node",d:"BSDF_GLOSSY",l:[{a:"node_in",d:"fO",g:["vec3"],f:!1},{a:"node_in",
d:"fP",g:["float"],f:!1},{a:"node_in",d:"fQ",g:["vec3"],f:!1},{a:"node_out",d:"fR",g:["vec3"],f:!1}],j:[{a:"txt",b:["fR","=","fO",";"]},{a:"txt",b:["fP",";","fQ",";"]}]},{a:"node",d:"BSDF_HAIR",l:[{a:"node_in",d:"fS",g:["vec3"],f:!1},{a:"node_in",d:"fT",g:["float"],f:!1},{a:"node_in",d:"fU",g:["float"],f:!1},{a:"node_in",d:"fV",g:["float"],f:!1},{a:"node_out",d:"fW",g:["vec3"],f:!1}],j:[{a:"txt",b:["fW","=","fS",";"]},{a:"txt",b:"fT ; fU ; fV ;".split(" ")}]},{a:"node",d:"BSDF_TRANSPARENT",l:[{a:"node_in",
d:"fX",g:["vec3"],f:!1},{a:"node_out",d:"fY",g:["vec3"],f:!1}],j:[{a:"txt",b:["fY","=","fX",";"]}]},{a:"node",d:"BSDF_TRANSLUCENT",l:[{a:"node_in",d:"fZ",g:["vec3"],f:!1},{a:"node_in",d:"f_",g:["vec3"],f:!1},{a:"node_out",d:"gc",g:["vec3"],f:!1}],j:[{a:"txt",b:["gc","=","fZ",";"]},{a:"txt",b:["f_",";"]}]},{a:"node",d:"BSDF_REFRACTION",l:[{a:"node_in",d:"gd",g:["vec3"],f:!1},{a:"node_in",d:"ge",g:["float"],f:!1},{a:"node_in",d:"gf",g:["float"],f:!1},{a:"node_in",d:"gh",g:["vec3"],f:!1},{a:"node_out",
d:"gi",g:["vec3"],f:!1}],j:[{a:"txt",b:"gi [ 0 ] = gi [ 1 ] = gi [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{a:"txt",b:"gd ; ge ; gf ; gh ;".split(" ")}]},{a:"node",d:"BSDF_TOON",l:[{a:"node_in",d:"gj",g:["vec3"],f:!1},{a:"node_in",d:"gk",g:["float"],f:!1},{a:"node_in",d:"gl",g:["float"],f:!1},{a:"node_in",d:"gm",g:["vec3"],f:!1},{a:"node_out",d:"gn",g:["vec3"],f:!1}],j:[{a:"txt",b:["gn","=","gj",";"]},{a:"txt",b:"gk ; gl ; gm ;".split(" ")}]},{a:"node",d:"BSDF_VELVET",l:[{a:"node_in",d:"go",g:["vec3"],
f:!1},{a:"node_in",d:"gp",g:["float"],f:!1},{a:"node_in",d:"gq",g:["vec3"],f:!1},{a:"node_out",d:"gs",g:["vec3"],f:!1}],j:[{a:"txt",b:["gs","=","go",";"]},{a:"txt",b:["gp",";","gq",";"]}]},{a:"node",d:"SUBSURFACE_SCATTERING",l:[{a:"node_in",d:"gt",g:["vec3"],f:!1},{a:"node_in",d:"gu",g:["float"],f:!1},{a:"node_in",d:"gv",g:["vec3"],f:!1},{a:"node_in",d:"gw",g:["float"],f:!1},{a:"node_in",d:"gx",g:["float"],f:!1},{a:"node_in",d:"gy",g:["vec3"],f:!1},{a:"node_out",d:"gz",g:["vec3"],f:!1}],j:[{a:"txt",
b:"gz [ 0 ] = gz [ 1 ] = gz [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{a:"txt",b:"gt ; gv ; gw ; gx ; gy ; gu ;".split(" ")}]},{a:"node",d:"EMISSION",l:[{a:"node_in",d:"gA",g:["vec3"],f:!1},{a:"node_in",d:"gB",g:["float"],f:!1},{a:"node_out",d:"gC",g:["vec3"],f:!1}],j:[{a:"txt",b:["gC","=","gA",";"]},{a:"txt",b:["gB",";"]}]},{a:"node",d:"AMBIENT_OCCLUSION",l:[{a:"node_in",d:"gD",g:["vec3"],f:!1},{a:"node_out",d:"gE",g:["vec3"],f:!1}],j:[{a:"txt",b:"gE [ 0 ] = gE [ 1 ] = gE [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},
{a:"txt",b:["gD",";"]}]},{a:"node",d:"HOLDOUT",l:[{a:"node_out",d:"gF",g:["vec3"],f:!1}],j:[{a:"txt",b:"gF [ 0 ] = gF [ 1 ] = gF [ 2 ] = ZERO_VALUE_NODES ;".split(" ")}]},{a:"node",d:"VOLUME_ABSORPTION",l:[{a:"node_in",d:"gG",g:["vec3"],f:!1},{a:"node_in",d:"gH",g:["float"],f:!1},{a:"node_out",d:"gI",g:["vec3"],f:!1}],j:[{a:"txt",b:"gI [ 0 ] = gI [ 1 ] = gI [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{a:"txt",b:["gG",";","gH",";"]}]},{a:"node",d:"VOLUME_SCATTER",l:[{a:"node_in",d:"gJ",g:["vec3"],f:!1},
{a:"node_in",d:"gK",g:["float"],f:!1},{a:"node_in",d:"gL",g:["float"],f:!1},{a:"node_out",d:"gM",g:["vec3"],f:!1}],j:[{a:"txt",b:"gM [ 0 ] = gM [ 1 ] = gM [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{a:"txt",b:"gJ ; gK ; gL ;".split(" ")}]},{a:"node",d:"BUMP",l:[{a:"node_in",d:"gN",g:["float"],f:!1},{a:"node_in",d:"gO",g:["float"],f:!1},{a:"node_in",d:"gP",g:["float"],f:!1},{a:"node_in",d:"gQ",g:["vec3"],f:!1},{a:"node_out",d:"gR",g:["vec3"],f:!1}],j:[{a:"txt",b:["gR","=","gQ",";"]},{a:"txt",b:"gN ; gO ; gP ;".split(" ")}]},
{a:"node",d:"NORMAL_MAP",l:[{a:"node_in",d:"gS",g:["float"],f:!1},{a:"node_in",d:"gT",g:["vec3"],f:!1},{a:"node_out",d:"gU",g:["vec3"],f:!1}],j:[{a:"txt",b:["vec3","gV","=","ej",";"]},{a:"txt",b:"gV . yz = vec2 ( - gV . z , gV . y ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["SPACE","NM_TANGENT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"gU = em * ( gT . xyz - dz ) ;".split(" ")},{a:"txt",b:"gU . yz = vec2 ( - gU . z , gU . y ) ;".split(" ")}]},{a:"node_elif",e:["SPACE","NM_OBJECT",{a:"equal_expr",
i:2},"SPACE","NM_BLENDER_OBJECT",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"gU = gT . xyz - dz ; gU . yz *= - 1.0 ; gU = ( eb * vec4 ( gU , ZERO_VALUE_NODES ) ) . xyz ;".split(" ")}]},{a:"node_elif",e:["SPACE","NM_WORLD",{a:"equal_expr",i:2},"SPACE","NM_BLENDER_WORLD",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"gU = gT . xyz - dz ; gU . yz *= - 1.0 ;".split(" ")}]}]},{a:"txt",b:"gU = normalize ( mix ( gV , gU , gS ) ) ;".split(" ")}]},{a:"node",d:"VECT_TRANSFORM",
l:[{a:"node_in",d:"gW",g:["vec3"],f:!1},{a:"node_out",d:"gX",g:["vec3"],f:!1}],j:[{a:"node_cond",c:[{a:"node_if",e:["CONVERT_TYPE","VT_WORLD_TO_WORLD",{a:"equal_expr",i:2},"CONVERT_TYPE","VT_OBJECT_TO_OBJECT",{a:"equal_expr",i:2},"CONVERT_TYPE","VT_CAMERA_TO_CAMERA",{a:"equal_expr",i:2},{a:"logical_or_expr",i:3}],j:[{a:"txt",b:["gX","=","gW",";"]}]},{a:"node_else",j:[{a:"node_cond",c:[{a:"node_if",e:["VECTOR_TYPE","VT_POINT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vec4 gY = vec4 ( gW , UNITY_VALUE_NODES ) ;".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"vec4 gY = vec4 ( gW , ZERO_VALUE_NODES ) ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["CONVERT_TYPE","VT_WORLD_TO_CAMERA",{a:"equal_expr",i:2}],j:[{a:"txt",b:"gX = ( d_ * gY ) . xyz ;".split(" ")}]},{a:"node_elif",e:["CONVERT_TYPE","VT_WORLD_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"gX = ( ec * gY ) . xyz ;".split(" ")}]},{a:"node_elif",e:["CONVERT_TYPE","VT_OBJECT_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"gX = ( eb * gY ) . xyz ;".split(" ")}]},{a:"node_elif",
e:["CONVERT_TYPE","VT_OBJECT_TO_CAMERA",{a:"equal_expr",i:2}],j:[{a:"txt",b:"gX = ( d_ * eb * gY ) . xyz ;".split(" ")}]},{a:"node_elif",e:["CONVERT_TYPE","VT_CAMERA_TO_WORLD",{a:"equal_expr",i:2}],j:[{a:"txt",b:"gX = ( ea * gY ) . xyz ;".split(" ")}]},{a:"node_elif",e:["CONVERT_TYPE","VT_CAMERA_TO_OBJECT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"gX = ( ec * ea * gY ) . xyz ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["VECTOR_TYPE","VT_NORMAL",{a:"equal_expr",i:2}],j:[{a:"txt",b:"gX = normalize ( gX ) ;".split(" ")}]}]}]}]}]},
{a:"node",d:"BLACKBODY",l:[{a:"node_in",d:"gZ",g:["float"],f:!1},{a:"node_out",d:"g_",g:["vec3"],f:!1}],j:[{a:"txt",b:"g_ [ 0 ] = g_ [ 1 ] = g_ [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{a:"txt",b:["gZ",";"]}]},{a:"node",d:"WAVELENGTH",l:[{a:"node_in",d:"ha",g:["float"],f:!1},{a:"node_out",d:"hb",g:["vec3"],f:!1}],j:[{a:"txt",b:"hb [ 0 ] = hb [ 1 ] = hb [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{a:"txt",b:["ha",";"]}]},{a:"node",d:"SEPXYZ",l:[{a:"node_in",d:"hc",g:["vec3"],f:!1},{a:"node_out",d:"hd",
g:["float"],f:!1},{a:"node_out",d:"he",g:["float"],f:!1},{a:"node_out",d:"hf",g:["float"],f:!1}],j:[{a:"txt",b:"hd = hc [ 0 ] ; he = hc [ 1 ] ; hf = hc [ 2 ] ;".split(" ")}]},{a:"node",d:"COMBXYZ",l:[{a:"node_in",d:"hg",g:["float"],f:!1},{a:"node_in",d:"hh",g:["float"],f:!1},{a:"node_in",d:"hi",g:["float"],f:!1},{a:"node_out",d:"hj",g:["vec3"],f:!1}],j:[{a:"txt",b:"hj [ 0 ] = hg ; hj [ 1 ] = hh ; hj [ 2 ] = hi ;".split(" ")}]},{a:"node",d:"BRIGHTCONTRAST",l:[{a:"node_in",d:"hk",g:["vec3"],f:!1},{a:"node_in",
d:"hl",g:["float"],f:!1},{a:"node_in",d:"hm",g:["float"],f:!1},{a:"node_out",d:"hn",g:["vec3"],f:!1}],j:[{a:"txt",b:"float b = hl - hm * dz ; hn = max ( ( UNITY_VALUE_NODES + hm ) * hk + b , vec3 ( ZERO_VALUE_NODES ) ) ;".split(" ")}]},{a:"node",d:"LIGHT_FALLOFF",l:[{a:"node_in",d:"ho",g:["float"],f:!1},{a:"node_in",d:"hp",g:["float"],f:!1},{a:"node_out",d:"hq",g:["float"],f:!1},{a:"node_out",d:"hr",g:["float"],f:!1},{a:"node_out",d:"hs",g:["float"],f:!1}],j:[{a:"txt",b:"hq = hr = hs = ZERO_VALUE_NODES ;".split(" ")},
{a:"txt",b:["ho",";","hp",";"]}]},{a:"node",d:"TEX_IMAGE",l:[{a:"node_in",d:"ht",g:["vec3"],f:!1},{a:"node_out",d:"hu",g:["vec3"],f:!1},{a:"node_out",d:"hv",g:["float"],f:!1}],j:[{a:"txt",b:"hu [ 0 ] = hu [ 1 ] = hu [ 2 ] = ZERO_VALUE_NODES ; hv = UNITY_VALUE_NODES ;".split(" ")},{a:"txt",b:["ht",";"]}]},{a:"node",d:"TEX_ENVIRONMENT",l:[{a:"node_in",d:"hw",g:["vec3"],f:!1},{a:"node_out",d:"hx",g:["vec3"],f:!1}],j:[{a:"txt",b:"hx [ 0 ] = hx [ 1 ] = hx [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{a:"txt",
b:["hw",";"]}]},{a:"node",d:"TEX_SKY",l:[{a:"node_in",d:"hy",g:["vec3"],f:!1},{a:"node_out",d:"hz",g:["vec3"],f:!1}],j:[{a:"txt",b:"hz [ 0 ] = hz [ 1 ] = hz [ 2 ] = ZERO_VALUE_NODES ;".split(" ")},{a:"txt",b:["hy",";"]}]},{a:"node",d:"TEX_NOISE",l:[{a:"node_in",d:"hA",g:["vec3"],f:!1},{a:"node_in",d:"hB",g:["float"],f:!1},{a:"node_in",d:"hC",g:["float"],f:!1},{a:"node_in",d:"hD",g:["float"],f:!1},{a:"node_out",d:"hE",g:["vec3"],f:!1},{a:"node_out",d:"hF",g:["float"],f:!1}],j:[{a:"txt",b:"hE [ 0 ] = hE [ 1 ] = hE [ 2 ] = ZERO_VALUE_NODES ; hF = UNITY_VALUE_NODES ;".split(" ")},
{a:"txt",b:"hA ; hB ; hC ; hD ;".split(" ")}]},{a:"node",d:"TEX_WAVE",l:[{a:"node_in",d:"hG",g:["vec3"],f:!1},{a:"node_in",d:"hH",g:["float"],f:!1},{a:"node_in",d:"hI",g:["float"],f:!1},{a:"node_in",d:"hJ",g:["float"],f:!1},{a:"node_in",d:"hK",g:["float"],f:!1},{a:"node_out",d:"hL",g:["vec3"],f:!1},{a:"node_out",d:"hM",g:["float"],f:!1}],j:[{a:"txt",b:"hL [ 0 ] = hL [ 1 ] = hL [ 2 ] = ZERO_VALUE_NODES ; hM = UNITY_VALUE_NODES ;".split(" ")},{a:"txt",b:"hG ; hH ; hI ; hJ ; hK ;".split(" ")}]},{a:"node",
d:"TEX_VORONOI",l:[{a:"node_in",d:"hN",g:["vec3"],f:!1},{a:"node_in",d:"hO",g:["float"],f:!1},{a:"node_out",d:"hP",g:["vec3"],f:!1},{a:"node_out",d:"hQ",g:["float"],f:!1}],j:[{a:"txt",b:"hP [ 0 ] = hP [ 1 ] = hP [ 2 ] = ZERO_VALUE_NODES ; hQ = UNITY_VALUE_NODES ;".split(" ")},{a:"txt",b:["hN",";","hO",";"]}]},{a:"node",d:"TEX_MUSGRAVE",l:[{a:"node_in",d:"hR",g:["vec3"],f:!1},{a:"node_in",d:"hS",g:["float"],f:!1},{a:"node_in",d:"hT",g:["float"],f:!1},{a:"node_in",d:"hU",g:["float"],f:!1},{a:"node_in",
d:"hV",g:["float"],f:!1},{a:"node_in",d:"hW",g:["float"],f:!1},{a:"node_in",d:"hX",g:["float"],f:!1},{a:"node_out",d:"hY",g:["vec3"],f:!1},{a:"node_out",d:"hZ",g:["float"],f:!1}],j:[{a:"txt",b:"hY [ 0 ] = hY [ 1 ] = hY [ 2 ] = ZERO_VALUE_NODES ; hZ = UNITY_VALUE_NODES ;".split(" ")},{a:"txt",b:"hR ; hS ; hT ; hU ; hV ; hW ; hX ;".split(" ")}]},{a:"node",d:"TEX_GRADIENT",l:[{a:"node_in",d:"h_",g:["vec3"],f:!1},{a:"node_out",d:"ia",g:["vec3"],f:!1},{a:"node_out",d:"ib",g:["float"],f:!1}],j:[{a:"txt",
b:"ia [ 0 ] = ia [ 1 ] = ia [ 2 ] = ZERO_VALUE_NODES ; ib = UNITY_VALUE_NODES ;".split(" ")},{a:"txt",b:["h_",";"]}]},{a:"node",d:"TEX_MAGIC",l:[{a:"node_in",d:"ic",g:["vec3"],f:!1},{a:"node_in",d:"id",g:["float"],f:!1},{a:"node_in",d:"ie",g:["float"],f:!1},{a:"node_out",d:"ig",g:["vec3"],f:!1},{a:"node_out",d:"ih",g:["float"],f:!1}],j:[{a:"txt",b:"ig [ 0 ] = ig [ 1 ] = ig [ 2 ] = ZERO_VALUE_NODES ; ih = UNITY_VALUE_NODES ;".split(" ")},{a:"txt",b:"ic ; id ; ie ;".split(" ")}]},{a:"node",d:"TEX_CHECKER",
l:[{a:"node_in",d:"ii",g:["vec3"],f:!1},{a:"node_in",d:"ij",g:["vec3"],f:!1},{a:"node_in",d:"ik",g:["vec3"],f:!1},{a:"node_in",d:"il",g:["float"],f:!1},{a:"node_out",d:"im",g:["vec3"],f:!1},{a:"node_out",d:"io",g:["float"],f:!1}],j:[{a:"txt",b:"im [ 0 ] = im [ 1 ] = im [ 2 ] = ZERO_VALUE_NODES ; io = UNITY_VALUE_NODES ;".split(" ")},{a:"txt",b:"ii ; ij ; ik ; il ;".split(" ")}]},{a:"node",d:"TEX_BRICK",l:[{a:"node_in",d:"ip",g:["vec3"],f:!1},{a:"node_in",d:"iq",g:["vec3"],f:!1},{a:"node_in",d:"ir",
g:["vec3"],f:!1},{a:"node_in",d:"is",g:["vec3"],f:!1},{a:"node_in",d:"it",g:["float"],f:!1},{a:"node_in",d:"iu",g:["float"],f:!1},{a:"node_in",d:"iv",g:["float"],f:!1},{a:"node_in",d:"iw",g:["float"],f:!1},{a:"node_in",d:"ix",g:["float"],f:!1},{a:"node_out",d:"iy",g:["vec3"],f:!1},{a:"node_out",d:"iz",g:["float"],f:!1}],j:[{a:"txt",b:"iy [ 0 ] = iy [ 1 ] = iy [ 2 ] = ZERO_VALUE_NODES ; iz = UNITY_VALUE_NODES ;".split(" ")},{a:"txt",b:"ip ; iq ; ir ; is ; it ; iu ; iv ; iw ; ix ;".split(" ")}]},{a:"node",
d:"ADD_SHADER",l:[{a:"node_in",d:"iA",g:["vec3"],f:!1},{a:"node_in",d:"iB",g:["vec3"],f:!1},{a:"node_out",d:"iC",g:["vec3"],f:!1}],j:[{a:"txt",b:"iC = clamp ( iA + iB , vec3 ( ZERO_VALUE_NODES ) , vec3 ( UNITY_VALUE_NODES ) ) ;".split(" ")}]},{a:"node",d:"MIX_SHADER",l:[{a:"node_in",d:"iD",g:["float"],f:!1},{a:"node_in",d:"iE",g:["vec3"],f:!1},{a:"node_in",d:"iF",g:["vec3"],f:!1},{a:"node_out",d:"iG",g:["vec3"],f:!1}],j:[{a:"txt",b:"float iH = clamp ( iD , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; iG = iH * iE + ( UNITY_VALUE_NODES - iH ) * iF ;".split(" ")}]},
{a:"node",d:"UV_MERGED",l:[{a:"node_out",d:"iI",g:["vec3"],f:!1},{a:"node_out",d:"iJ",g:["vec3"],f:!1}],j:[{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_iI"],j:[{a:"txt",b:"iI = dJ ( bQ ) ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_iJ"],j:[{a:"txt",b:"iJ = vec3 ( bQ , ZERO_VALUE_NODES ) ;".split(" ")}]}]}]},{a:"node",d:"TEX_COORD_UV",l:[{a:"node_out",d:"iK",g:["vec3"],f:!1}],j:[{a:"txt",b:"iK = vec3 ( bQ , ZERO_VALUE_NODES ) ;".split(" ")}]},{a:"node",d:"TEX_COORD_NO",l:[{a:"node_out",
d:"iL",g:["vec3"],f:!1}],j:[{a:"txt",b:["iL","=","ej",";"]}]},{a:"node",d:"TEX_COORD_GE",l:[{a:"node_out",d:"iM",g:["vec3"],f:!1}],j:[{a:"txt",b:"iM = vec3 ( bQ , ZERO_VALUE_NODES ) ;".split(" ")}]},{a:"node",d:"TEX_COORD_OB",l:[{a:"node_out",d:"iN",g:["vec3"],f:!1}],j:[{a:"txt",b:"iN [ 0 ] = iN [ 1 ] = iN [ 2 ] = UNITY_VALUE_NODES ;".split(" ")}]},{a:"node",d:"TEX_COORD_CA",l:[{a:"node_out",d:"iO",g:["vec3"],f:!1}],j:[{a:"txt",b:"iO [ 0 ] = eo [ 0 ] ; iO [ 1 ] = eo [ 1 ] ; iO [ 2 ] = UNITY_VALUE_NODES ;".split(" ")}]},
{a:"node",d:"TEX_COORD_WI",l:[{a:"node_out",d:"iP",g:["vec3"],f:!1}],j:[{a:"txt",b:"iP [ 0 ] = iP [ 1 ] = iP [ 2 ] = UNITY_VALUE_NODES ;".split(" ")}]},{a:"node",d:"TEX_COORD_RE",l:[{a:"node_out",d:"iQ",g:["vec3"],f:!1}],j:[{a:"txt",b:"iQ [ 0 ] = iQ [ 1 ] = iQ [ 2 ] = UNITY_VALUE_NODES ;".split(" ")}]},{a:"node",d:"UVMAP",l:[{a:"node_out",d:"iR",g:["vec3"],f:!1}],j:[{a:"txt",b:"iR = vec3 ( bQ , ZERO_VALUE_NODES ) ;".split(" ")}]},{a:"node",d:"PARTICLE_INFO",l:[{a:"node_out",d:"iS",g:["float"],f:!1},
{a:"node_out",d:"iT",g:["float"],f:!1},{a:"node_out",d:"iU",g:["float"],f:!1},{a:"node_out",d:"iV",g:["vec3"],f:!1},{a:"node_out",d:"iW",g:["float"],f:!1},{a:"node_out",d:"iX",g:["vec3"],f:!1},{a:"node_out",d:"iY",g:["vec3"],f:!1},{a:"node_param",d:"wL",g:["GLSL_IN","vec4"],f:!0},{a:"node_param",d:"wM",g:["GLSL_IN","vec3"],f:!0},{a:"node_param",d:"wN",g:["GLSL_IN","vec3"],f:!0},{a:"node_param",d:"wO",g:["GLSL_IN","vec3"],f:!0}],j:[{a:"node_cond",c:[{a:"node_if",e:["PARTICLE_BATCH"],j:[{a:"node_cond",
c:[{a:"node_if",e:["USE_OUT_iS"],j:[{a:"txt",b:"iS = wL [ 0 ] ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_iT"],j:[{a:"txt",b:"iT = wL [ 1 ] ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_iU"],j:[{a:"txt",b:"iU = wL [ 2 ] ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_iV"],j:[{a:"txt",b:"iV = vec3 ( wM . r , - wM . b , wM . g ) ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_iW"],j:[{a:"txt",b:"iW = wL [ 3 ] ;".split(" ")}]}]},{a:"node_cond",
c:[{a:"node_if",e:["USE_OUT_iX"],j:[{a:"txt",b:"iX = vec3 ( wN . r , - wN . b , wN . g ) ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_iY"],j:[{a:"txt",b:"iY = vec3 ( wO . r , - wO . b , wO . g ) ;".split(" ")}]}]}]},{a:"node_else",j:[{a:"txt",b:"iS = ZERO_VALUE_NODES ; iT = ZERO_VALUE_NODES ; iU = ZERO_VALUE_NODES ; iV = vec3 ( ZERO_VALUE_NODES ) ; iW = ZERO_VALUE_NODES ; iX = iV ; iY = iV ;".split(" ")}]}]}]},{a:"node",d:"HAIR_INFO",l:[{a:"node_out",d:"iZ",g:["float"],f:!1},{a:"node_out",
d:"i_",g:["float"],f:!1},{a:"node_out",d:"ja",g:["float"],f:!1},{a:"node_out",d:"jb",g:["vec3"],f:!1}],j:[{a:"txt",b:"iZ = ZERO_VALUE_NODES ; i_ = ZERO_VALUE_NODES ; ja = ZERO_VALUE_NODES ; jb = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},{a:"node",d:"OBJECT_INFO",l:[{a:"node_out",d:"jc",g:["vec3"],f:!1},{a:"node_out",d:"jd",g:["float"],f:!1},{a:"node_out",d:"je",g:["float"],f:!1},{a:"node_out",d:"jf",g:["float"],f:!1}],j:[{a:"txt",b:"jd = ZERO_VALUE_NODES ; je = ZERO_VALUE_NODES ; jf = ZERO_VALUE_NODES ; jc = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},
{a:"node",d:"WIREFRAME",l:[{a:"node_in",d:"jg",g:["float"],f:!1},{a:"node_out",d:"jh",g:["float"],f:!1}],j:[{a:"txt",b:["jh","=","jg",";"]}]},{a:"node",d:"TANGENT",l:[{a:"node_out",d:"ji",g:["vec3"],f:!1}],j:[{a:"txt",b:"ji = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},{a:"node",d:"LAYER_WEIGHT",l:[{a:"node_in",d:"jj",g:["float"],f:!1},{a:"node_in",d:"jk",g:["vec3"],f:!1},{a:"node_out",d:"jl",g:["float"],f:!1},{a:"node_out",d:"jm",g:["float"],f:!1}],j:[{a:"txt",b:"jl = jm = ZERO_VALUE_NODES ;".split(" ")},
{a:"txt",b:["jk",";","jj",";"]}]},{a:"node",d:"LIGHT_PATH",l:[{a:"node_out",d:"jn",g:["float"],f:!1},{a:"node_out",d:"jo",g:["float"],f:!1},{a:"node_out",d:"jp",g:["float"],f:!1},{a:"node_out",d:"jq",g:["float"],f:!1},{a:"node_out",d:"jr",g:["float"],f:!1},{a:"node_out",d:"js",g:["float"],f:!1},{a:"node_out",d:"jt",g:["float"],f:!1},{a:"node_out",d:"ju",g:["float"],f:!1},{a:"node_out",d:"jv",g:["float"],f:!1},{a:"node_out",d:"jw",g:["float"],f:!1}],j:[{a:"txt",b:"jn = jo = jp = ZERO_VALUE_NODES ; jq = jr = js = ZERO_VALUE_NODES ; jt = jt = jv = jw = ZERO_VALUE_NODES ; ju = ZERO_VALUE_NODES ;".split(" ")}]},
{a:"node",d:"ATTRIBUTE",l:[{a:"node_out",d:"jx",g:["vec3"],f:!1},{a:"node_out",d:"jy",g:["vec3"],f:!1},{a:"node_out",d:"jz",g:["float"],f:!1}],j:[{a:"txt",b:"jx = jy = vec3 ( ZERO_VALUE_NODES ) ; jz = ZERO_VALUE_NODES ;".split(" ")}]},{a:"node",d:"SCRIPT",l:[],j:[]},{a:"node",d:"CURVE_VEC",l:[{a:"node_in",d:"jA",g:["float"],f:!1},{a:"node_in",d:"jB",g:["vec3"],f:!1},{a:"node_out",d:"jC",g:["vec3"],f:!1}],j:[{a:"txt",b:["jC","=","jB",";"]},{a:"node_cond",c:[{a:"node_if",e:["READ_R"],j:[{a:"txt",b:"jC . r = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( 0.5 * jB . r + 0.5 , NODE_TEX_ROW ) ) . r - 0.5 ) * 2.0 ;".split(" ")}]}]},
{a:"node_cond",c:[{a:"node_if",e:["READ_G"],j:[{a:"txt",b:"jC . g = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( 0.5 * jB . g + 0.5 , NODE_TEX_ROW ) ) . g - 0.5 ) * 2.0 ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["READ_B"],j:[{a:"txt",b:"jC . b = ( GLSL_TEXTURE ( u_nodes_texture , vec2 ( 0.5 * jB . b + 0.5 , NODE_TEX_ROW ) ) . b - 0.5 ) * 2.0 ;".split(" ")}]}]},{a:"txt",b:"jC = mix ( jB , jC , jA ) ;".split(" ")}]},{a:"node",d:"CURVE_RGB",l:[{a:"node_in",d:"jD",g:["float"],f:!1},{a:"node_in",
d:"jE",g:["vec3"],f:!1},{a:"node_out",d:"jF",g:["vec3"],f:!1}],j:[{a:"node_cond",c:[{a:"node_if",e:["READ_A"],j:[{a:"txt",b:"float r = GLSL_TEXTURE ( u_nodes_texture , vec2 ( jE . r , NODE_TEX_ROW ) ) . a ; float g = GLSL_TEXTURE ( u_nodes_texture , vec2 ( jE . g , NODE_TEX_ROW ) ) . a ; float b = GLSL_TEXTURE ( u_nodes_texture , vec2 ( jE . b , NODE_TEX_ROW ) ) . a ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float r = jE . r ; float g = jE . g ; float b = jE . b ;".split(" ")}]}]},{a:"node_cond",
c:[{a:"node_if",e:["READ_R"],j:[{a:"txt",b:"jF . r = GLSL_TEXTURE ( u_nodes_texture , vec2 ( r , NODE_TEX_ROW ) ) . r ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"jF . r = r ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["READ_G"],j:[{a:"txt",b:"jF . g = GLSL_TEXTURE ( u_nodes_texture , vec2 ( g , NODE_TEX_ROW ) ) . g ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"jF . g = g ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["READ_B"],j:[{a:"txt",b:"jF . b = GLSL_TEXTURE ( u_nodes_texture , vec2 ( b , NODE_TEX_ROW ) ) . b ;".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"jF . b = b ;".split(" ")}]}]},{a:"txt",b:"jF = mix ( jE , jF , jD ) ;".split(" ")}]},{a:"node",d:"VALTORGB",l:[{a:"node_in",d:"jG",g:["float"],f:!1},{a:"node_out",d:"jH",g:["vec3"],f:!1},{a:"node_out",d:"jI",g:["float"],f:!1}],j:[{a:"txt",b:"vec4 jJ = GLSL_TEXTURE ( u_nodes_texture , vec2 ( jG , NODE_TEX_ROW ) ) ; jH = jJ . rgb ; jI = jJ . a ;".split(" ")}]},{a:"node",d:"MAPPING",l:[{a:"node_in",d:"jK",g:["vec3"],f:!1},{a:"node_out",d:"jL",g:["vec3"],f:!1}],j:[{a:"txt",
b:["jL","=","jK",";"]},{a:"node_cond",c:[{a:"node_ifdef",d:"MAPPING_TRS_MATRIX",j:[{a:"txt",b:"jL = ( MAPPING_TRS_MATRIX * vec4 ( jL , UNITY_VALUE_NODES ) ) . xyz ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_ifdef",d:"MAPPING_SCALE",j:[{a:"txt",b:"jL = jL * MAPPING_SCALE ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_ifdef",d:"MAPPING_TRANSLATION",j:[{a:"txt",b:"jL = jL + MAPPING_TRANSLATION ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_ifdef",d:"MAPPING_MIN_CLIP",j:[{a:"txt",b:"jL = max ( jL , MAPPING_MIN_CLIP ) ;".split(" ")}]}]},
{a:"node_cond",c:[{a:"node_ifdef",d:"MAPPING_MAX_CLIP",j:[{a:"txt",b:"jL = min ( jL , MAPPING_MAX_CLIP ) ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["MAPPING_IS_NORMAL"],j:[{a:"txt",b:"jL = normalize ( jL ) ;".split(" ")}]}]}]},{a:"node",d:"MATH_ADD",l:[{a:"node_in",d:"jM",g:["float"],f:!1},{a:"node_in",d:"jN",g:["float"],f:!1},{a:"node_out",d:"jO",g:["float"],f:!1}],j:[{a:"txt",b:"jO = jM + jN ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"jO = clamp ( jO , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{a:"node",d:"MATH_SUBTRACT",l:[{a:"node_in",d:"jP",g:["float"],f:!1},{a:"node_in",d:"jQ",g:["float"],f:!1},{a:"node_out",d:"jR",g:["float"],f:!1}],j:[{a:"txt",b:"jR = jP - jQ ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"jR = clamp ( jR , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{a:"node",d:"MATH_MULTIPLY",l:[{a:"node_in",d:"jS",g:["float"],f:!1},{a:"node_in",d:"jT",g:["float"],f:!1},{a:"node_out",d:"jU",g:["float"],f:!1}],j:[{a:"txt",b:"jU = jS * jT ;".split(" ")},
{a:"node_cond",c:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"jU = clamp ( jU , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{a:"node",d:"MATH_DIVIDE",l:[{a:"node_in",d:"jV",g:["float"],f:!1},{a:"node_in",d:"jW",g:["float"],f:!1},{a:"node_out",d:"jX",g:["float"],f:!1}],j:[{a:"txt",b:"jX = ( jW != ZERO_VALUE_NODES ) ? jV / jW : ZERO_VALUE_NODES ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"jX = clamp ( jX , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{a:"node",d:"MATH_SINE",l:[{a:"node_in",d:"jY",g:["float"],f:!1},{a:"node_in",d:"jZ",g:["float"],f:!1},{a:"node_out",d:"j_",g:["float"],f:!1}],j:[{a:"txt",b:"j_ = sin ( jY ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"j_ = clamp ( j_ , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{a:"txt",b:["jZ",";"]}]},{a:"node",d:"MATH_COSINE",l:[{a:"node_in",d:"ka",g:["float"],f:!1},{a:"node_in",d:"kb",g:["float"],f:!1},{a:"node_out",d:"kc",g:["float"],f:!1}],
j:[{a:"txt",b:"kc = cos ( ka ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"kc = clamp ( kc , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{a:"txt",b:["kb",";"]}]},{a:"node",d:"MATH_TANGENT",l:[{a:"node_in",d:"kd",g:["float"],f:!1},{a:"node_in",d:"ke",g:["float"],f:!1},{a:"node_out",d:"kf",g:["float"],f:!1}],j:[{a:"txt",b:"kf = tan ( kd ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"kf = clamp ( kf , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},
{a:"txt",b:["ke",";"]}]},{a:"node",d:"MATH_ARCSINE",l:[{a:"node_in",d:"kg",g:["float"],f:!1},{a:"node_in",d:"kh",g:["float"],f:!1},{a:"node_out",d:"ki",g:["float"],f:!1}],j:[{a:"txt",b:"ki = ( kg <= UNITY_VALUE_NODES && kg >= - UNITY_VALUE_NODES ) ? asin ( kg ) : ZERO_VALUE_NODES ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"ki = clamp ( ki , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{a:"txt",b:["kh",";"]}]},{a:"node",d:"MATH_ARCCOSINE",l:[{a:"node_in",
d:"kj",g:["float"],f:!1},{a:"node_in",d:"kk",g:["float"],f:!1},{a:"node_out",d:"kl",g:["float"],f:!1}],j:[{a:"txt",b:"kl = ( kj <= UNITY_VALUE_NODES && kj >= - UNITY_VALUE_NODES ) ? acos ( kj ) : ZERO_VALUE_NODES ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"kl = clamp ( kl , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{a:"txt",b:["kk",";"]}]},{a:"node",d:"MATH_ARCTANGENT",l:[{a:"node_in",d:"km",g:["float"],f:!1},{a:"node_in",d:"kn",g:["float"],f:!1},
{a:"node_out",d:"ko",g:["float"],f:!1}],j:[{a:"txt",b:"ko = atan ( km ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"ko = clamp ( ko , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{a:"txt",b:["kn",";"]}]},{a:"node",d:"MATH_POWER",l:[{a:"node_in",d:"kp",g:["float"],f:!1},{a:"node_in",d:"kq",g:["float"],f:!1},{a:"node_out",d:"kr",g:["float"],f:!1}],j:[{a:"txt",b:"if ( kp < ZERO_VALUE_NODES && kq != floor ( kq ) ) kr = ZERO_VALUE_NODES ; else if ( kq == ZERO_VALUE_NODES )".split(" ")},
{a:"txt",b:"kr = UNITY_VALUE_NODES ; else if ( kp < ZERO_VALUE_NODES ) kr = mix ( UNITY_VALUE_NODES , - UNITY_VALUE_NODES , sign ( mod ( - kq , 2.0 ) ) ) * pow ( - kp , kq ) ; else if ( kp == ZERO_VALUE_NODES ) kr = ZERO_VALUE_NODES ; else kr = pow ( kp , kq ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"kr = clamp ( kr , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{a:"node",d:"MATH_LOGARITHM",l:[{a:"node_in",d:"ks",g:["float"],f:!1},{a:"node_in",
d:"kt",g:["float"],f:!1},{a:"node_out",d:"ku",g:["float"],f:!1}],j:[{a:"txt",b:"ku = ( ks > ZERO_VALUE_NODES && kt > ZERO_VALUE_NODES ) ? log2 ( ks ) / log2 ( kt ) : ZERO_VALUE_NODES ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"ku = clamp ( ku , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{a:"node",d:"MATH_MINIMUM",l:[{a:"node_in",d:"kv",g:["float"],f:!1},{a:"node_in",d:"kw",g:["float"],f:!1},{a:"node_out",d:"kx",g:["float"],f:!1}],j:[{a:"txt",
b:"kx = min ( kv , kw ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"kx = clamp ( kx , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{a:"node",d:"MATH_MAXIMUM",l:[{a:"node_in",d:"ky",g:["float"],f:!1},{a:"node_in",d:"kz",g:["float"],f:!1},{a:"node_out",d:"kA",g:["float"],f:!1}],j:[{a:"txt",b:"kA = max ( ky , kz ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"kA = clamp ( kA , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{a:"node",d:"MATH_ROUND",l:[{a:"node_in",d:"kB",g:["float"],f:!1},{a:"node_in",d:"kC",g:["float"],f:!1},{a:"node_out",d:"kD",g:["float"],f:!1}],j:[{a:"txt",b:"kD = floor ( kB + dz ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"kD = clamp ( kD , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{a:"txt",b:["kC",";"]}]},{a:"node",d:"MATH_LESS_THAN",l:[{a:"node_in",d:"kE",g:["float"],f:!1},{a:"node_in",d:"kF",g:["float"],f:!1},{a:"node_out",d:"kG",g:["float"],
f:!1}],j:[{a:"txt",b:"kG = ( kE < kF ) ? UNITY_VALUE_NODES : ZERO_VALUE_NODES ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"kG = clamp ( kG , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{a:"node",d:"MATH_GREATER_THAN",l:[{a:"node_in",d:"kH",g:["float"],f:!1},{a:"node_in",d:"kI",g:["float"],f:!1},{a:"node_out",d:"kJ",g:["float"],f:!1}],j:[{a:"txt",b:"kJ = ( kH > kI ) ? UNITY_VALUE_NODES : ZERO_VALUE_NODES ;".split(" ")},{a:"node_cond",c:[{a:"node_if",
e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"kJ = clamp ( kJ , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{a:"node",d:"MATH_MODULO",l:[{a:"node_in",d:"kK",g:["float"],f:!1},{a:"node_in",d:"kL",g:["float"],f:!1},{a:"node_out",d:"kM",g:["float"],f:!1}],j:[{a:"txt",b:"kM = abs ( kL ) > 0.000001 ? mod ( kK , kL ) : ZERO_VALUE_NODES ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"kM = clamp ( kM , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{a:"node",
d:"MATH_ABSOLUTE",l:[{a:"node_in",d:"kN",g:["float"],f:!1},{a:"node_in",d:"kO",g:["float"],f:!1},{a:"node_out",d:"kP",g:["float"],f:!1}],j:[{a:"txt",b:"kP = abs ( kN ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["MATH_USE_CLAMP"],j:[{a:"txt",b:"kP = clamp ( kP , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]},{a:"txt",b:["kO",";"]}]},{a:"node",d:"MIX_RGB_MIX",l:[{a:"node_in",d:"kQ",g:["float"],f:!1},{a:"node_in",d:"kR",g:["vec3"],f:!1},{a:"node_in",d:"kS",g:["vec3"],f:!1},{a:"node_out",
d:"kT",g:["vec3"],f:!1}],j:[{a:"txt",b:"float iH = clamp ( kQ , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; kT = mix ( kR , kS , iH ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"kT = clamp ( kT , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{a:"node",d:"MIX_RGB_ADD",l:[{a:"node_in",d:"kU",g:["float"],f:!1},{a:"node_in",d:"kV",g:["vec3"],f:!1},{a:"node_in",d:"kW",g:["vec3"],f:!1},{a:"node_out",d:"kX",g:["vec3"],f:!1}],j:[{a:"txt",b:"float iH = clamp ( kU , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; kX = mix ( kV , kV + kW , iH ) ;".split(" ")},
{a:"node_cond",c:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"kX = clamp ( kX , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{a:"node",d:"MIX_RGB_MULTIPLY",l:[{a:"node_in",d:"kY",g:["float"],f:!1},{a:"node_in",d:"kZ",g:["vec3"],f:!1},{a:"node_in",d:"k_",g:["vec3"],f:!1},{a:"node_out",d:"la",g:["vec3"],f:!1}],j:[{a:"txt",b:"float iH = clamp ( kY , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; la = mix ( kZ , kZ * k_ , iH ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],
j:[{a:"txt",b:"la = clamp ( la , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{a:"node",d:"MIX_RGB_SUBTRACT",l:[{a:"node_in",d:"lb",g:["float"],f:!1},{a:"node_in",d:"lc",g:["vec3"],f:!1},{a:"node_in",d:"ld",g:["vec3"],f:!1},{a:"node_out",d:"le",g:["vec3"],f:!1}],j:[{a:"txt",b:"float iH = clamp ( lb , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; le = mix ( lc , lc - ld , iH ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"le = clamp ( le , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{a:"node",d:"MIX_RGB_SCREEN",l:[{a:"node_in",d:"lf",g:["float"],f:!1},{a:"node_in",d:"lg",g:["vec3"],f:!1},{a:"node_in",d:"lh",g:["vec3"],f:!1},{a:"node_out",d:"li",g:["vec3"],f:!1}],j:[{a:"txt",b:"float iH = clamp ( lf , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; float lj = UNITY_VALUE_NODES - iH ; li = vec3 ( UNITY_VALUE_NODES ) - ( vec3 ( lj ) + iH * ( vec3 ( UNITY_VALUE_NODES ) - lh ) ) * ( vec3 ( UNITY_VALUE_NODES ) - lg ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",
b:"li = clamp ( li , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{a:"node",d:"MIX_RGB_DIVIDE",l:[{a:"node_in",d:"lk",g:["float"],f:!1},{a:"node_in",d:"ll",g:["vec3"],f:!1},{a:"node_in",d:"lm",g:["vec3"],f:!1},{a:"node_out",d:"ln",g:["vec3"],f:!1}],j:[{a:"txt",b:"float iH = clamp ( lk , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; float lj = UNITY_VALUE_NODES - iH ; lm += step ( lm , vec3 ( ZERO_VALUE_NODES ) ) ; ln = lj * ll + iH * ll / lm ;".split(" ")},{a:"node_cond",c:[{a:"node_if",
e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"ln = clamp ( ln , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{a:"node",d:"MIX_RGB_DIFFERENCE",l:[{a:"node_in",d:"lo",g:["float"],f:!1},{a:"node_in",d:"lp",g:["vec3"],f:!1},{a:"node_in",d:"lq",g:["vec3"],f:!1},{a:"node_out",d:"lr",g:["vec3"],f:!1}],j:[{a:"txt",b:"float iH = clamp ( lo , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; lr = mix ( lp , abs ( lp - lq ) , iH ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",
b:"lr = clamp ( lr , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{a:"node",d:"MIX_RGB_DARKEN",l:[{a:"node_in",d:"ls",g:["float"],f:!1},{a:"node_in",d:"lt",g:["vec3"],f:!1},{a:"node_in",d:"lu",g:["vec3"],f:!1},{a:"node_out",d:"lv",g:["vec3"],f:!1}],j:[{a:"txt",b:"float iH = clamp ( ls , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; lv = min ( lt . rgb , lu . rgb * iH ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"lv = clamp ( lv , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{a:"node",d:"MIX_RGB_LIGHTEN",l:[{a:"node_in",d:"lw",g:["float"],f:!1},{a:"node_in",d:"lx",g:["vec3"],f:!1},{a:"node_in",d:"ly",g:["vec3"],f:!1},{a:"node_out",d:"lz",g:["vec3"],f:!1}],j:[{a:"txt",b:"float iH = clamp ( lw , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; lz = max ( lx . rgb , ly . rgb * iH ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"lz = clamp ( lz , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{a:"node",d:"MIX_RGB_OVERLAY",l:[{a:"node_in",
d:"lA",g:["float"],f:!1},{a:"node_in",d:"lB",g:["vec3"],f:!1},{a:"node_in",d:"lC",g:["vec3"],f:!1},{a:"node_out",d:"lD",g:["vec3"],f:!1}],j:[{a:"txt",b:"float iH = clamp ( lA , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; vec3 lE = vec3 ( UNITY_VALUE_NODES - iH ) ; lD = mix ( lB * ( lE + 2.0 * iH * lC ) , vec3 ( UNITY_VALUE_NODES ) - ( lE + 2.0 * iH * ( vec3 ( UNITY_VALUE_NODES ) - lC ) ) * ( vec3 ( UNITY_VALUE_NODES ) - lB ) , step ( dz , lB ) ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],
j:[{a:"txt",b:"lD = clamp ( lD , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{a:"node",d:"MIX_RGB_DODGE",l:[{a:"node_in",d:"lF",g:["float"],f:!1},{a:"node_in",d:"lG",g:["vec3"],f:!1},{a:"node_in",d:"lH",g:["vec3"],f:!1},{a:"node_out",d:"lI",g:["vec3"],f:!1}],j:[{a:"txt",b:"float iH = clamp ( lF , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; vec3 lJ = vec3 ( UNITY_VALUE_NODES ) - iH * lH ; vec3 lK = clamp ( lG / lJ , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; lI = mix ( mix ( lK , vec3 ( UNITY_VALUE_NODES ) , step ( lJ , vec3 ( ZERO_VALUE_NODES ) ) ) , lG , step ( lG , vec3 ( ZERO_VALUE_NODES ) ) ) ;".split(" ")},
{a:"node_cond",c:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"lI = clamp ( lI , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{a:"node",d:"MIX_RGB_BURN",l:[{a:"node_in",d:"lL",g:["float"],f:!1},{a:"node_in",d:"lM",g:["vec3"],f:!1},{a:"node_in",d:"lN",g:["vec3"],f:!1},{a:"node_out",d:"lO",g:["vec3"],f:!1}],j:[{a:"txt",b:"float iH = clamp ( lL , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; vec3 lP = vec3 ( UNITY_VALUE_NODES - iH ) ; vec3 lJ = lP + iH * lN ; vec3 lK = clamp ( vec3 ( UNITY_VALUE_NODES ) - ( vec3 ( UNITY_VALUE_NODES ) - lM ) / lJ , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; lO = mix ( lK , vec3 ( ZERO_VALUE_NODES ) , step ( lJ , vec3 ( ZERO_VALUE_NODES ) ) ) ;".split(" ")},
{a:"node_cond",c:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"lO = clamp ( lO , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{a:"node",d:"MIX_RGB_HUE",l:[{a:"node_in",d:"lQ",g:["float"],f:!1},{a:"node_in",d:"lR",g:["vec3"],f:!1},{a:"node_in",d:"lS",g:["vec3"],f:!1},{a:"node_out",d:"lT",g:["vec3"],f:!1}],j:[{a:"txt",b:"float iH = clamp ( lQ , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; vec3 dG , lU , lJ ; lT = lR ; lU = dF ( lS ) ; if ( lU . y != ZERO_VALUE_NODES ) { dG = dF ( lT ) ; dG . x = lU . x ; lJ = dH ( dG ) ; lT = mix ( lT , lJ , iH ) ; }".split(" ")},
{a:"node_cond",c:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"lT = clamp ( lT , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{a:"node",d:"MIX_RGB_SATURATION",l:[{a:"node_in",d:"lV",g:["float"],f:!1},{a:"node_in",d:"lW",g:["vec3"],f:!1},{a:"node_in",d:"lX",g:["vec3"],f:!1},{a:"node_out",d:"lY",g:["vec3"],f:!1}],j:[{a:"txt",b:"float iH = clamp ( lV , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; float lj = UNITY_VALUE_NODES - iH ; lY = lW ; vec3 dG , lU ; dG = dF ( lY ) ; if ( dG . y != ZERO_VALUE_NODES ) { lU = dF ( lX ) ; dG . y = lj * dG . y + iH * lU . y ; lY = dH ( dG ) ; }".split(" ")},
{a:"node_cond",c:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"lY = clamp ( lY , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{a:"node",d:"MIX_RGB_VALUE",l:[{a:"node_in",d:"lZ",g:["float"],f:!1},{a:"node_in",d:"l_",g:["vec3"],f:!1},{a:"node_in",d:"ma",g:["vec3"],f:!1},{a:"node_out",d:"mb",g:["vec3"],f:!1}],j:[{a:"txt",b:"float iH = clamp ( lZ , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; float lj = UNITY_VALUE_NODES - iH ; vec3 dG , lU ; dG = dF ( l_ ) ; lU = dF ( ma ) ; dG . z = lj * dG . z + iH * lU . z ; mb = dH ( dG ) ;".split(" ")},
{a:"node_cond",c:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"mb = clamp ( mb , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{a:"node",d:"MIX_RGB_COLOR",l:[{a:"node_in",d:"mc",g:["float"],f:!1},{a:"node_in",d:"md",g:["vec3"],f:!1},{a:"node_in",d:"me",g:["vec3"],f:!1},{a:"node_out",d:"mf",g:["vec3"],f:!1}],j:[{a:"txt",b:"float iH = clamp ( mc , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; vec3 dG , lU , lJ ; mf = md ; lU = dF ( me ) ; if ( lU . y != ZERO_VALUE_NODES ) { dG = dF ( mf ) ; dG . x = lU . x ; dG . y = lU . y ; lJ = dH ( dG ) ; mf = mix ( mf , lJ , iH ) ; }".split(" ")},
{a:"node_cond",c:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"mf = clamp ( mf , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{a:"node",d:"MIX_RGB_SOFT_LIGHT",l:[{a:"node_in",d:"mg",g:["float"],f:!1},{a:"node_in",d:"mh",g:["vec3"],f:!1},{a:"node_in",d:"mi",g:["vec3"],f:!1},{a:"node_out",d:"mj",g:["vec3"],f:!1}],j:[{a:"txt",b:"float iH = clamp ( mg , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; float lj = UNITY_VALUE_NODES - iH ; vec3 mk = mi + mh - mi * mh ; mj = mh * ( vec3 ( lj ) + vec3 ( iH ) * ( ( vec3 ( UNITY_VALUE_NODES ) - mh ) * mi + mk ) ) ;".split(" ")},
{a:"node_cond",c:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"mj = clamp ( mj , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{a:"node",d:"MIX_RGB_LINEAR_LIGHT",l:[{a:"node_in",d:"ml",g:["float"],f:!1},{a:"node_in",d:"mm",g:["vec3"],f:!1},{a:"node_in",d:"mn",g:["vec3"],f:!1},{a:"node_out",d:"mo",g:["vec3"],f:!1}],j:[{a:"txt",b:"float iH = clamp ( ml , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; mo = mm + iH * ( 2.0 * mn - vec3 ( UNITY_VALUE_NODES ) ) ;".split(" ")},{a:"node_cond",
c:[{a:"node_if",e:["MIX_RGB_USE_CLAMP"],j:[{a:"txt",b:"mo = clamp ( mo , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},{a:"node",d:"OUTPUT",l:[{a:"node_in",d:"mp",g:["vec3"],f:!1},{a:"node_in",d:"mq",g:["float"],f:!1}],j:[{a:"txt",b:"ed = mp ; eh = mq ;".split(" ")}]},{a:"node",d:"MATERIAL_BEGIN",l:[{a:"node_in",d:"mr",g:["vec3"],f:!1},{a:"node_in",d:"ms",g:["vec3"],f:!1},{a:"node_in",d:"mt",g:["float"],f:!1},{a:"node_in",d:"mu",g:["vec3"],f:!0},{a:"node_in",d:"mv",g:["float"],f:!0},
{a:"node_out",d:"mw",g:["vec3"],f:!1},{a:"node_out",d:"mx",g:["vec3"],f:!1},{a:"node_out",d:"my",g:["vec3"],f:!1},{a:"node_out",d:"mz",g:["vec3"],f:!1},{a:"node_out",d:"mA",g:["vec3"],f:!1},{a:"node_out",d:"mB",g:["vec2"],f:!1},{a:"node_out",d:"mC",g:["vec2"],f:!1},{a:"node_out",d:"mD",g:["vec4"],f:!1},{a:"node_param",d:"dU",g:["const","vec2"],f:!0},{a:"node_param",d:"dV",g:["const","vec3"],f:!1}],j:[{a:"txt",b:"my = clamp ( mr , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},{a:"txt",b:"mz = dV [ 0 ] * clamp ( ms , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},
{a:"node_cond",c:[{a:"node_if",e:["USE_MATERIAL_NORMAL"],j:[{a:"txt",b:"mA = normalize ( mu ) ;".split(" ")},{a:"txt",b:"mA . yz = vec2 ( mA . z , - mA . y ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:["mA","=","ej",";"]}]}]},{a:"node_cond",c:[{a:"node_if",e:["SHADELESS_MAT",{a:"logic_negative_expr",i:1}],j:[{a:"node_cond",c:[{a:"node_if",e:["MATERIAL_EXT"],j:[{a:"txt",b:"mw = mv * my ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"mw = ep * my ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",
e:["USE_MATERIAL_DIFFUSE"],j:[{a:"txt",b:["my","*=","mt",";"]}]}]},{a:"txt",b:"mx = eq * u_environment_energy * dm ( mA ) ; mD = vec4 ( 1.0 ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["NUM_LIGHTS",0,{a:"g_expr",i:2}],j:[{a:"txt",b:"mB = vec2 ( dU [ 0 ] , dU [ 1 ] ) ;".split(" ")},{a:"txt",b:"mC = vec2 ( dV [ 1 ] , dV [ 2 ] ) ;".split(" ")}]}]},{a:"txt",b:["eg","=","mD",";"]}]},{a:"node_else",j:[{a:"txt",b:"mw = vec3 ( ZERO_VALUE_NODES ) ; mx = vec3 ( UNITY_VALUE_NODES ) ;".split(" ")}]}]}]},
{a:"node",d:"MATERIAL_END",l:[{a:"node_in",d:"mE",g:["vec4"],f:!1},{a:"node_in",d:"mF",g:["vec3"],f:!1},{a:"node_in",d:"mG",g:["vec3"],f:!1},{a:"node_in",d:"mH",g:["float"],f:!0},{a:"node_in",d:"mI",g:["float"],f:!0},{a:"node_in",d:"mJ",g:["float"],f:!0},{a:"node_out",d:"mK",g:["vec3"],f:!0},{a:"node_out",d:"mL",g:["float"],f:!0},{a:"node_out",d:"mM",g:["vec3"],f:!0},{a:"node_out",d:"mN",g:["vec3"],f:!0},{a:"node_out",d:"mO",g:["vec3"],f:!0},{a:"node_param",d:"dW",g:["float"],f:!1},{a:"node_param",
d:"dX",g:["float"],f:!1}],j:[{a:"txt",b:["mH",";"]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_mK"],j:[{a:"node_cond",c:[{a:"node_if",e:["USE_MATERIAL_DIFFUSE"],j:[{a:"txt",b:"mK = mE . rgb ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"mK = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:["mK","+=","mF",";"]}]}]}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_mM"],j:[{a:"txt",b:["mM","=","mG",";"]},{a:"txt",b:"mM . yz = vec2 ( - mM . z , mM . y ) ;".split(" ")}]}]},
{a:"node_cond",c:[{a:"node_if",e:["MATERIAL_EXT"],j:[{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_mN"],j:[{a:"txt",b:"mN = mE . rgb ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_mO"],j:[{a:"txt",b:["mO","=","mF",";"]}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_mL"],j:[{a:"txt",b:"mL = clamp ( mJ , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:"float t = max ( max ( mF . r , mF . g ) , mF . b ) * mI ; mL = clamp ( mJ * ( UNITY_VALUE_NODES - t ) + t , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]}]}]}]}]},
{a:"node_else",j:[{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_mL"],j:[{a:"txt",b:"mL = clamp ( dW , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:"float t = max ( max ( mF . r , mF . g ) , mF . b ) * dX ; mL = dW * ( UNITY_VALUE_NODES - t ) + t ;".split(" ")}]}]}]}]}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_MATERIAL_SPECULAR"],j:[{a:"txt",b:["ee","=","mF",";"]}]},{a:"node_else",j:[{a:"txt",b:"ee = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]}]},
{a:"txt",b:["ef","=","mG",";"]}]},{a:"node",d:"LIGHTING_AMBIENT",l:[{a:"node_in",d:"mP",g:["vec3"],f:!1},{a:"node_in",d:"mQ",g:["vec3"],f:!1},{a:"node_in",d:"mR",g:["vec3"],f:!1},{a:"node_out",d:"mS",g:["vec4"],f:!1},{a:"node_out",d:"mT",g:["vec3"],f:!1}],j:[{a:"txt",b:"mS = vec4 ( mP + mR * mQ , ZERO_VALUE_NODES ) ; mT = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")}]},{a:"node",d:"LIGHTING_LAMP",l:[{a:"node_in",d:"mU",g:["vec4"],f:!1},{a:"node_out",d:"mV",g:["vec3"],f:!1},{a:"node_out",d:"mW",g:["vec2"],
f:!1},{a:"node_out",d:"mX",g:["vec3"],f:!1},{a:"node_out",d:"mY",g:["float"],f:!1}],j:[{a:"txt",b:"mW = u_light_factors [ LAMP_LIGHT_FACT_IND ] . LAMP_FAC_CHANNELS ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["LAMP_TYPE","HEMI",{a:"equal_expr",i:2}],j:[{a:"txt",b:["mY","=","dz",";"]}]},{a:"node_else",j:[{a:"txt",b:["mY","=","ZERO_VALUE_NODES",";"]}]}]},{a:"txt",b:"mX = u_light_color_intensities [ LAMP_IND ] ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["LAMP_SHADOW_MAP_IND",1,{a:"negative_expr",
i:1},{a:"non_equal_expr",i:2}],j:[{a:"txt",b:"mX *= mU [ LAMP_SHADOW_MAP_IND ] ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["LAMP_TYPE","SPOT",{a:"equal_expr",i:2},"LAMP_TYPE","POINT",{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],j:[{a:"txt",b:"vec3 mZ = u_light_positions [ LAMP_IND ] ; mV = mZ - en ;".split(" ")},{a:"txt",b:"float m_ = length ( mV ) ; mX *= LAMP_LIGHT_DIST / ( LAMP_LIGHT_DIST + m_ * m_ ) ; mV = normalize ( mV ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["LAMP_TYPE",
"SPOT",{a:"equal_expr",i:2}],j:[{a:"txt",b:"vec3 na = u_light_directions [ LAMP_IND ] ; float fs = dot ( mV , na ) ; fs *= smoothstep ( ZERO_VALUE_NODES , UNITY_VALUE_NODES , ( fs - LAMP_SPOT_SIZE ) / LAMP_SPOT_BLEND ) ; mX *= fs ;".split(" ")}]}]}]},{a:"node_else",j:[{a:"txt",b:"mV = u_light_directions [ LAMP_IND ] ;".split(" ")}]}]}]},{a:"node",d:"DIFFUSE_FRESNEL",l:[{a:"node_in",d:"nb",g:["vec3"],f:!1},{a:"node_in",d:"nc",g:["vec2"],f:!1},{a:"node_in",d:"nd",g:["vec3"],f:!1},{a:"node_in",d:"ne",
g:["float"],f:!1},{a:"node_in",d:"nf",g:["vec2"],f:!1},{a:"node_out",d:"ng",g:["float"],f:!1}],j:[{a:"node_cond",c:[{a:"node_if",e:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 ni = cross ( nb , bJ . xyz ) ; nd = cross ( ni , bJ . xyz ) ; nd = - normalize ( nd ) ;".split(" ")}]}]},{a:"txt",b:"ng = ZERO_VALUE_NODES ; if ( nc . r != ZERO_VALUE_NODES ) { float nj = ( UNITY_VALUE_NODES - ne ) * dot ( nd , nb ) + ne ; if ( nf [ 0 ] == ZERO_VALUE_NODES ) { ng = UNITY_VALUE_NODES ; } else { float t = UNITY_VALUE_NODES + abs ( nj ) ; t = nf [ 1 ] + ( UNITY_VALUE_NODES - nf [ 1 ] ) * pow ( t , nf [ 0 ] ) ; ng = clamp ( t , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; } ng = max ( ng , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{a:"node",d:"DIFFUSE_LAMBERT",l:[{a:"node_in",d:"nk",g:["vec3"],f:!1},{a:"node_in",d:"nl",g:["vec2"],f:!1},{a:"node_in",d:"nm",g:["vec3"],f:!1},{a:"node_in",d:"nn",g:["float"],f:!1},{a:"node_out",d:"no",g:["float"],f:!1}],j:[{a:"node_cond",c:[{a:"node_if",e:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 ni = cross ( nk , bJ . xyz ) ; nm = cross ( ni , bJ . xyz ) ; nm = - normalize ( nm ) ;".split(" ")}]}]},{a:"txt",b:"no = ZERO_VALUE_NODES ; if ( nl . r != ZERO_VALUE_NODES ) { float nj = ( UNITY_VALUE_NODES - nn ) * dot ( nm , nk ) + nn ; no = max ( nj , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{a:"node",d:"DIFFUSE_OREN_NAYAR",l:[{a:"node_in",d:"np",g:["vec3"],f:!1},{a:"node_in",d:"nq",g:["vec2"],f:!1},{a:"node_in",d:"nr",g:["vec3"],f:!1},{a:"node_in",d:"ns",g:["float"],f:!1},{a:"node_in",d:"nt",g:["vec2"],f:!1},{a:"node_out",d:"nu",g:["float"],f:!1}],j:[{a:"node_cond",c:[{a:"node_if",e:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 ni = cross ( np , bJ . xyz ) ; nr = cross ( ni , bJ . xyz ) ; nr = - normalize ( nr ) ;".split(" ")}]}]},{a:"txt",b:"nu = ZERO_VALUE_NODES ; if ( nq . r != ZERO_VALUE_NODES ) { float nj = ( UNITY_VALUE_NODES - ns ) * dot ( nr , np ) + ns ; if ( nt [ 0 ] > ZERO_VALUE_NODES ) { float nv = max ( dot ( nr , dY ) , ZERO_VALUE_NODES ) ; float nw = nt [ 0 ] * nt [ 0 ] ; float nx = UNITY_VALUE_NODES - dz * ( nw / ( nw + 0.33 ) ) ; vec3 ny = np - nj * nr ; vec3 nz = dY - nv * nr ;".split(" ")},
{a:"txt",b:"if ( length ( ny ) == ZERO_VALUE_NODES || length ( nz ) == ZERO_VALUE_NODES || abs ( nj ) > UNITY_VALUE_NODES || abs ( nv ) > UNITY_VALUE_NODES )".split(" ")},{a:"txt",b:"nu = nj * nx ; else { float nA = acos ( nj ) ; float nB = acos ( nv ) ; vec3 nC = normalize ( ny ) ; vec3 nD = normalize ( nz ) ; float a , b ; a = max ( nA , nB ) ; b = min ( nA , nB ) ; b *= 0.95 ; float t = max ( dot ( nC , nD ) , ZERO_VALUE_NODES ) ; float nE = 0.45 * ( nw / ( nw + 0.09 ) ) ; nu = nj * ( nx + ( nE * t * sin ( a ) * tan ( b ) ) ) ; } } else nu = nj ; nu = max ( nu , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{a:"node",d:"DIFFUSE_MINNAERT",l:[{a:"node_in",d:"nF",g:["vec3"],f:!1},{a:"node_in",d:"nG",g:["vec2"],f:!1},{a:"node_in",d:"nH",g:["vec3"],f:!1},{a:"node_in",d:"nI",g:["float"],f:!1},{a:"node_in",d:"nJ",g:["vec2"],f:!1},{a:"node_out",d:"nK",g:["float"],f:!1}],j:[{a:"node_cond",c:[{a:"node_if",e:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 ni = cross ( nF , bJ . xyz ) ; nH = cross ( ni , bJ . xyz ) ; nH = - normalize ( nH ) ;".split(" ")}]}]},{a:"txt",b:"nK = ZERO_VALUE_NODES ; if ( nG . r != ZERO_VALUE_NODES ) { float nj = ( UNITY_VALUE_NODES - nI ) * dot ( nH , nF ) + nI ; float nv = max ( dot ( nH , dY ) , ZERO_VALUE_NODES ) ; if ( nJ [ 0 ] <= UNITY_VALUE_NODES ) nK = nj * pow ( max ( nv * nj , 0.1 ) , nJ [ 0 ] - UNITY_VALUE_NODES ) ; else nK = nj * pow ( 1.0001 - nv , nJ [ 0 ] - UNITY_VALUE_NODES ) ; nK = max ( nK , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{a:"node",d:"DIFFUSE_TOON",l:[{a:"node_in",d:"nL",g:["vec3"],f:!1},{a:"node_in",d:"nM",g:["vec2"],f:!1},{a:"node_in",d:"nN",g:["vec3"],f:!1},{a:"node_in",d:"nO",g:["float"],f:!1},{a:"node_in",d:"nP",g:["vec2"],f:!1},{a:"node_out",d:"nQ",g:["float"],f:!1}],j:[{a:"node_cond",c:[{a:"node_if",e:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"vec3 ni = cross ( nL , bJ . xyz ) ; nN = cross ( ni , bJ . xyz ) ; nN = - normalize ( nN ) ;".split(" ")}]}]},{a:"txt",b:"nQ = ZERO_VALUE_NODES ; if ( nM . r != ZERO_VALUE_NODES ) { float nj = ( UNITY_VALUE_NODES - nO ) * dot ( nN , nL ) + nO ; float nR = acos ( nj ) ; if ( nR < nP [ 0 ] ) nQ = UNITY_VALUE_NODES ; else if ( nR > ( nP [ 0 ] + nP [ 1 ] ) || nP [ 1 ] == ZERO_VALUE_NODES ) nQ = ZERO_VALUE_NODES ; else nQ = UNITY_VALUE_NODES - ( ( nR - nP [ 0 ] ) / nP [ 1 ] ) ; nQ = max ( nQ , ZERO_VALUE_NODES ) ; }".split(" ")}]},
{a:"node",d:"SPECULAR_PHONG",l:[{a:"node_in",d:"nS",g:["vec3"],f:!1},{a:"node_in",d:"nT",g:["vec2"],f:!1},{a:"node_in",d:"nU",g:["vec3"],f:!1},{a:"node_in",d:"nV",g:["float"],f:!1},{a:"node_in",d:"nW",g:["vec2"],f:!1},{a:"node_out",d:"nX",g:["float"],f:!1}],j:[{a:"txt",b:"nX = ZERO_VALUE_NODES ; if ( nT . g == UNITY_VALUE_NODES ) { vec3 nY = normalize ( nS + dY ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"if ( nV == ZERO_VALUE_NODES ) { nX = dot ( bJ . xyz , nY ) ; nX = sqrt ( UNITY_VALUE_NODES - nX * nX ) ; }".split(" ")}]},
{a:"node_else",j:[{a:"txt",b:"nX = ( UNITY_VALUE_NODES - nV ) * max ( dot ( nU , nY ) , ZERO_VALUE_NODES ) + nV ;".split(" ")}]}]},{a:"txt",b:"nX = pow ( nX , nW [ 0 ] ) ; }".split(" ")}]},{a:"node",d:"SPECULAR_WARDISO",l:[{a:"node_in",d:"nZ",g:["vec3"],f:!1},{a:"node_in",d:"n_",g:["vec2"],f:!1},{a:"node_in",d:"oa",g:["vec3"],f:!1},{a:"node_in",d:"ob",g:["float"],f:!1},{a:"node_in",d:"oc",g:["vec2"],f:!1},{a:"node_out",d:"od",g:["float"],f:!1}],j:[{a:"txt",b:"od = ZERO_VALUE_NODES ; if ( n_ . g == UNITY_VALUE_NODES ) { vec3 nY = normalize ( nZ + dY ) ;".split(" ")},
{a:"node_cond",c:[{a:"node_if",e:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float oe = ZERO_VALUE_NODES ; float nv = ZERO_VALUE_NODES ; float of = ZERO_VALUE_NODES ; if ( ob == ZERO_VALUE_NODES ) { oe = dot ( bJ . xyz , nY ) ; nv = dot ( bJ . xyz , dY ) ; of = dot ( bJ . xyz , nZ ) ; oe = sqrt ( UNITY_VALUE_NODES - oe * oe ) ; nv = sqrt ( UNITY_VALUE_NODES - nv * nv ) ; of = sqrt ( UNITY_VALUE_NODES - of * of ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float oe = max ( dot ( oa , nY ) , 0.001 ) ;".split(" ")},
{a:"txt",b:"float nv = max ( dot ( oa , dY ) , 0.01 ) ; float of = max ( dot ( oa , nZ ) , 0.01 ) ;".split(" ")}]}]},{a:"txt",b:"float O = tan ( acos ( oe ) ) ; float bf = max ( oc [ 0 ] , 0.001 ) ; od = of * ( UNITY_VALUE_NODES / ( 4.0 * M_PI * bf * bf ) ) * ( exp ( - ( O * O ) / ( bf * bf ) ) / ( sqrt ( nv * of ) ) ) ; }".split(" ")}]},{a:"node",d:"SPECULAR_TOON",l:[{a:"node_in",d:"og",g:["vec3"],f:!1},{a:"node_in",d:"oh",g:["vec2"],f:!1},{a:"node_in",d:"oi",g:["vec3"],f:!1},{a:"node_in",d:"oj",
g:["float"],f:!1},{a:"node_in",d:"ok",g:["vec2"],f:!1},{a:"node_out",d:"ol",g:["float"],f:!1}],j:[{a:"txt",b:"ol = ZERO_VALUE_NODES ; if ( oh . g == UNITY_VALUE_NODES ) { vec3 aV = normalize ( og + dY ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float om = dot ( aV , bJ . xyz ) ; float O = ok [ 0 ] + ok [ 1 ] ; if ( oj == ZERO_VALUE_NODES ) O = acos ( sqrt ( UNITY_VALUE_NODES - om * om ) ) ;".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float O = acos ( dot ( aV , oi ) ) ;".split(" ")}]}]},
{a:"txt",b:"if ( O < ok [ 0 ] ) ol = UNITY_VALUE_NODES ; else if ( O >= ok [ 0 ] + ok [ 1 ] || ok [ 1 ] == ZERO_VALUE_NODES ) ol = ZERO_VALUE_NODES ; else ol = UNITY_VALUE_NODES - ( O - ok [ 0 ] ) / ok [ 1 ] ; }".split(" ")}]},{a:"node",d:"SPECULAR_BLINN",l:[{a:"node_in",d:"on",g:["vec3"],f:!1},{a:"node_in",d:"oo",g:["vec2"],f:!1},{a:"node_in",d:"op",g:["vec3"],f:!1},{a:"node_in",d:"oq",g:["float"],f:!1},{a:"node_in",d:"or",g:["vec2"],f:!1},{a:"node_out",d:"os",g:["float"],f:!1}],j:[{a:"txt",b:"os = ZERO_VALUE_NODES ; if ( oo . g == UNITY_VALUE_NODES ) { if ( or [ 0 ] < 1.0 || or [ 1 ] == ZERO_VALUE_NODES ) os = ZERO_VALUE_NODES ; else { if ( or [ 1 ] < 100.0 ) or [ 1 ] = sqrt ( 1.0 / or [ 1 ] ) ; else or [ 1 ] = 10.0 / or [ 1 ] ; vec3 nY = normalize ( dY + on ) ;".split(" ")},
{a:"node_cond",c:[{a:"node_if",e:["MAT_USE_TBN_SHADING"],j:[{a:"txt",b:"float oe = 0.0 ; if ( oq == ZERO_VALUE_NODES ) { float ot = dot ( bJ . xyz , nY ) ; oe = sqrt ( UNITY_VALUE_NODES - ot * ot ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"float oe = ( UNITY_VALUE_NODES - oq ) * max ( dot ( op , nY ) , ZERO_VALUE_NODES ) + oq ;".split(" ")}]}]},{a:"txt",b:"if ( oe < ZERO_VALUE_NODES ) os = ZERO_VALUE_NODES ; else { float nv = max ( dot ( op , dY ) , 0.01 ) ; float of = dot ( op , on ) ; if ( of <= 0.01 ) os = ZERO_VALUE_NODES ; else { float ou = max ( dot ( dY , nY ) , 0.01 ) ; float a = UNITY_VALUE_NODES ; float b = ( 2.0 * oe * nv ) / ou ; float ov = ( 2.0 * oe * of ) / ou ; float g = min ( min ( a , b ) , ov ) ; float p = sqrt ( pow ( or [ 0 ] , 2.0 ) + pow ( ou , 2.0 ) - UNITY_VALUE_NODES ) ; float ow = pow ( p - ou , 2.0 ) / pow ( p + ou , 2.0 ) * ( UNITY_VALUE_NODES + pow ( ou * ( p + ou ) - UNITY_VALUE_NODES , 2.0 ) / pow ( ou * ( p - ou ) + UNITY_VALUE_NODES , 2.0 ) ) ; float nR = acos ( oe ) ; os = max ( ow * g * exp ( - pow ( nR , 2.0 ) / ( 2.0 * pow ( or [ 1 ] , 2.0 ) ) ) , ZERO_VALUE_NODES ) ; } } } }".split(" ")}]},
{a:"node",d:"LIGHTING_APPLY",l:[{a:"node_in",d:"ox",g:["vec4"],f:!1},{a:"node_in",d:"oy",g:["vec3"],f:!1},{a:"node_in",d:"oz",g:["float"],f:!1},{a:"node_in",d:"oA",g:["float"],f:!1},{a:"node_in",d:"oB",g:["vec3"],f:!1},{a:"node_in",d:"oC",g:["vec3"],f:!1},{a:"node_in",d:"oD",g:["vec4"],f:!1},{a:"node_in",d:"oE",g:["vec3"],f:!1},{a:"node_in",d:"oF",g:["vec3"],f:!1},{a:"node_in",d:"oG",g:["vec3"],f:!1},{a:"node_in",d:"oH",g:["float"],f:!1},{a:"node_out",d:"oI",g:["vec4"],f:!1},{a:"node_out",d:"oJ",
g:["vec3"],f:!1}],j:[{a:"node_cond",c:[{a:"node_if",e:["USE_NODE_B4W_TRANSLUCENCY"],j:[{a:"txt",b:"if ( dot ( oB , oC ) * dot ( dY , oC ) < ZERO_VALUE_NODES ) { float oK = oD . x ; float oL = oD . y ; float oM = oD . z ; float oN = oD . w ;".split(" ")},{a:"txt",b:"float oO = clamp ( abs ( dot ( oB , oC ) ) , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; float oP = clamp ( dot ( dY , - oB ) , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; float oQ = pow ( oP , oL ) ;".split(" ")},{a:"txt",b:"oI = ox + oH * vec4 ( oG * oO * pow ( oE , vec3 ( oK ) ) , UNITY_VALUE_NODES ) ;".split(" ")},
{a:"txt",b:"oI += oM * mix ( vec4 ( oE , UNITY_VALUE_NODES ) , vec4 ( UNITY_VALUE_NODES ) , oN ) * oH * vec4 ( oG * oO * vec3 ( oQ ) , UNITY_VALUE_NODES ) ; oJ = oy ; } else {".split(" ")},{a:"txt",b:"oJ = oy + oG * oF * oA ; oI = ox + vec4 ( oG * oE * oz , oA ) ; }".split(" ")}]},{a:"node_else",j:[{a:"txt",b:"oJ = oy + oG * oF * oA ; oI = ox + vec4 ( oG * oE * oz , oA ) ;".split(" ")}]}]}]},{a:"node",d:"RGB",l:[{a:"node_out",d:"oR",g:["vec3"],f:!1}],j:[{a:"txt",b:"oR = u_node_rgbs [ RGB_IND ] ;".split(" ")}]},
{a:"node",d:"RGBTOBW",l:[{a:"node_in",d:"oS",g:["vec3"],f:!1},{a:"node_out",d:"oT",g:["float"],f:!1}],j:[{a:"txt",b:"oT = dot ( oS , vec3 ( 0.35 , 0.45 , 0.2 ) ) ;".split(" ")}]},{a:"node",d:"SEPRGB",l:[{a:"node_in",d:"oU",g:["vec3"],f:!1},{a:"node_out",d:"oV",g:["float"],f:!0},{a:"node_out",d:"oW",g:["float"],f:!0},{a:"node_out",d:"oX",g:["float"],f:!0}],j:[{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_oV"],j:[{a:"txt",b:"oV = oU . r ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_oW"],
j:[{a:"txt",b:"oW = oU . g ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_oX"],j:[{a:"txt",b:"oX = oU . b ;".split(" ")}]}]}]},{a:"node",d:"SEPHSV",l:[{a:"node_in",d:"oY",g:["vec3"],f:!1},{a:"node_out",d:"oZ",g:["float"],f:!0},{a:"node_out",d:"o_",g:["float"],f:!0},{a:"node_out",d:"pa",g:["float"],f:!0}],j:[{a:"txt",b:"vec3 pb = dF ( oY ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_oZ"],j:[{a:"txt",b:"oZ = pb . r ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_o_"],
j:[{a:"txt",b:"o_ = pb . g ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_pa"],j:[{a:"txt",b:"pa = pb . b ;".split(" ")}]}]}]},{a:"node",d:"SQUEEZE",l:[{a:"node_in",d:"pc",g:["float"],f:!1},{a:"node_in",d:"pd",g:["float"],f:!1},{a:"node_in",d:"pe",g:["float"],f:!1},{a:"node_out",d:"pf",g:["float"],f:!1}],j:[{a:"txt",b:"pf = UNITY_VALUE_NODES / ( UNITY_VALUE_NODES + pow ( 2.71828183 , - ( pc - pe ) * pd ) ) ;".split(" ")}]},{a:"node",d:"GAMMA",l:[{a:"node_in",d:"pg",g:["vec3"],f:!1},
{a:"node_in",d:"ph",g:["float"],f:!1},{a:"node_out",d:"pi",g:["vec3"],f:!1}],j:[{a:"txt",b:"pi = pg ; if ( pi . x > ZERO_VALUE_NODES ) pi . x = pow ( pg . x , ph ) ; if ( pi . y > ZERO_VALUE_NODES ) pi . y = pow ( pg . y , ph ) ; if ( pi . z > ZERO_VALUE_NODES ) pi . z = pow ( pg . z , ph ) ;".split(" ")}]},{a:"node",d:"B4W_SRGB_TO_LINEAR",l:[{a:"node_in",d:"pj",g:["vec3"],f:!1},{a:"node_out",d:"pk",g:["vec3"],f:!1}],j:[{a:"txt",b:"pk = max ( vec3 ( ZERO_VALUE_NODES ) , pj ) ; pk = pow ( pk , vec3 ( 2.2 ) ) ;".split(" ")}]},
{a:"node",d:"B4W_LINEAR_TO_SRGB",l:[{a:"node_in",d:"pl",g:["vec3"],f:!1},{a:"node_out",d:"pm",g:["vec3"],f:!1}],j:[{a:"txt",b:"pm = max ( vec3 ( ZERO_VALUE_NODES ) , pl ) ; pm = pow ( pm , vec3 ( UNITY_VALUE_NODES / 2.2 ) ) ;".split(" ")}]},{a:"node",d:"TEXTURE_EMPTY",l:[{a:"node_out",d:"pn",g:["vec3"],f:!1},{a:"node_out",d:"po",g:["vec3"],f:!1},{a:"node_out",d:"pr",g:["float"],f:!1}],j:[{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_pn"],j:[{a:"txt",b:"pn [ 2 ] = pn [ 1 ] = pn [ 0 ] = ZERO_VALUE_NODES ;".split(" ")}]}]},
{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_po"],j:[{a:"txt",b:"po [ 2 ] = po [ 1 ] = po [ 0 ] = ZERO_VALUE_NODES ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_pr"],j:[{a:"txt",b:["pr","=","ZERO_VALUE_NODES",";"]}]}]}]},{a:"node",d:"TEXTURE_ENVIRONMENT",l:[{a:"node_in",d:"pu",g:["vec3"],f:!1},{a:"node_out",d:"pv",g:["vec3"],f:!0},{a:"node_out",d:"pw",g:["float"],f:!0},{a:"node_param",d:"node_TEXTURE_ENVIRONMENT_var_texture",g:["uniform","samplerCube"],f:!1}],j:[{a:"txt",b:"vec3 px = vec3 ( pu . x , pu . z , - pu . y ) ; vec4 jJ = GLSL_TEXTURE_CUBE ( node_TEXTURE_ENVIRONMENT_var_texture , px ) ;".split(" ")},
{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_pv"],j:[{a:"txt",b:"pv = jJ . xyz ; bd ( pv ) ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_pw"],j:[{a:"txt",b:"pw = jJ . w ;".split(" ")}]}]}]},{a:"node",d:"TEXTURE_COLOR",l:[{a:"node_in",d:"py",g:["vec3"],f:!0},{a:"node_in",d:"pz",g:["vec3"],f:!0},{a:"node_in",d:"pA",g:["vec3"],f:!0},{a:"node_in",d:"pB",g:["vec3"],f:!0},{a:"node_out",d:"pC",g:["vec3"],f:!0},{a:"node_out",d:"pD",g:["float"],f:!0},{a:"node_out",d:"pE",g:["vec3"],f:!0},{a:"node_out",
d:"pF",g:["float"],f:!0},{a:"node_out",d:"pG",g:["vec3"],f:!0},{a:"node_out",d:"pH",g:["float"],f:!0},{a:"node_out",d:"pI",g:["vec3"],f:!0},{a:"node_out",d:"pJ",g:["float"],f:!0},{a:"node_param",d:"node_TEXTURE_COLOR_var_texture",g:["uniform","sampler2D"],f:!1}],j:[{a:"txt",b:"vec4 jJ = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , dK ( py ) ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_pC"],j:[{a:"txt",b:"pC = jJ . xyz ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["NON_COLOR",
{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bd","(","pC",")",";"]}]}]}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_pD"],j:[{a:"txt",b:"pD = jJ . w ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_uv2"],j:[{a:"txt",b:"jJ = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , dK ( pz ) ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_pE"],j:[{a:"txt",b:"pE = jJ . xyz ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bd",
"(","pE",")",";"]}]}]}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_pF"],j:[{a:"txt",b:"pF = jJ . w ;".split(" ")}]}]}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_uv3"],j:[{a:"txt",b:"jJ = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , dK ( pA ) ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_pG"],j:[{a:"txt",b:"pG = jJ . xyz ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bd","(","pG",")",";"]}]}]}]}]},{a:"node_cond",c:[{a:"node_if",
e:["USE_OUT_pH"],j:[{a:"txt",b:"pH = jJ . w ;".split(" ")}]}]}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_uv4"],j:[{a:"txt",b:"jJ = GLSL_TEXTURE ( node_TEXTURE_COLOR_var_texture , dK ( pB ) ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_pI"],j:[{a:"txt",b:"pI = jJ . xyz ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["NON_COLOR",{a:"logic_negative_expr",i:1}],j:[{a:"txt",b:["bd","(","pI",")",";"]}]}]}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_pJ"],j:[{a:"txt",b:"pJ = jJ . w ;".split(" ")}]}]}]}]}]},
{a:"node",d:"TEXTURE_NORMAL",l:[{a:"node_in",d:"pK",g:["vec3"],f:!0},{a:"node_in",d:"pL",g:["vec3"],f:!0},{a:"node_in",d:"pM",g:["vec3"],f:!0},{a:"node_in",d:"pN",g:["vec3"],f:!0},{a:"node_out",d:"pO",g:["vec3"],f:!0},{a:"node_out",d:"pP",g:["float"],f:!0},{a:"node_out",d:"pQ",g:["vec3"],f:!0},{a:"node_out",d:"pR",g:["float"],f:!0},{a:"node_out",d:"pS",g:["vec3"],f:!0},{a:"node_out",d:"pT",g:["float"],f:!0},{a:"node_out",d:"pU",g:["vec3"],f:!0},{a:"node_out",d:"pV",g:["float"],f:!0},{a:"node_param",
d:"node_TEXTURE_NORMAL_var_texture",g:["uniform","sampler2D"],f:!1}],j:[{a:"txt",b:"vec4 jJ = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , dK ( pK ) ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_pO"],j:[{a:"txt",b:"pO = normalize ( em * ( jJ . xyz - dz ) ) ;".split(" ")},{a:"txt",b:"pO . yz = vec2 ( - pO . z , pO . y ) ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_pP"],j:[{a:"txt",b:"pP = jJ . w ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_uv2"],j:[{a:"txt",
b:"jJ = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , dK ( pL ) ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_pQ"],j:[{a:"txt",b:"pQ = normalize ( em * ( jJ . xyz - dz ) ) ;".split(" ")},{a:"txt",b:"pQ . yz = vec2 ( - pQ . z , pQ . y ) ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_pR"],j:[{a:"txt",b:"pR = jJ . w ;".split(" ")}]}]}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_uv3"],j:[{a:"txt",b:"jJ = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , dK ( pM ) ) ;".split(" ")},
{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_pS"],j:[{a:"txt",b:"pS = normalize ( em * ( jJ . xyz - dz ) ) ;".split(" ")},{a:"txt",b:"pS . yz = vec2 ( - pS . z , pS . y ) ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_pT"],j:[{a:"txt",b:"pT = jJ . w ;".split(" ")}]}]}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_uv4"],j:[{a:"txt",b:"jJ = GLSL_TEXTURE ( node_TEXTURE_NORMAL_var_texture , dK ( pN ) ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_pU"],j:[{a:"txt",b:"pU = normalize ( em * ( jJ . xyz - dz ) ) ;".split(" ")},
{a:"txt",b:"pU . yz = vec2 ( - pU . z , pU . y ) ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_pV"],j:[{a:"txt",b:"pV = jJ . w ;".split(" ")}]}]}]}]}]},{a:"node",d:"VALUE",l:[{a:"node_out",d:"pW",g:["float"],f:!1}],j:[{a:"txt",b:"pW = u_node_values [ VALUE_IND ] ;".split(" ")}]},{a:"node",d:"VECT_MATH_ADD",l:[{a:"node_in",d:"pX",g:["vec3"],f:!1},{a:"node_in",d:"pY",g:["vec3"],f:!1},{a:"node_out",d:"pZ",g:["vec3"],f:!1},{a:"node_out",d:"p_",g:["float"],f:!0}],j:[{a:"txt",b:"pZ = pX + pY ;".split(" ")},
{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_p_"],j:[{a:"txt",b:"p_ = ( abs ( pZ [ 0 ] ) + abs ( pZ [ 1 ] ) + abs ( pZ [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},{a:"node",d:"VECT_MATH_SUBTRACT",l:[{a:"node_in",d:"qa",g:["vec3"],f:!1},{a:"node_in",d:"qb",g:["vec3"],f:!1},{a:"node_out",d:"qc",g:["vec3"],f:!1},{a:"node_out",d:"qd",g:["float"],f:!0}],j:[{a:"txt",b:"qc = qa - qb ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_qd"],j:[{a:"txt",b:"qd = ( abs ( qc [ 0 ] ) + abs ( qc [ 1 ] ) + abs ( qc [ 2 ] ) ) / 3.0 ;".split(" ")}]}]}]},
{a:"node",d:"VECT_MATH_AVERAGE",l:[{a:"node_in",d:"qe",g:["vec3"],f:!1},{a:"node_in",d:"qf",g:["vec3"],f:!1},{a:"node_out",d:"qg",g:["vec3"],f:!1},{a:"node_out",d:"qh",g:["float"],f:!0}],j:[{a:"txt",b:"qg = qe + qf ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_qh"],j:[{a:"txt",b:"qh = length ( qg ) ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_qg"],j:[{a:"txt",b:"qg = normalize ( qg ) ;".split(" ")}]}]}]},{a:"node",d:"VECT_MATH_DOT_PRODUCT",l:[{a:"node_in",d:"qi",g:["vec3"],
f:!1},{a:"node_in",d:"qj",g:["vec3"],f:!1},{a:"node_out",d:"qk",g:["vec3"],f:!1},{a:"node_out",d:"ql",g:["float"],f:!0}],j:[{a:"txt",b:"qk = vec3 ( ZERO_VALUE_NODES ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_ql"],j:[{a:"txt",b:"ql = dot ( qi , qj ) ;".split(" ")}]}]}]},{a:"node",d:"VECT_MATH_CROSS_PRODUCT",l:[{a:"node_in",d:"qm",g:["vec3"],f:!1},{a:"node_in",d:"qn",g:["vec3"],f:!1},{a:"node_out",d:"qo",g:["vec3"],f:!1},{a:"node_out",d:"qr",g:["float"],f:!0}],j:[{a:"txt",b:"qo = cross ( qm , qn ) ;".split(" ")},
{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_qr"],j:[{a:"txt",b:"qr = length ( qo ) ;".split(" ")}]}]}]},{a:"node",d:"VECT_MATH_NORMALIZE",l:[{a:"node_in",d:"qu",g:["vec3"],f:!1},{a:"node_in",d:"qv",g:["vec3"],f:!1},{a:"node_out",d:"qw",g:["vec3"],f:!1},{a:"node_out",d:"qx",g:["float"],f:!0}],j:[{a:"txt",b:"qw = normalize ( qu ) ;".split(" ")},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_qx"],j:[{a:"txt",b:"qx = length ( qu ) ;".split(" ")}]}]},{a:"txt",b:["qv",";"]}]},{a:"node",d:"B4W_REFLECT",l:[{a:"node_in",
d:"qy",g:["vec3"],f:!1},{a:"node_in",d:"qz",g:["vec3"],f:!1},{a:"node_out",d:"qA",g:["vec3"],f:!1}],j:[{a:"txt",b:"qA = reflect ( ( ea * vec4 ( qy , 0.0 ) ) . xyz , qz ) ;".split(" ")}]},{a:"node",d:"B4W_REFLECT_WORLD",l:[{a:"node_in",d:"qB",g:["vec3"],f:!1},{a:"node_out",d:"qC",g:["vec3"],f:!1}],j:[{a:"txt",b:"vec3 qD = vec3 ( - dY . x , dY . z , - dY . y ) ; qC = reflect ( qD , qB ) ;".split(" ")}]},{a:"node",d:"B4W_PARALLAX",l:[{a:"node_in",d:"qE",g:["vec3"],f:!1},{a:"node_in",d:"qF",g:["float"],
f:!1},{a:"node_in",d:"qG",g:["const","float"],f:!1},{a:"node_in",d:"qH",g:["const","float"],f:!1},{a:"node_out",d:"qI",g:["vec3"],f:!1},{a:"node_param",d:"node_B4W_PARALLAX_var_texture",g:["uniform","sampler2D"],f:!1}],j:[{a:"txt",b:"float bt = length ( eo ) ; if ( bt < qH ) { vec2 bv = dK ( qE ) ; float qJ = clamp ( dz * ( qH - bt ) , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ; float bA = qF * qJ ;".split(" ")},{a:"txt",b:"vec3 qK = normalize ( dY * em ) ;".split(" ")},{a:"txt",b:"float qL = UNITY_VALUE_NODES / qG ;".split(" ")},
{a:"txt",b:"vec2 qM = qK . xy * bA / ( qG * qK . z ) ; float qN = UNITY_VALUE_NODES ; float aV = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bv ) . a ;".split(" ")},{a:"txt",b:"for ( float aQ = 1.0 ; aQ <= qG ; aQ ++ ) { if ( aV < qN ) { qN -= qL ; bv -= qM ; aV = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , bv ) . a ; } }".split(" ")},{a:"txt",b:"vec2 qO = bv + qM ; float qP = GLSL_TEXTURE ( node_B4W_PARALLAX_var_texture , qO ) . a - ( qN + qL ) ; float qQ = aV - qN ; float qR = qQ / ( qQ - qP ) ;".split(" ")},
{a:"txt",b:"bv = qR * qO + ( UNITY_VALUE_NODES - qR ) * bv ; qI = dJ ( bv ) ; } else qI = qE ;".split(" ")}]},{a:"node",d:"B4W_CLAMP",l:[{a:"node_in",d:"qS",g:["vec3"],f:!1},{a:"node_out",d:"qT",g:["vec3"],f:!1}],j:[{a:"txt",b:"qT = clamp ( qS , ZERO_VALUE_NODES , UNITY_VALUE_NODES ) ;".split(" ")}]},{a:"node",d:"B4W_REFRACTION",l:[{a:"node_in",d:"qU",g:["vec3"],f:!1},{a:"node_in",d:"qV",g:["float"],f:!1},{a:"node_out",d:"qW",g:["vec3"],f:!1}],j:[{a:"txt",b:["qW","=","qU",";"]}]},{a:"node",d:"B4W_TRANSLUCENCY",
l:[{a:"node_in",d:"qX",g:["float"],f:!1},{a:"node_in",d:"qY",g:["float"],f:!1},{a:"node_in",d:"qZ",g:["float"],f:!1},{a:"node_in",d:"q_",g:["float"],f:!1},{a:"node_in",d:"rc",g:["float"],f:!1},{a:"node_out",d:"rd",g:["float"],f:!0},{a:"node_out",d:"re",g:["vec4"],f:!0}],j:[{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_rd"],j:[{a:"txt",b:["rd","=","qX",";"]}]}]},{a:"node_cond",c:[{a:"node_if",e:["USE_OUT_re"],j:[{a:"txt",b:"re = vec4 ( qY , qZ , q_ , rc ) ;".split(" ")}]}]}]},{a:"node",d:"B4W_TIME",l:[{a:"node_out",
d:"rf",g:["float"],f:!1}],j:[{a:"txt",b:["rf","=","u_time",";"]}]},{a:"node",d:"B4W_SMOOTHSTEP",l:[{a:"node_in",d:"rh",g:["float"],f:!1},{a:"node_in",d:"ri",g:["float"],f:!1},{a:"node_in",d:"rj",g:["float"],f:!1},{a:"node_out",d:"rk",g:["float"],f:!1}],j:[{a:"txt",b:"rk = smoothstep ( ri , rj , rh ) ;".split(" ")}]},{a:"node",d:"B4W_GLOW_OUTPUT",l:[{a:"node_in",d:"rl",g:["vec3"],f:!1},{a:"node_in",d:"rm",g:["float"],f:!1}],j:[{a:"txt",b:"ed = rl ; eh = rm ;".split(" ")}]},{a:"node",d:"B4W_VECTOSCAL",
l:[{a:"node_in",d:"rn",g:["vec3"],f:!1},{a:"node_out",d:"ro",g:["float"],f:!1}],j:[{a:"txt",b:"ro = ( rn . r + rn . g + rn . b ) / 3.0 ;".split(" ")}]},{a:"node",d:"B4W_SCALTOVEC",l:[{a:"node_in",d:"rp",g:["float"],f:!1},{a:"node_out",d:"rq",g:["vec3"],f:!1}],j:[{a:"txt",b:"rq [ 0 ] = rp ; rq [ 1 ] = rp ; rq [ 2 ] = rp ;".split(" ")}]},{a:"nodes_global"},{a:"txt",b:"void rs ( in vec3 dY , in mat4 dZ , in mat4 d_ , in mat4 ea , in mat4 eb , in mat4 ec , out vec3 ed , out vec3 ee , out vec3 ef , out vec4 eg , out float eh ) { ed = vec3 ( ZERO_VALUE_NODES ) ; ee = vec3 ( ZERO_VALUE_NODES ) ; ef = vec3 ( ZERO_VALUE_NODES ) ; eg = vec4 ( ZERO_VALUE_NODES ) ; eh = ZERO_VALUE_NODES ;".split(" ")},
{a:"cond",c:[{a:"if",e:["USE_NODE_MATERIAL_BEGIN","USE_NODE_GEOMETRY_NO","CAUSTICS","CALC_TBN_SPACE","USE_NODE_TEX_COORD_NO","USE_NODE_NORMAL_MAP",{a:"logical_or_expr",i:6}],h:{a:"grp",c:[{a:"txt",b:"vec3 l = normalize ( bI ) ; vec3 ei = l ;".split(" ")},{a:"cond",c:[{a:"if",e:["DOUBLE_SIDED_LIGHTING","USE_NODE_GEOMETRY_NO",{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["INVERT_FRONTFACING"],h:{a:"grp",c:[{a:"txt",b:["if","(","!","gl_FrontFacing",")"]}]}},{a:"else",h:{a:"grp",c:[{a:"txt",
b:["if","(","gl_FrontFacing",")"]}]}}]},{a:"txt",b:"ei = ei ; else ei = - ei ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["DOUBLE_SIDED_LIGHTING"],h:{a:"grp",c:[{a:"txt",b:["vec3","ej","=","ei",";"]}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:["vec3","ej","=","l",";"]}]}}]},{a:"cond",c:[{a:"if",e:["USE_NODE_GEOMETRY_NO"],h:{a:"grp",c:[{a:"txt",b:["vec3","ek","=","ei",";"]}]}}]}]}}]},{a:"cond",c:[{a:"if",e:["CALC_TBN_SPACE"],h:{a:"grp",c:[{a:"txt",b:"vec3 k = cross ( ei , bJ . xyz ) * bJ . w ; mat3 el = mat3 ( bJ . xyz , k , ei ) ; mat3 em = el ;".split(" ")}]}}]},
{a:"txt",b:"vec3 en = bG ; vec4 eo = bH ; float ep = u_emit ; float eq = u_ambient ;".split(" ")},{a:"nodes_main"},{a:"txt",b:["}"]}]};a["include/particles.glslv"]={a:"grp",c:[{a:"txt",b:"struct wT { float wU ; vec3 f ; float bf ; vec3 m ; float O ; vec3 wV ; vec3 wW ; float wX ; } ;".split(" ")},{a:"cond",c:[{a:"if",e:["COLOR_RAMP_LENGTH",0,{a:"g_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"void xc ( inout vec3 m , float wY , vec4 wZ , vec4 w_ ) { float xa = w_ . x - wZ . x ; float xb = ( wY - wZ . x ) / xa ; m = mix ( m , w_ . yzw , clamp ( xb , 0.0 , 1.0 ) ) ; }".split(" ")}]}}]},
{a:"cond",c:[{a:"if",e:["COLOR_RAMP_LENGTH",0,{a:"g_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"vec3 xf ( float t , float xd , vec4 xe [ COLOR_RAMP_LENGTH ] ) { float wY = t / xd ; vec3 m = xe [ 0 ] . yzw ;".split(" ")},{a:"cond",c:[{a:"if",e:["COLOR_RAMP_LENGTH",1,{a:"g_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"xc ( m , wY , xe [ 0 ] , xe [ 1 ] ) ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["COLOR_RAMP_LENGTH",2,{a:"g_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"xc ( m , wY , xe [ 1 ] , xe [ 2 ] ) ;".split(" ")}]}}]},
{a:"cond",c:[{a:"if",e:["COLOR_RAMP_LENGTH",3,{a:"g_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"xc ( m , wY , xe [ 2 ] , xe [ 3 ] ) ;".split(" ")}]}}]},{a:"txt",b:["return","m",";","}"]}]}}]},{a:"txt",b:"float xl ( float t , float xd , float xg , float xh ) { float xi = max ( 0.01 , min ( xd , xg ) ) ; float xj = max ( 0.01 , min ( xd , xh ) ) ; float xk = xd - xj ; float bf = clamp ( t / xi , 0.0 , 1.0 ) - step ( xk , t ) * ( t - xk ) / xj ; return bf ; } wT xp ( ) { wT sp ; float t ; float xd = a_p_data [ 0 ] ; float xm = a_p_data [ 1 ] ; if ( u_p_cyclic == 1 ) { t = mod ( u_p_time , u_p_length ) - xm ; if ( t < 0.0 ) t += u_p_length ; } if ( u_p_cyclic != 1 ) { t = u_p_time - xm ; } if ( t < 0.0 || t >= xd ) { sp . wU = 0.0001 ; sp . f = vec3 ( 99999.0 , 0.0 , 0.0 ) ; } if ( ! ( t < 0.0 || t >= xd ) ) {".split(" ")},
{a:"cond",c:[{a:"if",e:["WORLD_SPACE"],h:{a:"grp",c:[{a:"txt",b:"vec3 rT = a_position ; vec3 nh = a_normal ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"mat4 rR = _ ( u_model_tsr ) ; vec3 rT = ( rR * vec4 ( a_position , 1.0 ) ) . xyz ; vec3 nh = ( rR * vec4 ( a_normal , 0.0 ) ) . xyz ;".split(" ")}]}}]},{a:"txt",b:"vec3 xn = u_p_nfactor * nh ; xn += a_p_vels . xyz ; xn . y -= u_p_gravity * t / 2.0 ; float xo = max ( u_p_mass , EPSILON ) ; xn += ( u_p_wind_fac * u_wind / xo ) * t / 2.0 ; sp . wX = t ; sp . wV = xn ; sp . wW = a_normal * a_p_vels . w ; sp . f = rT + xn * t ; sp . O = a_p_vels . w * t ;".split(" ")},
{a:"cond",c:[{a:"if",e:["USE_COLOR_RAMP"],h:{a:"grp",c:[{a:"txt",b:"sp . wU = GLSL_TEXTURE ( u_color_ramp_tex , vec2 ( t / u_p_max_lifetime , 0.5 ) ) . g ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"sp . wU = 1.0 ;".split(" ")}]}}]},{a:"cond",c:[{a:"if",e:["COLOR_RAMP_LENGTH",0,{a:"g_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"sp . m = xf ( t , u_p_max_lifetime , u_p_color_ramp ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"sp . m = vec3 ( 1.0 ) ;".split(" ")}]}}]},{a:"txt",b:"sp . bf = xl ( t , a_p_data [ 0 ] , u_p_fade_in , u_p_fade_out ) ; } return sp ; }".split(" ")}]};
a["include/particles_nodes.glslv"]={a:"grp",c:[{a:"node",d:"TEX_COORD_UV",l:[],j:[{a:"txt",b:"bQ = xv + 0.5 ;".split(" ")}]},{a:"node",d:"UV_MERGED",l:[],j:[{a:"txt",b:"bQ = xv + 0.5 ;".split(" ")}]},{a:"node",d:"UVMAP",l:[],j:[{a:"txt",b:"bQ = xv + 0.5 ;".split(" ")}]},{a:"node",d:"GEOMETRY_UV",l:[],j:[{a:"txt",b:"bQ = xv + 0.5 ;".split(" ")}]},{a:"node",d:"PARTICLE_INFO",l:[{a:"node_param",d:"wL",g:["GLSL_OUT","vec4"],f:!0},{a:"node_param",d:"wM",g:["GLSL_OUT","vec3"],f:!0},{a:"node_param",d:"wN",
g:["GLSL_OUT","vec3"],f:!0},{a:"node_param",d:"wO",g:["GLSL_OUT","vec3"],f:!0},{a:"node_param",d:"node_PARTICLE_INFO_var_a_p_indices",g:["GLSL_IN","float"],f:!0}],j:[{a:"node_cond",c:[{a:"node_if",e:["PART_INFO_SIZE"],j:[{a:"txt",b:"wL [ 3 ] = xu ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["PART_INFO_AGE"],j:[{a:"txt",b:"wL [ 1 ] = xt ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["PART_INFO_LT"],j:[{a:"txt",b:"wL [ 2 ] = xA ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["PART_INFO_LOC"],
j:[{a:"txt",b:["wM","=","xq",";"]}]}]},{a:"node_cond",c:[{a:"node_if",e:["PART_INFO_IND"],j:[{a:"txt",b:"wL [ 0 ] = node_PARTICLE_INFO_var_a_p_indices ;".split(" ")}]}]},{a:"node_cond",c:[{a:"node_if",e:["PART_INFO_VEL"],j:[{a:"txt",b:["wN","=","xr",";"]}]}]},{a:"node_cond",c:[{a:"node_if",e:["PART_INFO_A_VEL"],j:[{a:"txt",b:["wO","=","xs",";"]}]}]}]},{a:"nodes_global"},{a:"txt",b:"void rs ( in vec3 xq , in vec3 xr , in vec3 xs , in float xt , in float xu , in vec2 xv , in float xA ) {".split(" ")},
{a:"cond",c:[{a:"if",e:["USE_NODE_GEOMETRY_OR","USE_NODE_TEX_COORD_GE",{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"bQ = xv + 0.5 ;".split(" ")}]}}]},{a:"nodes_main"},{a:"txt",b:["}"]}]};a["include/blending.glslf"]={a:"grp",c:[{a:"txt",b:"float yq = 0.0 ; float yr = 1.0 ; vec3 dF ( vec3 rgb ) { vec4 dD = vec4 ( yq , - yr / 3.0 , 2.0 / 3.0 , - yr ) ; vec4 p = mix ( vec4 ( rgb . bg , dD . wz ) , vec4 ( rgb . gb , dD . xy ) , step ( rgb . b , rgb . g ) ) ; vec4 q = mix ( vec4 ( p . xyw , rgb . r ) , vec4 ( rgb . r , p . yzx ) , step ( p . x , rgb . r ) ) ; float aH = q . x - min ( q . w , q . y ) ; float dE = 1.0e-10 ; return vec3 ( abs ( q . z + ( q . w - q . y ) / ( 6.0 * aH + dE ) ) , aH / ( q . x + dE ) , q . x ) ; } vec3 dH ( vec3 dG ) { vec4 dD = vec4 ( yr , 2.0 / 3.0 , yr / 3.0 , 3.0 ) ; vec3 p = abs ( fract ( vec3 ( dG . r , dG . r , dG . r ) + dD . xyz ) * 6.0 - dD . www ) ; return dG . b * mix ( dD . xxx , clamp ( p - dD . xxx , yq , yr ) , dG . g ) ; } vec3 yv ( vec3 ys , vec3 yt , float yu ) { return mix ( ys , yt , yu ) ; } vec3 yA ( vec3 ys , vec3 yt , float yu ) { return yu * ys + yt ; } vec3 yB ( vec3 ys , vec3 yt , float yu ) { return yt - yu * ys ; } vec3 yC ( vec3 ys , vec3 yt , float yu ) { float lP = yr - yu ; return ( vec3 ( lP ) + yu * ys ) * yt ; } vec3 yD ( vec3 ys , vec3 yt , float yu ) { vec3 lP = vec3 ( yr - yu ) ; return vec3 ( yr ) - ( lP + yu * ( vec3 ( yr ) - ys ) ) * ( vec3 ( yr ) - yt ) ; } vec3 yE ( vec3 ys , vec3 yt , float yu ) { vec3 lP = vec3 ( yr - yu ) ; return mix ( yt * ( lP + 2.0 * yu * ys ) , vec3 ( yr ) - ( lP + 2.0 * yu * ( vec3 ( yr ) - ys ) ) * ( vec3 ( yr ) - yt ) , step ( 0.5 , yt ) ) ; } vec3 yF ( vec3 ys , vec3 yt , float yu ) { return mix ( yt , abs ( ys - yt ) , yu ) ; } vec3 yG ( vec3 ys , vec3 yt , float yu ) { return mix ( yt , yt / ( ys + step ( ys , vec3 ( yq ) ) ) , yu ) ; } vec3 yH ( vec3 ys , vec3 yt , float yu ) { return mix ( yt , min ( ys , yt ) , yu ) ; } vec3 yI ( vec3 ys , vec3 yt , float yu ) { return max ( yu * ys , yt ) ; } vec3 yM ( vec3 ys , vec3 yt , float yu ) { vec3 yJ = dF ( yt ) ; if ( yJ . y != yq ) { vec3 yK = dF ( ys ) ; vec3 yL = dH ( vec3 ( yJ . x , yK . yz ) ) ; return mix ( ys , yL , yu ) ; } return ys ; } vec3 yN ( vec3 ys , vec3 yt , float yu ) { vec3 yJ = dF ( ys ) ; if ( yJ . y != yq ) { vec3 yK = dF ( yt ) ; return dH ( vec3 ( yJ . x , mix ( yJ . y , yK . y , yu ) , yJ . z ) ) ; } return ys ; } vec3 yO ( vec3 ys , vec3 yt , float yu ) { vec3 yJ = dF ( ys ) ; vec3 yK = dF ( yt ) ; return dH ( vec3 ( yJ . xy , mix ( yJ . z , yK . z , yu ) ) ) ; } vec3 yP ( vec3 ys , vec3 yt , float yu ) { vec3 yJ = dF ( yt ) ; if ( yJ . y != yq ) { vec3 yK = dF ( ys ) ; vec3 yL = dH ( vec3 ( yJ . xy , yK . z ) ) ; return mix ( ys , yL , yu ) ; } return ys ; } vec3 yR ( vec3 ys , vec3 yt , float yu ) { vec3 yQ = vec3 ( yr ) - ( vec3 ( yr ) - yt ) * ( vec3 ( yr ) - ys ) ; return mix ( ys , ( ( vec3 ( yr ) - ys ) * yt * ys ) + ys * yQ , yu ) ; } vec3 yS ( vec3 ys , vec3 yt , float yu ) { return ys + yu * ( 2.0 * yt - yr ) ; } float yW ( float yT , float yU , float yu , float yV ) { float lP = yr - yV ; return ( lP + yu * yT ) * yU ; } float yX ( float yT , float yU , float yu , float yV ) { float lP = yr - yV ; return yr - ( lP + yu * ( yr - yT ) ) * ( yr - yU ) ; } float yY ( float yT , float yU , float yu , float yV ) { float lP = yr - yV ; return mix ( yU * ( lP + 2.0 * yu * yT ) , yr - ( lP + 2.0 * yu * ( yr - yT ) ) * ( yr - yU ) , step ( 0.5 , yU ) ) ; }".split(" ")}]};
a["include/fxaa.glslf"]={a:"grp",c:[{a:"cond",c:[{a:"ifndef",d:"FXAA_PS3",h:{a:"grp",c:[{a:"define",d:"FXAA_PS3",b:["0"]}]}}]},{a:"cond",c:[{a:"ifndef",d:"FXAA_360",h:{a:"grp",c:[{a:"define",d:"FXAA_360",b:["0"]}]}}]},{a:"cond",c:[{a:"ifndef",d:"FXAA_360_OPT",h:{a:"grp",c:[{a:"define",d:"FXAA_360_OPT",b:["0"]}]}}]},{a:"cond",c:[{a:"ifndef",d:"FXAA_PC",h:{a:"grp",c:[{a:"define",d:"FXAA_PC",b:["0"]}]}}]},{a:"cond",c:[{a:"ifndef",d:"FXAA_PC_CONSOLE",h:{a:"grp",c:[{a:"define",d:"FXAA_PC_CONSOLE",b:["0"]}]}}]},
{a:"cond",c:[{a:"ifndef",d:"FXAA_GLSL_120",h:{a:"grp",c:[{a:"define",d:"FXAA_GLSL_120",b:["0"]}]}}]},{a:"cond",c:[{a:"ifndef",d:"FXAA_GLSL_130",h:{a:"grp",c:[{a:"define",d:"FXAA_GLSL_130",b:["0"]}]}}]},{a:"cond",c:[{a:"ifndef",d:"FXAA_HLSL_3",h:{a:"grp",c:[{a:"define",d:"FXAA_HLSL_3",b:["0"]}]}}]},{a:"cond",c:[{a:"ifndef",d:"FXAA_HLSL_4",h:{a:"grp",c:[{a:"define",d:"FXAA_HLSL_4",b:["0"]}]}}]},{a:"cond",c:[{a:"ifndef",d:"FXAA_HLSL_5",h:{a:"grp",c:[{a:"define",d:"FXAA_HLSL_5",b:["0"]}]}}]},{a:"cond",
c:[{a:"ifndef",d:"FXAA_GREEN_AS_LUMA",h:{a:"grp",c:[{a:"define",d:"FXAA_GREEN_AS_LUMA",b:["0"]}]}}]},{a:"cond",c:[{a:"ifndef",d:"FXAA_EARLY_EXIT",h:{a:"grp",c:[{a:"define",d:"FXAA_EARLY_EXIT",b:["1"]}]}}]},{a:"cond",c:[{a:"ifndef",d:"FXAA_DISCARD",h:{a:"grp",c:[{a:"define",d:"FXAA_DISCARD",b:["0"]}]}}]},{a:"cond",c:[{a:"ifndef",d:"FXAA_FAST_PIXEL_OFFSET",h:{a:"grp",c:[{a:"cond",c:[{a:"ifdef",d:"GL_EXT_gpu_shader4",h:{a:"grp",c:[{a:"define",d:"FXAA_FAST_PIXEL_OFFSET",b:["1"]}]}}]},{a:"cond",c:[{a:"ifdef",
d:"GL_NV_gpu_shader5",h:{a:"grp",c:[{a:"define",d:"FXAA_FAST_PIXEL_OFFSET",b:["1"]}]}}]},{a:"cond",c:[{a:"ifdef",d:"GL_ARB_gpu_shader5",h:{a:"grp",c:[{a:"define",d:"FXAA_FAST_PIXEL_OFFSET",b:["1"]}]}}]},{a:"cond",c:[{a:"ifndef",d:"FXAA_FAST_PIXEL_OFFSET",h:{a:"grp",c:[{a:"define",d:"FXAA_FAST_PIXEL_OFFSET",b:["0"]}]}}]}]}}]},{a:"cond",c:[{a:"ifndef",d:"FXAA_GATHER4_ALPHA",h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:["FXAA_HLSL_5",1,{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"define",d:"FXAA_GATHER4_ALPHA",b:["1"]}]}}]},
{a:"cond",c:[{a:"ifdef",d:"GL_ARB_gpu_shader5",h:{a:"grp",c:[{a:"define",d:"FXAA_GATHER4_ALPHA",b:["1"]}]}}]},{a:"cond",c:[{a:"ifdef",d:"GL_NV_gpu_shader5",h:{a:"grp",c:[{a:"define",d:"FXAA_GATHER4_ALPHA",b:["1"]}]}}]},{a:"cond",c:[{a:"ifndef",d:"FXAA_GATHER4_ALPHA",h:{a:"grp",c:[{a:"define",d:"FXAA_GATHER4_ALPHA",b:["0"]}]}}]}]}}]},{a:"cond",c:[{a:"ifndef",d:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:[1],h:{a:"grp",c:[{a:"define",d:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",b:["8.0"]}]}}]},
{a:"cond",c:[{a:"if",e:[0],h:{a:"grp",c:[{a:"define",d:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",b:["4.0"]}]}}]},{a:"cond",c:[{a:"if",e:[0],h:{a:"grp",c:[{a:"define",d:"FXAA_CONSOLE_PS3_EDGE_SHARPNESS",b:["2.0"]}]}}]}]}}]},{a:"cond",c:[{a:"ifndef",d:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",h:{a:"grp",c:[{a:"cond",c:[{a:"if",e:[1],h:{a:"grp",c:[{a:"define",d:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",b:["0.125"]}]}},{a:"else",h:{a:"grp",c:[{a:"define",d:"FXAA_CONSOLE_PS3_EDGE_THRESHOLD",b:["0.25"]}]}}]}]}}]},{a:"cond",c:[{a:"ifndef",
d:"FXAA_QUALITY_PRESET",h:{a:"grp",c:[{a:"define",d:"FXAA_QUALITY_PRESET",b:["12"]}]}}]},{a:"cond",c:[{a:"if",e:["FXAA_QUALITY_PRESET",10,{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"define",d:"FXAA_QUALITY_PS",b:["3"]},{a:"define",d:"FXAA_QUALITY_P0",b:["1.5"]},{a:"define",d:"FXAA_QUALITY_P1",b:["3.0"]},{a:"define",d:"FXAA_QUALITY_P2",b:["12.0"]}]}}]},{a:"cond",c:[{a:"if",e:["FXAA_QUALITY_PRESET",11,{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"define",d:"FXAA_QUALITY_PS",b:["4"]},{a:"define",d:"FXAA_QUALITY_P0",
b:["1.0"]},{a:"define",d:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",d:"FXAA_QUALITY_P2",b:["3.0"]},{a:"define",d:"FXAA_QUALITY_P3",b:["12.0"]}]}}]},{a:"cond",c:[{a:"if",e:["FXAA_QUALITY_PRESET",12,{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"define",d:"FXAA_QUALITY_PS",b:["5"]},{a:"define",d:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",d:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",d:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",d:"FXAA_QUALITY_P3",b:["4.0"]},{a:"define",d:"FXAA_QUALITY_P4",b:["12.0"]}]}}]},{a:"cond",
c:[{a:"if",e:["FXAA_QUALITY_PRESET",13,{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"define",d:"FXAA_QUALITY_PS",b:["6"]},{a:"define",d:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",d:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",d:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",d:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",d:"FXAA_QUALITY_P4",b:["4.0"]},{a:"define",d:"FXAA_QUALITY_P5",b:["12.0"]}]}}]},{a:"cond",c:[{a:"if",e:["FXAA_QUALITY_PRESET",14,{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"define",d:"FXAA_QUALITY_PS",b:["7"]},
{a:"define",d:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",d:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",d:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",d:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",d:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",d:"FXAA_QUALITY_P5",b:["4.0"]},{a:"define",d:"FXAA_QUALITY_P6",b:["12.0"]}]}}]},{a:"cond",c:[{a:"if",e:["FXAA_QUALITY_PRESET",15,{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"define",d:"FXAA_QUALITY_PS",b:["8"]},{a:"define",d:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",d:"FXAA_QUALITY_P1",
b:["1.5"]},{a:"define",d:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",d:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",d:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",d:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",d:"FXAA_QUALITY_P6",b:["4.0"]},{a:"define",d:"FXAA_QUALITY_P7",b:["12.0"]}]}}]},{a:"cond",c:[{a:"if",e:["FXAA_QUALITY_PRESET",20,{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"define",d:"FXAA_QUALITY_PS",b:["3"]},{a:"define",d:"FXAA_QUALITY_P0",b:["1.5"]},{a:"define",d:"FXAA_QUALITY_P1",b:["2.0"]},{a:"define",d:"FXAA_QUALITY_P2",
b:["8.0"]}]}}]},{a:"cond",c:[{a:"if",e:["FXAA_QUALITY_PRESET",21,{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"define",d:"FXAA_QUALITY_PS",b:["4"]},{a:"define",d:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",d:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",d:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",d:"FXAA_QUALITY_P3",b:["8.0"]}]}}]},{a:"cond",c:[{a:"if",e:["FXAA_QUALITY_PRESET",22,{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"define",d:"FXAA_QUALITY_PS",b:["5"]},{a:"define",d:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",d:"FXAA_QUALITY_P1",
b:["1.5"]},{a:"define",d:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",d:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",d:"FXAA_QUALITY_P4",b:["8.0"]}]}}]},{a:"cond",c:[{a:"if",e:["FXAA_QUALITY_PRESET",23,{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"define",d:"FXAA_QUALITY_PS",b:["6"]},{a:"define",d:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",d:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",d:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",d:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",d:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",d:"FXAA_QUALITY_P5",
b:["8.0"]}]}}]},{a:"cond",c:[{a:"if",e:["FXAA_QUALITY_PRESET",24,{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"define",d:"FXAA_QUALITY_PS",b:["7"]},{a:"define",d:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",d:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",d:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",d:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",d:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",d:"FXAA_QUALITY_P5",b:["3.0"]},{a:"define",d:"FXAA_QUALITY_P6",b:["8.0"]}]}}]},{a:"cond",c:[{a:"if",e:["FXAA_QUALITY_PRESET",25,{a:"equal_expr",
i:2}],h:{a:"grp",c:[{a:"define",d:"FXAA_QUALITY_PS",b:["8"]},{a:"define",d:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",d:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",d:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",d:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",d:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",d:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",d:"FXAA_QUALITY_P6",b:["4.0"]},{a:"define",d:"FXAA_QUALITY_P7",b:["8.0"]}]}}]},{a:"cond",c:[{a:"if",e:["FXAA_QUALITY_PRESET",26,{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"define",
d:"FXAA_QUALITY_PS",b:["9"]},{a:"define",d:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",d:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",d:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",d:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",d:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",d:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",d:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",d:"FXAA_QUALITY_P7",b:["4.0"]},{a:"define",d:"FXAA_QUALITY_P8",b:["8.0"]}]}}]},{a:"cond",c:[{a:"if",e:["FXAA_QUALITY_PRESET",27,{a:"equal_expr",i:2}],h:{a:"grp",
c:[{a:"define",d:"FXAA_QUALITY_PS",b:["10"]},{a:"define",d:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",d:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",d:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",d:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",d:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",d:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",d:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",d:"FXAA_QUALITY_P7",b:["2.0"]},{a:"define",d:"FXAA_QUALITY_P8",b:["4.0"]},{a:"define",d:"FXAA_QUALITY_P9",b:["8.0"]}]}}]},{a:"cond",c:[{a:"if",
e:["FXAA_QUALITY_PRESET",28,{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"define",d:"FXAA_QUALITY_PS",b:["11"]},{a:"define",d:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",d:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",d:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",d:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",d:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",d:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",d:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",d:"FXAA_QUALITY_P7",b:["2.0"]},{a:"define",d:"FXAA_QUALITY_P8",b:["2.0"]},{a:"define",
d:"FXAA_QUALITY_P9",b:["4.0"]},{a:"define",d:"FXAA_QUALITY_P10",b:["8.0"]}]}}]},{a:"cond",c:[{a:"if",e:["FXAA_QUALITY_PRESET",29,{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"define",d:"FXAA_QUALITY_PS",b:["12"]},{a:"define",d:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",d:"FXAA_QUALITY_P1",b:["1.5"]},{a:"define",d:"FXAA_QUALITY_P2",b:["2.0"]},{a:"define",d:"FXAA_QUALITY_P3",b:["2.0"]},{a:"define",d:"FXAA_QUALITY_P4",b:["2.0"]},{a:"define",d:"FXAA_QUALITY_P5",b:["2.0"]},{a:"define",d:"FXAA_QUALITY_P6",b:["2.0"]},
{a:"define",d:"FXAA_QUALITY_P7",b:["2.0"]},{a:"define",d:"FXAA_QUALITY_P8",b:["2.0"]},{a:"define",d:"FXAA_QUALITY_P9",b:["2.0"]},{a:"define",d:"FXAA_QUALITY_P10",b:["4.0"]},{a:"define",d:"FXAA_QUALITY_P11",b:["8.0"]}]}}]},{a:"cond",c:[{a:"if",e:["FXAA_QUALITY_PRESET",39,{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"define",d:"FXAA_QUALITY_PS",b:["12"]},{a:"define",d:"FXAA_QUALITY_P0",b:["1.0"]},{a:"define",d:"FXAA_QUALITY_P1",b:["1.0"]},{a:"define",d:"FXAA_QUALITY_P2",b:["1.0"]},{a:"define",d:"FXAA_QUALITY_P3",
b:["1.0"]},{a:"define",d:"FXAA_QUALITY_P4",b:["1.0"]},{a:"define",d:"FXAA_QUALITY_P5",b:["1.5"]},{a:"define",d:"FXAA_QUALITY_P6",b:["2.0"]},{a:"define",d:"FXAA_QUALITY_P7",b:["2.0"]},{a:"define",d:"FXAA_QUALITY_P8",b:["2.0"]},{a:"define",d:"FXAA_QUALITY_P9",b:["2.0"]},{a:"define",d:"FXAA_QUALITY_P10",b:["4.0"]},{a:"define",d:"FXAA_QUALITY_P11",b:["8.0"]}]}}]},{a:"txt",b:"float AF ( float x ) { return clamp ( x , 0.0 , 1.0 ) ; }".split(" ")},{a:"cond",c:[{a:"if",e:["FXAA_BLEND4WEB",1,{a:"equal_expr",
i:2}],h:{a:"grp",c:[{a:"txt",b:"vec4 AG ( sampler2D t , vec2 p ) { return GLSL_TEXTURE ( t , p ) ; } vec4 AI ( sampler2D t , vec2 p , vec2 AH , vec2 r ) { return GLSL_TEXTURE ( t , p + ( AH * r ) ) ; }".split(" ")}]}}]},{a:"txt",b:"vec4 Cl ( vec2 rT , sampler2D AJ , vec2 AK , float AL , float AM , float AN ) { vec2 AO ; AO . x = rT . x ; AO . y = rT . y ;".split(" ")},{a:"cond",c:[{a:"if",e:["FXAA_GATHER4_ALPHA",1,{a:"equal_expr",i:2}],h:{a:"grp",c:[]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"vec4 AP = AG ( AJ , AO ) ; float As = bk ( AP ) ; float AQ = bk ( AI ( AJ , AO , vec2 ( 0 , 1 ) , AK . xy ) ) ; float AR = bk ( AI ( AJ , AO , vec2 ( 1 , 0 ) , AK . xy ) ) ; float AS = bk ( AI ( AJ , AO , vec2 ( 0 , - 1 ) , AK . xy ) ) ; float AT = bk ( AI ( AJ , AO , vec2 ( - 1 , 0 ) , AK . xy ) ) ;".split(" ")}]}}]},
{a:"txt",b:"float AU = max ( AQ , As ) ; float AV = min ( AQ , As ) ; float AW = max ( AR , AU ) ; float AX = min ( AR , AV ) ; float AY = max ( AS , AT ) ; float AZ = min ( AS , AT ) ; float A_ = max ( AY , AW ) ; float Ba = min ( AZ , AX ) ; float Bb = A_ * AM ; float Bc = A_ - Ba ; float Bd = max ( AN , Bb ) ; bool Be = Bc < Bd ; if ( Be ) return AP ;".split(" ")},{a:"cond",c:[{a:"if",e:["FXAA_GATHER4_ALPHA",0,{a:"equal_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"float At = bk ( AI ( AJ , AO , vec2 ( - 1 , - 1 ) , AK . xy ) ) ; float Aw = bk ( AI ( AJ , AO , vec2 ( 1 , 1 ) , AK . xy ) ) ; float Au = bk ( AI ( AJ , AO , vec2 ( 1 , - 1 ) , AK . xy ) ) ; float Av = bk ( AI ( AJ , AO , vec2 ( - 1 , 1 ) , AK . xy ) ) ;".split(" ")}]}},
{a:"else",h:{a:"grp",c:[]}}]},{a:"txt",b:"float Bf = AS + AQ ; float Bg = AT + AR ; float Bh = 1.0 / Bc ; float Bi = Bf + Bg ; float Bj = ( - 2.0 * As ) + Bf ; float Bk = ( - 2.0 * As ) + Bg ; float Bl = Au + Aw ; float Bm = At + Au ; float Bn = ( - 2.0 * AR ) + Bl ; float Bo = ( - 2.0 * AS ) + Bm ; float Bp = At + Av ; float Bq = Av + Aw ; float Br = ( abs ( Bj ) * 2.0 ) + abs ( Bn ) ; float Bs = ( abs ( Bk ) * 2.0 ) + abs ( Bo ) ; float Bt = ( - 2.0 * AT ) + Bp ; float Bu = ( - 2.0 * AQ ) + Bq ; float Bv = abs ( Bt ) + Br ; float Bw = abs ( Bu ) + Bs ; float Bx = Bp + Bl ; float By = AK . x ; bool Bz = Bv >= Bw ; float BA = Bi * 2.0 + Bx ; if ( ! Bz ) AS = AT ; if ( ! Bz ) AQ = AR ; if ( Bz ) By = AK . y ; float BB = ( BA * ( 1.0 / 12.0 ) ) - As ; float BC = AS - As ; float BD = AQ - As ; float BE = AS + As ; float BF = AQ + As ; bool BG = abs ( BC ) >= abs ( BD ) ; float BH = max ( abs ( BC ) , abs ( BD ) ) ; if ( BG ) By = - By ; float BI = AF ( abs ( BB ) * Bh ) ; vec2 BJ ; BJ . x = AO . x ; BJ . y = AO . y ; vec2 BK ; BK . x = ( ! Bz ) ? 0.0 : AK . x ; BK . y = ( Bz ) ? 0.0 : AK . y ; if ( ! Bz ) BJ . x += By * 0.5 ; if ( Bz ) BJ . y += By * 0.5 ; vec2 BL ; BL . x = BJ . x - BK . x * FXAA_QUALITY_P0 ; BL . y = BJ . y - BK . y * FXAA_QUALITY_P0 ; vec2 BM ; BM . x = BJ . x + BK . x * FXAA_QUALITY_P0 ; BM . y = BJ . y + BK . y * FXAA_QUALITY_P0 ; float BN = ( ( - 2.0 ) * BI ) + 3.0 ; float BO = bk ( AG ( AJ , BL ) ) ; float BP = BI * BI ; float BQ = bk ( AG ( AJ , BM ) ) ; if ( ! BG ) BE = BF ; float BR = BH * 1.0 / 4.0 ; float BS = As - BE * 0.5 ; float BT = BN * BP ; bool BU = BS < 0.0 ; BO -= BE * 0.5 ; BQ -= BE * 0.5 ; bool BV = abs ( BO ) >= BR ; bool BW = abs ( BQ ) >= BR ; if ( ! BV ) BL . x -= BK . x * FXAA_QUALITY_P1 ; if ( ! BV ) BL . y -= BK . y * FXAA_QUALITY_P1 ; bool BX = ( ! BV ) || ( ! BW ) ; if ( ! BW ) BM . x += BK . x * FXAA_QUALITY_P1 ; if ( ! BW ) BM . y += BK . y * FXAA_QUALITY_P1 ; if ( BX ) { if ( ! BV ) BO = bk ( AG ( AJ , BL . xy ) ) ; if ( ! BW ) BQ = bk ( AG ( AJ , BM . xy ) ) ; if ( ! BV ) BO = BO - BE * 0.5 ; if ( ! BW ) BQ = BQ - BE * 0.5 ; BV = abs ( BO ) >= BR ; BW = abs ( BQ ) >= BR ; if ( ! BV ) BL . x -= BK . x * FXAA_QUALITY_P2 ; if ( ! BV ) BL . y -= BK . y * FXAA_QUALITY_P2 ; BX = ( ! BV ) || ( ! BW ) ; if ( ! BW ) BM . x += BK . x * FXAA_QUALITY_P2 ; if ( ! BW ) BM . y += BK . y * FXAA_QUALITY_P2 ;".split(" ")},
{a:"cond",c:[{a:"if",e:["FXAA_QUALITY_PS",3,{a:"g_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"if ( BX ) { if ( ! BV ) BO = bk ( AG ( AJ , BL . xy ) ) ; if ( ! BW ) BQ = bk ( AG ( AJ , BM . xy ) ) ; if ( ! BV ) BO = BO - BE * 0.5 ; if ( ! BW ) BQ = BQ - BE * 0.5 ; BV = abs ( BO ) >= BR ; BW = abs ( BQ ) >= BR ; if ( ! BV ) BL . x -= BK . x * FXAA_QUALITY_P3 ; if ( ! BV ) BL . y -= BK . y * FXAA_QUALITY_P3 ; BX = ( ! BV ) || ( ! BW ) ; if ( ! BW ) BM . x += BK . x * FXAA_QUALITY_P3 ; if ( ! BW ) BM . y += BK . y * FXAA_QUALITY_P3 ;".split(" ")},
{a:"cond",c:[{a:"if",e:["FXAA_QUALITY_PS",4,{a:"g_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"if ( BX ) { if ( ! BV ) BO = bk ( AG ( AJ , BL . xy ) ) ; if ( ! BW ) BQ = bk ( AG ( AJ , BM . xy ) ) ; if ( ! BV ) BO = BO - BE * 0.5 ; if ( ! BW ) BQ = BQ - BE * 0.5 ; BV = abs ( BO ) >= BR ; BW = abs ( BQ ) >= BR ; if ( ! BV ) BL . x -= BK . x * FXAA_QUALITY_P4 ; if ( ! BV ) BL . y -= BK . y * FXAA_QUALITY_P4 ; BX = ( ! BV ) || ( ! BW ) ; if ( ! BW ) BM . x += BK . x * FXAA_QUALITY_P4 ; if ( ! BW ) BM . y += BK . y * FXAA_QUALITY_P4 ;".split(" ")},
{a:"cond",c:[{a:"if",e:["FXAA_QUALITY_PS",5,{a:"g_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"if ( BX ) { if ( ! BV ) BO = bk ( AG ( AJ , BL . xy ) ) ; if ( ! BW ) BQ = bk ( AG ( AJ , BM . xy ) ) ; if ( ! BV ) BO = BO - BE * 0.5 ; if ( ! BW ) BQ = BQ - BE * 0.5 ; BV = abs ( BO ) >= BR ; BW = abs ( BQ ) >= BR ; if ( ! BV ) BL . x -= BK . x * FXAA_QUALITY_P5 ; if ( ! BV ) BL . y -= BK . y * FXAA_QUALITY_P5 ; BX = ( ! BV ) || ( ! BW ) ; if ( ! BW ) BM . x += BK . x * FXAA_QUALITY_P5 ; if ( ! BW ) BM . y += BK . y * FXAA_QUALITY_P5 ;".split(" ")},
{a:"cond",c:[{a:"if",e:["FXAA_QUALITY_PS",6,{a:"g_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"if ( BX ) { if ( ! BV ) BO = bk ( AG ( AJ , BL . xy ) ) ; if ( ! BW ) BQ = bk ( AG ( AJ , BM . xy ) ) ; if ( ! BV ) BO = BO - BE * 0.5 ; if ( ! BW ) BQ = BQ - BE * 0.5 ; BV = abs ( BO ) >= BR ; BW = abs ( BQ ) >= BR ; if ( ! BV ) BL . x -= BK . x * FXAA_QUALITY_P6 ; if ( ! BV ) BL . y -= BK . y * FXAA_QUALITY_P6 ; BX = ( ! BV ) || ( ! BW ) ; if ( ! BW ) BM . x += BK . x * FXAA_QUALITY_P6 ; if ( ! BW ) BM . y += BK . y * FXAA_QUALITY_P6 ;".split(" ")},
{a:"cond",c:[{a:"if",e:["FXAA_QUALITY_PS",7,{a:"g_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"if ( BX ) { if ( ! BV ) BO = bk ( AG ( AJ , BL . xy ) ) ; if ( ! BW ) BQ = bk ( AG ( AJ , BM . xy ) ) ; if ( ! BV ) BO = BO - BE * 0.5 ; if ( ! BW ) BQ = BQ - BE * 0.5 ; BV = abs ( BO ) >= BR ; BW = abs ( BQ ) >= BR ; if ( ! BV ) BL . x -= BK . x * FXAA_QUALITY_P7 ; if ( ! BV ) BL . y -= BK . y * FXAA_QUALITY_P7 ; BX = ( ! BV ) || ( ! BW ) ; if ( ! BW ) BM . x += BK . x * FXAA_QUALITY_P7 ; if ( ! BW ) BM . y += BK . y * FXAA_QUALITY_P7 ;".split(" ")},
{a:"cond",c:[{a:"if",e:["FXAA_QUALITY_PS",8,{a:"g_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"if ( BX ) { if ( ! BV ) BO = bk ( AG ( AJ , BL . xy ) ) ; if ( ! BW ) BQ = bk ( AG ( AJ , BM . xy ) ) ; if ( ! BV ) BO = BO - BE * 0.5 ; if ( ! BW ) BQ = BQ - BE * 0.5 ; BV = abs ( BO ) >= BR ; BW = abs ( BQ ) >= BR ; if ( ! BV ) BL . x -= BK . x * FXAA_QUALITY_P8 ; if ( ! BV ) BL . y -= BK . y * FXAA_QUALITY_P8 ; BX = ( ! BV ) || ( ! BW ) ; if ( ! BW ) BM . x += BK . x * FXAA_QUALITY_P8 ; if ( ! BW ) BM . y += BK . y * FXAA_QUALITY_P8 ;".split(" ")},
{a:"cond",c:[{a:"if",e:["FXAA_QUALITY_PS",9,{a:"g_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"if ( BX ) { if ( ! BV ) BO = bk ( AG ( AJ , BL . xy ) ) ; if ( ! BW ) BQ = bk ( AG ( AJ , BM . xy ) ) ; if ( ! BV ) BO = BO - BE * 0.5 ; if ( ! BW ) BQ = BQ - BE * 0.5 ; BV = abs ( BO ) >= BR ; BW = abs ( BQ ) >= BR ; if ( ! BV ) BL . x -= BK . x * FXAA_QUALITY_P9 ; if ( ! BV ) BL . y -= BK . y * FXAA_QUALITY_P9 ; BX = ( ! BV ) || ( ! BW ) ; if ( ! BW ) BM . x += BK . x * FXAA_QUALITY_P9 ; if ( ! BW ) BM . y += BK . y * FXAA_QUALITY_P9 ;".split(" ")},
{a:"cond",c:[{a:"if",e:["FXAA_QUALITY_PS",10,{a:"g_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"if ( BX ) { if ( ! BV ) BO = bk ( AG ( AJ , BL . xy ) ) ; if ( ! BW ) BQ = bk ( AG ( AJ , BM . xy ) ) ; if ( ! BV ) BO = BO - BE * 0.5 ; if ( ! BW ) BQ = BQ - BE * 0.5 ; BV = abs ( BO ) >= BR ; BW = abs ( BQ ) >= BR ; if ( ! BV ) BL . x -= BK . x * FXAA_QUALITY_P10 ; if ( ! BV ) BL . y -= BK . y * FXAA_QUALITY_P10 ; BX = ( ! BV ) || ( ! BW ) ; if ( ! BW ) BM . x += BK . x * FXAA_QUALITY_P10 ; if ( ! BW ) BM . y += BK . y * FXAA_QUALITY_P10 ;".split(" ")},
{a:"cond",c:[{a:"if",e:["FXAA_QUALITY_PS",11,{a:"g_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"if ( BX ) { if ( ! BV ) BO = bk ( AG ( AJ , BL . xy ) ) ; if ( ! BW ) BQ = bk ( AG ( AJ , BM . xy ) ) ; if ( ! BV ) BO = BO - BE * 0.5 ; if ( ! BW ) BQ = BQ - BE * 0.5 ; BV = abs ( BO ) >= BR ; BW = abs ( BQ ) >= BR ; if ( ! BV ) BL . x -= BK . x * FXAA_QUALITY_P11 ; if ( ! BV ) BL . y -= BK . y * FXAA_QUALITY_P11 ; BX = ( ! BV ) || ( ! BW ) ; if ( ! BW ) BM . x += BK . x * FXAA_QUALITY_P11 ; if ( ! BW ) BM . y += BK . y * FXAA_QUALITY_P11 ;".split(" ")},
{a:"cond",c:[{a:"if",e:["FXAA_QUALITY_PS",12,{a:"g_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"if ( BX ) { if ( ! BV ) BO = bk ( AG ( AJ , BL . xy ) ) ; if ( ! BW ) BQ = bk ( AG ( AJ , BM . xy ) ) ; if ( ! BV ) BO = BO - BE * 0.5 ; if ( ! BW ) BQ = BQ - BE * 0.5 ; BV = abs ( BO ) >= BR ; BW = abs ( BQ ) >= BR ; if ( ! BV ) BL . x -= BK . x * FXAA_QUALITY_P12 ; if ( ! BV ) BL . y -= BK . y * FXAA_QUALITY_P12 ; BX = ( ! BV ) || ( ! BW ) ; if ( ! BW ) BM . x += BK . x * FXAA_QUALITY_P12 ; if ( ! BW ) BM . y += BK . y * FXAA_QUALITY_P12 ; }".split(" ")}]}}]},
{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:["}"]}]}}]},{a:"txt",b:"} float BY = AO . x - BL . x ; float BZ = BM . x - AO . x ; if ( ! Bz ) BY = AO . y - BL . y ; if ( ! Bz ) BZ = BM . y - AO . y ; bool B_ = ( BO < 0.0 ) != BU ; float Ca = ( BZ + BY ) ; bool Cb = ( BQ < 0.0 ) != BU ; float Cc = 1.0 / Ca ; bool Cd = BY < BZ ; float Ce = min ( BY , BZ ) ; bool Cf = Cd ? B_ : Cb ; float Cg = BT * BT ; float Ch = ( Ce * ( - Cc ) ) + 0.5 ; float Ci = Cg * AL ; float Cj = Cf ? Ch : 0.0 ; float Ck = max ( Cj , Ci ) ; if ( ! Bz ) AO . x += Ck * By ; if ( Bz ) AO . y += Ck * By ;".split(" ")},
{a:"cond",c:[{a:"if",e:["FXAA_DISCARD",1,{a:"equal_expr",i:2},"FXAA_BLEND4WEB",1,{a:"equal_expr",i:2},{a:"logical_or_expr",i:2}],h:{a:"grp",c:[{a:"txt",b:"return AG ( AJ , AO ) ;".split(" ")}]}},{a:"else",h:{a:"grp",c:[{a:"txt",b:"return vec4 ( AG ( AJ , AO ) . xyz , As ) ;".split(" ")}]}}]},{a:"txt",b:["}"]}]};a["include/depth_fetch.glslf"]={a:"grp",c:[{a:"txt",b:"float Cu ( in sampler2D Cq , in vec2 aY , in vec2 Cr ) { float ao = GLSL_TEXTURE ( Cq , aY ) . r ; float xU = Cr . x ; float Cs = Cr . y ; float Ct = 2.0 * xU / ( xU + Cs - ( 2.0 * ao - 1.0 ) * ( Cs - xU ) ) ; return Ct ; }".split(" ")}]}};b4w.module.animation=function(a,p){var e=p("__animation"),c=p("__armature"),b=p("__obj_util"),n=p("__print"),h=p("__tsr");a.SLOT_0=e.SLOT_0;a.SLOT_1=e.SLOT_1;a.SLOT_2=e.SLOT_2;a.SLOT_3=e.SLOT_3;a.SLOT_4=e.SLOT_4;a.SLOT_5=e.SLOT_5;a.SLOT_6=e.SLOT_6;a.SLOT_7=e.SLOT_7;a.SLOT_ALL=e.SLOT_ALL;a.OBJ_ANIM_TYPE_NONE=e.OBJ_ANIM_TYPE_NONE;a.OBJ_ANIM_TYPE_ARMATURE=e.OBJ_ANIM_TYPE_ARMATURE;a.OBJ_ANIM_TYPE_OBJECT=e.OBJ_ANIM_TYPE_OBJECT;a.OBJ_ANIM_TYPE_VERTEX=e.OBJ_ANIM_TYPE_VERTEX;a.OBJ_ANIM_TYPE_SOUND=e.OBJ_ANIM_TYPE_SOUND;
a.OBJ_ANIM_TYPE_PARTICLES=e.OBJ_ANIM_TYPE_PARTICLES;a.OBJ_ANIM_TYPE_MATERIAL=e.OBJ_ANIM_TYPE_MATERIAL;a.AB_CYCLIC=e.AB_CYCLIC;a.AB_FINISH_RESET=e.AB_FINISH_RESET;a.AB_FINISH_STOP=e.AB_FINISH_STOP;var r=h.create();a.is_animated=function(a){return e.is_animated(a)};a.get_anim_names=function(a){return e.bB(a)?e.get_anim_names(a):[]};a.get_current_anim_name=function(a,b){if(!e.is_animated(a))return null;b=b||e.SLOT_0;return e.sJ(a,b)};a.apply=function(a,b,c){if(c>e.SLOT_7)n.error("Can't apply animation to slot "+
c+' for object "'+a.name+'". Object can have maximum of 8 animation slots');else{c=c||e.SLOT_0;if(e.is_animated(a)){var h=e.get_slot_num_by_anim(a,b);if(-1!=h&&h!=c){n.error('Animation "'+b+'" is already applied to object "'+a.name+'" (slot "'+h+'").');return}}e.TC(a,b)?e.apply(a,null,b,c):n.error('No fcurves in action "'+b+'"')}};a.apply_ext=function(a,b,c){if(c>e.SLOT_7)n.error("Can't apply animation to slot "+c+' for object "'+a.name+'". Object can have maximum of 8 animation slots');else{c=c||
e.SLOT_0;var h=b[0];if(e.is_animated(a)){var d=e.get_slot_num_by_anim(a,h);if(-1!=d&&d!=c){n.error('Animation "'+h+'" is already applied to object "'+a.name+'" (slot "'+d+'").');return}}e.TC(a,h)?e.apply(a,b.slice(1),h,c):n.error('No fcurves in action "'+h+'"')}};a.remove=function(a){e.remove(a)};a.remove_slot_animation=function(a,b){e.is_animated(a)&&(b=b||e.SLOT_0,e.remove_slot_animation(a,b))};a.apply_def=function(a){e.apply_def(a)};a.play=function(a,b,c){e.is_animated(a)?(c=c||e.SLOT_0,e.play(a,
b,c),e.eO(a,0,c,!0)):n.error('Object "'+a.name+'" has no applied animation')};a.stop=function(a,b){e.is_animated(a)&&(b=b||e.SLOT_0,e.stop(a,b))};a.is_play=function(a,b){if(!e.is_animated(a))return!1;b=b||e.SLOT_0;return e.is_play(a,b)};a.set_frame=function(a,b,c){e.is_animated(a)&&(c=c||e.SLOT_0,e.set_frame(a,b,c))};a.set_first_frame=function(a,b){e.is_animated(a)&&e.set_first_frame(a,b)};a.set_last_frame=function(a,b){if(e.is_animated(a)){b=b||e.SLOT_0;var c=e.get_anim_start_frame(a,b),h=e.get_anim_length(a,
b);e.set_frame(a,c+h-e.MD,b)}};a.get_frame=function(a,b){if(!e.is_animated(a))return 0;b=b||e.SLOT_0;return e.Mz(a,b)};a.set_speed=function(a,b,c){e.is_animated(a)&&(c=c||e.SLOT_0,e.set_speed(a,b||1,c))};a.get_speed=function(a,b){if(!e.is_animated(a))return 0;b=b||e.SLOT_0;return a.X[b]?e.get_speed(a,b):0};a.get_anim_start_frame=function(a,b){return e.is_animated(a)&&(b=b||e.SLOT_0,a.X[b])?e.get_anim_start_frame(a,b):-1};a.get_anim_length=function(a,b){return e.is_animated(a)&&(b=b||e.SLOT_0,a.X[b])?
e.get_anim_length(a,b):-1};a.set_behavior=function(a,b,c){e.is_animated(a)&&(c=c||e.SLOT_0,e.set_behavior(a,b,c))};a.get_behavior=function(a,b){if(!e.is_animated(a))return null;b=b||e.SLOT_0;return e.get_behavior(a,b)};a.apply_smoothing=function(a,b,c,h){h=h||e.SLOT_0;e.is_animated(a)&&e.apply_smoothing(a,b,c,h)};a.frame_to_sec=function(a){return e.frame_to_sec(a)};a.get_bone_translation=function(a,e,h){n.qb("get_bone_translation","armature.get_bone_tsr");if(!b.is_armature(a))return null;if(!c.wn(a,
e))return n.error('There is no bone: "',e,'" in "',a.name,'".'),null;h||(h=new Float32Array(3));c.get_bone_tsr(a,e,!1,!1,r);h[0]=r[0];h[1]=r[1];h[2]=r[2];return h};a.get_first_armature_object=function(){n.uc("get_first_armature_object() deprecated");return null};a.get_slot_num_by_anim=function(a,b){return e.is_animated(a)&&b?e.get_slot_num_by_anim(a,b):null};a.get_anim_type=function(a,b){return e.is_animated(a)?e.get_anim_type(a,b):null};a.apply_to_first_empty_slot=function(a,b){return e.apply_to_first_empty_slot(a,
b)};a.get_skel_mix_factor=function(a){return a.k.og};a.set_skel_mix_factor=function(a,c,h){b.is_armature(a)?(c=Math.min(Math.max(c,0),1),a.k.og!=c&&e.set_skel_mix_factor(a,c,h||0)):n.error("Can't blend animation. Object \""+a.name+'" is not armature')}};b4w.module.anchors=function(a,p){var e=p("__anchors");p("__print");a.attach_move_cb=e.attach_move_cb;a.detach_move_cb=e.detach_move_cb;a.is_anchor=e.is_anchor;a.get_element_id=e.get_element_id};b4w.module.armature=function(a,p){var e=p("__armature"),c=p("__obj_util"),b=p("__transform"),n=p("__print");a.get_bone_tsr=function(a,b,g){if(!c.is_armature(a))return null;if(!e.wn(a,b))return n.error('There is no bone: "',b,'" in "',a.name,'".'),null;g||(g=new Float32Array(8));e.get_bone_tsr(a,b,!1,!1,g);return g};a.get_bone_tsr_rel=function(a,b,g){if(!c.is_armature(a))return null;if(!e.wn(a,b))return n.error('There is no bone: "',b,'" in "',a.name,'".'),null;g||(g=new Float32Array(8));e.get_bone_tsr(a,
b,!1,!0,g);return g};a.set_bone_tsr=function(a,p,g){c.is_armature(a)&&(e.wn(a,p)?(e.set_bone_tsr(a,p,g,!1),b.u(a)):n.error('There is no bone: "',p,'" in "',a.name,'".'))};a.set_bone_tsr_rel=function(a,p,g){c.is_armature(a)&&(e.wn(a,p)?(e.set_bone_tsr(a,p,g,!0),b.u(a)):n.error('There is no bone: "',p,'" in "',a.name,'".'))}};b4w.module.assets=function(a,p){var e=p("__assets");a.AT_ARRAYBUFFER=e.AT_ARRAYBUFFER;a.AT_JSON=e.AT_JSON;a.AT_TEXT=e.AT_TEXT;a.AT_AUDIOBUFFER=e.AT_AUDIOBUFFER;a.AT_IMAGE_ELEMENT=e.AT_IMAGE_ELEMENT;a.AT_AUDIO_ELEMENT=e.AT_AUDIO_ELEMENT;a.enqueue=function(a,b,n,h){if(a.length)if(a.id)e.enqueue(a,b,n,h);else{for(var p=[],g=0;g<a.length;g++){var m=a[g];p.push({id:m[0],type:m[1],url:m[2],qe:m.qe?m.qe:"GET",Ti:null,Eh:null,Kb:m[3]})}e.enqueue(p,b,n,h)}}};b4w.module.camera=function(a,p){function e(a,b){q.qb("camera.set_pivot","camera.target_set_trans_pivot");c.is_target_camera(a)?(H.copy(b,a.k.pivot),d.u(a),m.sync_transform(a)):q.error("set_pivot(): Wrong object or camera move style")}var c=p("__camera");p("__config");var b=p("__constraints"),n=p("__container"),h=p("__mat4"),r=p("__math"),g=p("__obj_util"),m=p("__physics"),q=p("__print"),B=p("__scenes"),d=p("__transform"),l=p("__tsr"),f=p("__util"),H=p("__vec3"),D=p("__vec4"),w=new Float32Array(2),
E=new Float32Array(3),y=new Float32Array(3),A=new Float32Array(4);new Float32Array(9);var G={},x={};a.MS_STATIC=c.MS_STATIC;a.MS_TARGET_CONTROLS=c.MS_TARGET_CONTROLS;a.MS_EYE_CONTROLS=c.MS_EYE_CONTROLS;a.MS_HOVER_CONTROLS=c.MS_HOVER_CONTROLS;a.static_setup=function(a,b){if(g.is_camera(a)){c.Rs(a);a.k.nb=c.MS_STATIC;if(b){var e=b.pos||l.get_trans_view(a.k.m);b.look_at?c.set_look_at(a,e,b.look_at):d.set_translation(a,e)}d.u(a);m.sync_transform(a);c.po(a)}else q.error("static_setup(): Wrong camera object")};
a.static_set_look_at=function(a,b,e){c.is_static_camera(a)?(b=b||l.get_trans_view(a.k.m),e?c.set_look_at(a,b,e):d.set_translation(a,b),d.u(a),m.sync_transform(a)):q.error("static_set_look_at(): Wrong camera object or camera move style")};a.static_set_rotation=function(a,b){c.is_static_camera(a)?(d.set_rotation(a,b),d.u(a),m.sync_transform(a)):q.error("static_set_rotation(): Wrong camera object or camera move style")};a.static_get_rotation=function(a,b){if(!c.is_static_camera(a))return q.error("static_get_rotation(): Wrong camera object or camera move style"),
null;b=b||new Float32Array(4);return d.get_rotation(a,b)};a.eye_setup=function(a,b){if(g.is_camera(a))if(b&&b.horiz_rot_lim&&("number"!=typeof b.horiz_rot_lim.left||"number"!=typeof b.horiz_rot_lim.right))q.error("eye_setup(): Wrong horizontal limits object.");else if(b&&b.vert_rot_lim&&("number"!=typeof b.vert_rot_lim.down||"number"!=typeof b.vert_rot_lim.up))q.error("eye_setup(): Wrong vertical limits object.");else{c.Rs(a);a.k.nb=c.MS_EYE_CONTROLS;if(b){var e=b.pos||l.get_trans_view(a.k.m);c.UM(a,
e,b.look_at,b.horiz_rot_lim,b.vert_rot_lim)}d.u(a);m.sync_transform(a);c.po(a)}else q.error("eye_setup(): Wrong camera object")};a.eye_set_look_at=function(a,e,f){c.is_eye_camera(a)?(e=e||l.get_trans_view(a.k.m),f?c.FM(a,e,f):d.set_translation(a,e),b.correct_up(a,a.k.xe,!0),d.u(a),m.sync_transform(a)):q.error("eye_set_look_at(): Wrong camera object or camera move style")};a.eye_rotate=function(a,b,e,f,g){c.is_eye_camera(a)?(c.rotate_eye_camera(a,b,e,f||!1,g||!1),d.u(a),m.sync_transform(a)):q.error("eye_rotate(): Wrong camera object or camera move style")};
a.eye_set_vertical_limits=function(a,b){c.is_eye_camera(a)?!b||"number"==typeof b.down&&"number"==typeof b.up?(c.MB(a,b),d.u(a),m.sync_transform(a)):q.error("eye_set_vertical_limits(): Incorrect limits object."):q.error("eye_set_vertical_limits(): Wrong camera object or camera move style")};a.eye_get_vertical_limits=function(a,b,d){if(!c.is_eye_camera(a))return q.error("eye_get_vertical_limits(): Wrong camera object or camera move style"),null;a=a.k;return a.na?(b=b||{},d?(b.down=a.na.xl,b.up=a.na.Im):
(b.down=a.na.down,b.up=a.na.up),b.camera_space=d||!1,b):null};a.eye_set_horizontal_limits=function(a,b){c.is_eye_camera(a)?!b||"number"==typeof b.left&&"number"==typeof b.right?(c.JB(a,b),d.u(a),m.sync_transform(a)):q.error("eye_set_horizontal_limits(): Incorrect limits object."):q.error("eye_set_horizontal_limits(): Wrong camera object or camera move style")};a.eye_get_horizontal_limits=function(a,b,d){if(!c.is_eye_camera(a))return q.error("eye_get_horizontal_limits(): Wrong camera object or camera move style"),
null;a=a.k;return a.eb?(b=b||{},d?(b.left=a.eb.Tl,b.right=a.eb.km):(b.left=a.eb.left,b.right=a.eb.right),b.camera_space=d||!1,b):null};a.target_setup=function(a,b){if(g.is_camera(a))if(!b.horiz_rot_lim||"number"==typeof b.horiz_rot_lim.left&&"number"==typeof b.horiz_rot_lim.right)if(!b.vert_rot_lim||"number"==typeof b.vert_rot_lim.down&&"number"==typeof b.vert_rot_lim.up){if(b.dist_lim){if("number"!=typeof b.dist_lim.min||"number"!=typeof b.dist_lim.max||b.dist_lim.min>b.dist_lim.max){q.error("target_setup(): Wrong distance limits object");
return}b.dist_lim.min=Math.max(b.dist_lim.min,0);b.dist_lim.max=Math.max(b.dist_lim.max,0)}if(b.Ko&&("number"!=typeof b.Ko.min_y||"number"!=typeof b.Ko.max_y||b.Ko.min_y>b.Ko.max_y))q.error("target_setup(): Wrong pivot limits object");else{c.Rs(a);a.k.nb=c.MS_TARGET_CONTROLS;var e=b.pos||l.get_trans_view(a.k.m);c.WM(a,e,b.pivot,b.horiz_rot_lim,b.vert_rot_lim,b.dist_lim,b.Ko,b.use_panning||!1);d.u(a);m.sync_transform(a);c.po(a)}}else q.error("target_setup(): Wrong vertical limits object");else q.error("target_setup(): Wrong horizontal limits object");
else q.error("target_setup(): Wrong camera object")};a.target_rotate=function(a,b,e,f,g){c.is_target_camera(a)?(c.rotate_target_camera(a,b,e,f||!1,g||!1),d.u(a),m.sync_transform(a)):q.error("target_rotate(): Wrong camera object or camera move style")};a.target_set_trans_pivot=function(a,b,e){c.is_target_camera(a)?(b=b||l.get_trans_view(a.k.m),e=e||a.k.pivot,c.set_trans_pivot(a,b,e),d.u(a),m.sync_transform(a)):q.error("target_set_trans_pivot(): Wrong camera object or camera move style")};a.target_set_pivot_translation=
function(a,b){c.is_target_camera(a)?(c.NM(a,b),d.u(a),m.sync_transform(a)):q.error("target_set_pivot_translation(): Wrong camera object or camera move style")};a.target_set_distance=function(a,b){if(c.is_target_camera(a)){var e=d.dm(a,a.k.pivot),f=Math.max(0,b);d.move_local(a,0,f-e,0);d.u(a);m.sync_transform(a)}else q.error("target_set_distance(): Wrong camera object or camera move style")};a.target_get_distance=function(a){return c.is_target_camera(a)?d.dm(a,a.k.pivot):(q.error("target_get_distance(): Wrong camera object or camera move style"),
0)};a.target_zoom_object=function(a,b){if(c.is_target_camera(a)){var e=d.get_object_center(b,!1,E),f=d.get_object_size(b),h=B.get_active(),h=g.fa(a,h).R[0],h=c.Hz(h)/2,f=f/Math.sin(h),h=d.dm(a,e);c.set_trans_pivot(a,l.get_trans_view(a.k.m),e);d.u(a);d.move_local(a,0,f-h,0);d.u(a);m.sync_transform(a)}else q.error("target_zoom_object(): Wrong camera object or camera move style")};a.target_get_pivot=function(a,b){if(!c.is_target_camera(a))return q.error("target_get_pivot(): Wrong camera object or camera move style"),
null;b=b||new Float32Array(3);H.copy(a.k.pivot,b);return b};a.target_set_distance_limits=function(a,b){if(c.is_target_camera(a)){if(b){if("number"!=typeof b.min||"number"!=typeof b.max||b.min>b.max){q.error("target_set_distance_limits(): Wrong limits object");return}b.min=Math.max(b.min,0);b.max=Math.max(b.max,0)}c.pM(a,b);d.u(a);m.sync_transform(a)}else q.error("target_set_distance_limits(): Wrong camera object or camera move style")};a.target_get_distance_limits=function(a,b){if(!c.is_target_camera(a))return q.error("target_get_distance_limits(): Wrong camera object or camera move style"),
null;var d=a.k;return d.ib?(b=b||{},b.min=d.ib.min,b.max=d.ib.max,b):null};a.target_set_vertical_limits=function(a,b){c.is_target_camera(a)?!b||"number"==typeof b.down&&"number"==typeof b.up?(c.MB(a,b),d.u(a),m.sync_transform(a)):q.error("target_set_vertical_limits(): Wrong limits object"):q.error("target_set_vertical_limits(): Wrong camera object or camera move style")};a.target_get_vertical_limits=function(a,b,d){if(!c.is_target_camera(a))return q.error("target_get_vertical_limits(): Wrong camera object or camera move style"),
null;a=a.k;return a.na?(b=b||{},d?(b.down=a.na.xl,b.up=a.na.Im):(b.down=a.na.down,b.up=a.na.up),b.camera_space=d||!1,b):null};a.target_set_horizontal_limits=function(a,b){c.is_target_camera(a)?!b||"number"==typeof b.left&&"number"==typeof b.right?(c.JB(a,b),d.u(a),m.sync_transform(a)):q.error("target_set_horizontal_limits(): Wrong limits object"):q.error("target_set_horizontal_limits(): Wrong camera object or camera move style")};a.target_get_horizontal_limits=function(a,b,d){if(!c.is_target_camera(a))return q.error("target_get_horizontal_limits(): Wrong camera object or camera move style"),
null;a=a.k;return a.eb?(b=b||{},d?(b.left=a.eb.Tl,b.right=a.eb.km):(b.left=a.eb.left,b.right=a.eb.right),b.camera_space=d||!1,b):null};a.target_set_pivot_limits=function(a,b){c.is_target_camera(a)?b&&("number"!=typeof b.min_y||"number"!=typeof b.max_y||b.min_y>b.max_y)?q.error("target_set_pivot_limits(): Wrong limits object"):(c.IM(a,b),d.u(a),m.sync_transform(a)):q.error("target_set_pivot_limits(): Wrong camera object or camera move style")};a.target_get_pivot_limits=function(a,b){if(!c.is_target_camera(a))return q.error("target_get_pivot_limits(): Wrong camera object or camera move style"),
null;var d=a.k;return d.pe?(b=b||{},b.min_y=d.pe.min_y,b.max_y=d.pe.max_y,b):null};a.target_pan_pivot=function(a,b,e){if(c.is_target_camera(a)){var f=a.k;f.use_panning&&(E[0]=b,E[1]=0,E[2]=e,l.transform_dir_vec3(E,f.m,E),H.add(f.pivot,E,f.pivot),b=l.get_trans_view(f.m),H.add(b,E,b),d.u(a),m.sync_transform(a))}else q.error("target_pan_pivot(): wrong object")};a.target_switch_panning=function(a,b){if(!c.is_target_camera(a))return q.error("target_switch_panning(): Wrong camera object or camera move style"),
null;a.k.use_panning=b};a.hover_setup_rel=function(b,e){a.hover_setup(b,{pos:e.pos,pivot:e.pivot});var g="undefined"==typeof e.dist_interval?0:Math.max(e.dist_interval,0),h="undefined"==typeof e.angle_interval?0:Math.max(e.angle_interval,0),l="undefined"==typeof e.t?.5:f.clamp(e.t,0,1),n=a.hover_get_distance_limits(b,G);n.min=Math.max(n.min-l*g,0);n.max+=(1-l)*g;g=a.hover_get_vertical_limits(b,x);g.down=f.clamp(g.down+l*h,-Math.PI/2,0);g.up=f.clamp(g.up-(1-l)*h,-Math.PI/2,0);c.hover_set_distance_limits(b,
n);c.hover_set_vertical_limits(b,g);d.u(b);m.sync_transform(b);c.po(b)};a.hover_setup=function(a,b){if(g.is_camera(a)){if(b.dist_lim){if("number"!=typeof b.dist_lim.min||"number"!=typeof b.dist_lim.max||b.dist_lim.min>b.dist_lim.max){q.error("hover_setup(): Wrong distance limits object");return}b.dist_lim.min=Math.max(b.dist_lim.min,0);b.dist_lim.max=Math.max(b.dist_lim.max,0)}if(b.hover_angle_lim&&("number"!=typeof b.hover_angle_lim.down||"number"!=typeof b.hover_angle_lim.up||b.hover_angle_lim.down<
b.hover_angle_lim.up))q.error("hover_setup(): Wrong hover angle limits object");else if(b.horiz_trans_lim&&("number"!=typeof b.horiz_trans_lim.min||"number"!=typeof b.horiz_trans_lim.max||b.horiz_trans_lim.min>b.horiz_trans_lim.max))q.error("hover_setup(): Wrong horizontal translation limits object");else if(b.vert_trans_lim&&("number"!=typeof b.vert_trans_lim.min||"number"!=typeof b.vert_trans_lim.max||b.vert_trans_lim.min>b.vert_trans_lim.max))q.error("hover_setup(): Wrong vertical translation limits object");
else{c.Rs(a);a.k.nb=c.MS_HOVER_CONTROLS;var e=b.pos||l.get_trans_view(a.k.m);c.VM(a,e,b.pivot,b.dist_lim,b.hover_angle_lim,b.horiz_trans_lim,b.vert_trans_lim,b.enable_horiz_rot||!1);d.u(a);m.sync_transform(a);c.po(a)}}else q.error("hover_setup(): Wrong camera object")};a.hover_rotate=function(a,b,e,f,g){c.is_hover_camera(a)?(c.rotate_hover_camera(a,b,e,f||!1,g||!1),d.u(a),m.sync_transform(a)):q.error("hover_rotate(): Wrong camera object or camera move style")};a.hover_set_pivot_translation=function(a,
b){c.is_hover_camera(a)?(c.set_hover_pivot(a,b),d.u(a),m.sync_transform(a)):q.error("hover_set_pivot_translation(): Wrong camera object or camera move style")};a.hover_get_pivot=function(a,b){if(!c.is_hover_camera(a))return q.error("hover_get_pivot(): Wrong camera object or camera move style"),null;b=b||new Float32Array(3);H.copy(a.k.ub,b);return b};a.hover_get_distance=function(a){return c.is_hover_camera(a)?d.dm(a,a.k.ub):(q.error("hover_get_distance(): Wrong camera object or camera move style"),
0)};a.hover_set_vertical_limits=function(a,b){c.is_hover_camera(a)?"number"!=typeof b.down||"number"!=typeof b.up||b.down<b.up?q.error("hover_set_vertical_limits(): Wrong limits object"):(c.hover_set_vertical_limits(a,b),d.u(a),m.sync_transform(a)):q.error("hover_set_vertical_limits(): Wrong camera object or camera move style")};a.hover_get_vertical_limits=function(a,b){if(!c.is_hover_camera(a))return q.error("hover_get_vertical_limits(): Wrong camera object or camera move style"),null;var d=a.k;
b=b||{};b.down=d.na.down;b.up=d.na.up;return b};a.hover_set_distance_limits=function(a,b){c.is_hover_camera(a)?"number"!=typeof b.min||"number"!=typeof b.max||b.min>b.max?q.error("hover_set_distance_limits(): Wrong limits object"):(b.min=Math.max(b.min,0),b.max=Math.max(b.max,0),c.hover_set_distance_limits(a,b),d.u(a),m.sync_transform(a)):q.error("hover_set_distance_limits(): Wrong camera object or camera move style")};a.hover_get_distance_limits=function(a,b){if(!c.is_hover_camera(a))return q.error("hover_get_distance_limits(): Wrong camera object or camera move style"),
null;var d=a.k;b=b||{};b.min=d.ib.min;b.max=d.ib.max;return b};a.hover_set_vert_trans_limits=function(a,b){c.is_hover_camera(a)?b&&("number"!=typeof b.min||"number"!=typeof b.max||b.min>b.max)?q.error("hover_set_vert_trans_limits(): Wrong limits object"):(c.QM(a,b),d.u(a),m.sync_transform(a)):q.error("hover_set_vert_trans_limits(): Wrong camera object or camera move style")};a.hover_get_vert_trans_limits=function(a,b){if(!c.is_hover_camera(a))return q.error("hover_get_vert_trans_limits(): Wrong camera object or camera move style"),
null;var d=a.k;return d.Gc?(b=b||{},b.min=d.Gc.min,b.max=d.Gc.max,b):null};a.hover_set_horiz_trans_limits=function(a,b){c.is_hover_camera(a)?b&&("number"!=typeof b.min||"number"!=typeof b.max||b.min>b.max)?q.error("hover_set_horiz_trans_limits(): Wrong limits object"):(c.zM(a,b),d.u(a),m.sync_transform(a)):q.error("hover_set_horiz_trans_limits(): Wrong camera object or camera move style")};a.hover_get_horiz_trans_limits=function(a,b){if(!c.is_hover_camera(a))return q.error("hover_get_horiz_trans_limits(): Wrong camera object or camera move style"),
null;var d=a.k;return d.Fc?(b=b||{},b.min=d.Fc.min,b.max=d.Fc.max,b):null};a.hover_switch_horiz_rotation=function(a,b){if(!c.is_hover_camera(a))return q.error("hover_switch_horiz_rotation(): Wrong camera object or camera move style"),null;a.k.Yj=b};a.is_static_camera=c.is_static_camera;a.is_target_camera=c.is_target_camera;a.is_eye_camera=c.is_eye_camera;a.is_hover_camera=c.is_hover_camera;a.set_move_style=function(a,b){if(!g.is_camera(a))return q.error("set_move_style(): Wrong camera object"),!1;
if(b!=c.MS_STATIC&&b!=c.MS_EYE_CONTROLS&&b!=c.MS_TARGET_CONTROLS&&b!=c.MS_HOVER_CONTROLS)return q.error("set_move_style(): Wrong move style"),!1;c.set_move_style(a,b);d.u(a);m.sync_transform(a);return!0};a.get_move_style=function(a){return g.is_camera(a)?c.get_move_style(a):(q.error("get_move_style(): Wrong camera object"),null)};a.set_translation=function(a,b){if(g.is_camera(a)){var e=a.k;if(c.is_target_camera(a)){var f=l.get_trans_view(e.m),f=H.subtract(b,f,E);H.add(f,e.pivot,e.pivot)}else c.is_hover_camera(a)&&
(f=l.get_trans_view(e.m),f=H.subtract(b,f,E),H.add(f,e.ub,e.ub));d.set_translation(a,b);d.u(a);m.sync_transform(a)}else q.error("set_translation(): Wrong camera object")};a.get_translation=function(a,b){if(!g.is_camera(a))return q.error("get_translation(): Wrong camera object"),null;b=b||new Float32Array(3);return d.get_translation(a,b)};a.rotate_camera=function(a,b,e,f,h){g.is_camera(a)?(f=f||!1,h=h||!1,c.is_target_camera(a)?c.rotate_target_camera(a,b,e,f,h):c.is_eye_camera(a)?c.rotate_eye_camera(a,
b,e,f,h):c.is_hover_camera(a)?c.rotate_hover_camera(a,b,e,f,h):c.is_static_camera(a)?q.warn("rotate_camera(): not supported for STATIC cameras"):q.error("rotate_camera(): Wrong camera move style"),d.u(a),m.sync_transform(a)):q.error("rotate_camera(): Wrong camera object")};a.set_velocities=function(a,b){if(g.is_camera(a)){var c=a.k;"number"==typeof b.trans&&(c.Wk=f.clamp(b.trans,0,Infinity));"number"==typeof b.rot&&(c.Vk=f.clamp(b.rot,0,Infinity));"number"==typeof b.zoom&&(c.Xk=f.clamp(b.zoom,0,.99))}else q.error("set_velocities(): Wrong camera object")};
a.get_velocities=function(a,b){if(!g.is_camera(a))return q.error("get_velocities(): Wrong camera object"),null;var c=a.k;b=b||{};b.trans=c.Wk;b.rot=c.Vk;b.zoom=c.Xk;return b};a.is_look_up=function(a){if(!g.is_camera(a))return q.error("is_look_up(): Wrong camera object"),!1;a=l.get_quat_view(a.k.m);return 0<=f.quat_to_dir(a,f.AXIS_MY,E)[1]};a.get_camera_angles=function(a,b){if(!g.is_camera(a))return q.error("get_camera_angles(): Wrong camera object"),null;b=b||new Float32Array(2);c.get_camera_angles(a,
b);return b};a.get_camera_angles_char=function(a,b){if(!g.is_camera(a))return q.error("get_camera_angles_char(): Wrong camera object"),null;b=b||new Float32Array(2);c.get_camera_angles_char(a,b);return b};a.set_stereo_distance=function(a,b){if(g.is_camera(a))for(var d=B.get_active(),d=g.fa(a,d).R,e=0;e<d.length;e++){var f=d[e];f.type!=c.qc&&f.type!=c.Bc&&f.type!=c.Zd&&f.type!=c.$d||c.MM(f,b,f.te)}else q.error("set_stereo_distance(): Wrong camera object")};a.get_stereo_distance=function(a){if(!g.is_camera(a))return q.error("get_stereo_distance(): Wrong camera object"),
0;var b=B.get_active();a=g.fa(a,b).R;for(b=0;b<a.length;b++){var d=a[b];if(d.type==c.qc||d.type==c.Bc)return d.ej}return 0};a.set_eye_distance=function(a,b){if(g.is_camera(a)){var d=B.get_active(),d=g.fa(a,d).R;c.set_eye_distance(d,b)}else q.error("set_eye_distance(): Wrong camera object")};a.get_eye_distance=function(a){if(!g.is_camera(a))return q.error("get_eye_distance(): Wrong camera object"),0;var b=B.get_active();a=g.fa(a,b).R;for(b=0;b<a.length;b++){var d=a[b];if(d.type==c.qc||d.type==c.Bc||
d.type==c.Zd||d.type==c.$d)return d.te}return 0};a.set_vertical_axis=function(a,b){g.is_camera(a)?(H.copy(b,a.k.xe),d.u(a),m.sync_transform(a)):q.error("set_vertical_axis(): Wrong camera object")};a.get_vertical_axis=function(a,b){if(g.is_camera(a))return b||(b=H.create()),H.copy(a.k.xe,b),b;q.error("get_vertical_axis(): Wrong camera object")};a.translate_view=function(a,b,d,e){if(g.is_camera(a)){var f=B.get_active();a=g.fa(a,f).R;for(f=0;f<a.length;f++){var l=a[f];l.Fb||c.bj(l,l.$a);var m=E;m[0]=
-b;m[1]=-d;m[2]=0;h.translate(l.Ya,m,l.Ya);h.rotateZ(l.Ya,e,l.Ya);c.qy(l);c.Et(l)}}else q.error("translate_view(): Wrong camera object")};a.get_view_vector=function(a,b){if(!g.is_camera(a))return q.error("get_view_vector(): Wrong camera object"),null;b=b||new Float32Array(3);var c=l.get_quat_view(a.k.m);f.quat_to_dir(c,f.AXIS_MY,b);return b};a.get_fov=function(a){if(!g.is_camera(a))return q.error("get_fov(): Wrong camera object"),0;var b=B.get_active();a=g.fa(a,b).R;return f.deg_to_rad(a[0].ad)};
a.set_fov=function(a,b){if(g.is_camera(a))for(var d=B.get_active(),d=g.fa(a,d).R,e=0;e<d.length;e++){var h=d[e];h.ad=f.rad_to_deg(b);h.Fb||c.bj(h,h.$a);c.qy(h);c.Et(h)}else q.error("set_fov(): Wrong camera object")};a.set_hmd_fov=function(a,b,d){var e;if(!(e=g.is_camera(a)))a:{if(g.is_camera(a)){e=B.get_active();e=g.fa(a,e).R;for(var f=0;f<e.length;f++){var h=e[f];if(h.type==c.Zd||h.type==c.$d){e=!0;break a}}}else q.error("is_hmd_camera(): Wrong camera object");e=!1}e?b&&d&&c.set_hmd_fov(a,b,d):q.error("set_hmd_fov(): Wrong camera object")};
a.correct_up=function(a,c,e){g.is_camera(a)?(c=c||a.k.xe,b.correct_up(a,c,e||!1),d.u(a),m.sync_transform(a)):q.error("correct_up(): Wrong camera object")};a.set_ortho_scale=function(a,b){if(g.is_camera(a)&&c.is_ortho_camera(a)){var d=a.k;if(c.is_target_camera(a)){var e=l.get_trans_view(d.m),e=H.dist(e,d.pivot);d.yi=b/2*d.xi/e}else c.is_hover_camera(a)?(e=l.get_trans_view(d.m),e=H.distance(e,d.ub),d.yi=b/2*d.xi/e):(d=B.get_active(),g.fa(a,d).R[0].top=b/2);c.hO(a)}else q.error("set_ortho_scale(): Wrong camera object")};
a.get_ortho_scale=function(a){if(!g.is_camera(a)||!c.is_ortho_camera(a))return q.error("get_ortho_scale(): Wrong camera object"),0;var b=B.get_active();return 2*g.fa(a,b).R[0].top};a.is_ortho_camera=function(a){return g.is_camera(a)?c.is_ortho_camera(a):(q.error("is_ortho_camera(): Wrong camera object"),!1)};a.calc_ray=function(a,b,e,h){if(!g.is_camera(a))return q.error("calc_ray(): Wrong camera object"),null;var m=B.get_active(),p=g.fa(a,m).R[0];h&&3==h.length?q.uc('dest parameter in the function "calc_ray" should be type of parametric line.'):
h=h||new Float32Array(6);switch(p.type){case c.kd:case c.lg:case c.qc:case c.Bc:var x=Math.tan(p.ad*Math.PI/360),C=x*p.$a,m=E;b=n.gq(b,e,w,p);m[0]=(2*b[0]/p.width-1)*C;m[1]=-1;m[2]=(2*b[1]/p.height-1)*x;l.transform_dir_vec3(m,a.k.m,m);H.normalize(m,m);3==h.length?H.copy(m,h):(a=d.get_translation(a,y),r.set_pline_initial_point(h,a),r.set_pline_directional_vec(h,m));return h;case c.ae:return m=E,b=n.gq(b,e,w,p),m[0]=(2*b[0]/p.width-1)*p.top*p.$a,m[1]=0,m[2]=(2*b[1]/p.height-1)*p.top,l.transform_vec3(m,
a.k.m,m),H.copy(m,h),a=l.get_quat_view(a.k.m,A),H.transformQuat(f.AXIS_MY,a,m),r.set_pline_directional_vec(h,m),h;default:return q.error("calc_ray(): Non-compatible camera"),h}};a.project_point=function(a,b,d){if(!g.is_camera(a))return q.error("project_point(): Wrong camera object"),null;d=d||new Float32Array(2);return c.project_point(a,b,d)};a.has_distance_limits=function(a){return(c.is_target_camera(a)||c.is_hover_camera(a))&&null!==a.k.ib};a.has_vertical_rot_limits=function(a){return(c.is_eye_camera(a)||
c.is_target_camera(a)||c.is_hover_camera(a))&&null!==a.k.na};a.has_vertical_limits=function(a){q.qb("has_vertical_limits","has_vertical_rot_limits");return c.is_target_camera(a)||c.is_eye_camera(a)?null!==a.k.na:(q.error("has_vertical_limits(): Wrong camera object"),!1)};a.has_horizontal_rot_limits=function(a){return(c.is_target_camera(a)||c.is_eye_camera(a))&&null!==a.k.eb};a.has_horizontal_limits=function(a){q.qb("has_horizontal_limits","has_horizontal_rot_limits");return c.is_target_camera(a)||
c.is_eye_camera(a)?null!==a.k.eb:(q.error("has_horizontal_limits(): Wrong camera object"),!1)};a.has_vertical_trans_limits=function(a){return c.is_hover_camera(a)&&null!==a.k.Gc};a.has_horizontal_trans_limits=function(a){return c.is_hover_camera(a)&&null!==a.k.Fc};a.move_pivot=function(a,b,e){q.qb("move_pivot","target_pan_pivot");if(c.is_target_camera(a)){var f=a.k;if(f.use_panning){var g=l.get_trans_view(f.m),h=H.subtract(g,f.pivot,y);E[0]=b;E[1]=0;E[2]=e;H.scale(E,H.len(h),E);l.transform_dir_vec3(E,
f.m,E);H.add(f.pivot,E,f.pivot);H.add(g,E,g);d.u(a);m.sync_transform(a)}}else q.error("move_pivot(): wrong object")};a.set_velocity_params=function(a,b){q.qb("set_velocity_params","set_velocities");if(g.is_camera(a)){var c=a.k;c.Wk=f.clamp(b[0],0,Infinity);c.Vk=f.clamp(b[1],0,Infinity);c.Xk=f.clamp(b[2],0,.99)}else q.error("set_velocity_params(): Wrong camera object")};a.get_velocity_params=function(a,b){q.qb("get_velocity_params","get_velocities");if(!g.is_camera(a))return q.error("get_velocity_params(): Wrong camera object"),
null;b=b||new Float32Array(3);var c=a.k;b[0]=c.Wk;b[1]=c.Vk;b[2]=c.Xk;return b};a.clear_horizontal_limits=function(a){q.uc('camera.clear_horizontal_limits() deprecated, use camera.target_set_horizontal_limits(), camera.eye_set_horizontal_limits() or camera.hover_set_horiz_trans_limits() with passing null as the "limits" argument.');g.is_camera(a)?c.is_target_camera(a)||c.is_eye_camera(a)?a.k.eb=null:c.is_hover_camera(a)&&(a.k.Fc=null):q.error("clear_horizontal_limits(): Wrong camera object")};a.clear_vertical_limits=
function(a){q.uc('camera.clear_vertical_limits() deprecated, use camera.target_set_vertical_limits(), camera.eye_set_vertical_limits() or camera.hover_set_vert_trans_limits() with passing null as the "limits" argument.');g.is_camera(a)?c.is_target_camera(a)||c.is_eye_camera(a)?a.k.na=null:c.is_hover_camera(a)&&(a.k.Gc=null):q.error("clear_vertical_limits(): Wrong camera object")};a.clear_hover_angle_limits=function(){q.uc("camera.clear_hover_angle_limits() deprecated, HOVER camera always has hover angle limits")};
a.set_look_at=function(a,e,f,g){q.xg("camera.set_look_at",["camera.static_set_look_at","camera.eye_set_look_at"]);g=g||a.k.xe;c.set_look_at(a,e,f);b.correct_up(a,g,!0);d.u(a);m.sync_transform(a)};a.rotate_eye_camera=function(a,b,e,f,g){q.xg("camera.rotate_eye_camera",["camera.eye_rotate","camera.rotate_camera"]);c.is_eye_camera(a)?(c.rotate_eye_camera(a,b,e,f,g),d.u(a),m.sync_transform(a)):q.error("rotate_eye_camera(): wrong object")};a.rotate_target_camera=function(a,b,e,f,g){q.xg("camera.rotate_target_camera",
["camera.target_rotate","camera.rotate_camera"]);c.is_target_camera(a)?(c.rotate_target_camera(a,b,e,f,g),d.u(a),m.sync_transform(a)):q.error("rotate_target_camera(): wrong object")};a.set_trans_pivot=function(a,b,e){q.qb("camera.set_trans_pivot","camera.target_set_trans_pivot");c.is_target_camera(a)?(c.set_trans_pivot(a,b,e),d.u(a),m.sync_transform(a)):q.error("set_trans_pivot(): Wrong object or camera move style")};a.zoom_object=function(a,b){q.qb("camera.zoom_object","camera.target_zoom_object");
if(c.is_target_camera(a)){d.get_object_center(b,!1,E);e(a,E);d.u(a);var f=d.get_object_size(b),h=B.get_active(),h=g.fa(a,h).R[0],h=c.Hz(h)/2,f=f/Math.sin(h),h=d.dm(a,E);d.move_local(a,0,f-h,0);d.u(a);m.sync_transform(a)}else q.error("zoom_object(): wrong object")};a.set_pivot=e;a.rotate_hover_camera=function(a,b,e,f,g){q.qb("camera.rotate_hover_camera","camera.hover_rotate");c.is_hover_camera(a)?(c.rotate_hover_camera(a,b,e,f,g),d.u(a),m.sync_transform(a)):q.error("rotate_hover_camera(): wrong object")};
a.get_hover_cam_pivot=function(a,b){q.qb("camera.get_hover_cam_pivot","camera.hover_get_pivot");if(!c.is_hover_camera(a))return q.error("get_hover_cam_pivot(): wrong object"),null;b||(b=new Float32Array(3));H.copy(a.k.ub,b);return b};a.get_eye=function(a,b){q.qb("camera.get_eye","camera.get_translation");return g.is_camera(a)?c.get_eye(a,b):(q.error("get_eye(): Wrong object"),null)};a.get_pivot=function(a,b){q.qb("camera.get_pivot","camera.target_get_pivot");if(!c.is_target_camera(a))return q.error("get_pivot(): Wrong object or camera move style"),
null;b||(b=new Float32Array(3));H.copy(a.k.pivot,b);return b};a.hover_cam_set_translation=function(a,b){q.qb("camera.hover_cam_set_translation","camera.set_translation");if(c.is_hover_camera(a)){var e=a.k,f=l.get_trans_view(e.m),f=H.subtract(b,f,E);H.add(f,e.ub,e.ub);d.set_translation(a,b);d.u(a);m.sync_transform(a)}else q.error("hover_cam_set_translation(): wrong object")};a.set_hover_pivot=function(a,b){q.qb("camera.set_hover_pivot","camera.hover_set_pivot_translation");c.is_hover_camera(a)?(c.set_hover_pivot(a,
b),d.u(a),m.sync_transform(a)):q.error("set_hover_pivot(): Wrong object or camera move style")};a.get_hover_angle_limits=function(a,b){q.qb("camera.get_hover_angle_limits","camera.hover_get_vertical_limits");if(!c.is_hover_camera(a))return q.error("get_hover_angle_limits(): wrong object"),null;b=b||new Float32Array(2);b[0]=a.k.na.down;b[1]=a.k.na.up;return b};a.get_cam_dist_limits=function(a,b){q.xg("camera.get_cam_dist_limits",["camera.hover_get_distance_limits","camera.target_get_distance_limits"]);
if(!c.is_hover_camera(a)&&!c.is_target_camera(a))return q.error("get_cam_dist_limits(): wrong object"),null;if(a.k.ib)b=b||new Float32Array(2),b[0]=a.k.ib.max,b[1]=a.k.ib.min;else return null;return b};a.apply_vertical_limits=function(b,e,f,g){q.xg("camera.apply_vertical_limits",["camera.eye_set_vertical_limits","camera.target_set_vertical_limits","camera.hover_set_vert_trans_limits"]);if(c.is_target_camera(b)){var h=G;h.down=e;h.up=f;h.camera_space=g==d.SPACE_LOCAL;a.target_set_vertical_limits(b,
h)}else c.is_eye_camera(b)?(h=G,h.down=e,h.up=f,h.camera_space=g==d.SPACE_LOCAL,a.eye_set_vertical_limits(b,h)):c.is_hover_camera(b)?(h=G,h.min=e,h.max=f,a.hover_set_vert_trans_limits(b,h)):q.error("apply_vertical_limits(): wrong object")};a.apply_hover_angle_limits=function(b,c,d){q.qb("camera.apply_hover_angle_limits","camera.hover_set_vertical_limits");G.down=c;G.up=d;a.hover_set_vertical_limits(b,G)};a.apply_distance_limits=function(b,d,e){q.xg("camera.apply_distance_limits",["camera.target_set_distance_limits",
"camera.hover_set_distance_limits"]);if(c.is_target_camera(b)){var f=G;f.min=d;f.max=e;a.target_set_distance_limits(b,f)}else c.is_hover_camera(b)?(f=G,f.min=d,f.max=e,a.hover_set_distance_limits(b,f)):q.error("apply_distance_limits(): wrong object")};a.clear_distance_limits=function(b){q.qb("camera.clear_distance_limits","camera.target_set_distance_limits");a.target_set_distance_limits(b,null)};a.get_vertical_limits=function(a,b){q.xg("camera.get_vertical_limits",["camera.eye_get_vertical_limits",
"camera.target_get_vertical_limits","camera.hover_get_vert_trans_limits"]);if(!c.is_target_camera(a)&&!c.is_eye_camera(a)&&!c.is_hover_camera(a))return q.error("get_vertical_limits(): wrong object"),null;var d=a.k;b=b||new Float32Array(2);if(c.is_eye_camera(a)||c.is_target_camera(a)){if(d.na)return b[0]=d.na.down,b[1]=d.na.up,b}else if(c.is_hover_camera(a)&&d.Gc)return b[0]=d.Gc.min,b[1]=d.Gc.max,b;return null};a.apply_horizontal_limits=function(b,e,f,g){q.xg("camera.apply_horizontal_limits",["camera.eye_set_horizontal_limits",
"camera.target_set_horizontal_limits","camera.hover_set_horiz_trans_limits"]);if(c.is_target_camera(b)){var h=G;h.left=e;h.right=f;h.camera_space=g==d.SPACE_LOCAL;a.target_set_horizontal_limits(b,h)}else c.is_eye_camera(b)?(h=G,h.left=e,h.right=f,h.camera_space=g==d.SPACE_LOCAL,a.eye_set_horizontal_limits(b,h)):c.is_hover_camera(b)?(h=G,h.min=e,h.max=f,a.hover_set_horiz_trans_limits(b,h)):q.error("apply_horizontal_limits(): wrong object")};a.get_horizontal_limits=function(a,b){q.xg("camera.get_horizontal_limits",
["camera.eye_get_horizontal_limits","camera.target_get_horizontal_limits","camera.hover_get_horiz_trans_limits"]);if(!c.is_target_camera(a)&&!c.is_eye_camera(a)&&!c.is_hover_camera(a))return q.error("get_horizontal_limits(): wrong object"),null;var d=a.k;b=b||new Float32Array(2);if(c.is_eye_camera(a)||c.is_target_camera(a)){if(d.eb)return b[0]=d.eb.left,b[1]=d.eb.right,b}else if(c.is_hover_camera(a)&&d.Fc)return b[0]=d.Fc.min,b[1]=d.Fc.max,b;return null};a.get_frustum_planes=function(a,b){if(!g.is_camera(a))return q.error("get_frustum_planes(): Wrong camera object"),
null;var c=B.get_active(),c=g.fa(a,c).R[0].Ag;D.copy(c.left,b.left);D.copy(c.right,b.right);D.copy(c.top,b.top);D.copy(c.bottom,b.bottom);D.copy(c.near,b.near);D.copy(c.far,b.far);return b}};b4w.module.config=function(a,p){var e=p("__config");a.P_LOW=e.P_LOW;a.P_HIGH=e.P_HIGH;a.P_ULTRA=e.P_ULTRA;a.P_CUSTOM=e.P_CUSTOM;a.set=e.set;a.get=e.get;a.reset=e.reset;a.reset_limits=e.reset_limits;a.get_std_assets_path=e.get_std_assets_path};b4w.module.controls=function(a,p){var e=p("__controls"),c=p("__print");a.CT_POSITIVE=e.CT_POSITIVE;a.CT_CONTINUOUS=e.CT_CONTINUOUS;a.CT_TRIGGER=e.CT_TRIGGER;a.CT_SHOT=e.CT_SHOT;a.CT_LEVEL=e.CT_LEVEL;a.CT_CHANGE=e.CT_CHANGE;a.KEY_BACKSPACE=8;a.KEY_TAB=9;a.KEY_ENTER=13;a.KEY_SHIFT=16;a.KEY_CTRL=17;a.KEY_ALT=18;a.KEY_PAUSE=19;a.KEY_CAPSLOCK=20;a.KEY_ESC=27;a.KEY_SPACE=32;a.KEY_LEFT=37;a.KEY_UP=38;a.KEY_RIGHT=39;a.KEY_DOWN=40;a.KEY_1=49;a.KEY_2=50;a.KEY_3=51;a.KEY_4=52;a.KEY_5=53;a.KEY_6=54;a.KEY_7=55;
a.KEY_8=56;a.KEY_9=57;a.KEY_A=65;a.KEY_B=66;a.KEY_C=67;a.KEY_D=68;a.KEY_E=69;a.KEY_F=70;a.KEY_G=71;a.KEY_H=72;a.KEY_I=73;a.KEY_J=74;a.KEY_K=75;a.KEY_L=76;a.KEY_M=77;a.KEY_N=78;a.KEY_O=79;a.KEY_P=80;a.KEY_Q=81;a.KEY_R=82;a.KEY_S=83;a.KEY_T=84;a.KEY_U=85;a.KEY_V=86;a.KEY_W=87;a.KEY_X=88;a.KEY_Y=89;a.KEY_Z=90;a.KEY_NUM0=96;a.KEY_NUM1=97;a.KEY_NUM2=98;a.KEY_NUM3=99;a.KEY_NUM4=100;a.KEY_NUM5=101;a.KEY_NUM6=102;a.KEY_NUM7=103;a.KEY_NUM8=104;a.KEY_NUM9=105;a.KEY_MULT=106;a.KEY_ADD=107;a.KEY_SUB=109;a.KEY_DEC_POINT=
110;a.KEY_DIV=111;a.KEY_SEMI_COLON=186;a.KEY_EQUAL_SIGN=187;a.KEY_COMMA=188;a.KEY_DASH=189;a.KEY_PERIOD=190;a.KEY_FORWARD_SLASH=191;a.KEY_GRAVE_ACCENT=192;a.KEY_LEFT_SQ_BRACKET=219;a.KEY_BACK_SLASH=220;a.KEY_RIGHT_SQ_BRACKET=221;a.KEY_SINGLE_QUOTE=222;a.PL_SINGLE_TOUCH_MOVE=e.PL_SINGLE_TOUCH_MOVE;a.PL_MULTITOUCH_MOVE_ZOOM=e.PL_MULTITOUCH_MOVE_ZOOM;a.PL_MULTITOUCH_MOVE_PAN=e.PL_MULTITOUCH_MOVE_PAN;a.PL_MULTITOUCH_MOVE_ROTATE=e.PL_MULTITOUCH_MOVE_ROTATE;a.create_gamepad_btn_sensor=e.create_gamepad_btn_sensor;
a.create_gamepad_axis_sensor=e.create_gamepad_axis_sensor;a.create_custom_sensor=e.create_custom_sensor;a.create_keyboard_sensor=e.create_keyboard_sensor;a.create_collision_sensor=function(a,c,h){return e.create_collision_sensor(a,c||"ANY",h||!1)};a.create_collision_impulse_sensor=e.create_collision_impulse_sensor;a.create_ray_sensor=function(a,c,h,p,g,m,q){return e.create_ray_sensor(a,c,h,p||"ANY",g||!1,m||!1,q||!1)};a.create_mouse_click_sensor=e.create_mouse_click_sensor;a.create_mouse_wheel_sensor=
e.create_mouse_wheel_sensor;a.create_mouse_move_sensor=e.create_mouse_move_sensor;a.create_touch_move_sensor=e.create_touch_move_sensor;a.create_touch_zoom_sensor=e.create_touch_zoom_sensor;a.create_touch_rotate_sensor=e.create_touch_rotate_sensor;a.create_touch_click_sensor=e.create_touch_click_sensor;a.create_motion_sensor=e.create_motion_sensor;a.create_vertical_velocity_sensor=e.create_vertical_velocity_sensor;a.create_gyro_angles_sensor=e.create_gyro_angles_sensor;a.create_gyro_quat_sensor=e.create_gyro_quat_sensor;
a.create_gyro_delta_sensor=e.create_gyro_delta_sensor;a.create_hmd_quat_sensor=e.create_hmd_quat_sensor;a.create_hmd_position_sensor=e.create_hmd_position_sensor;a.create_timer_sensor=function(a,c){return e.create_timer_sensor(a,c||!1)};a.reset_timer_sensor=e.reset_timer_sensor;a.create_elapsed_sensor=e.create_elapsed_sensor;a.create_timeline_sensor=e.create_timeline_sensor;a.create_selection_sensor=function(a,c){return e.create_selection_sensor(a,c||!1)};a.create_callback_sensor=function(a,c){return e.create_callback_sensor(a,
c||0)};a.set_custom_sensor=function(a,c){e.hM(a,c)};a.get_custom_sensor=function(a){return a.value};a.get_sensor_value=e.get_sensor_value;a.get_sensor_payload=e.get_sensor_payload;a.create_sensor_manifold=function(a,c,h,p,g,m,q){g=g||e.Zy;e.create_sensor_manifold(a,c,h,p,g,m,void 0===q?null:q)};a.create_kb_sensor_manifold=function(a,c,h,p,g,m){p=e.create_keyboard_sensor(p);e.create_sensor_manifold(a,c,h,[p],e.Zy,g,void 0===m?null:m)};a.check_sensor_manifolds=function(a){return e.check_sensor_manifold(a,
null)};a.check_sensor_manifold=e.check_sensor_manifold;a.remove_sensor_manifold=e.remove_sensor_manifold;a.reset=e.reset;a.register_keyboard_events=function(){c.uc("controls.register_keyboard_events() deprecated")};a.register_mouse_events=function(){c.uc("controls.register_mouse_events() deprecated")};a.register_wheel_events=function(){c.uc("controls.register_wheel_events() deprecated")};a.register_touch_events=function(){c.uc("controls.register_touch_events() deprecated")};a.register_device_orientation=
function(){c.uc("controls.register_device_orientation() deprecated")};a.unregister_keyboard_events=function(){c.uc("controls.unregister_keyboard_events() deprecated")};a.unregister_mouse_events=function(){c.uc("controls.unregister_mouse_events() deprecated")};a.unregister_wheel_events=function(){c.uc("controls.unregister_wheel_events() deprecated")};a.unregister_touch_events=function(){c.uc("controls.unregister_touch_events() deprecated")};a.unregister_device_orientation=function(){c.uc("controls.unregister_device_orientation() deprecated")}};b4w.module.constraints=function(a,p){var e=p("__camera"),c=p("__constraints"),b=p("__obj_util"),n=p("__physics"),h=p("__print"),r=p("__transform");a.append_stiff=function(a,b,e,h,d){d=d||1;b instanceof Array&&2==b.length?c.wF(a,b[0],b[1],e,h,d):c.Tx(a,b,e,h,d);r.u(a);n.sync_transform(a)};a.append_semi_stiff=function(a,b,e,h){c.uF(a,b,e,h);r.u(a);n.sync_transform(a)};a.append_semi_stiff_cam=function(a,b,q,p,d,l,f,H){e.is_eye_camera(a)?(d=d||-Math.PI/2,l=l||Math.PI/2,f=f||Math.PI/2,H=H||-Math.PI/2,
c.tF(a,b,q,p,d,l,f,H),r.u(a),n.sync_transform(a)):h.error("append_semi_stiff_cam(): wrong object type, only EYE camera objects can be parented.")};a.append_semi_soft_cam=function(a,b,q,p){if(e.is_eye_camera(a)){if(!p||0>p)p=.25;c.sF(a,b,q,p);r.u(a);n.sync_transform(a)}else h.error("append_semi_soft_cam(): wrong object type, only EYE camera objects can be parented.")};a.append_stiff_trans=function(a,b,e){c.yF(a,b,e);r.u(a);n.sync_transform(a)};a.append_copy_trans=function(a,b,e){c.mF(a,b,e);r.u(a);
n.sync_transform(a)};a.append_stiff_trans_rot=function(a,b,e,h){c.zF(a,b,e,h);r.u(a);n.sync_transform(a)};a.append_track=function(a,b){3==b.length?c.DF(a,b):c.CF(a,b);r.u(a);n.sync_transform(a)};a.append_follow=function(a,b,e,h){3==b.length?c.pF(a,b,e,h):c.oF(a,b,e,h);r.u(a);n.sync_transform(a)};a.append_stiff_viewport=function(a,b,e){c.append_stiff_viewport(a,b,e);r.u(a);n.sync_transform(a)};a.remove=function(a){a.Ib&&c.remove(a)};a.get_parent=function(a){h.qb("constraints.get_parent","objects.get_parent");
return b.get_parent(a)}};b4w.module.container=function(a,p){var e=p("__container"),c=p("__print");a.get_canvas=e.get_canvas;a.get_canvas_hud=e.get_canvas_hud;a.get_container=e.get_container;a.insert_to_container=function(a,n){2!=arguments.length?c.error("insert_to_container(): two arguments required"):a&&n&&e.insert_to_container(a,n)};a.set_canvas_offsets=e.set_canvas_offsets;a.update_canvas_offsets=e.update_canvas_offsets;a.client_to_canvas_coords=e.client_to_canvas_coords;a.force_offsets_updating=e.force_offsets_updating;
a.resize=function(a,n,h){a&&n||c.warn("Wrong canvas container dimensions: "+a+"x"+n+". Zero dimensions aren't allowed. Resized to: "+e.Ys+"x"+e.Xs+".");e.resize(a,n,h)};a.resize_to_container=function(a){e.resize_to_container(a||!1)}};b4w.module.data=function(a,p){var e=p("__data"),c=p("__loader");p("__print");a.load=e.load;a.unload=function(a){e.unload(a|0)};a.set_debug_resources_root=e.set_debug_resources_root;a.is_primary_loaded=e.is_primary_loaded;a.is_idle=c.qk;a.load_and_add_new=e.load;a.cleanup=a.unload;a.activate_media=e.activate_media};b4w.module.debug=function(a,p){function e(a){var b={};if(!a)return b;a=a.split("\n");for(var c=0;c<a.length;c++){var d=a[c];if(-1!=d.search(new RegExp(/^[A-Z.]+ ?/))){var e=d.split(" ")[0];e in b||(b[e]=0);b[e]++}}c=a=0;for(e in b)switch(e){case "KIL":case "TEX":case "TXB":case "TXP":case "KIL.F":case "TEX.F":case "TXB.F":case "TXD.F":case "TXL.F":case "TXQ.F":case "TXP.F":c+=b[e];a+=b[e];break;case "ADDRESS":case "ATTRIB":case "PARAM":case "TEMP":case "ALIAS":case "OUTPUT":break;case "END":break;
default:a+=b[e]}b.ALL_OPS=a;b.TEX_OPS=c;return b}function c(a,b){var c=new XMLHttpRequest;c.open("POST",a,!1);c.send(b);if(200==c.status)return c.responseText;throw"Error POST XHR: "+c.status;}function b(a){a.sort(function(a,b){return b.xu.ALL_OPS-a.xu.ALL_OPS});for(var b=0;b<a.length;b++){var c=a[b],d=c.xu,e=c.RO,f=n(c.dI),f=f?"\t\t("+f.join(", ")+")":"\t\t(NA)";w.groupCollapsed("VERT --\x3e","OPS",e.ALL_OPS,"TEX",e.TEX_OPS,"\t\tFRAG --\x3e","OPS",d.ALL_OPS,"TEX",d.TEX_OPS,f);w.groupCollapsed("directives");
for(var f=c.Va.nh,g=0;g<f.length;g++){var h=f[g];w.Qe(h[0],h[1])}w.groupEnd();w.groupCollapsed("vert source");w.Qe(c.PO);w.groupEnd();w.groupCollapsed("vert translated source");w.Qe(c.QO);w.groupEnd();w.groupCollapsed("vert ops stats");for(var l in e)"ALL_OPS"!=l&&"TEX_OPS"!=l&&w.Qe(l,e[l]);w.groupEnd();w.groupCollapsed("vert assembly");w.Qe(c.OO);w.groupEnd();w.groupCollapsed("frag source");w.Qe(c.cJ);w.groupEnd();w.groupCollapsed("frag translated source");w.Qe(c.dJ);w.groupEnd();w.groupCollapsed("frag ops stats");
for(l in d)"ALL_OPS"!=l&&"TEX_OPS"!=l&&w.Qe(l,d[l]);w.groupEnd();w.groupCollapsed("frag assembly");w.Qe(c.VI);w.groupEnd();w.groupEnd()}}function n(a){for(var b=y.io(),c=0;c<b.length;c++)for(var d=b[c],e=f.yb(d,"MESH",f.DATA_ID_ALL),g=0;g<e.length;g++){var h=H.fa(e[g],d);if(h&&h.P.length)for(var h=h.P,l=0;l<h.length;l++){var k=h[l];if(k.La==a&&k.lc.length)return k.lc}}return null}function h(a,b){function c(){v.push(c);z=b;return a.apply(a,arguments)}return c}function r(a,b,c){if(typeof b!=typeof a)throw"Wrong expected data type.";
if(a.length!=b.length)throw"Wrong expected vector length.";c=c?c:1E-6;for(var d=0;d<a.length;d++)if(b[d]>a[d]+c||b[d]<a[d]-c)throw"Wrong result.";}p("__config");var g=p("__compat"),m=p("__controls"),q=p("__container"),B=p("__debug"),d=p("__extensions"),l=p("__loader"),f=p("__objects"),H=p("__obj_util"),D=p("__physics"),w=p("__print"),E=p("__renderer"),y=p("__scenes"),A=p("__scenegraph"),G=p("__sfx"),x=p("__shaders"),k=p("__subscene"),t=p("__textures"),M=p("__util"),u=p("__vec3"),v=[],z="",S=!0,C=
new Float32Array(2);a.DV_NONE=B.DV_NONE;a.DV_OPAQUE_WIREFRAME=B.DV_OPAQUE_WIREFRAME;a.DV_TRANSPARENT_WIREFRAME=B.DV_TRANSPARENT_WIREFRAME;a.DV_FRONT_BACK_VIEW=B.DV_FRONT_BACK_VIEW;a.DV_BOUNDINGS=B.DV_BOUNDINGS;a.DV_CLUSTERS_VIEW=B.DV_CLUSTERS_VIEW;a.DV_BATCHES_VIEW=B.DV_BATCHES_VIEW;a.DV_RENDER_TIME=B.DV_RENDER_TIME;a.physics_stats=function(){D.kI()};a.physics_id=function(a){w.log("O",D.RI(a));for(var b=D.qJ().Wb.ha,c=0;c<b.length;c++){var d=b[c];d.A.M==a&&w.log("B",d)}};a.visible_objects=function(){for(var a=
y.get_active(),b=f.yb(a,"MESH",f.DATA_ID_ALL),a=[y.Ba(a,k.pb),y.Ba(a,k.hc),y.Ba(a,k.pd)],c=0;c<a.length;c++){var d=a[c],e=subs.za;if(e.length){w.group(d.type,"DYNAMIC");for(var g=0;g<b.length;g++){var h=b[g],l=h.k;if("DYNAMIC"==l.type)for(var m=!1,n=0;n<e.length;n++){for(var q=e[n].ha,p=0;p<q.length;p++){var r=q[p];if(r.sb&&r.Jg==l){w.Qe(h.name,h);m=!0;break}}if(m)break}}w.groupEnd();w.groupCollapsed(d.type,"STATIC");for(g=0;g<b.length;g++)if(h=b[g],l=h.k,"DYNAMIC"!=l.type)for(m=!1,n=0;n<e.length;n++){q=
e[n].ha;for(p=0;p<q.length;p++)if(r=q[p],r.sb&&r.Jg==l){w.Qe(h.name,h);m=!0;break}if(m)break}w.groupEnd()}}};a.object_info=function(a){for(var b=y.get_active(),c=f.yb(b,"MESH",f.DATA_ID_ALL),d=0;d<c.length;d++){var e=c[d];if(e.name==a){w.log("Object",e);for(var g=y.Au(b),h=0;h<g.length;h++){for(var l=g[h],k=[],m=l.za,n=0;n<m.length;n++)for(var q=m[n].ha,p=0;p<q.length;p++)q[p].Jg==e.k&&k.push(q[p]);w.log("Subscene "+l.type,k)}}}};a.objects_stat=function(){var a=y.get_active();console.log("Armatures: "+
f.yb(a,"ARMATURE",f.DATA_ID_ALL).length);console.log("Cameras: "+f.yb(a,"CAMERA",f.DATA_ID_ALL).length);console.log("Curves: "+f.yb(a,"CURVE",f.DATA_ID_ALL).length);console.log("Empties: "+f.yb(a,"EMPTY",f.DATA_ID_ALL).length);console.log("Lamps: "+f.yb(a,"LAMP",f.DATA_ID_ALL).length);console.log("Meshes: "+f.yb(a,"MESH",f.DATA_ID_ALL).length);console.log("Speakers: "+f.yb(a,"SPEAKER",f.DATA_ID_ALL).length)};a.num_vertices=function(){for(var a=0,b=y.get_active(),b=[y.Ba(b,k.pb),y.Ba(b,k.hc),y.Ba(b,
k.pd)],c=0;c<b.length;c++){var d=b[c];if(d)for(var d=d.za,e=0;e<d.length;e++)for(var f=d[e].ha,g=0;g<f.length;g++){var h=f[g].Y;h&&(a+=h.num_vertices)}}return a};a.num_triangles=function(){for(var a=0,b=y.get_active(),b=[y.Ba(b,k.pb),y.Ba(b,k.hc),y.Ba(b,k.pd)],c=0;c<b.length;c++){var d=b[c];if(d)for(var d=d.za,e=0;e<d.length;e++)for(var f=d[e].ha,g=0;g<f.length;g++){var h=f[g].Y;h&&(a+=h.num_triangles)}}return a};a.num_draw_calls=function(){for(var a=y.get_active(),b=y.Bw(a,[k.pb,k.hc,k.pd,k.jd,k.df]),
c=0,d=0;d<b.length;d++)for(var e=b[d],e=e.za,f=0;f<e.length;f++)c+=e[f].ha.length;a=y.Bw(a,[k.Kc,k.Yd]);for(d=0;d<a.length;d++)for(e=a[d],e=e.za,f=0;f<e.length;f++)c+=6*e[f].ha.length;return c};a.num_shaders=function(){return M.jo(x.Lz())};a.geometry_stats=function(){for(var a=y.get_active(),b=y.Au(a),a={},c=0;c<b.length;c++){var d=b[c];if(d.type!=k.hl&&d.type!=k.ze)for(var e=d.za,f=0;f<e.length;f++)for(var g=e[f].ha,h=0;h<g.length;h++){var l=g[h].Y,m=g[h].Jg;l&&(d.type!=k.Xd&&d.type!=k.Xd||m.fm||
m.em)&&(a[l.id]=l)}}var e=d=c=b=0,n;for(n in a)l=a[n],l=l.aa,l.tl&&(d++,e+=l.tl/1048576),b++,c+=l.vq/1048576;return{vbo_number:b,vbo_memory:c,ibo_number:d,ibo_memory:e}};a.num_textures=function(){for(var a=[],b=0,c=y.get_active(),c=[y.Ba(c,k.pb),y.Ba(c,k.hc),y.Ba(c,k.pd)],d=0;d<c.length;d++){var e=c[d];if(e)for(var e=e.za,f=0;f<e.length;f++)for(var g=e[f].ha,h=0;h<g.length;h++){var l=g[h].Y;if(l)for(var l=l.T,m=0;m<l.length;m++){var n=l[m];if("IMAGE"===n.source||"ENVIRONMENT_MAP"===n.source){var q=
n.Wa;-1===a.indexOf(q)&&(a.push(q),n=n.width*n.height*4/1048576/n.Gn,n*=1.3333,b+=n)}}}}return{number:a.length,memory:b}};a.num_render_targets=function(){for(var a=[],b=0,c=y.get_active(),c=y.Au(c),d=0;d<c.length;d++){var e=c[d];if(e.type!=k.hl){var f=e.o,g=[f.Zb,f.ge];g.push.apply(g,e.Sg);for(e=0;e<g.length;e++){var h=g[e];t.Pl(h)&&-1==a.indexOf(h)&&(a.push(h),b+=f.width*f.height*t.SJ(h))}}}return{number:a.length,memory:b/1024/1024}};a.make_camera_frustum_shot=function(){var a=y.get_active();(a=
y.Ba(a,k.pb))&&y.FA(a.o,a,[1,1,0])};a.make_light_frustum_shot=function(){var a=y.get_active(),b=y.Ba(a,k.pb),a=y.Bw(a,[k.Ac]);if(b)for(var c=0;c<a.length;c++){var d=a[c],e;switch(c){case 0:e=[1,0,0];break;case 1:e=[0,1,0];break;case 2:e=[0,0,1];break;default:e=[1,0,1]}y.FA(d.o,b,e)}};a.scenegraph_to_dot=function(){for(var a=y.io(),b=0;b<a.length;b++)w.log("\n"+A.iI(y.Gu(a[b])))};a.scenes_to_dot=function(){};a.loading_graph_to_dot=function(){w.log("\n"+l.WJ())};a.controls_info=m.debug;a.object_distance=
function(a,b){var c=m_tsr.get_trans_view(a.k.m),d=m_tsr.get_trans_view(b.k.m);return u.dist(c,d)};a.msg=B.msg;a.fbmsg=B.fbmsg;a.print_telemetry=B.print_telemetry;a.plot_telemetry=B.plot_telemetry;a.fbres=function(a,b){function c(){B.fbmsg("FBRES",a());setTimeout(c,b)}b||(b=16);c()};a.assert_constants=function(){var a=new Float32Array(3),b=new Float32Array([0,0,0,1]),c=new Float32Array([1,0,0]),d=new Float32Array([0,1,0]),e=new Float32Array([0,0,1]),f=new Float32Array([-1,0,0]),g=new Float32Array([0,
-1,0]),h=new Float32Array([0,0,-1]);if(!M.li(a,M.Gx))throw"Wrong VEC3_IDENT";if(!M.li(b,M.gt))throw"Wrong QUAT4_IDENT";if(!M.li(c,M.AXIS_X))throw"Wrong AXIS_X";if(!M.li(d,M.AXIS_Y))throw"Wrong AXIS_Y";if(!M.li(e,M.AXIS_Z))throw"Wrong AXIS_Z";if(!M.li(f,M.AXIS_MX))throw"Wrong AXIS_MX";if(!M.li(g,M.AXIS_MY))throw"Wrong AXIS_MY";if(!M.li(h,M.AXIS_MZ))throw"Wrong AXIS_MZ";};a.mute_music=function(){for(var a=G.get_speaker_objects(),b=0;b<a.length;b++){var c=a[b];"BACKGROUND_MUSIC"==G.Ju(c)&&G.mute(c,!0)}};
a.check_finite=function(a){B.check_finite(a)};a.set_debug_params=function(a){var b=y.get_active();if(b=y.Ba(b,k.ze)){if("number"==typeof a.debug_view_mode)switch(a.debug_view_mode){case B.DV_NONE:case B.DV_OPAQUE_WIREFRAME:case B.DV_TRANSPARENT_WIREFRAME:case B.DV_FRONT_BACK_VIEW:case B.DV_BOUNDINGS:case B.DV_CLUSTERS_VIEW:case B.DV_BATCHES_VIEW:case B.DV_RENDER_TIME:y.mM(b,a.debug_view_mode);break;default:w.error("set_debug_params(): Wrong debug view mode")}"number"==typeof a.debug_colors_seed&&
y.lM(b,a.debug_colors_seed);"number"==typeof a.VL&&y.LM(b,a.VL);"object"==typeof a.wireframe_edge_color&&y.SM(b,M.f32(a.wireframe_edge_color))}else w.error("Debugging is not available on the scene.")};a.get_error_quantity=function(){return w.CJ()};a.get_warning_quantity=function(){return w.UJ()};a.clear_errors_warnings=function(){return w.clear_errors_warnings()};a.analyze_shaders=function(a){var f=x.Lz(),h=0,l;for(l in f)a&&-1===l.indexOf(a)||h++;var h="of "+h+" analyzing...",k={};for(l in f)if(!a||
-1!==l.indexOf(a)){var m=f[l],n;var q=m.dD;n=m.xz;var p=d.Bu();if(p){var r=p.getTranslatedShaderSource(q),p=p.getTranslatedShaderSource(n);if(g.detect_mobile())var r=r.replace("#version","#version 300 //"),p=p.replace("#version","#version 300 //"),v=c("/analyze_shader/vert_gles",r),u=c("/analyze_shader/frag_gles",p);else r=r.replace("#version","#version 400 //"),p=p.replace("#version","#version 400 //"),v=c("/analyze_shader/vert",r),u=c("/analyze_shader/frag",p);var t=e(v),z=e(u);n={PO:B.Pz().getShaderSource(q),
QO:r,OO:v,RO:t,cJ:B.Pz().getShaderSource(n),dJ:p,VI:u,xu:z}}else w.error("WEBGL_debug_shaders extension not found"),n=void 0;r=m.Va;q=r.oj+" + "+r.zg;n.dI=m;n.Va=r;m=k[q]=k[q]||[];m.push(n);w.Qe(h)}for(q in k)w.group("%c"+q,"color: #800"),m=k[q],b(m),w.groupEnd()};a.fake_load=B.fake_load;a.test_performance=function(a){if(d.Du()){var b=A.rH();y.Cz(b);for(var c=A.$b(b,k.Gp),b=0;10>b;b++)E.yl(c);window.setTimeout(function(){B.IL(c);a(c.Ie)},100)}else a(-1)};a.start_debug=function(a){v=[];S=!0;a=p(a);
for(var b in a)"function"===typeof a[b]&&(a[b]=h(a[b],b))};a.check_debug_result=function(){return S};a.test=function(a,b){try{return b(),!0}catch(c){return S=!1,console.error(a+" test was failed. ",c),!1}};a.pix=function(a){var b=q.Xz(),c=q.Wz(),d=b/2,e=c/2;q.resize(b,c,!1);b=y.get_active().p.Oa;(c=A.SI(b))||M.q("Couldn't find onscreen subscene");b=c.o;d=q.gq(d,e,C,c.o);d[1]=b.height-d[1];d=E.Wv(b.je,d[0],d[1]);r(a,d,1)};a.eqs=function(a,b){if(JSON.stringify(a)!=JSON.stringify(b))throw"Wrong result. Function: "+
z;};a.eqv=r;a.eqf=function(a,b,c){if("number"!=typeof b)throw"Wrong expected data type.";c=c?c:1E-6;if(b>a+c||b<a-c)throw"Wrong result.";};a.eq=function(a,b){if(a!==b)throw"Wrong result.";};a.stat=function(a){a=p(a);for(var b in a)-1==v.indexOf(a[b])&&console.warn(b+" function wasn't called.")};a.ok=function(a){if(!Boolean(a))throw"Wrong result. Function: "+z;}};b4w.module.geometry=function(a,p){var e=p("__batch"),c=p("__geometry"),b=p("__print"),n=p("__renderer");a.extract_vertex_array=function(a,n,g){if(!c.Jl(a))return b.error("Wrong object:",a.name),null;if(a=e.Ma(a,n,"MAIN")){if((n=a.aa)&&n.vb&&n.vb[g])return c.JI(n,g);b.error("Attribute not found:"+g);return null}b.error("Wrong material:",n);return null};a.extract_index_array=function(a,n){if(!c.Jl(a))return b.error("Wrong object:",a.name),null;var g=e.Ma(a,n,"MAIN");if(g){if((g=g.aa)&&g.vb)return g.ke;
b.error("Buffer data not found");return null}b.error("Wrong material:",n);return null};a.update_vertex_array=function(a,n,g,m){var q=["MAIN","SHADOW","COLOR_ID"];if(c.Jl(a))for(var p=0;p<q.length;p++){var d=e.Ma(a,n,q[p]);d&&(d=d.aa)&&d.vb&&d.vb[g]&&c.FC(d,g,0,m)}else b.error("Wrong object:",a.name)};a.override_geometry=function(a,p,g,m,q){var B=["MAIN","SHADOW","COLOR_ID"];if(c.Jl(a))if(g instanceof Uint16Array||g instanceof Uint32Array)if(m instanceof Float32Array)for(var d=0;d<B.length;d++){var l=
e.Ma(a,p,B[d]);if(l){var f=l.aa;if(f){c.GC(f,l.Mf,g);var H=0,D;for(D in f.vb)var w=f.vb[D],H=H+m.length/3*w.Jb;f.Ic=new Float32Array(H);var H=f.Ic,E=0;for(D in f.vb)switch(w=f.vb[D],D){case "a_position":H.set(m,E);w.offset=E;w.length=m.length;E+=w.length;break;case "a_normal":var y;q&&(y=c.ny(g,m,m));var A=c.my(g,m,y);H.set(A,E);w.offset=E;w.length=m.length;E+=w.length;break;case "a_tangent":w.offset=E;w.length=m.length/3*w.Jb;for(var A=new Float32Array(w.length),G=0;G<A.length;G+=4)A[G]=1,A[G+3]=
1;H.set(A,E);E+=w.length;break;default:w.offset=E,w.length=m.length/3*w.Jb,A=new Float32Array(w.length),H.set(A,E),E+=w.length}c.Zw(f);n.st(l);(l=e.Le(a,l))&&l.aa&&(l.aa=f)}}}else b.error("Wrong positions_array type");else b.error("Wrong ibo_array type");else b.error("Wrong object:",a.name)};a.set_shape_key_value=function(a,e,g){c.check_shape_keys(a)?c.Pu(a,e)?c.Ux(a,e,parseFloat(g)):b.error("Wrong key name:",e):b.error("Wrong object:",a.name)};a.check_shape_keys=function(a){return c.check_shape_keys(a)};
a.get_shape_keys_names=function(a){return c.check_shape_keys(a)?c.get_shape_keys_names(a):(b.error("Wrong object:",a.name),null)};a.get_shape_key_value=function(a,e){return c.check_shape_keys(a)?c.Pu(a,e)?c.get_shape_key_value(a,e):(b.error("Wrong key name:",e),null):(b.error("Wrong object:",a.name),null)};a.draw_line=function(a,p,g){g=g||!1;if(p instanceof Float32Array){if(a=e.Fu(a))c.draw_line(a,p,g),n.st(a)}else b.error("Wrong positions type")}};b4w.module.hud=function(a,p){var e=p("__hud");p("__print");a.draw_mixer_strip=e.draw_mixer_strip;a.plot_array=e.plot_array};b4w.module.input=function(a,p){function e(a){var c=b.get_device_by_type_element(b.DEVICE_HMD);if(!c||!c.$f)return!1;if(f)return!0;var e=b.get_vector_param(c,b.oD,d),h=b.get_vector_param(c,b.pD,l);n.set_hmd_fov(a,e,h);if(e=b.get_value_param(c,D))h=q.get_active(),a=g.fa(a,h).R,n.set_eye_distance(a,e);a={base_line_factor:.5,inter_lens_factor:.5,enable_hmd_stereo:!0};b.get_value_param(b.HMD_WEBVR_TYPE)!==b.HMD_WEBVR1&&(a.distortion_coefs=[c.distortion_coefs[0],c.distortion_coefs[1]],a.chromatic_aberration_coefs=
[c.chromatic_aberration_coefs[0],c.chromatic_aberration_coefs[1],c.chromatic_aberration_coefs[2],c.chromatic_aberration_coefs[3]],c.Qm||(c.ci&&c.wi&&c.ei?a.base_line_factor=(c.ci-c.ei)/c.wi:c.ei||(a.base_line_factor=c.ci/c.wi)),c.nk&&c.Rm&&!c.Qm&&(a.inter_lens_factor=c.nk/c.Rm),H.enabled||(e=1+c.distortion_coefs[0]+c.distortion_coefs[1],q.OA(e,e)));q.set_hmd_params(a);r.resize_to_container(!0);b.reset_device(c);return f=!0}function c(){for(var a=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?
navigator.webkitGetGamepads:[],b=[],c=0;c<a.length;c++)a[c]&&b.push(c);return b}var b=p("__input"),n=p("__camera"),h=p("__config"),r=p("__container"),g=p("__obj_util"),m=p("__print"),q=p("__scenes"),B=p("__vec4"),d=B.create(),l=B.create(),f=!1,H=h.uq;a.GMPD_BUTTON_12=b.GMPD_BUTTON_12;a.GMPD_BUTTON_13=b.GMPD_BUTTON_13;a.GMPD_BUTTON_15=b.GMPD_BUTTON_15;a.GMPD_BUTTON_14=b.GMPD_BUTTON_14;a.GMPD_BUTTON_3=b.GMPD_BUTTON_3;a.GMPD_BUTTON_0=b.GMPD_BUTTON_0;a.GMPD_BUTTON_1=b.GMPD_BUTTON_1;a.GMPD_BUTTON_2=b.GMPD_BUTTON_2;
a.GMPD_BUTTON_5=b.GMPD_BUTTON_5;a.GMPD_BUTTON_7=b.GMPD_BUTTON_7;a.GMPD_BUTTON_4=b.GMPD_BUTTON_4;a.GMPD_BUTTON_6=b.GMPD_BUTTON_6;a.GMPD_BUTTON_8=b.GMPD_BUTTON_8;a.GMPD_BUTTON_9=b.GMPD_BUTTON_9;a.GMPD_BUTTON_10=b.GMPD_BUTTON_10;a.GMPD_BUTTON_11=b.GMPD_BUTTON_11;a.GMPD_BUTTON_16=b.GMPD_BUTTON_16;a.GMPD_BUTTON_17=b.GMPD_BUTTON_17;a.GMPD_BUTTON_18=b.GMPD_BUTTON_18;a.GMPD_BUTTON_19=b.GMPD_BUTTON_19;a.GMPD_BUTTON_20=b.GMPD_BUTTON_20;a.GMPD_BUTTON_21=b.GMPD_BUTTON_21;a.GMPD_BUTTON_22=b.GMPD_BUTTON_22;a.GMPD_BUTTON_23=
b.GMPD_BUTTON_23;a.GMPD_BUTTON_24=b.GMPD_BUTTON_24;a.GMPD_BUTTON_25=b.GMPD_BUTTON_25;a.GMPD_AXIS_0=b.GMPD_AXIS_0;a.GMPD_AXIS_1=b.GMPD_AXIS_1;a.GMPD_AXIS_2=b.GMPD_AXIS_2;a.GMPD_AXIS_3=b.GMPD_AXIS_3;a.GMPD_AXIS_4=b.GMPD_AXIS_4;a.GMPD_AXIS_5=b.GMPD_AXIS_5;a.GMPD_AXIS_6=b.GMPD_AXIS_6;a.GMPD_AXIS_7=b.GMPD_AXIS_7;a.GMPD_AXIS_8=b.GMPD_AXIS_8;a.GMPD_AXIS_9=b.GMPD_AXIS_9;a.GMPD_AXIS_10=b.GMPD_AXIS_10;a.GMPD_AXIS_11=b.GMPD_AXIS_11;a.HMD_ORIENTATION_QUAT=b.HMD_ORIENTATION_QUAT;a.HMD_POSITION=b.HMD_POSITION;
a.HMD_WEBVR_TYPE=b.HMD_WEBVR_TYPE;a.HMD_WEBVR_DESKTOP=b.HMD_WEBVR_DESKTOP;a.HMD_WEBVR_MOBILE=b.HMD_WEBVR_MOBILE;a.HMD_NON_WEBVR=b.HMD_NON_WEBVR;a.HMD_WEBVR1=b.HMD_WEBVR1;var D=b.HMD_EYE_DISTANCE;a.HMD_EYE_DISTANCE=D;a.HMD_DISTORTION=b.HMD_DISTORTION;a.HMD_BASELINE_DIST=b.HMD_BASELINE_DIST;a.HMD_SCREEN_LENSE_DIST=b.HMD_SCREEN_LENSE_DIST;a.HMD_SCREEN_WIDTH=b.HMD_SCREEN_WIDTH;a.HMD_SCREEN_HEIGHT=b.HMD_SCREEN_HEIGHT;a.HMD_BEVEL_SIZE=b.HMD_BEVEL_SIZE;a.MOUSE_LOCATION=b.MOUSE_LOCATION;a.MOUSE_DOWN_WHICH=
b.MOUSE_DOWN_WHICH;a.MOUSE_UP_WHICH=b.MOUSE_UP_WHICH;a.MOUSE_WHEEL=b.MOUSE_WHEEL;a.KEYBOARD_UP=b.KEYBOARD_UP;a.KEYBOARD_DOWN=b.KEYBOARD_DOWN;a.TOUCH_START=b.TOUCH_START;a.TOUCH_MOVE=b.TOUCH_MOVE;a.TOUCH_END=b.TOUCH_END;a.GYRO_ORIENTATION_QUAT=b.GYRO_ORIENTATION_QUAT;a.GYRO_ORIENTATION_ANGLES=b.GYRO_ORIENTATION_ANGLES;var w={};w[b.DEVICE_HMD]=[b.HMD_ORIENTATION_QUAT,b.HMD_POSITION];w[b.DEVICE_MOUSE]=[b.MOUSE_LOCATION];var E={};E[b.DEVICE_HMD]=[b.HMD_WEBVR_TYPE];var y={};y[b.DEVICE_MOUSE]=[b.MOUSE_LOCATION,
b.MOUSE_DOWN_WHICH,b.MOUSE_UP_WHICH,b.MOUSE_WHEEL];y[b.DEVICE_KEYBOARD]=[b.KEYBOARD_UP,b.KEYBOARD_DOWN];y[b.DEVICE_TOUCH]=[b.TOUCH_START,b.TOUCH_MOVE,b.TOUCH_END];y[b.DEVICE_GYRO]=[b.GYRO_ORIENTATION_QUAT,b.GYRO_ORIENTATION_ANGLES];var A={};A[b.DEVICE_HMD]=[b.HMD_DISTORTION,b.HMD_EYE_DISTANCE,b.HMD_BASELINE_DIST,b.HMD_SCREEN_LENSE_DIST,b.HMD_SCREEN_WIDTH,b.HMD_SCREEN_HEIGHT,b.HMD_BEVEL_SIZE];a.DEVICE_GYRO=b.DEVICE_GYRO;a.DEVICE_HMD=b.DEVICE_HMD;a.DEVICE_MOUSE=b.DEVICE_MOUSE;a.DEVICE_KEYBOARD=b.DEVICE_KEYBOARD;
a.DEVICE_TOUCH=b.DEVICE_TOUCH;a.can_use_device=b.can_use_device;a.get_device_by_type_element=b.get_device_by_type_element;a.switch_prevent_default=function(a,c){a&&b.switch_prevent_default(a,c)};a.register_device=function(){m.uc("input.register_device() deprecated")};a.reset_device=function(a){a&&a.type==b.DEVICE_HMD?b.reset_device(a):m.error("reset_device is undefined for device.")};a.get_vector_param=function(a,c,d){if(a&&a.type in w&&0<=w[a.type].indexOf(c))return b.get_vector_param(a,c,d);m.error("device hasn't param: ",
c)};a.get_value_param=function(a,c){if(a&&a.type in E&&0<=E[a.type].indexOf(c))return b.get_value_param(a,c);m.error("device hasn't param: ",c)};a.attach_param_cb=function(a,c,d){if(a&&a.type in y&&0<=y[a.type].indexOf(c))return b.attach_param_cb(a,c,d);m.error("device hasn't param: ",c)};a.detach_param_cb=function(a,c,d){if(a&&a.type in y&&0<=y[a.type].indexOf(c))return b.detach_param_cb(a,c,d);m.error("device hasn't param: ",c)};a.set_config=function(a,c,d){if(a&&a.type in A&&0<=A[a.type].indexOf(c))return b.set_config(a,
c,d);m.error("device hasn't config: ",c)};a.request_fullscreen_hmd=function(){if(q.ya()){var a=q.gk(q.get_active());if(a&&(e(a),a=b.get_device_by_type_element(b.DEVICE_HMD))&&(a=a.af))if(a.capabilities.canPresent){var c=r.get_canvas();a.requestPresent([{source:c}]).then(function(){},function(){m.error("HMD fullscreen request failed.")})}else m.error("HMD fullscreen request failed.")}};a.enable_split_screen=e;a.disable_split_screen=function(){var a=b.get_device_by_type_element(b.DEVICE_HMD);if(!(f||
a&&a.$f))return!1;q.set_hmd_params({enable_hmd_stereo:!1});a=1/(1+a.distortion_coefs[0]+a.distortion_coefs[1]);q.OA(a,a);r.resize_to_container(!0);return!0};a.set_gamepad_key=function(a,d,e){c();switch(a){case 0:a=b.Ap;break;case 1:a=b.Zs;break;case 2:a=b.$s;break;case 3:a=b.at;break;default:a=b.Ap}a=b.get_device_by_type_element(a);b.set_config(a,d,e)};a.get_pressed_gmpd_btn=b.get_pressed_gmpd_btn;a.get_moved_gmpd_axis=b.get_moved_gmpd_axis;a.check_enable_gamepad_indices=c};b4w.module.lights=function(a,p){function e(a){for(var c=g.get_active(),e=n.yb(c,"LAMP",n.DATA_ID_ALL),f=0;f<e.length;f++){var h=e[f];if("SUN"==h.Pa.type){var p=h;break}}if(!p)r.error("There is no sun on the scene");else if("number"==typeof a.hor_position&&"number"==typeof a.vert_position){e=B.deg_to_rad(180-a.hor_position);a=B.deg_to_rad(90-a.vert_position);f=p.k;m.set_rotation_euler(p,[a,e,0]);e=new Float32Array(3);h=q.get_quat_view(f.m);B.quat_to_dir(h,B.AXIS_Y,e);f=q.get_trans_view(f.m);f=d.length(f);
d.copy(e,l);d.scale(l,f,l);m.set_translation(p,l);m.u(p);e=p.Pa;if(e.iz){var x=c.world.light_settings.environment_energy,f=c.world.horizon_color,h=c.world.zenith_color,k=Math.cos(Math.abs(a));a=Math.max(Math.min(3*k,1),0)*e.az;x*=Math.max(k,.1);b.set_light_energy(e,a);g.set_environment_colors(c,x,f,h)}g.Jm(p,c)}}function c(a){if(h.is_lamp(a))return a.Pa.type;r.error("get_light_type(): Wrong object");return!1}var b=p("__lights"),n=p("__objects"),h=p("__obj_util"),r=p("__print"),g=p("__scenes"),m=p("__transform"),
q=p("__tsr"),B=p("__util"),d=p("__vec3"),l=new Float32Array(3),f,H=60;a.get_lamps=function(a){var b=g.get_active(),b=n.yb(b,"LAMP",n.DATA_ID_ALL);if(!a)return b;for(var c=[],d=0;d<b.length;d++){var e=b[d];e.Pa.type===a&&c.push(e)}return c};a.get_sun_params=function(){for(var a=g.get_active(),a=n.yb(a,"LAMP",n.DATA_ID_ALL),b=null,c=0;c<a.length;c++){var d=a[c];if("SUN"==d.Pa.type){b=d;break}}return b?(b=b.Pa.direction,a=B.rad_to_deg(Math.atan2(b[2],b[0]))+90,180<a&&(a-=360),b=B.rad_to_deg(Math.atan2(b[1],
Math.sqrt(b[0]*b[0]+b[2]*b[2]))),c={},c.hor_position=a,c.vert_position=b,c):null};a.set_sun_params=e;a.set_day_time=function(a){for(var b=g.get_active(),b=n.yb(b,"LAMP",n.DATA_ID_ALL),c=0;c<b.length;c++){var d=b[c];if("SUN"==d.Pa.type){var f=d;break}}f?(f=-Math.cos(a/12*Math.PI)*H,b={},b.hor_position=12>a?15*a:15*(a-24),b.vert_position=f,e(b)):r.error("There is no sun on the scene")};a.set_date=function(a){(f=a.getDate())?1582==f&&10==a.jR&&4<a.hI&&15>a.hI&&r.error("The dates 5 through 14 October, 1582, do not exist in the Gregorian system!"):
r.error("There is no year 0 in the Julian system!")};a.set_max_sun_angle=function(a){H=Math.min(Math.max(a,0),90)};a.get_light_params=function(a){if(h.is_lamp(a))var b=a.Pa;else return r.error("get_light_params(): Wrong object"),null;if(a=c(a))switch(a){case "SPOT":var d={light_type:a,light_color:new Float32Array(3),light_energy:b.Je,light_spot_blend:b.hp,light_spot_size:b.Ok,light_distance:b.distance};d.light_color.set(b.color);break;case "POINT":d={light_type:a,light_color:new Float32Array(3),light_energy:b.Je,
light_distance:b.distance};d.light_color.set(b.color);break;default:d={light_type:a,light_color:new Float32Array(3),light_energy:b.Je},d.light_color.set(b.color)}return d?d:null};a.get_light_type=c;a.set_light_params=function(a,c){if(h.is_lamp(a)){var d=a.Pa,e=g.get_active(),f=!1;"number"==typeof c.light_energy&&b.set_light_energy(d,c.light_energy);"object"==typeof c.light_color&&b.set_light_color(d,c.light_color);"number"==typeof c.light_spot_blend&&(b.CM(d,c.light_spot_blend),f=!0);"number"==typeof c.light_spot_size&&
(b.DM(d,c.light_spot_size),f=!0);"number"==typeof c.light_distance&&(b.BM(d,c.light_distance),f=!0);g.Jm(a,e);f&&n.NN(e)}else r.error("set_light_params(): Wrong object")};a.get_light_energy=function(a){return h.is_lamp(a)?a.Pa.Je:(r.error("get_light_energy(): Wrong object"),0)};a.set_light_energy=function(a,c){if(h.is_lamp(a)){var d=g.get_active();b.set_light_energy(a.Pa,c);g.Jm(a,d)}else r.error("set_light_energy(): Wrong object")};a.get_light_color=function(a,b){if(!h.is_lamp(a))return r.error("get_light_color(): Wrong object"),
null;b=b||new Float32Array(3);b.set(a.Pa.color);return b};a.set_light_color=function(a,c){if(h.is_lamp(a)){var d=g.get_active();b.set_light_color(a.Pa,c);g.Jm(a,d)}else r.error("set_light_color(): Wrong object")}};b4w.module.logic_nodes=function(a,p){var e=p("__logic_nodes");a.append_custom_callback=function(a,b){e.nF(a,b)};a.remove_custom_callback=function(a){e.NL(a)};a.run_entrypoint=function(a,b){e.dM(a,b)}};b4w.module.material=function(a,p){function e(a,b){for(var c=a.C[0].P,e=0;e<c.length;e++){var g=c[e];if(-1<g.lc.indexOf(b)&&"MAIN"==g.type)return!0}return!1}function c(a,b){var c=n.Ma(a,b,"MAIN");return Boolean(c&&c.Dd[0])}function b(a,b){var c=n.Ma(a,b,"MAIN");return Boolean(c&&c.Dd[1])}var n=p("__batch"),h=p("__config"),r=p("__obj_util"),g=p("__print"),m=p("__shaders"),q=p("__util"),B=h.v;a.inherit_material=function(a,b,c,e){r.pk(c)&&r.pk(a)?n.inherit_material(a,b,c,e):g.error("Wrong or batched object(s)")};
a.get_materials_names=function(a){var b=[];a=a.C;for(var c=0;c<a.length;c++)for(var e=a[c].P,g=0;g<e.length;g++)for(var h=0;h<e[g].lc.length;h++)-1==b.indexOf(e[g].lc[h])&&b.push(e[g].lc[h]);return b};a.set_diffuse_color=function(a,b,c){var e=n.Ma(a,b,"MAIN");e?(e.Zc.set(c),(a=n.Le(a,b,"MAIN"))&&a.Zc.set(c)):g.error('Couldn\'t set property "diffuse_color"!')};a.get_diffuse_color=function(a,b){var c=n.Ma(a,b,"MAIN");if(c){var e=new Float32Array(4);e.set(c.Zc);return e}g.error('Couldn\'t get property "diffuse_color"!')};
a.set_diffuse_intensity=function(a,b,c){var e=n.Ma(a,b,"MAIN");if(e){if(e.vg=c,a=n.Le(a,b,"MAIN"))a.vg=c}else g.error('Couldn\'t set property "diffuse_color"!')};a.get_diffuse_intensity=function(a,b){var c=n.Ma(a,b,"MAIN");if(c)return c.vg;g.error('Couldn\'t get property "diffuse_intensity"!')};a.set_specular_color=function(a,b,c){var e=n.Ma(a,b,"MAIN");e?(e.Cf.set(c),(a=n.Le(a,b,"MAIN"))&&a.Cf.set(c)):g.error('Couldn\'t set property "specular_color"!')};a.get_specular_color=function(a,b){var c=n.Ma(a,
b,"MAIN");if(c){var e=Array(3);e[0]=c.Cf[0];e[1]=c.Cf[1];e[2]=c.Cf[2];return e}g.error('Couldn\'t get property "specular_color"!')};a.set_specular_color_factor=function(a,b,c){var e=n.Ma(a,b,"MAIN");if(e){if(e.Lh=c,a=n.Le(a,b,"MAIN"))a.Lh=c}else g.error('Couldn\'t set property "specular_color_factor"!')};a.get_specular_color_factor=function(a,b){var c=n.Ma(a,b,"MAIN");if(c)return c.Lh;g.error('Couldn\'t get property "specular_color_factor"!')};a.set_specular_intensity=function(a,b,e){c(a,b)||g.error('Property "specular_intensity" is missing!');
n.Ma(a,b,"MAIN").Dd[0]=e;(a=n.Le(a,b,"MAIN"))&&(a.Dd[0]=e)};a.get_specular_intensity=function(a,b){c(a,b)||g.error('Property "specular_intensity" is missing!');return n.Ma(a,b,"MAIN").Dd[0]};a.check_specular_intensity=c;a.set_specular_hardness=function(a,c,e){b(a,c)||g.error('Property "specular_hardness" is missing!');n.Ma(a,c,"MAIN").Dd[1]=e;(a=n.Le(a,c,"MAIN"))&&(a.Dd[1]=e)};a.get_specular_hardness=function(a,c){b(a,c)||g.error('Property "specular_hardness" is missing!');return n.Ma(a,c,"MAIN").Dd[1]};
a.check_specular_hardness=b;a.set_emit_factor=function(a,b,c){var e=n.Ma(a,b,"MAIN");if(e){if(e.Nf=c,a=n.Le(a,b,"MAIN"))a.Nf=c}else g.error('Couldn\'t set property "emit_factor"!')};a.get_emit_factor=function(a,b){var c=n.Ma(a,b,"MAIN");if(c)return c.Nf;g.error('Couldn\'t get property "emit_factor"!')};a.set_ambient_factor=function(a,b,c){var e=n.Ma(a,b,"MAIN");if(e){if(e.Gf=c,a=n.Le(a,b,"MAIN"))a.Gf=c}else g.error('Couldn\'t set property "ambient_factor"!')};a.get_ambient_factor=function(a,b){var c=
n.Ma(a,b,"MAIN");if(c)return c.Gf;g.error('Couldn\'t get property "ambient_factor"!')};a.set_diffuse_color_factor=function(a,b,c){var e=n.Ma(a,b,"MAIN");if(e){if(e.ug=c,a=n.Le(a,b,"MAIN"))a.ug=c}else g.error('Couldn\'t set property "diffuse_color_factor"!')};a.get_diffuse_color_factor=function(a,b){var c=n.Ma(a,b,"MAIN");if(c)return c.ug;g.error('Couldn\'t get property "diffuse_color_factor"!')};a.set_alpha_factor=function(a,b,c){var e=n.Ma(a,b,"MAIN");if(e){if(e.mg=c,a=n.Le(a,b,"MAIN"))a.mg=c}else g.error('Couldn\'t set property "alpha_factor"!')};
a.get_alpha_factor=function(a,b){var c=n.Ma(a,b,"MAIN");if(c)return c.mg;g.error('Couldn\'t get property "alpha_factor"!')};a.get_material_extended_params=function(a,b){if(!a||!b)return g.error("missing arguments in get_material_params"),null;if(!e(a,b))return null;var c=n.Ma(a,b,"MAIN");if(!c)return null;var h={};"MAIN"==c.type&&(h.reflect_factor=c.reflect_factor,h.fresnel=c.Me[2],h.fresnel_factor=5*(1-c.Me[3]),h.parallax_scale=c.parallax_scale,h.parallax_steps=n.bd(c,"PARALLAX_STEPS")[1]);return h};
a.get_water_material_params=function(a,b){if(!a||!b)return g.error("missing arguments in get_water_material_params"),null;if(!e(a,b))return null;var c=n.Ma(a,b,"MAIN");if(!c||!c.Wg)return null;if(!c)return g.error("material not found"),null;var h={};if("MAIN"==c.type){if(B.mm){var m=h.shallow_water_col=Array(3);m[0]=c.shallow_water_col[0];m[1]=c.shallow_water_col[1];m[2]=c.shallow_water_col[2];m=h.shore_water_col=Array(3);m[0]=c.shore_water_col[0];m[1]=c.shore_water_col[1];m[2]=c.shore_water_col[2];
h.shallow_water_col_fac=c.shallow_water_col_fac;h.shore_water_col_fac=c.shore_water_col_fac}h.foam_factor=c.foam_factor;h.norm_uv_velocity=c.rj;h.absorb_factor=n.bd(c,"ABSORB")[1];h.sss_strength=n.bd(c,"SSS_STRENGTH")[1];h.sss_width=n.bd(c,"SSS_WIDTH")[1];h.dst_noise_scale0=n.bd(c,"DST_NOISE_SCALE_0")[1];h.dst_noise_scale1=n.bd(c,"DST_NOISE_SCALE_1")[1];h.dst_noise_freq0=n.bd(c,"DST_NOISE_FREQ_0")[1];h.dst_noise_freq1=n.bd(c,"DST_NOISE_FREQ_1")[1];h.dir_min_shore_fac=n.bd(c,"DIR_MIN_SHR_FAC")[1];
h.dir_freq=n.bd(c,"DIR_FREQ")[1];h.dir_noise_scale=n.bd(c,"DIR_NOISE_SCALE")[1];h.dir_noise_freq=n.bd(c,"DIR_NOISE_FREQ")[1];h.dir_min_noise_fac=n.bd(c,"DIR_MIN_NOISE_FAC")[1];h.dst_min_fac=n.bd(c,"DST_MIN_FAC")[1];h.waves_hor_fac=n.bd(c,"WAVES_HOR_FAC")[1]}return h};a.set_material_extended_params=function(a,b,c){if(a&&b&&c)if(e(a,b)){var h=n.Ma(a,b,"MAIN");if(h){var q=[h];(h=n.Le(a,b,"MAIN"))&&q.push(h);for(a=0;a<q.length;a++)h=q[a],"number"==typeof c.material_reflectivity&&(h.reflect_factor=c.material_reflectivity),
"number"==typeof c.material_fresnel&&(h.Me[2]=c.material_fresnel),"number"==typeof c.material_fresnel_factor&&(h.Me[3]=1-c.material_fresnel_factor/5),"number"==typeof c.material_parallax_scale&&(h.parallax_scale=c.material_parallax_scale),"number"==typeof c.material_parallax_steps&&(b=m.D(parseFloat(c.material_parallax_steps)),n.Sa(h,"PARALLAX_STEPS",b),n.gc(h))}else g.error("material not found")}else g.error("setting material params is not possible");else g.error("missing arguments in set_material_params")};
a.set_water_material_params=function(a,b,c){if(a&&b&&c)if(e(a,b)){var h=n.Ma(a,b,"MAIN");if(h){var q=[h];(h=n.Le(a,b,"MAIN"))&&q.push(h);for(a=0;a<q.length;a++)h=q[a],B.mm&&("object"==typeof c.shallow_water_col&&h.shallow_water_col.set(c.shallow_water_col),"number"==typeof c.shallow_water_col_fac&&(h.shallow_water_col_fac=c.shallow_water_col_fac),"object"==typeof c.shore_water_col&&h.shore_water_col.set(c.shore_water_col),"number"==typeof c.shore_water_col_fac&&(h.shore_water_col_fac=c.shore_water_col_fac)),
B.shore_smoothing&&h.Pm&&("boolean"==typeof c.shore_smoothing&&(c.shore_smoothing?n.Sa(h,"SHORE_SMOOTHING",1):n.Sa(h,"SHORE_SMOOTHING",0)),"number"==typeof c.absorb_factor&&(b=m.D(parseFloat(c.absorb_factor)),n.Sa(h,"ABSORB",b))),"number"==typeof c.foam_factor&&B.Dl&&(h.foam_factor=c.foam_factor),"number"==typeof c.norm_uv_velocity&&(h.rj=c.norm_uv_velocity),B.water_dynamic&&h.water_dynamic&&("boolean"==typeof c.water_dynamic&&(c.water_dynamic?n.Sa(h,"DYNAMIC",1):n.Sa(h,"DYNAMIC",0)),"number"==typeof c.waves_height&&
(b=m.D(parseFloat(c.waves_height)),n.Sa(h,"WAVES_HEIGHT",b)),"number"==typeof c.waves_length&&(b=m.D(parseFloat(c.waves_length)),n.Sa(h,"WAVES_LENGTH",b)),"number"==typeof c.sss_strength&&(b=m.D(parseFloat(c.sss_strength)),n.Sa(h,"SSS_STRENGTH",b)),"number"==typeof c.sss_width&&(b=m.D(parseFloat(c.sss_width)),n.Sa(h,"SSS_WIDTH",b)),"number"==typeof c.dst_noise_scale0&&(b=m.D(parseFloat(c.dst_noise_scale0)),n.Sa(h,"DST_NOISE_SCALE_0",b)),"number"==typeof c.dst_noise_scale1&&(b=m.D(parseFloat(c.dst_noise_scale1)),
n.Sa(h,"DST_NOISE_SCALE_1",b)),"number"==typeof c.dst_noise_freq0&&(b=m.D(parseFloat(c.dst_noise_freq0)),n.Sa(h,"DST_NOISE_FREQ_0",b)),"number"==typeof c.dst_noise_freq1&&(b=m.D(parseFloat(c.dst_noise_freq1)),n.Sa(h,"DST_NOISE_FREQ_1",b)),"number"==typeof c.dir_min_shore_fac&&(b=m.D(parseFloat(c.dir_min_shore_fac)),n.Sa(h,"DIR_MIN_SHR_FAC",b)),"number"==typeof c.dir_freq&&(b=m.D(parseFloat(c.dir_freq)),n.Sa(h,"DIR_FREQ",b)),"number"==typeof c.dir_noise_scale&&(b=m.D(parseFloat(c.dir_noise_scale)),
n.Sa(h,"DIR_NOISE_SCALE",b)),"number"==typeof c.dir_noise_freq&&(b=m.D(parseFloat(c.dir_noise_freq)),n.Sa(h,"DIR_NOISE_FREQ",b)),"number"==typeof c.dir_min_noise_fac&&(b=m.D(parseFloat(c.dir_min_noise_fac)),n.Sa(h,"DIR_MIN_NOISE_FAC",b)),"number"==typeof c.dst_min_fac&&(b=m.D(parseFloat(c.dst_min_fac)),n.Sa(h,"DST_MIN_FAC",b)),"number"==typeof c.waves_hor_fac&&(b=m.D(parseFloat(c.waves_hor_fac)),n.Sa(h,"WAVES_HOR_FAC",b))),n.gc(h)}else g.error("material not found")}else g.error("setting water material params is not possible");
else g.error("missing arguments in set_water_material_params")};a.set_line_params=function(a,b){var c=n.Fu(a);c?(q.sf(b.color)&&c.Zc.set(b.color),q.sf(b.width)&&(c.Ul=b.width)):g.error("Couldn't set line params!")};a.get_line_params=function(a){if(a=n.Fu(a))return{color:new Float32Array(a.Zc),width:a.Ul};g.error("Couldn't get line params");return null}};b4w.module.math=function(a,p){var e=p("__vec3"),c=p("__util"),b=p("__math"),n=new Float32Array(3);a.create_pline_from_points=function(a,c){var g=new Float32Array(6);b.JM(g,a);e.subtract(c,a,n);b.set_pline_directional_vec(g,n);return g};a.create_pline_from_point_vec=function(a,c){var e=new Float32Array(6);b.JM(e,a);b.set_pline_directional_vec(e,c);return e};a.create_pline=function(){return new Float32Array(6)};a.get_pline_directional_vec=b.get_pline_directional_vec;a.get_pline_initial_point=b.get_pline_initial_point;
a.set_pline_initial_point=b.set_pline_initial_point;a.set_pline_directional_vec=b.set_pline_directional_vec;a.line_plane_intersect=c.line_plane_intersect;a.calc_pline_point=b.calc_pline_point;a.point_plane_dist=b.point_plane_dist};b4w.module.particles=function(a,p){var e=p("__particles"),c=p("__print");a.set_size=function(a,n,h){e.cm(a)?e.set_size(a,n,h):c.error('"',a.name,'" has no particle systems')};a.set_normal_factor=function(a,n,h){e.cm(a)?e.set_normal_factor(a,n,h):c.error('"',a.name,'" has no particle systems')};a.set_factor=function(a,n,h){e.cm(a)?(h=Math.min(h,1),h=Math.max(h,0),e.set_factor(a,n,h)):c.error('"',a.name,'" has no particle systems')}};b4w.module.physics=function(a,p){p("__config");var e=p("__ipc"),c=p("__physics"),b=p("__print"),n=p("__util");a.CM_WALK=0;a.CM_RUN=1;a.CM_CLIMB=2;a.CM_FLY=3;a.enable_simulation=function(a){c.ia(a)?c.enable_simulation(a):b.error("No physics for object "+a.name)};a.disable_simulation=function(a){c.ia(a)?c.disable_simulation(a):b.error("No physics for object "+a.name)};a.has_physics=function(a){return c.ia(a)};a.has_simulated_physics=function(a){return c.has_simulated_physics(a)};a.has_dynamic_physics=
function(a){return c.has_dynamic_physics(a)};a.set_gravity=function(a,e){c.ia(a)?c.set_gravity(a,e):b.error("No physics for object "+a.name)};a.set_damping=function(a,e,g){c.ia(a)?c.S("set_damping",a.A.M,e,g):b.error("No physics for object "+a.name)};a.reset_damping=function(a){if(c.ia(a)){var e=a.Zf;c.S("set_damping",a.A.M,e.hu,e.fw)}else b.error("No physics for object "+a.name)};a.set_transform=function(a,e,g){c.ia(a)?c.set_transform(a,e,g):b.error("No physics for object "+a.name)};a.sync_transform=
function(a){c.ia(a)?c.sync_transform(a):b.error("No physics for object "+a.name)};a.apply_velocity=function(a,e,g,m){c.ia(a)?c.apply_velocity(a,e,g,m):b.error("No physics for object "+a.name)};a.apply_velocity_world=function(a,e,g,m){c.ia(a)?c.apply_velocity_world(a,e,g,m):b.error("No physics for object "+a.name)};a.apply_force=function(a,e,g,m){c.ia(a)?c.apply_force(a,e,g,m,!1):b.error("No physics for object "+a.name)};a.apply_force_world=function(a,e,g,m){c.ia(a)?c.apply_force(a,e,g,m,!0):b.error("No physics for object "+
a.name)};a.apply_torque=function(a,e,g,m){c.ia(a)?c.apply_torque(a,e,g,m):b.error("No physics for object "+a.name)};a.vehicle_throttle=function(a,e){c.ia(a)?(c.is_vehicle_chassis(a)||c.is_vehicle_hull(a)||b.error("Wrong object"),c.vehicle_throttle(a,n.clamp(e,-1,1))):b.error("No physics for object "+a.name)};a.vehicle_throttle_inc=function(a,e,g){if(c.ia(a)){c.is_vehicle_chassis(a)||c.is_vehicle_hull(a)||b.error("Wrong object");e=n.clamp(e,0,1);var m=a.s.zl;-1==g||1==g?m=Math.max(-1,Math.min(m+g*
e,1)):0==g&&0<=m?(m-=e,m=Math.max(0,m)):0==g&&0>m?(m+=e,m=Math.min(0,m)):b.error("Wrong steering direction");c.vehicle_throttle(a,n.clamp(m,-1,1))}else b.error("No physics for object "+a.name)};a.vehicle_steer=function(a,e){c.ia(a)?(c.is_vehicle_chassis(a)||c.is_vehicle_hull(a)||b.error("Wrong object"),c.vehicle_steer(a,n.clamp(e,-1,1))):b.error("No physics for object "+a.name)};a.vehicle_steer_inc=function(a,e,g){if(c.ia(a)){c.is_vehicle_chassis(a)||c.is_vehicle_hull(a)||b.error("Wrong object");
e=n.clamp(e,0,1);var m=a.s.vm;-1==g||1==g?m=Math.max(-1,Math.min(m+g*e,1)):0==g&&0<=m?(m-=e,m=Math.max(0,m)):0==g&&0>m?(m+=e,m=Math.min(0,m)):b.error("Wrong steering direction");c.vehicle_steer(a,n.clamp(m,-1,1))}else b.error("No physics for object "+a.name)};a.vehicle_brake=function(a,e){c.ia(a)?(c.is_vehicle_chassis(a)||c.is_vehicle_hull(a)||b.error("Wrong object"),c.vehicle_brake(a,n.clamp(e,0,1))):b.error("No physics for object "+a.name)};a.vehicle_brake_inc=function(a,e){if(c.ia(a)){c.is_vehicle_chassis(a)||
c.is_vehicle_hull(a)||b.error("Wrong object");e=n.clamp(e,-1,1);var g=a.s.pn;c.vehicle_brake(a,n.clamp(g+g*e,0,1))}else b.error("No physics for object "+a.name)};a.is_vehicle_chassis=function(a){return c.is_vehicle_chassis(a)};a.is_vehicle_hull=function(a){return c.is_vehicle_hull(a)};a.get_vehicle_name=function(a){if(!c.ia(a))return b.error("No physics for object "+a.name),null;if(c.is_vehicle_chassis(a)||c.is_vehicle_hull(a))return a.we.name;b.error("Wrong object");return null};a.get_vehicle_throttle=
function(a){if(!c.ia(a))return b.error("No physics for object "+a.name),null;if(c.is_vehicle_chassis(a)||c.is_vehicle_hull(a))return a.s.zl;b.error("Wrong object");return null};a.get_vehicle_steering=function(a){if(!c.ia(a))return b.error("No physics for object "+a.name),null;if(c.is_vehicle_chassis(a)||c.is_vehicle_hull(a))return a.s.vm;b.error("Wrong object")};a.get_vehicle_brake=function(a){if(!c.ia(a))return b.error("No physics for object "+a.name),null;if(c.is_vehicle_chassis(a)||c.is_vehicle_hull(a))return a.s.pn;
b.error("Wrong object")};a.get_vehicle_speed=function(a){if(!c.ia(a))return b.error("No physics for object "+a.name),null;if(c.is_vehicle_chassis(a)||c.is_vehicle_hull(a))return c.get_vehicle_speed(a);b.error("Wrong object")};a.is_character=function(a){return c.is_character(a)};a.set_character_move_dir=function(a,e,g){c.ia(a)?c.set_character_move_dir(a,e,g):b.error("No physics for object "+a.name)};a.set_character_move_type=function(a,e){c.ia(a)?c.set_character_move_type(a,e):b.error("No physics for object "+
a.name)};a.set_character_walk_velocity=function(a,e){c.ia(a)?c.set_character_walk_velocity(a,e):b.error("No physics for object "+a.name)};a.set_character_run_velocity=function(a,e){c.ia(a)?c.set_character_run_velocity(a,e):b.error("No physics for object "+a.name)};a.set_character_fly_velocity=function(a,e){c.ia(a)?c.set_character_fly_velocity(a,e):b.error("No physics for object "+a.name)};a.character_jump=function(a){c.ia(a)?c.character_jump(a):b.error("No physics for object "+a.name)};a.character_rotation_inc=
function(a,e,g){c.ia(a)?c.character_rotation_inc(a,e,g):b.error("No physics for object "+a.name)};a.set_character_rotation=function(a,e,g){c.ia(a)?c.set_character_rotation(a,e,g):b.error("No physics for object "+a.name)};a.set_character_rotation_v=function(a,e){c.ia(a)?c.set_character_rotation_v(a,e):b.error("No physics for object "+a.name)};a.set_character_rotation_h=function(a,e){c.ia(a)?c.set_character_rotation_h(a,e):b.error("No physics for object "+a.name)};a.append_collision_test=function(a,
e,g,m){c.ia(a)?c.append_collision_test(a,e,g,m||!1):b.error("No physics for object "+a.name)};a.remove_collision_test=function(a,e,g){c.ia(a)?c.remove_collision_test(a,e||"ANY",g):b.error("No physics for object "+a.name)};a.apply_collision_impulse_test=function(a,e){c.ia(a)?c.apply_collision_impulse_test(a,e):b.error("No physics for object "+a.name)};a.clear_collision_impulse_test=function(a){c.ia(a)?c.clear_collision_impulse_test(a):b.error("No physics for object "+a.name)};a.append_ray_test=function(a,
e,g,m,n,p){a=a||null;if(null==a||c.ia(a))return c.append_ray_test(a,e,g,m,n,p||!1,!1,!1,!1);b.error("No physics for object "+a.name)};a.append_ray_test_ext=function(a,e,g,m,n,p,d,l,f){a=a||null;if(null==a||c.ia(a))return c.append_ray_test(a,e,g,m,n,p||!1,d||!1,l||!1,f||!1);b.error("No physics for object "+a.name)};a.remove_ray_test=function(a){c.mA(a)?c.remove_ray_test(a):b.error("Wrong ray test ID")};a.change_ray_test_from_to=function(a,e,g){c.mA(a)?c.change_ray_test_from_to(a,e,g):b.error("Wrong ray test ID")};
a.apply_constraint=function(a,e,g,m,n,p,d,l,f,H){c.ia(e)&&c.ia(n)?c.apply_constraint(a,e,g,m,n,p,d,l,f,H):b.error("Wrong objects")};a.clear_constraint=function(a){c.ia(a)&&c.ZJ(a)?c.clear_constraint(a):b.error("Wrong object")};a.pull_to_constraint_pivot=function(a,e,g,m,n,p){c.ia(a)&&c.ia(m)?c.pull_to_constraint_pivot(a,e,g,m,n,p):b.error("Wrong objects")};a.get_worker_listeners=e.get_worker_listeners};b4w.module.rgb=function(a,p){p("__print");var e=p("__util"),c=new Float32Array(3);a.create=function(){return new Float32Array(3)};a.from_values=function(a,c,e){var p=new Float32Array(3);p[0]=a;p[1]=c;p[2]=e;return p};a.set=function(a,c,e,p){p[0]=a;p[1]=c;p[2]=e;return p};a.css_to_rgb=function(a,c,h,p){p=p||new Float32Array(3);p[0]=a/255;p[1]=c/255;p[2]=h/255;e.eC(p,p);return p};a.rgb_to_css=function(a){a=e.dv(a,c);return[Math.round(255*a[0]),Math.round(255*a[1]),Math.round(255*a[2])]};a.rgb_to_css_hex=
function(a){function n(a){a=Math.round(255*a).toString(16);return 1==a.length?"0"+a:a}a=e.dv(a,c);return"#"+n(a[0])+n(a[1])+n(a[2])}};
b4w.module.rgba=function(a,p){p("__print");var e=p("__util"),c=new Float32Array(3);a.create=function(){var a=new Float32Array(4);a[3]=1;return a};a.from_values=function(a,c,e,p){var g=new Float32Array(4);g[0]=a;g[1]=c;g[2]=e;g[3]=p;return g};a.set=function(a,c,e,p,g){g[0]=a;g[1]=c;g[2]=e;g[3]=p;return g};a.css_to_rgba=function(a,c,h,p,g){g=g||new Float32Array(4);g[0]=a/255;g[1]=c/255;g[2]=h/255;g[3]=p;e.eC(g,g);return g};a.rgba_to_css=function(a){var n=e.dv(a,c);return[Math.round(255*n[0]),Math.round(255*
n[1]),Math.round(255*n[2]),a[3]]}};b4w.module.scenes=function(a,p){var e=p("__batch"),c=p("__camera"),b=p("__data"),n=p("__graph"),h=p("__objects"),r=p("__obj_util");p("__physics");var g=p("__print"),m=p("__scenes"),q=p("__subscene"),B=p("__util");a.DATA_ID_ALL=h.DATA_ID_ALL;a.set_active=function(a){var b=m.io();m.set_active(B.keysearch("name",a,b))};a.get_active=function(){return m.ya()?m.get_active().name:""};a.get_scenes=function(){for(var a=m.io(),b=[],c=0;c<a.length;c++)b.push(a[c].name);return b};a.get_active_camera=function(){if(m.ya())return m.gk(m.get_active());
g.error("No active scene");return!1};a.get_object_by_name=function(a,b){var c=h.wc(h.dt,a,b|0);if(c)return c;g.error("get object "+a+": not found")};a.get_object_by_dupli_name=function(a,b,c){if(a=h.wc(h.bt,a,b,c|0))return a;g.error("get object "+b+": not found")};a.get_object_by_dupli_name_list=function(a,b){var c=h.wc(h.Vc,a,b|0);if(c)return c;g.error("get object "+a+": not found")};a.get_world_by_name=function(a,b){var c=h.get_world_by_name(a,b|0);if(c)return c;g.error("get object "+a+": not found")};
a.get_object_data_id=function(a){return r.get_object_data_id(a)};a.pick_object=h.pick_object;a.outlining_is_enabled=function(a){return a&&a.k&&a.k.fc};a.set_outline_intensity=function(a,b){a&&a.k&&a.k.fc?h.set_outline_intensity(a,b):g.error("set_outline_intensity(): wrong object")};a.get_outline_intensity=function(a){if(a&&a.k&&a.k.fc)return a.k.Yf;g.error("get_outline_intensity(): wrong object")};a.apply_outline_anim=function(a,b,c,e){a&&a.k&&a.k.fc?h.apply_outline_anim(a,b,c,e):g.error("apply_outline_anim(): wrong object")};
a.apply_outline_anim_def=function(a){if(a&&a.k&&a.k.fc){var b=a.k.xf;h.apply_outline_anim(a,b.Mi,b.Ni,b.Oi)}else g.error("apply_outline_anim_def(): wrong object")};a.clear_outline_anim=function(a){a&&a.k&&a.k.fc?h.clear_outline_anim(a):g.error("clear_outline_anim(): wrong object")};a.set_outline_color=m.set_outline_color;a.get_outline_color=function(a){var b=m.get_active();if(b=m.Ba(b,q.el))return a=a||new Float32Array(3),a.set(b.Dh),a};a.set_hmd_params=function(a){m.ya()?a&&(!a.distortion_coefs||
a.distortion_coefs instanceof Array||(a.distortion_coefs=null),!a.chromatic_aberration_coefs||a.chromatic_aberration_coefs instanceof Array||(a.chromatic_aberration_coefs=null),"number"!=typeof a.base_line_factor&&(a.base_line_factor=null),"number"!=typeof a.inter_lens_factor&&(a.inter_lens_factor=null),"boolean"!=typeof a.enable_hmd_stereo&&(a.enable_hmd_stereo=null),m.set_hmd_params(a)):g.error("No active scene")};a.get_shadow_params=function(){if(!m.ya())return g.error("No active scene"),!1;var a=
m.get_active(),b=m.Ba(a,q.Ac);if(!b)return null;var c=a.p.od,e=m.Ba(a,q.pb),h=m.Ba(a,q.Be),n={};n.csm_resolution=c.csm_resolution;n.self_shadow_polygon_offset=b.self_shadow_polygon_offset;h&&(n.self_shadow_normal_offset=h.self_shadow_normal_offset);n.enable_csm=c.enable_csm;n.csm_num=c.csm_num;n.csm_first_cascade_border=c.csm_first_cascade_border;n.first_cascade_blur_radius=c.first_cascade_blur_radius;n.csm_last_cascade_border=c.csm_last_cascade_border;n.last_cascade_blur_radius=c.last_cascade_blur_radius;
n.fade_last_cascade=c.fade_last_cascade;n.blend_between_cascades=c.blend_between_cascades;c.enable_csm?(n.csm_borders=m.zJ(a,e.o),n.blur_radii=new Float32Array(c.csm_num),n.blur_radii.set(e.o.gm.subarray(0,c.csm_num))):(n.csm_borders=null,n.blur_radii=null);return n};a.set_shadow_params=function(a){if(m.ya()){var b=m.get_active();"number"==typeof a.self_shadow_polygon_offset&&n.ma(b.p.Oa,function(b,c){c.type==q.Ac&&(c.self_shadow_polygon_offset=a.self_shadow_polygon_offset)});var f=m.Ba(b,q.Be);f&&
("number"==typeof a.self_shadow_normal_offset&&(f.self_shadow_normal_offset=a.self_shadow_normal_offset),"number"==typeof a.pcf_blur_radius&&(f.pcf_blur_radius=a.pcf_blur_radius));var h=m.Ba(b,q.hc);h&&("number"==typeof a.self_shadow_normal_offset&&(h.self_shadow_normal_offset=a.self_shadow_normal_offset),"number"==typeof a.pcf_blur_radius&&(h.pcf_blur_radius=a.pcf_blur_radius),h.qa=!0);h=b.p.od;"number"==typeof a.csm_first_cascade_border&&(h.csm_first_cascade_border=a.csm_first_cascade_border);"number"==
typeof a.first_cascade_blur_radius&&(h.first_cascade_blur_radius=a.first_cascade_blur_radius);"number"==typeof a.csm_last_cascade_border&&(h.csm_last_cascade_border=a.csm_last_cascade_border);"number"==typeof a.last_cascade_blur_radius&&(h.last_cascade_blur_radius=a.last_cascade_blur_radius);if(f){for(var p=f.za,w=0;w<p.length;w++)for(var B=p[w].ha,y=0;y<B.length;y++){var A=B[y];A.Jg.Tc&&(A=A.Y,e.Wx(A,h),e.gc(A))}f.qa=!0}f=r.fa(b.ai,b).R;for(w=0;w<f.length;w++)c.Xw(f[w],h);m.iw(b)}else g.error("No active scene")};
a.get_environment_colors=function(){if(!m.ya())return g.error("No active scene"),!1;var a=m.get_active();return m.get_environment_colors(a)};a.set_environment_colors=function(a,b,c){if(m.ya()){var e=m.get_active(),h=m.Ba(e,q.pb);m.set_environment_colors(e,a||0==a?parseFloat(a):h.ph,b||0==b?b:h.Oe,c||0==c?c:h.cf)}else g.error("No active scene")};a.get_fog_color_density=function(a){if(!m.ya())return g.error("No active scene"),!1;var b=m.get_active();return m.get_fog_color_density(b,a)};a.set_fog_color_density=
function(a){if(m.ya()){var b=m.get_active();m.set_fog_color_density(b,a)}else g.error("No active scene")};a.get_ssao_params=function(){if(!m.ya())return g.error("No active scene"),!1;var a=m.get_active();return m.get_ssao_params(a)};a.set_ssao_params=function(a){if(m.ya()){var b=m.get_active();m.set_ssao_params(b,a)}else g.error("No active scene")};a.get_color_correction_params=function(){if(!m.ya())return g.error("No active scene"),null;var a=m.get_active(),a=m.Ba(a,q.Vs);if(!a)return null;var b=
{};b.brightness=a.brightness;b.contrast=a.contrast;b.exposure=a.exposure;b.saturation=a.saturation;return b};a.set_color_correction_params=function(a){if(m.ya()){var b=m.get_active();if(b=m.Ba(b,q.Vs))"number"==typeof a.brightness&&(b.brightness=a.brightness),"number"==typeof a.contrast&&(b.contrast=a.contrast),"number"==typeof a.exposure&&(b.exposure=a.exposure),"number"==typeof a.saturation&&(b.saturation=a.saturation),b.qa=!0}else g.error("No active scene")};a.get_sky_params=function(){if(!m.ya())return g.error("No active scene"),
!1;var a=m.get_active();return m.get_sky_params(a)};a.set_sky_params=function(a){if(m.ya()){var b=m.get_active();m.set_sky_params(b,a)}else g.error("No active scene")};a.get_dof_params=function(){if(!m.ya())return g.error("No active scene"),!1;var a=m.get_active();return m.Ba(a,q.Wm)?m.get_dof_params(a):null};a.set_dof_params=function(a){if(m.ya()){var b=m.get_active();m.set_dof_params(b,a)}else g.error("No active scene")};a.get_god_rays_params=function(){if(!m.ya())return g.error("No active scene"),
!1;var a=m.get_active();return m.Ba(a,q.Xh)?m.get_god_rays_params(a):null};a.set_god_rays_params=function(a){if(m.ya()){var b=m.get_active();m.set_god_rays_params(b,a)}else g.error("No active scene")};a.get_bloom_params=function(){if(!m.ya())return g.error("No active scene"),!1;var a=m.get_active();return m.Ba(a,q.Tm)?m.get_bloom_params(a):null};a.set_bloom_params=function(a){if(m.ya()){var b=m.get_active();m.set_bloom_params(b,a)}else g.error("No active scene")};a.get_glow_material_params=function(){if(!m.ya())return g.error("No active scene"),
!1;var a=m.get_active();return m.Ba(a,q.Xm)?m.get_glow_material_params(a):null};a.set_glow_material_params=function(a){if(m.ya()){var b=m.get_active();m.set_glow_material_params(b,a)}else g.error("No active scene")};a.get_wind_params=function(){if(!m.ya())return g.error("No active scene"),!1;var a=m.get_active();return m.get_wind_params(a)};a.set_wind_params=function(a){if(m.ya()){var b=m.get_active();h.set_wind_params(b,a)}else g.error("No active scene")};a.get_water_surface_level=function(a,b){if(!m.ya())return g.error("No active scene"),
0;var c=m.get_active();return c.p.oc?m.get_water_surface_level(c,a,b):(g.error("No water parameters on the active scene"),0)};a.set_water_params=function(a){if(m.ya()){var b=m.get_active();m.set_water_params(b,a)}else g.error("No active scene")};a.get_water_mat_params=function(a){if(m.ya()){var b=m.get_active();m.get_water_mat_params(b,a)}else g.error("No active scene")};a.update_scene_materials_params=function(){if(m.ya()){var a=m.get_active();m.LC(a)}else g.error("No active scene")};a.hide_object=
function(a,b){b=b||!1;!r.is_mesh(a)&&!r.is_empty(a)||r.Da(a)?b?m.vn(a,!0):m.vy(a,!0):g.error("show/hide is only supported for dynamic objects.")};a.show_object=function(a,b){b=b||!1;!r.is_mesh(a)&&!r.is_empty(a)||r.Da(a)?b?m.vn(a,!1):m.vy(a,!1):g.error("show/hide is only supported for dynamic objects.")};a.is_hidden=function(a){if(r.pk(a)||r.is_empty(a)||r.is_lamp(a))return m.is_hidden(a);g.error("show/hide is only supported for dynamic meshes/empties and lamps");return!1};a.is_visible=function(a){return a.k.is_visible};
a.check_object=function(a){g.qb("scenes.check_object","scenes.check_object_by_name");return m.ya()?h.qL(a,m.get_active()):(g.error("No active scene"),!1)};a.check_object_by_name=function(a,b){return h.wc(h.dt,a,b|0)?!0:!1};a.check_object_by_dupli_name=function(a,b,c){return h.wc(h.bt,a,b,c|0)?!0:!1};a.check_object_by_dupli_name_list=function(a,b){return h.wc(h.Vc,a,b|0)?!0:!1};a.get_all_objects=function(a,b){var c=m.get_active();a||(a="ALL");b||0===b||(b=h.DATA_ID_ALL);return h.yb(c,a,b)};a.get_object_name=
function(a){return a?a.Ak:(g.error("Wrong object name"),"")};a.get_object_name_hierarchy=function(a){if(!a)return g.error("Wrong object name"),null;for(var b=[];a;)b.push(a.Ak),a=r.get_dg_parent(a);return b.reverse()};a.get_object_type=function(a){return a&&a.type?a.type:(g.error("Wrong object"),"UNDEFINED")};a.get_object_dg_parent=function(a){g.qb("scenes.get_object_dg_parent","objects.get_dg_parent");return r.get_dg_parent(a)};a.get_object_children=function(a){return a.ee.slice(0)};a.get_first_character=
function(){return h.get_first_character(m.get_active())};a.get_shore_dist=function(a,b){b||0===b||(b=1);if(!m.ya())return g.error("No active scene"),!1;var c=m.get_active();return m.get_shore_dist(c,a,b)};a.get_cam_water_depth=function(){return m.get_cam_water_depth()};a.get_type_mesh_object=function(a){return r.is_mesh(a)?a.k.type:null};a.get_meta_tags=function(){if(!m.ya())return g.error("No active scene"),!1;var a=m.get_active();return m.get_meta_tags(a)};a.append_object=function(a,b){if(a.k.fr){if(b)var c=
m.io(),c=B.keysearch("name",b,c);else c=m.get_active();m.append_object(c,a,!0)}else g.error('object "'+a.name+'" has been created not by coping.')};a.remove_object=function(a){(r.is_mesh(a)||r.is_empty(a))&&r.Da(a)?(h.Jr(a,!1,a.k.gr,!1,!1),b.GL(a),h.Jr(a,!0,!0,!0,!0),h.remove_object(a)):g.error("Can't remove object \""+a.name+'". It must be dynamic and type of MESH or EMPTY.')};a.marker_frame=function(a){var b=m.get_active();if(b.timeline_markers&&a in b.timeline_markers)return m.marker_frame(b,a);
g.error('"'+a+'" marker not found.');return 0};a.get_mb_params=function(){var a=m.get_active();return(a=m.Ba(a,q.Yh))?{mb_factor:a.mb_factor,mb_decay_threshold:a.mb_decay_threshold}:null};a.set_mb_params=function(a){var b=m.get_active();(b=m.Ba(b,q.Yh))?("number"==typeof a.mb_decay_threshold&&(b.mb_decay_threshold=a.mb_decay_threshold),"number"==typeof a.mb_factor&&(b.mb_factor=a.mb_factor)):g.error("The motion blur subscene doesn't exist.")};a.can_select_objects=function(){var a=m.get_active();return Boolean(m.Ba(a,
q.Xd))}};b4w.module.sfx=function(a,p){var e=p("__obj_util"),c=p("__scenes"),b=p("__sfx"),n=p("__print");a.play=function(a,c,e){b.play(a,c||0,e||0)};a.play_def=function(a){b.play_def(a)};a.is_play=function(a){return b.is_playing(a)};a.is_playing=function(a){return b.is_playing(a)};a.stop=function(a){b.stop(a)};a.pause=function(a){b.hN(a)};a.resume=function(a){b.jN(a)};a.loop_stop=function(a,c,e){b.loop_stop(a,c||0,e||!1)};a.playrate=function(a,c){b.playrate(a,c)};a.get_playrate=function(a){return b.get_playrate(a)};
a.cyclic=function(a,c){b.cyclic(a,c)};a.is_cyclic=function(a){return b.is_cyclic(a)};a.listener_reset_speed=function(){b.listener_stride()};a.listener_stride=function(){b.listener_stride()};a.speaker_reset_speed=function(a){b.speaker_stride(a)};a.speaker_stride=function(a){b.speaker_stride(a)};a.get_volume=function(a){return a&&"object"===typeof a?b.get_volume(a):b.LJ()};a.set_volume=function(a,c){a&&"object"===typeof a?b.set_volume(a,c):b.GM(c)};a.mute=function(a,c){a&&"object"===typeof a?b.mute(a,
c):b.kL(c)};a.is_muted=function(a){return a&&"object"===typeof a?b.is_muted(a):b.pK()};a.get_speaker_objects=function(){return b.get_speaker_objects().slice(0)};a.check_active_speakers=b.check_active_speakers;a.set_compressor_params=function(a){b.set_compressor_params(c.get_active(),a)};a.get_compressor_params=function(){return b.get_compressor_params(c.get_active())};a.duck=function(a,c,e){a&&"object"===typeof a?b.duck(a,c,e):b.vI(c,e)};a.unduck=function(a){a&&"object"===typeof a?b.unduck(a):b.MN()};
a.apply_playlist=b.apply_playlist;a.clear_playlist=b.clear_playlist;a.detect_audio_container=b.detect_audio_container;a.detect_video_container=b.detect_video_container;a.set_positional_params=b.set_positional_params;a.get_positional_params=b.get_positional_params;a.set_filter_params=b.set_filter_params;a.get_filter_params=b.get_filter_params;a.get_filter_freq_response=b.get_filter_freq_response;a.get_duration=function(a){if(a&&e.is_speaker(a))return b.get_duration(a);n.error('Object "'+(a?a.name:
void 0)+'" is not a valid speaker')}};b4w.module.textures=function(a,p){var e=p("__print"),c=p("__scenes"),b=p("__textures"),n=p("__obj_util"),h=p("__assets");a.play_video=function(a,g){g||(g=0);c.get_active().b4w_use_nla&&b.ex(a,g)?e.error("NLA texture can't be controlled directly through API."):b.play_video(a,g)||e.error('Texture with name "'+a+'" not found!')};a.pause_video=function(a,g){g||(g=0);c.get_active().b4w_use_nla&&b.ex(a,g)?e.error("NLA texture can't be controlled directly through API."):b.pause_video(a,g)||e.error('Texture with name "'+
a+'" not found!')};a.reset_video=function(a,g){g||(g=0);c.get_active().b4w_use_nla&&b.ex(a,g)?e.error("NLA texture can't be controlled directly through API."):b.reset_video(a,g)||e.error('Texture with name "'+a+'" not found!')};a.get_canvas_ctx=function(a,c){if(n.is_mesh(a)){var h=b.wJ(a,c);if(h)return h;e.error("Couldn't find canvas texture with this name: "+c)}else e.error("Object must be type of mesh.");return null};a.update_canvas_ctx=function(a,c){if(n.is_mesh(a)){if(b.ZN(a,c))return!0;e.error("Couldn't find canvas texture with this name: "+
c)}else e.error("Object must be type of mesh.");return!1};a.change_image=function(a,c,m,n){n=n||function(){};h.enqueue([{id:m,type:h.AT_IMAGE_ELEMENT,url:m,qe:"GET",Ti:null,Eh:null,qR:null}],function(h){h&&(b.change_image(a,c,h)?n():e.error("Couldn't find texture with this name: "+c))},null,null)};a.get_texture_names=function(a){if(n.is_mesh(a))return b.get_texture_names(a);e.error("Object must be type of mesh.")}};b4w.module.time=function(a,p){var e=p("__time");a.set_timeout=e.set_timeout;a.clear_timeout=e.clear_timeout;a.get_timeline=e.get_timeline;a.animate=e.animate;a.clear_animation=e.clear_animation};b4w.module.transform=function(a,p){var e=p("__obj_util"),c=p("__physics"),b=p("__print"),n=p("__quat"),h=p("__transform"),r=p("__tsr"),g=p("__util"),m=r.create(),q=new Float32Array(3),B=new Float32Array(4);a.SPACE_LOCAL=h.SPACE_LOCAL;a.SPACE_WORLD=h.SPACE_WORLD;a.set_translation=function(a,g,f,m){e.Da(a)?(q[0]=g,q[1]=f,q[2]=m,h.set_translation(a,q),h.u(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_translation_rel=function(a,g,f,m){e.Da(a)?(q[0]=g,q[1]=f,q[2]=
m,h.set_translation_rel(a,q),h.u(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_translation_v=function(a,g){e.Da(a)?(h.set_translation(a,g),h.u(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_translation_rel_v=function(a,g){e.Da(a)?(h.set_translation_rel(a,g),h.u(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_translation_obj_rel=function(a,l,f,m,n){e.Da(a)?(q[0]=l,q[1]=f,q[2]=m,l=r.get_trans_view(n.k.m),
n=r.get_quat_view(n.k.m),g.transform_vec3(q,1,n,l,q),h.set_translation(a,q),h.u(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.get_translation=function(a,b){b||(b=new Float32Array(3));h.get_translation(a,b);return b};a.get_translation_rel=function(a,b){b||(b=new Float32Array(3));h.get_translation_rel(a,b);return b};a.set_rotation=function(a,g,f,m,n){e.Da(a)?(B[0]=g,B[1]=f,B[2]=m,B[3]=n,h.set_rotation(a,B),h.u(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+
'" is not dynamic.')};a.set_rotation_rel=function(a,g,f,m,n){e.Da(a)?(B[0]=g,B[1]=f,B[2]=m,B[3]=n,h.set_rotation_rel(a,B),h.u(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_rotation_v=function(a,g){e.Da(a)?(h.set_rotation(a,g),h.u(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_rotation_rel_v=function(a,g){e.Da(a)?(h.set_rotation_rel(a,g),h.u(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.get_rotation=
function(a,b){b||(b=new Float32Array(4));h.get_rotation(a,b);return b};a.get_rotation_rel=function(a,b){b||(b=new Float32Array(4));h.get_rotation_rel(a,b);return b};a.set_rotation_euler=function(a,g,f,m){e.Da(a)?(q[0]=g,q[1]=f,q[2]=m,h.set_rotation_euler(a,q),h.u(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_rotation_euler_rel=function(a,g,f,m){e.Da(a)?(q[0]=g,q[1]=f,q[2]=m,h.set_rotation_euler_rel(a,q),h.u(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+
'" is not dynamic.')};a.set_rotation_euler_v=function(a,g){e.Da(a)?(h.set_rotation_euler(a,g),h.u(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_rotation_euler_rel_v=function(a,g){e.Da(a)?(h.set_rotation_euler_rel(a,g),h.u(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_scale=function(a,c){e.Da(a)?(h.set_scale(a,c),h.u(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_scale_rel=function(a,c){e.Da(a)?(h.set_scale_rel(a,
c),h.u(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.get_scale=function(a){return h.get_scale(a)};a.get_scale_rel=function(a){return h.get_scale_rel(a)};a.empty_reset_transform=function(a){if("EMPTY"!=a.type)b.error("Wrong object: "+a.name);else{for(var g=0;g<a.ee.length;g++)if(!e.Da(a.ee[g])){b.error('Wrong object: "'+a.ee[g].name+'" is not dynamic.');return}h.set_translation(a,[0,0,0]);h.set_rotation(a,[0,0,0,1]);h.set_scale(a,1);h.u(a);c.sync_transform(a)}};a.get_object_size=function(a){return e.is_mesh(a)?
h.get_object_size(a):(b.error("Wrong object: "+a.name),0)};a.get_object_center=function(a,c,f){return e.is_mesh(a)?h.get_object_center(a,c,f):(b.error("Wrong object: "+a.name),null)};a.move_local=function(a,g,f,m){e.Da(a)?(h.move_local(a,g,f,m),h.u(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.rotate_x_local=function(a,l){if(e.Da(a)){var f=n.setAxisAngle(g.AXIS_X,l,B);h.ew(a,f);h.u(a);c.sync_transform(a)}else b.error('Wrong object: "'+a.name+'" is not dynamic.')};
a.rotate_y_local=function(a,l){if(e.Da(a)){var f=n.setAxisAngle(g.AXIS_Y,l,B);h.ew(a,f);h.u(a);c.sync_transform(a)}else b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.rotate_z_local=function(a,l){if(e.Da(a)){var f=n.setAxisAngle(g.AXIS_Z,l,B);h.ew(a,f);h.u(a);c.sync_transform(a)}else b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.get_object_bounding_box=function(a){return h.get_object_bounding_box(a)};a.set_tsr=function(a,g){e.Da(a)?(h.set_tsr(a,g),h.u(a),c.sync_transform(a)):
b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.set_tsr_rel=function(a,g){e.Da(a)?(h.set_tsr_rel(a,g),h.u(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.get_tsr=function(a,b){b||(b=new Float32Array(8));h.get_tsr(a,b);return b};a.get_tsr_rel=function(a,b){b||(b=new Float32Array(8));h.get_tsr_rel(a,b);return b};a.distance=function(a,b){return h.distance(a,b)};a.set_matrix=function(a,g){e.Da(a)?(r.from_mat4(g,m),h.set_tsr(a,m),h.u(a),c.sync_transform(a)):b.error('Wrong object: "'+
a.name+'" is not dynamic.')};a.set_matrix_rel=function(a,g){e.Da(a)?(r.from_mat4(g,m),h.set_tsr_rel(a,m),h.u(a),c.sync_transform(a)):b.error('Wrong object: "'+a.name+'" is not dynamic.')};a.get_matrix=function(a,b){b||(b=new Float32Array(16));h.get_tsr(a,m);r.to_mat4(m,b);return b};a.get_matrix_rel=function(a,b){b||(b=new Float32Array(16));h.get_tsr_rel(a,m);r.to_mat4(m,b);return b}};b4w.module.tsr=function(a,p){function e(a,b,c,m){m||(m=n.create());e(a,b,c,m);return m}var c=p("__mat4"),b=p("__print"),n=p("__tsr");a.create=n.create;a.from_values=n.from_values;a.copy=n.copy;a.identity=n.identity;a.create_sep=function(a,c,g,m){b.qb("create_sep","set_sep");return e(a,c,g,m)};a.set_sep=n.set_sep;a.set_trans=n.set_trans;a.set_scale=n.set_scale;a.set_transcale=n.set_transcale;a.set_quat=n.set_quat;a.get_trans_view=n.get_trans_view;a.get_scale=n.get_scale;a.get_quat_view=n.get_quat_view;
a.invert=n.invert;a.to_mat4=function(a,b){b||(b=c.create());n.to_mat4(a,b);return b};a.from_mat4=n.from_mat4;a.multiply=n.multiply;a.transform_vec3=n.transform_vec3;a.transform_vec3_inv=n.transform_vec3_inv;a.transform_vectors=n.transform_vectors;a.transform_dir_vectors=n.transform_dir_vectors;a.transform_dir_vec3=n.transform_dir_vec3;a.transform_tangents=n.transform_tangents;a.translate=n.translate;a.interpolate=function(a,b,c,e){e||(e=n.create());n.interpolate(a,b,c,e);return e}};b4w.module.util=function(a,p){var e=p("__compat"),c=p("__obj_util"),b=p("__print"),n=p("__quat"),h=p("__util"),r=p("__vec3"),g=new Float32Array(6);a.AXIS_X=new Float32Array([1,0,0]);a.AXIS_Y=new Float32Array([0,1,0]);a.AXIS_Z=new Float32Array([0,0,1]);a.AXIS_MX=new Float32Array([-1,0,0]);a.AXIS_MY=new Float32Array([0,-1,0]);a.AXIS_MZ=new Float32Array([0,0,-1]);a.XYX=h.XYX;a.YZY=h.YZY;a.ZXZ=h.ZXZ;a.XZX=h.XZX;a.YXY=h.YXY;a.ZYZ=h.ZYZ;a.XYZ=h.XYZ;a.YZX=h.YZX;a.ZXY=h.ZXY;a.XZY=h.XZY;a.YXZ=h.YXZ;a.ZYX=
h.ZYX;a.f32=function(a){return h.f32(a||0)};a.assert=h.assert;a.keyfind=h.keyfind;a.keysearch=h.keysearch;a.matrix_to_quat=function(a){return h.matrix_to_quat(a)};a.euler_to_quat=function(a,b){b||(b=new Float32Array(4));return h.euler_to_quat(a,b)};a.ordered_angles_to_quat=function(a,b,c){c||(c=n.create());return h.ordered_angles_to_quat(a,b,c)};a.quat_to_ordered_angles=function(a,b,c){c||(c=r.create());return h.quat_to_ordered_angles(a,b,c)};a.quat_to_euler=function(a,b){b||(b=new Float32Array(3));
return h.quat_to_euler(a,b)};a.sign=h.sign;a.clamp=h.clamp;a.quat_to_dir=h.quat_to_dir;a.ground_project_quat=function(a,b){return h.quat_project(a,h.AXIS_MY,h.AXIS_Y,h.AXIS_MZ,b)};a.cam_quat_to_mesh_quat=function(a,b){return h.cam_quat_to_mesh_quat(a,b)};a.quat_project=function(a,c,e,d,g){return 0!=r.dot(e,d)?(b.error("Wrong in-plane direction"),null):h.quat_project(a,c,e,d,g)};a.hash_code=h.hash_code;a.smooth=h.smooth;a.smooth_v=h.smooth_v;a.is_vector=h.is_vector;a.correct_cam_quat_up=h.correct_cam_quat_up;
a.quat_to_angle_axis=h.quat_to_angle_axis;a.random_from_array=h.random_from_array;a.xz_direction=h.xz_direction;a.line_plane_intersect=function(a,c,e,d,l){b.qb("util.line_plane_intersect","math.line_plane_intersect");g[0]=e[0];g[1]=e[1];g[2]=e[2];g[3]=d[0];g[4]=d[1];g[5]=d[2];return h.line_plane_intersect(a,c,g,l)};a.is_mesh=function(a){b.qb("util.is_mesh","objects.is_mesh");return c.is_mesh(a)};a.is_armature=function(a){b.qb("util.is_armature","objects.is_armature");return c.is_armature(a)};a.angle_wrap_0_2pi=
h.angle_wrap_0_2pi;a.angle_wrap_periodic=h.angle_wrap_periodic;a.smooth_step=h.smooth_step;a.lerp=h.lerp;a.deg_to_rad=h.deg_to_rad;a.rad_to_deg=h.rad_to_deg;a.dir_to_quat=h.dir_to_quat;a.is_ie11=e.is_ie11};"object"==typeof module&&module.tu&&(GLOBAL.b4w={module:{}});b4w.module.version=function(a,p){p("__print");var e=p("__version");a.version=e.version;a.version_str=e.version_str;a.type=e.type;a.date=e.date;a.date_str=e.date_str};"object"==typeof module&&module.tu&&b4w.module.version(exports);b4w.module.objects=function(a,p){var e=p("__geometry"),c=p("__objects"),b=p("__batch"),n=p("__obj_util"),h=p("__print"),r=p("__scenes");a.get_meta_tags=function(a){if(a)return c.get_meta_tags(a)};a.copy=function(a,b,q){return n.is_mesh(a)?n.Da(a)?e.Jl(a)||e.check_shape_keys(a)||!q?-1==c.yb(r.get_active(),"MESH",c.DATA_ID_ALL).indexOf(a)?(h.error('object "'+a.name+'" does not belong to the active scene.'),!1):c.copy(a,b||"",q):(h.error('object "'+a.name+'" has not dynamic geometry for deep copying.'),
!1):(h.error('object "'+a.name+'" is not dynamic.'),!1):(h.error('object "'+a.name+'" is not of type "MESH".'),!1)};a.set_nodemat_value=function(a,c,e){if(n.pk(a)){var p=c[0],d=b.Ma(a,p,"MAIN");if(null===d)return h.error('Material "'+p+'" was not found in the object "'+a.name+'".'),null;d=b.Il(d.Wf,c);if(null===d)return h.error('Value node "'+c[c.length-1]+'" was not found in the object "'+a.name+'".'),null;b.set_nodemat_value(a,p,d,e)}else h.error('The type of the object "'+a.name+'" is not "MESH" or it is not dynamic.')};
a.get_nodemat_value=function(a,c){if(!n.pk(a))return h.error('The type of the object "'+a.name+'" is not "MESH" or it is not dynamic.'),null;var e=c[0],p=b.Ma(a,e,"MAIN");if(null===p)return h.error('Material "'+e+'" was not found in the object "'+a.name+'".'),null;e=b.Il(p.Wf,c);return null===e?(h.error('Value node "'+c[c.length-1]+'" was not found in the object "'+a.name+'".'),null):b.get_nodemat_value(p,e)};a.set_nodemat_rgb=function(a,c,e,p,d){if(n.pk(a)){var l=c[0],f=b.Ma(a,l,"MAIN");null===f?
h.error('Material "'+l+'" was not found in the object "'+a.name+'".'):(f=b.Il(f.Vf,c),null===f?h.error('RGB node "'+c[c.length-1]+'" was not found in the object "'+a.name+'".'):b.set_nodemat_rgb(a,l,f,e,p,d))}else h.error('The type of the object "'+a.name+'" is not "MESH" or it is not dynamic.')};a.get_nodemat_rgb=function(a,c,e){if(!n.pk(a))return h.error('The type of the object "'+a.name+'" is not "MESH" or it is not dynamic.'),null;var p=c[0],d=b.Ma(a,p,"MAIN");if(null===d)return h.error('Material "'+
p+'" was not found in the object "'+a.name+'".'),null;p=b.Il(d.Vf,c);if(null===p)return h.error('RGB node "'+c[c.length-1]+'" was not found in the object "'+a.name+'".'),null;e||(e=new Float32Array(3));return b.get_nodemat_rgb(d,p,e)};a.update_boundings=function(a){n.is_mesh(a)?e.Jl(a)||e.check_shape_keys(a)?c.update_boundings(a):h.error('object "'+a.name+'" has not dynamic geometry.'):h.error('The type of the object "'+a.name+'" is not "MESH".')};a.get_parent=n.get_parent;a.get_dg_parent=n.get_dg_parent;
a.is_mesh=n.is_mesh;a.is_armature=n.is_armature;a.is_speaker=n.is_speaker;a.is_camera=n.is_camera;a.is_lamp=n.is_lamp;a.is_empty=n.is_empty;a.is_line=n.is_line;a.is_world=n.is_world;a.get_selectable_objects=function(){return c.get_selectable_objects()};a.get_outlining_objects=function(){return c.get_outlining_objects()}};b4w.module.main=function(a,p){function e(){}function c(){}function b(){}function n(){window.performance||(C.log("Apply performance workaround"),window.performance={});var a=Date.now();window.performance.now||(C.log("Apply performance.now() workaround"),window.performance.now=function(){return Date.now()-a});L.LB(0)}function h(a,b){for(var c=null,d=b?ea:ha,e=0;e<d.length;e++){var f=d[e];try{c=a.getContext(f,T)}catch(g){}if(c)break}c&&w.oI(c);return c}function r(a,b,e){a.addEventListener("webglcontextlost",
function(a){a.preventDefault();C.error("WebGL context lost");m()},!1);x.Ve(e);var f=x.get_renderer_info();f&&C.log("%cRENDERER INFO:","color: #00a",e.getParameter(f.UNMASKED_VENDOR_WEBGL)+", "+e.getParameter(f.UNMASKED_RENDERER_WEBGL));W.Ve(e);k.Ve(e);N.Ve(e);X.Ve(e);G.Ve(e);E.Ve(e);A.TM(a);E.init(a,b);F.NB(a.width,a.height,1);K.init();c=d();B()}function g(){e=function(){}}function m(){q()||(ma=performance.now()/1E3,K.pause(),S.pause(),N.pause(),l.pause())}function q(){return ra<ma}function B(){var a=
"HMD"===la.stereo&&t.Yz();a?a.requestAnimationFrame(B):I(B);var b=performance.now()/1E3;Z||(Z=b);var d=b-Z;if(!(d<1/la.max_fps)){for(var g=L.get_timeline(),h=0;h<ja.length;h++)ja[h](g,d);q()||(ra>Z&&(d-=ra-Math.max(ma,Z)),g+=d,L.LB(g),G.update(),H.update(),A.update(),h=d,A.is_primary_loaded()&&(M.reset(),P.update(h),v.update(g,h),u.update(g,h),K.update(g,h),h&&f.update(h),A.is_primary_loaded()&&(S.update(g,h),A.is_primary_loaded()&&(t.update(g),y.update(g,h),A.is_primary_loaded()&&(l.update(),z.update(g,
h),ga.update(),e(h,g),A.is_primary_loaded()&&(F.update(g,h),l.OC(),oa&&(oa(O.toDataURL()),oa=null)))))),c(d));Z=b;a&&a.isPresenting&&a.submitFrame()}}function d(){var a=60,c=0,d=la.uz,e=la.WI;return function(f){f<1/la.max_fps||(a=da.smooth(1/f,a,f,d),f=S.EJ(),c=(c+1)%e,0==c&&b(Math.round(a),f))}}var l=p("__anchors"),f=p("__animation"),H=p("__assets"),D=p("__config"),w=p("__compat"),E=p("__container"),y=p("__controls"),A=p("__data"),G=p("__debug"),x=p("__extensions"),k=p("__geometry"),t=p("__input"),
M=p("__hud"),u=p("__nla"),v=p("__logic_nodes"),z=p("__objects"),S=p("__physics"),C=p("__print"),W=p("__renderer"),F=p("__scenes"),K=p("__sfx"),X=p("__shaders"),N=p("__textures"),L=p("__time"),P=p("__transform"),da=p("__util"),U=p("__version"),ga=p("__particles"),T=D.context,la=D.v,O=null,Q=null,Z=0,ma=0,ra=0,ja=[],oa=null,ha=["webgl","experimental-webgl"],ea=["webgl2","experimental-webgl2"],ka=null,I=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||
window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(a){return window.setTimeout(a,1E3/la.max_fps)}}();a.init=function(a,b){D.HM();C.PM(la.console_verbose);var c=U.version_str()+" "+U.type()+" ("+U.date_str()+")";C.log("%cINIT ENGINE","color: #00a",c);C.log("%cUSER AGENT:","color: #00a",navigator.userAgent);if(!window.WebGLRenderingContext)return null;n();O=a;b?(M.init(b),Q=b):(D.v.show_hud_debug_info=!1,D.L.Ar=!1);w.GF();w.Jt("Chrome")||w.Jt("Firefox")||(la.pc=!1);c=h(a,la.pc);
!c&&la.pc&&(la.pc=!1,c=h(a,!1));if(!c)return null;C.log("%cINIT WEBGL "+(la.pc?"2":"1"),"color: #00a");ka=c;r(O,Q,c);D.IF();w.yM(c);X.MK();la.$q&&(a.style["touch-action"]="none");C.log("%cSET PRECISION:","color: #00a",la.precision);return c};a.resize=function(a,b,c){C.qb("main.resize","container.resize");E.resize(a,b,c)};a.set_fps_callback=function(a){b=a};a.clear_fps_callback=function(){b=function(){}};a.set_render_callback=function(a){e=a};a.clear_render_callback=function(){g()};a.global_timeline=
function(){C.qb("main.global_timeline","time.get_timeline");return L.get_timeline()};a.pause=m;a.resume=function(){q()&&(ra=performance.now()/1E3,K.resume(),S.resume(),N.play(!0),l.resume())};a.is_paused=q;a.reset=function(){A.unload(0);A.reset();x.reset();W.reset();k.reset();N.ZL();X.reset();G.reset();E.reset();A.reset();E.reset();L.reset();K.reset();Q=O=null;ra=ma=Z=0;b=function(){};c=function(){};e=function(){};ja.length=0;ka=null};a.canvas_data_url=function(a){oa=a};a.get_canvas_elem=function(){C.qb("main.get_canvas_elem",
"container.get_canvas");return O};a.detect_mobile=function(){return w.detect_mobile()};a.append_loop_cb=function(a){for(var b=0;b<ja.length;b++)if(ja[b]==a)return;ja.push(a)};a.remove_loop_cb=function(a){for(var b=0;b<ja.length;b++)if(ja[b]==a){ja.splice(b,1);break}};a.get_renderer_info=function(){var a=x.get_renderer_info();return a?{vendor:ka.getParameter(a.UNMASKED_VENDOR_WEBGL),renderer:ka.getParameter(a.UNMASKED_RENDERER_WEBGL)}:null}};b4w.module.nla=function(a,p){var e=p("__nla"),c=p("__time"),b=p("__print"),n=p("__util");a.set_frame=function(a){a=n.clamp(a,e.get_frame_start(),e.get_frame_end());e.check_logic_nodes()?b.error("The active scene is using NLA script."):e.set_frame(a,c.get_timeline())};a.get_frame=function(){return e.get_frame(c.get_timeline())};a.stop=function(){e.check_logic_nodes()?b.error("The active scene is using NLA script."):e.xw()};a.play=function(a){e.check_logic_nodes()?b.error("The active scene is using NLA script."):
e.mB(a)};a.is_play=function(){return e.is_play()};a.get_frame_start=function(){return e.get_frame_start()};a.get_frame_end=function(){return e.get_frame_end()};a.check_nla=function(){return e.check_nla()};a.check_nla_scripts=function(){return e.check_logic_nodes()};a.check_logic_nodes=function(){return e.check_logic_nodes()};a.set_range=function(a,c){e.check_logic_nodes()?b.error("The active scene is using NLA script."):(c=parseFloat(c)||e.get_frame_end(),a=parseFloat(a)||e.get_frame_end(),c=n.clamp(c,
e.get_frame_start(),e.get_frame_end()),a=n.clamp(a,e.get_frame_start(),c),e.set_range(a,c))};a.reset_range=function(){e.check_logic_nodes()?b.error("The active scene is using NLA script."):e.reset_range()};a.set_cyclic=function(a){e.check_logic_nodes()?b.error("The active scene is using NLA script."):e.set_cyclic(a)};a.clear_callback=function(){e.check_logic_nodes()?b.error("The active scene is using NLA script."):e.clear_callback()}};b4w.module.app=function(a,p){function e(){var a=v.is_paused();document.addEventListener("visibilitychange",function(){document.hidden?(a=v.is_paused(),v.pause()):a||v.resume()},!1)}function c(){var a=0,b=x.get_container(),c=v.is_paused(),d=!0;v.append_loop_cb(function(){if(0==a%10){var e=b.getBoundingClientRect();e.top>window.innerHeight||0>e.bottom?(d&&(c=v.is_paused()),v.pause(),d=!1):c||d||(v.resume(),d=!0)}a++})}function b(a,b,c,d){var e=document.createElement("canvas"),f=document.getElementById(a);
e.style.position="absolute";e.style.left=0;e.style.top=0;e.style.width=f.offsetWidth+"px";e.style.height=f.offsetHeight+"px";e.width=f.offsetWidth*window.devicePixelRatio;e.height=f.offsetHeight*window.devicePixelRatio;b?(b=document.createElement("canvas"),b.style.position="absolute",e.style.left=0,e.style.top=0,b.style.pointerEvents="none"):b=null;f||(S.error('Warning: canvas container "'+a+'" not found, appending to body'),f=document.body);f.appendChild(e);if(!v.init(e,b))return c&&w("Browser could not initialize WebGL",
"For more info visit","https://www.blend4web.com/doc/en/problems_and_solutions.html",d),!1;b&&x.insert_to_container(b,"LAST");return!0}function n(a,b){a?(b&&(document.getElementById(b).style.display="block"),N=document.getElementById(a)):(N=document.createElement("div"),N.innerHTML=0,N.style.cssText="position:absolute;top: 23px;right: 20px;text-shadow: 0px 0px 6px #fff;font-size: 40px;line-height: 50px;font-weight: bold;color: #000;",x.insert_to_container(N,"JUST_AFTER_CANVAS"))}function h(a,b){var c=
String(a);b&&(c+="/"+String(b));N.innerHTML=c}function r(a){a=document.getElementById(a);var b=a.cloneNode(!0);a.parentNode.replaceChild(b,a);return b}function g(a,b,c){var d=Math.max(y.hover_get_distance(a),1),e=W.get_rotation(a,O);b=F.quat_to_dir(e,b,T);b[1]=0;K.normalize(b,b);K.scale(b,d*c,b);c=W.get_translation(a,la);K.add(c,b,c);y.set_translation(a,c)}function m(a,b){var c=y.hover_get_vertical_limits(a,Z);if(c.up!=c.down){var d=y.get_camera_angles(a,ga)[1],c=(c.down-d)/(c.down-c.up),d=y.hover_get_distance_limits(a,
Z),c=Math.max(c,2/d.max);y.hover_rotate(a,0,c*b)}}function q(a,b,c,d){W.move_local(a,5*b,5*c,5*d)}function B(a,b,c){var d=y.target_get_distance(a),e=Math.abs(b);c=Math.pow(e*c,1-Math.pow(e*c,.15));W.move_local(a,0,0>b?.001<d?-d*c:0:c/(1-c)*d,0)}function d(a,b,c,d){for(var e=c*b;0<a;--a)c+=e,d+=e,e=c*b;return d}function l(a,b,c,e,f){f?(f=y.target_get_pivot(a,T),a=y.get_translation(a),a=K.dist(f,a)+e,e=0<b?d(b,-c,a,e):d(-b,c/(1-c),a,e)):e-=2*b*c;return e}function f(a,b,c,d,e){function f(a,b,c,d){if(1==
c){y.get_velocities(a,Z);var e=M?.003*Z.trans:.003*Z.rot;c=k.get_sensor_value(a,b,0);k.get_sensor_payload(a,b,0)===k.PL_SINGLE_TOUCH_MOVE?(Ya+="X"==d?-c*e:0,jb+="Y"==d?-c*e:0):k.get_sensor_payload(a,b,0)===k.PL_MULTITOUCH_MOVE_PAN&&(a=M?.003*Z.rot:7.5E-4*Z.trans,kb+="X"==d?-c*a:0,Na+="Y"==d?-c*a:0)}}function h(a){y.get_velocities(a,Z);Ua-=.05*Z.zoom}function n(a){y.get_velocities(a,Z);ta-=.002*Z.trans}function p(a){y.get_velocities(a,Z);Ua+=.05*Z.zoom}function r(a){y.get_velocities(a,Z);ta+=.002*
Z.trans}function v(a,b,c,d){if(1==c){c=k.get_sensor_value(a,b,1);y.get_velocities(a,Z);if(M)e=.003*Z.trans,f=7.5E-4*Z.rot;else var e=.003*Z.rot,f=7.5E-4*Z.trans;if(1===k.get_sensor_payload(a,b,0))Da+="X"==d?-c*e:0,La+="Y"==d?-c*e:0;else if(2===k.get_sensor_payload(a,b,0)||3===k.get_sensor_payload(a,b,0))bb+="X"==d?-c*f:0,Bb+="Y"==d?-c*f:0}}function t(a){return a[0]&&(a[1]||a[2]||-.1>a[3])}function w(a){return a[0]&&(a[1]||a[2]||.1<a[3])}function x(a){return a[0]&&(a[1]||-.1>a[2])}function A(a){return a[0]&&
(a[1]||.1<a[2])}function D(a){return a[0]&&(a[1]||a[2]||a[3])}function E(a,b,c){if(1==c)switch(c=k.get_sensor_value(a,b,0),y.get_velocities(a,Z),b){case "FORWARD":O?Fa[0]=1:M?(b=y.get_camera_angles(a,ga)[1],b=Math.abs(b)>=Math.PI/4?F.AXIS_MZ:F.AXIS_MY,g(a,b,.5*Z.trans*c)):S?B(a,-Z.zoom,c):q(a,0,-Z.trans*c,0);break;case "BACKWARD":O?Fa[0]=-1:M?(b=y.get_camera_angles(a,ga)[1],b=Math.abs(b)>=Math.PI/4?F.AXIS_Z:F.AXIS_Y,g(a,b,.5*Z.trans*c)):S?B(a,Z.zoom,c):q(a,0,Z.trans*c,0);break;case "UP":M?m(a,30*
-Z.zoom*c):O||q(a,0,0,-Z.trans*c);break;case "DOWN":M?m(a,30*Z.zoom*c):O||q(a,0,0,Z.trans*c);break;case "LEFT":O?Fa[1]=1:M?g(a,F.AXIS_MX,.5*Z.trans*c):q(a,-Z.trans*c,0,0);break;case "RIGHT":O?Fa[1]=-1:M?g(a,F.AXIS_X,.5*Z.trans*c):q(a,Z.trans*c,0,0);break;case "ROT_LEFT":S?y.target_rotate(a,.75*-Z.rot*c,0):y.eye_rotate(a,.75*Z.rot*c,0);break;case "ROT_RIGHT":S?y.target_rotate(a,.75*Z.rot*c,0):y.eye_rotate(a,.75*-Z.rot*c,0);break;case "ROT_UP":S?y.target_rotate(a,0,.75*-Z.rot*c):y.eye_rotate(a,0,.75*
Z.rot*c);break;case "ROT_DOWN":S?y.target_rotate(a,0,.75*Z.rot*c):y.eye_rotate(a,0,.75*-Z.rot*c)}else switch(b){case "FORWARD":case "BACKWARD":O&&(Fa[0]=0);break;case "LEFT":case "RIGHT":O&&(Fa[1]=0)}O&&(z.set_character_move_dir(O,Fa[0],Fa[1]),a=y.get_camera_angles_char(a,U),z.set_character_rotation(O,a[0],a[1]))}L=a;P=b;da=c;var N=C.get_active_camera();H(N);var S=!1,O=null,M=!1;switch(y.get_move_style(N)){case y.MS_TARGET_CONTROLS:S=!a;break;case y.MS_EYE_CONTROLS:O=C.get_first_character();break;
case y.MS_STATIC:return;case y.MS_HOVER_CONTROLS:M=!0}var Z=y.get_velocities(N,Q);a=k.create_elapsed_sensor();if(z.has_simulated_physics(N)){var va=k.create_collision_sensor(N,null,!0);k.create_sensor_manifold(N,"CAMERA_COLLISION",k.CT_POSITIVE,[va],null,function(a,b){var c=k.get_sensor_payload(a,b,0).coll_dist;if(0>c){var d=k.get_sensor_payload(a,b,0).coll_norm,e=T;K.scale(d,-.25*c,e);c=W.get_translation(a,la);K.add(c,e,c);W.set_translation_v(a,c)}})}if(O){var va=W.get_translation(N),Ma=W.get_rotation(N),
Ma=F.cam_quat_to_mesh_quat(Ma);va[1]-=.5;z.set_transform(O,va,Ma);G.append_stiff_trans(N,O,[0,.5,0]);var Fa=new Float32Array(2),Ja=!0;z.set_character_move_type(O,z.CM_FLY);k.create_kb_sensor_manifold(N,"TOGGLE_CHAR_MOVE_TYPE",k.CT_SHOT,k.KEY_C,function(){Ja=!Ja;z.set_character_move_type(O,Ja?z.CM_FLY:z.CM_WALK)})}var Ka=u.check_enable_gamepad_indices(),va=Ka.length?Ka[Ka.length-1]:0,Oa,Ba,Y,wa,ua,xa;b?Oa=Ba=Y=wa=ua=xa=b=va=k.create_custom_sensor(0):(Oa=k.create_keyboard_sensor(k.KEY_W),Ba=k.create_keyboard_sensor(k.KEY_S),
Y=k.create_keyboard_sensor(k.KEY_A),wa=k.create_keyboard_sensor(k.KEY_D),ua=k.create_keyboard_sensor(k.KEY_R),xa=k.create_keyboard_sensor(k.KEY_F),b=k.create_gamepad_btn_sensor(u.GMPD_BUTTON_6,va),va=k.create_gamepad_btn_sensor(u.GMPD_BUTTON_7,va));var gc=k.create_keyboard_sensor(k.KEY_UP),Qa=k.create_keyboard_sensor(k.KEY_DOWN),ba=k.create_keyboard_sensor(k.KEY_LEFT),$b=k.create_keyboard_sensor(k.KEY_RIGHT),Ma=k.create_gamepad_axis_sensor(u.GMPD_AXIS_0,Ka),sa=k.create_gamepad_axis_sensor(u.GMPD_AXIS_1,
Ka),R=k.create_gamepad_axis_sensor(u.GMPD_AXIS_2,Ka),Ka=k.create_gamepad_axis_sensor(u.GMPD_AXIS_3,Ka);M||(k.create_sensor_manifold(N,"FORWARD",k.CT_CONTINUOUS,[a,Oa,sa],x,E),k.create_sensor_manifold(N,"BACKWARD",k.CT_CONTINUOUS,[a,Ba,sa],A,E));S?(k.create_sensor_manifold(N,"ROT_UP",k.CT_CONTINUOUS,[a,gc,ua,Ka],t,E),k.create_sensor_manifold(N,"ROT_DOWN",k.CT_CONTINUOUS,[a,Qa,xa,Ka],w,E),k.create_sensor_manifold(N,"ROT_LEFT",k.CT_CONTINUOUS,[a,ba,Y,R],t,E),k.create_sensor_manifold(N,"ROT_RIGHT",k.CT_CONTINUOUS,
[a,$b,wa,R],w,E)):M?(k.create_sensor_manifold(N,"LEFT",k.CT_CONTINUOUS,[a,ba,Y,Ma],t,E),k.create_sensor_manifold(N,"RIGHT",k.CT_CONTINUOUS,[a,$b,wa,Ma],w,E),k.create_sensor_manifold(N,"FORWARD",k.CT_CONTINUOUS,[a,gc,Oa,sa],t,E),k.create_sensor_manifold(N,"BACKWARD",k.CT_CONTINUOUS,[a,Qa,Ba,sa],w,E),k.create_sensor_manifold(N,"UP",k.CT_CONTINUOUS,[a,xa,Ka],A,E),k.create_sensor_manifold(N,"DOWN",k.CT_CONTINUOUS,[a,ua,Ka],x,E)):(k.create_sensor_manifold(N,"UP",k.CT_CONTINUOUS,[a,ua,b],D,E),k.create_sensor_manifold(N,
"DOWN",k.CT_CONTINUOUS,[a,xa,va],D,E),k.create_sensor_manifold(N,"LEFT",k.CT_CONTINUOUS,[a,Y,Ma],x,E),k.create_sensor_manifold(N,"RIGHT",k.CT_CONTINUOUS,[a,wa,Ma],A,E),k.create_sensor_manifold(N,"ROT_UP",k.CT_CONTINUOUS,[a,gc,Ka],x,E),k.create_sensor_manifold(N,"ROT_DOWN",k.CT_CONTINUOUS,[a,Qa,Ka],A,E),k.create_sensor_manifold(N,"ROT_LEFT",k.CT_CONTINUOUS,[a,ba,R],x,E),k.create_sensor_manifold(N,"ROT_RIGHT",k.CT_CONTINUOUS,[a,$b,R],A,E));if(!c){var Ra=0;c=k.create_mouse_wheel_sensor(d);var za=0,Ka=
k.create_touch_zoom_sensor(d);k.create_sensor_manifold(N,"MOUSE_WHEEL",k.CT_LEVEL,[c],null,function(a,b,c){1==c&&(b=k.get_sensor_value(a,b,0),y.get_velocities(a,Z),S||M?Ra=l(a,b,Z.zoom,Ra,S):(Z.trans*=1+b*Z.zoom,y.set_velocities(a,Z)))});k.create_sensor_manifold(N,"TOUCH_ZOOM",k.CT_LEVEL,[Ka],null,function(a,b,c){1==c&&(c=k.get_sensor_value(a,b,0),y.get_velocities(a,Z),k.get_sensor_payload(a,b,0)===k.PL_MULTITOUCH_MOVE_ZOOM&&(za=l(a,c,.03*Z.zoom,za,S)))});k.create_sensor_manifold(N,"ZOOM_INTERPOL",
k.CT_POSITIVE,[a],null,function(a,b){if(S||M)if(1E-5<Math.abs(Ra)||1E-5<Math.abs(za)){var c=k.get_sensor_value(a,b,0),d=F.smooth(Ra,0,c,.1*X);Ra-=d;c=F.smooth(za,0,c,.15*X);za-=c;M?m(a,-(d+c)):(d=y.target_get_distance(a)+d+c,d=Math.max(d,.001),y.target_set_distance(a,d))}else za=Ra=0})}var Da=0,La=0,bb=0,Bb=0,ta=0,Ua=0;S?(k.create_sensor_manifold(N,"GMPD_PAN_Y_POS",k.CT_CONTINUOUS,[b],null,p),k.create_sensor_manifold(N,"GMPD_PAN_Y_NEG",k.CT_CONTINUOUS,[va],null,h),k.create_sensor_manifold(N,"GMPD_PAN_X_POS",
k.CT_CONTINUOUS,[Ma],function(a){return-.1>a[0]},n),k.create_sensor_manifold(N,"GMPD_PAN_X_NEG",k.CT_CONTINUOUS,[Ma],function(a){return.1<a[0]},r)):M&&(k.create_sensor_manifold(N,"GMPD_PAN_X_POS",k.CT_CONTINUOUS,[R],function(a){return-.1>a[0]},n),k.create_sensor_manifold(N,"GMPD_PAN_X_NEG",k.CT_CONTINUOUS,[R],function(a){return.1<a[0]},r));if(e){e=k.create_mouse_move_sensor("X",window);c=k.create_mouse_move_sensor("Y",window);b=k.create_mouse_click_sensor(d);var va=k.create_mouse_click_sensor(window),
Ta=!1,Ma=function(a){a[2]?Ta=!0:a[0]||(Ta=!1);return Ta&&a[0]};k.create_sensor_manifold(N,"MOUSE_X",k.CT_POSITIVE,[va,e,b],Ma,v,"X");k.create_sensor_manifold(N,"MOUSE_Y",k.CT_POSITIVE,[va,c,b],Ma,v,"Y");e=u.get_device_by_type_element(u.DEVICE_MOUSE,window);u.switch_prevent_default(e,!1)}else e=k.create_mouse_move_sensor("X",d),c=k.create_mouse_move_sensor("Y",d),b=k.create_mouse_click_sensor(d),k.create_sensor_manifold(N,"MOUSE_X",k.CT_LEVEL,[b,e],null,v,"X"),k.create_sensor_manifold(N,"MOUSE_Y",
k.CT_LEVEL,[b,c],null,v,"Y");var Ya=0,jb=0,kb=0,Na=0;e=k.create_touch_move_sensor("X",d);d=k.create_touch_move_sensor("Y",d);k.create_sensor_manifold(N,"TOUCH_X",k.CT_LEVEL,[e],null,f,"X");k.create_sensor_manifold(N,"TOUCH_Y",k.CT_LEVEL,[d],null,f,"Y");k.create_sensor_manifold(N,"ROT_TRANS_INTERPOL",k.CT_POSITIVE,[a],null,function(a,b){if(1E-5<Math.abs(Da)||1E-5<Math.abs(La)||1E-5<Math.abs(Ya)||1E-5<Math.abs(jb)||1E-5<Math.abs(bb)||1E-5<Math.abs(Bb)||1E-5<Math.abs(kb)||1E-5<Math.abs(Na)||1E-5<Math.abs(ta)||
1E-5<Math.abs(Ua)){var c=k.get_sensor_value(a,b,0),d=F.smooth(Da,0,c,.08*X),e=F.smooth(La,0,c,.08*X);Da-=d;La-=e;var f=F.smooth(Ya,0,c,.12*X),h=F.smooth(jb,0,c,.12*X);Ya-=f;jb-=h;var l=F.smooth(bb,0,c,.08*X),m=F.smooth(Bb,0,c,.08*X);bb-=l;Bb-=m;var n=F.smooth(kb,0,c,.12*X),q=F.smooth(Na,0,c,.12*X);kb-=n;Na-=q;var p=F.smooth(ta,0,c,.08*X),c=F.smooth(Ua,0,c,.08*X);ta-=p;Ua-=c;S?(y.target_rotate(a,d+f,e+h),e=y.target_get_distance(a),y.target_pan_pivot(a,e*(l+n+p),e*(m+q+c))):M?(d+f&&g(a,F.AXIS_X,.2*
(d+f)),e+h&&(m=y.get_camera_angles(a,ga)[1],g(a,Math.abs(m)>Math.PI/4?F.AXIS_Z:F.AXIS_Y,.2*(e+h))),y.hover_rotate(a,l+n+p,0)):(y.eye_rotate(a,.5*(d+f),.5*(e+h)),O&&(l=y.get_camera_angles_char(a,U),z.set_character_rotation(O,l[0],l[1])))}});k.create_kb_sensor_manifold(N,"DEC_STEREO_DIST",k.CT_SHOT,k.KEY_LEFT_SQ_BRACKET,function(a){var b=y.get_stereo_distance(a);y.set_stereo_distance(a,.9*b)});k.create_kb_sensor_manifold(N,"INC_STEREO_DIST",k.CT_SHOT,k.KEY_RIGHT_SQ_BRACKET,function(a){var b=y.get_stereo_distance(a);
y.set_stereo_distance(a,1.1*b)})}function H(a){var b=y.get_move_style(a),c=k.create_callback_sensor(function(){var c=y.get_move_style(a),d=c!=b;b=c;return d});k.create_sensor_manifold(a,"CHANGE_MOVE_STYLE",k.CT_POSITIVE,[c],null,function(){D();f(L,P,da)})}function D(){for(var a=C.get_active_camera(),b="FORWARD BACKWARD ROT_UP ROT_DOWN ROT_LEFT ROT_RIGHT UP DOWN LEFT RIGHT MOUSE_WHEEL TOUCH_ZOOM ZOOM_INTERPOL MOUSE_X MOUSE_Y TOUCH_X TOUCH_Y ROT_TRANS_INTERPOL CHANGE_MOVE_STYLE".split(" "),c=0;c<b.length;c++)k.remove_sensor_manifold(a,
b[c]);y.get_move_style(a)==y.MS_EYE_CONTROLS&&C.get_first_character()&&G.remove(a)}function w(a,b,c,d){var e=document.createElement("div"),f=document.createElement("div"),g=document.createElement("div");if(d)for(var h=0;h<d.length;h++){var k=document.getElementById(d[h]);k&&k.parentNode.removeChild(k)}e.style.cssText="z-index:10;width:100%;height:auto;position:absolute;top:50%;margin-top:150px;text-align:center;";f.style.cssText="color:#fff;font-size:24px;";g.style.cssText="color:#fff;font-size:20px;";
f.innerHTML=a;g.innerHTML=b+'   <a style="color:#fff;font-size:20px;width:100%;" href="'+c+'">'+c.replace("https://www.","")+"</a>";e.appendChild(f);e.appendChild(g);document.body.appendChild(e)}function E(a,b,c,d,e){function f(){var h=performance.now()-g;e(b+h*(c-b)/d);(h>=d||!a.parentNode)&&v.remove_loop_cb(f)}var g=performance.now();v.append_loop_cb(f)}p("animation");var y=p("camera"),A=p("config"),G=p("constraints"),x=p("container"),k=p("controls"),t=p("data"),M=p("debug"),u=p("input"),v=p("main"),
z=p("physics"),S=p("print"),C=p("scenes"),W=p("transform"),F=p("util"),K=p("vec3"),X=1,N=null,L=!1,P=!1,da=!1,U=new Float32Array(2),ga=new Float32Array(2),T=new Float32Array(3),la=new Float32Array(3);new Float32Array(3);var O=new Float32Array(4),Q={},Z={};a.init=function(a){function d(){var a=b(m,G,y,q),f=x.get_canvas();if(a){var k=x.get_container();x.resize_to_container();F&&(n(p,u),v.set_fps_callback(h));C&&(e(),c());r&&v.append_loop_cb(function(){k.style.height=k.clientWidth/r+"px"});l&&v.append_loop_cb(function(){x.resize_to_container()});
L&&v.append_loop_cb(function(){x.force_offsets_updating()});w&&A.reset_limits();g(f,!0)}else g(f,!1)}function f(a){a.keyCode==k.KEY_P&&(v.is_paused()?v.resume():v.pause())}function g(){}a=a||{};var l=!1,m=null,q=null,p=null,r=0,u=null,z=!0,w=!1,C=!0,y=!0,B=!1,F=!1,D=!1,L=!1,E;for(E in a)switch(E){case "canvas_container_id":m=a.canvas_container_id;break;case "callback":g=a.callback;break;case "autoresize":l=a.autoresize;break;case "do_not_use_onload":break;case "show_hud_debug_info":D=a.show_hud_debug_info;
break;case "sfx_mix_mode":B=a.sfx_mix_mode;break;case "show_fps":F=a.show_fps;break;case "track_container_position":L=a.track_container_position;break;case "fps_wrapper_id":u=a.fps_wrapper_id;break;case "fps_elem_id":p=a.fps_elem_id;break;case "error_purge_elements":q=a.error_purge_elements;break;case "report_init_failure":y=a.report_init_failure;break;case "pause_invisible":C=a.pause_invisible;break;case "key_pause_enabled":z=a.key_pause_enabled;break;case "force_container_ratio":r=a.force_container_ratio;
break;case "min_capabilities":w=a.min_capabilities;break;default:A.set(E,a[E])}z&&document.addEventListener("keydown",f,!1);A.set("show_hud_debug_info",D);A.set("sfx_mix_mode",B);var G=D||B||null;"complete"==document.readyState?window.setTimeout(d,0):window.addEventListener("load",d,!1);window.addEventListener("unload",function(){t.cleanup()},!1)};a.resize_to_container=function(){S.qb("app.resize_to_container","container.resize_to_container");x.resize_to_container()};a.set_onclick=function(a,b){var c=
r(a);c.addEventListener("mouseup",function(){b(c.value)},!1)};a.set_onchange=function(a,b){var c=r(a);c.addEventListener("change",function(){var a=c.checked;b(void 0!=a?a:c.value)},!1)};a.set_onkeypress=function(a,b){var c=r(a);c.addEventListener("keypress",function(a){b(a.keyCode,c.value)},!1)};a.enable_camera_controls=f;a.disable_camera_controls=D;a.set_camera_move_style=function(a){S.xg("app.set_camera_move_style",["camera.static_setup","camera.eye_setup","camera.target_setup","camera.hover_setup",
"camera.hover_setup_rel"]);var b=C.get_active_camera();y.set_move_style(b,a)};a.enable_object_controls=function(a){function b(a){return a[0]&&(a[1]||a[2])}function c(a,b,e){if(1==e)switch(e=k.get_sensor_value(a,b,0),b){case "FORWARD":d?z.vehicle_throttle(a,1):W.move_local(a,0,0,1*e);break;case "BACKWARD":d?z.vehicle_throttle(a,-1):W.move_local(a,0,0,-1*e);break;case "LEFT":d?z.vehicle_steer(a,-1):W.move_local(a,1*e,0,0);break;case "RIGHT":d?z.vehicle_steer(a,1):W.move_local(a,-1*e,0,0)}else switch(b){case "FORWARD":case "BACKWARD":d&&
z.vehicle_throttle(a,0);break;case "LEFT":case "RIGHT":d&&z.vehicle_steer(a,0)}}var d=z.is_vehicle_chassis(a)||z.is_vehicle_hull(a),e=k.create_elapsed_sensor(),f=k.create_keyboard_sensor(k.KEY_W),g=k.create_keyboard_sensor(k.KEY_S),h=k.create_keyboard_sensor(k.KEY_A),l=k.create_keyboard_sensor(k.KEY_D),m=k.create_keyboard_sensor(k.KEY_UP),n=k.create_keyboard_sensor(k.KEY_DOWN),q=k.create_keyboard_sensor(k.KEY_LEFT),p=k.create_keyboard_sensor(k.KEY_RIGHT);k.create_sensor_manifold(a,"FORWARD",k.CT_CONTINUOUS,
[e,f,m],b,c);k.create_sensor_manifold(a,"BACKWARD",k.CT_CONTINUOUS,[e,g,n],b,c);k.create_sensor_manifold(a,"LEFT",k.CT_CONTINUOUS,[e,h,q],b,c);k.create_sensor_manifold(a,"RIGHT",k.CT_CONTINUOUS,[e,l,p],b,c)};a.disable_object_controls=function(a){for(var b=["FORWARD","BACKWARD","LEFT","RIGHT"],c=0;c<b.length;c++)k.remove_sensor_manifold(a,b[c])};a.enable_controls=function(){S.uc("app.enable_controls() deprecated")};a.disable_controls=function(){S.uc("app.disable_controls() deprecated")};a.enable_debug_controls=
function(){k.create_kb_sensor_manifold(null,"CAMERA_SHOT",k.CT_SHOT,k.KEY_K,function(){M.make_camera_frustum_shot()});k.create_kb_sensor_manifold(null,"LIGHT_SHOT",k.CT_SHOT,k.KEY_L,function(){M.make_light_frustum_shot()});k.create_kb_sensor_manifold(null,"TELEMETRY",k.CT_SHOT,k.KEY_T,function(){M.plot_telemetry()})};a.request_fullscreen=function(a,b,c){function d(){document.fullscreenElement===a||document.webkitFullScreenElement===a||document.mozFullScreenElement===a||document.webkitIsFullScreen||
document.msFullscreenElement===a?b():(document.removeEventListener("fullscreenchange",d,!1),document.removeEventListener("webkitfullscreenchange",d,!1),document.removeEventListener("mozfullscreenchange",d,!1),document.removeEventListener("MSFullscreenChange",d,!1),c())}b=b||function(){};c=c||function(){};document.addEventListener("fullscreenchange",d,!1);document.addEventListener("webkitfullscreenchange",d,!1);document.addEventListener("mozfullscreenchange",d,!1);document.addEventListener("MSFullscreenChange",
d,!1);a.requestFullScreen=a.requestFullScreen||a.webkitRequestFullScreen||a.mozRequestFullScreen||a.msRequestFullscreen;a.requestFullScreen?a.requestFullScreen():S.error("B4W App: request fullscreen method is not supported")};a.exit_fullscreen=function(){var a=document.exitFullscreen||document.webkitExitFullscreen||document.mozCancelFullScreen||document.msExitFullscreen;"function"!=typeof a&&S.error("B4W App: exit fullscreen method is not supported");a.apply(document)};a.check_fullscreen=function(){return window.document.fullscreenEnabled||
window.document.mozFullScreenEnabled||window.document.msFullscreenEnabled||window.document.webkitFullscreenEnabled?!0:!1};a.report_app_error=w;a.get_url_params=function(a){a=!!a;var b=decodeURIComponent(location.href.toString());if(-1==b.indexOf("?"))return null;for(var b=b.split("?")[1].split("&"),c={},d=0;d<b.length;d++){var e=b[d].split("="),f=e[0];1<e.length?(e=e[1],a?f in c?c[f].push(e):c[f]=[e]:c[f]=e):a?f in c||(c[f]=[]):c[f]=""}return c};a.css_animate=function(a,b,c,d,e,f,g,h){function k(e){a&&
(l[b]=f+e+g,c>d&&e<=d||c<d&&e>=d)&&(l[b]=f+d+g,h())}if(a&&b&&isFinite(c)&&isFinite(d)&&isFinite(e)){f=f||"";g=g||"";h=h||function(){};var l=a.style,m=b.charAt(0).toUpperCase()+b.slice(1);if(void 0==l[b])if(void 0!=l["webkit"+m])b="webkit"+m;else if(void 0!=l["ms"+m])b="ms"+m;else if(void 0!=l["moz"+m])b="moz"+m;else return;E(a,c,d,e,k)}};a.attr_animate=function(a,b,c,d,e,f){function g(e){a&&(0<=e&&a.setAttribute(b,e),c>d&&e<=d||c<d&&e>=d)&&(a.setAttribute(b,d),f())}a&&b&&isFinite(c)&&isFinite(d)&&
isFinite(e)&&(f=f||function(){},E(a,c,d,e,g))};a.queue_animate=function(b){if(b.length){var c=b.shift(),d=c.elem,e=c.prop,f=c.from,g=c.to,h=c.duration,k=c.opt_prefix,l=c.opt_suffix,m=function(){c.cb&&c.cb();a.queue_animate(b)};"css"==c.type?a.css_animate(d,e,f,g,h,k,l,m):"attr"==c.type&&a.attr_animate(d,e,f,g,h,m)}};a.set_camera_smooth_factor=function(a){X=a};a.get_camera_smooth_factor=function(){return X}};b4w.module.camera_anim=function(a,p){function e(a,b,d,e,f){d=q.angle_wrap_0_2pi(b-d);d=Math.min(d,2*Math.PI-d);b=q.angle_wrap_0_2pi(e-b);b=Math.min(b,2*Math.PI-b);if(1E-6>Math.abs(d)||1E-6>2*Math.PI-Math.abs(d))d=0;if(1E-6>Math.abs(b)||1E-6>2*Math.PI-Math.abs(b))b=0;c.is_eye_camera(a)?(f[0]=b,f[1]=d):(f[0]=d,f[1]=b);return f}var c=p("camera"),b=p("controls"),n=p("print"),h=p("scenes"),r=p("time"),g=p("transform"),m=p("tsr"),q=p("util"),B=p("vec3"),d=p("quat"),l=new Float32Array(2),f=new Float32Array(2),
H=new Float32Array(3),D=new Float32Array(3),w=new Float32Array(3),E=new Float32Array(4),y=m.create(),A=m.create(),G=m.create(),x={},k=!1,t=!1,M=!1,u=!1;a.track_to_target=function(a,e,f,h,k,m,p,r){if(!c.is_eye_camera(a))n.error("track_to_target(): wrong object");else if(a&&e){if(q.is_vector(e))var u=e;else u=w,g.get_object_center(e,!1,u);e=f||1;f=h||2;var t=k||1;k=m||1;D[0]=0;D[1]=-1;D[2]=0;var x=g.get_rotation(a);m=q.quat_to_dir(x,D);h=c.get_camera_angles(a,l);var y=g.get_translation(a);B.subtract(u,
y,H);B.normalize(H,H);var A=d.rotationTo(m,H,d.create());d.multiply(A,x,E);q.correct_cam_quat_up(E,!1);B.subtract(u,y,D);var G=B.length(D)*(1-1/f),u=Math.asin(H[1]);f=Math.acos(-H[2]/Math.abs(Math.cos(u)));0<H[0]&&(f=2*Math.PI-f);var M=f-h[0],la=u-h[1];w[0]=0;w[1]=0;w[2]=-1;f=g.get_rotation(a);0>q.quat_to_dir(f,w)[1]?(la=0<m[1]?u-Math.PI+h[1]:u+Math.PI+h[1],M=0<M?-Math.PI+M:Math.PI+M):Math.abs(M)>Math.PI&&(M=0<M?M-2*Math.PI:M+2*Math.PI);var O=0,u=b.create_elapsed_sensor();m=Math.abs(M/e);e=Math.abs(la/
e);var Q=m>e?m:e,Z=Q+t,ma=Z+k,ra=ma+t,ja=M,oa=la,ha=G,ea=function(){b.remove_sensor_manifold(a,"TRACK_TO_TARGET");p&&p()};b.create_sensor_manifold(a,"TRACK_TO_TARGET",b.CT_CONTINUOUS,[u],null,function(a,d,e){if(e)if(c.is_eye_camera(a))if(e=b.get_sensor_value(a,d,0),O+=e,O<Q){var f=M/Q*e;e*=la/Q;d=O/Q;d=6*d*(1-d);f*=d;e*=d;ja-=f;oa-=e;c.eye_rotate(a,f,e)}else O<Z?(ja&&(c.eye_rotate(a,ja,oa),ja=0,r&&r()),d=(O-Q)/t,e=-G*e/t,ha-=f,g.move_local(a,0,6*e*d*(1-d),0)):O<ma?ha&&(g.move_local(a,0,ha,0),ha=0):
O<ra?(d=(O-ma)/t,e=G*e/t,e=6*e*d*(1-d),g.move_local(a,0,e,0)):(g.set_translation_v(a,y),ea());else ea()})}};a.auto_rotate=function(a,d,g){function k(d,g,h){if(1==h)if(h=c.get_move_style(d),h==c.MS_STATIC)m();else if(h!=c.MS_TARGET_CONTROLS&&h!=c.MS_EYE_CONTROLS||!c.has_horizontal_rot_limits(d))r=null,g=b.get_sensor_value(d,g,0),c.rotate_camera(d,g*a,0);else{h=h==c.MS_EYE_CONTROLS?c.eye_get_horizontal_limits(d,x):c.target_get_horizontal_limits(d,x);if(null===r||h.left!=r.left||h.right!=r.right){r=
r||{};r.left=h.left;r.right=h.right;u=Math.min(.2,q.angle_wrap_0_2pi(r.right-r.left)/2);h=p;var n=r,w=c.get_camera_angles(h,l)[0];h=e(h,w,n.left,n.right,f);t=a*Math.min(1,h[0]/.2,h[1]/.2)}g=b.get_sensor_value(d,g,0);h=c.get_camera_angles(d,l)[0];h=e(d,h,r.left,r.right,f);h[1]>u&&h[0]>u?t=q.sign(t)*a:h[1]<u?t-=Math.pow(a,2)/.4*g:h[0]<u&&(t+=Math.pow(a,2)/.4*g);c.rotate_camera(d,g*t,0)}}function m(){b.remove_sensor_manifold(p,"AUTO_ROTATE");b.remove_sensor_manifold(p,"DISABLE_AUTO_ROTATE");d()}d=d||
function(){};var p=h.get_active_camera();if(c.is_static_camera(p))n.error("auto_rotate(): Wrong camera move style");else{var r={},u=0,t=0;if(b.check_sensor_manifold(p,"AUTO_ROTATE"))m();else{var w=b.create_mouse_move_sensor("X"),y=b.create_mouse_move_sensor("Y"),A=b.create_mouse_click_sensor(),B=b.create_touch_move_sensor(),D=b.create_touch_zoom_sensor(),E=b.create_elapsed_sensor();g=g?b.create_mouse_wheel_sensor():b.create_custom_sensor(0);b.create_sensor_manifold(p,"DISABLE_AUTO_ROTATE",b.CT_LEVEL,
[w,y,A,B,D,g],function(a){return a[0]&&a[2]||a[1]&&a[2]||a[3]||a[4]||a[5]},m);b.create_sensor_manifold(p,"AUTO_ROTATE",b.CT_CONTINUOUS,[E],function(a){return a[0]},k)}}};a.is_auto_rotate=function(){var a=h.get_active_camera();return b.check_sensor_manifold(a,"AUTO_ROTATE")};a.check_auto_rotate=function(){var a=h.get_active_camera();return c.get_move_style(a)==c.MS_STATIC?!1:!0};a.move_camera_to_point=function(a,b,d,e,f){if(c.get_move_style(a)!=c.MS_STATIC)n.error("move_camera_to_point(): wrong camera type");
else if(!k)if(a)if(b){d=d||1;e=e||.01;var h=q.is_vector(a)?a:g.get_tsr(a,y),l=q.is_vector(b)?b:g.get_tsr(b,A);b=B.distance(m.get_trans_view(h),m.get_trans_view(l))/d;d=q.quat_to_dir(m.get_quat_view(h),q.AXIS_MY,H);var p=q.quat_to_dir(m.get_quat_view(l),q.AXIS_MY,D);d=Math.min(Math.abs(B.dot(d,p)),1);e=1E3*Math.max(b,Math.acos(d)/e);k=!0;var u=r.animate(0,1,e,function(b){var c=m.interpolate(h,l,q.smooth_step(b),G);M?(r.clear_animation(u),k=M=!1):(g.set_tsr(a,c),1==b&&(k=!1,f&&f()))})}else n.error("move_camera_to_point(): you must specify the point object");
else n.error("move_camera_to_point(): you must specify the camera object")};a.rotate_camera=function(a,b,d,e,f){if(c.get_move_style(a)==c.MS_STATIC)n.error("rotate_camera(): not supported for STATIC cameras");else if(!t)if(a)if(b||d){t=!0;var g=0,h=0,k=0!=b?b:d,l=r.animate(0,k,e||1E3,function(e){u?(r.clear_animation(l),t=u=!1):(g-=e,h-=e,d&&b?c.rotate_camera(a,g,h):d?c.rotate_camera(a,0,h):b&&c.rotate_camera(a,g,0),h=g=e,e==k&&(t=!1,f&&f()))})}else n.error("rotate_camera(): you must specify the rotation angle");
else n.error("rotate_camera(): you must specify the camera object")};a.stop_cam_moving=function(){M=!0};a.stop_cam_rotating=function(){u=!0};a.is_moving=function(){return k};a.is_rotating=function(){return t}};b4w.module.gp_conf=function(a,p){function e(){z.length=0;for(var a=navigator.getGamepads?navigator.getGamepads():navigator.webkitGetGamepads?navigator.webkitGetGamepads:[],b=0;b<a.length;b++)a[b]&&z.push(a[b]);return z}function c(a){var b=H.get(a+"_gmpd_stngs","b4w");if(b){var b=JSON.parse(b),c;for(c in b)f.set_gamepad_key(a,c,b[c])}else c=JSON.stringify(w),H.set(a+"_gmpd_stngs",c,"b4w")}function b(a){F=!0;var b=document.createElement("div"),c=document.createElement("div"),d=document.createElement("div"),
e=document.createElement("div"),g=document.createElement("div"),h=document.createElement("div"),l=document.createElement("div"),n=document.createElement("div"),q=document.createElement("div"),p=document.createElement("div"),r=document.createElement("div"),u=document.createElement("div"),v=document.createElement("div"),t=document.createElement("div"),w=document.createElement("div"),z=document.createElement("div"),x=document.createElement("div"),y=document.createElement("div"),A=document.createElement("div"),
B=document.createElement("div"),G=document.createElement("div"),H=document.createElement("div");k=b;b.style.cssText="position: absolute;height: auto;background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg26627" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="128.51mm" viewBox="0 0 636.63517 455.33329" width="179.67mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:dc="http://purl.org/dc/elements/1.1/"><defs id="defs26629"><linearGradient id="linearGradient4691"><stop id="stop4693" offset="0"/><stop id="stop4695" stop-opacity="0" offset="1"/></linearGradient><linearGradient id="linearGradient4358"><stop id="stop4360" stop-color="#2e2e2e" offset="0"/><stop id="stop4362" stop-color="#2e2e2e" stop-opacity="0" offset="1"/></linearGradient><linearGradient id="linearGradient4364" x1="1141.5" xlink:href="#linearGradient4358" gradientUnits="userSpaceOnUse" y1="255.95" gradientTransform="matrix(-1 0 0 1 1531.4 560.1)" x2="1165.2" y2="309.88"/><linearGradient id="linearGradient4368" x1="1141.5" xlink:href="#linearGradient4358" gradientUnits="userSpaceOnUse" y1="255.95" gradientTransform="translate(-896.37 560.1)" x2="1165.2" y2="309.88"/><linearGradient id="linearGradient4430" x1="959.32" gradientUnits="userSpaceOnUse" y1="653.07" gradientTransform="matrix(-1 0 0 1 1531.4 70.097)" x2="1467.6" y2="653.07"><stop id="stop4426" stop-color="#4f4f4f" offset="0"/><stop id="stop4428" stop-color="#4f4f4f" stop-opacity="0" offset="1"/></linearGradient><linearGradient id="linearGradient4701" x1="529.91" xlink:href="#linearGradient4691" gradientUnits="userSpaceOnUse" y1="111.1" gradientTransform="translate(-52.276 546.89)" x2="481.49" y2="85.746"/><linearGradient id="linearGradient4713" x1="529.91" xlink:href="#linearGradient4691" gradientUnits="userSpaceOnUse" y1="111.1" gradientTransform="matrix(-1 0 0 1 689.01 546.89)" x2="481.49" y2="85.746"/><linearGradient id="linearGradient4725" x1="367.39" xlink:href="#linearGradient4691" gradientUnits="userSpaceOnUse" y1="125.6" gradientTransform="matrix(-1.3272 0 0 .68317 806.95 579.14)" x2="367.39" y2="116.11"/></defs><metadata id="metadata26632"><rdf:RDF><cc:Work rdf:about="">    <dc:format>image/svg+xml</dc:format>    <dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/>    <dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -597.03)"><g id="g20" fill-rule="evenodd"><path id="path4209" fill="#434343" d="m576.71 1052.4c42.015-1.9097 64.296-46.468 59.204-122.86-5.0928-76.387-27.374-175.69-44.562-224.7-17.188-49.015-25.501-62.531-26.737-65.565-3.7697-9.2504-11.278-19.949-62.379-27.691-28.97-4.3891-16.697-7.9577-27.084-9.4696-17.96-2.6141-43.609-1.229-52.203 1.6354-8.594 2.8645-12.709 29.16-24.486 35.207-11.777 6.0473-19.416 10.185-80.149 10.185s-68.372-4.1376-80.149-10.185c-11.777-6.0473-18.113-32.099-25.736-36.993-11.183-7.1796-26.985-5.6722-54.891-0.57481-5.64 1.0302-1.1304 7.6212-18.165 12.509-32.913 9.4438-52.094 3.7056-65.087 20.831-1.9807 2.6106-11.822 21.096-29.01 70.111-17.179 48.95-39.46 148.25-44.553 224.64-5.0929 76.39 17.188 120.99 59.204 122.89 73.339-1.7 55.219-116.53 258.4-116.53s185.05 114.82 258.4 116.49z"/><path id="path4366" fill="url(#linearGradient4368)" d="m249.77 838.51c-107.76 0-171.55 96.288-176.84 121.23-5.2294 24.634-17.658 55.705 3.8195 53.789 9.6996-0.8655 18.053-15.713 37.559-38.193 18.78-21.643 41.379-54.425 96.763-54.425s73.209-44.877 75.119-53.152c1.9098-8.2752 2.4146-27.976-36.418-29.25z"/><path id="path4217" fill="url(#linearGradient4364)" d="m385.23 838.51c107.76 0 171.55 96.288 176.84 121.23 5.2293 24.634 17.658 55.705-3.8195 53.789-9.6996-0.8655-18.053-15.713-37.559-38.193-18.78-21.643-41.379-54.425-96.763-54.425s-73.209-44.877-75.119-53.152c-1.9098-8.2752-2.4146-27.976 36.418-29.25z"/><path id="path4370" fill="url(#linearGradient4430)" d="m572.06 654.81c-60.48-19.09-76.79-18.6-89.84-17.96-13.05 0.63657-22.638 16.617-45.237 49.4s-67.48 125.27-116.23 125.27c-48.746 0-93.626-92.491-116.23-125.27-22.599-32.783-32.008-48.942-45.059-49.579-13.05-0.63648-35.251 1.8354-95.728 20.932l1.1161-2.3404c60.494-19.1 81.754-20.83 94.804-20.19 13.05 0.63657 22.281 13.049 44.88 45.832s67.48 123.49 116.23 123.49c48.746 0 93.626-90.709 116.23-123.49 22.599-32.783 31.83-45.195 44.88-45.832 13.05-0.63648 28.783-1.6248 89.26 17.472"/><path id="path4315" fill="#343434" d="m570.99 652.48c-60.477-19.097-76.074-18.269-89.124-17.633-13.05 0.63658-22.281 14.832-44.88 47.614-22.599 32.783-67.48 125.27-116.23 125.27-48.746 0-93.626-92.491-116.23-125.27-22.599-32.783-31.83-46.978-44.88-47.614-13.05-0.63648-34.715 1.2996-95.192 20.396l1.1161-2.3404c60.474-19.1 81.024-22.26 94.074-21.62 13.05 0.63658 22.281 13.049 44.88 45.832s67.48 123.49 116.23 123.49c48.746 0 93.626-90.709 116.23-123.49 22.599-32.783 31.83-45.195 44.88-45.832 13.05-0.63647 27.71-0.17274 88.186 18.924"/></g><g id="g15645" transform="matrix(.75439 0 0 1 1558.5 -6638.3)" fill-rule="evenodd"><rect id="rect15584" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="2" ry="1.8461" height="44.307" width="570" y="6558.3" x="100.71" fill="#4164bb"/><rect id="rect15331" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="2" ry="1.8461" height="44.307" width="570" y="6554.6" x="100.71" fill="#5276cf"/></g><text id="text15623-9" style="word-spacing:0px;letter-spacing:0px" font-weight="300" xml:space="preserve" font-size="22px" line-height="430.99999428%" y="-53.755863" x="1792.7805" font-family="&apos;Noto Sans CJK TC&apos;" fill="#ffffff"><tspan id="tspan15625-5" y="-53.755863" x="1792.7805"/></text><text id="text15657" style="word-spacing:0px;letter-spacing:0px" font-weight="300" xml:space="preserve" font-size="13px" line-height="430.99999428%" y="-3.7607465" x="1670.2437" font-family="&apos;Noto Sans CJK TC&apos;" fill="#828282"><tspan id="tspan15659" y="-3.7607465" x="1670.2437"/></text><g id="g34" fill-rule="evenodd"><path id="path4675" fill="#303030" d="m551.75 628.4c9.3003 4.1796 8.2375 11.558 2.1302 9.9581-6.1073-1.6003-33.792-9.1405-46.239-11.577-12.446-2.4363-34.904-3.0623-36.951-4.0165-2.0474-0.95416 0.93313-7.7247 5.491-7.3449 23.258 0.91012 59.905 6.0339 75.569 12.98z"/><path id="path4677" fill="#303030" d="m474.88 602.61c3.6488 0.63684 4.1169 1.3708 2.4115 5.2499-0.80967 1.8416-1.261 3.904-3.4715 3.7336-4.456-0.34344-16.578-1.2846-25.692-1.3764-9.1139-0.0918-23.83 1.217-25.307 0.79399-1.4771-0.42301-1.8834-4.9141 1.7769-6.7458 4.6221-1.3593 38.698-3.2021 50.281-1.6553z"/><path id="path4699" opacity=".384" fill="url(#linearGradient4701)" d="m475.53 611.7c-11.693-0.63604-8.4597-0.73151-44.068 54.448-6.5182 8.6489-22.874 37.231-36.865 35.326-6.7491-1.4177 15.436-67.299 22.724-75.767 11.112-12.911 19.255-16.122 58.209-14.007z"/><path id="path4703" fill="#303030" d="m84.068 628.4c-9.3003 4.1796-8.2375 11.558-2.1302 9.9581 6.1073-1.6003 33.792-9.1405 46.239-11.577 12.446-2.4363 34.904-3.0623 36.951-4.0165 2.0474-0.95416-0.93313-7.7247-5.491-7.3449-23.258 0.91012-59.905 6.0339-75.569 12.98z"/><path id="path4705" fill="#303030" d="m161.86 602.61c-3.6488 0.63684-4.1169 1.3708-2.4115 5.2499 0.80967 1.8416 1.261 3.904 3.4715 3.7336 4.456-0.34344 16.578-1.2846 25.692-1.3764 9.1139-0.0918 23.83 1.217 25.307 0.79399 1.4771-0.42301 1.8834-4.9141-1.7769-6.7458-4.6221-1.3593-38.698-3.2021-50.281-1.6553z"/><path id="path4711" opacity=".384" fill="url(#linearGradient4713)" d="m161.2 611.7c11.693-0.63604 8.4597-0.73151 44.068 54.448 6.5182 8.6489 22.874 37.231 36.865 35.326 6.7491-1.4177-15.436-67.299-22.724-75.767-11.112-12.911-19.255-16.122-58.209-14.007z"/><path id="path4717" opacity=".115" fill="url(#linearGradient4725)" d="m413.37 645.84c-9.0496 10.007-29.401 19.937-36.775 19.937h-52.205c-31.171 0-37.359 0.34506-47.75 0.51758-10.39 0.17253-18.682 0.65628-23.653-3.278-5.0513-3.9977-24-15.425-24-15.425 53.346 4.1464 144.49 4.3368 184.38-1.7523z"/></g></g><g id="layer1-0" fill-rule="evenodd" transform="translate(159.08 -720.76)"><g id="g4527-3" transform="translate(-961.22,330.69)"><ellipse id="circle4233-8" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="66.284" ry="66.279" cy="655.39" cx="1027.5" fill="#303030"/><ellipse id="circle4235-8" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="62.007" ry="62.003" cy="655.39" cx="1027.5" fill="#4c4c4c"/><ellipse id="circle4237-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="43.41" ry="43.408" cy="655.39" cx="1027.5" fill="#303030"/></g><g id="g4523-1" transform="translate(-961.22,330.69)"><ellipse id="circle4239-4" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="40.057" ry="40.054" cy="655.39" cx="1027.5" fill="#3b63c9"/><ellipse id="circle4243-3" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="36.23" ry="36.228" cy="655.39" cx="1027.5" fill="#5276cf"/></g><g id="g3506" transform="translate(-961.22,330.69)"><ellipse id="ellipse3508" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="66.284" ry="66.279" cy="655.39" cx="1027.5" fill="#303030"/><ellipse id="ellipse3510" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="62.007" ry="62.003" cy="655.39" cx="1027.5" fill="#4c4c4c"/><ellipse id="ellipse3512" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="43.41" ry="43.408" cy="655.39" cx="1027.5" fill="#303030"/></g></g><g id="layer1-7" fill-rule="evenodd" transform="translate(352.57 -719.72)"><g id="g4527-3-4" transform="translate(-961.22,330.69)"><ellipse id="circle4233-8-8" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="66.284" ry="66.279" cy="655.39" cx="1027.5" fill="#303030"/><ellipse id="circle4235-8-9" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="62.007" ry="62.003" cy="655.39" cx="1027.5" fill="#4c4c4c"/><ellipse id="circle4237-7-3" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="43.41" ry="43.408" cy="655.39" cx="1027.5" fill="#303030"/></g><g id="g4523-1-1" transform="translate(-961.22,330.69)"><ellipse id="circle4239-4-4" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="40.057" ry="40.054" cy="655.39" cx="1027.5" fill="#3b63c9"/><ellipse id="circle4243-3-5" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="36.23" ry="36.228" cy="655.39" cx="1027.5" fill="#5276cf"/></g><g id="g3506-2" transform="translate(-961.22,330.69)"><ellipse id="ellipse3508-1" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="66.284" ry="66.279" cy="655.39" cx="1027.5" fill="#303030"/><ellipse id="ellipse3510-1" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="62.007" ry="62.003" cy="655.39" cx="1027.5" fill="#4c4c4c"/><ellipse id="ellipse3512-4" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="43.41" ry="43.408" cy="655.39" cx="1027.5" fill="#303030"/></g></g></svg>')+
"');width: 637px;height: 455px;background-size: 100% 100%;left: 50%;margin-bottom: 40px;-moz-transform: translateX(-50%);-ms-transform: translateX(-50%);-webkit-transform: translateX(-50%);bottom: 0px;";c.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3904" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="35.924mm" width="35.926mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 127.29808 127.28933"><metadata id="metadata3909"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" fill-rule="evenodd" transform="translate(0 -925.07)"><ellipse id="circle4330" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="63.649" ry="63.645" cy="988.72" cx="63.649" fill="#303030"/><ellipse id="circle4223" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="59.705" ry="59.701" cy="988.72" cx="63.649" fill="#4c4c4c"/></g></svg>')+
"');position: absolute;top: 47px;left: 65px;width: 135px;height: 135px;";d.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3754" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.711mm" width="9.9653mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 35.3101 37.950677"><metadata id="metadata3759"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1014.4)"><path id="path4326" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m34.81 1017.1c-15.254-3.8172-24.634-1.7612-34.31 0v16.247h0.015c-0.013 0.097-0.013 0.1951-0.015 0.2928 0.0006 9.4753 7.6813 18.256 17.156 18.256 9.4739-0.0005 17.154-8.7813 17.154-18.256 0-0.097-0.014-0.1952-0.014-0.2928h0.014z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>')+
"');width: 36px;height: 38px;left: 49px;top: 8px;position: absolute;";e.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3790" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.9646mm" width="10.711mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 37.953175 35.3077"><metadata id="metadata3795"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1017.1)"><path id="path4324" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m35.298 1017.6c3.8175 15.253 1.7611 24.633 0 34.308h-16.248v-0.015c-0.098 0.01-0.1952 0.01-0.2928 0.015-9.476-0.0006-18.258-7.6807-18.257-17.154 0.0005-9.4733 8.7818-17.153 18.257-17.153 0.098 0 0.1952 0.01 0.2928 0.011v-0.011z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>')+
"');width: 38px;height: 36px;top: 47px;left: 84px;position: absolute;";g.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3754" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.711mm" width="9.9653mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 35.3101 37.950677"><metadata id="metadata3759"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1014.4)"><path id="path4328" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m34.81 1049.7c-15.254 3.8172-24.634 1.7612-34.31 0v-16.247h0.015c-0.013-0.097-0.013-0.1951-0.015-0.2928 0.0006-9.4753 7.6813-18.256 17.156-18.256 9.4739 0.0005 17.154 8.7813 17.154 18.256 0 0.097-0.014 0.1952-0.014 0.2928h0.014z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>')+
"');width: 36px;height: 38px;bottom: 11px;left: 51px;position: absolute;";h.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3790" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.9646mm" width="10.711mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 37.953175 35.3077"><metadata id="metadata3795"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1017.1)"><path id="path4324" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m2.6552 1051.9c-3.8175-15.253-1.7611-24.633 0-34.308h16.248v0.015c0.098-0.01 0.1952-0.01 0.2928-0.015 9.476 0.0006 18.258 7.6807 18.257 17.154-0.0005 9.4733-8.7818 17.153-18.257 17.153-0.098 0-0.1952-0.01-0.2928-0.011v0.011z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>')+
"');width: 38px;height: 36px;top: 47px;left: 13px;position: absolute;";l.style.cssText="position: absolute;top: 55px;left: 434px;width: 150px;height: 150px;";n.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>')+
"');width: 50px;height: 50px;left: 53px;top: 0px;position: absolute;";q.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>')+
"');width: 50px;height: 50px;left: 107px;top: 51px;position: absolute;";p.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>')+
"');width: 50px;height: 50px;left: 53px;bottom: 0px;position: absolute;";r.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>')+
"');width: 50px;height: 50px;top: 51px;position: absolute;";u.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3461" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="22.608mm" width="22.61mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 80.114398 80.108405"><metadata id="metadata3466"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(.0000019915 -972.25)"><g id="g3514-7" fill-rule="evenodd" transform="translate(-987.45 356.91)"><ellipse id="ellipse3516-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="40.057" ry="40.054" cy="655.39" cx="1027.5" fill="#3b63c9"/><ellipse id="ellipse3518-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="36.23" ry="36.228" cy="655.39" cx="1027.5" fill="#5276cf"/></g></g></svg>')+
"');position: absolute;top: 222px;left: 183px;width: 85px;height: 85px;";v.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3461" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="22.608mm" width="22.61mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 80.114398 80.108405"><metadata id="metadata3466"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(.0000019915 -972.25)"><g id="g3514-7" fill-rule="evenodd" transform="translate(-987.45 356.91)"><ellipse id="ellipse3516-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="40.057" ry="40.054" cy="655.39" cx="1027.5" fill="#3b63c9"/><ellipse id="ellipse3518-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="36.23" ry="36.228" cy="655.39" cx="1027.5" fill="#5276cf"/></g></g></svg>')+
"');position: absolute;top: 223px;left: 376px;width: 85px;height: 85px;";t.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3699" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.2811mm" width="9.2817mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 32.8879 32.88565"><metadata id="metadata3704"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" fill-rule="evenodd" transform="translate(0 -1019.5)"><ellipse id="ellipse4575" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="16.444" ry="16.443" cy="1035.9" cx="16.444" fill="#2e2e2e"/><ellipse id="ellipse4577" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="15.112" ry="15.11" stroke="#4364b2" cy="1035.9" cx="16.444" fill="#5276cf"/><ellipse id="ellipse4579" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="11.867" ry="11.866" cy="1035.9" cx="16.444" fill="#434343"/></g></svg>')+
"');position: absolute;top: 76px;left: 227px;width: 34px;height: 34px;";w.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3699" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.2811mm" width="9.2817mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 32.8879 32.88565"><metadata id="metadata3704"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" fill-rule="evenodd" transform="translate(0 -1019.5)"><ellipse id="ellipse4575" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="16.444" ry="16.443" cy="1035.9" cx="16.444" fill="#2e2e2e"/><ellipse id="ellipse4577" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="15.112" ry="15.11" stroke="#4364b2" cy="1035.9" cx="16.444" fill="#5276cf"/><ellipse id="ellipse4579" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="11.867" ry="11.866" cy="1035.9" cx="16.444" fill="#434343"/></g></svg>')+
"');position: absolute;top: 76px;left: 376px;width: 34px;height: 34px;";z.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="21.241671mm" height="8.8544388mm" viewBox="0 0 75.265762 31.373996" id="svg3447" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="l1.svg"><defs id="defs3449" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="1.4" inkscape:cx="-254.57869" inkscape:cy="228.81952" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3452"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(1.5000945e-8,-1020.9882)"><path style="fill:#5276cf;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.99999994px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1" d="m 11.026383,1051.1651 c -7.4440599,1.9144 -7.5133499,2.2466 -9.7963799,-4.4934 -1.81058997,-5.3452 -2.44278,-8.8152 4.01547,-12.116 2.74038,-1.4007 13.7365799,-5.877 38.4768299,-10.72 24.26031,-4.749 25.16653,-2.7967 26.79132,0.3418 1.15503,2.2311 1.8961,4.1561 2.94279,6.651 3.08552,8.5188 2.92609,8.5778 -6.08214,9.5501 -19.09891,2.1414 -37.95723,5.8307 -56.34789,10.7865 z" id="path4289" inkscape:connector-curvature="0" sodipodi:nodetypes="cssssccc" /></g></svg>')+
"');position: absolute;top: 4px;left: 78px;width: 79px;height: 33px;";x.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3447" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="8.8544mm" width="21.242mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 75.265762 31.373996"><metadata id="metadata3452"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(1.5001e-8 -1021)"><path id="path4715" d="m64.239 1051.2c7.4441 1.9144 7.5134 2.2466 9.7964-4.4934 1.8106-5.3452 2.4428-8.8152-4.0155-12.116-2.7404-1.4007-13.737-5.877-38.477-10.72-24.26-4.749-25.167-2.7967-26.791 0.3418-1.155 2.2311-1.8961 4.1561-2.9428 6.651-3.0855 8.5188-2.9261 8.5778 6.0822 9.5501 19.099 2.1414 37.957 5.8307 56.348 10.786z" fill-rule="evenodd" fill="#5276cf"/></g></svg>')+
"');position: absolute;top: 4px;left: 477px;width: 79px;height: 33px;";y.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3560" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="4.7796mm" width="13.57mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 48.082162 16.935645"><metadata id="metadata3565"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1035.4)"><path id="path4727" d="m42.857 1052.2c4.7071 0.4081 4.7981 0.6563 5.1414-4.9139 0.16344-2.6517 0.16699-6.1108-0.72615-8.0342-0.59471-1.2808-1.7793-2.049-3.7642-2.4662-2.5264-0.531-16.253-1.4345-26.685-1.3241-15.118 0.16-15.362 1.4769-15.855 4.1522-0.35071 1.9018-0.5016 3.5056-0.74837 5.5967-0.55261 7.0693-0.44908 7.0921 5.0452 6.5411 11.661-1.1062 25.929-0.7359 37.592 0.4484z" fill-rule="evenodd" fill="#5276cf"/></g></svg>')+
"');position: absolute;top: -7px;left: 425px;width: 50px;height: 17px;";A.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3560" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="4.7796mm" width="13.57mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 48.082162 16.935645"><metadata id="metadata3565"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1035.4)"><path id="path4727" d="m42.857 1052.2c4.7071 0.4081 4.7981 0.6563 5.1414-4.9139 0.16344-2.6517 0.16699-6.1108-0.72615-8.0342-0.59471-1.2808-1.7793-2.049-3.7642-2.4662-2.5264-0.531-16.253-1.4345-26.685-1.3241-15.118 0.16-15.362 1.4769-15.855 4.1522-0.35071 1.9018-0.5016 3.5056-0.74837 5.5967-0.55261 7.0693-0.44908 7.0921 5.0452 6.5411 11.661-1.1062 25.929-0.7359 37.592 0.4484z" fill-rule="evenodd" fill="#5276cf"/></g></svg>')+
"');position: absolute;top: -7px;left: 164px;width: 50px;height: 17px;";B.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="24.603382mm" height="24.601696mm" viewBox="0 0 87.177338 87.171363" id="svg3640" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="main.svg"><defs id="defs3642" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="1.979899" inkscape:cx="61.113463" inkscape:cy="69.71796" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3645"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(0,-965.19093)"><ellipse ry="43.585682" rx="43.588669" style="color:#000000;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:#2e2e2e;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.99999994;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate" id="ellipse4372" cx="43.588669" cy="1008.7766" /><ellipse cy="1008.7766" cx="43.588669" id="circle4239-1" style="color:#000000;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:#5276cf;fill-opacity:1;fill-rule:evenodd;stroke:#4364b2;stroke-width:0.99999994;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate" rx="40.056705" ry="40.053959" /><ellipse style="color:#000000;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:#434343;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.99999994;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate" id="circle4243-0" cx="43.588669" cy="1008.7766" rx="31.455994" ry="31.453836" /></g></svg>')+
"');position: absolute;top: 68px;left: 274px;width: 92px;height: 92px;";G.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3407" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="41.787mm" width="41.786mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 148.0624 148.06251"><metadata id="metadata3412"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -904.3)" fill="#e6e6e6"><path id="rect4545" d="m74.031 904.3-14.469 22.156h8.0313v8.2187h12.875v-8.2187h8.0625l-14.5-22.156z"/><path id="rect4603" d="m125.94 963.86v8.0313h-8.25v12.906h8.25v8.0313l22.125-14.5-22.125-14.469z"/><path id="rect4609" d="m67.594 1022v8.25h-8.0313l14.469 22.125 14.5-22.125h-8.0625v-8.25h-12.875z"/><path id="rect4615" d="m22.156 963.86-22.156 14.47l22.156 14.5v-8.2188h8.2188v-12.906h-8.2188v-7.8438z"/><path id="path4619" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m54.393 924.58c-15.821 5.7885-28.404 18.385-34.188 34.219h11.156c4.6667-10.175 12.865-18.361 23.031-23.031v-11.188zm39.219 0.031v11.156c10.167 4.6713 18.361 12.86 23.031 23.031h11.156c-5.7846-15.821-18.379-28.393-34.188-34.188zm-73.375 73.438c5.7899 15.816 18.348 28.403 34.156 34.188v-11.156c-10.163-4.6691-18.364-12.861-23.031-23.031h-11.125zm96.406 0c-4.6712 10.167-12.868 18.361-23.031 23.031v11.125c15.796-5.7901 28.366-18.352 34.156-34.156h-11.125z"/></g></svg>')+
"');position: absolute;top: 186px;left: 148px;width: 157px;height: 157px;";H.style.cssText="background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3407" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="41.787mm" width="41.786mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 148.0624 148.06251"><metadata id="metadata3412"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -904.3)" fill="#e6e6e6"><path id="rect4545" d="m74.031 904.3-14.469 22.156h8.0313v8.2187h12.875v-8.2187h8.0625l-14.5-22.156z"/><path id="rect4603" d="m125.94 963.86v8.0313h-8.25v12.906h8.25v8.0313l22.125-14.5-22.125-14.469z"/><path id="rect4609" d="m67.594 1022v8.25h-8.0313l14.469 22.125 14.5-22.125h-8.0625v-8.25h-12.875z"/><path id="rect4615" d="m22.156 963.86-22.156 14.47l22.156 14.5v-8.2188h8.2188v-12.906h-8.2188v-7.8438z"/><path id="path4619" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m54.393 924.58c-15.821 5.7885-28.404 18.385-34.188 34.219h11.156c4.6667-10.175 12.865-18.361 23.031-23.031v-11.188zm39.219 0.031v11.156c10.167 4.6713 18.361 12.86 23.031 23.031h11.156c-5.7846-15.821-18.379-28.393-34.188-34.188zm-73.375 73.438c5.7899 15.816 18.348 28.403 34.156 34.188v-11.156c-10.163-4.6691-18.364-12.861-23.031-23.031h-11.125zm96.406 0c-4.6712 10.167-12.868 18.361-23.031 23.031v11.125c15.796-5.7901 28.366-18.352 34.156-34.156h-11.125z"/></g></svg>')+
"');position: absolute;top: 187px;left: 339px;width: 157px;height: 157px;";b.appendChild(G);b.appendChild(H);c.appendChild(d);c.appendChild(e);c.appendChild(g);c.appendChild(h);b.appendChild(c);l.appendChild(n);l.appendChild(q);l.appendChild(p);l.appendChild(r);b.appendChild(l);b.appendChild(u);b.appendChild(v);b.appendChild(t);b.appendChild(w);b.appendChild(z);b.appendChild(x);b.appendChild(y);a.appendChild(b);b.appendChild(A);b.appendChild(B);S.length=0;E.length=0;C.length=0;W.length=0;S.push(p,
q,r,n,z,x,A,y,t,w,u,v,d,g,h,e,B);E.push('<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>',
'<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>',
'<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>',
'<svg id="svg3548" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="13.417mm" width="13.418mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 47.543997 47.542"><metadata id="metadata3553"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1004.8)"><ellipse id="circle4271" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="23.772" ry="23.771" cy="1028.6" cx="23.772" fill="#303030"/><ellipse id="circle4273" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="18.668" ry="18.667" stroke="#3b63c9" cy="1028.6" cx="23.772" fill="#5276cf"/></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="21.241671mm" height="8.8544388mm" viewBox="0 0 75.265762 31.373996" id="svg3447" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="l1.svg"><defs id="defs3449" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="1.4" inkscape:cx="-254.57869" inkscape:cy="228.81952" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3452"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(1.5000945e-8,-1020.9882)"><path style="fill:#5276cf;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.99999994px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1" d="m 11.026383,1051.1651 c -7.4440599,1.9144 -7.5133499,2.2466 -9.7963799,-4.4934 -1.81058997,-5.3452 -2.44278,-8.8152 4.01547,-12.116 2.74038,-1.4007 13.7365799,-5.877 38.4768299,-10.72 24.26031,-4.749 25.16653,-2.7967 26.79132,0.3418 1.15503,2.2311 1.8961,4.1561 2.94279,6.651 3.08552,8.5188 2.92609,8.5778 -6.08214,9.5501 -19.09891,2.1414 -37.95723,5.8307 -56.34789,10.7865 z" id="path4289" inkscape:connector-curvature="0" sodipodi:nodetypes="cssssccc" /></g></svg>',
'<svg id="svg3447" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="8.8544mm" width="21.242mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 75.265762 31.373996"><metadata id="metadata3452"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(1.5001e-8 -1021)"><path id="path4715" d="m64.239 1051.2c7.4441 1.9144 7.5134 2.2466 9.7964-4.4934 1.8106-5.3452 2.4428-8.8152-4.0155-12.116-2.7404-1.4007-13.737-5.877-38.477-10.72-24.26-4.749-25.167-2.7967-26.791 0.3418-1.155 2.2311-1.8961 4.1561-2.9428 6.651-3.0855 8.5188-2.9261 8.5778 6.0822 9.5501 19.099 2.1414 37.957 5.8307 56.348 10.786z" fill-rule="evenodd" fill="#5276cf"/></g></svg>',
'<svg id="svg3560" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="4.7796mm" width="13.57mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 48.082162 16.935645"><metadata id="metadata3565"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1035.4)"><path id="path4727" d="m42.857 1052.2c4.7071 0.4081 4.7981 0.6563 5.1414-4.9139 0.16344-2.6517 0.16699-6.1108-0.72615-8.0342-0.59471-1.2808-1.7793-2.049-3.7642-2.4662-2.5264-0.531-16.253-1.4345-26.685-1.3241-15.118 0.16-15.362 1.4769-15.855 4.1522-0.35071 1.9018-0.5016 3.5056-0.74837 5.5967-0.55261 7.0693-0.44908 7.0921 5.0452 6.5411 11.661-1.1062 25.929-0.7359 37.592 0.4484z" fill-rule="evenodd" fill="#5276cf"/></g></svg>',
'<svg id="svg3560" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="4.7796mm" width="13.57mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 48.082162 16.935645"><metadata id="metadata3565"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1035.4)"><path id="path4727" d="m42.857 1052.2c4.7071 0.4081 4.7981 0.6563 5.1414-4.9139 0.16344-2.6517 0.16699-6.1108-0.72615-8.0342-0.59471-1.2808-1.7793-2.049-3.7642-2.4662-2.5264-0.531-16.253-1.4345-26.685-1.3241-15.118 0.16-15.362 1.4769-15.855 4.1522-0.35071 1.9018-0.5016 3.5056-0.74837 5.5967-0.55261 7.0693-0.44908 7.0921 5.0452 6.5411 11.661-1.1062 25.929-0.7359 37.592 0.4484z" fill-rule="evenodd" fill="#5276cf"/></g></svg>',
'<svg id="svg3699" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.2811mm" width="9.2817mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 32.8879 32.88565"><metadata id="metadata3704"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" fill-rule="evenodd" transform="translate(0 -1019.5)"><ellipse id="ellipse4575" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="16.444" ry="16.443" cy="1035.9" cx="16.444" fill="#2e2e2e"/><ellipse id="ellipse4577" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="15.112" ry="15.11" stroke="#4364b2" cy="1035.9" cx="16.444" fill="#5276cf"/><ellipse id="ellipse4579" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="11.867" ry="11.866" cy="1035.9" cx="16.444" fill="#434343"/></g></svg>',
'<svg id="svg3699" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.2811mm" width="9.2817mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 32.8879 32.88565"><metadata id="metadata3704"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" fill-rule="evenodd" transform="translate(0 -1019.5)"><ellipse id="ellipse4575" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="16.444" ry="16.443" cy="1035.9" cx="16.444" fill="#2e2e2e"/><ellipse id="ellipse4577" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" stroke-linecap="round" rx="15.112" ry="15.11" stroke="#4364b2" cy="1035.9" cx="16.444" fill="#5276cf"/><ellipse id="ellipse4579" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="11.867" ry="11.866" cy="1035.9" cx="16.444" fill="#434343"/></g></svg>',
'<svg id="svg3461" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="22.608mm" width="22.61mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 80.114398 80.108405"><metadata id="metadata3466"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(.0000019915 -972.25)"><g id="g3514-7" fill-rule="evenodd" transform="translate(-987.45 356.91)"><ellipse id="ellipse3516-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="40.057" ry="40.054" cy="655.39" cx="1027.5" fill="#3b63c9"/><ellipse id="ellipse3518-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="36.23" ry="36.228" cy="655.39" cx="1027.5" fill="#5276cf"/></g></g></svg>',
'<svg id="svg3461" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="22.608mm" width="22.61mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 80.114398 80.108405"><metadata id="metadata3466"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(.0000019915 -972.25)"><g id="g3514-7" fill-rule="evenodd" transform="translate(-987.45 356.91)"><ellipse id="ellipse3516-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="40.057" ry="40.054" cy="655.39" cx="1027.5" fill="#3b63c9"/><ellipse id="ellipse3518-7" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" rx="36.23" ry="36.228" cy="655.39" cx="1027.5" fill="#5276cf"/></g></g></svg>',
'<svg id="svg3754" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.711mm" width="9.9653mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 35.3101 37.950677"><metadata id="metadata3759"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1014.4)"><path id="path4326" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m34.81 1017.1c-15.254-3.8172-24.634-1.7612-34.31 0v16.247h0.015c-0.013 0.097-0.013 0.1951-0.015 0.2928 0.0006 9.4753 7.6813 18.256 17.156 18.256 9.4739-0.0005 17.154-8.7813 17.154-18.256 0-0.097-0.014-0.1952-0.014-0.2928h0.014z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>',
'<svg id="svg3754" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.711mm" width="9.9653mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 35.3101 37.950677"><metadata id="metadata3759"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1014.4)"><path id="path4328" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m34.81 1049.7c-15.254 3.8172-24.634 1.7612-34.31 0v-16.247h0.015c-0.013-0.097-0.013-0.1951-0.015-0.2928 0.0006-9.4753 7.6813-18.256 17.156-18.256 9.4739 0.0005 17.154 8.7813 17.154 18.256 0 0.097-0.014 0.1952-0.014 0.2928h0.014z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>',
'<svg id="svg3790" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.9646mm" width="10.711mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 37.953175 35.3077"><metadata id="metadata3795"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1017.1)"><path id="path4324" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m2.6552 1051.9c-3.8175-15.253-1.7611-24.633 0-34.308h16.248v0.015c0.098-0.01 0.1952-0.01 0.2928-0.015 9.476 0.0006 18.258 7.6807 18.257 17.154-0.0005 9.4733-8.7818 17.153-18.257 17.153-0.098 0-0.1952-0.01-0.2928-0.011v0.011z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>',
'<svg id="svg3790" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.9646mm" width="10.711mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 37.953175 35.3077"><metadata id="metadata3795"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1017.1)"><path id="path4324" stroke-linejoin="round" style="color-rendering:auto;color:#000000;isolation:auto;mix-blend-mode:normal;shape-rendering:auto;solid-color:#000000;image-rendering:auto" d="m35.298 1017.6c3.8175 15.253 1.7611 24.633 0 34.308h-16.248v-0.015c-0.098 0.01-0.1952 0.01-0.2928 0.015-9.476-0.0006-18.258-7.6807-18.257-17.154 0.0005-9.4733 8.7818-17.153 18.257-17.153 0.098 0 0.1952 0.01 0.2928 0.011v-0.011z" fill-rule="evenodd" stroke="#4364b2" stroke-linecap="round" fill="#5276cf"/></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="24.603382mm" height="24.601696mm" viewBox="0 0 87.177338 87.171363" id="svg3640" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="main.svg"><defs id="defs3642" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="1.979899" inkscape:cx="61.113463" inkscape:cy="69.71796" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3645"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(0,-965.19093)"><ellipse ry="43.585682" rx="43.588669" style="color:#000000;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:#2e2e2e;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.99999994;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate" id="ellipse4372" cx="43.588669" cy="1008.7766" /><ellipse cy="1008.7766" cx="43.588669" id="circle4239-1" style="color:#000000;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:#5276cf;fill-opacity:1;fill-rule:evenodd;stroke:#4364b2;stroke-width:0.99999994;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate" rx="40.056705" ry="40.053959" /><ellipse style="color:#000000;clip-rule:nonzero;display:inline;overflow:visible;visibility:visible;opacity:1;isolation:auto;mix-blend-mode:normal;color-interpolation:sRGB;color-interpolation-filters:linearRGB;solid-color:#000000;solid-opacity:1;fill:#434343;fill-opacity:1;fill-rule:evenodd;stroke:none;stroke-width:0.99999994;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;color-rendering:auto;image-rendering:auto;shape-rendering:auto;text-rendering:auto;enable-background:accumulate" id="circle4243-0" cx="43.588669" cy="1008.7766" rx="31.455994" ry="31.453836" /></g></svg>');
C.push(u,u,v,v);W.push(G,H);for(a=0;a<S.length;a++)S[a].setAttribute("id","pad_btn_"+a),S[a].setAttribute("data-colorstate","B"),S[a].setAttribute("data-key",a),S[a].setAttribute("data-svgid",a);G.setAttribute("id","pad_left_axis");G.setAttribute("data-colorstate","GR");G.setAttribute("data-key",f.GMPD_AXIS_0);G.setAttribute("data-svgid",E.length);H.setAttribute("id","pad_right_axis");H.setAttribute("data-colorstate","GR");H.setAttribute("data-key",f.GMPD_AXIS_2);H.setAttribute("data-svgid",E.length+
1);E.push('<svg id="svg3407" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="41.787mm" width="41.786mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 148.0624 148.06251"><metadata id="metadata3412"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -904.3)" fill="#e6e6e6"><path id="rect4545" d="m74.031 904.3-14.469 22.156h8.0313v8.2187h12.875v-8.2187h8.0625l-14.5-22.156z"/><path id="rect4603" d="m125.94 963.86v8.0313h-8.25v12.906h8.25v8.0313l22.125-14.5-22.125-14.469z"/><path id="rect4609" d="m67.594 1022v8.25h-8.0313l14.469 22.125 14.5-22.125h-8.0625v-8.25h-12.875z"/><path id="rect4615" d="m22.156 963.86-22.156 14.47l22.156 14.5v-8.2188h8.2188v-12.906h-8.2188v-7.8438z"/><path id="path4619" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m54.393 924.58c-15.821 5.7885-28.404 18.385-34.188 34.219h11.156c4.6667-10.175 12.865-18.361 23.031-23.031v-11.188zm39.219 0.031v11.156c10.167 4.6713 18.361 12.86 23.031 23.031h11.156c-5.7846-15.821-18.379-28.393-34.188-34.188zm-73.375 73.438c5.7899 15.816 18.348 28.403 34.156 34.188v-11.156c-10.163-4.6691-18.364-12.861-23.031-23.031h-11.125zm96.406 0c-4.6712 10.167-12.868 18.361-23.031 23.031v11.125c15.796-5.7901 28.366-18.352 34.156-34.156h-11.125z"/></g></svg>',
'<svg id="svg3407" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="41.787mm" width="41.786mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 148.0624 148.06251"><metadata id="metadata3412"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -904.3)" fill="#e6e6e6"><path id="rect4545" d="m74.031 904.3-14.469 22.156h8.0313v8.2187h12.875v-8.2187h8.0625l-14.5-22.156z"/><path id="rect4603" d="m125.94 963.86v8.0313h-8.25v12.906h8.25v8.0313l22.125-14.5-22.125-14.469z"/><path id="rect4609" d="m67.594 1022v8.25h-8.0313l14.469 22.125 14.5-22.125h-8.0625v-8.25h-12.875z"/><path id="rect4615" d="m22.156 963.86-22.156 14.47l22.156 14.5v-8.2188h8.2188v-12.906h-8.2188v-7.8438z"/><path id="path4619" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m54.393 924.58c-15.821 5.7885-28.404 18.385-34.188 34.219h11.156c4.6667-10.175 12.865-18.361 23.031-23.031v-11.188zm39.219 0.031v11.156c10.167 4.6713 18.361 12.86 23.031 23.031h11.156c-5.7846-15.821-18.379-28.393-34.188-34.188zm-73.375 73.438c5.7899 15.816 18.348 28.403 34.156 34.188v-11.156c-10.163-4.6691-18.364-12.861-23.031-23.031h-11.125zm96.406 0c-4.6712 10.167-12.868 18.361-23.031 23.031v11.125c15.796-5.7901 28.366-18.352 34.156-34.156h-11.125z"/></g></svg>');
m(S,D);m(W,"#e6e6e6")}function n(a){return[l.create_gamepad_btn_sensor(f.GMPD_BUTTON_0,a),l.create_gamepad_btn_sensor(f.GMPD_BUTTON_1,a),l.create_gamepad_btn_sensor(f.GMPD_BUTTON_2,a),l.create_gamepad_btn_sensor(f.GMPD_BUTTON_3,a),l.create_gamepad_btn_sensor(f.GMPD_BUTTON_4,a),l.create_gamepad_btn_sensor(f.GMPD_BUTTON_5,a),l.create_gamepad_btn_sensor(f.GMPD_BUTTON_6,a),l.create_gamepad_btn_sensor(f.GMPD_BUTTON_7,a),l.create_gamepad_btn_sensor(f.GMPD_BUTTON_8,a),l.create_gamepad_btn_sensor(f.GMPD_BUTTON_9,
a),l.create_gamepad_btn_sensor(f.GMPD_BUTTON_10,a),l.create_gamepad_btn_sensor(f.GMPD_BUTTON_11,a),l.create_gamepad_btn_sensor(f.GMPD_BUTTON_12,a),l.create_gamepad_btn_sensor(f.GMPD_BUTTON_13,a),l.create_gamepad_btn_sensor(f.GMPD_BUTTON_14,a),l.create_gamepad_btn_sensor(f.GMPD_BUTTON_15,a),l.create_gamepad_btn_sensor(f.GMPD_BUTTON_16,a),l.create_gamepad_btn_sensor(f.GMPD_BUTTON_17,a),l.create_gamepad_btn_sensor(f.GMPD_BUTTON_18,a),l.create_gamepad_btn_sensor(f.GMPD_BUTTON_19,a),l.create_gamepad_btn_sensor(f.GMPD_BUTTON_20,
a),l.create_gamepad_btn_sensor(f.GMPD_BUTTON_21,a),l.create_gamepad_btn_sensor(f.GMPD_BUTTON_22,a),l.create_gamepad_btn_sensor(f.GMPD_BUTTON_23,a),l.create_gamepad_btn_sensor(f.GMPD_BUTTON_24,a),l.create_gamepad_btn_sensor(f.GMPD_BUTTON_25,a)]}function h(a){return[l.create_gamepad_axis_sensor(f.GMPD_AXIS_0,a),l.create_gamepad_axis_sensor(f.GMPD_AXIS_1,a),l.create_gamepad_axis_sensor(f.GMPD_AXIS_2,a),l.create_gamepad_axis_sensor(f.GMPD_AXIS_3,a),l.create_gamepad_axis_sensor(f.GMPD_AXIS_4,a),l.create_gamepad_axis_sensor(f.GMPD_AXIS_5,
a),l.create_gamepad_axis_sensor(f.GMPD_AXIS_6,a),l.create_gamepad_axis_sensor(f.GMPD_AXIS_7,a),l.create_gamepad_axis_sensor(f.GMPD_AXIS_8,a),l.create_gamepad_axis_sensor(f.GMPD_AXIS_9,a),l.create_gamepad_axis_sensor(f.GMPD_AXIS_10,a),l.create_gamepad_axis_sensor(f.GMPD_AXIS_11,a)]}function r(a,b){var c=document.createElement("input");c.style.cssText="display: inline-block;position = relative;";c.setAttribute("type","radio");c.setAttribute("name","choice");var d=document.createElement("label");d.textContent=
b;d.style.cssText="position = relative;display: inline-block;color: white;";a.appendChild(c);a.appendChild(d);return c}function g(a){x.removeChild(k);k=null;switch(a){case "PAD":u.checked=!0;b(x);break;case "WHEEL":M.checked=!0;var c=x;F=!1;var d=document.createElement("div"),e=document.createElement("div"),g=document.createElement("div"),h=document.createElement("div"),l=document.createElement("div"),n=document.createElement("div"),q=document.createElement("div"),p=document.createElement("div"),
r=document.createElement("div"),v=document.createElement("div"),t=document.createElement("div"),w=document.createElement("div"),z=document.createElement("div"),y=document.createElement("div"),A=document.createElement("div"),B=document.createElement("div"),G=document.createElement("div"),H=document.createElement("div"),K=document.createElement("div"),Aa=document.createElement("div"),qa=document.createElement("div"),J=document.createElement("div"),aa=document.createElement("div"),V=document.createElement("div");
a=document.createElement("div");var ca=document.createElement("div"),pa=document.createElement("div"),fa=document.createElement("div"),Ea=document.createElement("div"),ia=document.createElement("div");k=d;var na="position: absolute;height: auto;background-image: url('data:image/svg+xml;base64,"+btoa('<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>')+
"');width: 19px;height: 19px;background-size: 100% 100%;";d.style.cssText="position: absolute;background-image: url('data:image/svg+xml;base64,"+btoa('<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="112.08413mm" height="128.46834mm" viewBox="0 0 397.14849 455.20277" id="svg3440" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel.svg"><defs id="defs3442" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="0.98994949" inkscape:cx="421.01508" inkscape:cy="52.510802" inkscape:document-units="px" inkscape:current-layer="g87" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3445"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title /></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(-2.3645008e-8,-597.15942)"><path inkscape:connector-curvature="0" style="fill:#4d4d4d;stroke:#6e6e6e;stroke-width:2.99125171;stroke-miterlimit:4;stroke-dasharray:none" id="path4140" d="m 307.84153,715.52552 c -4.35995,43.11849 -2.78952,86.66385 -15.90234,128.54337 -10.85452,25.86023 -13.33477,47.2976 6.91492,61.09536 7.23778,50.7442 78.38013,47.39232 82.20535,0 23.06079,-14.19054 13.49405,-42.79138 6.91492,-61.09536 -17.40045,-40.83001 -4.82581,-86.43019 -15.90235,-128.54337 -8.3177,-20.33228 -56.75348,-20.7661 -64.22927,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#cccccc;stroke:#1a1a1a;stroke-width:2.09465766;stroke-miterlimit:4;stroke-dasharray:none" id="path4266" d="m 313.11812,724.1957 -3.84514,68.80568 c 4.64168,13.40814 62.19981,10.8172 61.83082,0 l -3.84515,-68.80568 c -4.46942,-24.00369 -52.58756,-18.95946 -54.13979,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#353535;stroke:#2c2c2c;stroke-width:2.11880326;stroke-miterlimit:4;stroke-dasharray:none" id="path4156" d="m 304.91419,870.673 c -12.36924,67.40381 80.42804,69.69607 70.55134,0 -6.57605,-36.5947 -65.0964,-34.8253 -70.55134,0 z m 60.53812,3.9862 c 8.65841,48.24354 -57.58987,49.86644 -50.52489,0 4.7009,-26.27069 46.6394,-24.84292 50.52489,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#e6e6e6;stroke:#969696;stroke-width:2.99125171;stroke-miterlimit:4;stroke-dasharray:none" id="path4011" d="m 106.04576,696.97906 c -11.197076,4.25792 -17.123706,8.24834 -17.123706,8.24834 l -66.18493,16.33946 1.40291,30.64619 46.54715,-7.67623 c 17.00932,-1.6438 32.551896,8.94676 38.302026,23.34506 l 2.78663,65.4778 27.6363,0 2.78663,-65.4778 c 8.0428,-15.3291 20.46247,-27.10803 38.30202,-23.34506 l 46.54716,7.67623 1.40291,-30.64619 -66.18493,-16.33946 c 0,0 -5.92627,-3.99074 -17.12371,-8.24834 -13.45408,-4.31874 -26.62772,-4.20804 -39.08982,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#252525;stroke:#6e6e6e;stroke-width:2.99125171;stroke-miterlimit:4;stroke-dasharray:none" id="path2996" d="m 38.311064,931.09899 c -8.01574,5.05649 -22.76006,21.74743 -26.34852,58.0567 -4.1290804,35.18581 -4.8394604,60.59901 28.55878,61.68771 l 162.934726,0 c 39.19437,1.1693 30.46155,-41.5992 28.55878,-61.68771 -3.58839,-36.30927 -18.33277,-52.99983 -26.34851,-58.0567 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#373737;stroke:#6e6e6e;stroke-width:2.83429575;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none" id="path3019" d="m 26.230254,979.1291 c -11.50334,14.44882 -11.98241,47.3999 -0.33519,57.1202 l 191.802226,0 c 12.10111,-12.3068 9.93082,-46.99573 -0.33518,-57.1202 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#808080;stroke:#1a1a1a;stroke-width:2.14882827;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0" id="path4133" d="m 360.82498,854.6914 a 20.634815,21.265151 0 1 1 -41.269,0 20.634815,21.265151 0 1 1 41.269,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#333333;stroke:#000000;stroke-width:2.11880326;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0" id="path4280" d="m 351.64051,761.132 a 11.444622,11.75148 0 1 1 -22.88896,0 11.444622,11.75148 0 1 1 22.88896,0 z" stroke-miterlimit="4" /><path inkscape:connector-curvature="0" style="fill:#313131;stroke:#565656;stroke-width:2.93434715;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0" id="path3993" d="m 125.52855,598.62659 c -68.528026,0 -124.0613764,57.81925 -124.0613764,129.13695 0,71.31265 55.5370404,129.13696 124.0613764,129.13696 68.52804,0 124.07984,-57.81926 124.07984,-129.13696 0,-71.31264 -55.55611,-129.13695 -124.07984,-129.13695 z m -1.00095,23.63932 c 10.01261,0.0734 20.238,1.32074 28.95237,3.51006 11.62203,3.80301 21.53624,8.52304 31.01135,16.15381 26.21752,19.0207 43.36275,50.36277 43.36275,85.83029 0,58.01564 -45.80548,105.05244 -102.30928,105.05244 -56.500726,0 -102.309276,-47.03364 -102.309276,-105.05244 0,-32.14848 14.06783,-60.91918 36.22336,-80.19121 11.45168,-11.11714 23.14136,-17.13322 37.3943,-21.79731 7.855846,-2.48302 17.655666,-3.5835 27.668276,-3.51006 z" stroke-miterlimit="4" /><g style="stroke-miterlimit:4;stroke-dasharray:none" id="g4127" stroke-miterlimit="4" transform="matrix(0.61498728,0,0,0.63147657,-18.171616,453.28593)"><g id="g4111"><path style="fill:#808080;stroke:#373737;stroke-width:3.56837296" inkscape:connector-curvature="0" id="rect3040" d="m 110.97,771.16 31.694,4.8776 1.3007,44.257 -32.995,0 z" /><path style="fill:#b3b3b3;stroke:#565656;stroke-width:3.4000001;stroke-linecap:butt;stroke-linejoin:miter" inkscape:connector-curvature="0" id="path3024" d="m 96.83,686.82 58.353,-5.0761 c 15.608,27.569 6.8304,64.333 -5.0761,90.545 l -53.841,-2.538 z" /></g><g id="g4115" transform="translate(97.984785,0)"><path style="fill:#808080;stroke:#373737;stroke-width:3.56837296" inkscape:connector-curvature="0" id="path4117" d="m 110.97,771.16 31.694,4.8776 1.3007,44.257 -32.995,0 z" /><path style="fill:#b3b3b3;stroke:#565656;stroke-width:3.4000001;stroke-linecap:butt;stroke-linejoin:miter" inkscape:connector-curvature="0" id="path4119" d="m 96.83,686.82 58.353,-5.0761 c 15.608,27.569 6.8304,64.333 -5.0761,90.545 l -53.841,-2.538 z" /></g><g id="g4121" transform="translate(195.96959,0)"><path style="fill:#808080;stroke:#373737;stroke-width:3.56837296" inkscape:connector-curvature="0" id="path4123" d="m 110.97,771.16 31.694,4.8776 1.3007,44.257 -32.995,0 z" /><path style="fill:#b3b3b3;stroke:#565656;stroke-width:3.4000001;stroke-linecap:butt;stroke-linejoin:miter" inkscape:connector-curvature="0" id="path4125" d="m 96.83,686.82 58.353,-5.0761 c 15.608,27.569 6.8304,64.333 -5.0761,90.545 l -53.841,-2.538 z" /></g></g><g style="fill:#666666;stroke:#969696;stroke-width:3.99777174;stroke-miterlimit:4;stroke-dasharray:none" id="g4051" transform="translate(-42.878584,98.083591)" stroke-miterlimit="4"><g id="g4437" transform="matrix(0.74686368,0,0,0.74686368,-73.374214,285.30447)"><path inkscape:connector-curvature="0" id="rect4348" style="color:#000000;text-indent:0;text-transform:none;block-progression:tb;fill:#ffffff" d="m 567.31,584.22 0,42.25 0,3.4062 0,42.25 3.375,0 0,-42.25 27.062,0 0,42.25 3.375,0 0,-42.25 27.062,0 0,42.25 3.375,0 0,-42.25 27.062,0 0,42.25 3.4062,0 0,-43.969 0,-1.6875 -1.7188,0 -28.75,0 0,-42.25 -3.375,0 0,42.25 -27.062,0 0,-42.25 -3.375,0 0,42.25 -27.062,0 0,-42.25 -3.375,0 z" /><g style="fill:#a02c2c;stroke:#ffffff;stroke-width:3.4000001;stroke-linecap:square" id="g87" /></g></g></g></svg>')+
"');width: 397px;height: 455px;-moz-transform: translateX(-50%);-ms-transform: translateX(-50%);-webkit-transform: translateX(-50%);transform: translateX(-50%);background-size: 100% 100%;left: 50%;margin-left: 25px;margin-bottom: 40px;bottom: 0px;";e.style.cssText=na+"top: 132px;left: 331px;";g.style.cssText=na+"top: 122px;left: 315px;";h.style.cssText=na+"top: 122px;left: 347px;";l.style.cssText=na+"top: 113px;left: 331px;";n.style.cssText="position: absolute;height: auto;background-image: url('data:image/svg+xml;base64,"+
btoa('<svg id="svg3400" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.507mm" width="15.1mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 53.504016 37.228838"><metadata id="metadata3405"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(-2.847e-7 -1015.1)"><path id="path4049" d="m26.584 1016.1c-12.631 0-23.15 9.858-25.478 22.922l50.705 12.18c0.47921-2.1565 0.73023-4.4099 0.73023-6.7204 0-15.677-11.621-28.382-25.957-28.382z" stroke="#5276cf" stroke-linecap="square" stroke-width="1.9247" fill="#666"/></g></svg>')+
"');width: 54px;height: 37px;background-size: 100% 100%;top: 84px;left: 166px;";q.style.cssText="position: absolute;height: auto;background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3400" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.507mm" width="15.1mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 53.504016 37.228838"><metadata id="metadata3405"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(-2.847e-7 -1015.1)"><path id="path4033" d="m26.92 1016.1c-14.337 0-25.957 12.707-25.957 28.382 0 2.3225 0.26742 4.5784 0.74876 6.7386l50.681-12.18c-2.321-13.072-12.841-22.944-25.476-22.944z" stroke="#5276cf" stroke-linecap="square" stroke-width="1.9247" fill="#666"/></g></svg>')+
"');width: 54px;height: 37px;background-size: 100% 100%;top: 84px;left: 36px;";p.style.cssText=na+"top: 107px;left: 141px;";r.style.cssText=na+"top: 107px;left: 90px;";v.style.cssText=na+"top: 185px;left: 321px;";t.style.cssText=na+"top: 185px;left: 340px;";w.style.cssText=na+"top: 179px;left: 358px;";z.style.cssText=na+"top: 178px;left: 303px;";y.style.cssText=na+"top: 210px;left: 299px;";A.style.cssText=na+"top: 279px;left: 299px;";B.style.cssText=na+"top: 210px;left: 321px;";G.style.cssText=na+
"top: 279px;left: 321px;";H.style.cssText=na+"top: 210px;left: 344px;";K.style.cssText=na+"top: 278px;left: 344px;";Aa.style.cssText=na+"top: 124px;left: 147px;";qa.style.cssText=na+"top: 138px;left: 133px;";J.style.cssText=na+"top: 124px;left: 82px;";aa.style.cssText=na+"top: 138px;left: 96px;";V.style.cssText=na+"top: 278px;left: 367px;";na="position: absolute;background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3386" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="12.859mm" width="5.2917mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 18.749999 45.562501"><metadata id="metadata3391"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1006.8)"><path id="rect4575" d="m9.3125 1006.8-9.3125 14.25h5.3125v17.094h-5.1875l9.3125 14.219 9.3125-14.219h-5.1562v-17.094h5.0312l-9.3125-14.25z" fill="#e6e6e6"/></g></svg>')+
"');width: 19px;height: 46px;background-size: 100% 100%;";a.style.cssText=na+"top: 291px;left: 50px;";ca.style.cssText=na+"top: 291px;left: 111px;";pa.style.cssText=na+"top: 291px;left: 171px;";fa.style.cssText="position: absolute;background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3458" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="50.447mm" width="83.899mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 297.28131 178.75"><metadata id="metadata3463"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -873.61)" fill="#e6e6e6"><path id="path4535" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m33.875 873.61-18.5 8.8125 5.0626 3.0625c-12.899 22.78-20.438 49.17-20.438 77.44 0 28.284 7.5315 54.691 20.438 77.469l-5.0626 3.0625 18.5 8.8125 0.6563-20.469-5.531 3.3c-12.002-21.2-18.937-45.8-18.937-72.18 0-26.362 6.9415-50.99 18.937-72.188l5.5313 3.3438-0.6563-20.469z"/><path id="path4551" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m263.38 873.71-0.6562 20.469 5.5312-3.3438c11.996 21.198 18.969 45.825 18.969 72.188 0 26.371-6.9672 51.011-18.969 72.219l-5.5312-3.3437 0.6562 20.469 18.5-8.8125-5.0312-3.0625c12.906-22.778 20.438-49.184 20.438-77.469 0-28.275-7.5391-54.665-20.438-77.438l5.0312-3.0625-18.5-8.8125z"/></g></svg>')+
"');width: 297px;height: 179px;background-size: 100% 100%;top: 43px;left: -25px;";Ea.style.cssText="position: absolute;background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3378" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="2.9016mm" width="9.2516mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 32.781198 10.281199"><metadata id="metadata3383"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1042.1)"><path id="rect4585" d="m32.781 1047.2-7.875-5.125v2.8437h-17.031v-2.8437l-7.875 5.1 7.875 5.1562v-2.8437h17.031v2.8437z" fill="#e6e6e6"/></g></svg>')+
"');width: 33px;height: 10px;background-size: 100% 100%;top: 159px;left: 324px;";ia.style.cssText="position: absolute;background-image: url('data:image/svg+xml;base64,"+btoa('<svg id="svg3378" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.2516mm" width="2.9016mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 10.281248 32.7812"><metadata id="metadata3383"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1019.6)"><path id="rect4585" d="m5.125 1019.6-5.125 7.9h2.8437v17.031h-2.8437l5.125 7.875 5.1562-7.875h-2.8438v-17.031h2.8438z" fill="#e6e6e6"/></g></svg>')+
"');width: 10px;height: 33px;background-size: 100% 100%;top: 148px;left: 335px;";c.appendChild(d);d.appendChild(a);d.appendChild(ca);d.appendChild(pa);d.appendChild(fa);d.appendChild(Ea);d.appendChild(ia);d.appendChild(e);d.appendChild(g);d.appendChild(h);d.appendChild(l);d.appendChild(n);d.appendChild(q);d.appendChild(p);d.appendChild(r);d.appendChild(v);d.appendChild(t);d.appendChild(w);d.appendChild(z);d.appendChild(y);d.appendChild(A);d.appendChild(B);d.appendChild(G);d.appendChild(H);d.appendChild(K);
d.appendChild(Aa);d.appendChild(qa);d.appendChild(J);d.appendChild(aa);d.appendChild(V);S.length=0;E.length=0;C.length=0;W.length=0;S.push(e,g,h,l,n,q,p,r,v,t,w,z,y,A,B,G,H,K,Aa,qa,J,aa,V);E.push('<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg id="svg3400" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.507mm" width="15.1mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 53.504016 37.228838"><metadata id="metadata3405"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(-2.847e-7 -1015.1)"><path id="path4049" d="m26.584 1016.1c-12.631 0-23.15 9.858-25.478 22.922l50.705 12.18c0.47921-2.1565 0.73023-4.4099 0.73023-6.7204 0-15.677-11.621-28.382-25.957-28.382z" stroke="#5276cf" stroke-linecap="square" stroke-width="1.9247" fill="#666"/></g></svg>',
'<svg id="svg3400" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="10.507mm" width="15.1mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 53.504016 37.228838"><metadata id="metadata3405"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(-2.847e-7 -1015.1)"><path id="path4033" d="m26.92 1016.1c-14.337 0-25.957 12.707-25.957 28.382 0 2.3225 0.26742 4.5784 0.74876 6.7386l50.681-12.18c-2.321-13.072-12.841-22.944-25.476-22.944z" stroke="#5276cf" stroke-linecap="square" stroke-width="1.9247" fill="#666"/></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>',
'<svg xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" width="5.4777083mm" height="5.5003009mm" viewBox="0 0 19.409203 19.489255" id="svg3402" version="1.1" inkscape:version="0.91 r13725" sodipodi:docname="wheel_btn.svg"><defs id="defs3404" /><sodipodi:namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="22.4" inkscape:cx="4.7324003" inkscape:cy="15.245372" inkscape:document-units="px" inkscape:current-layer="layer1" showgrid="false" fit-margin-top="0" fit-margin-left="0" fit-margin-right="0" fit-margin-bottom="0" inkscape:window-width="1920" inkscape:window-height="1134" inkscape:window-x="0" inkscape:window-y="27" inkscape:window-maximized="1" /><metadata id="metadata3407"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage" /><dc:title></dc:title></cc:Work></rdf:RDF></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(8.5754969e-8,-1032.873)"><path inkscape:connector-curvature="0" style="fill:#5276cf;stroke:#000000;stroke-width:3.4000001;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;fill-opacity:1" id="path4272" d="m 17.709101,1042.6176 a 8.0046,8.0046 0 1 1 -16.0089998,0 8.0046,8.0046 0 1 1 16.0089998,0 z" stroke-miterlimit="4" /></g></svg>');
W.push(fa,a,pa,ca,Ea,ia);for(c=0;c<S.length;c++)S[c].setAttribute("id","wheel_btn_"+c),S[c].setAttribute("data-colorstate","B"),S[c].setAttribute("data-key",c),S[c].setAttribute("data-svgid",c);for(c=0;c<W.length;c++)S[c].setAttribute("id","wheel_axis_"+c),S[c].setAttribute("data-colorstate","GR");fa.setAttribute("data-key",f.GMPD_AXIS_0);fa.setAttribute("data-svgid",E.length);a.setAttribute("data-key",f.GMPD_AXIS_1);a.setAttribute("data-svgid",E.length+1);pa.setAttribute("data-key",f.GMPD_AXIS_2);
pa.setAttribute("data-svgid",E.length+2);ca.setAttribute("data-key",f.GMPD_AXIS_3);ca.setAttribute("data-svgid",E.length+3);Ea.setAttribute("data-key",f.GMPD_AXIS_4);Ea.setAttribute("data-svgid",E.length+4);ia.setAttribute("data-key",f.GMPD_AXIS_5);ia.setAttribute("data-svgid",E.length+5);E.push('<svg id="svg3458" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="50.447mm" width="83.899mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 297.28131 178.75"><metadata id="metadata3463"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -873.61)" fill="#e6e6e6"><path id="path4535" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m33.875 873.61-18.5 8.8125 5.0626 3.0625c-12.899 22.78-20.438 49.17-20.438 77.44 0 28.284 7.5315 54.691 20.438 77.469l-5.0626 3.0625 18.5 8.8125 0.6563-20.469-5.531 3.3c-12.002-21.2-18.937-45.8-18.937-72.18 0-26.362 6.9415-50.99 18.937-72.188l5.5313 3.3438-0.6563-20.469z"/><path id="path4551" style="color:#000000;text-indent:0;block-progression:tb;text-decoration-line:none;text-transform:none" d="m263.38 873.71-0.6562 20.469 5.5312-3.3438c11.996 21.198 18.969 45.825 18.969 72.188 0 26.371-6.9672 51.011-18.969 72.219l-5.5312-3.3437 0.6562 20.469 18.5-8.8125-5.0312-3.0625c12.906-22.778 20.438-49.184 20.438-77.469 0-28.275-7.5391-54.665-20.438-77.438l5.0312-3.0625-18.5-8.8125z"/></g></svg>',
'<svg id="svg3386" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="12.859mm" width="5.2917mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 18.749999 45.562501"><metadata id="metadata3391"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1006.8)"><path id="rect4575" d="m9.3125 1006.8-9.3125 14.25h5.3125v17.094h-5.1875l9.3125 14.219 9.3125-14.219h-5.1562v-17.094h5.0312l-9.3125-14.25z" fill="#e6e6e6"/></g></svg>',
'<svg id="svg3386" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="12.859mm" width="5.2917mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 18.749999 45.562501"><metadata id="metadata3391"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1006.8)"><path id="rect4575" d="m9.3125 1006.8-9.3125 14.25h5.3125v17.094h-5.1875l9.3125 14.219 9.3125-14.219h-5.1562v-17.094h5.0312l-9.3125-14.25z" fill="#e6e6e6"/></g></svg>',
'<svg id="svg3386" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="12.859mm" width="5.2917mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 18.749999 45.562501"><metadata id="metadata3391"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1006.8)"><path id="rect4575" d="m9.3125 1006.8-9.3125 14.25h5.3125v17.094h-5.1875l9.3125 14.219 9.3125-14.219h-5.1562v-17.094h5.0312l-9.3125-14.25z" fill="#e6e6e6"/></g></svg>',
'<svg id="svg3378" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="2.9016mm" width="9.2516mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 32.781198 10.281199"><metadata id="metadata3383"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1042.1)"><path id="rect4585" d="m32.781 1047.2-7.875-5.125v2.8437h-17.031v-2.8437l-7.875 5.1 7.875 5.1562v-2.8437h17.031v2.8437z" fill="#e6e6e6"/></g></svg>',
'<svg id="svg3378" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="9.2516mm" width="2.9016mm" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 10.281248 32.7812"><metadata id="metadata3383"><rdf:RDF><cc:Work rdf:about=""><dc:format>image/svg+xml</dc:format><dc:type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><dc:title/></cc:Work></rdf:RDF></metadata><g id="layer1" transform="translate(0 -1019.6)"><path id="rect4585" d="m5.125 1019.6-5.125 7.9h2.8437v17.031h-2.8437l5.125 7.875 5.1562-7.875h-2.8438v-17.031h2.8438z" fill="#e6e6e6"/></g></svg>');
m(S,D);m(W,"#e6e6e6")}}function m(a,b){function c(a){a=a.target;if(!(0>y||"G"==a.dataset.Nj))if(0!=G){if("R"==a.dataset.Nj&&(A=null,document.getElementById("action_label").textContent="Click on the buttons & arrows to setup your controller",G=0),"B"==a.dataset.Nj||"GR"==a.dataset.Nj){var d=parseFloat(A.dataset.us);A.style.backgroundImage="url('data:image/svg+xml;base64,"+btoa(E[d])+"')";A.setAttribute("data-colorstate",a.dataset.Nj);A=a;d=parseFloat(a.dataset.us);a.style.backgroundImage="url('data:image/svg+xml;base64,"+
btoa(E[d].replace(b,"#ff0000"))+"')";a.setAttribute("data-colorstate","R")}}else{var d=parseFloat(a.dataset.us),e="B"==a.dataset.Nj?1:2;G=e;a.style.backgroundImage="url('data:image/svg+xml;base64,"+btoa(E[d].replace(b,"#ff0000"))+"')";a.setAttribute("data-colorstate","R");document.getElementById("action_label").textContent=1==e?"Now press the button on the device":"Now move the axis on the device";A=a}}for(var d=0;d<a.length;d++)a[d].addEventListener("click",c,!1)}function q(a){var b=document.createElement("label");
b.style.cssText="position: relative;display: inline-block;width: 50px;color: white;margin: 0 10px;font-size: 36px;line-height: 50px;background-color: black;border: 3px solid white;border-radius: 5px;height: 50px;";b.textContent=a;return b}function B(){var a=window.innerWidth,b=window.innerHeight;x.style.zoom=750>=b&&400<b||750>=a&&400<a?"0.5":400>=a||400>=b?"0.3":"1"}p("config");var d=p("container"),l=p("controls"),f=p("input"),H=p("storage"),D=/#5276cf/g,w={};w[f.GMPD_BUTTON_12]=f.GMPD_BUTTON_12;
w[f.GMPD_BUTTON_13]=f.GMPD_BUTTON_13;w[f.GMPD_BUTTON_15]=f.GMPD_BUTTON_15;w[f.GMPD_BUTTON_14]=f.GMPD_BUTTON_14;w[f.GMPD_BUTTON_3]=f.GMPD_BUTTON_3;w[f.GMPD_BUTTON_0]=f.GMPD_BUTTON_0;w[f.GMPD_BUTTON_1]=f.GMPD_BUTTON_1;w[f.GMPD_BUTTON_2]=f.GMPD_BUTTON_2;w[f.GMPD_BUTTON_5]=f.GMPD_BUTTON_5;w[f.GMPD_BUTTON_7]=f.GMPD_BUTTON_7;w[f.GMPD_BUTTON_4]=f.GMPD_BUTTON_4;w[f.GMPD_BUTTON_6]=f.GMPD_BUTTON_6;w[f.GMPD_BUTTON_8]=f.GMPD_BUTTON_8;w[f.GMPD_BUTTON_9]=f.GMPD_BUTTON_9;w[f.GMPD_BUTTON_10]=f.GMPD_BUTTON_10;w[f.GMPD_BUTTON_11]=
f.GMPD_BUTTON_11;w[f.GMPD_BUTTON_16]=f.GMPD_BUTTON_16;var E=[],y=-1,A=null,G=0,x=null,k=null,t=null,M=null,u=null,v=null,z=[],S=[],C=[],W=[],F=!0,K={};K[f.GMPD_AXIS_0]=-2;K[f.GMPD_AXIS_1]=-2;K[f.GMPD_AXIS_2]=-2;K[f.GMPD_AXIS_3]=-2;K[f.GMPD_AXIS_4]=-2;K[f.GMPD_AXIS_5]=-2;K[f.GMPD_AXIS_6]=-2;K[f.GMPD_AXIS_7]=-2;K[f.GMPD_AXIS_8]=-2;K[f.GMPD_AXIS_9]=-2;K[f.GMPD_AXIS_10]=-2;K[f.GMPD_AXIS_11]=-2;K[f.tP]=-2;a.show=function(){var a=document.createElement("div");x=a;a.style.cssText="position: absolute;width: 720px;height: 750px;top: 50%;left: 50%;-moz-transform: translateY(-50%) translateX(-50%);-ms-transform: translateY(-50%) translateX(-50%);-webkit-transform: translateY(-50%) translateX(-50%);transform: translateY(-50%) translateX(-50%);background-color: black;border: 4px solid white;border-radius: 35px;box-shadow: 0px 0px 20px 0px rgba(50, 50, 50, 1);";
d.insert_to_container(a,"LAST");b(a);var k=document.createElement("div");k.style.cssText="position: absolute;width: 637px;top: 0px;font-family: sans-serif;text-align: center;margin-top: 40px;-moz-transform: translateX(-50%);-ms-transform: translateX(-50%);-webkit-transform: translateX(-50%);transform: translateX(-50%);left: 50%;";var m=document.createElement("div");m.innerHTML="Select a device";m.style.cssText="color: #fff;display: inline-block;";k.appendChild(m);for(m=0;4>m;m++){var p=n(m),w=function(){return!0},
z=function(a,b){if(b==y)for(var c=0;c<S.length;c++){var d=S[c],e=l.get_sensor_value(a,b,c),g=c;if(0==G){if(e&&"B"==d.dataset.Nj){var h=E[g];d.style.backgroundImage="url('data:image/svg+xml;base64,"+btoa(h.replace(D,"#00ff00"))+"')";d.setAttribute("data-colorstate","G")}e||"B"==d.dataset.Nj||(h=E[g],d.style.backgroundImage="url('data:image/svg+xml;base64,"+btoa(h)+"')",d.setAttribute("data-colorstate","B"))}else e=f.get_pressed_gmpd_btn(y),0<=e&&A&&1==G&&(d=A.dataset.key,f.set_gamepad_key(y,d,e),g=
H.get(y+"_gmpd_stngs","b4w")||"{}",g=JSON.parse(g),g[d]=e,H.set(y+"_gmpd_stngs",JSON.stringify(g),"b4w"),A=null,document.getElementById("action_label").textContent="Click on the buttons & arrows to setup your controller",G=0)}};l.create_sensor_manifold(null,m,l.CT_CONTINUOUS,p,w,z)}0<e().length&&(y=0);var ga=[],m=document.createElement("div");m.style.cssText="margin-top: 20px;";for(p=0;4>p;p++)z=q(p),p==y&&(z.style.backgroundColor="green",t=z),c(p),m.appendChild(z),z.setAttribute("data-device_type",
"PAD"),ga.push(z),z.addEventListener("click",function(a){var b=e();a=a.target;for(var d=0;d<b.length;d++)ga[d]==a&&(y=d,t=a,c(y),g(a.dataset.gQ))},!1);k.appendChild(m);v=document.createElement("label");v.style.cssText="position: relative;display: block;color: white;";k.appendChild(v);m=document.createElement("div");m.style.cssText="margin-top: 20px;";p=r(m,"Pad");z=r(m,"Wheel");p.setAttribute("checked","true");p.onchange=function(){g("PAD");t&&t.setAttribute("data-device_type","PAD")};z.onchange=
function(){g("WHEEL");t&&t.setAttribute("data-device_type","WHEEL")};p.setAttribute("id","test");u=p;M=z;p=document.createElement("label");p.style.cssText+="color: #fff;display: block;";m.appendChild(p);p.textContent="Click on the buttons & arrows to setup your controller";p.setAttribute("id","action_label");k.appendChild(m);a.appendChild(k);a=l.create_elapsed_sensor();l.create_sensor_manifold(null,"UPDATE_GAMEPAD_DATA",l.CT_CONTINUOUS,[a],w,function(){var a=e(),b=a.length;-1==y&&a.length&&(y=a[0].index,
t=ga[y]);for(var c=0;c<ga.length;c++)c<b?(ga[c].textContent=a[c].index,ga[c]==t?(ga[c].style.backgroundColor="green",v.textContent="Selected device: "+a[c].index+". Data: "+a[c].id):ga[c].style.backgroundColor="blue"):ga[c].style.backgroundColor="black";b||(y=-1,v.textContent="")});for(m=0;4>m;m++)p=h(m),w=function(){return!0},z=function(a,b){if(b=="AXES"+y){for(var c=0;c<C.length;c+=2){var d=C[c],e=a,g=b,h=c,k=20*l.get_sensor_value(e,g,h),e=20*l.get_sensor_value(e,g,h+1);d.style.transform="translate3d("+
k+"px, "+e+"px, 0px) rotate(0rad)"}if(F)for(c=0;12>c;c+=2){if(e=a,g=b,d=c,!(d+1>2*W.length)){k=l.get_sensor_value(e,g,d);e=l.get_sensor_value(e,g,d+1);if(-2<K[d]){var m=k-K[d],n=e-K[d+1],g=W[Math.floor(d/2)],h=g.dataset.us;0==G?g.style.backgroundImage=m||n?"url('data:image/svg+xml;base64,"+btoa(E[h].replace("#e6e6e6","#00ff00"))+"')":"url('data:image/svg+xml;base64,"+btoa(E[h])+"')":2==G&&(m=f.get_moved_gmpd_axis(y),0<=m&&(0!=m%2&&m--,G=0,g.style.backgroundImage="url('data:image/svg+xml;base64,"+
btoa(E[h])+"')",g=parseFloat(A.dataset.key),f.set_gamepad_key(y,g,m),f.set_gamepad_key(y,g+1,m+1),A=null,document.getElementById("action_label").textContent="Click on the buttons & arrows to setup your controller"))}K[d]=k;K[d+1]=e}}else for(c=0;12>c;c++)d=c,d>=W.length||(k=l.get_sensor_value(a,b,d),-2<K[d]&&(h=k-K[d],e=W[d],g=e.dataset.us,0==G?e.style.backgroundImage=h?"url('data:image/svg+xml;base64,"+btoa(E[g].replace("#e6e6e6","#00ff00"))+"')":"url('data:image/svg+xml;base64,"+btoa(E[g])+"')":
2==G&&(h=f.get_moved_gmpd_axis(y),0<=h&&(G=0,e.style.backgroundImage="url('data:image/svg+xml;base64,"+btoa(E[g])+"')",f.set_gamepad_key(y,parseFloat(A.dataset.key),h),A=null,document.getElementById("action_label").textContent="Click on the buttons & arrows to setup your controller"))),K[d]=k)}},l.create_sensor_manifold(null,"AXES"+m,l.CT_CONTINUOUS,p,w,z);B();window.addEventListener("resize",B)};a.hide=function(){G=0;y=-1;u=M=A=t=null;C.length=0;S.length=0;W.length=0;d.get_container().removeChild(x);
x=null;l.remove_sensor_manifold(null,"UPDATE_GAMEPAD_DATA");for(var a=0;4>a;a++)l.remove_sensor_manifold(null,a),l.remove_sensor_manifold(null,"AXES"+a);window.removeEventListener("resize",B)};a.update=function(){for(var a=0;4>a;a++)c(a)}};b4w.module.gyroscope=function(a,p){function e(a){var e=b.create_gyro_angles_sensor(),n=b.create_gyro_quat_sensor(),p=!0;b.create_sensor_manifold(a,"CAMERA_ROTATE_GYRO",b.CT_CONTINUOUS,[e,n],null,function(a,e,n){if(0<n)if(c.is_eye_camera(a))e=b.get_sensor_payload(a,e,1),n=g.transformQuat(r.AXIS_Z,e,B),c.set_vertical_axis(a,n),h.set_rotation_v(a,e);else{q=b.get_sensor_payload(a,e,0);p&&(m[0]=q[0],m[1]=q[1],m[2]=q[2],p=!1);n=e=0;0==window.orientation&&(e=q[1]-m[1],n=q[0]-m[0],q[1]>l&&q[1]<d&&(n=0));
if(180==window.orientation){e=q[1]-m[1];0>q[1]&&(e=-e);n=m[0]-q[0];if(e>Math.PI/2||e<-Math.PI/2)e=0;q[1]>-d&&q[1]<-l&&(n=0)}if(-90==window.orientation){e=q[0]-m[0];if(e>Math.PI/2||e<-Math.PI/2)e=0;n=m[1]-q[1];if(q[0]>f||q[0]<H)n=0}if(90==window.orientation){e=m[0]-q[0];if(e>Math.PI/2||e<-Math.PI/2)e=0;n=q[1]-m[1];if(q[0]>f||q[0]<H)n=0}c.rotate_camera(a,n,e);m[0]=q[0];m[1]=q[1];m[2]=q[2]}})}var c=p("camera"),b=p("controls"),n=p("scenes"),h=p("transform"),r=p("util"),g=p("vec3"),m=new Float32Array(3),
q=new Float32Array(3),B=g.create(),d=r.deg_to_rad(110),l=r.deg_to_rad(70),f=r.deg_to_rad(70),H=-r.deg_to_rad(70);a.enable_camera_rotation=function(){var a=n.get_active_camera();e(a)};a.disable_camera_rotation=function(){var a=n.get_active_camera();b.remove_sensor_manifold(a,"CAMERA_ROTATE_GYRO")}};b4w.module.hmd_conf=function(a,p){function e(a){a=a.target.value;var b=k[a],c;for(c in G)if(c in b){var d=document.getElementById(c+"_slider");d&&(d.disabled="custom"!==a,d.value=b[c]);if(d=document.getElementById(c+"_number"))d.disabled="custom"!==a,d.value=b[c]}}function c(){B.remove_sensor_manifold(null,"UPDATE_HMD_RENDERING");n();r();D&&(D=!1,q.get_container().removeChild(w),document.head.removeChild(E),E=y=w=null)}function b(){n(!0);r();for(var a in G){var b=document.getElementById(a+"_slider");
b&&(b.value=G[a]);if(b=document.getElementById(a+"_number"))b.value=G[a]}}function n(a){var b=navigator.userAgent||navigator.vendor||window.opera,c=Math.max(window.screen.width,window.screen.height)*window.devicePixelRatio,d=Math.min(window.screen.width,window.screen.height)*window.devicePixelRatio,e=0,g=0,h=0;a:{var k=M;if(1==k.format&&k.devices&&k.devices.length)for(var m=0;m<k.devices.length;m++){var n=k.devices[m];if(n.rules&&("ios"==n.type&&x||"android"==n.type)){for(var p=!1,q=0;q<n.rules.length;q++){var r=
n.rules[q],t=c,w=d;if(r.ua&&0<=b.indexOf(r.ua)||!r.ua&&r.res&&r.res[0]&&r.res[1]&&Math.min(t,w)==Math.min(r.res[0],r.res[1])&&Math.max(t,w)==Math.max(r.res[0],r.res[1])){p=!0;break}}if(p){b=m;break a}}}else l.error("DPDB isn't correct.");b=-1}-1!=b&&(h=M.devices[b],g=h.dpi[1]||h.dpi,e=Math.round(25.4*c/(h.dpi[0]||h.dpi)),g=Math.round(25.4*d/g),h=Math.round(h.bw));c=f.get("hmd_conf","b4w");c=JSON.parse(c?c:"{}");a?(G.first_distortion=.34,G.second_distortion=.55,G.bevel_size=h||4,G.screen_width=e||
110,G.screen_height=g||65,G.screen_lense=50,G.ipd=64,G.baseline=32):(G.first_distortion="first_distortion"in c?parseFloat(c.first_distortion):.34,G.second_distortion="second_distortion"in c?parseFloat(c.second_distortion):.55,G.bevel_size="bevel_size"in c?parseFloat(c.bevel_size):h||4,G.screen_width="screen_width"in c?parseFloat(c.screen_width):e||110,G.screen_height="screen_height"in c?parseFloat(c.screen_height):g||65,G.screen_lense="screen_lense"in c?parseFloat(c.screen_lense):50,G.ipd="ipd"in
c?parseFloat(c.ipd):64,G.baseline="baseline"in c?parseFloat(c.baseline):32);A=!0}function h(){f.set("hmd_conf",JSON.stringify(G),"b4w");c()}function r(){if(A){var a=d.get_device_by_type_element(d.DEVICE_HMD);a&&(d.set_config(a,d.HMD_DISTORTION,[G.first_distortion,G.second_distortion]),d.get_value_param(a,d.HMD_WEBVR_TYPE)!=d.HMD_WEBVR_DESKTOP&&(d.set_config(a,d.HMD_BEVEL_SIZE,.001*G.bevel_size),d.set_config(a,d.HMD_SCREEN_WIDTH,.001*G.screen_width),d.set_config(a,d.HMD_SCREEN_HEIGHT,.001*G.screen_height),
d.set_config(a,d.HMD_SCREEN_LENSE_DIST,.001*G.screen_lense),d.set_config(a,d.HMD_EYE_DISTANCE,.001*G.ipd),d.set_config(a,d.HMD_BASELINE_DIST,.001*G.baseline)));A=!1}}function g(a){var b=a.target.id.split("_"),b=b.splice(0,b.length-1).join("_");b in G&&G[b]!=a.target.value&&(A=!0,G[b]=a.target.value,document.getElementById(b+"_slider").value=a.target.value,document.getElementById(b+"_number").value=a.target.value)}function m(a,b){var c=document.createElement("button");c.onclick=a;c.style.cssText="display: inline-block;";
c.innerHTML=b;return c}p("config");var q=p("container"),B=p("controls"),d=p("input"),l=p("print");p("scenes");var f=p("storage"),H=p("util"),D=!1,w=null,E=null,y=null,A=!0,G={profile:"custom",first_distortion:0,second_distortion:0,bevel_size:0,screen_width:0,screen_height:0,screen_lense:0,ipd:0,baseline:0},x=/iPad|iPhone|iPod/.test(navigator.platform),k={oculus_dk2:{name:"Oculus Rift DK2",type:2,first_distortion:.22,second_distortion:.28},cardboard_1:{name:"Cardboard (2014)",type:1,ipd:60,baseline:35,
screen_lense:42,first_distortion:.441,second_distortion:.156},cardboard_2:{name:"Cardboard (2015)",type:1,ipd:64,baseline:35,screen_lense:39,first_distortion:.34,second_distortion:.55},custom:{name:"Custom",type:0,ipd:64,baseline:35,screen_lense:39,first_distortion:0,second_distortion:0}},t=[{label:"Tray to lens-center distance.",Ml:!0,H:[{id:"baseline",max:"50",step:"0.5"}]},{label:"Interpupillary distance.",Ml:!0,H:[{id:"ipd",max:"100",step:"1"}]},{label:"Screen to lense distance.",Ml:!0,H:[{id:"screen_lense",
max:"100",step:"1"}]},{label:"Screen height.",Ml:!0,H:[{id:"screen_height",max:"150",step:"1"}]},{label:"Screen width.",Ml:!0,H:[{id:"screen_width",max:"200",step:"1"}]},{label:"Bevel width.",Ml:!0,H:[{id:"bevel_size",max:"20",step:"1"}]},{label:"Distortion coefficients.",H:[{id:"first_distortion",max:"1.0",step:"0.01"},{id:"second_distortion",max:"1.0",step:"0.01"}]}];a.check=function(){return d.can_use_device(d.DEVICE_HMD)};a.show=function(a){E=document.createElement("style");E.innerHTML="html{-webkit-tap-highlight-color:rgba(0,0,0,0);}input[type=range]:focus{outline:0}input[type=range]::-webkit-slider-runnable-track{width:100%;height:8.4px;cursor:pointer;box-shadow:0 0 10px 0 rgba(50,50,50,1);background:#000;border-radius:1.3px;border:.2px solid #010101}input[type=range]::-webkit-slider-thumb{box-shadow:0 0 10px 0 rgba(50,50,50,1);border:1px solid #000;height:36px;width:16px;border-radius:3px;background:#fff;cursor:pointer;-webkit-appearance:none;margin-top:-14px}input[type=range]:focus::-webkit-slider-runnable-track{background:#000}input[type=range]::-moz-range-track{width:100%;height:8.4px;cursor:pointer;box-shadow:0 0 10px 0 rgba(50,50,50,1);background:#000;border-radius:1.3px;border:.2px solid #010101}input[type=range]::-moz-range-thumb{box-shadow:0 0 10px 0 rgba(50,50,50,1);border:1px solid #000;height:36px;width:16px;border-radius:3px;background:#fff;cursor:pointer}input[type=range]::-ms-track{width:100%;height:8.4px;cursor:pointer;background:0 0;border-color:transparent;color:transparent}input[type=range]::-ms-fill-lower{background:#000;border:.2px solid #010101;border-radius:2.6px;box-shadow:0 0 10px 0 rgba(50,50,50,1)}input[type=range]::-ms-fill-upper{background:#000;border:.2px solid #010101;border-radius:2.6px;box-shadow:0 0 10px 0 rgba(50,50,50,1)}input[type=range]::-ms-thumb{box-shadow:0 0 10px 0 rgba(50,50,50,1);border:1px solid #000;height:36px;width:16px;border-radius:3px;background:#fff;cursor:pointer}.text_label,.value_label{display:inline-block;text-decoration:none;height:30px;line-height:28px;position:relative;text-align:center;font-family:Arial;font-size:15px}input[type=range]:focus::-ms-fill-lower{background:#000}input[type=range]:focus::-ms-fill-upper{background:#000}.text_label{float:left;color:#fff;width:auto;padding:0 10px;background-color:#000;border:3px solid #fff;border-radius:15px;box-shadow:0 0 10px 0 rgba(50,50,50,1);margin-right:15px}.input_text,.value_label{border:3px solid #fff;background-color:#000;color:#fff;box-shadow:0 0 10px 0 rgba(50,50,50,1)}.value_label{right:0;width:40px;border-radius:15px;margin-left:15px}.slider{position:relative;cursor:pointer}.border{position:relative;width:100%;height:50px}.input_slider,.input_text{margin:13.8px 0;-webkit-appearance:none;width:50%;position:relative;display:inline-block}.input_text{border-radius:4px;padding-left:4px}.input_slider,_:-moz-tree-row(hover){-webkit-appearance:none;width:50%;margin:-4.8px 0;position:relative;display:inline-block}:root .input_slider,_:-ms-fullscreen{-webkit-appearance:none;width:50%;margin:-2.8px 0;position:relative;display:inline-block}button,select{display:block}button{background-color:#000;color:#fff;width:100px;border:3px solid #fff;text-align:center;font-family:Arial;border-radius:15px;box-shadow:0 0 10px 0 rgba(50,50,50,1);font-size:15px;line-height:30px;margin-right:10px}select{clear:both}";
document.head.appendChild(E);var l=d.get_device_by_type_element(d.DEVICE_HMD);if(!D&&l){D=!0;n();var p=q.get_container(),x=d.get_device_by_type_element(d.DEVICE_MOUSE,p);d.switch_prevent_default(x,!1);x=d.get_device_by_type_element(d.DEVICE_TOUCH,p);d.switch_prevent_default(x,!1);w=document.createElement("div");w.TP=a;p.appendChild(w);y=document.createElement("div");w.appendChild(y);y.style.cssText="position: absolute;background-color: #fff;left: 10px;top: 10px;right: 10px;bottom: 10px;bottom: 10px;min-width: 300px;overflow: auto;padding: 10px;border: 1px solid #ddd;border-radius: 4px;bottom: 10px;";
a=f.get("hmd_conf","b4w");a=JSON.parse(a?a:"{}").profile||"custom";p=document.createElement("div");x=document.createElement("label");x.innerHTML="Profile: ";x.className="text_label";p.appendChild(x);x=document.createElement("select");p.appendChild(x);p.style.cssText="margin: 20px 0;padding: 10px;";var C=d.get_device_by_type_element(d.DEVICE_HMD);if(C)for(var A in k)if(0==k[A].type||d.get_value_param(C,d.HMD_WEBVR_TYPE)==d.HMD_WEBVR_DESKTOP^1==k[A].type){var F=document.createElement("option");F.value=
A;F.text=k[A].name;x.appendChild(F)}x.value=a;H.is_ie11()?x.onchange=e:x.oninput=e;y.appendChild(p);for(A=0;A<t.length;A++)if(d.get_value_param(l,d.HMD_WEBVR_TYPE)!=d.HMD_WEBVR_DESKTOP||!t[A].Ml){a=t[A];p=document.createElement("div");x=document.createElement("label");x.className="text_label";x.textContent=a.label;p.appendChild(x);p.style.cssText="margin: 20px 0;float: left;display: inline-block;width: 50%;border: 1px solid #ddd;box-sizing: border-box;-webkit-box-sizing: border-box;padding: 10px;";
for(x=0;x<a.H.length;x++){C=a.H[x];F=document.createElement("div");F.style.cssText+="clear: both; margin-bottom: 10px;";var K=document.createElement("input");K.className="input_slider";K.setAttribute("id",C.id+"_slider");K.setAttribute("type","range");K.setAttribute("min","0.00");K.setAttribute("step",C.step);K.setAttribute("value",G[C.id]);K.setAttribute("max",C.max);K.style.cssText="float: left;";F.appendChild(K);var M=document.createElement("input");M.className="input_text";M.setAttribute("id",
C.id+"_number");M.setAttribute("type","number");M.setAttribute("min","0.00");M.setAttribute("step",C.step);M.setAttribute("value",G[C.id]);M.setAttribute("max",C.max);F.appendChild(M);H.is_ie11()?(K.onchange=g,M.onchange=g):(K.oninput=g,M.oninput=g);p.appendChild(F)}y.appendChild(p)}l=document.createElement("div");A=m(h,"SAVE");a=m(c,"CANCEL");p=m(b,"RESET");l.style.clear="both";l.appendChild(A);l.appendChild(a);l.appendChild(p);y.appendChild(l);l=B.create_timeline_sensor();B.create_sensor_manifold(null,
"UPDATE_HMD_RENDERING",B.CT_CONTINUOUS,[l],null,r)}};a.hide=c;a.reset=b;a.update=function(){n();r()};var M={_comment:"AUTOMATICALLY GENERATED BY generate_dpdb.py. DO NOT EDIT.",format:1,last_updated:"2016-01-26T23:11:18Z",devices:[{type:"android",rules:[{mdmh:"asus/*/Nexus 7/*"},{ua:"Nexus 7"}],dpi:[320.8,323],bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_Z00AD/*"},{ua:"ASUS_Z00AD"}],dpi:[403,404.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"HTC/*/HTC6435LVW/*"},{ua:"HTC6435LVW"}],dpi:[449.7,
443.3],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"HTC/*/HTC One XL/*"},{ua:"HTC One XL"}],dpi:[315.3,314.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"htc/*/Nexus 9/*"},{ua:"Nexus 9"}],dpi:289,bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One M9/*"},{ua:"HTC One M9"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One_M8/*"},{ua:"HTC One_M8"}],dpi:[449.7,447.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One/*"},{ua:"HTC One"}],dpi:472.8,bw:3,ac:1E3},{type:"android",
rules:[{mdmh:"Huawei/*/Nexus 6P/*"},{ua:"Nexus 6P"}],dpi:[515.1,518],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5X/*"},{ua:"Nexus 5X"}],dpi:[422,419.9],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"LGE/*/LGMS345/*"},{ua:"LGMS345"}],dpi:[221.7,219.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D800/*"},{ua:"LG-D800"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D850/*"},{ua:"LG-D850"}],dpi:[537.9,541.9],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/VS985 4G/*"},
{ua:"VS985 4G"}],dpi:[537.9,535.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5/*"},{ua:"Nexus 5 B"}],dpi:[442.4,444.8],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 4/*"},{ua:"Nexus 4"}],dpi:[319.8,318.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"LGE/*/LG-P769/*"},{ua:"LG-P769"}],dpi:[240.6,247.5],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"LGE/*/LGMS323/*"},{ua:"LGMS323"}],dpi:[206.6,204.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"LGE/*/LGLS996/*"},{ua:"LGLS996"}],dpi:[403.4,
401.5],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Micromax/*/4560MMX/*"},{ua:"4560MMX"}],dpi:[240,219.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Micromax/*/A250/*"},{ua:"Micromax A250"}],dpi:[480,446.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Micromax/*/Micromax AQ4501/*"},{ua:"Micromax AQ4501"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/DROID RAZR/*"},{ua:"DROID RAZR"}],dpi:[368.1,256.7],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"motorola/*/XT830C/*"},{ua:"XT830C"}],dpi:[254,
255.9],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"motorola/*/XT1021/*"},{ua:"XT1021"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1023/*"},{ua:"XT1023"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1028/*"},{ua:"XT1028"}],dpi:[326.6,327.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"motorola/*/XT1034/*"},{ua:"XT1034"}],dpi:[326.6,328.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1053/*"},{ua:"XT1053"}],dpi:[315.3,316.1],bw:3,ac:1E3},
{type:"android",rules:[{mdmh:"motorola/*/XT1562/*"},{ua:"XT1562"}],dpi:[403.4,402.7],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"motorola/*/Nexus 6/*"},{ua:"Nexus 6 B"}],dpi:[494.3,489.7],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"motorola/*/XT1063/*"},{ua:"XT1063"}],dpi:[295,296.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"motorola/*/XT1064/*"},{ua:"XT1064"}],dpi:[295,295.6],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1092/*"},{ua:"XT1092"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",
rules:[{mdmh:"motorola/*/XT1095/*"},{ua:"XT1095"}],dpi:[422,423.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"OnePlus/*/A0001/*"},{ua:"A0001"}],dpi:[403.4,401],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1005/*"},{ua:"ONE E1005"}],dpi:[442.4,441.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2005/*"},{ua:"ONE A2005"}],dpi:[391.9,405.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"OPPO/*/X909/*"},{ua:"X909"}],dpi:[442.4,444.1],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9082/*"},
{ua:"GT-I9082"}],dpi:[184.7,185.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G360P/*"},{ua:"SM-G360P"}],dpi:[196.7,205.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/Nexus S/*"},{ua:"Nexus S"}],dpi:[234.5,229.8],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[304.8,303.9],bw:5,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-T230NU/*"},{ua:"SM-T230NU"}],dpi:216,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SGH-T399/*"},{ua:"SGH-T399"}],
dpi:[217.7,231.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-N9005/*"},{ua:"SM-N9005"}],dpi:[386.4,387],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SM-N900A/*"},{ua:"SAMSUNG-SM-N900A"}],dpi:[386.4,387.7],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9500/*"},{ua:"GT-I9500"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/GT-I9505/*"},{ua:"GT-I9505"}],dpi:439.4,bw:4,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900F/*"},{ua:"SM-G900F"}],
dpi:[415.6,431.6],bw:5,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900M/*"},{ua:"SM-G900M"}],dpi:[415.6,431.6],bw:5,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G800F/*"},{ua:"SM-G800F"}],dpi:326.8,bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G906S/*"},{ua:"SM-G906S"}],dpi:[562.7,572.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[306.7,304.8],bw:5,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-T535/*"},{ua:"SM-T535"}],dpi:[142.6,
136.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-N920C/*"},{ua:"SM-N920C"}],dpi:[515.1,518.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300I/*"},{ua:"GT-I9300I"}],dpi:[304.8,305.8],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9195/*"},{ua:"GT-I9195"}],dpi:[249.4,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SPH-L520/*"},{ua:"SPH-L520"}],dpi:[249.4,255.9],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SGH-I717/*"},{ua:"SAMSUNG-SGH-I717"}],
dpi:285.8,bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SPH-D710/*"},{ua:"SPH-D710"}],dpi:[217.7,204.2],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/GT-N7100/*"},{ua:"GT-N7100"}],dpi:265.1,bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SCH-I605/*"},{ua:"SCH-I605"}],dpi:265.1,bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/Galaxy Nexus/*"},{ua:"Galaxy Nexus"}],dpi:[315.3,314.2],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910H/*"},{ua:"SM-N910H"}],dpi:[515.1,518],
bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910C/*"},{ua:"SM-N910C"}],dpi:[515.2,520.2],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G130M/*"},{ua:"SM-G130M"}],dpi:[165.9,164.8],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G928I/*"},{ua:"SM-G928I"}],dpi:[515.1,518.4],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"samsung/*/SM-G920F/*"},{ua:"SM-G920F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G920P/*"},{ua:"SM-G920P"}],dpi:[522.5,577],bw:3,ac:1E3},
{type:"android",rules:[{mdmh:"samsung/*/SM-G925F/*"},{ua:"SM-G925F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G925V/*"},{ua:"SM-G925V"}],dpi:[522.5,576.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Sony/*/C6903/*"},{ua:"C6903"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"Sony/*/D6653/*"},{ua:"D6653"}],dpi:[428.6,427.6],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Sony/*/E6653/*"},{ua:"E6653"}],dpi:[428.6,425.7],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Sony/*/E6853/*"},
{ua:"E6853"}],dpi:[403.4,401.9],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"Sony/*/SGP321/*"},{ua:"SGP321"}],dpi:[224.7,224.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"TCT/*/ALCATEL ONE TOUCH Fierce/*"},{ua:"ALCATEL ONE TOUCH Fierce"}],dpi:[240,247.5],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"THL/*/thl 5000/*"},{ua:"thl 5000"}],dpi:[480,443.3],bw:3,ac:1E3},{type:"android",rules:[{mdmh:"ZTE/*/ZTE Blade L2/*"},{ua:"ZTE Blade L2"}],dpi:240,bw:3,ac:500},{type:"ios",rules:[{res:[640,960]}],dpi:[325.1,
328.4],bw:4,ac:1E3},{type:"ios",rules:[{res:[640,1136]}],dpi:[317.1,320.2],bw:3,ac:1E3},{type:"ios",rules:[{res:[750,1334]}],dpi:326.4,bw:4,ac:1E3},{type:"ios",rules:[{res:[1242,2208]}],dpi:[453.6,458.4],bw:4,ac:1E3},{type:"ios",rules:[{res:[1125,2001]}],dpi:[410.9,415.4],bw:4,ac:1E3}]}};b4w.module.hmd=function(a,p){function e(a,e){if(e){var p=r.get_active_camera();if(p){c.is_eye_camera(p)||(l=c.is_target_camera(p),f=c.is_hover_camera(p),H=c.is_static_camera(p),c.eye_setup(p));var p=b.create_elapsed_sensor(),M=!1;b.create_sensor_manifold(null,"HMD_ROTATE_CAMERA",b.CT_CONTINUOUS,[p,e],null,function(e,f,k){if(0<k&&(k=r.get_active_camera())&&(!M&&n.enable_split_screen(k)&&(B=g.get_rotation(k,B),M=!0),M&&c.is_eye_camera(k)&&(e=b.get_sensor_payload(e,f,1))))if(1==a){var l=q.transformQuat(m.AXIS_Z,
e,D);c.set_vertical_axis(k,l);g.set_rotation_v(k,e)}else if(2==a||3==a){f=g.get_rotation(k,A);f=h.invert(f,A);var p=h.multiply(B,f,A);f=c.get_vertical_axis(k,D);Math.abs(f[2])<Math.PI/4?l=q.cross(f,m.AXIS_Z,w):Math.abs(f[1])<Math.PI/4&&(l=q.cross(f,m.AXIS_Y,w));q.normalize(l,l);var p=q.transformQuat(l,p,E),t=q.dot(f,p),p=q.scaleAndAdd(p,f,-t,E);q.normalize(p,p);f=q.cross(f,l,D);l=Math.acos(m.clamp(q.dot(l,p),0,1));f=m.sign(q.dot(p,f));d+=l*f;l=h.setAxisAngle(m.AXIS_Y,-d,A);3!=a&&(f=m.quat_project(e,
m.AXIS_MY,m.AXIS_Y,m.AXIS_MZ,G),f=h.invert(f,G),e=h.multiply(f,e,G));e=h.multiply(l,e,y);l=q.transformQuat(m.AXIS_Z,e,D);c.set_vertical_axis(k,l);g.set_rotation_v(k,e);h.copy(e,B)}})}}}var c=p("camera"),b=p("controls"),n=p("input"),h=p("quat"),r=p("scenes"),g=p("transform"),m=p("util"),q=p("vec3"),B=h.create(),d=0,l=!1,f=!1,H=!1,D=q.create(),w=q.create(),E=q.create(),y=h.create(),A=h.create(),G=h.create();a.HMD_NONE_MOUSE_ALL_AXES=0;a.HMD_ALL_AXES_MOUSE_NONE=1;a.HMD_ROLL_PITCH_MOUSE_YAW=2;a.HMD_ALL_AXES_MOUSE_YAW=
3;a.enable_hmd=function(a){var c=null;if(c=n.get_device_by_type_element(n.DEVICE_HMD))c=n.get_value_param(c,n.HMD_WEBVR_TYPE)==n.HMD_WEBVR_DESKTOP||n.get_value_param(c,n.HMD_WEBVR_TYPE)==n.HMD_WEBVR1?b.create_hmd_quat_sensor():b.create_gyro_quat_sensor(),e(a,c)};a.check_browser_support=function(){return Boolean(n.can_use_device(n.DEVICE_HMD))};a.get_hmd_device=function(){return null};a.reset=function(){n.reset_device(n.DEVICE_HMD)};a.disable_hmd=function(){b.remove_sensor_manifold(null,"HMD_ROTATE_CAMERA");
n.disable_split_screen();var a=r.get_active_camera();l?c.target_setup(a):f?c.hover_setup(a):H&&c.static_setup(a);c.set_vertical_axis(a,m.AXIS_Y);var d=g.get_rotation(a,y);g.set_rotation_v(a,d)}};b4w.module.mixer=function(a,p){function e(){E=w.length=0;y=c();A=new Float32Array(y.length);G=new Float32Array(y.length);var a=f.get_speaker_objects();if(a.length){w.push(b());for(var d=0;d<a.length;d++)w.push(h(a[d]));w.sort(function(a,b){return"MASTER"==a.id?-1:"MASTER"==b.id?1:"COMPRESSOR"==a.id?-1:"COMPRESSOR"==b.id?1:a.id.toUpperCase()<b.id.toUpperCase()?-1:a.id.toUpperCase()>b.id.toUpperCase()?1:0})}}function c(){for(var a=new Float32Array(100),b=0,c=0;100>c;c++)a[c]=20*Math.pow(1E3,b),b+=1/
99;return a}function b(){var a=n("MASTER"),b=f.get_compressor_params();b&&(a.V.push(["THRESHOLD",b.threshold,-100,0,100,!1]),a.V.push(["KNEE",b.knee,0,40,40,!1]),a.V.push(["RATIO",b.ratio,1,20,20,!1]),a.V.push(["ATTACK",b.attack,0,1,1E3,!1]),a.V.push(["RELEASE",b.release,0,1,1E3,!1]));a.V.push(["VOLUME",f.get_volume(null),0,1,50,!1]);a.mute=f.is_muted(null)?1:0;a.Bf=-1;return a}function n(a){return{id:a,V:[],wj:0,mute:-1,Bf:-1,zb:null}}function h(a){var b=n(l.get_object_name(a));b.mute=f.is_muted(a)?
1:0;b.Bf=0;b.zb=a;return b}function r(a){if(a.zb){a.V.length=0;var b=f.get_positional_params(a.zb);b&&(a.V.push(["DIST_REF",b.dist_ref,0,1E3,1E4,!1]),a.V.push(["ATTENUATION",b.attenuation,0,50,1E3,!1]),a.V.push(["DIST_MAX",b.dist_max,0,1E4,1E4,!1]));if(b=f.get_filter_params(a.zb))a.V.push(["EQ_FREQ",b.freq,20,2E4,100,!0]),a.V.push(["EQ_Q",b.Q,0,10,100,!1]),a.V.push(["EQ_GAIN",b.gain,-70,30,100,!1]);a.V.push(["VOLUME",f.get_volume(a.zb),0,1,50,!1]);H.clamp(a.wj,0,a.V.length-1)}}function g(a){for(var b=
0;b<w.length;b++){var c=w[b];if(c!=a&&1==c.Bf)return!0}return!1}function m(a){for(var b=0;b<w.length;b++){var c=w[b];c!=a&&0==c.mute&&0==c.Bf&&f.mute(c.zb,!1)}}function q(){if(0==w.length)return[0,-1];var a=8*Math.floor(E/8),b=a+7,a=H.clamp(a,0,w.length-1),b=H.clamp(b,0,w.length-1);return[a,b]}var B=p("controls"),d=p("hud"),l=p("scenes"),f=p("sfx"),H=p("util"),D="SWITCH_STRIP SWITCH_STRIP_HOLD SWITCH_PARAM INC_DEC INC_DEC_HOLD MUTE_SOLO".split(" "),w=[],E=0,y=null,A=null,G=null;a.enable_mixer_controls=
function(){function a(b,c,d){if(1==d){var e=Boolean(B.get_sensor_value(b,c,0))?-1:1,g=w[E];if(g)switch(d=g.V[g.wj],d[1]=d[5]?d[1]*Math.pow(d[3]/d[2],e/d[4]):d[1]+(d[3]-d[2])/d[4]*e,d[1]=H.clamp(d[1],d[2],d[3]),d[0]){case "VOLUME":"MASTER"!=g.id?f.set_volume(g.zb,d[1]):f.set_volume(null,d[1]);break;case "DIST_REF":e=f.get_positional_params(g.zb);e.dist_ref=d[1];f.set_positional_params(g.zb,e);break;case "ATTENUATION":e=f.get_positional_params(g.zb);e.attenuation=d[1];f.set_positional_params(g.zb,e);
break;case "DIST_MAX":e=f.get_positional_params(g.zb);e.dist_max=d[1];f.set_positional_params(g.zb,e);break;case "EQ_FREQ":e=f.get_filter_params(g.zb);e.freq=d[1];f.set_filter_params(g.zb,e);break;case "EQ_Q":e=f.get_filter_params(g.zb);e.Q=d[1];f.set_filter_params(g.zb,e);break;case "EQ_GAIN":e=f.get_filter_params(g.zb);e.gain=d[1];f.set_filter_params(g.zb,e);break;case "THRESHOLD":g=f.get_compressor_params();g.threshold=d[1];f.set_compressor_params(g);break;case "KNEE":g=f.get_compressor_params();
g.knee=d[1];f.set_compressor_params(g);break;case "RATIO":g=f.get_compressor_params();g.ratio=d[1];f.set_compressor_params(g);break;case "ATTACK":g=f.get_compressor_params();g.attack=d[1];f.set_compressor_params(g);break;case "RELEASE":g=f.get_compressor_params();g.release=d[1];f.set_compressor_params(g);break;default:H.q("Unknown strip param")}"INC_DEC"==c?B.reset_timer_sensor(b,c,2,.35):B.reset_timer_sensor(b,c,2,.05)}else B.reset_timer_sensor(b,c,2,10)}function b(a,c,d){if(1==d){d=Boolean(B.get_sensor_value(a,
c,0))?-1:1;if(w.length){1==d&&E<w.length-1?E++:-1==d&&0<E&&E--;d=q();for(var e=d[0];e<=d[1];e++)r(w[e])}"SWITCH_STRIP"==c?B.reset_timer_sensor(a,c,2,.15+.3):B.reset_timer_sensor(a,c,2,.15)}else B.reset_timer_sensor(a,c,2,10)}e();var c=B.create_keyboard_sensor(B.KEY_NUM4),h=B.create_keyboard_sensor(B.KEY_NUM6),l=B.create_keyboard_sensor(B.KEY_NUM8),n=B.create_keyboard_sensor(B.KEY_NUM2),p=B.create_keyboard_sensor(B.KEY_ADD),D=B.create_keyboard_sensor(B.KEY_SUB),C=B.create_keyboard_sensor(B.KEY_NUM7),
W=B.create_keyboard_sensor(B.KEY_NUM9),F=B.create_timer_sensor(.15,!0),K=B.create_timer_sensor(.05,!0),c=[c,h,F];B.create_sensor_manifold(null,"SWITCH_STRIP",B.CT_TRIGGER,c,function(a){return a[0]||a[1]},b);B.create_sensor_manifold(null,"SWITCH_STRIP_HOLD",B.CT_SHOT,c,function(a){return(a[0]||a[1])&&a[2]},b);B.create_sensor_manifold(null,"SWITCH_PARAM",B.CT_SHOT,[l,n],function(a){return a[0]||a[1]},function(a,b){var c=Boolean(B.get_sensor_value(a,b,0))?-1:1,d=w[E];d&&(1==c&&d.wj<d.V.length-1?d.wj++:
-1==c&&0<d.wj&&d.wj--)});l=[D,p,K];B.create_sensor_manifold(null,"INC_DEC",B.CT_TRIGGER,l,function(a){return a[0]||a[1]},a);B.create_sensor_manifold(null,"INC_DEC_HOLD",B.CT_SHOT,l,function(a){return(a[0]||a[1])&&a[2]},a);B.create_sensor_manifold(null,"MUTE_SOLO",B.CT_SHOT,[C,W],function(a){return a[0]||a[1]},function(a,b){if(Boolean(B.get_sensor_value(a,b,0))){var c=w[E];c&&0<=c.mute&&("MASTER"!=c.id?0==c.mute?(c.mute=1,f.mute(c.zb,!0),1==c.Bf&&(c.Bf=0,g(c)||m(c))):(c.mute=0,g(c)||f.mute(c.zb,!1)):
0==c.mute?(c.mute=1,f.mute(null,!0)):(c.mute=0,f.mute(null,!1)))}else if((c=w[E])&&0<=c.Bf)if(0==c.Bf){c.Bf=1;f.mute(c.zb,!1);1==c.mute&&(c.mute=0);for(var d=0;d<w.length;d++){var e=w[d];e!=c&&0==e.mute&&0==e.Bf&&f.mute(e.zb,!0)}}else c.Bf=0,g(c)?f.mute(c.zb,!0):m(c)});C=B.create_elapsed_sensor();B.create_sensor_manifold(null,"MIXER_DRAW",B.CT_CONTINUOUS,[C],null,function(){if(w[E])for(var a=q(),b=a[0];b<=a[1];b++){var c=w[b];d.draw_mixer_strip(c.id,b==E,b%8,c.V,c.wj,c.mute,c.Bf);if(c.zb&&f.get_filter_params(c.zb)){f.get_filter_freq_response(c.zb,
y,A,G);for(c=0;c<A.length;c++)A[c]=20*Math.log(A[c])/Math.LN10;d.plot_array("EQ",b%8,A,20,2E4,-10,10)}}});C=B.create_timer_sensor(1,!0);B.create_sensor_manifold(null,"MIXER_UPDATE",B.CT_TRIGGER,[C],null,function(){for(var a=q(),b=a[0];b<=a[1];b++)r(w[b])})};a.disable_mixer_controls=function(){for(var a=0;D.length;a++)B.remove_sensor_manifold(null,D[a])}};b4w.module.npc_ai=function(a,p){function e(a,b){var c=b.destination,d=w;l.get_translation(b.empty,d);var e=E;l.get_translation(b.collider,e);var h=0;b.Sm?h=b.Sm:b.Wh&&(h=b.Wh,b.type==t&&(h*=.5),b.type==u&&(h*=a));switch(b.type){case t:if(b.random&&b.Wi){c[0]=(12*Math.random()-6)*b.speed+d[0];c[2]=(12*Math.random()-6)*b.speed+d[2];var m=x,d=y,n=b.speed,p=b.rot_speed;l.get_rotation(b.collider,m);H.transformQuat(f.AXIS_Z,m,d);d[1]=0;H.normalize(d,d);m=.5*n/Math.sin(p/2);n=H.dist(c,e);n<2*m&&H.scaleAndAdd(c,
d,2*m-n,c);b.Wi=!1}c[1]=e[1];h&&(c[1]+=h);break;case M:case u:b.random&&b.Wi&&(b.type==u?(b.speed=Math.random()+.1,m=b.aL-b.gL):m=b.max_height-b.min_height,c[0]=10*Math.random()-5+d[0],c[1]=e[1]+(Math.random()*m-.5*m),c[2]=10*Math.random()-5+d[2],b.Wi=!1),h&&(c[1]=e[1]+h)}var c=w,d=E,n=y,e=k,B=b.rig,m=b.collider,h=b.destination,D=b.speed,da=b.actions,U=g.get_current_anim_name(B);if(!g.is_play(B)||!da.oo||-1==da.oo.indexOf(U)){l.get_translation(m,c);var p=h[0]-c[0],ga=h[2]-c[2],p=Math.sqrt(p*p+ga*
ga);if(p>2*D*a)b.state=20,f.xz_direction(h,c,n),da=b.rig,g.is_animated(da)&&(B=b.speed,D=g.get_frame(da),da=g.get_anim_length(da),B*=da/24*(1-D/da),.9>p/B&&H.scaleAndAdd(h,n,B-p,h)),p=x,B=A,l.get_rotation(b.collider,p),H.transformQuat(f.AXIS_Z,p,d),B[0]=d[0],B[1]=0,B[2]=d[2],H.normalize(B,B),D=H.dot(B,n),da=a/(Math.abs(Math.acos(D))/Math.PI)*b.rot_speed*b.gw,q.rotationTo(B,n,e),q.rotationTo(f.AXIS_Z,B,p),1<=Math.abs(D)?q.copy(p,e):(q.multiply(e,p,e),q.slerp(p,e,Math.min(da,1),e)),n=a,b.type!=M&&(n=
Math.max(n,1/60),p=G,B=x,q.setAxisAngle(f.AXIS_X,-Math.asin(d[1]),B),q.setAxisAngle(f.AXIS_X,-Math.atan(b.Wh/(b.speed*n)),p),q.slerp(B,p,n,p),q.multiply(e,p,e)),l.set_rotation_v(m,e),d=y,m=A,f.quat_to_dir(e,f.AXIS_Z,d),H.scale(d,b.speed*a,m),H.add(m,c,m),m[1]=b.type!=t?(h[1]-c[1])*a*.1+c[1]:h[1],l.set_translation_v(b.collider,m);else if(b.type==t)da.move?U&&-1!=da.move.indexOf(U)&&g.is_play(B)?b.state=20:(b.state=10,b.Wi=!0):(b.state=10,b.Wi=!0);else if(b.type==u||b.type==M)b.Wi=!0;if(r(b)&&(c=b.rig,
!g.is_play(c))){e=null;switch(b.state){case 10:e=b.actions;e=e.oo?f.random_from_array(e.oo):null;break;case 20:e=g.get_current_anim_name(b.rig),d=h=b.actions,d.zh&&-1==d.zh.indexOf(e)&&d.move&&-1!=d.move.indexOf(e)&&.33<Math.random()?(h=b.actions,e=h.zh[h.move.indexOf(e)]):(d=b.actions,d.move&&(-1!=d.move.indexOf(e)||!d.zh&&!d.Fi||!d.Fi&&!e||d.zh&&-1!=d.zh.indexOf(e)||d.Fi&&-1!=d.Fi.indexOf(e))?(h=b.actions,h.zh?(d=h.zh.indexOf(e),-1!=d?(e=d+1,e=e<h.move.length?e:0,e=h.move[e]):e=-1!=h.move.indexOf(e)?
e:f.random_from_array(h.move)):e=f.random_from_array(h.move)):(d=b.actions,e=d.Fi&&-1==d.Fi.indexOf(e)&&d.move&&-1==d.move.indexOf(e)?f.random_from_array(h.Fi):null))}e&&(g.apply(c,e),g.set_behavior(c,g.AB_FINISH_RESET),g.set_frame(c,0),g.play(c))}}}function c(a,b,c,d){if(d)if(1==c)switch(d.type){case M:a:{for(c=0;3>c;c++){var e=m.get_sensor_payload(a,b,c).hit_fract;if(e){b=e;break a}}b=void 0}a=100*b;d.Wh=a<d.min_height?10:a>d.max_height?-10:0;break;case t:a=m.get_sensor_payload(a,b,0).hit_fract;
d.Wh=d.pB==a?0:1-100*a;d.pB=a;break;case u:a=m.get_sensor_payload(a,b,0).hit_fract,"CLOSE_GROUND"==b?(d.Wh=100*a-1,d.Wh=.1>d.Wh?.05:0):"CLOSE_WATER"==b&&(d.Sm=100*a,d.Sm=d.Sm<d.gL?-.02:d.Sm>d.aL?.02:0)}else d.Wh=0}function b(){for(var a=0;a<D.length;a++){var b=D[a];n(b);h(b);b.rig&&g.get_current_anim_name(b.rig)&&g.play(b.rig)}}function n(a){var b=H.create(),d=a.collider;switch(a.type){case M:var e=m.create_ray_sensor(d,b,[0,-100,0],"TERRAIN",!0),f=m.create_ray_sensor(d,b,[0,-100,0],"STONE",!0),b=
m.create_ray_sensor(d,b,[0,-100,0],"WATER",!0),e=[e,f,b];m.create_sensor_manifold(d,"CLOSE_GROUND",m.CT_CONTINUOUS,e,function(a){return a[0]||a[1]||a[2]},c,a);break;case t:e=m.create_ray_sensor(d,[0,1,0],[0,-99,0],"TERRAIN",!0);e=[e];m.create_sensor_manifold(d,"CLOSE_GROUND",m.CT_CONTINUOUS,e,null,c,a);break;case u:e=m.create_ray_sensor(d,[0,1,0],[0,-99,0],"TERRAIN",!0),b=m.create_ray_sensor(d,b,[0,100,0],"WATER",!0),e=[e],m.create_sensor_manifold(d,"CLOSE_WATER",m.CT_CONTINUOUS,[b],null,c,a),m.create_sensor_manifold(d,
"CLOSE_GROUND",m.CT_CONTINUOUS,e,null,c,a)}}function h(a){function b(c,d,e){1==e?(l.get_translation(a.empty,a.destination),a.gw=4):a.gw=1}var c=a.collider;if(a.type==t){var d=m.create_collision_sensor(c,"CONSTRUCTION",!1);m.create_sensor_manifold(c,"CONSTRUCTION_COLL",m.CT_CONTINUOUS,[d],null,b)}}function r(a){var b=a.rig;if(!g.is_play(b))return!0;b=g.get_current_anim_name(b);if(!b)return!0;var c=a.actions;switch(a.state){case 10:if(!c.oo)return!1;if(-1==c.oo.indexOf(b))break;break;case 20:if(!c.move||
-1!=c.move.indexOf(b)||c.Fi&&-1!=c.Fi.indexOf(b)||c.zh&&-1!=c.zh.indexOf(b))return!1;break;default:return!1}return!0}var g=p("animation"),m=p("controls"),q=p("quat"),B=p("scenes"),d=p("time"),l=p("transform"),f=p("util"),H=p("vec3"),D=[];new Float32Array(9);var w=new Float32Array(3),E=new Float32Array(3),y=new Float32Array(3),A=new Float32Array(3),G=new Float32Array(4),x=new Float32Array(4),k=new Float32Array(4),t=a.NT_WALKING=10,M=a.NT_FLYING=20,u=a.NT_SWIMMING=30;a.new_event_track=function(a){a.destination=
new Float32Array(3);a.start=[];a.ended=[];a.Fq=[];a.Wh=null;a.pB=null;a.Sm=null;a.Wi=!0;a.gw=1;if(!a.random)for(var b=0;b<a.path.length;b++)a.start[b]=-1,a.ended[b]=!1,a.Fq[b]=!1;D.push(a)};a.enable_animation=function(){if(D.length){b();var a=m.create_elapsed_sensor();m.create_sensor_manifold(D[0].collider,"ELAPSED",m.CT_CONTINUOUS,[a],function(a){return a[0]},function(a,b,c){if(1==c)for(a=m.get_sensor_value(a,b,0),b=0;b<D.length;b++){c=D[b];var f=a;if(B.is_visible(c.obj))if(c.random)e(f,c);else{for(var g=
d.get_timeline(),h=0;h<c.path.length;h++)if(!c.ended[h]){c.Fq[h]||(c.Fq[h]=!0,c.destination[0]=c.path[h][0],c.destination[1]=c.path[h][1],c.destination[2]=c.path[h][2],c.start[h]=g+c.delay[h]);if(g<c.start[h])break;e(f,c);c.ended[h]=c.Wi;break}a:{for(f=0;f<c.path.length;f++)if(0==c.ended[f]){f=!1;break a}f=!0}if(f)for(f=0;f<c.path.length;f++)c.Fq[f]=!1,c.ended[f]=!1}}})}};a.disable_animation=function(){if(!(0>=D.length))for(var a=0;a<D.length;a++){var b=D[a];m.check_sensor_manifolds(b.collider)&&
m.remove_sensor_manifold(b.collider);g.is_play(b.rig)&&g.stop(b.rig)}}};b4w.module.mouse=function(a,p){function e(){1==M&&(M=0);var a=document.exitPointerLock||document.webkitExitPointerLock||document.mozExitPointerLock;"function"===typeof a&&a.apply(document);d.remove_sensor_manifold(H.get_active_camera(),"SMOOTH_PL")}function c(a){2==M&&(M=0);a.removeEventListener("mousedown",n,!1);a.removeEventListener("mouseup",h,!1);a.removeEventListener("mousemove",b,!1);d.remove_sensor_manifold(H.get_active_camera(),"SMOOTH_DRAG")}function b(a){k()&&(G[0]+=2*(a.clientX-y),G[1]+=
2*(a.clientY-A),y=a.clientX,A=a.clientY);a.preventDefault()}function n(a){y=a.clientX;A=a.clientY;a.currentTarget.addEventListener("mousemove",b,!1);a.preventDefault()}function h(a){a.currentTarget.removeEventListener("mousemove",b,!1);a.preventDefault()}function r(a,b,c,e){if(.01<Math.abs(G[0])||.01<Math.abs(G[1]))b=d.get_sensor_value(a,b,0),a=D.smooth(G[0],0,b,.1*E),b=D.smooth(G[1],0,b,.1*E),G[0]-=a,G[1]-=b,e(4E-4*-a,4E-4*-b)}function g(a,b){var c=H.get_first_character(),d=H.get_active_camera();
q.eye_rotate(d,a,b);c&&(d=q.get_camera_angles_char(d,x),l.set_character_rotation(c,d[0],d[1]))}function m(a){a=B.client_to_canvas_coords(a.clientX,a.clientY,x);(a=H.pick_object(a[0],a[1]))?(H.outlining_is_enabled(a)&&H.set_outline_intensity(a,1),H.outlining_is_enabled(t)&&a!=t&&H.set_outline_intensity(t,0)):H.outlining_is_enabled(t)&&H.set_outline_intensity(t,0);t=a}var q=p("camera"),B=p("container"),d=p("controls"),l=p("physics"),f=p("print"),H=p("scenes"),D=p("util"),w=p("main"),E=1,y=0,A=0,G=new Float32Array(2),
x=new Float32Array(2),k=null,t=null,M=0;a.request_pointerlock=function(a,b,e,h,k,l){function m(){if(document.pointerLockElement===a||document.webkitPointerLockElement===a||document.mozPointerLockElement===a){c(a);a.addEventListener("mousemove",h,!1);var f=H.get_active_camera();if(!d.check_sensor_manifold(f,"SMOOTH_PL")){var g=d.create_elapsed_sensor();d.create_sensor_manifold(f,"SMOOTH_PL",d.CT_CONTINUOUS,[g],null,r,l)}b()}else a.removeEventListener("mousemove",h,!1),M=0,document.removeEventListener("pointerlockchange",
m,!1),document.removeEventListener("webkitpointerlockchange",m,!1),document.removeEventListener("mozpointerlockchange",m,!1),e()}if(1!=M){M=1;b=b||function(){};e=e||function(){};l=l||g;k=k||function(){return!0};h=h||function(a){if(k()){if("number"==typeof a.movementX){var b=a.movementX;a=a.movementY}else"number"==typeof a.webkitMovementX?(b=a.webkitMovementX,a=a.webkitMovementY):"number"==typeof a.mozMovementX?(b=a.mozMovementX,a=a.mozMovementY):a=b=0;G[0]+=b;G[1]+=a}};document.addEventListener("pointerlockchange",
m,!1);document.addEventListener("webkitpointerlockchange",m,!1);document.addEventListener("mozpointerlockchange",m,!1);var n=a.requestPointerLock||a.webkitRequestPointerLock||a.mozRequestPointerLock;"function"===typeof n?n.apply(a):f.error("Pointer lock is not available")}};a.exit_pointerlock=e;a.check_pointerlock=function(a){return"function"===typeof(a.requestPointerLock||a.webkitRequestPointerLock||a.mozRequestPointerLock)?!0:!1};a.request_mouse_drag=function(a,b,c){2!=M&&(M=2,e(),k=b||function(){return!0},
c=c||g,a.addEventListener("mousedown",n,!1),a.addEventListener("mouseup",h,!1),a=H.get_active_camera(),d.check_sensor_manifold(a,"SMOOTH_DRAG")||(b=d.create_elapsed_sensor(),d.create_sensor_manifold(a,"SMOOTH_DRAG",d.CT_CONTINUOUS,[b],null,r,c)))};a.exit_mouse_drag=c;a.enable_mouse_hover_outline=function(){w.detect_mobile()||B.get_canvas().addEventListener("mousemove",m)};a.disable_mouse_hover_outline=function(){w.detect_mobile()||(B.get_canvas().removeEventListener("mousemove",m),t&&H.set_outline_intensity(t,
0))};a.get_coords_x=function(a,b){var c=b?a.targetTouches:a.touches;return"clientX"in a?a.clientX:c&&"clientX"in c[0]?c[0].clientX:-1};a.get_coords_y=function(a,b){var c=b?a.targetTouches:a.touches;return"clientY"in a?a.clientY:c&&"clientY"in c[0]?c[0].clientY:-1};a.set_plock_smooth_factor=function(a){E=a};a.get_plock_smooth_factor=function(){return E}};b4w.module.preloader=function(a,p){var e=p("container"),c,b,n,h,r,g,m,q,B=null;a.create_preloader=function(a){var g="#000",f="#5276cf",m="#fff",p="#fff",q;for(q in a)switch(q){case "container_color":g=a.container_color;break;case "bar_color":f=a.bar_color;break;case "frame_color":m=a.frame_color;break;case "font_color":p=a.font_color}a=document.createElement("div");q=a.cloneNode();var r=a.cloneNode(),y=a.cloneNode(),A=e.get_container();r.appendChild(q);r.appendChild(y);a.appendChild(r);A.appendChild(a);
a.style.cssText="background-color: "+g+";width: 100%;height: 100%;position: absolute;top: 0;left: 0;";r.style.cssText="position: absolute;left: 50%;top: 50%;margin-left: -150px;margin-top: -30px;width: 300px;height: 28px;border: 2px solid "+m+";";q.style.cssText="position: absolute;width: 0%;top: 0;left: 0;background-color: "+f+";height: 100%;";y.style.cssText="font-family: Arial, sans-serif;line-height: 28px;height: 100%;width: 100%;top: 0;left: 0;text-align: center;position: absolute;font-size: 16px;color: "+
p+";";c=q;b=y;n=a;h="DEFAULT"};a.create_simple_preloader=function(a){var e=null,f=null,g="#bf9221",m="#000",p;for(p in a)switch(p){case "canvas_container_id":e=a.canvas_container_id;break;case "background_container_id":f=a.background_container_id;break;case "bg_color":m=a.bg_color;break;case "bar_color":g=a.bar_color}a=document.createElement("div");p=document.createElement("div");a.id="simple_preloader_container";var q=document.createElement("div"),y=document.createElement("div"),f=document.getElementById(f);
B=document.getElementById(e);a.style.cssText="z-index: 4;background-color: "+m+";width: 100%;height: 100%;position: absolute;margin: 0;padding: 0;top: 0;left: 0;";p.style.cssText="position: absolute;left: 50%;top: 82%;width: 300px;height: 20px;margin-left: -150px;margin-top: -10px;border-style:solid;border-width:4px;border-color: #000;border-radius: 0px;";q.style.cssText="position: absolute;left: 0px;top: 1px;width: 0px;height: 18px;background-color: "+g+";border-radius: 0px;";y.style.cssText="position: absolute;left: 50%;top: 50%;width: 100%;height: 100%;margin-left: -150px;margin-top: -10px;text-align: center;font-size: 17px;font-weight: bold;color: #000;font-family: Verdana;"+
p.appendChild(q);p.appendChild(y);a.appendChild(p);document.body.appendChild(a);h="SIMPLE";n=a;c=q;b=y;r=f};a.create_rotation_preloader=function(a){var c=null,e=null,m="rgba(0,0,0,0)",p="",q="",E="rgba(0,0,0,0)",y;for(y in a)switch(y){case "canvas_container_id":c=a.canvas_container_id;break;case "background_container_id":e=a.background_container_id;break;case "frame_bg_color":m=a.frame_bg_color;break;case "bg_color":E=a.bg_color;break;case "frame_class":p=a.frame_class;break;case "anim_elem_class":q=
a.anim_elem_class}a=document.createElement("div");y=document.createElement("div");var A=document.createElement("div"),G=document.createElement("div"),e=document.getElementById(e);B=document.getElementById(c);a.style.cssText="z-index: 4;background-color: "+E+";width: 100%;height: 100%;position: absolute;margin: 0;padding: 0;top: 0;left: 0;";y.style.cssText="position: absolute;left: 50%;top: 50%;width: 117px;height: 117px;margin-left: -58px;margin-top: -58px;background-color: "+m+";";A.style.cssText=
"position: absolute;left: 0px;top: 0px;width: 100%;height: 100%;background-position: center;background-repeat: no-repeat;";G.style.cssText="position: absolute;width: 100%;height: 100%;text-align: center;margin-top: 38px;font-size: 36px;color: #ffffff;font-family: Arial;font-weight: bold;";A.className=q;y.appendChild(A);y.className=p;y.appendChild(G);a.appendChild(y);B.appendChild(a);h="ROTATION";n=a;g=A;b=G;r=e};a.create_advanced_preloader=function(a){var e=a.preloader_width,e=e/(e-a.img_width),f=
document.getElementById(a.preloader_bar_id),g=document.getElementById(a.fill_band_id),p=document.getElementById(a.preloader_caption_id),w=document.getElementById(a.preloader_container_id),E=document.getElementById(a.background_container_id);B=document.getElementById(a.canvas_container_id);h="ADVANCED";c=f;m=g;q=e;b=p;n=w;r=E};a.update_preloader=function(a){b.innerHTML=a+"%";"SIMPLE"==h?c.style.width=a+"%":"ADVANCED"==h?(c.style.width=a/q+"%",m.style.width=100-a+"%"):"ROTATION"==h?g.style.transform=
"rotate("+a+"deg)":"DEFAULT"==h&&(c.style.width=a+"%");100==a&&(n.parentNode.removeChild(n),r&&r.parentNode.removeChild(r))}};b4w.module.storage=function(a,p){function e(a){return n[a?a:b]?JSON.parse(n[a?a:b]):{}}var c=p("__print"),b="b4w",n=null;a.init=function(a){a?"b4w"!==a?b=a:c.error("b4w prefix denied"):c.warn("Prefix should be a string. Last declared storage prefix will be used.")};a.set=function(a,c,h){var p=e(h);p[a]=String(c);n[h?h:b]=JSON.stringify(p)};a.cleanup=function(a){delete n[a?a:b]};a.get=function(a,b){var c=e(b);return c[a]?c[a]:""};a.debug=function(a){c.log(e(a?a:b))};try{n=window.localStorage;try{n.tmp=
null,delete n.tmp}catch(h){c.warn("localStorage quota is limited. Disabling localStorage"),n=null}}catch(r){c.warn("Applying chrome localStorage bug workaround"),n=null}n||(c.warn("localStorage is not available, initializing temporary storage"),n={})};b4w.module.screenshooter=function(a,p){var e=p("main");a.shot=function(){e.canvas_data_url(function(a){var b=window.document.createElement("a");document.body.appendChild(b);b.style.display="none";b.href=a;b.download="screenshot.png";b.click();document.body.removeChild(b)})}};
